<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Tw-light-svn] r84 - in branches/multiplayer-branch: . doc source source/ais source/games source/libraries/raknet source/melee source/other source/sc1ships source/sc2ships source/ships
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/tw-light-svn/2004-October/index.html" >
   <LINK REL="made" HREF="mailto:tw-light-svn%40lists.berlios.de?Subject=Re%3A%20%5BTw-light-svn%5D%20r84%20-%20in%20branches/multiplayer-branch%3A%20.%20doc%20source%20source/ais%20source/games%20source/libraries/raknet%20source/melee%20source/other%20source/sc1ships%20source/sc2ships%20source/ships&In-Reply-To=%3C200410200805.i9K85nQG008325%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000031.html">
   <LINK REL="Next"  HREF="000033.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Tw-light-svn] r84 - in branches/multiplayer-branch: . doc source source/ais source/games source/libraries/raknet source/melee source/other source/sc1ships source/sc2ships source/ships</H1>
    <B>Paul Forest at BerliOS</B> 
    <A HREF="mailto:tw-light-svn%40lists.berlios.de?Subject=Re%3A%20%5BTw-light-svn%5D%20r84%20-%20in%20branches/multiplayer-branch%3A%20.%20doc%20source%20source/ais%20source/games%20source/libraries/raknet%20source/melee%20source/other%20source/sc1ships%20source/sc2ships%20source/ships&In-Reply-To=%3C200410200805.i9K85nQG008325%40sheep.berlios.de%3E"
       TITLE="[Tw-light-svn] r84 - in branches/multiplayer-branch: . doc source source/ais source/games source/libraries/raknet source/melee source/other source/sc1ships source/sc2ships source/ships">youbastrd at sheep.berlios.de
       </A><BR>
    <I>Wed Oct 20 10:05:49 CEST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000031.html">[Tw-light-svn] r83 - trunk/web
</A></li>
        <LI>Next message: <A HREF="000033.html">[Tw-light-svn] r85 - trunk/web
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32">[ date ]</a>
              <a href="thread.html#32">[ thread ]</a>
              <a href="subject.html#32">[ subject ]</a>
              <a href="author.html#32">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: youbastrd
Date: 2004-10-20 10:05:48 +0200 (Wed, 20 Oct 2004)
New Revision: 84

Added:
   branches/multiplayer-branch/source/games/gup.cpp
   branches/multiplayer-branch/source/games/gup.h
   branches/multiplayer-branch/source/melee/MultiplayerTypes.h
   branches/multiplayer-branch/source/melee/PresenceRegistry.cpp
   branches/multiplayer-branch/source/melee/PresenceRegistry.h
   branches/multiplayer-branch/source/sc1ships/sc1ships.h
   branches/multiplayer-branch/source/sc2ships/sc2ships.h
Removed:
   branches/multiplayer-branch/source/other/gup.cpp
   branches/multiplayer-branch/source/other/gup.h
   branches/multiplayer-branch/source/sc1ships.h
   branches/multiplayer-branch/source/sc2ships.h
Modified:
   branches/multiplayer-branch/doc/Doxyfile
   branches/multiplayer-branch/makefile
   branches/multiplayer-branch/source/ais.h
   branches/multiplayer-branch/source/ais/c_wussie.cpp
   branches/multiplayer-branch/source/frame.cpp
   branches/multiplayer-branch/source/frame.h
   branches/multiplayer-branch/source/games/MultiplayerGame.cpp
   branches/multiplayer-branch/source/games/MultiplayerGame.h
   branches/multiplayer-branch/source/games/gflmelee.h
   branches/multiplayer-branch/source/games/ggob.cpp
   branches/multiplayer-branch/source/games/gmelee.cpp
   branches/multiplayer-branch/source/games/gmelee.h
   branches/multiplayer-branch/source/gui.cpp
   branches/multiplayer-branch/source/gui.h
   branches/multiplayer-branch/source/id.h
   branches/multiplayer-branch/source/input.cpp
   branches/multiplayer-branch/source/input.h
   branches/multiplayer-branch/source/libraries/raknet/DistributedNetworkObjectHeader.h
   branches/multiplayer-branch/source/melee.h
   branches/multiplayer-branch/source/melee/manim.cpp
   branches/multiplayer-branch/source/melee/manim.h
   branches/multiplayer-branch/source/melee/mcbodies.cpp
   branches/multiplayer-branch/source/melee/mcbodies.h
   branches/multiplayer-branch/source/melee/mcontrol.cpp
   branches/multiplayer-branch/source/melee/mcontrol.h
   branches/multiplayer-branch/source/melee/mfleet.cpp
   branches/multiplayer-branch/source/melee/mfleet.h
   branches/multiplayer-branch/source/melee/mframe.cpp
   branches/multiplayer-branch/source/melee/mframe.h
   branches/multiplayer-branch/source/melee/mgame.h
   branches/multiplayer-branch/source/melee/mhelpers.cpp
   branches/multiplayer-branch/source/melee/mitems.cpp
   branches/multiplayer-branch/source/melee/mitems.h
   branches/multiplayer-branch/source/melee/mlog.cpp
   branches/multiplayer-branch/source/melee/mlog.h
   branches/multiplayer-branch/source/melee/mmath.cpp
   branches/multiplayer-branch/source/melee/mnet1.cpp
   branches/multiplayer-branch/source/melee/mnet1.h
   branches/multiplayer-branch/source/melee/moptions.cpp
   branches/multiplayer-branch/source/melee/moptions.h
   branches/multiplayer-branch/source/melee/mship.cpp
   branches/multiplayer-branch/source/melee/mship.h
   branches/multiplayer-branch/source/melee/mshot.cpp
   branches/multiplayer-branch/source/melee/mshot.h
   branches/multiplayer-branch/source/melee/mshpdata.cpp
   branches/multiplayer-branch/source/melee/mshppan.cpp
   branches/multiplayer-branch/source/melee/mshppan.h
   branches/multiplayer-branch/source/melee/msprite.cpp
   branches/multiplayer-branch/source/melee/mtarget.cpp
   branches/multiplayer-branch/source/melee/mtarget.h
   branches/multiplayer-branch/source/melee/mview.cpp
   branches/multiplayer-branch/source/melee/mview.h
   branches/multiplayer-branch/source/other/configrw.cpp
   branches/multiplayer-branch/source/other/configrw.h
   branches/multiplayer-branch/source/other/dialogs.cpp
   branches/multiplayer-branch/source/other/dialogs.h
   branches/multiplayer-branch/source/other/fontmorph.cpp
   branches/multiplayer-branch/source/other/fontmorph.h
   branches/multiplayer-branch/source/other/nullphas.cpp
   branches/multiplayer-branch/source/other/nullphas.h
   branches/multiplayer-branch/source/other/objanim.cpp
   branches/multiplayer-branch/source/other/objanim.h
   branches/multiplayer-branch/source/other/orbit.cpp
   branches/multiplayer-branch/source/other/orbit.h
   branches/multiplayer-branch/source/other/planet3d.cpp
   branches/multiplayer-branch/source/other/planet3d.h
   branches/multiplayer-branch/source/other/radar.cpp
   branches/multiplayer-branch/source/other/radar.h
   branches/multiplayer-branch/source/other/shippart.cpp
   branches/multiplayer-branch/source/other/shippart.h
   branches/multiplayer-branch/source/other/twconfig.cpp
   branches/multiplayer-branch/source/other/twconfig.h
   branches/multiplayer-branch/source/other/vbodies.cpp
   branches/multiplayer-branch/source/other/vbodies.h
   branches/multiplayer-branch/source/other/vtarget.cpp
   branches/multiplayer-branch/source/other/vtarget.h
   branches/multiplayer-branch/source/sc1ships/shpandgu.cpp
   branches/multiplayer-branch/source/sc1ships/shparisk.cpp
   branches/multiplayer-branch/source/sc1ships/shpchebr.cpp
   branches/multiplayer-branch/source/sc1ships/shpearcr.cpp
   branches/multiplayer-branch/source/sc1ships/shpilwav.cpp
   branches/multiplayer-branch/source/sc1ships/shpkzedr.cpp
   branches/multiplayer-branch/source/sc1ships/shpmmrxf.cpp
   branches/multiplayer-branch/source/sc1ships/shpmycpo.cpp
   branches/multiplayer-branch/source/sc1ships/shpshosc.cpp
   branches/multiplayer-branch/source/sc1ships/shpspael.cpp
   branches/multiplayer-branch/source/sc1ships/shpsyrpe.cpp
   branches/multiplayer-branch/source/sc1ships/shpumgdr.cpp
   branches/multiplayer-branch/source/sc1ships/shpvuxin.cpp
   branches/multiplayer-branch/source/sc1ships/shpyehte.cpp
   branches/multiplayer-branch/source/sc2ships/shpchmav.cpp
   branches/multiplayer-branch/source/sc2ships/shpdruma.cpp
   branches/multiplayer-branch/source/sc2ships/shpkohma.cpp
   branches/multiplayer-branch/source/sc2ships/shpmeltr.cpp
   branches/multiplayer-branch/source/sc2ships/shporzne.cpp
   branches/multiplayer-branch/source/sc2ships/shppkufu.cpp
   branches/multiplayer-branch/source/sc2ships/shpslypr.cpp
   branches/multiplayer-branch/source/sc2ships/shpsupbl.cpp
   branches/multiplayer-branch/source/sc2ships/shpthrto.cpp
   branches/multiplayer-branch/source/sc2ships/shputwju.cpp
   branches/multiplayer-branch/source/sc2ships/shpzfpst.cpp
   branches/multiplayer-branch/source/scp.cpp
   branches/multiplayer-branch/source/scp.h
   branches/multiplayer-branch/source/ship.h
   branches/multiplayer-branch/source/ships/shpaktgu.cpp
   branches/multiplayer-branch/source/ships/shpalabc.cpp
   branches/multiplayer-branch/source/ships/shpbahbu.cpp
   branches/multiplayer-branch/source/ships/shpbipka.cpp
   branches/multiplayer-branch/source/ships/shpbogce.cpp
   branches/multiplayer-branch/source/ships/shpchoex.cpp
   branches/multiplayer-branch/source/ships/shpconca.cpp
   branches/multiplayer-branch/source/ships/shpconho.cpp
   branches/multiplayer-branch/source/ships/shpdragr.cpp
   branches/multiplayer-branch/source/ships/shpearc3.cpp
   branches/multiplayer-branch/source/ships/shpforsh.cpp
   branches/multiplayer-branch/source/ships/shpgarty.cpp
   branches/multiplayer-branch/source/ships/shpilwsp.cpp
   branches/multiplayer-branch/source/ships/shpilwsp.h
   branches/multiplayer-branch/source/ships/shpkahbo.cpp
   branches/multiplayer-branch/source/ships/shprogsq.cpp
   branches/multiplayer-branch/source/ships/shpstaba.cpp
   branches/multiplayer-branch/source/ships/shptauar.cpp
   branches/multiplayer-branch/source/ships/shptauda.cpp
   branches/multiplayer-branch/source/ships/shptaume.cpp
   branches/multiplayer-branch/source/ships/shptausl.cpp
   branches/multiplayer-branch/source/ships/shptaust.cpp
   branches/multiplayer-branch/source/ships/shptauto.cpp
   branches/multiplayer-branch/source/ships/shpwolmi.cpp
   branches/multiplayer-branch/source/ships/shpyusra.cpp
   branches/multiplayer-branch/source/ships/shpzeksh.cpp
   branches/multiplayer-branch/sources.lst
Log:
many, many changes: added PresenceRegistry class, forced many subclasses of Presence to register themselves with a macro.  Renamed a few files.  Updated the header of many files to point to tw-light's webpage, rather than timewarp's webpage.  Forced the source.lst file to be a subset of all files to avoid unnecessary complications (the only ship that's available is the Yehat Terminator).  A few bug fixes involving pointers... and probably introduced many more. :( Many no-arg constructors are presently unstable.  Added makefile target &quot;run-multiplayer&quot;, which starts up a server, and creates a client which connects locally.  

When this branch is stable, I'll break up the changes into more meaningful and atomic revisions when adding to the trunk.  

This revision is barely able to compile, let alone run properly.  It's a very rough work in progress.  

Modified: branches/multiplayer-branch/doc/Doxyfile
===================================================================
--- branches/multiplayer-branch/doc/Doxyfile	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/doc/Doxyfile	2004-10-20 08:05:48 UTC (rev 84)
@@ -166,7 +166,7 @@
 INCLUDE_FILE_PATTERNS  = 
 PREDEFINED             = 
 EXPAND_AS_DEFINED      = 
-SKIP_FUNCTION_MACROS   = YES
+SKIP_FUNCTION_MACROS   = NO
 #---------------------------------------------------------------------------
 # Configuration::addtions related to external references   
 #---------------------------------------------------------------------------

Modified: branches/multiplayer-branch/makefile
===================================================================
--- branches/multiplayer-branch/makefile	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/makefile	2004-10-20 08:05:48 UTC (rev 84)
@@ -29,6 +29,7 @@
 CX = g++
 RC = windres
 LD = g++
+GDB = gdb
 
 CFLAGS = -fsigned-char -Wall -Wno-deprecated-declarations
 OBJDIR = obj
@@ -150,6 +151,9 @@
 OBJS += $(OBJDIR)/winicon.o
 endif
 
+ifdef DEBUG
+NAME = $(addprefix $(NAME)/,$(GDB))
+endif
 
 ##############################################################################
 
@@ -202,6 +206,12 @@
 add_stacktrace:
 	find source -name '*.cpp'|grep -v 'libraries'|grep -v 'errors.cpp'|grep -v 'utils.cpp'|xargs ./Util/addStackTrace.pl 
 
+run: all
+	$(NAME)
+
+run-multiplayer: all
+	$(NAME) -play game MultiplayerGameServer &amp; sleep 3 &amp;&amp; $(NAME) -play game MultiplayerGameClient
+
 install:
 	./install-sh $(NAME) $(EXECPATH)/$(NAME)
 	./install-sh gamedata $(DATAPATH)

Modified: branches/multiplayer-branch/source/ais/c_wussie.cpp
===================================================================
--- branches/multiplayer-branch/source/ais/c_wussie.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ais/c_wussie.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,6 +1,6 @@
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ais.h
===================================================================
--- branches/multiplayer-branch/source/ais.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ais.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: ais.h,v 1.1.1.1 2004/08/01 10:21:18 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/frame.cpp
===================================================================
--- branches/multiplayer-branch/source/frame.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/frame.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: frame.cpp,v 1.1.1.1 2004/08/01 10:21:18 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/frame.h
===================================================================
--- branches/multiplayer-branch/source/frame.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/frame.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: frame.h,v 1.1.1.1 2004/08/01 10:21:18 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -18,6 +18,8 @@
 #ifndef __FRAME_H__
 #define __FRAME_H__
 
+#include &quot;melee.h&quot;
+    
 typedef struct DirtyItem {
   int x, y, a, b;
 

Modified: branches/multiplayer-branch/source/games/MultiplayerGame.cpp
===================================================================
--- branches/multiplayer-branch/source/games/MultiplayerGame.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/games/MultiplayerGame.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,6 @@
-/* $Id: melee.h,v 1.3 2004/08/08 17:36:03 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -20,7 +19,8 @@
 
 #include &quot;libraries/raknet/RakClientInterface.h&quot;
 #include &quot;libraries/raknet/RakServerInterface.h&quot;
-//#include &quot;Raknet/RakNetworkFactory.h&quot;	
+#include &quot;Raknet/RakNetworkFactory.h&quot;	
+#include &quot;melee/PresenceRegistry.h&quot;
 
 // If you don't want to use distributed network objects, delete this include
 #include &quot;../libraries/raknet/DistributedNetworkObjectManager.h&quot;
@@ -29,143 +29,164 @@
 #include &lt;assert.h&gt;
 #include &lt;stdio.h&gt;
 #include &quot;../libraries/raknet/GetTime.h&quot;
-	
+#include &lt;iostream&gt;	
 
-//#ifdef DEBUG
+#ifdef DEBUGMODE
+    #define _DEBUG
+#endif
+#ifdef DEBUG
 	#define _DEBUG
-//#endif
+#endif
 
 #ifdef _DEBUG
 #include &lt;memory.h&gt;
 #endif
 
+
 template &lt;class InterfaceType&gt;
 MultiplayerGameTemplate&lt;InterfaceType&gt;::MultiplayerGameTemplate() :
-	_isServer(false)
+    server(RakNetworkFactory::GetRakServerInterface()),
+    client(RakNetworkFactory::GetRakClientInterface()),
+    networkInterface(NULL),
+    _isServer(false)
 {
     message.print(5000,15,&quot;Game on!&quot;);
+    cout &lt;&lt; &quot;gametype constructor:&quot; &lt;&lt; endl;
+    PresenceRegistry::GetInstance()-&gt;toString();
 }
 
 template &lt;class InterfaceType&gt;
 MultiplayerGameTemplate&lt;InterfaceType&gt;::~MultiplayerGameTemplate()
 {
+    RakNetworkFactory::DestroyRakServerInterface(server);
+    RakNetworkFactory::DestroyRakClientInterface(client);
 }
 
+
 template &lt;class InterfaceType&gt;
-void MultiplayerGameTemplate&lt;InterfaceType&gt;::ProcessPackets(InterfaceType *interfaceType)
-{
-	Packet* p;
-	unsigned char packetIdentifier;
+void MultiplayerGameTemplate&lt;InterfaceType&gt;::init(Log *log) { 
+    Game::init(log); 
+    prepare();
+    
+    asteroid = new Asteroid();
+    add(asteroid);
 
-	p = interfaceType-&gt;Receive();
+    stars = new Stars();
+    add( stars );
+    
+    yehat = new YehatTerminator(Vector2(0,0), 0, );
+    add( yehat );
+    
+    if (isServer()) {
+    	//printf(&quot;server:init&quot;);
+    	//PresenceRegistry::GetInstance()-&gt;toString();        	
+    	//Stars * stars = new Stars();
+    	//printf(&quot;server:init: adding stars with (%s:%d)\n&quot;, stars-&gt;GetClassName(), stars-&gt;GetClassID());
+    	//PresenceRegistry::GetInstance()-&gt;toString();
+	    //add( stars );
+	    //add(new Asteroid());
+	    
+        
+		/*
+        add(new Asteroid());
+        add(new Asteroid());*/
+    }
+}
 
-	while (p)
-	{
-		if ((unsigned char)p-&gt;data[0] == ID_TIMESTAMP)
-		{
-			if (p-&gt;length &gt; sizeof(unsigned char) + sizeof(unsigned long))
-				packetIdentifier = (unsigned char) p-&gt;data[sizeof(unsigned char) + sizeof(unsigned long)];
-			else
-				break;
-		}
-		else
-			packetIdentifier = (unsigned char) p-&gt;data[0];
+template &lt;class InterfaceType&gt;
+void MultiplayerGameTemplate&lt;InterfaceType&gt;::calculate() { 
+	Game::calculate(); 
+	ProcessPackets(networkInterface);
+}
 
-		// Check if this is a native packet
-		switch (packetIdentifier)
-		{
-		case ID_REMOTE_DISCONNECTION_NOTIFICATION:
-			ReceiveRemoteDisconnectionNotification(p,interfaceType);
-		    message.print(5000,15,&quot;client : told to bugger off&quot;);
-		break;
-		case ID_REMOTE_CONNECTION_LOST:
-			ReceiveRemoteConnectionLost(p,interfaceType);
-		    message.print(5000,15,&quot;client lost connection&quot;);
-		break;
-		case ID_REMOTE_NEW_INCOMING_CONNECTION:
-			ReceiveRemoteNewIncomingConnection(p,interfaceType);
-			message.print(5000,15,&quot;Got a new connection!&quot;);
-		break;
-		case ID_REMOTE_EXISTING_CONNECTION:
-			ReceiveRemoteExistingConnection(p,interfaceType);
-		    message.print(5000,15,&quot;Player leaving&quot;);
-		break;
-		case ID_CONNECTION_BANNED:
-			ReceiveConnectionBanned(p, interfaceType);
-		break;
-		case ID_CONNECTION_REQUEST_ACCEPTED:
-			ReceiveConnectionRequestAccepted(p,interfaceType);
-		    message.print(5000,15,&quot;We're allowed to connect!!&quot;);
-			break;
-		case ID_NEW_INCOMING_CONNECTION:
-			ReceiveNewIncomingConnection(p,interfaceType);
-			break;
-		case ID_NO_FREE_INCOMING_CONNECTIONS:
-			ReceiveNoFreeIncomingConnections(p,interfaceType);
-			break;
-		case ID_DISCONNECTION_NOTIFICATION:
-			ReceiveDisconnectionNotification(p,interfaceType);
-			break;
-		case ID_CONNECTION_LOST:
-			ReceiveConnectionLost(p,interfaceType);
-			break;
-		case ID_RECEIVED_STATIC_DATA:
-			ReceivedStaticData(p,interfaceType);
-			break;
-		case ID_INVALID_PASSWORD:
-			ReceiveInvalidPassword(p,interfaceType);
-			break;
-		case ID_MODIFIED_PACKET:
-			ReceiveModifiedPacket(p,interfaceType);
-			break;
-		case ID_REMOTE_PORT_REFUSED:
-			ReceiveRemotePortRefused(p,interfaceType);
-			break;
-		case ID_VOICE_PACKET:
-			ReceiveVoicePacket(p,interfaceType);
-			break;
-		case ID_PONG:
-			ReceivePong(p,interfaceType);
-			break;
-		case ID_UPDATE_DISTRIBUTED_NETWORK_OBJECT:
-			ReceiveDistributedNetworkObject(p,interfaceType);
-			break;
-		case ID_DISTRIBUTED_NETWORK_OBJECT_CREATION_ACCEPTED:
-			ReceiveDistributedNetworkObjectCreationAccepted(p,interfaceType);
-			break;
-		case ID_DISTRIBUTED_NETWORK_OBJECT_CREATION_REJECTED:
-			ReceiveDistributedNetworkObjectCreationRejected(p,interfaceType);
-			break;
-		case ID_AUTOPATCHER_REQUEST_FILE_LIST:
-			ReceiveAutopatcherRequestFileList(p,interfaceType);
-			break;
-		case ID_AUTOPATCHER_FILE_LIST:
-			ReceiveAutopatcherFileList(p,interfaceType);
-			break;
-		case ID_AUTOPATCHER_REQUEST_FILES:
-			ReceiveAutopatcherRequestFiles(p,interfaceType);
-			break;
-		case ID_AUTOPATCHER_SET_DOWNLOAD_LIST:
-			ReceiveAutopatcherSetDownloadList(p,interfaceType);
-			break;
-		case ID_AUTOPATCHER_WRITE_FILE:
-			ReceiveAutopatcherWriteFile(p,interfaceType);
-			break;
-		default:
-			// If not a native packet send it to ProcessUnhandledPacket which should have been written by the user
-			ProcessUnhandledPacket(p, packetIdentifier,interfaceType);
-			break;
-		}
 
-		interfaceType-&gt;DeallocatePacket(p);
+template &lt;class InterfaceType&gt;
+void MultiplayerGameTemplate&lt;InterfaceType&gt;::add(SpaceLocation *p)
+{
+    Game::add(p);
+    _add(p);
+}
+    
+template &lt;class InterfaceType&gt;
+void MultiplayerGameTemplate&lt;InterfaceType&gt;::add(Presence *p) 
+{
+    Game::add(p);   
+    _add(p);
+}
 
-		p = interfaceType-&gt;Receive();
-	}
+template &lt;class InterfaceType&gt;
+void MultiplayerGameTemplate&lt;InterfaceType&gt;::_add(Presence *p) 
+{
+    if (isServer()) {
+    	printf(&quot;adding: (%s:%d) ObjectID=%d &quot;, p-&gt;GetClassName(), p-&gt;GetClassID(), p-&gt;GetObjectID());
+        PresenceCreationDescription pc( p-&gt;GetObjectID(), p-&gt;GetClassID() );
+        printf(&quot;as (%s:%d)\n&quot;, 
+        	PresenceRegistry::GetInstance()-&gt;getClassName(pc.presenceType),
+        	pc.presenceType);
+        
+        bool b = server-&gt;Send((char*)&amp;pc, sizeof(PresenceCreationDescription), HIGH_PRIORITY, RELIABLE_ORDERED, 0, UNASSIGNED_PLAYER_ID, true);
+        if (!b)
+        	tw_error(&quot;couldn't send packet in MPGame::_add()&quot;);
+    }
 }
 
+
 template &lt;class InterfaceType&gt;
 void MultiplayerGameTemplate&lt;InterfaceType&gt;::ProcessUnhandledPacket(Packet *p, unsigned char packetIdentifier, InterfaceType *interfaceType)
 {
+	printf(&quot;got an unhandled packet packetIdentifier=%d&quot;, packetIdentifier);
+    switch (packetIdentifier) {
+        case ID_PRESENCE_CREATION:
+        {
+            //if (isServer())
+            //    return;
+            printf(&quot; (presence creation)&quot;);
+            PresenceCreationDescription * pc = (PresenceCreationDescription*) p-&gt;data;
+        
+            assert(p-&gt;length == sizeof(PresenceCreationDescription));
+            if (p-&gt;length != sizeof(PresenceCreationDescription)) {
+                tw_error(&quot;Got a PresenceCreationDescription request that was the wrong size.&quot;);
+                return;
+            }
+            
+            assert(GET_OBJECT_FROM_ID(pc-&gt;objectId) == NULL);
+            if (GET_OBJECT_FROM_ID(pc-&gt;objectId) != NULL) {
+                tw_error(&quot;Got a PresenceCreationDescription request for an object that already exists.&quot;);
+                return;
+            }
+            
+            message.print(15000,15,&quot;Got a presence creation packet, it's a %s&quot;, PresenceRegistry::GetInstance()-&gt;getClassName(pc-&gt;presenceType));
+            printf(&quot;Got a presence creation packet, it's a %s&quot;, PresenceRegistry::GetInstance()-&gt;getClassName(pc-&gt;presenceType));
+            
+            //Presence * presence = PresenceRegistry::GetInstance()-&gt;createPresenceFromNetworkDescription(pc);
+            Presence * presence = PresenceRegistry::GetInstance()-&gt;GetPresenceClassDefaultInstance(pc-&gt;presenceType);
+            Game::add(presence);
+            
+//            switch (pc-&gt;presenceType) {
+//                case PT_ASTEROID:
+//                    add(new Asteroid());
+//                    break;*/
+//                
+//                case PT_YEHAT_TERMINATOR:
+//                   {TeamCode human = new_team();
+//                    Control *c = create_control(channel_server, &quot;Human&quot;);
+//                    Ship *s = create_ship(&quot;yehte&quot;, c, Vector2(size.x/2,size.y/2), 0, human);
+//                    add(s-&gt;get_ship_phaser());
+//                    add_focus(s);}
+//                    break;
+//                
+//                case PT_UNKNOWN:
+//                default:
+//                    message.print(10000,15,&quot;Tried to add unknown object: %s&quot;, p-&gt;data);
+//                    ;
+//            };
+        }
+        break;
+        
+        default:
+            message.print(5000,15,&quot;Unknown data: %s&quot;, p-&gt;data);
+    };
+    
 	// Remove the annoying warnings
 	//packetIdentifier;
 	//interfaceType;
@@ -180,24 +201,25 @@
 //	message.print(5000,15,&quot;MultiplayerGameTemplate::ProcessUnhandledPacket (%i) (%i): &quot;, packetNumber++, p-&gt;length);
 //	for (i=0; i &lt; p-&gt;length; i++)
 //	message.print(5000,15,&quot;%i &quot;,p-&gt;data[i]);
-//	message.print(5000,15,&quot;\n&quot;);
+//	message.print(5000,15,&quot;&quot;);
 	
 
 	// Uncomment this to show output as a string
 	
 	// Raw output (string)
-	message.print(5000,15,&quot;%s\n&quot;, p-&gt;data);
+
 	
 #endif
+	printf(&quot;\n&quot;);
 }
 
 template &lt;class InterfaceType&gt;
 void MultiplayerGameTemplate&lt;InterfaceType&gt;::ReceiveRemoteDisconnectionNotification(Packet *packet,InterfaceType *interfaceType)
 {
 	// Another system has disconnected.  Client only.
-//#ifdef _DEBUG
-	message.print(5000,15,&quot;ID_REMOTE_DISCONNECTION_NOTIFICATION from PlayerID:%u:%u on %p.\n&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
-//#endif
+#ifdef _DEBUG
+	message.print(5000,15,&quot;ID_REMOTE_DISCONNECTION_NOTIFICATION from PlayerID:%u:%u on %p.&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
+#endif
 //	ProcessUnhandledPacket(packet, ID_REMOTE_DISCONNECTION_NOTIFICATION,interfaceType);
 }
 
@@ -205,9 +227,9 @@
 void MultiplayerGameTemplate&lt;InterfaceType&gt;::ReceiveRemoteConnectionLost(Packet *packet,InterfaceType *interfaceType)
 {
 	// Another system has been dropped by the server.  Client only.
-//#ifdef _DEBUG
-	message.print(5000,15,&quot;ID_REMOTE_CONNECTION_LOST from PlayerID:%u:%u on %p.\n&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
-//#endif
+#ifdef _DEBUG
+	message.print(5000,15,&quot;ID_REMOTE_CONNECTION_LOST from PlayerID:%u:%u on %p.&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
+#endif
 //	ProcessUnhandledPacket(packet, ID_REMOTE_CONNECTION_LOST,interfaceType);
 }
 
@@ -215,9 +237,9 @@
 void MultiplayerGameTemplate&lt;InterfaceType&gt;::ReceiveRemoteNewIncomingConnection(Packet *packet,InterfaceType *interfaceType)
 {
 	// Another system has connected.  Client only.
-//#ifdef _DEBUG
-	message.print(5000,15,&quot;ID_REMOTE_NEW_INCOMING_CONNECTION from PlayerID:%u:%u on %p.\n&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
-//#endif
+#ifdef _DEBUG
+	message.print(5000,15,&quot;ID_REMOTE_NEW_INCOMING_CONNECTION from PlayerID:%u:%u on %p.&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
+#endif
 //	ProcessUnhandledPacket(packet, ID_REMOTE_NEW_INCOMING_CONNECTION,interfaceType);
 }
 
@@ -227,9 +249,9 @@
 	// We just connected to the server and are getting a list of players already connected
 	// Note due to thread timing you might get both this and ID_REMOTE_NEW_INCOMING_CONNECTION when first connecting.
 	//  Client only.
-//#ifdef _DEBUG
-	message.print(5000,15,&quot;ID_REMOTE_EXISTING_CONNECTION from PlayerID:%u:%u on %p.\n&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
-//#endif
+#ifdef _DEBUG
+	message.print(5000,15,&quot;ID_REMOTE_EXISTING_CONNECTION from PlayerID:%u:%u on %p.&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
+#endif
 	//	ProcessUnhandledPacket(packet, ID_REMOTE_EXISTING_CONNECTION,interfaceType);
 }
 
@@ -238,9 +260,9 @@
 {
 	// We are banned from connecting to the system specified in packet-&gt;playerId
 	// Peer or client
-//#ifdef _DEBUG
-	message.print(5000,15,&quot;ID_CONNECTION_BANNED from PlayerID:%u:%u on %p.\n&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
-//#endif
+#ifdef _DEBUG
+	message.print(5000,15,&quot;ID_CONNECTION_BANNED from PlayerID:%u:%u on %p.&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
+#endif
 	//	ProcessUnhandledPacket(packet, ID_REMOTE_EXISTING_CONNECTION,interfaceType);
 }
 
@@ -250,9 +272,9 @@
 {
     message.print(5000,15,&quot;We're accepted to connect&quot;);
 	// Our request to connect to another system has been accepted.  Client only.
-//#ifdef _DEBUG
-	message.print(5000,15,&quot;ID_CONNECTION_REQUEST_ACCEPTED from PlayerID:%u:%u on %p.\n&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
-//#endif
+#ifdef _DEBUG
+	message.print(5000,15,&quot;ID_CONNECTION_REQUEST_ACCEPTED from PlayerID:%u:%u on %p.&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
+#endif
 //	ProcessUnhandledPacket(packet, ID_CONNECTION_REQUEST_ACCEPTED,interfaceType);
 }
 
@@ -260,9 +282,17 @@
 void MultiplayerGameTemplate&lt;InterfaceType&gt;::ReceiveNewIncomingConnection(Packet *packet, InterfaceType *interfaceType)
 {
 	// Another system has requested to connect to us, which we have accepted.  Server or peer only.
-//#ifdef _DEBUG
-	message.print(5000,15,&quot;ID_NEW_INCOMING_CONNECTION from PlayerID:%u:%u on %p.\n&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
-//#endif
+    message.print(10000,15,&quot;%s has connected&quot;, ((StaticClientDataStruct*)(server-&gt;GetStaticClientData(packet-&gt;playerId))-&gt;GetData())-&gt;name);
+    
+    TeamCode human = new_team();
+    Control *c = create_control(channel_server, &quot;Human&quot;);
+    Ship *s = create_ship(&quot;yehte&quot;, c, Vector2(size.x/2,size.y/2), 0, human);
+    add(s-&gt;get_ship_phaser());
+    add_focus(s);
+  
+#ifdef _DEBUG
+	message.print(5000,15,&quot;ID_NEW_INCOMING_CONNECTION from PlayerID:%u:%u on %p.&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
+#endif
 //	ProcessUnhandledPacket(packet, ID_NEW_INCOMING_CONNECTION,interfaceType);
 
 	// This will send all existing distributed objects to the new player
@@ -275,9 +305,9 @@
 void MultiplayerGameTemplate&lt;InterfaceType&gt;::ReceiveConnectionResumption(Packet *packet, InterfaceType *interfaceType)
 {
 	// Someone who was already connected to us connected again.  Server or peer only.
-//#ifdef _DEBUG
-	message.print(5000,15,&quot;ID_CONNECTION_RESUMPTION from PlayerID:%u:%u on %p.\n&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
-//#endif
+#ifdef _DEBUG
+	message.print(5000,15,&quot;ID_CONNECTION_RESUMPTION from PlayerID:%u:%u on %p.&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
+#endif
 //	ProcessUnhandledPacket(packet, ID_CONNECTION_RESUMPTION,interfaceType);
 }
 
@@ -287,9 +317,9 @@
 	// The system we connected to has no free slots to connect to
 	// Set free slots by calling SetMaximumIncomingConnections
 	// Client or peer only.
-//#ifdef _DEBUG
-	message.print(5000,15,&quot;ID_NO_FREE_INCOMING_CONNECTIONS from PlayerID:%u:%u on %p.\n&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
-//#endif
+#ifdef _DEBUG
+	message.print(5000,15,&quot;ID_NO_FREE_INCOMING_CONNECTIONS from PlayerID:%u:%u on %p.&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
+#endif
 //	ProcessUnhandledPacket(packet, ID_NO_FREE_INCOMING_CONNECTIONS,interfaceType);
 }
 
@@ -297,9 +327,9 @@
 void MultiplayerGameTemplate&lt;InterfaceType&gt;::ReceiveDisconnectionNotification(Packet *packet, InterfaceType *interfaceType)
 {
 	// A remote system terminated the connection.  packet-&gt;playerId specifies which remote system
-//#ifdef _DEBUG
-	message.print(5000,15,&quot;ID_DISCONNECTION_NOTIFICATION from PlayerID:%u:%u on %p.\n&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
-//#endif
+#ifdef _DEBUG
+	message.print(5000,15,&quot;ID_DISCONNECTION_NOTIFICATION from PlayerID:%u:%u on %p.&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
+#endif
 //	ProcessUnhandledPacket(packet, ID_DISCONNECTION_NOTIFICATION,interfaceType);
 }
 
@@ -307,9 +337,9 @@
 void MultiplayerGameTemplate&lt;InterfaceType&gt;::ReceiveConnectionLost(Packet *packet, InterfaceType *interfaceType)
 {
 	// The network cannot send reliable packets so has terminated the connection. packet-&gt;playerId specifies which remote system
-//#ifdef _DEBUG
-	message.print(5000,15,&quot;ID_CONNECTION_LOST from PlayerID:%u:%u on %p.\n&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
-//#endif
+#ifdef _DEBUG
+	message.print(5000,15,&quot;ID_CONNECTION_LOST from PlayerID:%u:%u on %p.&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
+#endif
 //	ProcessUnhandledPacket(packet, ID_CONNECTION_LOST,interfaceType);
 }
 
@@ -317,9 +347,9 @@
 void MultiplayerGameTemplate&lt;InterfaceType&gt;::ReceivedStaticData(Packet *packet, InterfaceType *interfaceType)
 {
 	// Another system has just sent their static data to us (which we recorded automatically)
-//#ifdef _DEBUG
-	message.print(5000,15,&quot;ID_RECEIVED_STATIC_DATA from PlayerID:%u:%u on %p.\n&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
-//#endif
+#ifdef _DEBUG
+	message.print(5000,15,&quot;ID_RECEIVED_STATIC_DATA from PlayerID:%u:%u on %p.&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
+#endif
 //	ProcessUnhandledPacket(packet, ID_RECEIVED_STATIC_DATA,interfaceType);
 }
 
@@ -327,9 +357,9 @@
 void MultiplayerGameTemplate&lt;InterfaceType&gt;::ReceiveInvalidPassword(Packet *packet, InterfaceType *interfaceType)
 {
 	// Our connection to another system was refused because the passwords do not match
-//#ifdef _DEBUG
-	message.print(5000,15,&quot;ID_INVALID_PASSWORD from PlayerID:%u:%u on %p.\n&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
-//#endif
+#ifdef _DEBUG
+	message.print(5000,15,&quot;ID_INVALID_PASSWORD from PlayerID:%u:%u on %p.&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
+#endif
 //	ProcessUnhandledPacket(packet, ID_INVALID_PASSWORD,interfaceType);
 }
 
@@ -338,9 +368,9 @@
 {
 	// The network layer has detected packet tampering
 	// This does NOT automatically close the connection
-//#ifdef _DEBUG
-	message.print(5000,15,&quot;ID_MODIFIED_PACKET from PlayerID:%u:%u on %p.\n&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
-//#endif
+#ifdef _DEBUG
+	message.print(5000,15,&quot;ID_MODIFIED_PACKET from PlayerID:%u:%u on %p.&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
+#endif
 //	ProcessUnhandledPacket(packet, ID_MODIFIED_PACKET,interfaceType);
 }
 
@@ -348,9 +378,9 @@
 void MultiplayerGameTemplate&lt;InterfaceType&gt;::ReceiveRemotePortRefused(Packet *packet, InterfaceType *interfaceType)
 {
 	// The remote system has responded with ICMP_PORT_UNREACHABLE
-//#ifdef _DEBUG
-	message.print(5000,15,&quot;ID_REMOTE_PORT_REFUSED from PlayerID:%u:%u on %p.\n&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
-//#endif
+#ifdef _DEBUG
+	message.print(5000,15,&quot;ID_REMOTE_PORT_REFUSED from PlayerID:%u:%u on %p.&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
+#endif
 //	ProcessUnhandledPacket(packet, ID_REMOTE_PORT_REFUSED,interfaceType);
 }
 
@@ -358,9 +388,9 @@
 void MultiplayerGameTemplate&lt;InterfaceType&gt;::ReceiveVoicePacket(Packet *packet, InterfaceType *interfaceType)
 {
 	// We got a voice packet
-//#ifdef _DEBUG
-	message.print(5000,15,&quot;ID_VOICE_PACKET from PlayerID:%u:%u on %p.\n&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
-//#endif
+#ifdef _DEBUG
+	message.print(5000,15,&quot;ID_VOICE_PACKET from PlayerID:%u:%u on %p.&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
+#endif
 //	ProcessUnhandledPacket(packet, ID_VOICE_PACKET,interfaceType);
 }
 
@@ -371,7 +401,7 @@
 //#ifdef _DEBUG
 	unsigned long time;
 	memcpy((char*)&amp;time, packet-&gt;data+sizeof(unsigned char), sizeof(unsigned long));
-	message.print(5000,15,&quot;ID_PONG from PlayerID:%u:%u on %p. Value is %i\n&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType, time);
+	message.print(5000,15,&quot;ID_PONG from PlayerID:%u:%u on %p. Value is %i&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType, time);
 //#endif
 	//	ProcessUnhandledPacket(packet, ID_PONG,interfaceType);
 }
@@ -380,9 +410,9 @@
 void MultiplayerGameTemplate&lt;InterfaceType&gt;::ReceiveDistributedNetworkObject(Packet *packet,InterfaceType *interfaceType)
 {
 	// Packet to create a distributed network object
-//#ifdef _DEBUG
-	message.print(5000,15,&quot;ID_UPDATE_DISTRIBUTED_NETWORK_OBJECT from PlayerID:%u:%u on %p.\n&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
-//#endif
+#ifdef _DEBUG
+	message.print(5000,15,&quot;ID_UPDATE_DISTRIBUTED_NETWORK_OBJECT from PlayerID:%u:%u on %p.&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
+#endif
 
 	#ifdef __DISTRIBUTED_NETWORK_OBJECT_MANAGER_H
 
@@ -401,9 +431,9 @@
 void MultiplayerGameTemplate&lt;InterfaceType&gt;::ReceiveDistributedNetworkObjectCreationAccepted(Packet *packet,InterfaceType *interfaceType)
 {
 	// Client only - creation of a distributed network object was accepted
-//#ifdef _DEBUG
-	message.print(5000,15,&quot;ID_DISTRIBUTED_NETWORK_OBJECT_CREATION_ACCEPTED from PlayerID:%u:%u on %p.\n&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
-//#endif
+#ifdef _DEBUG
+	message.print(5000,15,&quot;ID_DISTRIBUTED_NETWORK_OBJECT_CREATION_ACCEPTED from PlayerID:%u:%u on %p.&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
+#endif
 
 #ifdef __DISTRIBUTED_NETWORK_OBJECT_MANAGER_H
 	// This packet is only valid if the client was registered with the DistributedNetworkObjectManager
@@ -418,9 +448,9 @@
 void MultiplayerGameTemplate&lt;InterfaceType&gt;::ReceiveDistributedNetworkObjectCreationRejected(Packet *packet,InterfaceType *interfaceType)
 {
 	// Client only - creation of a distributed network object was accepted
-//#ifdef _DEBUG
-	message.print(5000,15,&quot;ID_DISTRIBUTED_NETWORK_OBJECT_CREATION_REJECTED from PlayerID:%u:%u on %p.\n&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
-//#endif
+#ifdef _DEBUG
+	message.print(5000,15,&quot;ID_DISTRIBUTED_NETWORK_OBJECT_CREATION_REJECTED from PlayerID:%u:%u on %p.&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
+#endif
 
 #ifdef __DISTRIBUTED_NETWORK_OBJECT_MANAGER_H
 	// This packet is only valid if the client was registered with the DistributedNetworkObjectManager
@@ -436,9 +466,9 @@
 {
 	// Request for a list of files served by the autopatcher.
 	// Send to Autopatcher::SendDownloadableFileList(packet-&gt;playerId)
-//#ifdef _DEBUG
-	message.print(5000,15,&quot;ID_AUTOPATCHER_REQUEST_FILE_LIST from PlayerID:%u:%u on %p.\n&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
-//#endif
+#ifdef _DEBUG
+	message.print(5000,15,&quot;ID_AUTOPATCHER_REQUEST_FILE_LIST from PlayerID:%u:%u on %p.&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
+#endif
 	// ProcessUnhandledPacket(packet, ID_AUTOPATCHER_REQUEST_FILE_LIST,interfaceType);
 }
 
@@ -447,9 +477,9 @@
 {
 	// Got a list of files served by a remote autopatcher
 	// Send to Autopatcher::OnAutopatcherFileList(packet, bool);
-//#ifdef _DEBUG
-	message.print(5000,15,&quot;ID_AUTOPATCHER_FILE_LIST from PlayerID:%u:%u on %p.\n&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
-//#endif
+#ifdef _DEBUG
+	message.print(5000,15,&quot;ID_AUTOPATCHER_FILE_LIST from PlayerID:%u:%u on %p.&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
+#endif
 	// ProcessUnhandledPacket(packet, ID_AUTOPATCHER_FILE_LIST,interfaceType);
 }
 
@@ -458,9 +488,9 @@
 {
 	// Got a request for a set of files from our autopatcher
 	// Send to Autopatcher::OnAutopatcherRequestFiles(packet);
-//#ifdef _DEBUG
-	message.print(5000,15,&quot;ID_AUTOPATCHER_REQUEST_FILES from PlayerID:%u:%u on %p.\n&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
-//#endif
+#ifdef _DEBUG
+	message.print(5000,15,&quot;ID_AUTOPATCHER_REQUEST_FILES from PlayerID:%u:%u on %p.&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
+#endif
 	// ProcessUnhandledPacket(packet, ID_AUTOPATCHER_REQUEST_FILES,interfaceType);
 }
 
@@ -469,9 +499,9 @@
 {
 	// Got confirmation of what files we are about to get from the remote autopatcher
 	// Send to Autopatcher::OnAutopatcherSetDownloadList(packet);
-//#ifdef _DEBUG
-	message.print(5000,15,&quot;ID_AUTOPATCHER_SET_DOWNLOAD_LIST from PlayerID:%u:%u on %p.\n&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
-//#endif
+#ifdef _DEBUG
+	message.print(5000,15,&quot;ID_AUTOPATCHER_SET_DOWNLOAD_LIST from PlayerID:%u:%u on %p.&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
+#endif
 	// ProcessUnhandledPacket(packet, ID_AUTOPATCHER_SET_DOWNLOAD_LIST,interfaceType);
 }
 
@@ -480,28 +510,28 @@
 {
 	// Got a file from a remote autopatcher
 	// Send to Autopatcher::OnAutopatcherWriteFile(packet);
-//#ifdef _DEBUG
-	message.print(5000,15,&quot;ID_AUTOPATCHER_WRITE_FILE from PlayerID:%u:%u on %p.\n&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
-//#endif
+#ifdef _DEBUG
+	message.print(5000,15,&quot;ID_AUTOPATCHER_WRITE_FILE from PlayerID:%u:%u on %p.&quot;,packet-&gt;playerId.binaryAddress, packet-&gt;playerId.port, interfaceType);
+#endif
 	// ProcessUnhandledPacket(packet, ID_AUTOPATCHER_WRITE_FILE,interfaceType);
 };
 
 // Copied from Multiplayer.cpp
 // If the first byte is ID_TIMESTAMP, then we want the 5th byte
 // Otherwise we want the 1st byte
-unsigned char GetPacketIdentifier(Packet *p)
-{
-	if (p==0)
-		return 255;
+//unsigned char GetPacketIdentifier(Packet *p)
+//{
+//	if (p==0)
+//		return 255;
+//
+//	if ((unsigned char)p-&gt;data[0] == ID_TIMESTAMP)
+//	{
+//		assert(p-&gt;length &gt; sizeof(unsigned char) + sizeof(unsigned long));
+//		return (unsigned char) p-&gt;data[sizeof(unsigned char) + sizeof(unsigned long)];
+//	}
+//	else
+//		return (unsigned char) p-&gt;data[0];
+//}
 
-	if ((unsigned char)p-&gt;data[0] == ID_TIMESTAMP)
-	{
-		assert(p-&gt;length &gt; sizeof(unsigned char) + sizeof(unsigned long));
-		return (unsigned char) p-&gt;data[sizeof(unsigned char) + sizeof(unsigned long)];
-	}
-	else
-		return (unsigned char) p-&gt;data[0];
-}
-
 REGISTER_GAME(MultiplayerGameClient, &quot;MultiplayerGameClient&quot;)
 REGISTER_GAME(MultiplayerGameServer, &quot;MultiplayerGameServer&quot;)

Modified: branches/multiplayer-branch/source/games/MultiplayerGame.h
===================================================================
--- branches/multiplayer-branch/source/games/MultiplayerGame.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/games/MultiplayerGame.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,6 @@
-/* $Id: melee.h,v 1.3 2004/08/08 17:36:03 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -24,19 +23,9 @@
 #include &quot;frame.h&quot;
 #include &quot;melee/mgame.h&quot;
 #include &quot;melee/mview.h&quot;
-
-//#include &quot;games/gmelee.h&quot;
-//#include &quot;melee/mview.h&quot;
-//#include &quot;melee/mcontrol.h&quot;
-//#include &quot;other/planet3d.h&quot;
-////#include &quot;mshppan.h&quot;
-//#include &quot;melee/mship.h&quot;
-//#include &quot;melee/mlog.h&quot;
-////#include &quot;mnet1.h&quot;
-//#include &quot;melee/mitems.h&quot;
-//#include &quot;melee/mfleet.h&quot;
-
-
+#include &quot;melee/mship.h&quot;
+#include &quot;melee/mcbodies.h&quot;
+#include &quot;melee/MultiplayerTypes.h&quot;
 #include &quot;../libraries/raknet/PacketEnumerations.h&quot;
 #include &quot;../libraries/raknet/RakNetworkFactory.h&quot;
 #include &quot;../libraries/raknet/RakClientInterface.h&quot;
@@ -44,6 +33,7 @@
 #include &quot;../libraries/raknet/NetworkTypes.h&quot;
 #include &quot;../libraries/raknet/BitStream.h&quot;
 #include &quot;../libraries/raknet/Multiplayer.h&quot;
+#include &quot;sc1ships/sc1ships.h&quot;
 	
 #include &lt;stdlib.h&gt;
 #include &lt;string.h&gt;
@@ -52,29 +42,19 @@
 //#include &lt;allegro.h&gt;
 
 
-//! 
-unsigned char GetPacketIdentifier(Packet *p);
+//#include &quot;games/gmelee.h&quot;
+//#include &quot;melee/mview.h&quot;
+//#include &quot;melee/mcontrol.h&quot;
+//#include &quot;other/planet3d.h&quot;
+////#include &quot;mshppan.h&quot;
+//#include &quot;melee/mlog.h&quot;
+////#include &quot;mnet1.h&quot;
+//#include &quot;melee/mitems.h&quot;
+//#include &quot;melee/mfleet.h&quot;
 
-// Holds enumeration data
-const int MOTD_MAXIMUM_LENGTH=50; // Characters allocated for the message of the day, used for enumerations
-const int SERVER_NAME_MAXIMUM_LENGTH=40; // Characters allocated for the server name
 
-//! data on the server which changes infrequently.  This information is transmitted to all joining clients.
-struct StaticServerDataStruct
-{
-	char MOTD[MOTD_MAXIMUM_LENGTH];  // (Message of the day) Optional, replace with whatever and/or add more fields
-	char serverName[SERVER_NAME_MAXIMUM_LENGTH];
-};
 
-const int SCDS_MAXIMUM_NAME_LENGTH=40;
 
-//! data on the client, which is automatically transmitted to the server and all other clients.  
-struct StaticClientDataStruct
-{
-	unsigned char typeId;  // ID_SET_CLIENT_DATA
-	char name[SCDS_MAXIMUM_NAME_LENGTH];
-};
-
 //! A class to implement Multiplayer Games with.  You should subclass this, rather than using it directly.
 //! You should also create a server and client class that can be used to start a game in the GUI and from the
 //! commandline (see MultiplayerGameServer for more explaination on how to do this).
@@ -99,6 +79,7 @@
 //! @see MultiplayerGameClient
 //! @see FleetSelectionPolicy
 //! @see SpawnTimeShipSelectionPolicy
+
 template &lt;class InterfaceType&gt;
 class MultiplayerGameTemplate : 
 	public Multiplayer&lt;InterfaceType&gt;,
@@ -112,13 +93,16 @@
     //!
 	~MultiplayerGameTemplate();
 	
+	YehatTerminator * yehat;
+
+	
 	// Methods and data stuctures from class Game /////////////////////////////////////////////////
 	
 	//! pre-initialization (enough so that the destructor won't crash)
 	virtual void preinit() { Game::preinit(); }	
 	
     //! initialization (loading data, creating a few game objects, whatever)
-    virtual void init(Log *log) { Game::init(log); }
+    virtual void init(Log *log);
     
     //! changes the view.  That is, the method that the screen is drawn for the user is selected.
     //! @param new_view the View data structure to use.
@@ -132,10 +116,7 @@
     virtual void prepare() { Game::prepare(); }
     
     //! called once per game loop.  Performs all game logic.
-    virtual void calculate() { 
-    	Game::calculate(); 
-    	ProcessPackets(networkInterface);
-    }
+    virtual void calculate();
     
     //! called once per game execution.  This contains the game loop itself.
     virtual void play() { Game::play(); }
@@ -162,13 +143,26 @@
 	//! Determines if the game has loaded/prepared all its data structures and ready to start.
     //! @return true if the game is ready to start, false otherwise.
 	virtual bool game_ready() {return Game::game_ready(); }
+    
+    /// add space location to universe
+    /// @see SpaceLocation
+    virtual void add(SpaceLocation *p);
+    
+    /// add presence from universe
+    /// @see Presence
+    virtual void add(Presence *p);
+
+protected:
+    ///
+    virtual void _add(Presence * p);
+    
+public: 
 	
-	
 	// Methods and data stuctures from class Multiplayer ///////////////////////////////////////////
 		
 	//! Automagically processes all incoming packets, and calls appropriate handlers.  This method
     //! must be called every frame, and this is done by default inside calculate().
-	void ProcessPackets(InterfaceType *interfaceType);
+	//void ProcessPackets(InterfaceType *interfaceType);
 	virtual void ProcessUnhandledPacket(Packet *p, unsigned char packetIdentifier, InterfaceType *interfaceType);
 	virtual void ReceiveRemoteDisconnectionNotification(Packet *packet,InterfaceType *interfaceType);
 	virtual void ReceiveRemoteConnectionLost(Packet *packet,InterfaceType *interfaceType);
@@ -200,6 +194,9 @@
 	virtual bool isServer() { return _isServer; }
 	
 protected:
+    RakServerInterface * server;
+    RakClientInterface * client;
+
 	//! this is the object which is used in all interactions with the RakNet API.  Note that the actual type
 	//! of this variable depends on the type of InterfaceType.  This means if this templated class is used as a client,
 	//! this variable is a RakClientInterface.  
@@ -208,9 +205,14 @@
 	//! - using MultiplayerGameTemplate&lt;RakServerInterface&gt; means this variable is a RakServerInterface
 	//! - using MultiplayerGameTemplate&lt;RakPeerInterface&gt; means this variable is a RakPeerInterface
 	InterfaceType * networkInterface;
+    
 
 protected:
 	bool _isServer;
+    PlayerList players;
+    
+    Asteroid * asteroid;
+    Stars * stars;
 };
 
 //! This class is exposed to the list of available games.  Note that this class is
@@ -244,15 +246,20 @@
 	MultiplayerGameServer()
     { 
         _isServer = true;
-		networkInterface = RakNetworkFactory::GetRakServerInterface(); 
-        networkInterface-&gt;SetStaticServerData((char*)&amp;staticServerData, sizeof(staticServerData));
-        bool b = networkInterface-&gt;Start(2, 0, true, 15515);
+		networkInterface = server;
+        server-&gt;SetStaticServerData((char*)&amp;staticServerData, sizeof(staticServerData));
+        bool b = server-&gt;Start(2, 0, true, 15515);
         if (!b)
             throw &quot;Can't start server!&quot;;
-        message.print(5000,15,&quot;Started server!&quot;);
+        message.print(60000,15,&quot;Started server!&quot;);
 	}
-	~MultiplayerGameServer() { RakNetworkFactory::DestroyRakServerInterface(networkInterface); }
+	~MultiplayerGameServer() { }
     
+    virtual void calculate() {
+        MultiplayerGameTemplate&lt;RakServerInterface&gt;::calculate();
+    }
+    
+protected:
     StaticServerDataStruct staticServerData;
 };
 
@@ -261,18 +268,18 @@
 public:
 	MultiplayerGameClient()
     { 
-      networkInterface = RakNetworkFactory::GetRakClientInterface(); 
-      networkInterface-&gt;SetStaticClientData(UNASSIGNED_PLAYER_ID, (char*)&amp;staticClientData, sizeof(StaticClientDataStruct));
+      networkInterface = client;
+      client-&gt;SetStaticClientData(UNASSIGNED_PLAYER_ID, (char*)&amp;staticClientData, sizeof(StaticClientDataStruct));
       bool b = false;
       while (!b) {
-        b = networkInterface-&gt;Connect(&quot;127.0.0.1&quot;, 15515, 15516, 0, true);
+        b = client-&gt;Connect(&quot;127.0.0.1&quot;, 15515, 15516, 0, true);
         if (!b)
             message.out(&quot;Couldn't connect, retrying...&quot;);
       }
-      message.out(&quot;Connected to server!&quot;);
+      message.print(60000,15,&quot;Connected to server!&quot;);
       
     }
-	~MultiplayerGameClient() { RakNetworkFactory::DestroyRakClientInterface(networkInterface);  }
+	~MultiplayerGameClient() { }
     StaticClientDataStruct staticClientData;
 };
 

Modified: branches/multiplayer-branch/source/games/gflmelee.h
===================================================================
--- branches/multiplayer-branch/source/games/gflmelee.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/games/gflmelee.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: gflmelee.h,v 1.1.1.1 2004/08/01 10:21:21 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/games/ggob.cpp
===================================================================
--- branches/multiplayer-branch/source/games/ggob.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/games/ggob.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -40,10 +40,10 @@
 #include &quot;util/aastr.h&quot;
 
 #include &quot;ggob.h&quot;
-#include &quot;sc1ships.h&quot;
-#include &quot;sc2ships.h&quot;
+#include &quot;sc1ships/sc1ships.h&quot;
+#include &quot;sc2ships/sc2ships.h&quot;
 
-#include &quot;other/gup.h&quot;
+#include &quot;games/gup.h&quot;
 #include &quot;other/dialogs.h&quot;
 #include &quot;other/twconfig.h&quot;
 

Modified: branches/multiplayer-branch/source/games/gmelee.cpp
===================================================================
--- branches/multiplayer-branch/source/games/gmelee.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/games/gmelee.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id$ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -36,6 +36,7 @@
 //#include &quot;mnet1.h&quot;
 #include &quot;melee/mitems.h&quot;
 #include &quot;melee/mfleet.h&quot;
+#include &quot;melee/PresenceRegistry.h&quot;
 
 #include &quot;gflmelee.h&quot;
 
@@ -455,6 +456,9 @@
 	int		*indtoggle;
 	Ship	*mother;
 	TeamIndicator(Ship *creator, int *toggle);
+	TeamIndicator() : indtoggle(NULL), mother(NULL) { }
+	virtual char * GetClassName(void) const;
+	virtual unsigned GetClassID(void) const;
 
 	virtual void calculate();
 	virtual void animate(Frame *space);
@@ -462,6 +466,7 @@
 
 
 
+
 void MeleeGame::choose_new_ships() 
 {
   STACKTRACE;
@@ -720,4 +725,5 @@
 
 
 
-REGISTER_GAME(MeleeGame, &quot;Melee&quot;)
+REGISTER_GAME(MeleeGame, &quot;Melee&quot;);
+REGISTER_PRESENCE_CLASS(TeamIndicator);

Modified: branches/multiplayer-branch/source/games/gmelee.h
===================================================================
--- branches/multiplayer-branch/source/games/gmelee.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/games/gmelee.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $$ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -19,6 +19,7 @@
 #define __MMAIN_H__
 
 #include &quot;melee.h&quot;
+#include &quot;melee/mship.h&quot;
 #include &quot;melee/mgame.h&quot;
 
 enum { DefaultEndingTime = 1000 };

Copied: branches/multiplayer-branch/source/games/gup.cpp (from rev 81, branches/multiplayer-branch/source/other/gup.cpp)
===================================================================
--- branches/multiplayer-branch/source/other/gup.cpp	2004-10-16 21:23:27 UTC (rev 81)
+++ branches/multiplayer-branch/source/games/gup.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -0,0 +1,716 @@
+#include &lt;string.h&gt;
+#include &lt;allegro.h&gt;
+#include &quot;melee.h&quot;
+
+#include &quot;melee/mframe.h&quot;
+#include &quot;melee/mship.h&quot;
+#include &quot;melee/mcbodies.h&quot;
+#include &quot;melee/mview.h&quot;
+#include &quot;frame.h&quot;
+#include &quot;sc1ships/sc1ships.h&quot;
+#include &quot;sc2ships/sc2ships.h&quot;
+#include &quot;games/ggob.h&quot;
+#include &quot;games/gup.h&quot;
+#include &quot;melee/PresenceRegistry.h&quot;
+
+/* this file contains the ship upgrades used by Gob */
+
+/*
+Generic Upgrades
+*/
+
+/*
+NOTE that execute() is called BEFORE charge(), so 
+num is not yet incremented when execute() is running
+*/
+void Upgrade::clear(Ship *oship, Ship *nship, GobPlayer *gs) {
+  STACKTRACE;
+	if (oship) gs-&gt;total -= num;
+	num = 0;
+	return;
+	}
+void Upgrade::charge(GobPlayer *gs) {
+  STACKTRACE; //called AFTER execute
+	gs-&gt;total += 1;
+	num += 1;
+	gs-&gt;value_starbucks += this-&gt;starbucks;
+	gs-&gt;value_buckazoids += this-&gt;buckazoids;
+	return;
+	}
+
+#define UPGRADE(a) virtual Upgrade *duplicate() {return new a();}
+class UpCrewpod : public Upgrade {
+	UPGRADE(UpCrewpod)
+	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
+		name = &quot;Add Crewpod&quot;;
+		if (ship-&gt;crew_max &gt;= 42) return false;
+		starbucks = 2;
+		buckazoids = gs-&gt;total / 3;
+		return true;
+		}
+	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
+		ship-&gt;crew_max += 4;
+		if (ship-&gt;crew_max &gt; 42) ship-&gt;crew_max = 42;
+		ship-&gt;crew += 4;
+		if (ship-&gt;crew &gt; 42) ship-&gt;crew = 42;
+		}
+	} crewpod;
+
+class UpBattery : public Upgrade {
+	UPGRADE(UpBattery)
+	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
+		name = &quot;Add Battery&quot;;
+		if (ship-&gt;batt_max &gt;= 42) return false;
+		starbucks = 1;
+		buckazoids = gs-&gt;total / 3;
+		return true;
+		}
+	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
+		ship-&gt;batt_max += 8;
+		if (ship-&gt;batt_max &gt; 42) ship-&gt;batt_max = 42;
+		ship-&gt;batt += 8;
+		if (ship-&gt;batt &gt; 42) ship-&gt;batt = 42;
+		}
+	} battery;
+
+class UpThrusters : public Upgrade {
+	UPGRADE(UpThrusters)
+	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
+		name = &quot;Upgrade Thrusters&quot;;
+		starbucks = 3 + num * 3;
+		buckazoids = gs-&gt;total / 3;
+		return true;
+		}
+	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
+		ship-&gt;speed_max *=  1 + .3  / (.25*num + 1);
+		ship-&gt;accel_rate *= 1 + .18 / (.12*num + 1);
+		}
+	} thrusters;
+
+class UpControlJets : public Upgrade {
+	UPGRADE(UpControlJets)
+	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
+		name = &quot;Upgrade Control Jets&quot;;
+		starbucks = 2 + num * 2;
+		buckazoids = gs-&gt;total / 3;
+		return true;
+		}
+	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
+		ship-&gt;turn_rate  *=  1 + .3  / (num + 1);
+		ship-&gt;accel_rate *=  1 + .1  / (.0*num + 1);
+		}
+	} controljets;
+
+class UpDynamo : public Upgrade {
+	UPGRADE(UpDynamo)
+	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
+		name = &quot;Upgrade Dynamo&quot;;
+		starbucks = 16 / (1 + ship-&gt;recharge_amount-num) + num;
+		if (ship-&gt;recharge_amount == 0) starbucks *= 6;
+		if (ship-&gt;weapon_rate &lt; 100) starbucks /= 2;
+		if (ship-&gt;special_drain &gt; 16) starbucks *= 2;
+		if (!strcmp(&quot;supbl&quot;, ship-&gt;type-&gt;id)) starbucks /= 2;
+		buckazoids = gs-&gt;total / 3;
+		return true;
+	}
+	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
+		ship-&gt;recharge_amount += 1;
+	}
+} dynamo;
+
+/*
+Supox Upgrades
+*/
+
+class UpSupoxRange : public Upgrade {
+	UPGRADE(UpSupoxRange)
+	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
+		name = &quot;Upgrade Glob Hurler (Supox)&quot;;
+		if (strcmp(&quot;supbl&quot;, ship-&gt;type-&gt;id)) return false;
+		starbucks = 2 + num;
+		buckazoids = gs-&gt;total / 3;
+		return true;
+		}
+	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
+		((SupoxBlade*)ship)-&gt;weaponRange *= 1 + .25 / (1 + num*.1);
+		((SupoxBlade*)ship)-&gt;weaponVelocity *= 1.15;
+		}
+	} supoxrange;
+
+class UpSupoxDamage : public Upgrade {
+	UPGRADE(UpSupoxDamage)
+	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
+		name = &quot;Upgrade Glob Former (Supox)&quot;;
+		if (strcmp(&quot;supbl&quot;, ship-&gt;type-&gt;id)) return false;
+		if (gs-&gt;ship-&gt;recharge_amount &lt; (1&lt;&lt;num)) return false;
+		if (num &gt; 7) return false;
+		starbucks = 5;
+		buckazoids = gs-&gt;total / 3;
+		return true;
+		}
+	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
+		((SupoxBlade*)ship)-&gt;weaponDamage += 1;
+		((SupoxBlade*)ship)-&gt;weaponArmour += 1;
+		((SupoxBlade*)ship)-&gt;weapon_drain += num + 1;
+		if (num &gt; 1) ((SupoxBlade*)ship)-&gt;recharge_amount += 1;
+		}
+	} supoxdamage;
+
+class UpSupoxBLADE : public Upgrade {
+	UPGRADE(UpSupoxBLADE)
+	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
+		name = &quot;Add B.L.A.D.E. (Supox)&quot;;
+		if (strcmp(&quot;supbl&quot;, ship-&gt;type-&gt;id)) return false;
+		starbucks = 2 + num;
+		buckazoids = gs-&gt;total / 3;
+		return true;
+		}
+	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
+		((SupoxBlade*)ship)-&gt;damage_factor += 3;
+		}
+	} supoxblade;
+
+/*
+Orz Upgrades
+*/
+
+class UpOrzMissile : public Upgrade {
+	UPGRADE(UpOrzMissile)
+	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
+		name = &quot;Upgrade Missiles (ORZ)&quot;;
+		if (strcmp(&quot;orzne&quot;, ship-&gt;type-&gt;id)) return false;
+		starbucks = 6;
+		buckazoids = gs-&gt;total / 2 + 2;
+		return true;
+		}
+	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
+		((OrzNemesis*)ship)-&gt;weaponDamage += 1;
+		((OrzNemesis*)ship)-&gt;weaponArmour += 1;
+		((OrzNemesis*)ship)-&gt;weaponRange *= 1.15;
+		((OrzNemesis*)ship)-&gt;weapon_drain += 1;
+		}
+	} orzmissile;
+
+class UpOrzMarineSpeed : public Upgrade {
+	UPGRADE(UpOrzMarineSpeed)
+	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
+		name = &quot;Upgrade Marine Suits (ORZ)&quot;;
+		if (strcmp(&quot;orzne&quot;, ship-&gt;type-&gt;id)) return false;
+		starbucks = 3 + num * 2;
+		buckazoids = gs-&gt;total / 3;
+		return true;
+		}
+	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
+		((OrzNemesis*)ship)-&gt;specialArmour += 1;
+		((OrzNemesis*)ship)-&gt;specialSpeedMax *= 1 + .2 / (.2*num+1);
+		((OrzNemesis*)ship)-&gt;specialAccelRate *= 1.15;
+		}
+	} orzmarinespeed;
+
+class UpOrzAbsorbtion : public Upgrade {
+	UPGRADE(UpOrzAbsorbtion)
+	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
+		name = &quot;Absorbtion (ORZ)&quot;;
+		if (strcmp(&quot;orzne&quot;, ship-&gt;type-&gt;id)) return false;
+		if (num) return false;
+		starbucks = 15;
+		buckazoids = gs-&gt;total / 3;
+		return true;
+	}
+	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
+		((OrzNemesis*)ship)-&gt;absorption = 256 / 3;
+	}
+	void charge(GobPlayer *gs) {
+		Upgrade::charge(gs);
+		gs-&gt;total += 2;
+	}
+} orzabsorption;
+
+/*
+Kohr-Ah Upgrades
+*/
+
+class UpKohrAhBladeDamage : public Upgrade {
+	UPGRADE(UpKohrAhBladeDamage)
+	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
+		name = &quot;Increase Shuriken Sharpness (Kohr-Ah)&quot;;
+		if (strcmp(&quot;kohma&quot;, ship-&gt;type-&gt;id)) return false;
+		starbucks = 2 + num;
+		buckazoids = gs-&gt;total / 3;
+		return true;
+		}
+	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
+		((KohrAhMarauder*)ship)-&gt;weaponDamage += 1;
+		((KohrAhMarauder*)ship)-&gt;weaponArmour += 1;
+		((KohrAhMarauder*)ship)-&gt;weapon_drain += 1;
+		}
+	} kohrahbladedamage;
+
+class UpKohrAhBladeSpeed : public Upgrade {
+	UPGRADE(UpKohrAhBladeSpeed)
+	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
+		if (strcmp(&quot;kohma&quot;, ship-&gt;type-&gt;id)) return false;
+		name = &quot;Increase Shuriken Velocity (Kohr-Ah)&quot;;
+		starbucks = 2 + num * 2;
+		buckazoids = gs-&gt;total / 3;
+		return true;
+	}
+	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
+		((KohrAhMarauder*)ship)-&gt;weaponVelocity *= 1.2;
+	}
+} kohrahbladespeed;
+
+class UpKohrAhFireRange : public Upgrade {
+	UPGRADE(UpKohrAhFireRange)
+	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
+		name = &quot;double F.R.I.E.D. range (Kohr-Ah)&quot;;
+		if (strcmp(&quot;kohma&quot;, ship-&gt;type-&gt;id)) return false;
+		if (num) return false;
+		starbucks = 30;
+		buckazoids = gs-&gt;total / 3;
+		return true;
+		}
+	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
+		((KohrAhMarauder*)ship)-&gt;specialRange *= 2;
+		((KohrAhMarauder*)ship)-&gt;specialVelocity *= 1.4;
+		((KohrAhMarauder*)ship)-&gt;special_drain += 12;
+		}
+	} kohrahfirerange;
+
+class UpKohrAhFireDamage : public Upgrade {
+	UPGRADE(UpKohrAhFireDamage)
+	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
+		name = &quot;double F.R.I.E.D. damage (Kohr-Ah)&quot;;
+		if (strcmp(&quot;kohma&quot;, ship-&gt;type-&gt;id)) return false;
+		if (num) return false;
+		starbucks = 13;
+		buckazoids = gs-&gt;total / 3;
+		return true;
+	}
+	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
+		((KohrAhMarauder*)ship)-&gt;specialDamage *= 2;
+		((KohrAhMarauder*)ship)-&gt;special_drain += 6;
+	}
+} kohrahfiredamage;
+
+/*
+Utwig Upgrades
+*/
+
+class UpUtwigJuggerRange : public Upgrade {
+	UPGRADE(UpUtwigJuggerRange)
+	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
+		name = &quot;Upgrade Bolt Regulator (Utwig)&quot;;
+		if (strcmp(&quot;utwju&quot;, ship-&gt;type-&gt;id)) return false;
+		starbucks = 3;
+		buckazoids = gs-&gt;total / 3;
+		return true;
+	}
+	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
+		((UtwigJugger*)ship)-&gt;weaponRange += 100;
+	}
+} utwigrange;
+class UpUtwigJuggerDamage : public Upgrade {
+	UPGRADE(UpUtwigJuggerDamage)
+	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
+		name = &quot;Upgrade Bolt Charger (Utwig)&quot;;
+		if (strcmp(&quot;utwju&quot;, ship-&gt;type-&gt;id)) return false;
+		starbucks = (num + 3) * 5;
+		buckazoids = gs-&gt;total / 3;
+		return true;
+	}
+	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
+		((UtwigJugger*)ship)-&gt;weaponDamage += 1;
+		ship-&gt;weapon_rate += 250;
+	}
+} utwigdamage;
+class UpUtwigJuggerROF : public Upgrade {
+	UPGRADE(UpUtwigJuggerROF)
+	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
+		name = &quot;Upgrade Bolt Generator (Utwig)&quot;;
+		if (strcmp(&quot;utwju&quot;, ship-&gt;type-&gt;id)) return false;
+		if (ship-&gt;weapon_rate &lt; 425) return false;
+		starbucks = num / 2 + 2;
+		buckazoids = gs-&gt;total / 3;
+		return true;
+	}
+	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
+		ship-&gt;weapon_rate -= 50;
+	}
+} utwigrof;
+class UpUtwigJuggerMaskOfHonestDemeanor : public Upgrade {
+	UPGRADE(UpUtwigJuggerMaskOfHonestDemeanor)
+	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
+		name = &quot;Mask of Honest Demeanor (max 1 mask)&quot;;
+		if (strcmp(&quot;utwju&quot;, ship-&gt;type-&gt;id)) return false;
+		if ((num + gs-&gt;upgrade_list[UpgradeIndex::utwigmask2]-&gt;num) == 1) return false;
+		starbucks = 99;
+		buckazoids = 0;
+		return true;
+	}
+	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
+		gs-&gt;value_starbucks += 251;
+		gs-&gt;value_buckazoids += 250;
+	}
+} utwigmask1;
+class UpUtwigJuggerMaskOfElephantineFortitude : public Upgrade {
+	UPGRADE(UpUtwigJuggerMaskOfElephantineFortitude)
+	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
+		name = &quot;Mask of Elephantine Fortitude (max 1 mask)&quot;;
+		if (strcmp(&quot;utwju&quot;, ship-&gt;type-&gt;id)) return false;
+		if ((num + gs-&gt;upgrade_list[UpgradeIndex::utwigmask1]-&gt;num) == 1) return false;
+		starbucks = 99;
+		buckazoids = 0;
+		return true;
+	}
+	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
+		((UtwigJugger*)ship)-&gt;fortitude = 1;
+	}
+} utwigmask2;
+
+/*
+Special Upgrades
+*/
+
+class UpDivineFavor : public Upgrade {
+	UPGRADE(UpDivineFavor)
+	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
+		name = &quot;Divine Favor (unique)&quot;;
+		if (strcmp(station-&gt;build_type, &quot;orzne&quot;)) return false;
+		if (num) return false;
+		starbucks = 150;
+		buckazoids = 0;
+		return true;
+		}
+	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
+		}
+	void clear(Ship *oship, Ship *nship, GobPlayer *gs) {
+		if (!oship) num = 0;
+		return;
+		}
+	void charge(GobPlayer *gs) {
+		num += 1;
+		}
+	} divinefavor;
+
+class UpUnholyAura : public Upgrade {
+	UPGRADE(UpUnholyAura)
+	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
+		name = &quot;the Devil protects his own...&quot;;
+		starbucks = 6;
+		buckazoids = 66;
+		//if (strcmp(station-&gt;build_type, &quot;orzne&quot;)) return false;
+		if (num) return false;
+		if (((game-&gt;game_time / 1000) % 1000) == 666) return true;
+		if (((game-&gt;game_time / 1000) % 666) == 0) return true;
+		//666, 1332, 1666, 1998, etc.
+		return false;
+		}
+	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
+		game-&gt;add ( new UnholyAura ( ship ) );
+		}
+	void clear(Ship *oship, Ship *nship, GobPlayer *gs) {
+		if (!oship) num = 0;
+		else if (num) {
+			game-&gt;add ( new UnholyAura ( nship ) );
+		}
+		return;
+		}
+	void charge(GobPlayer *gs) {
+		num += 1;
+		}
+	} unholyaura;
+
+
+class UpDefender : public Upgrade {
+	UPGRADE(UpDefender)
+	GobDefender *def[6];
+	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
+		name = &quot;External Defense System&quot;;
+		if (strcmp(station-&gt;build_type, &quot;kohma&quot;)) return false;
+		if (num &gt;= 6) return false;
+		starbucks = 5 + 5 * (num+1) * num;
+		buckazoids = 12;
+		return true;
+	}
+	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
+		def[num] = new GobDefender(ship);
+		int i;
+		for (i = 0; i &lt;= num; i += 1) def[i]-&gt;base_phase = i * PI2 / (num+1);
+		gobgame-&gt;add (def[num]);
+	}
+	void clear(Ship *oship, Ship *nship, GobPlayer *gs) {
+		if (!oship) num = 0;
+		if (oship) {
+			for (int i = 0; i &lt; num; i += 1) {
+				def[i]-&gt;die();
+				def[i] = new GobDefender(nship);
+				def[i]-&gt;base_phase = i * PI2 / num;
+				game-&gt;add(def[i]);
+			}
+		}
+		//Upgrade::clear(oship, nship, gs);
+		return;
+	}
+	void charge(GobPlayer *gs) {
+		gs-&gt;total += 1;
+		num += 1;
+	}
+} defender;
+
+class UpPlanetLocater : public Upgrade {
+	UPGRADE(UpPlanetLocater)
+	Presence **locater;
+	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
+		name = &quot;Planet Locater&quot;;
+		if (strcmp(station-&gt;build_type, &quot;supbl&quot;)) return false;
+		if (num) return false;
+		starbucks = 4;
+		buckazoids = 5;
+		return true;
+	}
+	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
+		locater = new Presence *[gobgame-&gt;num_planets];
+		for (int i = 0; i &lt; gobgame-&gt;num_planets; i += 1) {
+			locater[i] = new WedgeIndicator ( gobgame-&gt;planet[i], 80, 2 );
+			gobgame-&gt;add (locater[i] );
+		}
+	}
+	void clear(Ship *oship, Ship *nship, GobPlayer *gs) {
+		Upgrade::clear(oship, nship, gs);
+		if (oship &amp;&amp; locater) for (int i = 0; i &lt; gobgame-&gt;num_planets; i += 1) {
+			locater[i]-&gt;die();
+		}
+		locater = NULL;
+		return;
+	}
+} planetlocater;
+
+class UpHyperDynamo : public Upgrade {
+	UPGRADE(UpHyperDynamo)
+	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
+		name = &quot;Hyper Dynamo (ancient artifact)&quot;;
+		if (game-&gt;game_time / 1000 &lt; 21 * 60) return false;
+		starbucks = 720 / (game-&gt;game_time / (1000*60*10) - 1);
+		//unavailable before 20 minutes
+		//720 starbucks at 20 minutes
+		//360 starbucks at 30 minutes
+		//240 starbucks at 40 minutes
+		//180 starbucks at 50 minutes
+		//144 starbucks at 60 minutes
+		//120 starbucks at 70 minutes
+		//102 starbucks at 80 minutes
+		//90 starbucks at 90 minutes
+		buckazoids = starbucks/2 + gs-&gt;total / 3;
+		if (gs-&gt;starbucks &lt; starbucks / 4) return false;
+		if (ship-&gt;recharge_amount == 0) return false;
+		if (num) return false;
+		return true;
+	}
+	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
+		ship-&gt;recharge_rate /= 2;
+	}
+} hyperdynamo;
+
+/*class UpRoswellDevice : public Upgrade {
+	UPGRADE(UpUnholyAura)
+	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
+		name = &quot;Roswell Device&quot;;
+		if (((game-&gt;game_time / 1000) % 1000) &lt; 700) return false;
+		starbucks = 99;
+		buckazoids = 9;
+		if (strcmp(station-&gt;build_type, &quot;utwju&quot;)) return false;
+		if (num) return false;
+		return true;
+	}
+	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
+		game-&gt;add ( new RoswellDevice ( ship ) );
+	}
+	void clear(Ship *oship, Ship *nship, GobPlayer *gs) {
+		if (!oship) num = 0;
+		else if (num) {
+			game-&gt;add ( new RoswellDevice ( nship ) );
+		}
+		return;
+	}
+	void charge(GobPlayer *gs) {
+		num += 1;
+	}
+} roswelldevice;*/
+
+/*
+note to future coders:
+in order for an upgrade to show up, it must be added to this list
+anything added to this list MUST be added, in the same order, to 
+the enum in gup.h
+*/
+static Upgrade *_upgrade_list[] = {
+	&amp;crewpod,
+	&amp;battery,
+	&amp;thrusters,
+	&amp;controljets,
+	&amp;dynamo,
+	&amp;supoxrange,
+	&amp;supoxdamage,
+	&amp;supoxblade,
+	&amp;orzmissile,
+	&amp;orzmarinespeed,
+	&amp;orzabsorption,
+	&amp;kohrahbladedamage,
+	&amp;kohrahbladespeed,
+	&amp;kohrahfirerange,
+	&amp;kohrahfiredamage,
+	&amp;utwigrange,
+	&amp;utwigdamage,
+	&amp;utwigrof,
+	&amp;utwigmask1,
+	&amp;utwigmask2,
+	&amp;divinefavor,
+	&amp;unholyaura,
+	&amp;defender,
+	&amp;planetlocater,
+	&amp;hyperdynamo,
+//	&amp;roswelldevice,
+	NULL
+	};
+
+Upgrade **upgrade_list = _upgrade_list;
+
+UnholyAura::UnholyAura ( SpaceLocation * ship ) {
+	focus = ship;
+	angle = 0;
+}
+void UnholyAura::animate (Frame *frame) {
+	Vector2 p = corner(focus-&gt;normal_pos());
+	const int speed = 1500;
+	int color = game-&gt;game_time % speed;
+	if (color &gt; speed/2) color = speed - color;
+	color = tw_color ( color * 255 * 2 / speed, 0, 0);
+	Vector2 r;
+	r.y = space_zoom * 240;
+	r.x = r.y * 1.5;
+	double a = angle;
+	line (frame-&gt;surface, 
+		p + r *(unit_vector(a +   0 * ANGLE_RATIO)), 
+		p + r * (unit_vector(a + 144 * ANGLE_RATIO)), 
+		color);
+	a += 72 * ANGLE_RATIO;
+	line (frame-&gt;surface, 
+		p + r * (unit_vector(a +   0 * ANGLE_RATIO)), 
+		p + r * (unit_vector(a + 144 * ANGLE_RATIO)), 
+		color);
+	a += 72 * ANGLE_RATIO;
+	line (frame-&gt;surface, 
+		p + r * (unit_vector(a +   0 * ANGLE_RATIO)), 
+		p + r * (unit_vector(a + 144 * ANGLE_RATIO)), 
+		color);
+	a += 72 * ANGLE_RATIO;
+	line (frame-&gt;surface, 
+		p + r * (unit_vector(a +   0 * ANGLE_RATIO)), 
+		p + r * (unit_vector(a + 144 * ANGLE_RATIO)), 
+		color);
+	a += 72 * ANGLE_RATIO;
+	line (frame-&gt;surface, 
+		p + r * (unit_vector(a +   0 * ANGLE_RATIO)), 
+		p + r * (unit_vector(a + 144 * ANGLE_RATIO)), 
+		color);
+	frame-&gt;add_box(iround(p.x - r.x-1), iround(p.y - r.y-1), iround(r.x*2+3), iround(r.y*2+3));
+}
+void UnholyAura::calculate () {
+	if (!focus-&gt;exists()) die();
+	angle -= frame_time / 10.0;
+	if (angle &lt; 0) angle += 360;
+	if (random(1700) &lt; frame_time) {
+		Query q;
+		q.begin(focus, OBJECT_LAYERS, 666);
+		for (;q.current; q.next() ) {
+			if (!(focus-&gt;sameTeam(q.current))) q.current-&gt;handle_damage(focus, 0, random() % 6);
+		}
+	}
+}
+/*
+void GobRadar::animate_item ( SpaceLocation *item ) {
+	int type = 0;
+	int color = 0;
+	double angle = 0;
+	double radius = 0;
+	double x, y;
+	x = normalize(item-&gt;normal_x() - gx + X_MAX/2, X_MAX) - X_MAX/200+gx/2;
+	x *= window-&gt;w / gw;
+	y = normalize(item-&gt;normal_y() - gy + Y_MAX/2, Y_MAX) - Y_MAX/200+gy/2;
+	y *= window-&gt;h / gh;
+	TeamCode t = item-&gt;get_team();
+	if (t == 0) color = palette_color[6];
+	else if (t == team) color = palette_color[7];
+	else color = palette_color[4];
+	color = palette_color[7];
+	if (item-&gt;isObject()) {
+		SpaceSprite *sprite = ((SpaceObject*)item)-&gt;get_sprite();
+		if (sprite) radius = 
+			sqrt(sprite-&gt;width() * sprite-&gt;width() + sprite-&gt;height() * sprite-&gt;height()) / 2 / gw;
+		else return;
+		if (radius &lt; 5) radius = sqrt(radius * 5);
+	}
+	else if (item-&gt;isLine()) {
+		type = 1;
+		radius = (((SpaceLine*)item)-&gt;get_length()) / gw;
+		angle = (((SpaceLine*)item)-&gt;get_angle());
+	}
+
+
+	if (type == 0) {
+		circlefill ( window-&gt;surface, 
+			window-&gt;x + x, 
+			window-&gt;y + y, 
+			radius,
+			color
+		);
+	}
+	else if (type == 1) {
+		line (  window-&gt;surface,
+			window-&gt;x + x, 
+			window-&gt;y + y,
+			window-&gt;x + x + cos(angle) * radius,
+			window-&gt;y + y + sin(angle) * radius,
+			color
+		);
+	}
+}
+
+void GobRadar::animate ( Frame * frame ) {
+	Query q;
+	if (!window-&gt;surface) return;
+
+	window-&gt;lock();
+
+	rectfill(window-&gt;surface, 
+		window-&gt;x, window-&gt;y, 
+		window-&gt;x + window-&gt;w,
+		window-&gt;y + window-&gt;h,
+		0
+		);
+	for (q.begin(0, 0, ALL_LAYERS, 999999999999);q.current;q.next()) {
+		if (!q.current-&gt;exists()) continue;
+		if (q.current-&gt;isInvisible())
+			continue;
+		animate_item(q.current);
+	}
+	q.end();
+
+	window-&gt;unlock();
+}
+
+GobRadar::GobRadar() {
+  STACKTRACE;
+	attributes &amp;= ~ATTRIB_SYNCHED;
+	team = 0;
+	gx = 0;
+	gy = 0;
+	gw = X_MAX;
+	gh = Y_MAX;
+	window = new VideoWindow();
+	window-&gt;preinit();
+}
+*/
+
+REGISTER_PRESENCE_CLASS(UnholyAura)

Copied: branches/multiplayer-branch/source/games/gup.h (from rev 81, branches/multiplayer-branch/source/other/gup.h)
===================================================================
--- branches/multiplayer-branch/source/other/gup.h	2004-10-16 21:23:27 UTC (rev 81)
+++ branches/multiplayer-branch/source/games/gup.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -0,0 +1,77 @@
+class Upgrade;
+extern Upgrade **upgrade_list;
+
+class UpgradeIndex {
+public:
+	enum {
+		crewpod,
+		battery,
+		thrusters,
+		controljets,
+		dynamo,
+		supoxrange,
+		supoxdamage,
+		supoxblade,
+		orzmissile,
+		orzmarinespeed,
+		orzabsorption,
+		kohrahbladedamage,
+		kohrahbladespeed,
+		kohrahfirerange,
+		kohrahfiredamage,
+		utwigrange,
+		utwigdamage,
+		utwigrof,
+		utwigmask1,
+		utwigmask2,
+		divinefavor,
+		unholyaura,
+		defender,
+		planetlocater,
+		hyperdynamo,
+		//gobradar,
+		//roswelldevice,
+		NULL_UPGRADE
+	};
+};
+
+class GobDefender : public SpaceObject {
+	public:
+	GobDefender ( Ship *ship);
+	double base_phase;
+	virtual void calculate();
+	int next_shoot_time;
+};
+
+/*class RoswellDevice : public Presence {
+	public:
+	RoswellDevice ( Ship *ship, double angle );
+	virtual void calculate();
+	int next_shoot_time;
+	double phase;
+};*/
+
+class UnholyAura : public Presence {
+public:
+	SpaceLocation *focus;
+	double angle;
+	virtual void calculate ();
+	virtual void animate ( Frame * frame);
+	UnholyAura ( SpaceLocation *ship );
+	UnholyAura() : focus(NULL) { } 
+	virtual char * GetClassName(void) const;
+	virtual unsigned GetClassID(void) const;
+};
+
+/*
+class GobRadar : public Presence {
+public:
+	TeamCode team;
+	double gx, gy, gw, gh;
+	VideoWindow *window;
+	//virtual void calculate ();
+	virtual void animate ( Frame * frame );
+	virtual void animate_item ( SpaceLocation *item);
+	GobRadar();
+};*/
+

Modified: branches/multiplayer-branch/source/gui.cpp
===================================================================
--- branches/multiplayer-branch/source/gui.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/gui.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: gui.cpp,v 1.2 2004/08/03 11:37:22 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/gui.h
===================================================================
--- branches/multiplayer-branch/source/gui.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/gui.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: gui.h,v 1.1.1.1 2004/08/01 10:21:18 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/id.h
===================================================================
--- branches/multiplayer-branch/source/id.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/id.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: id.h,v 1.1.1.1 2004/08/01 10:21:18 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/input.cpp
===================================================================
--- branches/multiplayer-branch/source/input.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/input.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: input.cpp,v 1.1.1.1 2004/08/01 10:21:19 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/input.h
===================================================================
--- branches/multiplayer-branch/source/input.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/input.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: input.h,v 1.1.1.1 2004/08/01 10:21:18 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/libraries/raknet/DistributedNetworkObjectHeader.h
===================================================================
--- branches/multiplayer-branch/source/libraries/raknet/DistributedNetworkObjectHeader.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/libraries/raknet/DistributedNetworkObjectHeader.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -480,4 +480,4 @@
 	SynchronizationMethod6##_INTERPOLATION_CODE(AuthoritativeNetwork6, VariableName6)	\
 }
 
-// Extend this pattern as many times as necessary.  If anyone figures out a way to automate a way to do that with the preprocessor let me know
\ No newline at end of file
+// Extend this pattern as many times as necessary.  If anyone figures out a way to automate a way to do that with the preprocessor let me know

Added: branches/multiplayer-branch/source/melee/MultiplayerTypes.h
===================================================================
--- branches/multiplayer-branch/source/melee/MultiplayerTypes.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/MultiplayerTypes.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -0,0 +1,73 @@
+/*
+This file is part of &quot;TW-Light&quot; 
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
+Copyright (C) 2001-2004  TimeWarp development team
+
+This program is free software; you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation; either version 2 of the License, or
+(at your option) any later version.
+
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+*/
+#ifndef MULTIPLAYER_TYPES_HEADER
+#define MULTIPLAYER_TYPES_HEADER
+
+#include &quot;frame.h&quot;
+#include &quot;../libraries/raknet/NetworkTypes.h&quot;
+// this header contains the catagories of network messages, usually of the form ID_*
+// if you're looking for them, there they be.  
+#include &quot;../libraries/raknet/PacketEnumerations.h&quot;
+
+#include &lt;vector&gt;
+using namespace std;
+
+// Holds enumeration data
+enum { MOTD_MAXIMUM_LENGTH=50 }; // Characters allocated for the message of the day, used for enumerations
+enum { SERVER_NAME_MAXIMUM_LENGTH=40 }; // Characters allocated for the server name
+
+/// Data on the server which is transmitted to all joining clients.  This data should change infrequently 
+/// (ie once per map/match, or when the game settings are changed)
+struct StaticServerDataStruct
+{
+	char MOTD[MOTD_MAXIMUM_LENGTH];  // (Message of the day) Optional, replace with whatever and/or add more fields
+	char serverName[SERVER_NAME_MAXIMUM_LENGTH];
+};
+
+enum{ SCDS_MAXIMUM_NAME_LENGTH=40 };
+
+/// Data on the client, which is automatically transmitted to the server and all other clients.  
+struct StaticClientDataStruct
+{
+	unsigned char typeId;  // ID_SET_CLIENT_DATA
+	char name[SCDS_MAXIMUM_NAME_LENGTH];
+};
+
+typedef vector&lt;PlayerID&gt; PlayerList;
+typedef PlayerList::iterator PlayerListIterator;
+
+enum {PT_UNKNOWN=0};
+
+#pragma pack(1)
+struct PresenceCreationDescription
+{
+    PresenceCreationDescription(ObjectID ObjectID, unsigned PresenceType) :
+       networkMessageTypeID(ID_PRESENCE_CREATION), 
+       objectId(ObjectID),
+       presenceType(PresenceType)
+    {
+    }
+    unsigned char useTimeStamp; // Assign this to ID_TIMESTAMP
+    unsigned long timeStamp; // Put the system time in here returned by timeGetTime() or some other method that returns a similar value
+    unsigned char networkMessageTypeID; 
+    ObjectID objectId;
+    
+    /// This is the type of Presence subclass which we are referring to.  
+    /// @see PresenceRegistry
+    unsigned presenceType;
+};
+
+#endif

Added: branches/multiplayer-branch/source/melee/PresenceRegistry.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/PresenceRegistry.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/PresenceRegistry.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -0,0 +1,166 @@
+/*
+This file is part of &quot;TW-Light&quot; 
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
+Copyright (C) 2001-2004  TimeWarp development team
+
+This program is free software; you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation; either version 2 of the License, or
+(at your option) any later version.
+
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+*/
+
+#include &lt;iostream&gt; 
+#include &quot;melee/mframe.h&quot;
+#include &quot;melee/MultiplayerTypes.h&quot;
+#include &lt;vector&gt;
+using namespace std;
+
+#include &quot;melee/PresenceRegistry.h&quot;
+
+PresenceRegistry presenceRegistry;
+
+PresenceRegistry::PresenceRegistry() : boo(0) {
+   cout &lt;&lt; &quot;PR Constructor&quot; &lt;&lt; endl;
+   cout.flush();
+   boo ++;
+}
+
+void PresenceRegistry::registerPresenceClass (const char * className, Presence * (*GetPresenceClassInstance)()) {
+	//cout &lt;&lt; &quot;register boo=&quot;&lt;&lt;presenceRegistry.boo&lt;&lt;endl;
+	
+    //Check to see if this class has already been added.
+    //If so, don't do anything.
+    vector &lt;PresenceClassDescription&gt;::iterator iter;
+    vector &lt;PresenceClassDescription&gt;::iterator iterEnd = presenceRegistry.presenceClassDescriptionList.end();
+    for (iter = presenceRegistry.presenceClassDescriptionList.begin();
+         iter != iterEnd;
+         ++iter)
+    {
+        if (strcmp(iter-&gt;className, className)==0)
+            return;
+    }
+    unsigned id = presenceRegistry.presenceClassDescriptionList.size() + 1;
+    PresenceClassDescription pcd(className,
+        id,
+        GetPresenceClassInstance);
+    presenceRegistry.presenceClassDescriptionList.push_back(pcd);
+    
+//    cout &lt;&lt; &quot;registering PresenceClass ( &quot; &lt;&lt; className &lt;&lt; &quot;,&quot; 
+//    	 &lt;&lt; id &lt;&lt; &quot;) as (&quot; &lt;&lt; presenceRegistry.getClassName(id) &lt;&lt; &quot;,&quot; &lt;&lt; presenceRegistry.getClassID(className) &lt;&lt;&quot;)&quot;&lt;&lt; endl;
+//    cout.flush();
+}
+
+///
+Presence * PresenceRegistry::GetPresenceClassDefaultInstance(const unsigned classID) {
+    PresenceClassDescription * desc = presenceRegistry.getPresenceItem(classID);
+    if (desc)
+    	return desc-&gt;getPresenceClassInstance();
+    
+    return NULL;
+}
+
+///
+Presence * PresenceRegistry::GetPresenceClassDefaultInstance(const char * className) { 
+	PresenceClassDescription * pcd = presenceRegistry.getPresenceItem(className);
+	if (pcd)
+	   return pcd-&gt;getPresenceClassInstance();
+	return NULL;
+}
+
+
+/*Presence * PresenceRegistry::createPresenceFromNetworkDescription(PresenceCreationDescription * info) 
+{
+	assert(info);
+	if (info==NULL) {
+		tw_error(&quot;PresenceRegistry::createPresenceFromNetworkDescription got a NULL pointer&quot;);
+		return NULL;
+	}
+	
+	PresenceClassDescription * pcd = getPresenceItem(info-&gt;presenceType);
+	if (pcd) {
+		Presence * presence = pcd-&gt;getPresenceClassInstance();
+		presence-&gt;updatePresenceObjectFromNetworkDescription(info);
+		return presence;
+	}
+    return NULL;
+}*/
+
+const unsigned PresenceRegistry::getClassID(const char * className) {
+	PresenceClassDescription * pcd = presenceRegistry.getPresenceItem(className);
+	if (pcd)
+		return pcd-&gt;classID;
+	return 0;	
+}
+
+const char * PresenceRegistry::getClassName( const unsigned classID ) {
+	PresenceClassDescription * pcd = presenceRegistry.getPresenceItem(classID);
+	if (pcd)
+		return pcd-&gt;className;
+	return &quot;&quot;;
+}
+
+PresenceClassDescription * PresenceRegistry::getPresenceItem(const unsigned classID) 
+{
+//	cout &lt;&lt; &quot;checking for ClassID &quot; &lt;&lt; classID &lt;&lt; &quot; list.size&quot; &lt;&lt; presenceClassDescriptionList.size();
+    vector &lt;PresenceClassDescription&gt;::iterator iter = presenceRegistry.presenceClassDescriptionList.begin();
+    vector &lt;PresenceClassDescription&gt;::iterator iterEnd = presenceRegistry.presenceClassDescriptionList.end();
+    for ( ;
+         iter != iterEnd;
+         ++iter)
+    {
+        if (iter-&gt;classID == classID) {
+//        	cout &lt;&lt; &quot; found as &quot; &lt;&lt; iter-&gt;classID &lt;&lt;endl;
+        	cout.flush();
+            return &amp;(*iter);
+        }
+    }
+//    cout &lt;&lt; &quot;not found!&quot; &lt;&lt;endl;
+//    cout.flush();
+    return NULL;
+}
+
+PresenceClassDescription * PresenceRegistry::getPresenceItem(const char * className) 
+{
+//	cout &lt;&lt; &quot;checking for Classname &quot; &lt;&lt; className &lt;&lt; &quot; list.size=&quot; &lt;&lt; presenceClassDescriptionList.size();
+    vector &lt;PresenceClassDescription&gt;::iterator iter = presenceRegistry.presenceClassDescriptionList.begin();
+    vector &lt;PresenceClassDescription&gt;::iterator iterEnd = presenceRegistry.presenceClassDescriptionList.end();
+    for ( ;
+         iter != iterEnd;
+         ++iter)
+    {
+        if (strcmp(iter-&gt;className, className)==0) {
+//        	cout &lt;&lt; &quot; found as &quot; &lt;&lt; iter-&gt;classID &lt;&lt; endl;
+//        	cout.flush();
+            return &amp;(*iter);
+        }
+    }
+//    cout &lt;&lt; &quot;not found!&quot; &lt;&lt; endl;
+    //cout.flush();
+    return NULL;
+}
+
+PresenceRegistry * PresenceRegistry::GetInstance() { 
+	//cout &lt;&lt; &quot;GetInstance:list size=&quot; &lt;&lt; presenceRegistry.presenceClassDescriptionList.size() &lt;&lt; endl;
+	cout.flush();
+    return (PresenceRegistry *)&presenceRegistry; 
+}
+
+void PresenceRegistry::toString() {
+//	cout &lt;&lt; &quot;to string  boo(PR)=&quot;&lt;&lt;presenceRegistry.boo&lt;&lt; &quot; boo(this)=&quot;&lt;&lt;boo &lt;&lt;endl;
+
+	//printf(&quot;PresenceRegistry:size=%d\n&quot;, presenceRegistry-&gt;presenceClassDescriptionList.size());
+	
+}
+
+//static void testtesttest(void) {
+//	cout &lt;&lt; &quot;in testtesttest&quot; &lt;&lt; endl;
+//	cout.flush();
+//	presenceRegistry = new PresenceRegistry();
+//	//PresenceRegistry::GetInstance()-&gt;toString();
+//}
+//CALL_BEFORE_MAIN(testtesttest);

Added: branches/multiplayer-branch/source/melee/PresenceRegistry.h
===================================================================
--- branches/multiplayer-branch/source/melee/PresenceRegistry.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/PresenceRegistry.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -0,0 +1,168 @@
+/*
+This file is part of &quot;TW-Light&quot; 
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
+Copyright (C) 2001-2004  TimeWarp development team
+
+This program is free software; you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation; either version 2 of the License, or
+(at your option) any later version.
+
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+*/
+
+#ifndef PRESENCE_REGISTRY_HEADER
+#define PRESENCE_REGISTRY_HEADER
+
+#include &quot;melee/mframe.h&quot;
+#include &quot;melee/MultiplayerTypes.h&quot;
+#include &lt;vector&gt;
+#include &lt;string&gt;
+using namespace std;
+
+class Presence;
+
+class PresenceRegistry;
+
+/// global instance
+extern PresenceRegistry presenceRegistry;
+
+/// Describes a Presence subclass.  Contains a class name, and classID,
+/// which is set at compile-time.  Each Presence subclass must have a unique 
+/// classID
+struct PresenceClassDescription {
+    PresenceClassDescription(const char * ClassName, 
+                             unsigned classID, 
+                             Presence * GetPresenceClassInstance()) :
+        className(ClassName),
+        classID(classID),
+        getPresenceClassInstance(GetPresenceClassInstance)
+    { 
+    }
+    const char * className;
+    unsigned classID;
+    Presence * (*getPresenceClassInstance)();
+};
+
+    
+///Every Presence subclass must register using this class, so that the Presence
+///class can created and syncronized across the network.  You should use the macro
+///REGISTER_PRESENCE_CLASS( class )
+///exactly once to make the Presence subclass available on the network.  Like so:
+///
+///#include &quot;melee/PresenceRegistry.h&quot;
+///...
+///class MyPresenceClass : public Presence {
+///  ...
+///}
+///...
+///REGISTER_PRESENCE_CLASS(MyPresenceClass);
+///
+/// @see registerPresenceClass
+class PresenceRegistry {
+public:
+    PresenceRegistry();
+    ~PresenceRegistry() { }
+    
+    ///Registers a Presence subclass.  
+    /// @param className the name of the class to register.
+    static void registerPresenceClass (const char * className, Presence * (*GetPresenceClassInstance)());
+    
+    ///
+    Presence * GetPresenceClassDefaultInstance(const unsigned ClassID);
+    
+    ///
+    Presence * GetPresenceClassDefaultInstance(const char * className);
+    
+    ///
+    ///    
+    //Presence * createPresenceFromNetworkDescription(PresenceCreationDescription * info);
+    
+    ///Returns the class ID associated with this Presence subclass.
+    /// @param className the class name to check up on.
+    /// @return 0 if the class has not been registered, otherwise returns unique, positive class ID
+    //unsigned _getclassID(const char * className);
+    
+    ///Returns the class ID associated with this Presence subclass.
+    /// @param className the class name to check up on.
+    /// @return 0 if the class has not been registered, otherwise returns unique, positive class ID
+    const unsigned getClassID(const char * className);
+    
+    ///
+    const char * getClassName( const unsigned classID );
+    
+    ///
+    static PresenceRegistry * GetInstance();
+    void toString();
+
+protected:
+	///
+	PresenceClassDescription * getPresenceItem(const unsigned classID);
+	///
+    PresenceClassDescription * getPresenceItem(const char * className);
+private:
+    ///
+    vector &lt;PresenceClassDescription&gt; presenceClassDescriptionList;
+    int boo;
+    
+};
+
+///This macro must be called once for every subclass of Presence.  It make the
+///subclass available in network code.  Note that the subclass has two requirements:
+///- it must have a no-argument constructor
+///- it must declare, but not implement, 
+/// virtual char * MyPresenceClass::GetClassName(void) const;
+///
+///Call this macro like this:
+///
+/// (in your header file)
+///
+///class MyPresenceClass : public Presence {
+///public:
+///  MyPresenceClass() {...}
+///  virtual char * PRESENCE_CLASS::GetClassName(void) const;
+///  ...
+///}
+///
+/// (at the end of your .cpp file)
+///
+///REGISTER_PRESENCE_CLASS(MyPresenceClass);
+/// @param PRESENCE_CLASS the class to register.
+///
+#define REGISTER_PRESENCE_CLASS(PRESENCE_CLASS) \
+char * PRESENCE_CLASS::GetClassName(void) const { return # PRESENCE_CLASS ; } \
+unsigned PRESENCE_CLASS::GetClassID(void) const { return PresenceRegistry::GetInstance()-&gt;getClassID(# PRESENCE_CLASS) ; } \
+static Presence * GetDefaultInstance ## PRESENCE_CLASS () { return new PRESENCE_CLASS(); } \
+static void registerBeforeMain ## PRESENCE_CLASS (void) { \
+  PresenceRegistry::GetInstance()-&gt;registerPresenceClass( # PRESENCE_CLASS ,  GetDefaultInstance ## PRESENCE_CLASS ); \
+  REGISTER_DISTRIBUTED_CLASS(PRESENCE_CLASS); \
+} \
+CALL_BEFORE_MAIN(registerBeforeMain ## PRESENCE_CLASS );
+
+///
+///
+#define REGISTER_PRESENCE_CLASS_NO_NETWORK(PRESENCE_CLASS) \
+char * PRESENCE_CLASS::GetClassName(void) const { return # PRESENCE_CLASS ; } \
+unsigned PRESENCE_CLASS::GetClassID(void) const { return PresenceRegistry::GetInstance()-&gt;getClassID(# PRESENCE_CLASS) ; } \
+static void registerBeforeMainNoNetwork ## PRESENCE_CLASS (void) { \
+  PresenceRegistry::GetInstance()-&gt;registerPresenceClass( # PRESENCE_CLASS ); \
+} \
+CALL_BEFORE_MAIN(registerBeforeMainNoNetwork ## PRESENCE_CLASS );
+
+
+
+
+
+
+
+/*
+void register_shipclass (const char *name, const char *source_name, Ship *(*getShip)(Vector2 pos, double a, ShipData *data, unsigned int code));
+#define REGISTER_SHIP_EX(ship,func) static void __register_ship_ex ## ship ## _ ## func () { register_ship( ship, __FILE__, func);} CALL_BEFORE_MAIN(__register_shipclass_ex ## ship ## _ ## func);
+#define REGISTER_SHIP(ship) static Ship *get_shipclass_ ## ship (Vector2 pos, double a, ShipData *d, unsigned int c){return(new ship(pos,a,d,c));} static void __register_shipclass_ ## ship () {register_shipclass(#ship, __FILE__, &amp;get_shipclass_ ## ship);} CALL_BEFORE_MAIN(__register_shipclass_ ## ship);
+*/
+
+
+#endif

Modified: branches/multiplayer-branch/source/melee/manim.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/manim.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/manim.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: manim.cpp,v 1.1.1.1 2004/08/01 10:21:23 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/melee/manim.h
===================================================================
--- branches/multiplayer-branch/source/melee/manim.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/manim.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: manim.h,v 1.2 2004/08/07 12:33:53 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/melee/mcbodies.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mcbodies.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mcbodies.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: mcbodies.cpp,v 1.2 2004/08/07 12:33:53 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -467,3 +467,7 @@
     }
   return;
 }
+
+REGISTER_PRESENCE_CLASS(Stars);
+REGISTER_PRESENCE_CLASS(Planet);
+REGISTER_PRESENCE_CLASS(Asteroid);

Modified: branches/multiplayer-branch/source/melee/mcbodies.h
===================================================================
--- branches/multiplayer-branch/source/melee/mcbodies.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mcbodies.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: mcbodies.h,v 1.2 2004/08/07 12:33:53 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -20,6 +20,7 @@
 
 #include &quot;melee.h&quot;
 #include &quot;mframe.h&quot;
+#include &quot;melee/PresenceRegistry.h&quot;
 
 /// \brief Asteroid space object
 class Asteroid : public SpaceObject {
@@ -32,6 +33,8 @@
 	public:
 	/// \brief init various stuff, pic, speed etc
 	Asteroid();
+	virtual char * GetClassName(void) const;
+	virtual unsigned GetClassID(void) const;
 
 	/// \brief rotate
 	virtual void calculate();
@@ -55,6 +58,9 @@
 	/// Set collide flag, set layer, set mass to very huge, 
 	/// read from server.ini planet attributes
 	Planet(Vector2 location, SpaceSprite *sprite, int index);
+	Planet() { }
+	virtual char * GetClassName(void) const;
+	virtual unsigned GetClassID(void) const;
 	
 	/// \brief inflict damage when collide
 	///
@@ -68,9 +74,12 @@
 /// \brief Background stars
 class Stars : public Presence {
 	virtual void _event( Event *e);
-	public:
+public:
 	Stars();
 	~Stars();
+	virtual char * GetClassName(void) const;
+	virtual unsigned GetClassID(void) const;
+	
 	SpaceSprite **pic;
 	double width;
 	double height;
@@ -84,6 +93,9 @@
 	void animate(Frame *space);
 	void select_view( View **view);
 	View **v;
+	
+	REGISTER_1_DISTRIBUTED_OBJECT_MEMBERS(Presence,
+		DOM_COPY_COMPRESSED, DOM_CLIENT_AUTHORITATIVE, int, num_stars)
 };
 
 /// \brief helpers for drawing your own starfields

Modified: branches/multiplayer-branch/source/melee/mcontrol.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mcontrol.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mcontrol.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: mcontrol.cpp,v 1.2 2004/08/03 11:37:22 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -375,3 +375,4 @@
   animate_target(space, target, (i%3)*2-2, ((i/3)%3)*2-2, 140 + i, pallete_color[col]);
 }
 
+//REGISTER_PRESENCE_CLASS_NO_NETWORK(Control);

Modified: branches/multiplayer-branch/source/melee/mcontrol.h
===================================================================
--- branches/multiplayer-branch/source/melee/mcontrol.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mcontrol.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: mcontrol.h,v 1.2 2004/08/03 11:37:23 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -37,6 +37,9 @@
 
 class Control : public Presence {	
 	public:
+		Control() { }
+		virtual char * GetClassName(void) const { return &quot;Control&quot;; }
+		virtual unsigned GetClassID(void) const { return 0; }
 
   /*! \brief  controls CANNOT arbitrarily be killed off, because the deal with networking directly */
   virtual bool die(); 

Modified: branches/multiplayer-branch/source/melee/mfleet.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mfleet.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mfleet.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: mfleet.cpp,v 1.3 2004/08/08 17:36:05 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/melee/mfleet.h
===================================================================
--- branches/multiplayer-branch/source/melee/mfleet.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mfleet.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: mfleet.h,v 1.1.1.1 2004/08/01 10:21:22 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/melee/mframe.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mframe.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mframe.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: mframe.cpp,v 1.1.1.1 2004/08/01 10:21:23 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -39,9 +39,16 @@
 #include &quot;util/pmask.h&quot;
 #include &quot;other/twconfig.h&quot;
 #include &quot;scp.h&quot;
+    
+#include &quot;melee/MultiplayerTypes.h&quot;
+#include &quot;melee/PresenceRegistry.h&quot;
 
+#include &lt;iostream&gt;
+	
 int total_presences;
 
+
+
 #define DEATH_FRAMES 4
 //setting this too low will cause crashes
 //setting it too high will waste CPU power and RAM
@@ -73,6 +80,7 @@
 double MAX_SPEED = 0;
 
 
+
 void Query::begin (SpaceLocation *qtarget, int qlayers, double qrange) {STACKTRACE
 	if (qrange &lt; 0) {tw_error(&quot;Query::begin - negative range&quot;);}
 	layers = qlayers;
@@ -300,7 +308,8 @@
 	}
 
 
-Presence::Presence() {
+Presence::Presence()
+{
   STACKTRACE;
 	total_presences += 1;
 	attributes = 0;
@@ -309,6 +318,8 @@
 	id = 0;
 	_depth = 0;
 	set_depth(DEPTH_PRESENCE);
+    
+    presenceType = PT_UNKNOWN;
 	}
 
 void Presence::animate(Frame *space) {
@@ -319,6 +330,9 @@
 void Presence::calculate() 
 {
   STACKTRACE;
+  //cout &lt;&lt; &quot;Presence::Calcuate: my class name is (&quot; &lt;&lt; this-&gt;GetClassName() &lt;&lt; &quot;:&quot;&lt;&lt;this-&gt;GetClassID()&lt;&lt;&quot;)&quot;&lt;&lt; endl;
+  //cout.flush();
+  this-&gt;UpdateDistributedObject(this-&gt;GetClassName());
 }
 bool Presence::die() 
 {
@@ -1389,3 +1403,9 @@
       ship_died((Ship*)who, source);
     }
 }
+
+REGISTER_PRESENCE_CLASS(SpaceLocation);
+REGISTER_PRESENCE_CLASS(SpaceObject);
+REGISTER_PRESENCE_CLASS(SpaceLine);
+
+

Modified: branches/multiplayer-branch/source/melee/mframe.h
===================================================================
--- branches/multiplayer-branch/source/melee/mframe.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mframe.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: mframe.h,v 1.2 2004/08/07 12:33:53 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -21,6 +21,22 @@
 #include &lt;list&gt;
 #include &lt;vector&gt;
 
+#include &quot;libraries/raknet/DistributedNetworkObjectHeader.h&quot;
+#include &quot;libraries/raknet/NetworkObject.h&quot;
+#include &quot;libraries/raknet/RakServerInterface.h&quot;
+#include &quot;libraries/raknet/RakClientInterface.h&quot;
+#include &quot;libraries/raknet/RakNetworkFactory.h&quot;
+#include &quot;libraries/raknet/BitStream.h&quot;
+
+#include &quot;melee/MultiplayerTypes.h&quot;
+#include &quot;melee/PresenceRegistry.h&quot;
+//#include &quot;melee/mview.h&quot; // for message
+
+
+#include &lt;vector&gt;
+using namespace std;
+    
+    
 //debuging purposes only:
 extern int total_presences;
 
@@ -64,7 +80,7 @@
 };
 
 /// \brief melee universe
-class Physics : public BaseClass 
+class Physics : public BaseClass
 {
  public:
   
@@ -76,13 +92,13 @@
   std::list&lt;Presence*&gt; presence;
   
   /// add space location to universe
-  void add(SpaceLocation *p);
+  virtual void add(SpaceLocation *p);
   /// add presence from universe
-  void add(Presence *p);
+  virtual void add(Presence *p);
   /// remove space location to universe
-  bool remove(SpaceLocation *o);
+  virtual bool remove(SpaceLocation *o);
   /// remove presence from universe
-  bool remove(Presence *p) ;
+  virtual bool remove(Presence *p) ;
   
   TeamCode last_team;
   unsigned int last_ship;
@@ -94,7 +110,7 @@
  public:
   virtual unsigned int new_ship();
   virtual TeamCode new_team();
-  unsigned int get_code(unsigned int ship, TeamCode team) ;
+  virtual unsigned int get_code(unsigned int ship, TeamCode team) ;
   /// \brief causes team1 and team2 to be the same team (changes members of team2 to 
   /// being members of team1 instead)
   virtual void merge_teams ( TeamCode team1, TeamCode team2) ; 
@@ -134,7 +150,7 @@
 };
 
 /// \brief Any item in the game
-class Presence : public BaseClass 
+class Presence : public BaseClass, public DistributedNetworkObject
 { 
   friend class Physics;
  public:
@@ -171,14 +187,106 @@
   bool isShip() const ;      ///&lt; returns true if it is the specified engine-defined type
   bool isShot() const;       ///&lt; returns true if it is the specified engine-defined type
   bool isSynched() const;    ///&lt; returns true if it is the specified engine-defined type
+
+  /// Gets the ID to refer to this object.  Used by the Raknet API to refer to objects
+  /// across multiple computers.
+  // @return the assigned ID.
+  virtual unsigned short GetObjectID(void) const { return NetworkObject::GetID(); }
   
+  /// Sets the ID to refer to this object.  Used by the Raknet API to refer to objects
+  /// Only the server code should call this!
+  /// @param id the ID to use.
+  virtual void SetObjectID(unsigned short id) { NetworkObject::SetID(id); }
+
+  /// Gets the ID to refer to this class.  
+  // @return the assigned class ID.
+  virtual unsigned GetClassID(void) const = 0;
+  
+  /// Gets the class name to refer to this class.  
+  // @return the assigned class ID.
+  virtual char * GetClassName(void) const = 0;
+  
+  
+  //Creates and returns an instance of this class.
+  //There's no need to code this yourself, instead, use the 
+  //REGISTER_PRESENCE_CLASS( yourClassName ) macro, which is defined in
+  //PresenceRegistry.
+  //@return an instance of this class, with default values
+  //@see PresenceRegistry
+  //static Presence * GetDefaultInstance(void);
+  
+  // Overload this to show a message
+  /*bool OnDistributedObjectCreation(PlayerID senderID)
+  {
+  	//message.print(5000,15,&quot;Object Created\n&quot;);
+  	return true; // Allow object creation by returning true
+  }
+
+  // Overload this to show a message
+  void OnDistributedObjectDestruction(PlayerID senderID)
+  {
+  	//message.print(5000,15,&quot;Object Destroyed\n&quot;);
+  	delete this;
+  }*/
+  
+  
+  /// Sets the ID to refer to this object.  Used by the Raknet API to refer to objects
+  /// Only the server code should call this!
+  /// @param id the ID to use.
+  //virtual void SetObjectID(unsigned short id) { NetworkObject::SetID(id); }
+
+  /// Gets a complete description of this Presence object, suitable for creating the object
+  /// over the network.  This is not used to duplicate an object, rather it's to create 
+  /// one from scratch.  Every conceivable variable to create the object should appear within 
+  /// this description object.
+  /// @param pcd The PresenceCreationDescription object to populate with data which exactly
+  /// coresponds to the data from this Presence object.  It's passed-by-reference.
+  
+  
+  ///
+//  virtual PresenceCreationDescription * getNetworkDescription() {
+//      PresenceCreationDescription * pcd = new PresenceCreationDescription(
+//          GetObjectID(),
+//          GetClassID()
+//      );
+//      printf(&quot;getNetworkDescription: objectID=%d ClassID=%d&quot;, GetObjectID(), GetClassID());
+//      
+//      return pcd;
+//  }
+//  
+//  virtual void updatePresenceObjectFromNetworkDescription(PresenceCreationDescription * info) {
+//      
+//  }
+  
+protected:
+  unsigned presenceType;
+  
+//  struct ClassName {
+//  	  char name[50];
+//  };
+  
+//  ClassName className;
+//  static char * typename;
+
+	REGISTER_1_DISTRIBUTED_OBJECT_MEMBERS(DistributedNetworkObject,
+		DOM_COPY_COMPRESSED, DOM_CLIENT_AUTHORITATIVE, unsigned, presenceType)
+
+public:		
 };
+//REGISTER_PRESENCE_CLASS(Presence);
 
+
+
+
 /// \brief any item in the game that has a location, base class for all items in game
 class SpaceLocation : public Presence 
 { 
   friend class Physics;
   friend struct Query;
+public: 
+  SpaceLocation() { }
+  virtual char * GetClassName(void) const;
+	virtual unsigned GetClassID(void) const;
 
  protected: public: 
   //aught to be protected, but we're lazy
@@ -291,12 +399,21 @@
   virtual void animate(Frame *space); 
   /// advance the item frame_time milliseconds in time
   virtual void calculate(); 
+  
+  REGISTER_2_DISTRIBUTED_OBJECT_MEMBERS(Presence,
+  	DOM_COPY_UNCOMPRESSED, DOM_CLIENT_AUTHORITATIVE, Vector2, vel,
+  	DOM_COPY_COMPRESSED, DOM_CLIENT_AUTHORITATIVE, double, angle)
 };
 
+
+
 /// \brief any item with a sprite (only SpaceObjects can bounce)
 class SpaceObject : public SpaceLocation 
 {
  public:
+  SpaceObject() { }
+  virtual char * GetClassName(void) const;
+  virtual unsigned GetClassID(void) const;
   Vector2 size; ///&lt; size of sprite
   double  mass; ///&lt; mass of object
   bool isblockingweapons; ///&lt; this object blocks weaponry (shots)
@@ -322,11 +439,18 @@
   virtual void inflict_damage(SpaceObject *other);
   
   virtual void set_sprite ( SpaceSprite *sprite );
+  
 };
 
+
 /// an item that appears as a line.  these can only collide with SpaceObjects, but not other lines.  
 class SpaceLine : public SpaceLocation 
 {
+ public:
+  SpaceLine(){ }
+  virtual char * GetClassName(void) const;
+  virtual unsigned GetClassID(void) const;
+  
  protected:
   double length;
   int    color;
@@ -343,8 +467,10 @@
   virtual void animate(Frame *space);
   virtual void collide(SpaceObject *o);
   virtual void inflict_damage(SpaceObject *other);
+  
 };
 
+
 struct Query 
 {
   private:

Modified: branches/multiplayer-branch/source/melee/mgame.h
===================================================================
--- branches/multiplayer-branch/source/melee/mgame.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mgame.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: mgame.h,v 1.1.1.1 2004/08/01 10:21:22 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/melee/mhelpers.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mhelpers.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mhelpers.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: mhelpers.cpp,v 1.2 2004/08/03 11:37:23 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/melee/mitems.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mitems.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mitems.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: mitems.cpp,v 1.1.1.1 2004/08/01 10:21:22 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -265,3 +265,10 @@
 	vel.y = va * sin(angle) - vb * cos(angle);
 	return;
 	}
+
+//REGISTER_PRESENCE_CLASS(Indicator);
+REGISTER_PRESENCE_CLASS(HealthBar);
+REGISTER_PRESENCE_CLASS(BlinkyIndicator);
+REGISTER_PRESENCE_CLASS(WedgeIndicator);
+REGISTER_PRESENCE_CLASS(Orbiter);
+

Modified: branches/multiplayer-branch/source/melee/mitems.h
===================================================================
--- branches/multiplayer-branch/source/melee/mitems.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mitems.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: mitems.h,v 1.1.1.1 2004/08/01 10:21:23 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -23,6 +23,9 @@
 	Ship	*mother;
 
 	HealthBar(Ship *creator, int *toggle);
+	HealthBar() { }
+	virtual char * GetClassName(void) const;
+	virtual unsigned GetClassID(void) const;
 	void calculate();
 	void animate(Frame *space );
 
@@ -32,6 +35,8 @@
 class Indicator : public Presence {
 	public:
 	Indicator();
+	virtual char * GetClassName(void) const { return &quot;Indicator&quot;; }
+	virtual unsigned GetClassID(void) const { return 0; }
 	bool coords(Frame *space, SpaceLocation *l, Vector2 *pos, Vector2 *apos = NULL) ;
 	void animate(Frame *space) = 0;
 	};
@@ -41,6 +46,9 @@
 	SpaceObject *target;
 	int color;
 	BlinkyIndicator(SpaceObject *target, int color = -1);
+	BlinkyIndicator(): target(NULL), color(-1) { }
+	virtual char * GetClassName(void) const;
+	virtual unsigned GetClassID(void) const;
 	virtual void animate(Frame *space);
 	virtual void calculate();
 	};
@@ -51,6 +59,9 @@
 	int color;
 	int length;
 	WedgeIndicator(SpaceLocation *target, int length, int color);
+	WedgeIndicator() : target(NULL), color(15), length(0) { }
+	virtual char * GetClassName(void) const;
+	virtual unsigned GetClassID(void) const;
 	virtual void animate(Frame *space);
 	virtual void calculate();
 	};
@@ -61,4 +72,7 @@
 	double radius;
 	virtual void calculate();
 	Orbiter ( SpaceSprite *sprite, SpaceLocation *orbit, double distance);
+	Orbiter () : center(NULL), radius(0) { }
+	virtual char * GetClassName(void) const;
+	virtual unsigned GetClassID(void) const;
 };

Modified: branches/multiplayer-branch/source/melee/mlog.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mlog.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mlog.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: mlog.cpp,v 1.2 2004/08/03 07:08:55 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/melee/mlog.h
===================================================================
--- branches/multiplayer-branch/source/melee/mlog.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mlog.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: mlog.h,v 1.1.1.1 2004/08/01 10:21:23 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/melee/mmath.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mmath.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mmath.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: mmath.cpp,v 1.2 2004/08/05 21:06:38 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/melee/mnet1.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mnet1.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mnet1.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: mnet1.cpp,v 1.2 2004/08/03 07:08:55 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/melee/mnet1.h
===================================================================
--- branches/multiplayer-branch/source/melee/mnet1.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mnet1.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: mnet1.h,v 1.2 2004/08/03 07:08:55 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/melee/moptions.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/moptions.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/moptions.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: moptions.cpp,v 1.3 2004/08/03 11:37:23 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/melee/moptions.h
===================================================================
--- branches/multiplayer-branch/source/melee/moptions.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/moptions.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: moptions.h,v 1.1 2004/08/03 22:17:54 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/melee/mship.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mship.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mship.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -403,7 +403,10 @@
 
 Ship::~Ship() 
 {
-  delete spritePanel;
+  if (spritePanel) {
+     delete spritePanel;
+     spritePanel = NULL;
+  }
 }
 
 double Ship::getCrew()
@@ -988,3 +991,11 @@
 		PHASE_DELAY, PHASE_MAX, PHASE_DELAY
 	);
 }
+
+REGISTER_PRESENCE_CLASS(Ship)
+REGISTER_PRESENCE_CLASS(Shot)
+REGISTER_PRESENCE_CLASS(AnimatedShot)
+REGISTER_PRESENCE_CLASS(Missile)
+REGISTER_PRESENCE_CLASS(HomingMissile)
+REGISTER_PRESENCE_CLASS(Laser)
+REGISTER_PRESENCE_CLASS(PointLaser)

Modified: branches/multiplayer-branch/source/melee/mship.h
===================================================================
--- branches/multiplayer-branch/source/melee/mship.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mship.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: mship.h,v 1.2 2004/08/07 12:33:54 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -80,6 +80,11 @@
 /// \brief Exactly what is sounds like
 class Ship : public SpaceObject 
 {
+public:
+	Ship() { }
+	virtual char * GetClassName(void) const;
+	virtual unsigned GetClassID(void) const;
+	
  protected:
   
   int hotspot_frame;

Modified: branches/multiplayer-branch/source/melee/mshot.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mshot.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mshot.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: mshot.cpp,v 1.1.1.1 2004/08/01 10:21:23 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/melee/mshot.h
===================================================================
--- branches/multiplayer-branch/source/melee/mshot.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mshot.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: mshot.h,v 1.2 2004/08/07 12:33:54 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -35,8 +35,11 @@
   int          explosionFrameCount;
   int          explosionFrameSize;
   
+  Shot() { }
   Shot(SpaceLocation *creator, Vector2 rpos, double oangle, double ov, double odamage,
        double orange, double oarmour, SpaceLocation *opos, SpaceSprite *osprite, double relativity = game-&gt;shot_relativity);
+  virtual char * GetClassName(void) const;
+	virtual unsigned GetClassID(void) const;
   
   virtual void animate(Frame *space);
   
@@ -67,6 +70,9 @@
   AnimatedShot(SpaceLocation *creator, Vector2 rpos, double oangle, 
 	       double ov, double odamage, double orange, double oarmour, SpaceLocation *opos,
 	       SpaceSprite *osprite, int ofcount, int ofsize, double relativity = game-&gt;shot_relativity);
+  AnimatedShot() { }
+  virtual char * GetClassName(void) const;
+	virtual unsigned GetClassID(void) const;
   
   virtual void calculate();
 };
@@ -74,9 +80,12 @@
 /// \brief A shot that uses an image depending upon which angle it's pointing
 class Missile : public Shot {
 	public:
+	Missile() {}
 	Missile(SpaceLocation *creator, Vector2 rpos, double oangle, double ov, double odamage,
 			double orange, double oarmour, SpaceLocation *opos,
 			SpaceSprite *osprite, double relativity = game-&gt;shot_relativity);
+	virtual char * GetClassName(void) const;
+	virtual unsigned GetClassID(void) const;
 
 	virtual void changeDirection(double oangle);
 	};
@@ -88,9 +97,12 @@
 	double turn_step;
 
 	public:
+	HomingMissile() { }
 	HomingMissile(SpaceLocation *creator, Vector2 rpos, double oangle, double ov, double odamage,
 			double orange, double oarmour, double otrate, SpaceLocation *opos,
 			SpaceSprite *osprite, SpaceObject *target);
+	virtual char * GetClassName(void) const;
+	virtual unsigned GetClassID(void) const;
 
 	virtual void animate(Frame *space);
 	virtual void calculate();
@@ -109,6 +121,9 @@
 	public:
 	Laser(SpaceLocation *creator, double langle, int lcolor, double lrange, double ldamage, int lfcount,
 		SpaceLocation *opos, Vector2 rpos = Vector2(0,0), bool osinc_angle=false);
+	Laser() { }
+	virtual char * GetClassName(void) const;
+	virtual unsigned GetClassID(void) const;
 
 	void calculate();
 };
@@ -119,8 +134,11 @@
   SpaceObject *target;
 
   public:
+  	PointLaser() { }
 	PointLaser(SpaceLocation *creator, int lcolor, double ldamage, int lfcount, 
 		SpaceLocation *lsource, SpaceObject *ltarget, Vector2 rel_pos = Vector2(0,0)) ;
+	virtual char * GetClassName(void) const;
+	virtual unsigned GetClassID(void) const;
 
   void calculate();
   int canCollide(SpaceObject *other);

Modified: branches/multiplayer-branch/source/melee/mshpdata.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mshpdata.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mshpdata.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: mshpdata.cpp,v 1.3 2004/08/07 07:48:50 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/melee/mshppan.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mshppan.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mshppan.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: mshppan.cpp,v 1.1.1.1 2004/08/01 10:21:23 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -75,8 +75,10 @@
 
 ShipPanel::~ShipPanel()
 {STACKTRACE
-  destroy_bitmap(captain);
-  destroy_bitmap(panel);
+  if (captain)
+  	destroy_bitmap(captain);
+  if (panel) 
+  	destroy_bitmap(panel);
   window-&gt;deinit();
   delete window;
 }
@@ -385,3 +387,4 @@
 	return;
 }
 
+REGISTER_PRESENCE_CLASS(ShipPanel);

Modified: branches/multiplayer-branch/source/melee/mshppan.h
===================================================================
--- branches/multiplayer-branch/source/melee/mshppan.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mshppan.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: mshppan.h,v 1.1.1.1 2004/08/01 10:21:23 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -59,7 +59,10 @@
 	int always_redraw;
 
 	ShipPanel(Ship *oship);
+	ShipPanel() : ship(NULL) { }
 	virtual ~ShipPanel();
+	virtual char * GetClassName(void) const;
+	virtual unsigned GetClassID(void) const;
 
 	virtual void draw_stuff(int x, int y, int w, int h, int dx, int dy, int m, int value, int max, int color, int bcolor);
 	//used for drawing crew &amp; battery bars

Modified: branches/multiplayer-branch/source/melee/msprite.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/msprite.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/msprite.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: msprite.cpp,v 1.1.1.1 2004/08/01 10:21:23 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/melee/mtarget.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mtarget.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mtarget.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: mtarget.cpp,v 1.1.1.1 2004/08/01 10:21:23 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/melee/mtarget.h
===================================================================
--- branches/multiplayer-branch/source/melee/mtarget.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mtarget.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: mtarget.h,v 1.1.1.1 2004/08/01 10:21:22 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/melee/mview.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mview.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mview.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: mview.cpp,v 1.1.1.1 2004/08/01 10:21:22 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/melee/mview.h
===================================================================
--- branches/multiplayer-branch/source/melee/mview.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee/mview.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: mview.h,v 1.2 2004/08/08 17:36:06 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/melee.h
===================================================================
--- branches/multiplayer-branch/source/melee.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/melee.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: melee.h,v 1.3 2004/08/08 17:36:03 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/other/configrw.cpp
===================================================================
--- branches/multiplayer-branch/source/other/configrw.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/other/configrw.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: configrw.cpp,v 1.1.1.1 2004/08/01 10:21:23 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/other/configrw.h
===================================================================
--- branches/multiplayer-branch/source/other/configrw.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/other/configrw.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: configrw.h,v 1.1.1.1 2004/08/01 10:21:24 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/other/dialogs.cpp
===================================================================
--- branches/multiplayer-branch/source/other/dialogs.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/other/dialogs.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: dialogs.cpp,v 1.2 2004/08/03 21:05:00 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/other/dialogs.h
===================================================================
--- branches/multiplayer-branch/source/other/dialogs.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/other/dialogs.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: dialogs.h,v 1.1 2004/08/03 12:02:26 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/other/fontmorph.cpp
===================================================================
--- branches/multiplayer-branch/source/other/fontmorph.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/other/fontmorph.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: fontmorph.cpp,v 1.1.1.1 2004/08/01 10:21:24 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/other/fontmorph.h
===================================================================
--- branches/multiplayer-branch/source/other/fontmorph.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/other/fontmorph.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: fontmorph.h,v 1.1.1.1 2004/08/01 10:21:23 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Deleted: branches/multiplayer-branch/source/other/gup.cpp
===================================================================
--- branches/multiplayer-branch/source/other/gup.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/other/gup.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,713 +0,0 @@
-#include &lt;string.h&gt;
-#include &lt;allegro.h&gt;
-#include &quot;melee.h&quot;
-
-#include &quot;melee/mframe.h&quot;
-#include &quot;melee/mship.h&quot;
-#include &quot;melee/mcbodies.h&quot;
-#include &quot;melee/mview.h&quot;
-#include &quot;frame.h&quot;
-#include &quot;sc1ships.h&quot;
-#include &quot;sc2ships.h&quot;
-#include &quot;games/ggob.h&quot;
-#include &quot;gup.h&quot;
-
-/* this file contains the ship upgrades used by Gob */
-
-/*
-Generic Upgrades
-*/
-
-/*
-NOTE that execute() is called BEFORE charge(), so 
-num is not yet incremented when execute() is running
-*/
-void Upgrade::clear(Ship *oship, Ship *nship, GobPlayer *gs) {
-  STACKTRACE;
-	if (oship) gs-&gt;total -= num;
-	num = 0;
-	return;
-	}
-void Upgrade::charge(GobPlayer *gs) {
-  STACKTRACE; //called AFTER execute
-	gs-&gt;total += 1;
-	num += 1;
-	gs-&gt;value_starbucks += this-&gt;starbucks;
-	gs-&gt;value_buckazoids += this-&gt;buckazoids;
-	return;
-	}
-
-#define UPGRADE(a) virtual Upgrade *duplicate() {return new a();}
-class UpCrewpod : public Upgrade {
-	UPGRADE(UpCrewpod)
-	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
-		name = &quot;Add Crewpod&quot;;
-		if (ship-&gt;crew_max &gt;= 42) return false;
-		starbucks = 2;
-		buckazoids = gs-&gt;total / 3;
-		return true;
-		}
-	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
-		ship-&gt;crew_max += 4;
-		if (ship-&gt;crew_max &gt; 42) ship-&gt;crew_max = 42;
-		ship-&gt;crew += 4;
-		if (ship-&gt;crew &gt; 42) ship-&gt;crew = 42;
-		}
-	} crewpod;
-
-class UpBattery : public Upgrade {
-	UPGRADE(UpBattery)
-	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
-		name = &quot;Add Battery&quot;;
-		if (ship-&gt;batt_max &gt;= 42) return false;
-		starbucks = 1;
-		buckazoids = gs-&gt;total / 3;
-		return true;
-		}
-	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
-		ship-&gt;batt_max += 8;
-		if (ship-&gt;batt_max &gt; 42) ship-&gt;batt_max = 42;
-		ship-&gt;batt += 8;
-		if (ship-&gt;batt &gt; 42) ship-&gt;batt = 42;
-		}
-	} battery;
-
-class UpThrusters : public Upgrade {
-	UPGRADE(UpThrusters)
-	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
-		name = &quot;Upgrade Thrusters&quot;;
-		starbucks = 3 + num * 3;
-		buckazoids = gs-&gt;total / 3;
-		return true;
-		}
-	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
-		ship-&gt;speed_max *=  1 + .3  / (.25*num + 1);
-		ship-&gt;accel_rate *= 1 + .18 / (.12*num + 1);
-		}
-	} thrusters;
-
-class UpControlJets : public Upgrade {
-	UPGRADE(UpControlJets)
-	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
-		name = &quot;Upgrade Control Jets&quot;;
-		starbucks = 2 + num * 2;
-		buckazoids = gs-&gt;total / 3;
-		return true;
-		}
-	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
-		ship-&gt;turn_rate  *=  1 + .3  / (num + 1);
-		ship-&gt;accel_rate *=  1 + .1  / (.0*num + 1);
-		}
-	} controljets;
-
-class UpDynamo : public Upgrade {
-	UPGRADE(UpDynamo)
-	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
-		name = &quot;Upgrade Dynamo&quot;;
-		starbucks = 16 / (1 + ship-&gt;recharge_amount-num) + num;
-		if (ship-&gt;recharge_amount == 0) starbucks *= 6;
-		if (ship-&gt;weapon_rate &lt; 100) starbucks /= 2;
-		if (ship-&gt;special_drain &gt; 16) starbucks *= 2;
-		if (!strcmp(&quot;supbl&quot;, ship-&gt;type-&gt;id)) starbucks /= 2;
-		buckazoids = gs-&gt;total / 3;
-		return true;
-	}
-	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
-		ship-&gt;recharge_amount += 1;
-	}
-} dynamo;
-
-/*
-Supox Upgrades
-*/
-
-class UpSupoxRange : public Upgrade {
-	UPGRADE(UpSupoxRange)
-	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
-		name = &quot;Upgrade Glob Hurler (Supox)&quot;;
-		if (strcmp(&quot;supbl&quot;, ship-&gt;type-&gt;id)) return false;
-		starbucks = 2 + num;
-		buckazoids = gs-&gt;total / 3;
-		return true;
-		}
-	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
-		((SupoxBlade*)ship)-&gt;weaponRange *= 1 + .25 / (1 + num*.1);
-		((SupoxBlade*)ship)-&gt;weaponVelocity *= 1.15;
-		}
-	} supoxrange;
-
-class UpSupoxDamage : public Upgrade {
-	UPGRADE(UpSupoxDamage)
-	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
-		name = &quot;Upgrade Glob Former (Supox)&quot;;
-		if (strcmp(&quot;supbl&quot;, ship-&gt;type-&gt;id)) return false;
-		if (gs-&gt;ship-&gt;recharge_amount &lt; (1&lt;&lt;num)) return false;
-		if (num &gt; 7) return false;
-		starbucks = 5;
-		buckazoids = gs-&gt;total / 3;
-		return true;
-		}
-	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
-		((SupoxBlade*)ship)-&gt;weaponDamage += 1;
-		((SupoxBlade*)ship)-&gt;weaponArmour += 1;
-		((SupoxBlade*)ship)-&gt;weapon_drain += num + 1;
-		if (num &gt; 1) ((SupoxBlade*)ship)-&gt;recharge_amount += 1;
-		}
-	} supoxdamage;
-
-class UpSupoxBLADE : public Upgrade {
-	UPGRADE(UpSupoxBLADE)
-	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
-		name = &quot;Add B.L.A.D.E. (Supox)&quot;;
-		if (strcmp(&quot;supbl&quot;, ship-&gt;type-&gt;id)) return false;
-		starbucks = 2 + num;
-		buckazoids = gs-&gt;total / 3;
-		return true;
-		}
-	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
-		((SupoxBlade*)ship)-&gt;damage_factor += 3;
-		}
-	} supoxblade;
-
-/*
-Orz Upgrades
-*/
-
-class UpOrzMissile : public Upgrade {
-	UPGRADE(UpOrzMissile)
-	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
-		name = &quot;Upgrade Missiles (ORZ)&quot;;
-		if (strcmp(&quot;orzne&quot;, ship-&gt;type-&gt;id)) return false;
-		starbucks = 6;
-		buckazoids = gs-&gt;total / 2 + 2;
-		return true;
-		}
-	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
-		((OrzNemesis*)ship)-&gt;weaponDamage += 1;
-		((OrzNemesis*)ship)-&gt;weaponArmour += 1;
-		((OrzNemesis*)ship)-&gt;weaponRange *= 1.15;
-		((OrzNemesis*)ship)-&gt;weapon_drain += 1;
-		}
-	} orzmissile;
-
-class UpOrzMarineSpeed : public Upgrade {
-	UPGRADE(UpOrzMarineSpeed)
-	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
-		name = &quot;Upgrade Marine Suits (ORZ)&quot;;
-		if (strcmp(&quot;orzne&quot;, ship-&gt;type-&gt;id)) return false;
-		starbucks = 3 + num * 2;
-		buckazoids = gs-&gt;total / 3;
-		return true;
-		}
-	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
-		((OrzNemesis*)ship)-&gt;specialArmour += 1;
-		((OrzNemesis*)ship)-&gt;specialSpeedMax *= 1 + .2 / (.2*num+1);
-		((OrzNemesis*)ship)-&gt;specialAccelRate *= 1.15;
-		}
-	} orzmarinespeed;
-
-class UpOrzAbsorbtion : public Upgrade {
-	UPGRADE(UpOrzAbsorbtion)
-	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
-		name = &quot;Absorbtion (ORZ)&quot;;
-		if (strcmp(&quot;orzne&quot;, ship-&gt;type-&gt;id)) return false;
-		if (num) return false;
-		starbucks = 15;
-		buckazoids = gs-&gt;total / 3;
-		return true;
-	}
-	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
-		((OrzNemesis*)ship)-&gt;absorption = 256 / 3;
-	}
-	void charge(GobPlayer *gs) {
-		Upgrade::charge(gs);
-		gs-&gt;total += 2;
-	}
-} orzabsorption;
-
-/*
-Kohr-Ah Upgrades
-*/
-
-class UpKohrAhBladeDamage : public Upgrade {
-	UPGRADE(UpKohrAhBladeDamage)
-	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
-		name = &quot;Increase Shuriken Sharpness (Kohr-Ah)&quot;;
-		if (strcmp(&quot;kohma&quot;, ship-&gt;type-&gt;id)) return false;
-		starbucks = 2 + num;
-		buckazoids = gs-&gt;total / 3;
-		return true;
-		}
-	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
-		((KohrAhMarauder*)ship)-&gt;weaponDamage += 1;
-		((KohrAhMarauder*)ship)-&gt;weaponArmour += 1;
-		((KohrAhMarauder*)ship)-&gt;weapon_drain += 1;
-		}
-	} kohrahbladedamage;
-
-class UpKohrAhBladeSpeed : public Upgrade {
-	UPGRADE(UpKohrAhBladeSpeed)
-	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
-		if (strcmp(&quot;kohma&quot;, ship-&gt;type-&gt;id)) return false;
-		name = &quot;Increase Shuriken Velocity (Kohr-Ah)&quot;;
-		starbucks = 2 + num * 2;
-		buckazoids = gs-&gt;total / 3;
-		return true;
-	}
-	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
-		((KohrAhMarauder*)ship)-&gt;weaponVelocity *= 1.2;
-	}
-} kohrahbladespeed;
-
-class UpKohrAhFireRange : public Upgrade {
-	UPGRADE(UpKohrAhFireRange)
-	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
-		name = &quot;double F.R.I.E.D. range (Kohr-Ah)&quot;;
-		if (strcmp(&quot;kohma&quot;, ship-&gt;type-&gt;id)) return false;
-		if (num) return false;
-		starbucks = 30;
-		buckazoids = gs-&gt;total / 3;
-		return true;
-		}
-	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
-		((KohrAhMarauder*)ship)-&gt;specialRange *= 2;
-		((KohrAhMarauder*)ship)-&gt;specialVelocity *= 1.4;
-		((KohrAhMarauder*)ship)-&gt;special_drain += 12;
-		}
-	} kohrahfirerange;
-
-class UpKohrAhFireDamage : public Upgrade {
-	UPGRADE(UpKohrAhFireDamage)
-	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
-		name = &quot;double F.R.I.E.D. damage (Kohr-Ah)&quot;;
-		if (strcmp(&quot;kohma&quot;, ship-&gt;type-&gt;id)) return false;
-		if (num) return false;
-		starbucks = 13;
-		buckazoids = gs-&gt;total / 3;
-		return true;
-	}
-	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
-		((KohrAhMarauder*)ship)-&gt;specialDamage *= 2;
-		((KohrAhMarauder*)ship)-&gt;special_drain += 6;
-	}
-} kohrahfiredamage;
-
-/*
-Utwig Upgrades
-*/
-
-class UpUtwigJuggerRange : public Upgrade {
-	UPGRADE(UpUtwigJuggerRange)
-	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
-		name = &quot;Upgrade Bolt Regulator (Utwig)&quot;;
-		if (strcmp(&quot;utwju&quot;, ship-&gt;type-&gt;id)) return false;
-		starbucks = 3;
-		buckazoids = gs-&gt;total / 3;
-		return true;
-	}
-	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
-		((UtwigJugger*)ship)-&gt;weaponRange += 100;
-	}
-} utwigrange;
-class UpUtwigJuggerDamage : public Upgrade {
-	UPGRADE(UpUtwigJuggerDamage)
-	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
-		name = &quot;Upgrade Bolt Charger (Utwig)&quot;;
-		if (strcmp(&quot;utwju&quot;, ship-&gt;type-&gt;id)) return false;
-		starbucks = (num + 3) * 5;
-		buckazoids = gs-&gt;total / 3;
-		return true;
-	}
-	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
-		((UtwigJugger*)ship)-&gt;weaponDamage += 1;
-		ship-&gt;weapon_rate += 250;
-	}
-} utwigdamage;
-class UpUtwigJuggerROF : public Upgrade {
-	UPGRADE(UpUtwigJuggerROF)
-	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
-		name = &quot;Upgrade Bolt Generator (Utwig)&quot;;
-		if (strcmp(&quot;utwju&quot;, ship-&gt;type-&gt;id)) return false;
-		if (ship-&gt;weapon_rate &lt; 425) return false;
-		starbucks = num / 2 + 2;
-		buckazoids = gs-&gt;total / 3;
-		return true;
-	}
-	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
-		ship-&gt;weapon_rate -= 50;
-	}
-} utwigrof;
-class UpUtwigJuggerMaskOfHonestDemeanor : public Upgrade {
-	UPGRADE(UpUtwigJuggerMaskOfHonestDemeanor)
-	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
-		name = &quot;Mask of Honest Demeanor (max 1 mask)&quot;;
-		if (strcmp(&quot;utwju&quot;, ship-&gt;type-&gt;id)) return false;
-		if ((num + gs-&gt;upgrade_list[UpgradeIndex::utwigmask2]-&gt;num) == 1) return false;
-		starbucks = 99;
-		buckazoids = 0;
-		return true;
-	}
-	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
-		gs-&gt;value_starbucks += 251;
-		gs-&gt;value_buckazoids += 250;
-	}
-} utwigmask1;
-class UpUtwigJuggerMaskOfElephantineFortitude : public Upgrade {
-	UPGRADE(UpUtwigJuggerMaskOfElephantineFortitude)
-	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
-		name = &quot;Mask of Elephantine Fortitude (max 1 mask)&quot;;
-		if (strcmp(&quot;utwju&quot;, ship-&gt;type-&gt;id)) return false;
-		if ((num + gs-&gt;upgrade_list[UpgradeIndex::utwigmask1]-&gt;num) == 1) return false;
-		starbucks = 99;
-		buckazoids = 0;
-		return true;
-	}
-	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
-		((UtwigJugger*)ship)-&gt;fortitude = 1;
-	}
-} utwigmask2;
-
-/*
-Special Upgrades
-*/
-
-class UpDivineFavor : public Upgrade {
-	UPGRADE(UpDivineFavor)
-	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
-		name = &quot;Divine Favor (unique)&quot;;
-		if (strcmp(station-&gt;build_type, &quot;orzne&quot;)) return false;
-		if (num) return false;
-		starbucks = 150;
-		buckazoids = 0;
-		return true;
-		}
-	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
-		}
-	void clear(Ship *oship, Ship *nship, GobPlayer *gs) {
-		if (!oship) num = 0;
-		return;
-		}
-	void charge(GobPlayer *gs) {
-		num += 1;
-		}
-	} divinefavor;
-
-class UpUnholyAura : public Upgrade {
-	UPGRADE(UpUnholyAura)
-	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
-		name = &quot;the Devil protects his own...&quot;;
-		starbucks = 6;
-		buckazoids = 66;
-		//if (strcmp(station-&gt;build_type, &quot;orzne&quot;)) return false;
-		if (num) return false;
-		if (((game-&gt;game_time / 1000) % 1000) == 666) return true;
-		if (((game-&gt;game_time / 1000) % 666) == 0) return true;
-		//666, 1332, 1666, 1998, etc.
-		return false;
-		}
-	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
-		game-&gt;add ( new UnholyAura ( ship ) );
-		}
-	void clear(Ship *oship, Ship *nship, GobPlayer *gs) {
-		if (!oship) num = 0;
-		else if (num) {
-			game-&gt;add ( new UnholyAura ( nship ) );
-		}
-		return;
-		}
-	void charge(GobPlayer *gs) {
-		num += 1;
-		}
-	} unholyaura;
-
-
-class UpDefender : public Upgrade {
-	UPGRADE(UpDefender)
-	GobDefender *def[6];
-	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
-		name = &quot;External Defense System&quot;;
-		if (strcmp(station-&gt;build_type, &quot;kohma&quot;)) return false;
-		if (num &gt;= 6) return false;
-		starbucks = 5 + 5 * (num+1) * num;
-		buckazoids = 12;
-		return true;
-	}
-	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
-		def[num] = new GobDefender(ship);
-		int i;
-		for (i = 0; i &lt;= num; i += 1) def[i]-&gt;base_phase = i * PI2 / (num+1);
-		gobgame-&gt;add (def[num]);
-	}
-	void clear(Ship *oship, Ship *nship, GobPlayer *gs) {
-		if (!oship) num = 0;
-		if (oship) {
-			for (int i = 0; i &lt; num; i += 1) {
-				def[i]-&gt;die();
-				def[i] = new GobDefender(nship);
-				def[i]-&gt;base_phase = i * PI2 / num;
-				game-&gt;add(def[i]);
-			}
-		}
-		//Upgrade::clear(oship, nship, gs);
-		return;
-	}
-	void charge(GobPlayer *gs) {
-		gs-&gt;total += 1;
-		num += 1;
-	}
-} defender;
-
-class UpPlanetLocater : public Upgrade {
-	UPGRADE(UpPlanetLocater)
-	Presence **locater;
-	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
-		name = &quot;Planet Locater&quot;;
-		if (strcmp(station-&gt;build_type, &quot;supbl&quot;)) return false;
-		if (num) return false;
-		starbucks = 4;
-		buckazoids = 5;
-		return true;
-	}
-	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
-		locater = new Presence *[gobgame-&gt;num_planets];
-		for (int i = 0; i &lt; gobgame-&gt;num_planets; i += 1) {
-			locater[i] = new WedgeIndicator ( gobgame-&gt;planet[i], 80, 2 );
-			gobgame-&gt;add (locater[i] );
-		}
-	}
-	void clear(Ship *oship, Ship *nship, GobPlayer *gs) {
-		Upgrade::clear(oship, nship, gs);
-		if (oship &amp;&amp; locater) for (int i = 0; i &lt; gobgame-&gt;num_planets; i += 1) {
-			locater[i]-&gt;die();
-		}
-		locater = NULL;
-		return;
-	}
-} planetlocater;
-
-class UpHyperDynamo : public Upgrade {
-	UPGRADE(UpHyperDynamo)
-	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
-		name = &quot;Hyper Dynamo (ancient artifact)&quot;;
-		if (game-&gt;game_time / 1000 &lt; 21 * 60) return false;
-		starbucks = 720 / (game-&gt;game_time / (1000*60*10) - 1);
-		//unavailable before 20 minutes
-		//720 starbucks at 20 minutes
-		//360 starbucks at 30 minutes
-		//240 starbucks at 40 minutes
-		//180 starbucks at 50 minutes
-		//144 starbucks at 60 minutes
-		//120 starbucks at 70 minutes
-		//102 starbucks at 80 minutes
-		//90 starbucks at 90 minutes
-		buckazoids = starbucks/2 + gs-&gt;total / 3;
-		if (gs-&gt;starbucks &lt; starbucks / 4) return false;
-		if (ship-&gt;recharge_amount == 0) return false;
-		if (num) return false;
-		return true;
-	}
-	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
-		ship-&gt;recharge_rate /= 2;
-	}
-} hyperdynamo;
-
-/*class UpRoswellDevice : public Upgrade {
-	UPGRADE(UpUnholyAura)
-	bool update(Ship *ship, GobStation *station, GobPlayer *gs) {
-		name = &quot;Roswell Device&quot;;
-		if (((game-&gt;game_time / 1000) % 1000) &lt; 700) return false;
-		starbucks = 99;
-		buckazoids = 9;
-		if (strcmp(station-&gt;build_type, &quot;utwju&quot;)) return false;
-		if (num) return false;
-		return true;
-	}
-	void execute(Ship *ship, GobStation *station, GobPlayer *gs) {
-		game-&gt;add ( new RoswellDevice ( ship ) );
-	}
-	void clear(Ship *oship, Ship *nship, GobPlayer *gs) {
-		if (!oship) num = 0;
-		else if (num) {
-			game-&gt;add ( new RoswellDevice ( nship ) );
-		}
-		return;
-	}
-	void charge(GobPlayer *gs) {
-		num += 1;
-	}
-} roswelldevice;*/
-
-/*
-note to future coders:
-in order for an upgrade to show up, it must be added to this list
-anything added to this list MUST be added, in the same order, to 
-the enum in gup.h
-*/
-static Upgrade *_upgrade_list[] = {
-	&amp;crewpod,
-	&amp;battery,
-	&amp;thrusters,
-	&amp;controljets,
-	&amp;dynamo,
-	&amp;supoxrange,
-	&amp;supoxdamage,
-	&amp;supoxblade,
-	&amp;orzmissile,
-	&amp;orzmarinespeed,
-	&amp;orzabsorption,
-	&amp;kohrahbladedamage,
-	&amp;kohrahbladespeed,
-	&amp;kohrahfirerange,
-	&amp;kohrahfiredamage,
-	&amp;utwigrange,
-	&amp;utwigdamage,
-	&amp;utwigrof,
-	&amp;utwigmask1,
-	&amp;utwigmask2,
-	&amp;divinefavor,
-	&amp;unholyaura,
-	&amp;defender,
-	&amp;planetlocater,
-	&amp;hyperdynamo,
-//	&amp;roswelldevice,
-	NULL
-	};
-
-Upgrade **upgrade_list = _upgrade_list;
-
-UnholyAura::UnholyAura ( SpaceLocation * ship ) {
-	focus = ship;
-	angle = 0;
-}
-void UnholyAura::animate (Frame *frame) {
-	Vector2 p = corner(focus-&gt;normal_pos());
-	const int speed = 1500;
-	int color = game-&gt;game_time % speed;
-	if (color &gt; speed/2) color = speed - color;
-	color = tw_color ( color * 255 * 2 / speed, 0, 0);
-	Vector2 r;
-	r.y = space_zoom * 240;
-	r.x = r.y * 1.5;
-	double a = angle;
-	line (frame-&gt;surface, 
-		p + r *(unit_vector(a +   0 * ANGLE_RATIO)), 
-		p + r * (unit_vector(a + 144 * ANGLE_RATIO)), 
-		color);
-	a += 72 * ANGLE_RATIO;
-	line (frame-&gt;surface, 
-		p + r * (unit_vector(a +   0 * ANGLE_RATIO)), 
-		p + r * (unit_vector(a + 144 * ANGLE_RATIO)), 
-		color);
-	a += 72 * ANGLE_RATIO;
-	line (frame-&gt;surface, 
-		p + r * (unit_vector(a +   0 * ANGLE_RATIO)), 
-		p + r * (unit_vector(a + 144 * ANGLE_RATIO)), 
-		color);
-	a += 72 * ANGLE_RATIO;
-	line (frame-&gt;surface, 
-		p + r * (unit_vector(a +   0 * ANGLE_RATIO)), 
-		p + r * (unit_vector(a + 144 * ANGLE_RATIO)), 
-		color);
-	a += 72 * ANGLE_RATIO;
-	line (frame-&gt;surface, 
-		p + r * (unit_vector(a +   0 * ANGLE_RATIO)), 
-		p + r * (unit_vector(a + 144 * ANGLE_RATIO)), 
-		color);
-	frame-&gt;add_box(iround(p.x - r.x-1), iround(p.y - r.y-1), iround(r.x*2+3), iround(r.y*2+3));
-}
-void UnholyAura::calculate () {
-	if (!focus-&gt;exists()) die();
-	angle -= frame_time / 10.0;
-	if (angle &lt; 0) angle += 360;
-	if (random(1700) &lt; frame_time) {
-		Query q;
-		q.begin(focus, OBJECT_LAYERS, 666);
-		for (;q.current; q.next() ) {
-			if (!(focus-&gt;sameTeam(q.current))) q.current-&gt;handle_damage(focus, 0, random() % 6);
-		}
-	}
-}
-/*
-void GobRadar::animate_item ( SpaceLocation *item ) {
-	int type = 0;
-	int color = 0;
-	double angle = 0;
-	double radius = 0;
-	double x, y;
-	x = normalize(item-&gt;normal_x() - gx + X_MAX/2, X_MAX) - X_MAX/200+gx/2;
-	x *= window-&gt;w / gw;
-	y = normalize(item-&gt;normal_y() - gy + Y_MAX/2, Y_MAX) - Y_MAX/200+gy/2;
-	y *= window-&gt;h / gh;
-	TeamCode t = item-&gt;get_team();
-	if (t == 0) color = palette_color[6];
-	else if (t == team) color = palette_color[7];
-	else color = palette_color[4];
-	color = palette_color[7];
-	if (item-&gt;isObject()) {
-		SpaceSprite *sprite = ((SpaceObject*)item)-&gt;get_sprite();
-		if (sprite) radius = 
-			sqrt(sprite-&gt;width() * sprite-&gt;width() + sprite-&gt;height() * sprite-&gt;height()) / 2 / gw;
-		else return;
-		if (radius &lt; 5) radius = sqrt(radius * 5);
-	}
-	else if (item-&gt;isLine()) {
-		type = 1;
-		radius = (((SpaceLine*)item)-&gt;get_length()) / gw;
-		angle = (((SpaceLine*)item)-&gt;get_angle());
-	}
-
-
-	if (type == 0) {
-		circlefill ( window-&gt;surface, 
-			window-&gt;x + x, 
-			window-&gt;y + y, 
-			radius,
-			color
-		);
-	}
-	else if (type == 1) {
-		line (  window-&gt;surface,
-			window-&gt;x + x, 
-			window-&gt;y + y,
-			window-&gt;x + x + cos(angle) * radius,
-			window-&gt;y + y + sin(angle) * radius,
-			color
-		);
-	}
-}
-
-void GobRadar::animate ( Frame * frame ) {
-	Query q;
-	if (!window-&gt;surface) return;
-
-	window-&gt;lock();
-
-	rectfill(window-&gt;surface, 
-		window-&gt;x, window-&gt;y, 
-		window-&gt;x + window-&gt;w,
-		window-&gt;y + window-&gt;h,
-		0
-		);
-	for (q.begin(0, 0, ALL_LAYERS, 999999999999);q.current;q.next()) {
-		if (!q.current-&gt;exists()) continue;
-		if (q.current-&gt;isInvisible())
-			continue;
-		animate_item(q.current);
-	}
-	q.end();
-
-	window-&gt;unlock();
-}
-
-GobRadar::GobRadar() {
-  STACKTRACE;
-	attributes &amp;= ~ATTRIB_SYNCHED;
-	team = 0;
-	gx = 0;
-	gy = 0;
-	gw = X_MAX;
-	gh = Y_MAX;
-	window = new VideoWindow();
-	window-&gt;preinit();
-}
-*/

Deleted: branches/multiplayer-branch/source/other/gup.h
===================================================================
--- branches/multiplayer-branch/source/other/gup.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/other/gup.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,74 +0,0 @@
-class Upgrade;
-extern Upgrade **upgrade_list;
-
-class UpgradeIndex {
-public:
-	enum {
-		crewpod,
-		battery,
-		thrusters,
-		controljets,
-		dynamo,
-		supoxrange,
-		supoxdamage,
-		supoxblade,
-		orzmissile,
-		orzmarinespeed,
-		orzabsorption,
-		kohrahbladedamage,
-		kohrahbladespeed,
-		kohrahfirerange,
-		kohrahfiredamage,
-		utwigrange,
-		utwigdamage,
-		utwigrof,
-		utwigmask1,
-		utwigmask2,
-		divinefavor,
-		unholyaura,
-		defender,
-		planetlocater,
-		hyperdynamo,
-		//gobradar,
-		//roswelldevice,
-		NULL_UPGRADE
-	};
-};
-
-class GobDefender : public SpaceObject {
-	public:
-	GobDefender ( Ship *ship);
-	double base_phase;
-	virtual void calculate();
-	int next_shoot_time;
-};
-
-/*class RoswellDevice : public Presence {
-	public:
-	RoswellDevice ( Ship *ship, double angle );
-	virtual void calculate();
-	int next_shoot_time;
-	double phase;
-};*/
-
-class UnholyAura : public Presence {
-public:
-	SpaceLocation *focus;
-	double angle;
-	virtual void calculate ();
-	virtual void animate ( Frame * frame);
-	UnholyAura ( SpaceLocation *ship );
-};
-
-/*
-class GobRadar : public Presence {
-public:
-	TeamCode team;
-	double gx, gy, gw, gh;
-	VideoWindow *window;
-	//virtual void calculate ();
-	virtual void animate ( Frame * frame );
-	virtual void animate_item ( SpaceLocation *item);
-	GobRadar();
-};*/
-

Modified: branches/multiplayer-branch/source/other/nullphas.cpp
===================================================================
--- branches/multiplayer-branch/source/other/nullphas.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/other/nullphas.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: nullphas.cpp,v 1.1.1.1 2004/08/01 10:21:24 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -40,3 +40,5 @@
   }
 }
 
+
+

Modified: branches/multiplayer-branch/source/other/nullphas.h
===================================================================
--- branches/multiplayer-branch/source/other/nullphas.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/other/nullphas.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: nullphas.h,v 1.1.1.1 2004/08/01 10:21:24 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/other/objanim.cpp
===================================================================
--- branches/multiplayer-branch/source/other/objanim.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/other/objanim.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: objanim.cpp,v 1.1.1.1 2004/08/01 10:21:24 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/other/objanim.h
===================================================================
--- branches/multiplayer-branch/source/other/objanim.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/other/objanim.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: objanim.h,v 1.1.1.1 2004/08/01 10:21:24 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/other/orbit.cpp
===================================================================
--- branches/multiplayer-branch/source/other/orbit.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/other/orbit.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: orbit.cpp,v 1.1.1.1 2004/08/01 10:21:23 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -21,13 +21,14 @@
 #include &quot;id.h&quot;
 #include &quot;scp.h&quot;
 #include &quot;frame.h&quot;
-#include &quot;ship.h&quot;
+#include &quot;melee/mship.h&quot;
 
 #include &quot;melee/mgame.h&quot;
 #include &quot;melee/mview.h&quot;
 #include &quot;melee/mcbodies.h&quot;
 #include &quot;melee/manim.h&quot;
 #include &quot;melee/mship.h&quot;
+#include &quot;melee/mshot.h&quot;
 
 #include &quot;orbit.h&quot;
 

Modified: branches/multiplayer-branch/source/other/orbit.h
===================================================================
--- branches/multiplayer-branch/source/other/orbit.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/other/orbit.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: orbit.h,v 1.1.1.1 2004/08/01 10:21:24 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/other/planet3d.cpp
===================================================================
--- branches/multiplayer-branch/source/other/planet3d.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/other/planet3d.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: planet3d.cpp,v 1.1.1.1 2004/08/01 10:21:24 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -16,8 +16,10 @@
 */
 
 
-#include &quot;ship.h&quot;
+#include &quot;melee.h&quot;
+#include &quot;melee/mship.h&quot;
 #include &quot;melee/mview.h&quot;
+#include &quot;melee/mgame.h&quot;
 
 #include &quot;util/pmask.h&quot;
 #include &quot;util/aastr.h&quot;

Modified: branches/multiplayer-branch/source/other/planet3d.h
===================================================================
--- branches/multiplayer-branch/source/other/planet3d.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/other/planet3d.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: planet3d.h,v 1.2 2004/08/07 12:33:54 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -18,7 +18,8 @@
 #ifndef __PLANET_3D__
 #define __PLANET_3D__
 
-
+#include &quot;melee.h&quot;
+#include &quot;melee/mship.h&quot;
 #include &quot;melee/mcbodies.h&quot;
 
 Planet *create_planet( Vector2 position = map_size/2 );//remove me!

Modified: branches/multiplayer-branch/source/other/radar.cpp
===================================================================
--- branches/multiplayer-branch/source/other/radar.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/other/radar.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: radar.cpp,v 1.1.1.1 2004/08/01 10:21:24 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -20,7 +20,7 @@
 #include &quot;id.h&quot;
 #include &quot;scp.h&quot;
 #include &quot;frame.h&quot;
-#include &quot;ship.h&quot;
+#include &quot;melee/mship.h&quot;
 
 #include &quot;melee/mgame.h&quot;
 #include &quot;melee/mview.h&quot;

Modified: branches/multiplayer-branch/source/other/radar.h
===================================================================
--- branches/multiplayer-branch/source/other/radar.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/other/radar.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: radar.h,v 1.1.1.1 2004/08/01 10:21:23 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/other/shippart.cpp
===================================================================
--- branches/multiplayer-branch/source/other/shippart.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/other/shippart.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shippart.cpp,v 1.1.1.1 2004/08/01 10:21:24 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -16,8 +16,10 @@
 */
 
 
-#include &quot;ship.h&quot;
+#include &quot;melee.h&quot;
+#include &quot;melee/mship.h&quot;
 #include &quot;melee/mview.h&quot;
+#include &quot;melee/mtarget.h&quot;
 
 #include &lt;stdio.h&gt;
 

Modified: branches/multiplayer-branch/source/other/shippart.h
===================================================================
--- branches/multiplayer-branch/source/other/shippart.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/other/shippart.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shippart.h,v 1.1.1.1 2004/08/01 10:21:23 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -18,7 +18,7 @@
 #ifndef __SHIPPART__
 #define __SHIPPART__
 
-#include &quot;ship.h&quot;
+#include &quot;melee/mship.h&quot;
 
 
 //void removefromtargetlist(SpaceObject *o);

Modified: branches/multiplayer-branch/source/other/twconfig.cpp
===================================================================
--- branches/multiplayer-branch/source/other/twconfig.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/other/twconfig.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: twconfig.cpp,v 1.2 2004/08/08 17:36:04 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/other/twconfig.h
===================================================================
--- branches/multiplayer-branch/source/other/twconfig.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/other/twconfig.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: twconfig.h,v 1.1.1.1 2004/08/01 10:21:23 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/other/vbodies.cpp
===================================================================
--- branches/multiplayer-branch/source/other/vbodies.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/other/vbodies.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: vbodies.cpp,v 1.1.1.1 2004/08/01 10:21:24 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/other/vbodies.h
===================================================================
--- branches/multiplayer-branch/source/other/vbodies.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/other/vbodies.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: vbodies.h,v 1.1.1.1 2004/08/01 10:21:24 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/other/vtarget.cpp
===================================================================
--- branches/multiplayer-branch/source/other/vtarget.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/other/vtarget.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: vtarget.cpp,v 1.2 2004/08/08 17:36:04 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -25,7 +25,7 @@
 #include &quot;melee/mview.h&quot;
 #include &quot;melee/mship.h&quot;
 #include &quot;melee/mcbodies.h&quot;
-#include &quot;ship.h&quot;
+#include &quot;melee/mship.h&quot;
 #include &quot;frame.h&quot;
 #include &quot;vtarget.h&quot;
 

Modified: branches/multiplayer-branch/source/other/vtarget.h
===================================================================
--- branches/multiplayer-branch/source/other/vtarget.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/other/vtarget.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: vtarget.h,v 1.2 2004/08/08 17:36:04 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Copied: branches/multiplayer-branch/source/sc1ships/sc1ships.h (from rev 81, branches/multiplayer-branch/source/sc1ships.h)
===================================================================
--- branches/multiplayer-branch/source/sc1ships.h	2004-10-16 21:23:27 UTC (rev 81)
+++ branches/multiplayer-branch/source/sc1ships/sc1ships.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -0,0 +1,363 @@
+/* $Id: sc1ships.h,v 1.4 2004/03/24 23:51:34 yurand Exp $ */ 
+
+#ifndef SC1_SHIP_HEADER
+#define SC1_SHIP_HEADER
+
+#include &quot;melee/mship.h&quot;
+	
+class AndrosynthGuardian : public Ship {
+public:
+	double       weaponRange;
+	double       weaponVelocity;
+	int          weaponDamage;
+	int          weaponArmour;
+
+	int bounce_status;
+
+	SpaceSprite *specialSprite;
+	SpaceSprite *shipSprite;
+	double       specialVelocity;
+	double       specialTurnRate;
+	int          specialDamage;
+	int          specialBounceDistance;
+	int          specialBounceTime;
+	int          specialActive;
+	double       shipTurnRate;
+	int          shipRechargeAmount;
+	double specialMass;
+	double normalMass;
+
+	public:
+	AndrosynthGuardian(Vector2 opos, double angle, ShipData *data, unsigned int code);
+	AndrosynthGuardian() { }
+	virtual char * GetClassName(void) const;
+	virtual unsigned GetClassID(void) const;
+	
+	virtual void calculate();
+	virtual void calculate_thrust();
+	virtual void calculate_hotspots();
+
+	virtual void inflict_damage(SpaceObject *other);
+
+	virtual int activate_weapon();
+	virtual int activate_special();
+};
+
+
+
+class ArilouSkiff : public Ship {
+public:
+	int    weaponColor;
+	double weaponRange;
+	int    weaponFrames;
+	int    weaponDamage;
+
+	int just_teleported;
+
+	SpaceSprite *specialSprite;
+	double       specialFrames;
+
+	public:
+	ArilouSkiff(Vector2 opos, double angle, ShipData *data, unsigned int code);
+
+	protected:
+	virtual void inflict_damage(SpaceObject *other);
+	virtual int activate_weapon();
+	virtual int activate_special();
+	virtual void calculate();
+	virtual void calculate_gravity();
+	virtual int accelerate(SpaceLocation *source, double angle, double velocity, 
+			double max_speed);
+	virtual int accelerate_gravwhip(SpaceLocation *source, double angle, double velocity, 
+			double max_speed);
+	};
+
+
+class ChenjesuDOGI ;
+class ChenjesuBroodhome : public Ship
+{
+protected:
+	double		weaponVelocity, shardRange;
+	double		shardDamage, shardArmour;
+	double		shardRelativity;
+	double		weaponDamage, weaponArmour;
+	int			shardRotation;
+	int			weaponFired;
+	Shot		*weaponObject;
+
+	double		specialVelocity;
+	double		specialFuelSap;
+	double		specialArmour;
+	double		specialAccelRate;
+	double		specialMass;
+	double		specialAvoidanceAngle;
+	double		specialAvoidanceFactor;
+	int			specialNumDOGIs;
+
+public:
+	ChenjesuBroodhome(Vector2 opos, double angle, ShipData *data, unsigned int code);
+	virtual int activate_weapon();
+	virtual int activate_special();
+	virtual void calculate();
+};
+
+
+class EarthlingCruiser : public Ship {
+public:
+  double       weaponRange;
+  double       weaponVelocity;
+  int          weaponDamage;
+  int          weaponArmour;
+  double       weaponTurnRate;
+
+  int    specialColor;
+  double specialRange;
+  int    specialFrames;
+  int    specialDamage;
+
+  public:
+  EarthlingCruiser(Vector2 opos, double angle, ShipData *data, unsigned int code);
+
+  protected:
+  virtual int activate_weapon();
+  virtual int activate_special();
+};
+
+
+class IlwrathAvenger : public Ship {
+public:
+	double       weaponRange;
+	double       weaponVelocity;
+	int          weaponDamage;
+	int          weaponArmour;
+
+	int cloak;
+	int cloak_frame;
+
+	public:
+	static int cloak_color[3];
+	IlwrathAvenger(Vector2 opos, double angle, ShipData *data, unsigned int code);
+
+	virtual double isInvisible() const;
+	virtual int activate_weapon();
+	virtual void calculate_fire_special();
+	virtual void calculate_hotspots();
+	virtual void calculate();
+	virtual void animate(Frame *space);
+};
+
+
+class KzerZaDreadnought : public Ship {
+public:
+	double weaponRange;
+	double weaponVelocity;
+	int    weaponDamage;
+	int    weaponArmour;
+
+	int    specialFrames;
+	int    specialLaserDamage;
+	int    specialLaserColor;
+	double specialLaserRange;
+	int    specialLaserFrames;
+	int    specialLaserDrain;
+	double specialVelocity;
+	double specialRange;
+	int    specialArmour;
+
+	public:
+	KzerZaDreadnought(Vector2 opos, double angle, ShipData *data, unsigned int code);
+
+	int activate_weapon();
+	int activate_special();
+	};
+
+
+class MmrnmhrmXForm : public Ship {
+public:
+	struct {
+		public:
+		double       speed_max;
+		double       accel_rate;
+		double       turn_rate;
+		int          recharge_amount;
+		int          recharge_rate;
+		int          weapon_drain;
+		int          weapon_rate;
+		int          hotspot_rate;
+		SpaceSprite *sprite;
+	} form_data[2];
+
+	int form;
+
+	int        laserColor;
+	double     laserRange;
+	double     laserAngle;
+	int        laserDamage;
+	SpaceLine *laser1;
+	SpaceLine *laser2;
+	int        laserSpark;
+
+	double missileRange;
+	double missileVelocity;
+	int    missileDamage;
+	int    missileArmour;
+	double missileTurnRate;
+
+	public:
+	MmrnmhrmXForm(Vector2 opos, double shipAngle, 
+		ShipData *shipData, unsigned int code);
+
+	void calculate();
+	double handle_speed_loss(SpaceLocation *source, double normal);
+
+	int activate_weapon();
+	int activate_special();
+};
+
+
+class MyconPodship : public Ship {
+public:
+	double       weaponRange;
+	double       weaponVelocity;
+	int          weaponDamage;
+	double       weaponHome;
+	int          specialRepair;
+
+	public:
+	MyconPodship(Vector2 opos, double angle, ShipData *data, unsigned int code);
+
+	virtual int activate_weapon();
+	virtual int activate_special();
+};
+
+class ShofixtiScout : public Ship {
+	public:
+	double       weaponRange;
+	double       weaponVelocity;
+	int          weaponDamage;
+	int          weaponArmour;
+
+	double       specialRange;
+	double       specialScale;
+	int          specialFrames;
+	int          specialDamage;
+	int          flipSwitch;
+	int          glory;
+
+	ShofixtiScout(Vector2 opos, double angle, ShipData *data, unsigned int code);
+
+	virtual int activate_weapon();
+	virtual void calculate_fire_special();
+};
+
+
+class SpathiEluder : public Ship {
+public:
+	double       weaponRange;
+	double       weaponVelocity;
+	int          weaponDamage;
+	int          weaponArmour;
+
+	double       specialRange;
+	double       specialVelocity;
+	int          specialDamage;
+	int          specialArmour;
+	double       specialTurnRate;
+
+	public:
+	SpathiEluder(Vector2 opos, double angle, ShipData *data, unsigned int code);
+
+	virtual int activate_weapon();
+	virtual int activate_special();
+};
+
+
+class SyreenPenetrator : public Ship {
+public:
+	double       weaponRange;
+	double       weaponVelocity;
+	int          weaponDamage;
+	int          weaponArmour;
+
+	double       specialRange;
+	double       specialVelocity;
+	int          specialDamage;
+	int          specialFrames;
+
+	public:
+	SyreenPenetrator(Vector2 opos, double angle, ShipData *data, unsigned int code);
+
+	virtual int activate_weapon();
+	virtual int activate_special();
+};
+
+
+class UmgahDrone : public Ship {
+public:
+	int          weaponDamage;
+	int          weaponCone;
+	int          specialRate;
+
+	public:
+
+	int          firing;
+	int          damage_type;
+
+	UmgahDrone(Vector2 opos, double angle, ShipData *data, unsigned int code);
+
+	virtual int activate_weapon();
+	virtual int activate_special();
+	virtual void calculate_thrust();
+	virtual void calculate();
+};
+
+
+class VuxIntruder : public Ship {
+public:
+	int    weaponColor;
+	double weaponRange;
+	int    weaponDamage;
+
+	double specialRange;
+	double specialVelocity;
+	double specialSlowdown;
+	int    specialArmour;
+
+	public:
+	VuxIntruder(Vector2 opos, double angle, ShipData *data, unsigned int code);
+
+	virtual int activate_weapon();
+	virtual int activate_special();
+	virtual SpaceLocation *get_ship_phaser() ;
+	void relocate() ;
+  virtual void animate(Frame *space);
+};
+
+
+class YehatTerminator : public Ship {
+public:
+	double       weaponRange;
+	double       weaponVelocity;
+	int          weaponDamage;
+	int          weaponArmour;
+
+	int          specialFrames;
+	int          shieldFrames;
+
+	public:
+	YehatTerminator(Vector2 opos, double angle, ShipData *data, unsigned int code);
+	YehatTerminator() { }
+	virtual char * GetClassName(void) const;
+	virtual unsigned GetClassID(void) const;
+
+	virtual double isProtected() const;
+
+	protected:
+	virtual int activate_weapon();
+	virtual int activate_special();
+	virtual void calculate();
+	virtual void animate(Frame *space);
+	virtual int handle_damage(SpaceLocation *source, double normal, double direct);
+};
+
+#endif

Modified: branches/multiplayer-branch/source/sc1ships/shpandgu.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shpandgu.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/sc1ships/shpandgu.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id$ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -18,10 +18,14 @@
 #include &quot;util/sound.h&quot;
 #include &quot;ship.h&quot;
 
-#include &quot;sc1ships.h&quot;
+#include &quot;sc1ships/sc1ships.h&quot;
 #include &quot;scp.h&quot;
 
 class AndrosynthBubble : public AnimatedShot {
+  AndrosynthBubble () {}
+  virtual char * GetClassName(void) const;
+	virtual unsigned GetClassID(void) const;
+  
   int courseFrames;
 
   public:
@@ -249,4 +253,5 @@
 
 
 REGISTER_SHIP(AndrosynthGuardian)
+REGISTER_PRESENCE_CLASS(AndrosynthBubble);
 

Modified: branches/multiplayer-branch/source/sc1ships/shparisk.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shparisk.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/sc1ships/shparisk.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id$ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -17,7 +17,7 @@
 
 #include &quot;ship.h&quot;
 
-#include &quot;sc1ships.h&quot;
+#include &quot;sc1ships/sc1ships.h&quot;
 
 ArilouSkiff::ArilouSkiff(Vector2 opos, double angle, ShipData *data, unsigned int code) 
 	:

Modified: branches/multiplayer-branch/source/sc1ships/shpchebr.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shpchebr.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/sc1ships/shpchebr.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id$ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -17,7 +17,7 @@
 
 #include &quot;ship.h&quot;
 
-#include &quot;sc1ships.h&quot;
+#include &quot;sc1ships/sc1ships.h&quot;
 
 #define MAX_DOGIS 4
 

Modified: branches/multiplayer-branch/source/sc1ships/shpearcr.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shpearcr.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/sc1ships/shpearcr.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id$ */
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -18,7 +18,7 @@
 #include &quot;util/sound.h&quot; 
 #include &quot;ship.h&quot;
 
-#include &quot;sc1ships.h&quot;
+#include &quot;sc1ships/sc1ships.h&quot;
 #include &quot;scp.h&quot;
 
 class EarthlingMissile : public HomingMissile {

Modified: branches/multiplayer-branch/source/sc1ships/shpilwav.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shpilwav.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/sc1ships/shpilwav.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id$ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -17,7 +17,7 @@
 
 #include &quot;ship.h&quot;
 
-#include &quot;sc1ships.h&quot;
+#include &quot;sc1ships/sc1ships.h&quot;
 
 int IlwrathAvenger::cloak_color[3] = { 15, 11, 9 };
 

Modified: branches/multiplayer-branch/source/sc1ships/shpkzedr.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shpkzedr.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/sc1ships/shpkzedr.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id$ */
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -18,7 +18,7 @@
 #include &quot;ship.h&quot;
 #include &quot;melee/mview.h&quot;
 
-#include &quot;sc1ships.h&quot;
+#include &quot;sc1ships/sc1ships.h&quot;
 
 class KzerZaMissile : public Missile {
 	public:

Modified: branches/multiplayer-branch/source/sc1ships/shpmmrxf.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shpmmrxf.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/sc1ships/shpmmrxf.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id$ */
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -20,7 +20,7 @@
 #define T_FORM 0
 #define Y_FORM 1
 
-#include &quot;sc1ships.h&quot;
+#include &quot;sc1ships/sc1ships.h&quot;
 
 MmrnmhrmXForm::MmrnmhrmXForm(Vector2 opos, double shipAngle,
 	ShipData *shipData, unsigned int code) 

Modified: branches/multiplayer-branch/source/sc1ships/shpmycpo.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shpmycpo.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/sc1ships/shpmycpo.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id$ */
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -17,7 +17,7 @@
  
 #include &quot;ship.h&quot;
 
-#include &quot;sc1ships.h&quot;
+#include &quot;sc1ships/sc1ships.h&quot;
 
 class MyconPlasma : public HomingMissile {
 	//double v;

Modified: branches/multiplayer-branch/source/sc1ships/shpshosc.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shpshosc.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/sc1ships/shpshosc.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id$ */
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -17,7 +17,7 @@
  
 #include &quot;ship.h&quot;
 
-#include &quot;sc1ships.h&quot;
+#include &quot;sc1ships/sc1ships.h&quot;
 
 ShofixtiScout::ShofixtiScout(Vector2 opos, double angle, ShipData *data, unsigned int code) 
 	:

Modified: branches/multiplayer-branch/source/sc1ships/shpspael.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shpspael.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/sc1ships/shpspael.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id$ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -17,7 +17,7 @@
 
 #include &quot;ship.h&quot;
 
-#include &quot;sc1ships.h&quot;
+#include &quot;sc1ships/sc1ships.h&quot;
 
 SpathiEluder::SpathiEluder(Vector2 opos, double angle, ShipData *data, unsigned int code) 
 	:

Modified: branches/multiplayer-branch/source/sc1ships/shpsyrpe.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shpsyrpe.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/sc1ships/shpsyrpe.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id$*/ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -17,7 +17,7 @@
 
 #include &quot;ship.h&quot;
 
-#include &quot;sc1ships.h&quot;
+#include &quot;sc1ships/sc1ships.h&quot;
 
 class CrewPod : public SpaceObject {
 	int frame_count;

Modified: branches/multiplayer-branch/source/sc1ships/shpumgdr.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shpumgdr.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/sc1ships/shpumgdr.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id$ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -17,7 +17,7 @@
 
 #include &quot;ship.h&quot;
 
-#include &quot;sc1ships.h&quot;
+#include &quot;sc1ships/sc1ships.h&quot;
 
 class UmgahCone : public SpaceObject {
   double dist;

Modified: branches/multiplayer-branch/source/sc1ships/shpvuxin.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shpvuxin.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/sc1ships/shpvuxin.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id$ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -17,7 +17,7 @@
 
 #include &quot;ship.h&quot;
 
-#include &quot;sc1ships.h&quot;
+#include &quot;sc1ships/sc1ships.h&quot;
 
 class VuxLimpet : public AnimatedShot {
   double slowdown_factor;

Modified: branches/multiplayer-branch/source/sc1ships/shpyehte.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shpyehte.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/sc1ships/shpyehte.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id$ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -16,11 +16,9 @@
 */
 
 #include &quot;ship.h&quot;
-
 #include &quot;frame.h&quot;
+#include &quot;sc1ships/sc1ships.h&quot;
 
-#include &quot;sc1ships.h&quot;
-
 YehatTerminator::YehatTerminator(Vector2 opos, double angle, ShipData *data, unsigned int code) 
 	:
 	Ship(opos, angle, data, code)
@@ -83,5 +81,5 @@
   return (shieldFrames &gt; 0);
 }
 
-
+REGISTER_PRESENCE_CLASS(YehatTerminator)
 REGISTER_SHIP (YehatTerminator)

Deleted: branches/multiplayer-branch/source/sc1ships.h
===================================================================
--- branches/multiplayer-branch/source/sc1ships.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/sc1ships.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,349 +0,0 @@
-/* $Id: sc1ships.h,v 1.4 2004/03/24 23:51:34 yurand Exp $ */ 
-class AndrosynthGuardian : public Ship {
-public:
-	double       weaponRange;
-	double       weaponVelocity;
-	int          weaponDamage;
-	int          weaponArmour;
-
-	int bounce_status;
-
-	SpaceSprite *specialSprite;
-	SpaceSprite *shipSprite;
-	double       specialVelocity;
-	double       specialTurnRate;
-	int          specialDamage;
-	int          specialBounceDistance;
-	int          specialBounceTime;
-	int          specialActive;
-	double       shipTurnRate;
-	int          shipRechargeAmount;
-	double specialMass;
-	double normalMass;
-
-	public:
-	AndrosynthGuardian(Vector2 opos, double angle, ShipData *data, unsigned int code);
-
-	virtual void calculate();
-	virtual void calculate_thrust();
-	virtual void calculate_hotspots();
-
-	virtual void inflict_damage(SpaceObject *other);
-
-	virtual int activate_weapon();
-	virtual int activate_special();
-};
-
-
-
-class ArilouSkiff : public Ship {
-public:
-	int    weaponColor;
-	double weaponRange;
-	int    weaponFrames;
-	int    weaponDamage;
-
-	int just_teleported;
-
-	SpaceSprite *specialSprite;
-	double       specialFrames;
-
-	public:
-	ArilouSkiff(Vector2 opos, double angle, ShipData *data, unsigned int code);
-
-	protected:
-	virtual void inflict_damage(SpaceObject *other);
-	virtual int activate_weapon();
-	virtual int activate_special();
-	virtual void calculate();
-	virtual void calculate_gravity();
-	virtual int accelerate(SpaceLocation *source, double angle, double velocity, 
-			double max_speed);
-	virtual int accelerate_gravwhip(SpaceLocation *source, double angle, double velocity, 
-			double max_speed);
-	};
-
-
-class ChenjesuDOGI ;
-class ChenjesuBroodhome : public Ship
-{
-protected:
-	double		weaponVelocity, shardRange;
-	double		shardDamage, shardArmour;
-	double		shardRelativity;
-	double		weaponDamage, weaponArmour;
-	int			shardRotation;
-	int			weaponFired;
-	Shot		*weaponObject;
-
-	double		specialVelocity;
-	double		specialFuelSap;
-	double		specialArmour;
-	double		specialAccelRate;
-	double		specialMass;
-	double		specialAvoidanceAngle;
-	double		specialAvoidanceFactor;
-	int			specialNumDOGIs;
-
-public:
-	ChenjesuBroodhome(Vector2 opos, double angle, ShipData *data, unsigned int code);
-	virtual int activate_weapon();
-	virtual int activate_special();
-	virtual void calculate();
-};
-
-
-class EarthlingCruiser : public Ship {
-public:
-  double       weaponRange;
-  double       weaponVelocity;
-  int          weaponDamage;
-  int          weaponArmour;
-  double       weaponTurnRate;
-
-  int    specialColor;
-  double specialRange;
-  int    specialFrames;
-  int    specialDamage;
-
-  public:
-  EarthlingCruiser(Vector2 opos, double angle, ShipData *data, unsigned int code);
-
-  protected:
-  virtual int activate_weapon();
-  virtual int activate_special();
-};
-
-
-class IlwrathAvenger : public Ship {
-public:
-	double       weaponRange;
-	double       weaponVelocity;
-	int          weaponDamage;
-	int          weaponArmour;
-
-	int cloak;
-	int cloak_frame;
-
-	public:
-	static int cloak_color[3];
-	IlwrathAvenger(Vector2 opos, double angle, ShipData *data, unsigned int code);
-
-	virtual double isInvisible() const;
-	virtual int activate_weapon();
-	virtual void calculate_fire_special();
-	virtual void calculate_hotspots();
-	virtual void calculate();
-	virtual void animate(Frame *space);
-};
-
-
-class KzerZaDreadnought : public Ship {
-public:
-	double weaponRange;
-	double weaponVelocity;
-	int    weaponDamage;
-	int    weaponArmour;
-
-	int    specialFrames;
-	int    specialLaserDamage;
-	int    specialLaserColor;
-	double specialLaserRange;
-	int    specialLaserFrames;
-	int    specialLaserDrain;
-	double specialVelocity;
-	double specialRange;
-	int    specialArmour;
-
-	public:
-	KzerZaDreadnought(Vector2 opos, double angle, ShipData *data, unsigned int code);
-
-	int activate_weapon();
-	int activate_special();
-	};
-
-
-class MmrnmhrmXForm : public Ship {
-public:
-	struct {
-		public:
-		double       speed_max;
-		double       accel_rate;
-		double       turn_rate;
-		int          recharge_amount;
-		int          recharge_rate;
-		int          weapon_drain;
-		int          weapon_rate;
-		int          hotspot_rate;
-		SpaceSprite *sprite;
-	} form_data[2];
-
-	int form;
-
-	int        laserColor;
-	double     laserRange;
-	double     laserAngle;
-	int        laserDamage;
-	SpaceLine *laser1;
-	SpaceLine *laser2;
-	int        laserSpark;
-
-	double missileRange;
-	double missileVelocity;
-	int    missileDamage;
-	int    missileArmour;
-	double missileTurnRate;
-
-	public:
-	MmrnmhrmXForm(Vector2 opos, double shipAngle, 
-		ShipData *shipData, unsigned int code);
-
-	void calculate();
-	double handle_speed_loss(SpaceLocation *source, double normal);
-
-	int activate_weapon();
-	int activate_special();
-};
-
-
-class MyconPodship : public Ship {
-public:
-	double       weaponRange;
-	double       weaponVelocity;
-	int          weaponDamage;
-	double       weaponHome;
-	int          specialRepair;
-
-	public:
-	MyconPodship(Vector2 opos, double angle, ShipData *data, unsigned int code);
-
-	virtual int activate_weapon();
-	virtual int activate_special();
-};
-
-class ShofixtiScout : public Ship {
-	public:
-	double       weaponRange;
-	double       weaponVelocity;
-	int          weaponDamage;
-	int          weaponArmour;
-
-	double       specialRange;
-	double       specialScale;
-	int          specialFrames;
-	int          specialDamage;
-	int          flipSwitch;
-	int          glory;
-
-	ShofixtiScout(Vector2 opos, double angle, ShipData *data, unsigned int code);
-
-	virtual int activate_weapon();
-	virtual void calculate_fire_special();
-};
-
-
-class SpathiEluder : public Ship {
-public:
-	double       weaponRange;
-	double       weaponVelocity;
-	int          weaponDamage;
-	int          weaponArmour;
-
-	double       specialRange;
-	double       specialVelocity;
-	int          specialDamage;
-	int          specialArmour;
-	double       specialTurnRate;
-
-	public:
-	SpathiEluder(Vector2 opos, double angle, ShipData *data, unsigned int code);
-
-	virtual int activate_weapon();
-	virtual int activate_special();
-};
-
-
-class SyreenPenetrator : public Ship {
-public:
-	double       weaponRange;
-	double       weaponVelocity;
-	int          weaponDamage;
-	int          weaponArmour;
-
-	double       specialRange;
-	double       specialVelocity;
-	int          specialDamage;
-	int          specialFrames;
-
-	public:
-	SyreenPenetrator(Vector2 opos, double angle, ShipData *data, unsigned int code);
-
-	virtual int activate_weapon();
-	virtual int activate_special();
-};
-
-
-class UmgahDrone : public Ship {
-public:
-	int          weaponDamage;
-	int          weaponCone;
-	int          specialRate;
-
-	public:
-
-	int          firing;
-	int          damage_type;
-
-	UmgahDrone(Vector2 opos, double angle, ShipData *data, unsigned int code);
-
-	virtual int activate_weapon();
-	virtual int activate_special();
-	virtual void calculate_thrust();
-	virtual void calculate();
-};
-
-
-class VuxIntruder : public Ship {
-public:
-	int    weaponColor;
-	double weaponRange;
-	int    weaponDamage;
-
-	double specialRange;
-	double specialVelocity;
-	double specialSlowdown;
-	int    specialArmour;
-
-	public:
-	VuxIntruder(Vector2 opos, double angle, ShipData *data, unsigned int code);
-
-	virtual int activate_weapon();
-	virtual int activate_special();
-	virtual SpaceLocation *get_ship_phaser() ;
-	void relocate() ;
-  virtual void animate(Frame *space);
-};
-
-
-class YehatTerminator : public Ship {
-public:
-	double       weaponRange;
-	double       weaponVelocity;
-	int          weaponDamage;
-	int          weaponArmour;
-
-	int          specialFrames;
-	int          shieldFrames;
-
-	public:
-	YehatTerminator(Vector2 opos, double angle, ShipData *data, unsigned int code);
-	virtual double isProtected() const;
-
-	protected:
-	virtual int activate_weapon();
-	virtual int activate_special();
-	virtual void calculate();
-	virtual void animate(Frame *space);
-	virtual int handle_damage(SpaceLocation *source, double normal, double direct);
-};
-

Copied: branches/multiplayer-branch/source/sc2ships/sc2ships.h (from rev 81, branches/multiplayer-branch/source/sc2ships.h)
===================================================================
--- branches/multiplayer-branch/source/sc2ships.h	2004-10-16 21:23:27 UTC (rev 81)
+++ branches/multiplayer-branch/source/sc2ships/sc2ships.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -0,0 +1,297 @@
+/* $Id: sc2ships.h,v 1.7 2004/03/24 23:51:34 yurand Exp $ */ 
+
+#ifndef SC2_SHIP_HEADER
+#define SC1_SHIP_HEADER
+	
+#include &quot;melee/mship.h&quot;
+	
+class ChmmrAvatar : public Ship {
+public:
+  double weaponRange;
+  int    weaponDamage;
+
+  double       specialForce;
+  double       specialRange;
+
+  double extraRange;
+  int    extraDamage;
+  int    extraFrames;
+  int    extraRechargeRate;
+  int    extraColor;
+  int    extraArmour;
+
+  bool   uninterrupted_fire;
+
+  public:
+  ChmmrAvatar(Vector2 opos, double shipAngle, 
+    ShipData *shipData, unsigned int code);
+
+  virtual int activate_weapon();
+  virtual int activate_special();
+  virtual void calculate();
+  virtual void materialize();
+};
+
+class DruugeMauler : public Ship {
+public:
+  double       weaponRange;
+  double       weaponVelocity;
+  int          weaponDamage;
+  int          weaponArmour;
+  double       weaponDriftVelocity;
+
+  public:
+  DruugeMauler(Vector2 opos, double shipAngle,
+    ShipData *shipData, unsigned int code);
+
+  protected:
+  virtual int activate_weapon();
+  virtual void calculate_fire_special();
+};
+
+
+class KohrAhBlade;
+class KohrAhMarauder : public Ship
+{
+  public:
+  double       weaponRange;
+  double       weaponVelocity;
+  int          weaponDamage;
+  int          weaponArmour;
+  int          weaponFired;
+  KohrAhBlade **weaponObject;
+  bool         bladesPersist;
+
+  double       specialVelocity;
+  int          specialDamage;
+  int          specialArmour;
+  double       specialRange;
+
+
+  KohrAhMarauder(Vector2 opos, double shipAngle,
+    ShipData *shipData, unsigned int code);
+
+  virtual int activate_weapon();
+  virtual int activate_special();
+  virtual void calculate();
+
+  int numblades;
+  int maxblades;
+};
+
+
+class MelnormeTrader : public Ship {
+public:
+  double       weaponRange;
+	double       weaponRangeUp;
+  double       weaponVelocity;
+  int          weaponDamage;
+  int          weaponArmour;
+  SpaceObject *weaponObject;
+
+  double       specialRange;
+  double       specialVelocity;
+  int          specialFrames;
+  int          specialArmour;
+
+  public:
+  MelnormeTrader(Vector2 opos, double shipAngle,
+    ShipData *shipData, unsigned int code);
+
+  virtual void calculate();
+
+  virtual int activate_weapon();
+  virtual int activate_special();
+};
+
+
+
+
+#define MAX_MARINES 8
+
+class OrzNemesis;
+class OrzMissile;
+class OrzMarine;
+
+class OrzNemesis : public Ship {
+	public:
+
+	double absorption; //added for gob
+
+        double       turret_turn_step;
+
+	double       weaponRange;
+	double       weaponVelocity;
+	int          weaponDamage;
+	int          weaponArmour;
+
+	double       specialAccelRate;
+	double       specialSpeedMax;
+	int          specialHotspotRate;
+	int          specialArmour;
+	OrzMarine   *marine[MAX_MARINES];
+
+	double       turretAngle;
+
+	int          recoil;
+	int          recoil_rate;
+	int          recoil_range;
+	double       turret_turn_rate;
+
+	OrzNemesis(Vector2 opos, double shipAngle,
+    ShipData *shipData, unsigned int code);
+
+	virtual void calculate();
+	virtual void animate(Frame *space);
+
+	virtual void calculate_turn_left();
+	virtual void calculate_turn_right();
+
+	virtual int activate_weapon();
+	virtual int activate_special();
+	};
+
+
+
+class PkunkFury : public Ship {
+public:
+  int reborn;
+
+  double       weaponRange;
+  double       weaponVelocity;
+  int          weaponDamage;
+  int          weaponArmour;
+
+  public:
+  PkunkFury(Vector2 opos, double shipAngle,
+    ShipData *shipData, unsigned int code);
+
+  virtual int handle_damage(SpaceLocation *source, double normal, double direct);
+  virtual int activate_weapon();
+  virtual void calculate_fire_special();
+};
+
+
+
+class	SlylandroLaserNew;
+
+class SlylandroProbe : public Ship {
+public:
+	int frame;
+	int thrustActive;
+	int thrustForward;
+	int segments;
+	int segment_length, segment_dispersion;
+	int rnd_angle, aiming, dispersion;
+
+	SlylandroLaserNew	*SlyLaser;
+
+	double realturnstep;
+
+	int sprite_index2;
+
+	int last_turn_left, last_turn_right;
+
+public:
+	SlylandroProbe(Vector2 opos, double shipAngle,
+		ShipData *shipData, unsigned int code);
+
+	RGB crewPanelColor(int k = 0);
+
+	virtual void calculate_thrust();
+	virtual void calculate_turn_left();
+	virtual void calculate_turn_right();
+	virtual void calculate_fire_special();
+	virtual void calculate_hotspots();
+	virtual int activate_weapon();
+	virtual void calculate();
+	virtual int accelerate_gravwhip(SpaceLocation *source, double angle, double velocity, double max_speed);
+
+};
+
+
+
+class SupoxBlade : public Ship {
+  public:
+  double       weaponRange;
+  double       weaponVelocity;
+  int          weaponDamage;
+  int          weaponArmour;
+
+  SupoxBlade(Vector2 opos, double shipAngle,
+    ShipData *shipData, unsigned int code);
+
+  virtual void calculate_thrust();
+  virtual void calculate_turn_left();
+  virtual void calculate_turn_right();
+  virtual void calculate_hotspots();
+
+  virtual int activate_weapon();
+  virtual void calculate_fire_special();
+};
+
+
+
+class ThraddashTorch : public Ship {
+public:
+  double       weaponRange;
+  double       weaponVelocity;
+  int          weaponDamage;
+  int          weaponArmour;
+
+  double       specialThrust;
+  int          specialDamage;
+  int          specialArmour;
+
+  public:
+  ThraddashTorch(Vector2 opos, double shipAngle,
+    ShipData *shipData, unsigned int code);
+
+  virtual int activate_weapon();
+  virtual int activate_special();
+  virtual void calculate_thrust();
+};
+
+
+
+class UtwigJugger : public Ship {
+  public:
+
+	int fortitude; //added for gob
+
+  double       weaponRange;
+  double       weaponVelocity;
+  int          weaponDamage;
+  int          weaponArmour;
+
+  UtwigJugger(Vector2 opos, double shipAngle,
+    ShipData *shipData, unsigned int code);
+  virtual void calculate();
+  virtual double isProtected() const;
+
+  protected:
+  virtual void calculate_fire_weapon();
+  virtual void animate(Frame *space);
+  virtual int handle_damage(SpaceLocation *source, double normal, double direct);
+};
+
+
+
+class ZoqFotPikStinger : public Ship {
+  public:
+  double       weaponRange;
+  double       weaponVelocity;
+  int          weaponDamage;
+  int          weaponArmour;
+
+  int          specialDamage;
+
+
+  ZoqFotPikStinger(Vector2 opos, double shipAngle,
+    ShipData *shipData, unsigned int code);
+
+  virtual int activate_weapon();
+  virtual int activate_special();
+};
+
+#endif

Modified: branches/multiplayer-branch/source/sc2ships/shpchmav.cpp
===================================================================
--- branches/multiplayer-branch/source/sc2ships/shpchmav.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/sc2ships/shpchmav.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shpchmav.cpp,v 1.14 2004/03/24 23:51:44 yurand Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -18,7 +18,7 @@
 #include &quot;ship.h&quot;
 
 #include &quot;util/aastr.h&quot;
-#include &quot;sc2ships.h&quot;
+#include &quot;sc2ships/sc2ships.h&quot;
 
 
 class ChmmrLaser : public Laser {

Modified: branches/multiplayer-branch/source/sc2ships/shpdruma.cpp
===================================================================
--- branches/multiplayer-branch/source/sc2ships/shpdruma.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/sc2ships/shpdruma.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shpdruma.cpp,v 1.9 2004/03/24 23:51:44 yurand Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -18,7 +18,7 @@
 #include &quot;ship.h&quot;
 
 
-#include &quot;sc2ships.h&quot;
+#include &quot;sc2ships/sc2ships.h&quot;
 
 class DruugeMissile : public Missile {
   public:

Modified: branches/multiplayer-branch/source/sc2ships/shpkohma.cpp
===================================================================
--- branches/multiplayer-branch/source/sc2ships/shpkohma.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/sc2ships/shpkohma.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shpkohma.cpp,v 1.8 2004/03/24 23:51:44 yurand Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -18,7 +18,7 @@
 #include &quot;ship.h&quot;
 
 
-#include &quot;sc2ships.h&quot;
+#include &quot;sc2ships/sc2ships.h&quot;
 
 class KohrAhBlade : public AnimatedShot {
 	bool persist;

Modified: branches/multiplayer-branch/source/sc2ships/shpmeltr.cpp
===================================================================
--- branches/multiplayer-branch/source/sc2ships/shpmeltr.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/sc2ships/shpmeltr.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shpmeltr.cpp,v 1.11 2004/03/24 23:51:44 yurand Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -18,7 +18,7 @@
 #include &quot;ship.h&quot;
 
 
-#include &quot;sc2ships.h&quot;
+#include &quot;sc2ships/sc2ships.h&quot;
 
 class MelnormeShot : public Shot {
   double v;

Modified: branches/multiplayer-branch/source/sc2ships/shporzne.cpp
===================================================================
--- branches/multiplayer-branch/source/sc2ships/shporzne.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/sc2ships/shporzne.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shporzne.cpp,v 1.16 2004/03/24 23:51:44 yurand Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -20,7 +20,7 @@
 #include &quot;melee/mview.h&quot;
 #include &quot;melee/mcbodies.h&quot;
 
-#include &quot;sc2ships.h&quot;
+#include &quot;sc2ships/sc2ships.h&quot;
 
 class OrzMissile : public Missile {
   public:

Modified: branches/multiplayer-branch/source/sc2ships/shppkufu.cpp
===================================================================
--- branches/multiplayer-branch/source/sc2ships/shppkufu.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/sc2ships/shppkufu.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shppkufu.cpp,v 1.13 2004/03/24 23:51:44 yurand Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -18,7 +18,7 @@
 #include &quot;ship.h&quot;
 #include &quot;melee/mcbodies.h&quot;
 
-#include &quot;sc2ships.h&quot;
+#include &quot;sc2ships/sc2ships.h&quot;
 
 #include &quot;melee/mshppan.h&quot;
 #include &quot;melee/mitems.h&quot;

Modified: branches/multiplayer-branch/source/sc2ships/shpslypr.cpp
===================================================================
--- branches/multiplayer-branch/source/sc2ships/shpslypr.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/sc2ships/shpslypr.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shpslypr.cpp,v 1.15 2004/03/24 23:51:44 yurand Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -18,7 +18,7 @@
 
 #include &quot;ship.h&quot;
 
-#include &quot;sc2ships.h&quot;
+#include &quot;sc2ships/sc2ships.h&quot;
 #include &quot;frame.h&quot;
 
 static const int Ndirections = 16;

Modified: branches/multiplayer-branch/source/sc2ships/shpsupbl.cpp
===================================================================
--- branches/multiplayer-branch/source/sc2ships/shpsupbl.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/sc2ships/shpsupbl.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shpsupbl.cpp,v 1.7 2004/03/24 23:51:44 yurand Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -17,7 +17,7 @@
 
 #include &quot;ship.h&quot;
 
-#include &quot;sc2ships.h&quot;
+#include &quot;sc2ships/sc2ships.h&quot;
 
 SupoxBlade::SupoxBlade(Vector2 opos, double shipAngle,
 	ShipData *shipData, unsigned int code)

Modified: branches/multiplayer-branch/source/sc2ships/shpthrto.cpp
===================================================================
--- branches/multiplayer-branch/source/sc2ships/shpthrto.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/sc2ships/shpthrto.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shpthrto.cpp,v 1.13 2004/03/24 23:51:44 yurand Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -17,7 +17,7 @@
 
 #include &quot;ship.h&quot;
 
-#include &quot;sc2ships.h&quot;
+#include &quot;sc2ships/sc2ships.h&quot;
 
 class ThraddashFlame : public Animation {
   int armour;

Modified: branches/multiplayer-branch/source/sc2ships/shputwju.cpp
===================================================================
--- branches/multiplayer-branch/source/sc2ships/shputwju.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/sc2ships/shputwju.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shputwju.cpp,v 1.7 2004/03/24 23:51:44 yurand Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -19,7 +19,7 @@
 
 #include &quot;frame.h&quot;
 
-#include &quot;sc2ships.h&quot;
+#include &quot;sc2ships/sc2ships.h&quot;
 
 UtwigJugger::UtwigJugger(Vector2 opos, double shipAngle,
 	ShipData *shipData, unsigned int code)

Modified: branches/multiplayer-branch/source/sc2ships/shpzfpst.cpp
===================================================================
--- branches/multiplayer-branch/source/sc2ships/shpzfpst.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/sc2ships/shpzfpst.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shpzfpst.cpp,v 1.11 2004/03/24 23:51:44 yurand Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -19,7 +19,7 @@
 
 #include &lt;math.h&gt;
 
-#include &quot;sc2ships.h&quot;
+#include &quot;sc2ships/sc2ships.h&quot;
 
 class ZoqFotPikShot : public Shot {
   int frame_count;

Deleted: branches/multiplayer-branch/source/sc2ships.h
===================================================================
--- branches/multiplayer-branch/source/sc2ships.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/sc2ships.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,290 +0,0 @@
-/* $Id: sc2ships.h,v 1.7 2004/03/24 23:51:34 yurand Exp $ */ 
-class ChmmrAvatar : public Ship {
-public:
-  double weaponRange;
-  int    weaponDamage;
-
-  double       specialForce;
-  double       specialRange;
-
-  double extraRange;
-  int    extraDamage;
-  int    extraFrames;
-  int    extraRechargeRate;
-  int    extraColor;
-  int    extraArmour;
-
-  bool   uninterrupted_fire;
-
-  public:
-  ChmmrAvatar(Vector2 opos, double shipAngle, 
-    ShipData *shipData, unsigned int code);
-
-  virtual int activate_weapon();
-  virtual int activate_special();
-  virtual void calculate();
-  virtual void materialize();
-};
-
-class DruugeMauler : public Ship {
-public:
-  double       weaponRange;
-  double       weaponVelocity;
-  int          weaponDamage;
-  int          weaponArmour;
-  double       weaponDriftVelocity;
-
-  public:
-  DruugeMauler(Vector2 opos, double shipAngle,
-    ShipData *shipData, unsigned int code);
-
-  protected:
-  virtual int activate_weapon();
-  virtual void calculate_fire_special();
-};
-
-
-class KohrAhBlade;
-class KohrAhMarauder : public Ship
-{
-  public:
-  double       weaponRange;
-  double       weaponVelocity;
-  int          weaponDamage;
-  int          weaponArmour;
-  int          weaponFired;
-  KohrAhBlade **weaponObject;
-  bool         bladesPersist;
-
-  double       specialVelocity;
-  int          specialDamage;
-  int          specialArmour;
-  double       specialRange;
-
-
-  KohrAhMarauder(Vector2 opos, double shipAngle,
-    ShipData *shipData, unsigned int code);
-
-  virtual int activate_weapon();
-  virtual int activate_special();
-  virtual void calculate();
-
-  int numblades;
-  int maxblades;
-};
-
-
-class MelnormeTrader : public Ship {
-public:
-  double       weaponRange;
-	double       weaponRangeUp;
-  double       weaponVelocity;
-  int          weaponDamage;
-  int          weaponArmour;
-  SpaceObject *weaponObject;
-
-  double       specialRange;
-  double       specialVelocity;
-  int          specialFrames;
-  int          specialArmour;
-
-  public:
-  MelnormeTrader(Vector2 opos, double shipAngle,
-    ShipData *shipData, unsigned int code);
-
-  virtual void calculate();
-
-  virtual int activate_weapon();
-  virtual int activate_special();
-};
-
-
-
-
-#define MAX_MARINES 8
-
-class OrzNemesis;
-class OrzMissile;
-class OrzMarine;
-
-class OrzNemesis : public Ship {
-	public:
-
-	double absorption; //added for gob
-
-        double       turret_turn_step;
-
-	double       weaponRange;
-	double       weaponVelocity;
-	int          weaponDamage;
-	int          weaponArmour;
-
-	double       specialAccelRate;
-	double       specialSpeedMax;
-	int          specialHotspotRate;
-	int          specialArmour;
-	OrzMarine   *marine[MAX_MARINES];
-
-	double       turretAngle;
-
-	int          recoil;
-	int          recoil_rate;
-	int          recoil_range;
-	double       turret_turn_rate;
-
-	OrzNemesis(Vector2 opos, double shipAngle,
-    ShipData *shipData, unsigned int code);
-
-	virtual void calculate();
-	virtual void animate(Frame *space);
-
-	virtual void calculate_turn_left();
-	virtual void calculate_turn_right();
-
-	virtual int activate_weapon();
-	virtual int activate_special();
-	};
-
-
-
-class PkunkFury : public Ship {
-public:
-  int reborn;
-
-  double       weaponRange;
-  double       weaponVelocity;
-  int          weaponDamage;
-  int          weaponArmour;
-
-  public:
-  PkunkFury(Vector2 opos, double shipAngle,
-    ShipData *shipData, unsigned int code);
-
-  virtual int handle_damage(SpaceLocation *source, double normal, double direct);
-  virtual int activate_weapon();
-  virtual void calculate_fire_special();
-};
-
-
-
-class	SlylandroLaserNew;
-
-class SlylandroProbe : public Ship {
-public:
-	int frame;
-	int thrustActive;
-	int thrustForward;
-	int segments;
-	int segment_length, segment_dispersion;
-	int rnd_angle, aiming, dispersion;
-
-	SlylandroLaserNew	*SlyLaser;
-
-	double realturnstep;
-
-	int sprite_index2;
-
-	int last_turn_left, last_turn_right;
-
-public:
-	SlylandroProbe(Vector2 opos, double shipAngle,
-		ShipData *shipData, unsigned int code);
-
-	RGB crewPanelColor(int k = 0);
-
-	virtual void calculate_thrust();
-	virtual void calculate_turn_left();
-	virtual void calculate_turn_right();
-	virtual void calculate_fire_special();
-	virtual void calculate_hotspots();
-	virtual int activate_weapon();
-	virtual void calculate();
-	virtual int accelerate_gravwhip(SpaceLocation *source, double angle, double velocity, double max_speed);
-
-};
-
-
-
-class SupoxBlade : public Ship {
-  public:
-  double       weaponRange;
-  double       weaponVelocity;
-  int          weaponDamage;
-  int          weaponArmour;
-
-  SupoxBlade(Vector2 opos, double shipAngle,
-    ShipData *shipData, unsigned int code);
-
-  virtual void calculate_thrust();
-  virtual void calculate_turn_left();
-  virtual void calculate_turn_right();
-  virtual void calculate_hotspots();
-
-  virtual int activate_weapon();
-  virtual void calculate_fire_special();
-};
-
-
-
-class ThraddashTorch : public Ship {
-public:
-  double       weaponRange;
-  double       weaponVelocity;
-  int          weaponDamage;
-  int          weaponArmour;
-
-  double       specialThrust;
-  int          specialDamage;
-  int          specialArmour;
-
-  public:
-  ThraddashTorch(Vector2 opos, double shipAngle,
-    ShipData *shipData, unsigned int code);
-
-  virtual int activate_weapon();
-  virtual int activate_special();
-  virtual void calculate_thrust();
-};
-
-
-
-class UtwigJugger : public Ship {
-  public:
-
-	int fortitude; //added for gob
-
-  double       weaponRange;
-  double       weaponVelocity;
-  int          weaponDamage;
-  int          weaponArmour;
-
-  UtwigJugger(Vector2 opos, double shipAngle,
-    ShipData *shipData, unsigned int code);
-  virtual void calculate();
-  virtual double isProtected() const;
-
-  protected:
-  virtual void calculate_fire_weapon();
-  virtual void animate(Frame *space);
-  virtual int handle_damage(SpaceLocation *source, double normal, double direct);
-};
-
-
-
-class ZoqFotPikStinger : public Ship {
-  public:
-  double       weaponRange;
-  double       weaponVelocity;
-  int          weaponDamage;
-  int          weaponArmour;
-
-  int          specialDamage;
-
-
-  ZoqFotPikStinger(Vector2 opos, double shipAngle,
-    ShipData *shipData, unsigned int code);
-
-  virtual int activate_weapon();
-  virtual int activate_special();
-};
-

Modified: branches/multiplayer-branch/source/scp.cpp
===================================================================
--- branches/multiplayer-branch/source/scp.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/scp.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -520,7 +520,7 @@
 int main(int argc, char *argv[]) {
 	int r;
 	r = tw_main(argc, argv);
-	return r;
+	return 0;
 }
 END_OF_MAIN();
 #endif

Modified: branches/multiplayer-branch/source/scp.h
===================================================================
--- branches/multiplayer-branch/source/scp.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/scp.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: scp.h,v 1.4 2004/08/08 17:36:03 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ship.h
===================================================================
--- branches/multiplayer-branch/source/ship.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ship.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: ship.h,v 1.1.1.1 2004/08/01 10:21:18 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ships/shpaktgu.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpaktgu.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ships/shpaktgu.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shpaktgu.cpp,v 1.1.1.1 2004/08/01 10:21:24 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ships/shpalabc.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpalabc.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ships/shpalabc.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shpalabc.cpp,v 1.1.1.1 2004/08/01 10:21:25 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ships/shpbahbu.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpbahbu.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ships/shpbahbu.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shpbahbu.cpp,v 1.1.1.1 2004/08/01 10:21:26 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ships/shpbipka.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpbipka.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ships/shpbipka.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shpbipka.cpp,v 1.1.1.1 2004/08/01 10:21:26 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ships/shpbogce.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpbogce.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ships/shpbogce.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shpbogce.cpp,v 1.1.1.1 2004/08/01 10:21:24 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ships/shpchoex.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpchoex.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ships/shpchoex.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shpchoex.cpp,v 1.1.1.1 2004/08/01 10:21:25 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ships/shpconca.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpconca.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ships/shpconca.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shpconca.cpp,v 1.1.1.1 2004/08/01 10:21:25 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ships/shpconho.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpconho.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ships/shpconho.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shpconho.cpp,v 1.1.1.1 2004/08/01 10:21:25 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ships/shpdragr.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpdragr.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ships/shpdragr.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shpdragr.cpp,v 1.1.1.1 2004/08/01 10:21:25 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ships/shpearc3.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpearc3.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ships/shpearc3.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shpearc3.cpp,v 1.1.1.1 2004/08/01 10:21:26 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ships/shpforsh.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpforsh.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ships/shpforsh.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shpforsh.cpp,v 1.1.1.1 2004/08/01 10:21:25 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ships/shpgarty.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpgarty.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ships/shpgarty.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shpgarty.cpp,v 1.1.1.1 2004/08/01 10:21:25 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ships/shpilwsp.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpilwsp.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ships/shpilwsp.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shpilwsp.cpp,v 1.1.1.1 2004/08/01 10:21:25 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ships/shpilwsp.h
===================================================================
--- branches/multiplayer-branch/source/ships/shpilwsp.h	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ships/shpilwsp.h	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shpilwsp.h,v 1.1.1.1 2004/08/01 10:21:25 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ships/shpkahbo.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpkahbo.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ships/shpkahbo.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shpkahbo.cpp,v 1.1.1.1 2004/08/01 10:21:26 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ships/shprogsq.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shprogsq.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ships/shprogsq.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shprogsq.cpp,v 1.1.1.1 2004/08/01 10:21:25 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ships/shpstaba.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpstaba.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ships/shpstaba.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shpstaba.cpp,v 1.1.1.1 2004/08/01 10:21:26 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ships/shptauar.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shptauar.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ships/shptauar.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shptauar.cpp,v 1.1.1.1 2004/08/01 10:21:24 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ships/shptauda.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shptauda.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ships/shptauda.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shptauda.cpp,v 1.1.1.1 2004/08/01 10:21:24 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ships/shptaume.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shptaume.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ships/shptaume.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shptaume.cpp,v 1.1.1.1 2004/08/01 10:21:25 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ships/shptausl.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shptausl.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ships/shptausl.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shptausl.cpp,v 1.1.1.1 2004/08/01 10:21:25 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ships/shptaust.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shptaust.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ships/shptaust.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shptaust.cpp,v 1.1.1.1 2004/08/01 10:21:25 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ships/shptauto.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shptauto.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ships/shptauto.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shptauto.cpp,v 1.1.1.1 2004/08/01 10:21:25 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ships/shpwolmi.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpwolmi.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ships/shpwolmi.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shpwolmi.cpp,v 1.1.1.1 2004/08/01 10:21:26 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ships/shpyusra.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpyusra.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ships/shpyusra.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shpyusra.cpp,v 1.1.1.1 2004/08/01 10:21:25 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/source/ships/shpzeksh.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpzeksh.cpp	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/source/ships/shpzeksh.cpp	2004-10-20 08:05:48 UTC (rev 84)
@@ -1,7 +1,7 @@
 /* $Id: shpzeksh.cpp,v 1.1.1.1 2004/08/01 10:21:25 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify

Modified: branches/multiplayer-branch/sources.lst
===================================================================
--- branches/multiplayer-branch/sources.lst	2004-10-19 21:59:09 UTC (rev 83)
+++ branches/multiplayer-branch/sources.lst	2004-10-20 08:05:48 UTC (rev 84)
@@ -7,6 +7,7 @@
 source/games/gflmelee.cpp
 source/games/ggob.cpp
 source/games/gmelee.cpp
+source/games/gup.cpp
 source/games/MultiplayerGame.cpp
 source/gui.cpp
 source/input.cpp
@@ -71,6 +72,7 @@
 source/libraries/raknet/NetworkTypes.cpp
 source/libraries/raknet/PacketPool.cpp
 source/libraries/raknet/RakClient.cpp
+source/libraries/raknet/RakNetStatistics.cpp
 source/libraries/raknet/RakNetworkFactory.cpp
 source/libraries/raknet/RakPeer.cpp
 source/libraries/raknet/RakServer.cpp
@@ -101,10 +103,10 @@
 source/melee/msprite.cpp
 source/melee/mtarget.cpp
 source/melee/mview.cpp
+source/melee/PresenceRegistry.cpp
 source/other/configrw.cpp
 source/other/dialogs.cpp
 source/other/fontmorph.cpp
-source/other/gup.cpp
 source/other/nullphas.cpp
 source/other/objanim.cpp
 source/other/orbit.cpp
@@ -114,67 +116,10 @@
 source/other/twconfig.cpp
 source/other/vbodies.cpp
 source/other/vtarget.cpp
-source/sc1ships/shpandgu.cpp
-source/sc1ships/shparisk.cpp
-source/sc1ships/shpchebr.cpp
-source/sc1ships/shpearcr.cpp
-source/sc1ships/shpilwav.cpp
-source/sc1ships/shpkzedr.cpp
-source/sc1ships/shpmmrxf.cpp
-source/sc1ships/shpmycpo.cpp
-source/sc1ships/shpshosc.cpp
-source/sc1ships/shpspael.cpp
-source/sc1ships/shpsyrpe.cpp
-source/sc1ships/shpumgdr.cpp
-source/sc1ships/shpvuxin.cpp
 source/sc1ships/shpyehte.cpp
-source/sc2ships/shpchmav.cpp
-source/sc2ships/shpdruma.cpp
-source/sc2ships/shpkohma.cpp
-source/sc2ships/shpmeltr.cpp
-source/sc2ships/shporzne.cpp
-source/sc2ships/shppkufu.cpp
-source/sc2ships/shpslypr.cpp
-source/sc2ships/shpsupbl.cpp
-source/sc2ships/shpthrto.cpp
-source/sc2ships/shputwju.cpp
-source/sc2ships/shpzfpst.cpp
 source/scp.cpp
-source/ships/shpaktgu.cpp
-source/ships/shpalabc.cpp
-source/ships/shpbahbu.cpp
-source/ships/shpbipka.cpp
-source/ships/shpbogce.cpp
-source/ships/shpchoex.cpp
-source/ships/shpconca.cpp
-source/ships/shpconho.cpp
-source/ships/shpdragr.cpp
-source/ships/shpearc3.cpp
-source/ships/shpforsh.cpp
-source/ships/shpgarty.cpp
-source/ships/shpilwsp.cpp
-source/ships/shpkahbo.cpp
-source/ships/shprogsq.cpp
-source/ships/shpstaba.cpp
-source/ships/shptauar.cpp
-source/ships/shptauda.cpp
-source/ships/shptaume.cpp
-source/ships/shptausl.cpp
-source/ships/shptaust.cpp
-source/ships/shptauto.cpp
-source/ships/shpwolmi.cpp
-source/ships/shpyusra.cpp
-source/ships/shpzeksh.cpp
 source/tests/testdatapath.cpp
 source/tests/testmain.cpp
-source/twgui/twbutton.cpp
-source/twgui/twbuttontypes.cpp
-source/twgui/twgui.cpp
-source/twgui/twhelpers.cpp
-source/twgui/twmenuexamples.cpp
-source/twgui/twpopup.cpp
-source/twgui/twwindow.cpp
-source/twgui/utils.cpp
 source/util/aarot.c
 source/util/aastr.c
 source/util/aautil.c


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000031.html">[Tw-light-svn] r83 - trunk/web
</A></li>
	<LI>Next message: <A HREF="000033.html">[Tw-light-svn] r85 - trunk/web
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32">[ date ]</a>
              <a href="thread.html#32">[ thread ]</a>
              <a href="subject.html#32">[ subject ]</a>
              <a href="author.html#32">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/tw-light-svn">More information about the Tw-light-svn
mailing list</a><br>
</body></html>
