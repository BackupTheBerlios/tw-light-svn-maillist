<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Tw-light-svn] r164 - in trunk: Util/deditor gamedata/default_ini/ships gamedata/games/test_game/dialogs gamedata/games/test_game/scripts gamedata/games/test_game/scripts/systems gamedata/python source source/ais source/games source/generated source/melee source/other source/python source/tests source/tml source/util
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/tw-light-svn/2005-May/index.html" >
   <LINK REL="made" HREF="mailto:tw-light-svn%40lists.berlios.de?Subject=Re%3A%20%5BTw-light-svn%5D%20r164%20-%20in%20trunk%3A%20Util/deditor%20gamedata/default_ini/ships%20gamedata/games/test_game/dialogs%20gamedata/games/test_game/scripts%20gamedata/games/test_game/scripts/systems%20gamedata/python%20source%20source/ais%20source/games%20source/generated%20source/melee%20source/other%20source/python%20source/tests%20source/tml%20source/util&In-Reply-To=%3C200505161839.j4GIdhoo019700%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000109.html">
   <LINK REL="Next"  HREF="000111.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Tw-light-svn] r164 - in trunk: Util/deditor gamedata/default_ini/ships gamedata/games/test_game/dialogs gamedata/games/test_game/scripts gamedata/games/test_game/scripts/systems gamedata/python source source/ais source/games source/generated source/melee source/other source/python source/tests source/tml source/util</H1>
    <B>Yura Semashko at BerliOS</B> 
    <A HREF="mailto:tw-light-svn%40lists.berlios.de?Subject=Re%3A%20%5BTw-light-svn%5D%20r164%20-%20in%20trunk%3A%20Util/deditor%20gamedata/default_ini/ships%20gamedata/games/test_game/dialogs%20gamedata/games/test_game/scripts%20gamedata/games/test_game/scripts/systems%20gamedata/python%20source%20source/ais%20source/games%20source/generated%20source/melee%20source/other%20source/python%20source/tests%20source/tml%20source/util&In-Reply-To=%3C200505161839.j4GIdhoo019700%40sheep.berlios.de%3E"
       TITLE="[Tw-light-svn] r164 - in trunk: Util/deditor gamedata/default_ini/ships gamedata/games/test_game/dialogs gamedata/games/test_game/scripts gamedata/games/test_game/scripts/systems gamedata/python source source/ais source/games source/generated source/melee source/other source/python source/tests source/tml source/util">yurand at sheep.berlios.de
       </A><BR>
    <I>Mon May 16 20:39:43 CEST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="000109.html">[Tw-light-svn] r163 - in trunk/gamedata: . games games/test_game games/test_game/scripts games/test_game/scripts/systems
</A></li>
        <LI>Next message: <A HREF="000111.html">[Tw-light-svn] r165 - in trunk: gamedata/games/test_game/dialogs gamedata/games/test_game/scripts gamedata/games/test_game/scripts/systems gamedata/images/alien gamedata/python source/generated source/melee source/python source/ships source/tml
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#110">[ date ]</a>
              <a href="thread.html#110">[ thread ]</a>
              <a href="subject.html#110">[ subject ]</a>
              <a href="author.html#110">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: yurand
Date: 2005-05-16 20:39:41 +0200 (Mon, 16 May 2005)
New Revision: 164

Modified:
   trunk/Util/deditor/maindialog.h
   trunk/Util/deditor/maindialog.ui
   trunk/gamedata/default_ini/ships/shpchoex.ini
   trunk/gamedata/games/test_game/dialogs/welcomecommander.xml
   trunk/gamedata/games/test_game/scripts/start.py
   trunk/gamedata/games/test_game/scripts/systems/ixis.py
   trunk/gamedata/python/dialog.py
   trunk/gamedata/python/tml.py
   trunk/source/ais.h
   trunk/source/ais/c_wussie.cpp
   trunk/source/games/ggob.cpp
   trunk/source/games/ggob.h
   trunk/source/generated/tml.py
   trunk/source/generated/tml_wrap.cpp
   trunk/source/melee/mcbodies.cpp
   trunk/source/melee/mcontrol.h
   trunk/source/melee/mframe.cpp
   trunk/source/melee/mframe.h
   trunk/source/melee/mship.cpp
   trunk/source/melee/mship.h
   trunk/source/other/starmap.cpp
   trunk/source/other/starmap.h
   trunk/source/python/python_class.cpp
   trunk/source/scp.cpp
   trunk/source/tests/gameconfigtest.cpp
   trunk/source/tml/eventmanager.cpp
   trunk/source/tml/gameaction.cpp
   trunk/source/tml/gameaction.h
   trunk/source/tml/gameconfig.cpp
   trunk/source/tml/gamedialog.cpp
   trunk/source/tml/gameevent.cpp
   trunk/source/tml/gameevent.h
   trunk/source/util/sound.cpp
Log:
fixed bug with adding objects to different systems


Modified: trunk/Util/deditor/maindialog.h
===================================================================
--- trunk/Util/deditor/maindialog.h	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/Util/deditor/maindialog.h	2005-05-16 18:39:41 UTC (rev 164)
@@ -1,7 +1,7 @@
 /****************************************************************************
 ** Form interface generated from reading ui file 'maindialog.ui'
 **
-** Created: Fri May 6 19:46:21 2005
+** Created: Sat May 14 10:31:25 2005
 **      by: The User Interface Compiler ($Id: qt/main.cpp   3.3.3   edited Nov 24 2003 $)
 **
 ** WARNING! All changes made in this file will be lost!
@@ -17,16 +17,17 @@
 class QHBoxLayout;
 class QGridLayout;
 class QSpacerItem;
+class QSplitter;
+class QTextBrowser;
 class QLabel;
-class QTable;
-class QListView;
-class QListViewItem;
-class QTextBrowser;
 class QMultiLineEdit;
 class QCheckBox;
 class QTabWidget;
 class QLineEdit;
 class QGroupBox;
+class QTable;
+class QListView;
+class QListViewItem;
 
 class DialogEditorGenerated : public QWidget
 {
@@ -36,15 +37,12 @@
     DialogEditorGenerated( QWidget* parent = 0, const char* name = 0, WFlags fl = 0 );
     ~DialogEditorGenerated();
 
-    QLabel* TextLabel3;
-    QLabel* TextLabel12;
-    QLabel* TextLabel13;
-    QTable* triggerTable;
-    QListView* nodeListView;
+    QSplitter* splitter3;
+    QSplitter* splitter2;
+    QSplitter* splitter1;
     QTextBrowser* alienTextBrowser;
     QLabel* TextLabel4;
     QMultiLineEdit* commonMultiLineEdit;
-    QListView* answersListView;
     QCheckBox* TestModeCheckBox;
     QTabWidget* TabWidget2;
     QWidget* tab;
@@ -84,6 +82,12 @@
     QLineEdit* condition5LineEdit;
     QLabel* TextLabel11;
     QLineEdit* action5LineEdit;
+    QLabel* TextLabel3;
+    QLabel* TextLabel12;
+    QLabel* TextLabel13;
+    QTable* triggerTable;
+    QListView* nodeListView;
+    QListView* answersListView;
 
 public slots:
     virtual void answerChangedSlot(QListViewItem*);
@@ -95,9 +99,6 @@
 
 protected:
     QGridLayout* DialogEditorGeneratedLayout;
-    QGridLayout* Layout17;
-    QVBoxLayout* Layout19;
-    QHBoxLayout* Layout18;
     QVBoxLayout* Layout20;
     QVBoxLayout* Layout14;
     QGridLayout* tabLayout;
@@ -113,6 +114,8 @@
     QHBoxLayout* Layout7;
     QHBoxLayout* Layout8;
     QHBoxLayout* Layout9;
+    QVBoxLayout* Layout19;
+    QHBoxLayout* Layout18;
 
 protected slots:
     virtual void languageChange();

Modified: trunk/Util/deditor/maindialog.ui
===================================================================
--- trunk/Util/deditor/maindialog.ui	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/Util/deditor/maindialog.ui	2005-05-16 18:39:41 UTC (rev 164)
@@ -1,1021 +1,836 @@
-&lt;!DOCTYPE UI&gt;&lt;UI&gt;
+&lt;!DOCTYPE UI&gt;&lt;UI version=&quot;3.3&quot; stdsetdef=&quot;1&quot;&gt;
 &lt;class&gt;DialogEditorGenerated&lt;/class&gt;
-&lt;widget&gt;
-    &lt;class&gt;QWidget&lt;/class&gt;
-    &lt;property stdset=&quot;1&quot;&gt;
-        &lt;name&gt;name&lt;/name&gt;
+&lt;widget class=&quot;QWidget&quot;&gt;
+    &lt;property name=&quot;name&quot;&gt;
         &lt;cstring&gt;DialogEditorGenerated&lt;/cstring&gt;
     &lt;/property&gt;
-    &lt;property stdset=&quot;1&quot;&gt;
-        &lt;name&gt;geometry&lt;/name&gt;
+    &lt;property name=&quot;geometry&quot;&gt;
         &lt;rect&gt;
             &lt;x&gt;0&lt;/x&gt;
             &lt;y&gt;0&lt;/y&gt;
-            &lt;width&gt;785&lt;/width&gt;
-            &lt;height&gt;452&lt;/height&gt;
+            &lt;width&gt;870&lt;/width&gt;
+            &lt;height&gt;582&lt;/height&gt;
         &lt;/rect&gt;
     &lt;/property&gt;
-    &lt;property stdset=&quot;1&quot;&gt;
-        &lt;name&gt;caption&lt;/name&gt;
+    &lt;property name=&quot;caption&quot;&gt;
         &lt;string&gt;Form1&lt;/string&gt;
     &lt;/property&gt;
     &lt;grid&gt;
-        &lt;property stdset=&quot;1&quot;&gt;
-            &lt;name&gt;margin&lt;/name&gt;
+        &lt;property name=&quot;name&quot;&gt;
+            &lt;cstring&gt;unnamed&lt;/cstring&gt;
+        &lt;/property&gt;
+        &lt;property name=&quot;margin&quot;&gt;
             &lt;number&gt;11&lt;/number&gt;
         &lt;/property&gt;
-        &lt;property stdset=&quot;1&quot;&gt;
-            &lt;name&gt;spacing&lt;/name&gt;
+        &lt;property name=&quot;spacing&quot;&gt;
             &lt;number&gt;6&lt;/number&gt;
         &lt;/property&gt;
-        &lt;widget row=&quot;0&quot;  column=&quot;0&quot; &gt;
-            &lt;class&gt;QLayoutWidget&lt;/class&gt;
-            &lt;property stdset=&quot;1&quot;&gt;
-                &lt;name&gt;name&lt;/name&gt;
-                &lt;cstring&gt;Layout17&lt;/cstring&gt;
+        &lt;widget class=&quot;QSplitter&quot; row=&quot;0&quot; column=&quot;0&quot;&gt;
+            &lt;property name=&quot;name&quot;&gt;
+                &lt;cstring&gt;splitter3&lt;/cstring&gt;
             &lt;/property&gt;
-            &lt;grid&gt;
-                &lt;property stdset=&quot;1&quot;&gt;
-                    &lt;name&gt;margin&lt;/name&gt;
-                    &lt;number&gt;0&lt;/number&gt;
+            &lt;property name=&quot;orientation&quot;&gt;
+                &lt;enum&gt;Vertical&lt;/enum&gt;
+            &lt;/property&gt;
+            &lt;widget class=&quot;QSplitter&quot;&gt;
+                &lt;property name=&quot;name&quot;&gt;
+                    &lt;cstring&gt;splitter2&lt;/cstring&gt;
                 &lt;/property&gt;
-                &lt;property stdset=&quot;1&quot;&gt;
-                    &lt;name&gt;spacing&lt;/name&gt;
-                    &lt;number&gt;6&lt;/number&gt;
+                &lt;property name=&quot;orientation&quot;&gt;
+                    &lt;enum&gt;Horizontal&lt;/enum&gt;
                 &lt;/property&gt;
-                &lt;widget row=&quot;0&quot;  column=&quot;2&quot; &gt;
-                    &lt;class&gt;QLayoutWidget&lt;/class&gt;
-                    &lt;property stdset=&quot;1&quot;&gt;
-                        &lt;name&gt;name&lt;/name&gt;
+                &lt;widget class=&quot;QSplitter&quot;&gt;
+                    &lt;property name=&quot;name&quot;&gt;
+                        &lt;cstring&gt;splitter1&lt;/cstring&gt;
+                    &lt;/property&gt;
+                    &lt;property name=&quot;orientation&quot;&gt;
+                        &lt;enum&gt;Horizontal&lt;/enum&gt;
+                    &lt;/property&gt;
+                    &lt;widget class=&quot;QLayoutWidget&quot;&gt;
+                        &lt;property name=&quot;name&quot;&gt;
+                            &lt;cstring&gt;Layout20&lt;/cstring&gt;
+                        &lt;/property&gt;
+                        &lt;vbox&gt;
+                            &lt;property name=&quot;name&quot;&gt;
+                                &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                            &lt;/property&gt;
+                            &lt;property name=&quot;margin&quot;&gt;
+                                &lt;number&gt;0&lt;/number&gt;
+                            &lt;/property&gt;
+                            &lt;property name=&quot;spacing&quot;&gt;
+                                &lt;number&gt;6&lt;/number&gt;
+                            &lt;/property&gt;
+                            &lt;widget class=&quot;QTextBrowser&quot;&gt;
+                                &lt;property name=&quot;name&quot;&gt;
+                                    &lt;cstring&gt;alienTextBrowser&lt;/cstring&gt;
+                                &lt;/property&gt;
+                                &lt;property name=&quot;sizePolicy&quot;&gt;
+                                    &lt;sizepolicy&gt;
+                                        &lt;hsizetype&gt;7&lt;/hsizetype&gt;
+                                        &lt;vsizetype&gt;7&lt;/vsizetype&gt;
+                                        &lt;horstretch&gt;0&lt;/horstretch&gt;
+                                        &lt;verstretch&gt;0&lt;/verstretch&gt;
+                                    &lt;/sizepolicy&gt;
+                                &lt;/property&gt;
+                                &lt;property name=&quot;minimumSize&quot;&gt;
+                                    &lt;size&gt;
+                                        &lt;width&gt;200&lt;/width&gt;
+                                        &lt;height&gt;200&lt;/height&gt;
+                                    &lt;/size&gt;
+                                &lt;/property&gt;
+                                &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                    &lt;string&gt;Alian picture, and text here&lt;/string&gt;
+                                &lt;/property&gt;
+                            &lt;/widget&gt;
+                            &lt;widget class=&quot;QLabel&quot;&gt;
+                                &lt;property name=&quot;name&quot;&gt;
+                                    &lt;cstring&gt;TextLabel4&lt;/cstring&gt;
+                                &lt;/property&gt;
+                                &lt;property name=&quot;text&quot;&gt;
+                                    &lt;string&gt;Place text here:&lt;/string&gt;
+                                &lt;/property&gt;
+                            &lt;/widget&gt;
+                            &lt;widget class=&quot;QMultiLineEdit&quot;&gt;
+                                &lt;property name=&quot;name&quot;&gt;
+                                    &lt;cstring&gt;commonMultiLineEdit&lt;/cstring&gt;
+                                &lt;/property&gt;
+                                &lt;property name=&quot;minimumSize&quot;&gt;
+                                    &lt;size&gt;
+                                        &lt;width&gt;0&lt;/width&gt;
+                                        &lt;height&gt;90&lt;/height&gt;
+                                    &lt;/size&gt;
+                                &lt;/property&gt;
+                                &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                    &lt;string&gt;Text in this edit can be set aso player or alian answer.&lt;/string&gt;
+                                &lt;/property&gt;
+                            &lt;/widget&gt;
+                        &lt;/vbox&gt;
+                    &lt;/widget&gt;
+                    &lt;widget class=&quot;QLayoutWidget&quot;&gt;
+                        &lt;property name=&quot;name&quot;&gt;
+                            &lt;cstring&gt;Layout14&lt;/cstring&gt;
+                        &lt;/property&gt;
+                        &lt;vbox&gt;
+                            &lt;property name=&quot;name&quot;&gt;
+                                &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                            &lt;/property&gt;
+                            &lt;property name=&quot;margin&quot;&gt;
+                                &lt;number&gt;0&lt;/number&gt;
+                            &lt;/property&gt;
+                            &lt;property name=&quot;spacing&quot;&gt;
+                                &lt;number&gt;6&lt;/number&gt;
+                            &lt;/property&gt;
+                            &lt;widget class=&quot;QCheckBox&quot;&gt;
+                                &lt;property name=&quot;name&quot;&gt;
+                                    &lt;cstring&gt;TestModeCheckBox&lt;/cstring&gt;
+                                &lt;/property&gt;
+                                &lt;property name=&quot;text&quot;&gt;
+                                    &lt;string&gt;Test Mode (Hide not allowed answers)&lt;/string&gt;
+                                &lt;/property&gt;
+                            &lt;/widget&gt;
+                            &lt;widget class=&quot;QTabWidget&quot;&gt;
+                                &lt;property name=&quot;name&quot;&gt;
+                                    &lt;cstring&gt;TabWidget2&lt;/cstring&gt;
+                                &lt;/property&gt;
+                                &lt;property name=&quot;sizePolicy&quot;&gt;
+                                    &lt;sizepolicy&gt;
+                                        &lt;hsizetype&gt;4&lt;/hsizetype&gt;
+                                        &lt;vsizetype&gt;4&lt;/vsizetype&gt;
+                                        &lt;horstretch&gt;0&lt;/horstretch&gt;
+                                        &lt;verstretch&gt;0&lt;/verstretch&gt;
+                                    &lt;/sizepolicy&gt;
+                                &lt;/property&gt;
+                                &lt;property name=&quot;minimumSize&quot;&gt;
+                                    &lt;size&gt;
+                                        &lt;width&gt;200&lt;/width&gt;
+                                        &lt;height&gt;250&lt;/height&gt;
+                                    &lt;/size&gt;
+                                &lt;/property&gt;
+                                &lt;property name=&quot;margin&quot;&gt;
+                                    &lt;number&gt;0&lt;/number&gt;
+                                &lt;/property&gt;
+                                &lt;widget class=&quot;QWidget&quot;&gt;
+                                    &lt;property name=&quot;name&quot;&gt;
+                                        &lt;cstring&gt;tab&lt;/cstring&gt;
+                                    &lt;/property&gt;
+                                    &lt;attribute name=&quot;title&quot;&gt;
+                                        &lt;string&gt;Node&lt;/string&gt;
+                                    &lt;/attribute&gt;
+                                    &lt;grid&gt;
+                                        &lt;property name=&quot;name&quot;&gt;
+                                            &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;margin&quot;&gt;
+                                            &lt;number&gt;11&lt;/number&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;spacing&quot;&gt;
+                                            &lt;number&gt;6&lt;/number&gt;
+                                        &lt;/property&gt;
+                                        &lt;widget class=&quot;QLayoutWidget&quot; row=&quot;0&quot; column=&quot;0&quot;&gt;
+                                            &lt;property name=&quot;name&quot;&gt;
+                                                &lt;cstring&gt;Layout15&lt;/cstring&gt;
+                                            &lt;/property&gt;
+                                            &lt;grid&gt;
+                                                &lt;property name=&quot;name&quot;&gt;
+                                                    &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                                                &lt;/property&gt;
+                                                &lt;property name=&quot;margin&quot;&gt;
+                                                    &lt;number&gt;0&lt;/number&gt;
+                                                &lt;/property&gt;
+                                                &lt;property name=&quot;spacing&quot;&gt;
+                                                    &lt;number&gt;6&lt;/number&gt;
+                                                &lt;/property&gt;
+                                                &lt;widget class=&quot;QLineEdit&quot; row=&quot;5&quot; column=&quot;1&quot; rowspan=&quot;1&quot; colspan=&quot;2&quot;&gt;
+                                                    &lt;property name=&quot;name&quot;&gt;
+                                                        &lt;cstring&gt;textLocationLineEdit&lt;/cstring&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;alignment&quot;&gt;
+                                                        &lt;set&gt;AlignLeft&lt;/set&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;hAlign&quot; stdset=&quot;0&quot;&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                        &lt;string&gt;Alien text location&lt;/string&gt;
+                                                    &lt;/property&gt;
+                                                &lt;/widget&gt;
+                                                &lt;widget class=&quot;QLineEdit&quot; row=&quot;1&quot; column=&quot;1&quot; rowspan=&quot;1&quot; colspan=&quot;2&quot;&gt;
+                                                    &lt;property name=&quot;name&quot;&gt;
+                                                        &lt;cstring&gt;NodeNameLineEdit&lt;/cstring&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;alignment&quot;&gt;
+                                                        &lt;set&gt;AlignLeft&lt;/set&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;hAlign&quot; stdset=&quot;0&quot;&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                        &lt;string&gt;Name is not used&lt;/string&gt;
+                                                    &lt;/property&gt;
+                                                &lt;/widget&gt;
+                                                &lt;widget class=&quot;QLabel&quot; row=&quot;4&quot; column=&quot;0&quot;&gt;
+                                                    &lt;property name=&quot;name&quot;&gt;
+                                                        &lt;cstring&gt;TextLabel1_3&lt;/cstring&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;text&quot;&gt;
+                                                        &lt;string&gt;Font:&lt;/string&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                        &lt;string&gt;Alien text font&lt;/string&gt;
+                                                    &lt;/property&gt;
+                                                &lt;/widget&gt;
+                                                &lt;widget class=&quot;QLineEdit&quot; row=&quot;4&quot; column=&quot;1&quot; rowspan=&quot;1&quot; colspan=&quot;2&quot;&gt;
+                                                    &lt;property name=&quot;name&quot;&gt;
+                                                        &lt;cstring&gt;fontLineEdit&lt;/cstring&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;alignment&quot;&gt;
+                                                        &lt;set&gt;AlignLeft&lt;/set&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;hAlign&quot; stdset=&quot;0&quot;&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                        &lt;string&gt;Alien text font&lt;/string&gt;
+                                                    &lt;/property&gt;
+                                                &lt;/widget&gt;
+                                                &lt;widget class=&quot;QLabel&quot; row=&quot;2&quot; column=&quot;0&quot;&gt;
+                                                    &lt;property name=&quot;name&quot;&gt;
+                                                        &lt;cstring&gt;TextLabel3_2&lt;/cstring&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;text&quot;&gt;
+                                                        &lt;string&gt;Music&lt;/string&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                        &lt;string&gt;Path to music file&lt;/string&gt;
+                                                    &lt;/property&gt;
+                                                &lt;/widget&gt;
+                                                &lt;widget class=&quot;QLabel&quot; row=&quot;0&quot; column=&quot;0&quot;&gt;
+                                                    &lt;property name=&quot;name&quot;&gt;
+                                                        &lt;cstring&gt;TextLabel1&lt;/cstring&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;text&quot;&gt;
+                                                        &lt;string&gt;Node ID&lt;/string&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                        &lt;string&gt;unique identifier for node&lt;/string&gt;
+                                                    &lt;/property&gt;
+                                                &lt;/widget&gt;
+                                                &lt;widget class=&quot;QLabel&quot; row=&quot;5&quot; column=&quot;0&quot;&gt;
+                                                    &lt;property name=&quot;name&quot;&gt;
+                                                        &lt;cstring&gt;TextLabel2_3&lt;/cstring&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;text&quot;&gt;
+                                                        &lt;string&gt;Text location:&lt;/string&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                        &lt;string&gt;Alien text location&lt;/string&gt;
+                                                    &lt;/property&gt;
+                                                &lt;/widget&gt;
+                                                &lt;widget class=&quot;QLabel&quot; row=&quot;3&quot; column=&quot;0&quot;&gt;
+                                                    &lt;property name=&quot;name&quot;&gt;
+                                                        &lt;cstring&gt;TextLabel4_2&lt;/cstring&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;text&quot;&gt;
+                                                        &lt;string&gt;Background&lt;/string&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                        &lt;string&gt;Path to background picture&lt;/string&gt;
+                                                    &lt;/property&gt;
+                                                &lt;/widget&gt;
+                                                &lt;spacer row=&quot;0&quot; column=&quot;1&quot;&gt;
+                                                    &lt;property name=&quot;name&quot;&gt;
+                                                        &lt;cstring&gt;Spacer1&lt;/cstring&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;orientation&quot;&gt;
+                                                        &lt;enum&gt;Horizontal&lt;/enum&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;sizeType&quot;&gt;
+                                                        &lt;enum&gt;Expanding&lt;/enum&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;sizeHint&quot;&gt;
+                                                        &lt;size&gt;
+                                                            &lt;width&gt;20&lt;/width&gt;
+                                                            &lt;height&gt;20&lt;/height&gt;
+                                                        &lt;/size&gt;
+                                                    &lt;/property&gt;
+                                                &lt;/spacer&gt;
+                                                &lt;widget class=&quot;QLineEdit&quot; row=&quot;2&quot; column=&quot;1&quot; rowspan=&quot;1&quot; colspan=&quot;2&quot;&gt;
+                                                    &lt;property name=&quot;name&quot;&gt;
+                                                        &lt;cstring&gt;MusicEdit&lt;/cstring&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;alignment&quot;&gt;
+                                                        &lt;set&gt;AlignLeft&lt;/set&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;hAlign&quot; stdset=&quot;0&quot;&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                        &lt;string&gt;Path to music file&lt;/string&gt;
+                                                    &lt;/property&gt;
+                                                &lt;/widget&gt;
+                                                &lt;widget class=&quot;QLineEdit&quot; row=&quot;3&quot; column=&quot;1&quot; rowspan=&quot;1&quot; colspan=&quot;2&quot;&gt;
+                                                    &lt;property name=&quot;name&quot;&gt;
+                                                        &lt;cstring&gt;BackgroundLineEdit&lt;/cstring&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;alignment&quot;&gt;
+                                                        &lt;set&gt;AlignLeft&lt;/set&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;hAlign&quot; stdset=&quot;0&quot;&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                        &lt;string&gt;Path to background picture&lt;/string&gt;
+                                                    &lt;/property&gt;
+                                                &lt;/widget&gt;
+                                                &lt;widget class=&quot;QLabel&quot; row=&quot;1&quot; column=&quot;0&quot;&gt;
+                                                    &lt;property name=&quot;name&quot;&gt;
+                                                        &lt;cstring&gt;TextLabel2&lt;/cstring&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;text&quot;&gt;
+                                                        &lt;string&gt;Node Name&lt;/string&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                        &lt;string&gt;Name is not used&lt;/string&gt;
+                                                    &lt;/property&gt;
+                                                &lt;/widget&gt;
+                                                &lt;widget class=&quot;QLineEdit&quot; row=&quot;0&quot; column=&quot;2&quot;&gt;
+                                                    &lt;property name=&quot;name&quot;&gt;
+                                                        &lt;cstring&gt;nodeIdLineEdit&lt;/cstring&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;alignment&quot;&gt;
+                                                        &lt;set&gt;AlignRight&lt;/set&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;hAlign&quot; stdset=&quot;0&quot;&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                        &lt;string&gt;unique identifier for node&lt;/string&gt;
+                                                    &lt;/property&gt;
+                                                &lt;/widget&gt;
+                                            &lt;/grid&gt;
+                                        &lt;/widget&gt;
+                                    &lt;/grid&gt;
+                                &lt;/widget&gt;
+                                &lt;widget class=&quot;QWidget&quot;&gt;
+                                    &lt;property name=&quot;name&quot;&gt;
+                                        &lt;cstring&gt;tab&lt;/cstring&gt;
+                                    &lt;/property&gt;
+                                    &lt;attribute name=&quot;title&quot;&gt;
+                                        &lt;string&gt;Answer&lt;/string&gt;
+                                    &lt;/attribute&gt;
+                                    &lt;vbox&gt;
+                                        &lt;property name=&quot;name&quot;&gt;
+                                            &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;margin&quot;&gt;
+                                            &lt;number&gt;11&lt;/number&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;spacing&quot;&gt;
+                                            &lt;number&gt;6&lt;/number&gt;
+                                        &lt;/property&gt;
+                                        &lt;widget class=&quot;QLayoutWidget&quot;&gt;
+                                            &lt;property name=&quot;name&quot;&gt;
+                                                &lt;cstring&gt;Layout12&lt;/cstring&gt;
+                                            &lt;/property&gt;
+                                            &lt;vbox&gt;
+                                                &lt;property name=&quot;name&quot;&gt;
+                                                    &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                                                &lt;/property&gt;
+                                                &lt;property name=&quot;margin&quot;&gt;
+                                                    &lt;number&gt;0&lt;/number&gt;
+                                                &lt;/property&gt;
+                                                &lt;property name=&quot;spacing&quot;&gt;
+                                                    &lt;number&gt;6&lt;/number&gt;
+                                                &lt;/property&gt;
+                                                &lt;widget class=&quot;QLayoutWidget&quot;&gt;
+                                                    &lt;property name=&quot;name&quot;&gt;
+                                                        &lt;cstring&gt;Layout11&lt;/cstring&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;hbox&gt;
+                                                        &lt;property name=&quot;name&quot;&gt;
+                                                            &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                                                        &lt;/property&gt;
+                                                        &lt;property name=&quot;margin&quot;&gt;
+                                                            &lt;number&gt;0&lt;/number&gt;
+                                                        &lt;/property&gt;
+                                                        &lt;property name=&quot;spacing&quot;&gt;
+                                                            &lt;number&gt;6&lt;/number&gt;
+                                                        &lt;/property&gt;
+                                                        &lt;widget class=&quot;QLabel&quot;&gt;
+                                                            &lt;property name=&quot;name&quot;&gt;
+                                                                &lt;cstring&gt;TextLabel1_2&lt;/cstring&gt;
+                                                            &lt;/property&gt;
+                                                            &lt;property name=&quot;text&quot;&gt;
+                                                                &lt;string&gt;Appear condition:&lt;/string&gt;
+                                                            &lt;/property&gt;
+                                                        &lt;/widget&gt;
+                                                        &lt;widget class=&quot;QLineEdit&quot;&gt;
+                                                            &lt;property name=&quot;name&quot;&gt;
+                                                                &lt;cstring&gt;appearConditionLineEdit&lt;/cstring&gt;
+                                                            &lt;/property&gt;
+                                                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                                &lt;string&gt;Answer will not show, if doesn.t match&lt;/string&gt;
+                                                            &lt;/property&gt;
+                                                        &lt;/widget&gt;
+                                                    &lt;/hbox&gt;
+                                                &lt;/widget&gt;
+                                                &lt;widget class=&quot;QGroupBox&quot;&gt;
+                                                    &lt;property name=&quot;name&quot;&gt;
+                                                        &lt;cstring&gt;GroupBox1&lt;/cstring&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;title&quot;&gt;
+                                                        &lt;string&gt;Actions&lt;/string&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;hbox&gt;
+                                                        &lt;property name=&quot;name&quot;&gt;
+                                                            &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                                                        &lt;/property&gt;
+                                                        &lt;property name=&quot;margin&quot;&gt;
+                                                            &lt;number&gt;11&lt;/number&gt;
+                                                        &lt;/property&gt;
+                                                        &lt;property name=&quot;spacing&quot;&gt;
+                                                            &lt;number&gt;6&lt;/number&gt;
+                                                        &lt;/property&gt;
+                                                        &lt;widget class=&quot;QLayoutWidget&quot;&gt;
+                                                            &lt;property name=&quot;name&quot;&gt;
+                                                                &lt;cstring&gt;Layout10&lt;/cstring&gt;
+                                                            &lt;/property&gt;
+                                                            &lt;vbox&gt;
+                                                                &lt;property name=&quot;name&quot;&gt;
+                                                                    &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                                                                &lt;/property&gt;
+                                                                &lt;property name=&quot;margin&quot;&gt;
+                                                                    &lt;number&gt;0&lt;/number&gt;
+                                                                &lt;/property&gt;
+                                                                &lt;property name=&quot;spacing&quot;&gt;
+                                                                    &lt;number&gt;6&lt;/number&gt;
+                                                                &lt;/property&gt;
+                                                                &lt;widget class=&quot;QLayoutWidget&quot;&gt;
+                                                                    &lt;property name=&quot;name&quot;&gt;
+                                                                        &lt;cstring&gt;Layout5&lt;/cstring&gt;
+                                                                    &lt;/property&gt;
+                                                                    &lt;hbox&gt;
+                                                                        &lt;property name=&quot;name&quot;&gt;
+                                                                            &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                                                                        &lt;/property&gt;
+                                                                        &lt;property name=&quot;margin&quot;&gt;
+                                                                            &lt;number&gt;0&lt;/number&gt;
+                                                                        &lt;/property&gt;
+                                                                        &lt;property name=&quot;spacing&quot;&gt;
+                                                                            &lt;number&gt;6&lt;/number&gt;
+                                                                        &lt;/property&gt;
+                                                                        &lt;widget class=&quot;QLabel&quot;&gt;
+                                                                            &lt;property name=&quot;name&quot;&gt;
+                                                                                &lt;cstring&gt;TextLabel2_2&lt;/cstring&gt;
+                                                                            &lt;/property&gt;
+                                                                            &lt;property name=&quot;text&quot;&gt;
+                                                                                &lt;string&gt;condition&lt;/string&gt;
+                                                                            &lt;/property&gt;
+                                                                        &lt;/widget&gt;
+                                                                        &lt;widget class=&quot;QLineEdit&quot;&gt;
+                                                                            &lt;property name=&quot;name&quot;&gt;
+                                                                                &lt;cstring&gt;condition1LineEdit&lt;/cstring&gt;
+                                                                            &lt;/property&gt;
+                                                                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                                                &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
+                                                                            &lt;/property&gt;
+                                                                        &lt;/widget&gt;
+                                                                        &lt;widget class=&quot;QLabel&quot;&gt;
+                                                                            &lt;property name=&quot;name&quot;&gt;
+                                                                                &lt;cstring&gt;TextLabel7&lt;/cstring&gt;
+                                                                            &lt;/property&gt;
+                                                                            &lt;property name=&quot;text&quot;&gt;
+                                                                                &lt;string&gt;do&lt;/string&gt;
+                                                                            &lt;/property&gt;
+                                                                        &lt;/widget&gt;
+                                                                        &lt;widget class=&quot;QLineEdit&quot;&gt;
+                                                                            &lt;property name=&quot;name&quot;&gt;
+                                                                                &lt;cstring&gt;action1LineEdit&lt;/cstring&gt;
+                                                                            &lt;/property&gt;
+                                                                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                                                &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
+                                                                            &lt;/property&gt;
+                                                                        &lt;/widget&gt;
+                                                                    &lt;/hbox&gt;
+                                                                &lt;/widget&gt;
+                                                                &lt;widget class=&quot;QLayoutWidget&quot;&gt;
+                                                                    &lt;property name=&quot;name&quot;&gt;
+                                                                        &lt;cstring&gt;Layout6&lt;/cstring&gt;
+                                                                    &lt;/property&gt;
+                                                                    &lt;hbox&gt;
+                                                                        &lt;property name=&quot;name&quot;&gt;
+                                                                            &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                                                                        &lt;/property&gt;
+                                                                        &lt;property name=&quot;margin&quot;&gt;
+                                                                            &lt;number&gt;0&lt;/number&gt;
+                                                                        &lt;/property&gt;
+                                                                        &lt;property name=&quot;spacing&quot;&gt;
+                                                                            &lt;number&gt;6&lt;/number&gt;
+                                                                        &lt;/property&gt;
+                                                                        &lt;widget class=&quot;QLabel&quot;&gt;
+                                                                            &lt;property name=&quot;name&quot;&gt;
+                                                                                &lt;cstring&gt;TextLabel3_3&lt;/cstring&gt;
+                                                                            &lt;/property&gt;
+                                                                            &lt;property name=&quot;text&quot;&gt;
+                                                                                &lt;string&gt;condition&lt;/string&gt;
+                                                                            &lt;/property&gt;
+                                                                        &lt;/widget&gt;
+                                                                        &lt;widget class=&quot;QLineEdit&quot;&gt;
+                                                                            &lt;property name=&quot;name&quot;&gt;
+                                                                                &lt;cstring&gt;condition2LineEdit&lt;/cstring&gt;
+                                                                            &lt;/property&gt;
+                                                                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                                                &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
+                                                                            &lt;/property&gt;
+                                                                        &lt;/widget&gt;
+                                                                        &lt;widget class=&quot;QLabel&quot;&gt;
+                                                                            &lt;property name=&quot;name&quot;&gt;
+                                                                                &lt;cstring&gt;TextLabel8&lt;/cstring&gt;
+                                                                            &lt;/property&gt;
+                                                                            &lt;property name=&quot;text&quot;&gt;
+                                                                                &lt;string&gt;do&lt;/string&gt;
+                                                                            &lt;/property&gt;
+                                                                        &lt;/widget&gt;
+                                                                        &lt;widget class=&quot;QLineEdit&quot;&gt;
+                                                                            &lt;property name=&quot;name&quot;&gt;
+                                                                                &lt;cstring&gt;action2LineEdit&lt;/cstring&gt;
+                                                                            &lt;/property&gt;
+                                                                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                                                &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
+                                                                            &lt;/property&gt;
+                                                                        &lt;/widget&gt;
+                                                                    &lt;/hbox&gt;
+                                                                &lt;/widget&gt;
+                                                                &lt;widget class=&quot;QLayoutWidget&quot;&gt;
+                                                                    &lt;property name=&quot;name&quot;&gt;
+                                                                        &lt;cstring&gt;Layout7&lt;/cstring&gt;
+                                                                    &lt;/property&gt;
+                                                                    &lt;hbox&gt;
+                                                                        &lt;property name=&quot;name&quot;&gt;
+                                                                            &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                                                                        &lt;/property&gt;
+                                                                        &lt;property name=&quot;margin&quot;&gt;
+                                                                            &lt;number&gt;0&lt;/number&gt;
+                                                                        &lt;/property&gt;
+                                                                        &lt;property name=&quot;spacing&quot;&gt;
+                                                                            &lt;number&gt;6&lt;/number&gt;
+                                                                        &lt;/property&gt;
+                                                                        &lt;widget class=&quot;QLabel&quot;&gt;
+                                                                            &lt;property name=&quot;name&quot;&gt;
+                                                                                &lt;cstring&gt;TextLabel4_3&lt;/cstring&gt;
+                                                                            &lt;/property&gt;
+                                                                            &lt;property name=&quot;text&quot;&gt;
+                                                                                &lt;string&gt;condition&lt;/string&gt;
+                                                                            &lt;/property&gt;
+                                                                        &lt;/widget&gt;
+                                                                        &lt;widget class=&quot;QLineEdit&quot;&gt;
+                                                                            &lt;property name=&quot;name&quot;&gt;
+                                                                                &lt;cstring&gt;condition3LineEdit&lt;/cstring&gt;
+                                                                            &lt;/property&gt;
+                                                                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                                                &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
+                                                                            &lt;/property&gt;
+                                                                        &lt;/widget&gt;
+                                                                        &lt;widget class=&quot;QLabel&quot;&gt;
+                                                                            &lt;property name=&quot;name&quot;&gt;
+                                                                                &lt;cstring&gt;TextLabel9&lt;/cstring&gt;
+                                                                            &lt;/property&gt;
+                                                                            &lt;property name=&quot;text&quot;&gt;
+                                                                                &lt;string&gt;do&lt;/string&gt;
+                                                                            &lt;/property&gt;
+                                                                        &lt;/widget&gt;
+                                                                        &lt;widget class=&quot;QLineEdit&quot;&gt;
+                                                                            &lt;property name=&quot;name&quot;&gt;
+                                                                                &lt;cstring&gt;action3LineEdit&lt;/cstring&gt;
+                                                                            &lt;/property&gt;
+                                                                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                                                &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
+                                                                            &lt;/property&gt;
+                                                                        &lt;/widget&gt;
+                                                                    &lt;/hbox&gt;
+                                                                &lt;/widget&gt;
+                                                                &lt;widget class=&quot;QLayoutWidget&quot;&gt;
+                                                                    &lt;property name=&quot;name&quot;&gt;
+                                                                        &lt;cstring&gt;Layout8&lt;/cstring&gt;
+                                                                    &lt;/property&gt;
+                                                                    &lt;hbox&gt;
+                                                                        &lt;property name=&quot;name&quot;&gt;
+                                                                            &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                                                                        &lt;/property&gt;
+                                                                        &lt;property name=&quot;margin&quot;&gt;
+                                                                            &lt;number&gt;0&lt;/number&gt;
+                                                                        &lt;/property&gt;
+                                                                        &lt;property name=&quot;spacing&quot;&gt;
+                                                                            &lt;number&gt;6&lt;/number&gt;
+                                                                        &lt;/property&gt;
+                                                                        &lt;widget class=&quot;QLabel&quot;&gt;
+                                                                            &lt;property name=&quot;name&quot;&gt;
+                                                                                &lt;cstring&gt;TextLabel5&lt;/cstring&gt;
+                                                                            &lt;/property&gt;
+                                                                            &lt;property name=&quot;text&quot;&gt;
+                                                                                &lt;string&gt;condition&lt;/string&gt;
+                                                                            &lt;/property&gt;
+                                                                        &lt;/widget&gt;
+                                                                        &lt;widget class=&quot;QLineEdit&quot;&gt;
+                                                                            &lt;property name=&quot;name&quot;&gt;
+                                                                                &lt;cstring&gt;condition4LineEdit&lt;/cstring&gt;
+                                                                            &lt;/property&gt;
+                                                                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                                                &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
+                                                                            &lt;/property&gt;
+                                                                        &lt;/widget&gt;
+                                                                        &lt;widget class=&quot;QLabel&quot;&gt;
+                                                                            &lt;property name=&quot;name&quot;&gt;
+                                                                                &lt;cstring&gt;TextLabel10&lt;/cstring&gt;
+                                                                            &lt;/property&gt;
+                                                                            &lt;property name=&quot;text&quot;&gt;
+                                                                                &lt;string&gt;do&lt;/string&gt;
+                                                                            &lt;/property&gt;
+                                                                        &lt;/widget&gt;
+                                                                        &lt;widget class=&quot;QLineEdit&quot;&gt;
+                                                                            &lt;property name=&quot;name&quot;&gt;
+                                                                                &lt;cstring&gt;action4LineEdit&lt;/cstring&gt;
+                                                                            &lt;/property&gt;
+                                                                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                                                &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
+                                                                            &lt;/property&gt;
+                                                                        &lt;/widget&gt;
+                                                                    &lt;/hbox&gt;
+                                                                &lt;/widget&gt;
+                                                                &lt;widget class=&quot;QLayoutWidget&quot;&gt;
+                                                                    &lt;property name=&quot;name&quot;&gt;
+                                                                        &lt;cstring&gt;Layout9&lt;/cstring&gt;
+                                                                    &lt;/property&gt;
+                                                                    &lt;hbox&gt;
+                                                                        &lt;property name=&quot;name&quot;&gt;
+                                                                            &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                                                                        &lt;/property&gt;
+                                                                        &lt;property name=&quot;margin&quot;&gt;
+                                                                            &lt;number&gt;0&lt;/number&gt;
+                                                                        &lt;/property&gt;
+                                                                        &lt;property name=&quot;spacing&quot;&gt;
+                                                                            &lt;number&gt;6&lt;/number&gt;
+                                                                        &lt;/property&gt;
+                                                                        &lt;widget class=&quot;QLabel&quot;&gt;
+                                                                            &lt;property name=&quot;name&quot;&gt;
+                                                                                &lt;cstring&gt;TextLabel6&lt;/cstring&gt;
+                                                                            &lt;/property&gt;
+                                                                            &lt;property name=&quot;text&quot;&gt;
+                                                                                &lt;string&gt;condition&lt;/string&gt;
+                                                                            &lt;/property&gt;
+                                                                        &lt;/widget&gt;
+                                                                        &lt;widget class=&quot;QLineEdit&quot;&gt;
+                                                                            &lt;property name=&quot;name&quot;&gt;
+                                                                                &lt;cstring&gt;condition5LineEdit&lt;/cstring&gt;
+                                                                            &lt;/property&gt;
+                                                                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                                                &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
+                                                                            &lt;/property&gt;
+                                                                        &lt;/widget&gt;
+                                                                        &lt;widget class=&quot;QLabel&quot;&gt;
+                                                                            &lt;property name=&quot;name&quot;&gt;
+                                                                                &lt;cstring&gt;TextLabel11&lt;/cstring&gt;
+                                                                            &lt;/property&gt;
+                                                                            &lt;property name=&quot;text&quot;&gt;
+                                                                                &lt;string&gt;do&lt;/string&gt;
+                                                                            &lt;/property&gt;
+                                                                        &lt;/widget&gt;
+                                                                        &lt;widget class=&quot;QLineEdit&quot;&gt;
+                                                                            &lt;property name=&quot;name&quot;&gt;
+                                                                                &lt;cstring&gt;action5LineEdit&lt;/cstring&gt;
+                                                                            &lt;/property&gt;
+                                                                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                                                &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
+                                                                            &lt;/property&gt;
+                                                                        &lt;/widget&gt;
+                                                                    &lt;/hbox&gt;
+                                                                &lt;/widget&gt;
+                                                            &lt;/vbox&gt;
+                                                        &lt;/widget&gt;
+                                                    &lt;/hbox&gt;
+                                                &lt;/widget&gt;
+                                            &lt;/vbox&gt;
+                                        &lt;/widget&gt;
+                                    &lt;/vbox&gt;
+                                &lt;/widget&gt;
+                            &lt;/widget&gt;
+                        &lt;/vbox&gt;
+                    &lt;/widget&gt;
+                &lt;/widget&gt;
+                &lt;widget class=&quot;QLayoutWidget&quot;&gt;
+                    &lt;property name=&quot;name&quot;&gt;
                         &lt;cstring&gt;Layout19&lt;/cstring&gt;
                     &lt;/property&gt;
                     &lt;vbox&gt;
-                        &lt;property stdset=&quot;1&quot;&gt;
-                            &lt;name&gt;margin&lt;/name&gt;
+                        &lt;property name=&quot;name&quot;&gt;
+                            &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                        &lt;/property&gt;
+                        &lt;property name=&quot;margin&quot;&gt;
                             &lt;number&gt;0&lt;/number&gt;
                         &lt;/property&gt;
-                        &lt;property stdset=&quot;1&quot;&gt;
-                            &lt;name&gt;spacing&lt;/name&gt;
+                        &lt;property name=&quot;spacing&quot;&gt;
                             &lt;number&gt;6&lt;/number&gt;
                         &lt;/property&gt;
-                        &lt;widget&gt;
-                            &lt;class&gt;QLayoutWidget&lt;/class&gt;
-                            &lt;property stdset=&quot;1&quot;&gt;
-                                &lt;name&gt;name&lt;/name&gt;
+                        &lt;widget class=&quot;QLayoutWidget&quot;&gt;
+                            &lt;property name=&quot;name&quot;&gt;
                                 &lt;cstring&gt;Layout18&lt;/cstring&gt;
                             &lt;/property&gt;
                             &lt;hbox&gt;
-                                &lt;property stdset=&quot;1&quot;&gt;
-                                    &lt;name&gt;margin&lt;/name&gt;
+                                &lt;property name=&quot;name&quot;&gt;
+                                    &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                                &lt;/property&gt;
+                                &lt;property name=&quot;margin&quot;&gt;
                                     &lt;number&gt;0&lt;/number&gt;
                                 &lt;/property&gt;
-                                &lt;property stdset=&quot;1&quot;&gt;
-                                    &lt;name&gt;spacing&lt;/name&gt;
+                                &lt;property name=&quot;spacing&quot;&gt;
                                     &lt;number&gt;6&lt;/number&gt;
                                 &lt;/property&gt;
-                                &lt;widget&gt;
-                                    &lt;class&gt;QLabel&lt;/class&gt;
-                                    &lt;property stdset=&quot;1&quot;&gt;
-                                        &lt;name&gt;name&lt;/name&gt;
+                                &lt;widget class=&quot;QLabel&quot;&gt;
+                                    &lt;property name=&quot;name&quot;&gt;
                                         &lt;cstring&gt;TextLabel3&lt;/cstring&gt;
                                     &lt;/property&gt;
-                                    &lt;property stdset=&quot;1&quot;&gt;
-                                        &lt;name&gt;text&lt;/name&gt;
+                                    &lt;property name=&quot;text&quot;&gt;
                                         &lt;string&gt;Triggers:&lt;/string&gt;
                                     &lt;/property&gt;
                                 &lt;/widget&gt;
-                                &lt;widget&gt;
-                                    &lt;class&gt;QLabel&lt;/class&gt;
-                                    &lt;property stdset=&quot;1&quot;&gt;
-                                        &lt;name&gt;name&lt;/name&gt;
+                                &lt;widget class=&quot;QLabel&quot;&gt;
+                                    &lt;property name=&quot;name&quot;&gt;
                                         &lt;cstring&gt;TextLabel12&lt;/cstring&gt;
                                     &lt;/property&gt;
-                                    &lt;property stdset=&quot;1&quot;&gt;
-                                        &lt;name&gt;text&lt;/name&gt;
+                                    &lt;property name=&quot;text&quot;&gt;
                                         &lt;string&gt;Name&lt;/string&gt;
                                     &lt;/property&gt;
                                 &lt;/widget&gt;
-                                &lt;widget&gt;
-                                    &lt;class&gt;QLabel&lt;/class&gt;
-                                    &lt;property stdset=&quot;1&quot;&gt;
-                                        &lt;name&gt;name&lt;/name&gt;
+                                &lt;widget class=&quot;QLabel&quot;&gt;
+                                    &lt;property name=&quot;name&quot;&gt;
                                         &lt;cstring&gt;TextLabel13&lt;/cstring&gt;
                                     &lt;/property&gt;
-                                    &lt;property stdset=&quot;1&quot;&gt;
-                                        &lt;name&gt;text&lt;/name&gt;
+                                    &lt;property name=&quot;text&quot;&gt;
                                         &lt;string&gt;Value&lt;/string&gt;
                                     &lt;/property&gt;
                                 &lt;/widget&gt;
                             &lt;/hbox&gt;
                         &lt;/widget&gt;
-                        &lt;widget&gt;
-                            &lt;class&gt;QTable&lt;/class&gt;
-                            &lt;property stdset=&quot;1&quot;&gt;
-                                &lt;name&gt;name&lt;/name&gt;
+                        &lt;widget class=&quot;QTable&quot;&gt;
+                            &lt;property name=&quot;name&quot;&gt;
                                 &lt;cstring&gt;triggerTable&lt;/cstring&gt;
                             &lt;/property&gt;
-                            &lt;property stdset=&quot;1&quot;&gt;
-                                &lt;name&gt;maximumSize&lt;/name&gt;
+                            &lt;property name=&quot;maximumSize&quot;&gt;
                                 &lt;size&gt;
                                     &lt;width&gt;200&lt;/width&gt;
                                     &lt;height&gt;32767&lt;/height&gt;
                                 &lt;/size&gt;
                             &lt;/property&gt;
-                            &lt;property stdset=&quot;1&quot;&gt;
-                                &lt;name&gt;numRows&lt;/name&gt;
+                            &lt;property name=&quot;numRows&quot;&gt;
                                 &lt;number&gt;6&lt;/number&gt;
                             &lt;/property&gt;
-                            &lt;property stdset=&quot;1&quot;&gt;
-                                &lt;name&gt;numCols&lt;/name&gt;
+                            &lt;property name=&quot;numCols&quot;&gt;
                                 &lt;number&gt;6&lt;/number&gt;
                             &lt;/property&gt;
-                            &lt;property&gt;
-                                &lt;name&gt;whatsThis&lt;/name&gt;
+                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
                                 &lt;string&gt;First column - trigger name, second - value&lt;/string&gt;
                             &lt;/property&gt;
                         &lt;/widget&gt;
-                        &lt;widget&gt;
-                            &lt;class&gt;QListView&lt;/class&gt;
+                        &lt;widget class=&quot;QListView&quot;&gt;
                             &lt;column&gt;
-                                &lt;property&gt;
-                                    &lt;name&gt;text&lt;/name&gt;
+                                &lt;property name=&quot;text&quot;&gt;
                                     &lt;string&gt;ID&lt;/string&gt;
                                 &lt;/property&gt;
-                                &lt;property&gt;
-                                    &lt;name&gt;clickable&lt;/name&gt;
+                                &lt;property name=&quot;clickable&quot;&gt;
                                     &lt;bool&gt;true&lt;/bool&gt;
                                 &lt;/property&gt;
-                                &lt;property&gt;
-                                    &lt;name&gt;resizeable&lt;/name&gt;
+                                &lt;property name=&quot;resizable&quot;&gt;
                                     &lt;bool&gt;true&lt;/bool&gt;
                                 &lt;/property&gt;
                             &lt;/column&gt;
                             &lt;column&gt;
-                                &lt;property&gt;
-                                    &lt;name&gt;text&lt;/name&gt;
+                                &lt;property name=&quot;text&quot;&gt;
                                     &lt;string&gt;Name&lt;/string&gt;
                                 &lt;/property&gt;
-                                &lt;property&gt;
-                                    &lt;name&gt;clickable&lt;/name&gt;
+                                &lt;property name=&quot;clickable&quot;&gt;
                                     &lt;bool&gt;true&lt;/bool&gt;
                                 &lt;/property&gt;
-                                &lt;property&gt;
-                                    &lt;name&gt;resizeable&lt;/name&gt;
+                                &lt;property name=&quot;resizable&quot;&gt;
                                     &lt;bool&gt;true&lt;/bool&gt;
                                 &lt;/property&gt;
                             &lt;/column&gt;
-                            &lt;property stdset=&quot;1&quot;&gt;
-                                &lt;name&gt;name&lt;/name&gt;
+                            &lt;property name=&quot;name&quot;&gt;
                                 &lt;cstring&gt;nodeListView&lt;/cstring&gt;
                             &lt;/property&gt;
-                            &lt;property stdset=&quot;1&quot;&gt;
-                                &lt;name&gt;sizePolicy&lt;/name&gt;
+                            &lt;property name=&quot;sizePolicy&quot;&gt;
                                 &lt;sizepolicy&gt;
                                     &lt;hsizetype&gt;7&lt;/hsizetype&gt;
                                     &lt;vsizetype&gt;5&lt;/vsizetype&gt;
+                                    &lt;horstretch&gt;0&lt;/horstretch&gt;
+                                    &lt;verstretch&gt;0&lt;/verstretch&gt;
                                 &lt;/sizepolicy&gt;
                             &lt;/property&gt;
-                            &lt;property stdset=&quot;1&quot;&gt;
-                                &lt;name&gt;maximumSize&lt;/name&gt;
+                            &lt;property name=&quot;maximumSize&quot;&gt;
                                 &lt;size&gt;
                                     &lt;width&gt;200&lt;/width&gt;
                                     &lt;height&gt;32767&lt;/height&gt;
                                 &lt;/size&gt;
                             &lt;/property&gt;
-                            &lt;property&gt;
-                                &lt;name&gt;whatsThis&lt;/name&gt;
+                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
                                 &lt;string&gt;Browse nodes from here&lt;/string&gt;
                             &lt;/property&gt;
                         &lt;/widget&gt;
                     &lt;/vbox&gt;
                 &lt;/widget&gt;
-                &lt;widget row=&quot;0&quot;  column=&quot;0&quot; &gt;
-                    &lt;class&gt;QLayoutWidget&lt;/class&gt;
-                    &lt;property stdset=&quot;1&quot;&gt;
-                        &lt;name&gt;name&lt;/name&gt;
-                        &lt;cstring&gt;Layout20&lt;/cstring&gt;
+            &lt;/widget&gt;
+            &lt;widget class=&quot;QListView&quot;&gt;
+                &lt;column&gt;
+                    &lt;property name=&quot;text&quot;&gt;
+                        &lt;string&gt;Player answers&lt;/string&gt;
                     &lt;/property&gt;
-                    &lt;vbox&gt;
-                        &lt;property stdset=&quot;1&quot;&gt;
-                            &lt;name&gt;margin&lt;/name&gt;
-                            &lt;number&gt;0&lt;/number&gt;
-                        &lt;/property&gt;
-                        &lt;property stdset=&quot;1&quot;&gt;
-                            &lt;name&gt;spacing&lt;/name&gt;
-                            &lt;number&gt;6&lt;/number&gt;
-                        &lt;/property&gt;
-                        &lt;widget&gt;
-                            &lt;class&gt;QTextBrowser&lt;/class&gt;
-                            &lt;property stdset=&quot;1&quot;&gt;
-                                &lt;name&gt;name&lt;/name&gt;
-                                &lt;cstring&gt;alienTextBrowser&lt;/cstring&gt;
-                            &lt;/property&gt;
-                            &lt;property stdset=&quot;1&quot;&gt;
-                                &lt;name&gt;sizePolicy&lt;/name&gt;
-                                &lt;sizepolicy&gt;
-                                    &lt;hsizetype&gt;7&lt;/hsizetype&gt;
-                                    &lt;vsizetype&gt;7&lt;/vsizetype&gt;
-                                &lt;/sizepolicy&gt;
-                            &lt;/property&gt;
-                            &lt;property stdset=&quot;1&quot;&gt;
-                                &lt;name&gt;minimumSize&lt;/name&gt;
-                                &lt;size&gt;
-                                    &lt;width&gt;200&lt;/width&gt;
-                                    &lt;height&gt;200&lt;/height&gt;
-                                &lt;/size&gt;
-                            &lt;/property&gt;
-                            &lt;property&gt;
-                                &lt;name&gt;whatsThis&lt;/name&gt;
-                                &lt;string&gt;Alian picture, and text here&lt;/string&gt;
-                            &lt;/property&gt;
-                        &lt;/widget&gt;
-                        &lt;widget&gt;
-                            &lt;class&gt;QLabel&lt;/class&gt;
-                            &lt;property stdset=&quot;1&quot;&gt;
-                                &lt;name&gt;name&lt;/name&gt;
-                                &lt;cstring&gt;TextLabel4&lt;/cstring&gt;
-                            &lt;/property&gt;
-                            &lt;property stdset=&quot;1&quot;&gt;
-                                &lt;name&gt;text&lt;/name&gt;
-                                &lt;string&gt;Place text here:&lt;/string&gt;
-                            &lt;/property&gt;
-                        &lt;/widget&gt;
-                        &lt;widget&gt;
-                            &lt;class&gt;QMultiLineEdit&lt;/class&gt;
-                            &lt;property stdset=&quot;1&quot;&gt;
-                                &lt;name&gt;name&lt;/name&gt;
-                                &lt;cstring&gt;commonMultiLineEdit&lt;/cstring&gt;
-                            &lt;/property&gt;
-                            &lt;property stdset=&quot;1&quot;&gt;
-                                &lt;name&gt;minimumSize&lt;/name&gt;
-                                &lt;size&gt;
-                                    &lt;width&gt;0&lt;/width&gt;
-                                    &lt;height&gt;90&lt;/height&gt;
-                                &lt;/size&gt;
-                            &lt;/property&gt;
-                            &lt;property&gt;
-                                &lt;name&gt;whatsThis&lt;/name&gt;
-                                &lt;string&gt;Text in this edit can be set aso player or alian answer.&lt;/string&gt;
-                            &lt;/property&gt;
-                        &lt;/widget&gt;
-                    &lt;/vbox&gt;
-                &lt;/widget&gt;
-                &lt;widget row=&quot;1&quot;  column=&quot;0&quot;  rowspan=&quot;1&quot;  colspan=&quot;3&quot; &gt;
-                    &lt;class&gt;QListView&lt;/class&gt;
-                    &lt;column&gt;
-                        &lt;property&gt;
-                            &lt;name&gt;text&lt;/name&gt;
-                            &lt;string&gt;Player answers&lt;/string&gt;
-                        &lt;/property&gt;
-                        &lt;property&gt;
-                            &lt;name&gt;clickable&lt;/name&gt;
-                            &lt;bool&gt;true&lt;/bool&gt;
-                        &lt;/property&gt;
-                        &lt;property&gt;
-                            &lt;name&gt;resizeable&lt;/name&gt;
-                            &lt;bool&gt;true&lt;/bool&gt;
-                        &lt;/property&gt;
-                    &lt;/column&gt;
-                    &lt;property stdset=&quot;1&quot;&gt;
-                        &lt;name&gt;name&lt;/name&gt;
-                        &lt;cstring&gt;answersListView&lt;/cstring&gt;
+                    &lt;property name=&quot;clickable&quot;&gt;
+                        &lt;bool&gt;true&lt;/bool&gt;
                     &lt;/property&gt;
-                    &lt;property&gt;
-                        &lt;name&gt;whatsThis&lt;/name&gt;
-                        &lt;string&gt;Player Answers&lt;/string&gt;
+                    &lt;property name=&quot;resizable&quot;&gt;
+                        &lt;bool&gt;true&lt;/bool&gt;
                     &lt;/property&gt;
-                &lt;/widget&gt;
-                &lt;widget row=&quot;0&quot;  column=&quot;1&quot; &gt;
-                    &lt;class&gt;QLayoutWidget&lt;/class&gt;
-                    &lt;property stdset=&quot;1&quot;&gt;
-                        &lt;name&gt;name&lt;/name&gt;
-                        &lt;cstring&gt;Layout14&lt;/cstring&gt;
-                    &lt;/property&gt;
-                    &lt;vbox&gt;
-                        &lt;property stdset=&quot;1&quot;&gt;
-                            &lt;name&gt;margin&lt;/name&gt;
-                            &lt;number&gt;0&lt;/number&gt;
-                        &lt;/property&gt;
-                        &lt;property stdset=&quot;1&quot;&gt;
-                            &lt;name&gt;spacing&lt;/name&gt;
-                            &lt;number&gt;6&lt;/number&gt;
-                        &lt;/property&gt;
-                        &lt;widget&gt;
-                            &lt;class&gt;QCheckBox&lt;/class&gt;
-                            &lt;property stdset=&quot;1&quot;&gt;
-                                &lt;name&gt;name&lt;/name&gt;
-                                &lt;cstring&gt;TestModeCheckBox&lt;/cstring&gt;
-                            &lt;/property&gt;
-                            &lt;property stdset=&quot;1&quot;&gt;
-                                &lt;name&gt;text&lt;/name&gt;
-                                &lt;string&gt;Test Mode (Hide not allowed answers)&lt;/string&gt;
-                            &lt;/property&gt;
-                        &lt;/widget&gt;
-                        &lt;widget&gt;
-                            &lt;class&gt;QTabWidget&lt;/class&gt;
-                            &lt;property stdset=&quot;1&quot;&gt;
-                                &lt;name&gt;name&lt;/name&gt;
-                                &lt;cstring&gt;TabWidget2&lt;/cstring&gt;
-                            &lt;/property&gt;
-                            &lt;property stdset=&quot;1&quot;&gt;
-                                &lt;name&gt;sizePolicy&lt;/name&gt;
-                                &lt;sizepolicy&gt;
-                                    &lt;hsizetype&gt;4&lt;/hsizetype&gt;
-                                    &lt;vsizetype&gt;4&lt;/vsizetype&gt;
-                                &lt;/sizepolicy&gt;
-                            &lt;/property&gt;
-                            &lt;property stdset=&quot;1&quot;&gt;
-                                &lt;name&gt;minimumSize&lt;/name&gt;
-                                &lt;size&gt;
-                                    &lt;width&gt;200&lt;/width&gt;
-                                    &lt;height&gt;250&lt;/height&gt;
-                                &lt;/size&gt;
-                            &lt;/property&gt;
-                            &lt;property stdset=&quot;1&quot;&gt;
-                                &lt;name&gt;margin&lt;/name&gt;
-                                &lt;number&gt;0&lt;/number&gt;
-                            &lt;/property&gt;
-                            &lt;widget&gt;
-                                &lt;class&gt;QWidget&lt;/class&gt;
-                                &lt;property stdset=&quot;1&quot;&gt;
-                                    &lt;name&gt;name&lt;/name&gt;
-                                    &lt;cstring&gt;tab&lt;/cstring&gt;
-                                &lt;/property&gt;
-                                &lt;attribute&gt;
-                                    &lt;name&gt;title&lt;/name&gt;
-                                    &lt;string&gt;Node&lt;/string&gt;
-                                &lt;/attribute&gt;
-                                &lt;grid&gt;
-                                    &lt;property stdset=&quot;1&quot;&gt;
-                                        &lt;name&gt;margin&lt;/name&gt;
-                                        &lt;number&gt;11&lt;/number&gt;
-                                    &lt;/property&gt;
-                                    &lt;property stdset=&quot;1&quot;&gt;
-                                        &lt;name&gt;spacing&lt;/name&gt;
-                                        &lt;number&gt;6&lt;/number&gt;
-                                    &lt;/property&gt;
-                                    &lt;widget row=&quot;0&quot;  column=&quot;0&quot; &gt;
-                                        &lt;class&gt;QLayoutWidget&lt;/class&gt;
-                                        &lt;property stdset=&quot;1&quot;&gt;
-                                            &lt;name&gt;name&lt;/name&gt;
-                                            &lt;cstring&gt;Layout15&lt;/cstring&gt;
-                                        &lt;/property&gt;
-                                        &lt;grid&gt;
-                                            &lt;property stdset=&quot;1&quot;&gt;
-                                                &lt;name&gt;margin&lt;/name&gt;
-                                                &lt;number&gt;0&lt;/number&gt;
-                                            &lt;/property&gt;
-                                            &lt;property stdset=&quot;1&quot;&gt;
-                                                &lt;name&gt;spacing&lt;/name&gt;
-                                                &lt;number&gt;6&lt;/number&gt;
-                                            &lt;/property&gt;
-                                            &lt;widget row=&quot;5&quot;  column=&quot;1&quot;  rowspan=&quot;1&quot;  colspan=&quot;2&quot; &gt;
-                                                &lt;class&gt;QLineEdit&lt;/class&gt;
-                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                    &lt;name&gt;name&lt;/name&gt;
-                                                    &lt;cstring&gt;textLocationLineEdit&lt;/cstring&gt;
-                                                &lt;/property&gt;
-                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                    &lt;name&gt;alignment&lt;/name&gt;
-                                                    &lt;set&gt;AlignLeft&lt;/set&gt;
-                                                &lt;/property&gt;
-                                                &lt;property&gt;
-                                                    &lt;name&gt;hAlign&lt;/name&gt;
-                                                &lt;/property&gt;
-                                                &lt;property&gt;
-                                                    &lt;name&gt;whatsThis&lt;/name&gt;
-                                                    &lt;string&gt;Alien text location&lt;/string&gt;
-                                                &lt;/property&gt;
-                                            &lt;/widget&gt;
-                                            &lt;widget row=&quot;1&quot;  column=&quot;1&quot;  rowspan=&quot;1&quot;  colspan=&quot;2&quot; &gt;
-                                                &lt;class&gt;QLineEdit&lt;/class&gt;
-                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                    &lt;name&gt;name&lt;/name&gt;
-                                                    &lt;cstring&gt;NodeNameLineEdit&lt;/cstring&gt;
-                                                &lt;/property&gt;
-                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                    &lt;name&gt;alignment&lt;/name&gt;
-                                                    &lt;set&gt;AlignLeft&lt;/set&gt;
-                                                &lt;/property&gt;
-                                                &lt;property&gt;
-                                                    &lt;name&gt;hAlign&lt;/name&gt;
-                                                &lt;/property&gt;
-                                                &lt;property&gt;
-                                                    &lt;name&gt;whatsThis&lt;/name&gt;
-                                                    &lt;string&gt;Name is not used&lt;/string&gt;
-                                                &lt;/property&gt;
-                                            &lt;/widget&gt;
-                                            &lt;widget row=&quot;4&quot;  column=&quot;0&quot; &gt;
-                                                &lt;class&gt;QLabel&lt;/class&gt;
-                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                    &lt;name&gt;name&lt;/name&gt;
-                                                    &lt;cstring&gt;TextLabel1_3&lt;/cstring&gt;
-                                                &lt;/property&gt;
-                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                    &lt;name&gt;text&lt;/name&gt;
-                                                    &lt;string&gt;Font:&lt;/string&gt;
-                                                &lt;/property&gt;
-                                                &lt;property&gt;
-                                                    &lt;name&gt;whatsThis&lt;/name&gt;
-                                                    &lt;string&gt;Alien text font&lt;/string&gt;
-                                                &lt;/property&gt;
-                                            &lt;/widget&gt;
-                                            &lt;widget row=&quot;4&quot;  column=&quot;1&quot;  rowspan=&quot;1&quot;  colspan=&quot;2&quot; &gt;
-                                                &lt;class&gt;QLineEdit&lt;/class&gt;
-                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                    &lt;name&gt;name&lt;/name&gt;
-                                                    &lt;cstring&gt;fontLineEdit&lt;/cstring&gt;
-                                                &lt;/property&gt;
-                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                    &lt;name&gt;alignment&lt;/name&gt;
-                                                    &lt;set&gt;AlignLeft&lt;/set&gt;
-                                                &lt;/property&gt;
-                                                &lt;property&gt;
-                                                    &lt;name&gt;hAlign&lt;/name&gt;
-                                                &lt;/property&gt;
-                                                &lt;property&gt;
-                                                    &lt;name&gt;whatsThis&lt;/name&gt;
-                                                    &lt;string&gt;Alien text font&lt;/string&gt;
-                                                &lt;/property&gt;
-                                            &lt;/widget&gt;
-                                            &lt;widget row=&quot;2&quot;  column=&quot;0&quot; &gt;
-                                                &lt;class&gt;QLabel&lt;/class&gt;
-                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                    &lt;name&gt;name&lt;/name&gt;
-                                                    &lt;cstring&gt;TextLabel3_2&lt;/cstring&gt;
-                                                &lt;/property&gt;
-                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                    &lt;name&gt;text&lt;/name&gt;
-                                                    &lt;string&gt;Music&lt;/string&gt;
-                                                &lt;/property&gt;
-                                                &lt;property&gt;
-                                                    &lt;name&gt;whatsThis&lt;/name&gt;
-                                                    &lt;string&gt;Path to music file&lt;/string&gt;
-                                                &lt;/property&gt;
-                                            &lt;/widget&gt;
-                                            &lt;widget row=&quot;0&quot;  column=&quot;0&quot; &gt;
-                                                &lt;class&gt;QLabel&lt;/class&gt;
-                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                    &lt;name&gt;name&lt;/name&gt;
-                                                    &lt;cstring&gt;TextLabel1&lt;/cstring&gt;
-                                                &lt;/property&gt;
-                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                    &lt;name&gt;text&lt;/name&gt;
-                                                    &lt;string&gt;Node ID&lt;/string&gt;
-                                                &lt;/property&gt;
-                                                &lt;property&gt;
-                                                    &lt;name&gt;whatsThis&lt;/name&gt;
-                                                    &lt;string&gt;unique identifier for node&lt;/string&gt;
-                                                &lt;/property&gt;
-                                            &lt;/widget&gt;
-                                            &lt;widget row=&quot;5&quot;  column=&quot;0&quot; &gt;
-                                                &lt;class&gt;QLabel&lt;/class&gt;
-                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                    &lt;name&gt;name&lt;/name&gt;
-                                                    &lt;cstring&gt;TextLabel2_3&lt;/cstring&gt;
-                                                &lt;/property&gt;
-                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                    &lt;name&gt;text&lt;/name&gt;
-                                                    &lt;string&gt;Text location:&lt;/string&gt;
-                                                &lt;/property&gt;
-                                                &lt;property&gt;
-                                                    &lt;name&gt;whatsThis&lt;/name&gt;
-                                                    &lt;string&gt;Alien text location&lt;/string&gt;
-                                                &lt;/property&gt;
-                                            &lt;/widget&gt;
-                                            &lt;widget row=&quot;3&quot;  column=&quot;0&quot; &gt;
-                                                &lt;class&gt;QLabel&lt;/class&gt;
-                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                    &lt;name&gt;name&lt;/name&gt;
-                                                    &lt;cstring&gt;TextLabel4_2&lt;/cstring&gt;
-                                                &lt;/property&gt;
-                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                    &lt;name&gt;text&lt;/name&gt;
-                                                    &lt;string&gt;Background&lt;/string&gt;
-                                                &lt;/property&gt;
-                                                &lt;property&gt;
-                                                    &lt;name&gt;whatsThis&lt;/name&gt;
-                                                    &lt;string&gt;Path to background picture&lt;/string&gt;
-                                                &lt;/property&gt;
-                                            &lt;/widget&gt;
-                                            &lt;spacer row=&quot;0&quot;  column=&quot;1&quot; &gt;
-                                                &lt;property&gt;
-                                                    &lt;name&gt;name&lt;/name&gt;
-                                                    &lt;cstring&gt;Spacer1&lt;/cstring&gt;
-                                                &lt;/property&gt;
-                                                &lt;property&gt;
-                                                    &lt;name&gt;orientation&lt;/name&gt;
-                                                    &lt;enum&gt;Horizontal&lt;/enum&gt;
-                                                &lt;/property&gt;
-                                                &lt;property&gt;
-                                                    &lt;name&gt;sizeType&lt;/name&gt;
-                                                    &lt;enum&gt;Expanding&lt;/enum&gt;
-                                                &lt;/property&gt;
-                                                &lt;property&gt;
-                                                    &lt;name&gt;sizeHint&lt;/name&gt;
-                                                    &lt;size&gt;
-                                                        &lt;width&gt;20&lt;/width&gt;
-                                                        &lt;height&gt;20&lt;/height&gt;
-                                                    &lt;/size&gt;
-                                                &lt;/property&gt;
-                                            &lt;/spacer&gt;
-                                            &lt;widget row=&quot;2&quot;  column=&quot;1&quot;  rowspan=&quot;1&quot;  colspan=&quot;2&quot; &gt;
-                                                &lt;class&gt;QLineEdit&lt;/class&gt;
-                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                    &lt;name&gt;name&lt;/name&gt;
-                                                    &lt;cstring&gt;MusicEdit&lt;/cstring&gt;
-                                                &lt;/property&gt;
-                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                    &lt;name&gt;alignment&lt;/name&gt;
-                                                    &lt;set&gt;AlignLeft&lt;/set&gt;
-                                                &lt;/property&gt;
-                                                &lt;property&gt;
-                                                    &lt;name&gt;hAlign&lt;/name&gt;
-                                                &lt;/property&gt;
-                                                &lt;property&gt;
-                                                    &lt;name&gt;whatsThis&lt;/name&gt;
-                                                    &lt;string&gt;Path to music file&lt;/string&gt;
-                                                &lt;/property&gt;
-                                            &lt;/widget&gt;
-                                            &lt;widget row=&quot;3&quot;  column=&quot;1&quot;  rowspan=&quot;1&quot;  colspan=&quot;2&quot; &gt;
-                                                &lt;class&gt;QLineEdit&lt;/class&gt;
-                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                    &lt;name&gt;name&lt;/name&gt;
-                                                    &lt;cstring&gt;BackgroundLineEdit&lt;/cstring&gt;
-                                                &lt;/property&gt;
-                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                    &lt;name&gt;alignment&lt;/name&gt;
-                                                    &lt;set&gt;AlignLeft&lt;/set&gt;
-                                                &lt;/property&gt;
-                                                &lt;property&gt;
-                                                    &lt;name&gt;hAlign&lt;/name&gt;
-                                                &lt;/property&gt;
-                                                &lt;property&gt;
-                                                    &lt;name&gt;whatsThis&lt;/name&gt;
-                                                    &lt;string&gt;Path to background picture&lt;/string&gt;
-                                                &lt;/property&gt;
-                                            &lt;/widget&gt;
-                                            &lt;widget row=&quot;1&quot;  column=&quot;0&quot; &gt;
-                                                &lt;class&gt;QLabel&lt;/class&gt;
-                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                    &lt;name&gt;name&lt;/name&gt;
-                                                    &lt;cstring&gt;TextLabel2&lt;/cstring&gt;
-                                                &lt;/property&gt;
-                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                    &lt;name&gt;text&lt;/name&gt;
-                                                    &lt;string&gt;Node Name&lt;/string&gt;
-                                                &lt;/property&gt;
-                                                &lt;property&gt;
-                                                    &lt;name&gt;whatsThis&lt;/name&gt;
-                                                    &lt;string&gt;Name is not used&lt;/string&gt;
-                                                &lt;/property&gt;
-                                            &lt;/widget&gt;
-                                            &lt;widget row=&quot;0&quot;  column=&quot;2&quot; &gt;
-                                                &lt;class&gt;QLineEdit&lt;/class&gt;
-                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                    &lt;name&gt;name&lt;/name&gt;
-                                                    &lt;cstring&gt;nodeIdLineEdit&lt;/cstring&gt;
-                                                &lt;/property&gt;
-                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                    &lt;name&gt;alignment&lt;/name&gt;
-                                                    &lt;set&gt;AlignRight&lt;/set&gt;
-                                                &lt;/property&gt;
-                                                &lt;property&gt;
-                                                    &lt;name&gt;hAlign&lt;/name&gt;
-                                                &lt;/property&gt;
-                                                &lt;property&gt;
-                                                    &lt;name&gt;whatsThis&lt;/name&gt;
-                                                    &lt;string&gt;unique identifier for node&lt;/string&gt;
-                                                &lt;/property&gt;
-                                            &lt;/widget&gt;
-                                        &lt;/grid&gt;
-                                    &lt;/widget&gt;
-                                &lt;/grid&gt;
-                            &lt;/widget&gt;
-                            &lt;widget&gt;
-                                &lt;class&gt;QWidget&lt;/class&gt;
-                                &lt;property stdset=&quot;1&quot;&gt;
-                                    &lt;name&gt;name&lt;/name&gt;
-                                    &lt;cstring&gt;tab&lt;/cstring&gt;
-                                &lt;/property&gt;
-                                &lt;attribute&gt;
-                                    &lt;name&gt;title&lt;/name&gt;
-                                    &lt;string&gt;Answer&lt;/string&gt;
-                                &lt;/attribute&gt;
-                                &lt;vbox&gt;
-                                    &lt;property stdset=&quot;1&quot;&gt;
-                                        &lt;name&gt;margin&lt;/name&gt;
-                                        &lt;number&gt;11&lt;/number&gt;
-                                    &lt;/property&gt;
-                                    &lt;property stdset=&quot;1&quot;&gt;
-                                        &lt;name&gt;spacing&lt;/name&gt;
-                                        &lt;number&gt;6&lt;/number&gt;
-                                    &lt;/property&gt;
-                                    &lt;widget&gt;
-                                        &lt;class&gt;QLayoutWidget&lt;/class&gt;
-                                        &lt;property stdset=&quot;1&quot;&gt;
-                                            &lt;name&gt;name&lt;/name&gt;
-                                            &lt;cstring&gt;Layout12&lt;/cstring&gt;
-                                        &lt;/property&gt;
-                                        &lt;vbox&gt;
-                                            &lt;property stdset=&quot;1&quot;&gt;
-                                                &lt;name&gt;margin&lt;/name&gt;
-                                                &lt;number&gt;0&lt;/number&gt;
-                                            &lt;/property&gt;
-                                            &lt;property stdset=&quot;1&quot;&gt;
-                                                &lt;name&gt;spacing&lt;/name&gt;
-                                                &lt;number&gt;6&lt;/number&gt;
-                                            &lt;/property&gt;
-                                            &lt;widget&gt;
-                                                &lt;class&gt;QLayoutWidget&lt;/class&gt;
-                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                    &lt;name&gt;name&lt;/name&gt;
-                                                    &lt;cstring&gt;Layout11&lt;/cstring&gt;
-                                                &lt;/property&gt;
-                                                &lt;hbox&gt;
-                                                    &lt;property stdset=&quot;1&quot;&gt;
-                                                        &lt;name&gt;margin&lt;/name&gt;
-                                                        &lt;number&gt;0&lt;/number&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property stdset=&quot;1&quot;&gt;
-                                                        &lt;name&gt;spacing&lt;/name&gt;
-                                                        &lt;number&gt;6&lt;/number&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;widget&gt;
-                                                        &lt;class&gt;QLabel&lt;/class&gt;
-                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                            &lt;name&gt;name&lt;/name&gt;
-                                                            &lt;cstring&gt;TextLabel1_2&lt;/cstring&gt;
-                                                        &lt;/property&gt;
-                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                            &lt;name&gt;text&lt;/name&gt;
-                                                            &lt;string&gt;Appear condition:&lt;/string&gt;
-                                                        &lt;/property&gt;
-                                                    &lt;/widget&gt;
-                                                    &lt;widget&gt;
-                                                        &lt;class&gt;QLineEdit&lt;/class&gt;
-                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                            &lt;name&gt;name&lt;/name&gt;
-                                                            &lt;cstring&gt;appearConditionLineEdit&lt;/cstring&gt;
-                                                        &lt;/property&gt;
-                                                        &lt;property&gt;
-                                                            &lt;name&gt;whatsThis&lt;/name&gt;
-                                                            &lt;string&gt;Answer will not show, if doesn.t match&lt;/string&gt;
-                                                        &lt;/property&gt;
-                                                    &lt;/widget&gt;
-                                                &lt;/hbox&gt;
-                                            &lt;/widget&gt;
-                                            &lt;widget&gt;
-                                                &lt;class&gt;QGroupBox&lt;/class&gt;
-                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                    &lt;name&gt;name&lt;/name&gt;
-                                                    &lt;cstring&gt;GroupBox1&lt;/cstring&gt;
-                                                &lt;/property&gt;
-                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                    &lt;name&gt;title&lt;/name&gt;
-                                                    &lt;string&gt;Actions&lt;/string&gt;
-                                                &lt;/property&gt;
-                                                &lt;hbox&gt;
-                                                    &lt;property stdset=&quot;1&quot;&gt;
-                                                        &lt;name&gt;margin&lt;/name&gt;
-                                                        &lt;number&gt;11&lt;/number&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property stdset=&quot;1&quot;&gt;
-                                                        &lt;name&gt;spacing&lt;/name&gt;
-                                                        &lt;number&gt;6&lt;/number&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;widget&gt;
-                                                        &lt;class&gt;QLayoutWidget&lt;/class&gt;
-                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                            &lt;name&gt;name&lt;/name&gt;
-                                                            &lt;cstring&gt;Layout10&lt;/cstring&gt;
-                                                        &lt;/property&gt;
-                                                        &lt;vbox&gt;
-                                                            &lt;property stdset=&quot;1&quot;&gt;
-                                                                &lt;name&gt;margin&lt;/name&gt;
-                                                                &lt;number&gt;0&lt;/number&gt;
-                                                            &lt;/property&gt;
-                                                            &lt;property stdset=&quot;1&quot;&gt;
-                                                                &lt;name&gt;spacing&lt;/name&gt;
-                                                                &lt;number&gt;6&lt;/number&gt;
-                                                            &lt;/property&gt;
-                                                            &lt;widget&gt;
-                                                                &lt;class&gt;QLayoutWidget&lt;/class&gt;
-                                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                                    &lt;name&gt;name&lt;/name&gt;
-                                                                    &lt;cstring&gt;Layout5&lt;/cstring&gt;
-                                                                &lt;/property&gt;
-                                                                &lt;hbox&gt;
-                                                                    &lt;property stdset=&quot;1&quot;&gt;
-                                                                        &lt;name&gt;margin&lt;/name&gt;
-                                                                        &lt;number&gt;0&lt;/number&gt;
-                                                                    &lt;/property&gt;
-                                                                    &lt;property stdset=&quot;1&quot;&gt;
-                                                                        &lt;name&gt;spacing&lt;/name&gt;
-                                                                        &lt;number&gt;6&lt;/number&gt;
-                                                                    &lt;/property&gt;
-                                                                    &lt;widget&gt;
-                                                                        &lt;class&gt;QLabel&lt;/class&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;name&lt;/name&gt;
-                                                                            &lt;cstring&gt;TextLabel2_2&lt;/cstring&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;text&lt;/name&gt;
-                                                                            &lt;string&gt;condition&lt;/string&gt;
-                                                                        &lt;/property&gt;
-                                                                    &lt;/widget&gt;
-                                                                    &lt;widget&gt;
-                                                                        &lt;class&gt;QLineEdit&lt;/class&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;name&lt;/name&gt;
-                                                                            &lt;cstring&gt;condition1LineEdit&lt;/cstring&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property&gt;
-                                                                            &lt;name&gt;whatsThis&lt;/name&gt;
-                                                                            &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
-                                                                        &lt;/property&gt;
-                                                                    &lt;/widget&gt;
-                                                                    &lt;widget&gt;
-                                                                        &lt;class&gt;QLabel&lt;/class&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;name&lt;/name&gt;
-                                                                            &lt;cstring&gt;TextLabel7&lt;/cstring&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;text&lt;/name&gt;
-                                                                            &lt;string&gt;do&lt;/string&gt;
-                                                                        &lt;/property&gt;
-                                                                    &lt;/widget&gt;
-                                                                    &lt;widget&gt;
-                                                                        &lt;class&gt;QLineEdit&lt;/class&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;name&lt;/name&gt;
-                                                                            &lt;cstring&gt;action1LineEdit&lt;/cstring&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property&gt;
-                                                                            &lt;name&gt;whatsThis&lt;/name&gt;
-                                                                            &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
-                                                                        &lt;/property&gt;
-                                                                    &lt;/widget&gt;
-                                                                &lt;/hbox&gt;
-                                                            &lt;/widget&gt;
-                                                            &lt;widget&gt;
-                                                                &lt;class&gt;QLayoutWidget&lt;/class&gt;
-                                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                                    &lt;name&gt;name&lt;/name&gt;
-                                                                    &lt;cstring&gt;Layout6&lt;/cstring&gt;
-                                                                &lt;/property&gt;
-                                                                &lt;hbox&gt;
-                                                                    &lt;property stdset=&quot;1&quot;&gt;
-                                                                        &lt;name&gt;margin&lt;/name&gt;
-                                                                        &lt;number&gt;0&lt;/number&gt;
-                                                                    &lt;/property&gt;
-                                                                    &lt;property stdset=&quot;1&quot;&gt;
-                                                                        &lt;name&gt;spacing&lt;/name&gt;
-                                                                        &lt;number&gt;6&lt;/number&gt;
-                                                                    &lt;/property&gt;
-                                                                    &lt;widget&gt;
-                                                                        &lt;class&gt;QLabel&lt;/class&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;name&lt;/name&gt;
-                                                                            &lt;cstring&gt;TextLabel3_3&lt;/cstring&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;text&lt;/name&gt;
-                                                                            &lt;string&gt;condition&lt;/string&gt;
-                                                                        &lt;/property&gt;
-                                                                    &lt;/widget&gt;
-                                                                    &lt;widget&gt;
-                                                                        &lt;class&gt;QLineEdit&lt;/class&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;name&lt;/name&gt;
-                                                                            &lt;cstring&gt;condition2LineEdit&lt;/cstring&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property&gt;
-                                                                            &lt;name&gt;whatsThis&lt;/name&gt;
-                                                                            &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
-                                                                        &lt;/property&gt;
-                                                                    &lt;/widget&gt;
-                                                                    &lt;widget&gt;
-                                                                        &lt;class&gt;QLabel&lt;/class&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;name&lt;/name&gt;
-                                                                            &lt;cstring&gt;TextLabel8&lt;/cstring&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;text&lt;/name&gt;
-                                                                            &lt;string&gt;do&lt;/string&gt;
-                                                                        &lt;/property&gt;
-                                                                    &lt;/widget&gt;
-                                                                    &lt;widget&gt;
-                                                                        &lt;class&gt;QLineEdit&lt;/class&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;name&lt;/name&gt;
-                                                                            &lt;cstring&gt;action2LineEdit&lt;/cstring&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property&gt;
-                                                                            &lt;name&gt;whatsThis&lt;/name&gt;
-                                                                            &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
-                                                                        &lt;/property&gt;
-                                                                    &lt;/widget&gt;
-                                                                &lt;/hbox&gt;
-                                                            &lt;/widget&gt;
-                                                            &lt;widget&gt;
-                                                                &lt;class&gt;QLayoutWidget&lt;/class&gt;
-                                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                                    &lt;name&gt;name&lt;/name&gt;
-                                                                    &lt;cstring&gt;Layout7&lt;/cstring&gt;
-                                                                &lt;/property&gt;
-                                                                &lt;hbox&gt;
-                                                                    &lt;property stdset=&quot;1&quot;&gt;
-                                                                        &lt;name&gt;margin&lt;/name&gt;
-                                                                        &lt;number&gt;0&lt;/number&gt;
-                                                                    &lt;/property&gt;
-                                                                    &lt;property stdset=&quot;1&quot;&gt;
-                                                                        &lt;name&gt;spacing&lt;/name&gt;
-                                                                        &lt;number&gt;6&lt;/number&gt;
-                                                                    &lt;/property&gt;
-                                                                    &lt;widget&gt;
-                                                                        &lt;class&gt;QLabel&lt;/class&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;name&lt;/name&gt;
-                                                                            &lt;cstring&gt;TextLabel4_3&lt;/cstring&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;text&lt;/name&gt;
-                                                                            &lt;string&gt;condition&lt;/string&gt;
-                                                                        &lt;/property&gt;
-                                                                    &lt;/widget&gt;
-                                                                    &lt;widget&gt;
-                                                                        &lt;class&gt;QLineEdit&lt;/class&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;name&lt;/name&gt;
-                                                                            &lt;cstring&gt;condition3LineEdit&lt;/cstring&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property&gt;
-                                                                            &lt;name&gt;whatsThis&lt;/name&gt;
-                                                                            &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
-                                                                        &lt;/property&gt;
-                                                                    &lt;/widget&gt;
-                                                                    &lt;widget&gt;
-                                                                        &lt;class&gt;QLabel&lt;/class&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;name&lt;/name&gt;
-                                                                            &lt;cstring&gt;TextLabel9&lt;/cstring&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;text&lt;/name&gt;
-                                                                            &lt;string&gt;do&lt;/string&gt;
-                                                                        &lt;/property&gt;
-                                                                    &lt;/widget&gt;
-                                                                    &lt;widget&gt;
-                                                                        &lt;class&gt;QLineEdit&lt;/class&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;name&lt;/name&gt;
-                                                                            &lt;cstring&gt;action3LineEdit&lt;/cstring&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property&gt;
-                                                                            &lt;name&gt;whatsThis&lt;/name&gt;
-                                                                            &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
-                                                                        &lt;/property&gt;
-                                                                    &lt;/widget&gt;
-                                                                &lt;/hbox&gt;
-                                                            &lt;/widget&gt;
-                                                            &lt;widget&gt;
-                                                                &lt;class&gt;QLayoutWidget&lt;/class&gt;
-                                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                                    &lt;name&gt;name&lt;/name&gt;
-                                                                    &lt;cstring&gt;Layout8&lt;/cstring&gt;
-                                                                &lt;/property&gt;
-                                                                &lt;hbox&gt;
-                                                                    &lt;property stdset=&quot;1&quot;&gt;
-                                                                        &lt;name&gt;margin&lt;/name&gt;
-                                                                        &lt;number&gt;0&lt;/number&gt;
-                                                                    &lt;/property&gt;
-                                                                    &lt;property stdset=&quot;1&quot;&gt;
-                                                                        &lt;name&gt;spacing&lt;/name&gt;
-                                                                        &lt;number&gt;6&lt;/number&gt;
-                                                                    &lt;/property&gt;
-                                                                    &lt;widget&gt;
-                                                                        &lt;class&gt;QLabel&lt;/class&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;name&lt;/name&gt;
-                                                                            &lt;cstring&gt;TextLabel5&lt;/cstring&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;text&lt;/name&gt;
-                                                                            &lt;string&gt;condition&lt;/string&gt;
-                                                                        &lt;/property&gt;
-                                                                    &lt;/widget&gt;
-                                                                    &lt;widget&gt;
-                                                                        &lt;class&gt;QLineEdit&lt;/class&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;name&lt;/name&gt;
-                                                                            &lt;cstring&gt;condition4LineEdit&lt;/cstring&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property&gt;
-                                                                            &lt;name&gt;whatsThis&lt;/name&gt;
-                                                                            &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
-                                                                        &lt;/property&gt;
-                                                                    &lt;/widget&gt;
-                                                                    &lt;widget&gt;
-                                                                        &lt;class&gt;QLabel&lt;/class&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;name&lt;/name&gt;
-                                                                            &lt;cstring&gt;TextLabel10&lt;/cstring&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;text&lt;/name&gt;
-                                                                            &lt;string&gt;do&lt;/string&gt;
-                                                                        &lt;/property&gt;
-                                                                    &lt;/widget&gt;
-                                                                    &lt;widget&gt;
-                                                                        &lt;class&gt;QLineEdit&lt;/class&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;name&lt;/name&gt;
-                                                                            &lt;cstring&gt;action4LineEdit&lt;/cstring&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property&gt;
-                                                                            &lt;name&gt;whatsThis&lt;/name&gt;
-                                                                            &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
-                                                                        &lt;/property&gt;
-                                                                    &lt;/widget&gt;
-                                                                &lt;/hbox&gt;
-                                                            &lt;/widget&gt;
-                                                            &lt;widget&gt;
-                                                                &lt;class&gt;QLayoutWidget&lt;/class&gt;
-                                                                &lt;property stdset=&quot;1&quot;&gt;
-                                                                    &lt;name&gt;name&lt;/name&gt;
-                                                                    &lt;cstring&gt;Layout9&lt;/cstring&gt;
-                                                                &lt;/property&gt;
-                                                                &lt;hbox&gt;
-                                                                    &lt;property stdset=&quot;1&quot;&gt;
-                                                                        &lt;name&gt;margin&lt;/name&gt;
-                                                                        &lt;number&gt;0&lt;/number&gt;
-                                                                    &lt;/property&gt;
-                                                                    &lt;property stdset=&quot;1&quot;&gt;
-                                                                        &lt;name&gt;spacing&lt;/name&gt;
-                                                                        &lt;number&gt;6&lt;/number&gt;
-                                                                    &lt;/property&gt;
-                                                                    &lt;widget&gt;
-                                                                        &lt;class&gt;QLabel&lt;/class&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;name&lt;/name&gt;
-                                                                            &lt;cstring&gt;TextLabel6&lt;/cstring&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;text&lt;/name&gt;
-                                                                            &lt;string&gt;condition&lt;/string&gt;
-                                                                        &lt;/property&gt;
-                                                                    &lt;/widget&gt;
-                                                                    &lt;widget&gt;
-                                                                        &lt;class&gt;QLineEdit&lt;/class&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;name&lt;/name&gt;
-                                                                            &lt;cstring&gt;condition5LineEdit&lt;/cstring&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property&gt;
-                                                                            &lt;name&gt;whatsThis&lt;/name&gt;
-                                                                            &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
-                                                                        &lt;/property&gt;
-                                                                    &lt;/widget&gt;
-                                                                    &lt;widget&gt;
-                                                                        &lt;class&gt;QLabel&lt;/class&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;name&lt;/name&gt;
-                                                                            &lt;cstring&gt;TextLabel11&lt;/cstring&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;text&lt;/name&gt;
-                                                                            &lt;string&gt;do&lt;/string&gt;
-                                                                        &lt;/property&gt;
-                                                                    &lt;/widget&gt;
-                                                                    &lt;widget&gt;
-                                                                        &lt;class&gt;QLineEdit&lt;/class&gt;
-                                                                        &lt;property stdset=&quot;1&quot;&gt;
-                                                                            &lt;name&gt;name&lt;/name&gt;
-                                                                            &lt;cstring&gt;action5LineEdit&lt;/cstring&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property&gt;
-                                                                            &lt;name&gt;whatsThis&lt;/name&gt;
-                                                                            &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
-                                                                        &lt;/property&gt;
-                                                                    &lt;/widget&gt;
-                                                                &lt;/hbox&gt;
-                                                            &lt;/widget&gt;
-                                                        &lt;/vbox&gt;
-                                                    &lt;/widget&gt;
-                                                &lt;/hbox&gt;
-                                            &lt;/widget&gt;
-                                        &lt;/vbox&gt;
-                                    &lt;/widget&gt;
-                                &lt;/vbox&gt;
-                            &lt;/widget&gt;
-                        &lt;/widget&gt;
-                    &lt;/vbox&gt;
-                &lt;/widget&gt;
-            &lt;/grid&gt;
+                &lt;/column&gt;
+                &lt;property name=&quot;name&quot;&gt;
+                    &lt;cstring&gt;answersListView&lt;/cstring&gt;
+                &lt;/property&gt;
+                &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                    &lt;string&gt;Player Answers&lt;/string&gt;
+                &lt;/property&gt;
+            &lt;/widget&gt;
         &lt;/widget&gt;
     &lt;/grid&gt;
 &lt;/widget&gt;
@@ -1024,7 +839,7 @@
         &lt;sender&gt;nodeListView&lt;/sender&gt;
         &lt;signal&gt;selectionChanged(QListViewItem*)&lt;/signal&gt;
         &lt;receiver&gt;DialogEditorGenerated&lt;/receiver&gt;
-        &lt;slot&gt;nodeChangedSlot(QListViewItem* )&lt;/slot&gt;
+        &lt;slot&gt;nodeChangedSlot(QListViewItem*)&lt;/slot&gt;
     &lt;/connection&gt;
     &lt;connection&gt;
         &lt;sender&gt;answersListView&lt;/sender&gt;
@@ -1044,12 +859,6 @@
         &lt;receiver&gt;DialogEditorGenerated&lt;/receiver&gt;
         &lt;slot&gt;answerChangedSlot(QListViewItem*)&lt;/slot&gt;
     &lt;/connection&gt;
-    &lt;slot access=&quot;public&quot;&gt;answerChangedSlot(QListViewItem*)&lt;/slot&gt;
-    &lt;slot access=&quot;public&quot;&gt;answerPositionChanged(int)&lt;/slot&gt;
-    &lt;slot access=&quot;public&quot;&gt;nodeChangedSlot(QListViewItem* )&lt;/slot&gt;
-    &lt;slot access=&quot;public&quot;&gt;processAnswerSlot(QListViewItem*)&lt;/slot&gt;
-    &lt;slot access=&quot;public&quot;&gt;saveAnswer()&lt;/slot&gt;
-    &lt;slot access=&quot;public&quot;&gt;saveNodeInfo()&lt;/slot&gt;
 &lt;/connections&gt;
 &lt;tabstops&gt;
     &lt;tabstop&gt;nodeIdLineEdit&lt;/tabstop&gt;
@@ -1073,4 +882,13 @@
     &lt;tabstop&gt;condition5LineEdit&lt;/tabstop&gt;
     &lt;tabstop&gt;action5LineEdit&lt;/tabstop&gt;
 &lt;/tabstops&gt;
+&lt;slots&gt;
+    &lt;slot&gt;answerChangedSlot(QListViewItem*)&lt;/slot&gt;
+    &lt;slot&gt;answerPositionChanged(int)&lt;/slot&gt;
+    &lt;slot&gt;nodeChangedSlot(QListViewItem* )&lt;/slot&gt;
+    &lt;slot&gt;processAnswerSlot(QListViewItem*)&lt;/slot&gt;
+    &lt;slot&gt;saveAnswer()&lt;/slot&gt;
+    &lt;slot&gt;saveNodeInfo()&lt;/slot&gt;
+&lt;/slots&gt;
+&lt;layoutdefaults spacing=&quot;6&quot; margin=&quot;11&quot;/&gt;
 &lt;/UI&gt;

Modified: trunk/gamedata/default_ini/ships/shpchoex.ini
===================================================================
--- trunk/gamedata/default_ini/ships/shpchoex.ini	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/gamedata/default_ini/ships/shpchoex.ini	2005-05-16 18:39:41 UTC (rev 164)
@@ -12,8 +12,8 @@
 CrewMax = 18
 Batt = 20
 BattMax = 20
-SpeedMax = 46	; 40
-AccelRate = 10
+SpeedMax = 20	; 40
+AccelRate = 5
 TurnRate = 2
 RechargeAmount = 1
 RechargeRate = 3
@@ -22,7 +22,7 @@
 SpecialDrain = 1
 SpecialRate = 0
 HotspotRate = 4
-Mass = 14
+Mass = 25
 
 [Weapon]
 Frames = 6000

Modified: trunk/gamedata/games/test_game/dialogs/welcomecommander.xml
===================================================================
--- trunk/gamedata/games/test_game/dialogs/welcomecommander.xml	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/gamedata/games/test_game/dialogs/welcomecommander.xml	2005-05-16 18:39:41 UTC (rev 164)
@@ -1,69 +1 @@
-&lt;DIALOG&gt;
-  &lt;START_NODES/&gt;
-  &lt;NODES&gt;
-    &lt;NODE text_location=&quot;(50,10)&quot; alien_text=&quot;Welcome to the Charlys Sector, Captain.  I am Commander Jacques Haven, of Silcuu Station. Your ship will be a great addition to fleet here. Would you like some background information before you proceed with your first assignment? &quot; background=&quot;images/alien/human.jpg&quot; id=&quot;0&quot; name=&quot;Welcome&quot; font=&quot;Earthling&quot; music=&quot;music/races/human.mod&quot; &gt;
-      &lt;PLAYER_ANSWER appear_condition=&quot;1&quot; text=&quot;Yes, Commander. Information is always valuable.&quot; &gt;
-        &lt;ACTION action=&quot;goto(1)&quot; condition=&quot;1&quot; /&gt;
-      &lt;/PLAYER_ANSWER&gt;
-      &lt;PLAYER_ANSWER appear_condition=&quot;1&quot; text=&quot;No, Commander. I'd like to get straight to my duties.&quot; &gt;
-        &lt;ACTION action=&quot;goto(5)&quot; condition=&quot;1&quot; /&gt;
-      &lt;/PLAYER_ANSWER&gt;
-    &lt;/NODE&gt;
-    &lt;NODE text_location=&quot;(50,10)&quot; alien_text=&quot;As you might have seen on your hyperspace map, there are three systems in the Charlys Sector; Narike, Ixis, and Gamma Onyx. It's mostly peaceful in Charlys, except for a few Kohr-Ah raiders and Ulzrak. We are having negotiatons to have a native, energy-based race known as the Chorali join the Alliance, and we are hoping to initiate them soon with the avian Drax race. &quot; background=&quot;images/alien/human.jpg&quot; id=&quot;1&quot; name=&quot;Info&quot; font=&quot;Earthling&quot; music=&quot;music/races/human.mod&quot; &gt;
-      &lt;PLAYER_ANSWER appear_condition=&quot;1&quot; text=&quot;I'd like to learn more about the Ulzrak.&quot; &gt;
-        &lt;ACTION action=&quot;goto(2)&quot; condition=&quot;1&quot; /&gt;
-      &lt;/PLAYER_ANSWER&gt;
-      &lt;PLAYER_ANSWER appear_condition=&quot;1&quot; text=&quot;I'd like to learn more about the Chorali.&quot; &gt;
-        &lt;ACTION action=&quot;goto(3)&quot; condition=&quot;1&quot; /&gt;
-      &lt;/PLAYER_ANSWER&gt;
-      &lt;PLAYER_ANSWER appear_condition=&quot;1&quot; text=&quot;I'd like to learn more about the Drax.&quot; &gt;
-        &lt;ACTION action=&quot;goto(4)&quot; condition=&quot;1&quot; /&gt;
-      &lt;/PLAYER_ANSWER&gt;
-      &lt;PLAYER_ANSWER appear_condition=&quot;1&quot; text=&quot;That's enough information for now. What are my orders?&quot; &gt;
-        &lt;ACTION action=&quot;goto(5)&quot; condition=&quot;1&quot; /&gt;
-      &lt;/PLAYER_ANSWER&gt;
-    &lt;/NODE&gt;
-    &lt;NODE text_location=&quot;(50,10)&quot; alien_text=&quot;The Ulzrak are a completely hostile race, that do not seem to have any purpose to their destruction, as far as we can tell. They do not initiate contact before attacking. The only reason we know their name is froma salvaged computer database. &quot; background=&quot;images/alien/human.jpg&quot; id=&quot;2&quot; name=&quot;Ulzrak&quot; font=&quot;Earthling&quot; music=&quot;music/races/human.mod&quot; &gt;
-      &lt;PLAYER_ANSWER appear_condition=&quot;1&quot; text=&quot;I'd like some more general info, Commander.&quot; &gt;
-        &lt;ACTION action=&quot;goto(1)&quot; condition=&quot;1&quot; /&gt;
-      &lt;/PLAYER_ANSWER&gt;
-      &lt;PLAYER_ANSWER appear_condition=&quot;1&quot; text=&quot;That's enough information for now. What are my orders?&quot; &gt;
-        &lt;ACTION action=&quot;goto(5)&quot; condition=&quot;1&quot; /&gt;
-      &lt;/PLAYER_ANSWER&gt;
-    &lt;/NODE&gt;
-    &lt;NODE text_location=&quot;(50,10)&quot; alien_text=&quot;The Chorali are energy-based creatures that mostly made of photons, liquid, and a thin normal matter shell, through which they interact with a normal environment. As a species, they're rather secretive about any technology or information they find, though it's said they are quite social amog themselves. They are also, as a species rather friendly, however. We're currently negotiating them joining the New Alliance. &quot; background=&quot;images/alien/human.jpg&quot; id=&quot;3&quot; name=&quot;Chorali&quot; font=&quot;Earthling&quot; music=&quot;music/races/human.mod&quot; &gt;
-      &lt;PLAYER_ANSWER appear_condition=&quot;1&quot; text=&quot;I'd like some more general info, Commander.&quot; &gt;
-        &lt;ACTION action=&quot;goto(1)&quot; condition=&quot;1&quot; /&gt;
-      &lt;/PLAYER_ANSWER&gt;
-      &lt;PLAYER_ANSWER appear_condition=&quot;1&quot; text=&quot;That's enough information for now. What are my orders?&quot; &gt;
-        &lt;ACTION action=&quot;goto(5)&quot; condition=&quot;1&quot; /&gt;
-      &lt;/PLAYER_ANSWER&gt;
-    &lt;/NODE&gt;
-    &lt;NODE text_location=&quot;(50,10)&quot; alien_text=&quot;We haven't had much contact with the Drax so far, but from what we've heard they've had over a hundred million internal conflicts, and that's only during their spacefaring age. The only governments that succeed are very loosely tied ones, with very little law. It will likely be difficult getting even a preliminary treaty, with the number of factions working for different goals.  &quot; background=&quot;images/alien/human.jpg&quot; id=&quot;4&quot; name=&quot;Drax&quot; font=&quot;Earthling&quot; music=&quot;music/races/human.mod&quot; &gt;
-      &lt;PLAYER_ANSWER appear_condition=&quot;1&quot; text=&quot;I'd like some more general info, Commander.&quot; &gt;
-        &lt;ACTION action=&quot;goto(1)&quot; condition=&quot;1&quot; /&gt;
-      &lt;/PLAYER_ANSWER&gt;
-      &lt;PLAYER_ANSWER appear_condition=&quot;1&quot; text=&quot;That's enough information for now. What are my orders?&quot; &gt;
-        &lt;ACTION action=&quot;goto(5)&quot; condition=&quot;1&quot; /&gt;
-      &lt;/PLAYER_ANSWER&gt;
-    &lt;/NODE&gt;
-    &lt;NODE text_location=&quot;(50,10)&quot; alien_text=&quot;You actually have a choice of assignments, Captain. You can choose to take a transport escort assignment to a mining operation in Ixis, where they need medical supplies. Or, you can negotiate with the Chorali, here in Narike.  &quot; background=&quot;images/alien/human.jpg&quot; id=&quot;5&quot; name=&quot;Orders/Assignments&quot; font=&quot;Earthling&quot; music=&quot;music/races/human.mod&quot; &gt;
-      &lt;PLAYER_ANSWER appear_condition=&quot;1&quot; text=&quot;I'll escort the transport to Ixis. &quot; &gt;
-        &lt;ACTION action=&quot;goto(6)&quot; condition=&quot;1&quot; /&gt;
-        &lt;ACTION action=&quot;ESCORT_SELECT=True&quot; condition=&quot;1&quot; /&gt;
-      &lt;/PLAYER_ANSWER&gt;
-      &lt;PLAYER_ANSWER appear_condition=&quot;1&quot; text=&quot;I'll negotiate with the Chorali.&quot; &gt;
-        &lt;ACTION action=&quot;goto(6)&quot; condition=&quot;1&quot; /&gt;
-        &lt;ACTION action=&quot;CHORALI_SELECTED=True&quot; condition=&quot;1&quot; /&gt;
-      &lt;/PLAYER_ANSWER&gt;
-    &lt;/NODE&gt;
-    &lt;NODE text_location=&quot;(50,10)&quot; alien_text=&quot;Good luck, Captain. Be careful, I wouldn't want to lose the newest addition to my fleet. &quot; background=&quot;images/alien/human.jpg&quot; id=&quot;6&quot; name=&quot;Good Luck!&quot; font=&quot;Earthling&quot; music=&quot;music/races/human.mod&quot; &gt;
-      &lt;PLAYER_ANSWER appear_condition=&quot;1&quot; text=&quot;Thank you, Commander.&quot; &gt;
-        &lt;ACTION action=&quot;endDialog()&quot; condition=&quot;1&quot; /&gt;
-      &lt;/PLAYER_ANSWER&gt;
-      &lt;PLAYER_ANSWER appear_condition=&quot;1&quot; text=&quot;I'll execute my mission well, Commander, be sure of that. &quot; &gt;
-        &lt;ACTION action=&quot;endDialog() &quot; condition=&quot;1&quot; /&gt;
-      &lt;/PLAYER_ANSWER&gt;
-    &lt;/NODE&gt;
-  &lt;/NODES&gt;
-&lt;/DIALOG&gt;
+&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;Welcome&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;Welcome to the Charlys Sector, Captain.  I am Commander Jacques Haven, of Silcuu Station. Your ship will be a great addition to fleet here. Would you like some background information before you proceed with your first assignment? &quot; font=&quot;Earthling&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Yes, Commander. Information is always valuable.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;No, Commander. I'd like to get straight to my duties.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(5)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;1&quot; name=&quot;Info&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;As you might have seen on your hyperspace map, there are three systems in the Charlys Sector; Narike, Ixis, and Gamma Onyx. It's mostly peaceful in Charlys, except for a few Ko!
 hr-Ah raiders and Ulzrak. We are having negotiatons to have a native, energy-based race known as the Chorali join the Alliance, and we are hoping to initiate them soon with the avian Drax race. &quot; font=&quot;Earthling&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;I'd like to learn more about the Ulzrak.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(2)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;I'd like to learn more about the Chorali.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(3)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;I'd like to learn more about the Drax.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(4)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;That's enough information for now. What are my orders?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(5)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;2&quot; name=&quot;Ulzrak&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;The Ulzrak are a completely hostil!
 e race, that do not seem to have any purpose to their destruct!
 ion, as 
far as we can tell. They do not initiate contact before attacking. The only reason we know their name is froma salvaged computer database. &quot; font=&quot;Earthling&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;I'd like some more general info, Commander.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;That's enough information for now. What are my orders?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(5)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;3&quot; name=&quot;Chorali&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;The Chorali are energy-based creatures that mostly made of photons, liquid, and a thin normal matter shell, through which they interact with a normal environment. As a species, they're rather secretive about any technology or information they find, though it's said they are quite social amog themselves. They are also, as a species rather friendly, however. We're currently negoti!
 ating them joining the New Alliance. &quot; font=&quot;Earthling&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;I'd like some more general info, Commander.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;That's enough information for now. What are my orders?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(5)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;4&quot; name=&quot;Drax&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;We haven't had much contact with the Drax so far, but from what we've heard they've had over a hundred million internal conflicts, and that's only during their spacefaring age. The only governments that succeed are very loosely tied ones, with very little law. It will likely be difficult getting even a preliminary treaty, with the number of factions working for different goals.  &quot; font=&quot;Earthling&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;I'd like some more general info, Comman!
 der.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(!
 1)&quot;&gt;&lt;/AC
TION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;That's enough information for now. What are my orders?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(5)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;5&quot; name=&quot;Orders/Assignments&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;You actually have a choice of assignments, Captain. You can choose to take a transport escort assignment to a mining operation in Ixis, where they need medical supplies. Or, you can negotiate with the Chorali, here in Narike.  &quot; font=&quot;Earthling&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;I'll escort the transport to Ixis. &quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(6)&quot;&gt;&lt;/ACTION&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;quests.escort_transport_to_ixis_func()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;I'll negotiate with the Chorali.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(6)&quot;&gt;&lt;/ACTION&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;CHORALI_SELECTED=True&quot;&gt;&lt;/ACTION&gt;&lt;/PL!
 AYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;6&quot; name=&quot;Good Luck!&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;Good luck, Captain. Be careful, I wouldn't want to lose the newest addition to my fleet. &quot; font=&quot;Earthling&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Thank you, Commander.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;I'll execute my mission well, Commander, be sure of that. &quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog() &quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;
\ No newline at end of file

Modified: trunk/gamedata/games/test_game/scripts/start.py
===================================================================
--- trunk/gamedata/games/test_game/scripts/start.py	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/gamedata/games/test_game/scripts/start.py	2005-05-16 18:39:41 UTC (rev 164)
@@ -2,25 +2,38 @@
 # This script executing after loading universe
 #
 
-import tml
+import tml, random
+from quests import *
 
+# Add player to the game
+tml.GameAction.add_player('Narike', &quot;earcr&quot;, 400, 400)
 
 
+# Add new random enemy as time flow
 
+tml.EventManager.setRepeatableTimeEvent(30, &quot;add_random_enemy_func&quot;)
 
-def abc():
-    print &quot;abc\n&quot;
+def add_random_enemy_func():
+    if random.random()&lt;0.1:
+        tml.GameAction.add_ship(tml.GameAction.get_player_star_system(), &quot;kohma&quot;, -1, -1, tml.GameAction.get_enemy_team())
+    if random.random()&lt;0.25:
+        tml.GameAction.add_ship(tml.GameAction.get_player_star_system(), &quot;ilwsp&quot;, -1, -1, tml.GameAction.get_enemy_team())
+        
+escort_transport_to_ixis_func()
 
 
 
-# Add player to the game
-tml.GameAction.add_player('Narike', &quot;earcr&quot;, 400, 400)
 
+
+
+
+
+
+
+
 #tml.GameAction.go_to_point(tml.GameAction.get_player_ship_id(), 1000, 1000, 200)
-tml.GameAction.guard_point(tml.GameAction.get_player_ship_id(), 0, 0, 2000)
+#tml.GameAction.guard_point(tml.GameAction.get_player_ship_id(), 0, 0, 2000)
 
-tml.EventManager.setSingleTimeEvent(1, 'abc')
-
 #id = tml.GameAction.add_ship('Narike', &quot;earcr&quot;, 2000, 2000, 1)
 
 #tml.GameAction.set_target(id,tml.GameAction.get_double_flag('Narike Silcuu Base'))

Modified: trunk/gamedata/games/test_game/scripts/systems/ixis.py
===================================================================
--- trunk/gamedata/games/test_game/scripts/systems/ixis.py	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/gamedata/games/test_game/scripts/systems/ixis.py	2005-05-16 18:39:41 UTC (rev 164)
@@ -6,14 +6,16 @@
 tml.GameAction.add_system('Ixis',50, 50)
 
 tml.GameAction.add_planet('Ixis','I', 1500, 1800)
-tml.GameAction.add_orbiter_station('Ixis',
-                           'I',
-                           'gob.dat',
-                           'station0sprite',
-                           'gob.dat#station0picture.bmp',
-                           'choex',
-                           'dialogs/welcomecommander.xml')
 
+tml.GameAction.save_flag( 'ixis_mining_station base',
+                          tml.GameAction.add_orbiter_station('Ixis',
+                                                             'I',
+                                                             'gob.dat',
+                                                             'station0sprite',
+                                                             'gob.dat#station0picture.bmp',
+                                                             'earcr',
+                                                             'dialogs/ixis_mining_station_commander.xml'))
+
 for i in xrange(20):
     tml.GameAction.add_asteroid('Ixis')
 

Modified: trunk/gamedata/python/dialog.py
===================================================================
--- trunk/gamedata/python/dialog.py	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/gamedata/python/dialog.py	2005-05-16 18:39:41 UTC (rev 164)
@@ -30,6 +30,8 @@
 else:
     import misc
 
+import quests
+
 g_cur_dialog = &quot;&quot;
 
 def runDialogString(str_xml):

Modified: trunk/gamedata/python/tml.py
===================================================================
--- trunk/gamedata/python/tml.py	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/gamedata/python/tml.py	2005-05-16 18:39:41 UTC (rev 164)
@@ -61,6 +61,8 @@
     if _newclass:get_double_flag = staticmethod(_tml.GameAction_get_double_flag)
     __swig_getmethods__[&quot;get_player_ship_id&quot;] = lambda x: _tml.GameAction_get_player_ship_id
     if _newclass:get_player_ship_id = staticmethod(_tml.GameAction_get_player_ship_id)
+    __swig_getmethods__[&quot;get_player_star_system&quot;] = lambda x: _tml.GameAction_get_player_star_system
+    if _newclass:get_player_star_system = staticmethod(_tml.GameAction_get_player_star_system)
     __swig_getmethods__[&quot;set_target&quot;] = lambda x: _tml.GameAction_set_target
     if _newclass:set_target = staticmethod(_tml.GameAction_set_target)
     __swig_getmethods__[&quot;disable_weapon&quot;] = lambda x: _tml.GameAction_disable_weapon
@@ -77,6 +79,14 @@
     if _newclass:guard_point = staticmethod(_tml.GameAction_guard_point)
     __swig_getmethods__[&quot;set_ship_team&quot;] = lambda x: _tml.GameAction_set_ship_team
     if _newclass:set_ship_team = staticmethod(_tml.GameAction_set_ship_team)
+    __swig_getmethods__[&quot;get_enemy_team&quot;] = lambda x: _tml.GameAction_get_enemy_team
+    if _newclass:get_enemy_team = staticmethod(_tml.GameAction_get_enemy_team)
+    __swig_getmethods__[&quot;get_player_team&quot;] = lambda x: _tml.GameAction_get_player_team
+    if _newclass:get_player_team = staticmethod(_tml.GameAction_get_player_team)
+    __swig_getmethods__[&quot;remove_location&quot;] = lambda x: _tml.GameAction_remove_location
+    if _newclass:remove_location = staticmethod(_tml.GameAction_remove_location)
+    __swig_getmethods__[&quot;set_crew&quot;] = lambda x: _tml.GameAction_set_crew
+    if _newclass:set_crew = staticmethod(_tml.GameAction_set_crew)
     def __init__(self, *args):
         _swig_setattr(self, GameAction, 'this', _tml.new_GameAction(*args))
         _swig_setattr(self, GameAction, 'thisown', 1)
@@ -114,6 +124,8 @@
 
 GameAction_get_player_ship_id = _tml.GameAction_get_player_ship_id
 
+GameAction_get_player_star_system = _tml.GameAction_get_player_star_system
+
 GameAction_set_target = _tml.GameAction_set_target
 
 GameAction_disable_weapon = _tml.GameAction_disable_weapon
@@ -130,6 +142,14 @@
 
 GameAction_set_ship_team = _tml.GameAction_set_ship_team
 
+GameAction_get_enemy_team = _tml.GameAction_get_enemy_team
+
+GameAction_get_player_team = _tml.GameAction_get_player_team
+
+GameAction_remove_location = _tml.GameAction_remove_location
+
+GameAction_set_crew = _tml.GameAction_set_crew
+
 class DialogApi(_object):
     __swig_setmethods__ = {}
     __setattr__ = lambda self, name, value: _swig_setattr(self, DialogApi, name, value)

Modified: trunk/source/ais/c_wussie.cpp
===================================================================
--- trunk/source/ais/c_wussie.cpp	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/source/ais/c_wussie.cpp	2005-05-16 18:39:41 UTC (rev 164)
@@ -184,6 +184,37 @@
   return dodgeangle;
 }
 
+bool ControlWussie::planet_dangerP()
+{
+  STACKTRACE;
+  if (!ship || !ship-&gt;exists())
+    {
+      tw_error(&quot;planet_dangerP - location doesn't exist&quot;);
+      return false;
+    }
+
+  double pangle = 0, va;
+  Query ap;
+  SpaceObject *p;
+
+  bool avoid_planet = false;
+  for (ap.begin (ship, bit (LAYER_CBODIES), planet_safe[state]);
+       ap.current; ap.next ())
+    {
+      p = ap.currento;
+      if (p-&gt;isPlanet ())
+	{
+	  pangle = ship-&gt;trajectory_angle (p);
+	  va = atan (ship-&gt;get_vel ());
+	  if (fabs (pangle - va) &lt; PI/3)
+	    {
+	      avoid_planet = true;
+	    }
+	}
+    }
+  return avoid_planet;
+}
+
 /// Wussie bot AI
 int ControlWussie::think ()
 {
@@ -192,7 +223,7 @@
   if (!ship)
     return 0;
 
-  int action = 0;
+  int   action = 0;
   float velocity, distance;
   double angle = 0, va, pangle, dangle;
   int avoid_planet = FALSE;
@@ -202,6 +233,7 @@
     last_seen_time = game-&gt;game_time;
   else if ((rand () &amp; 32767) &lt; frame_time)
     last_seen_time = game-&gt;game_time - 1000;
+
   for (ap.begin (ship, bit (LAYER_CBODIES), planet_safe[state]);
        ap.current; ap.next ())
     {

Modified: trunk/source/ais.h
===================================================================
--- trunk/source/ais.h	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/source/ais.h	2005-05-16 18:39:41 UTC (rev 164)
@@ -84,6 +84,7 @@
   ControlWussie (const char *name, int channel) ;
   virtual void select_ship(Ship* ship_pointer, const char* ship_name);
   virtual double check_danger();
+  virtual bool planet_dangerP();
   virtual double evasion(Ship* ship) ;
   
   double option_range[MAX_STATES][2];

Modified: trunk/source/games/ggob.cpp
===================================================================
--- trunk/source/games/ggob.cpp	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/source/games/ggob.cpp	2005-05-16 18:39:41 UTC (rev 164)
@@ -59,6 +59,7 @@
 ///////////////////////////////////////////////////////////////////////
 SaveGobGameInfo* SaveGobGameInfo::getInstance()
 {
+  STACKTRACE;
   static SaveGobGameInfo svg;
   return &svg;
 }
@@ -66,6 +67,7 @@
 
 void SaveGobGameInfo::updateGame()
 {
+  STACKTRACE;
   gobgame-&gt;gobplayer.starbucks    = starbucks;
   gobgame-&gt;gobplayer.buckazoids   = buckazoids;
   gobgame-&gt;gobplayer.kills        = kills;
@@ -75,6 +77,7 @@
 
 void SaveGobGameInfo::updateSave()
 {
+  STACKTRACE;
   starbucks   = gobgame-&gt;gobplayer.starbucks;
   buckazoids  = gobgame-&gt;gobplayer.buckazoids;
   kills       = gobgame-&gt;gobplayer.kills;
@@ -95,6 +98,7 @@
   :
   Asteroid()
 {
+  STACKTRACE;
   gen_pos      = opos;
   gen_angle    = oangle; 
   gen_speed    = ospeed; 
@@ -211,10 +215,26 @@
     }
 
   // Save current star items  
-  (*sOld)-&gt;_item = item;
-
+  (*sOld)-&gt;_item     = item;
+  
+  
+  // remove all items
+  int psize = item.size();
+  while(item.size())
+    {
+      remove(item.back());
+      if(item.size()==psize)
+      {
+	tw_error(&quot;!!!!@@!!@$##$%#$^%#$@#&quot;);
+      }
+      psize = item.size();
+    }
   // Load new items
-  item = (*sNew)-&gt;_item;
+  //item     = (*sNew)-&gt;_item;
+  for(std::list&lt;SpaceLocation*&gt;::iterator i =(*sNew)-&gt;_item.begin(); i!= (*sNew)-&gt;_item.end();i++)
+    {
+      add(*i);
+    }
   
   // set new name
   _name = name;
@@ -267,8 +287,7 @@
   else 
     {
       ship = NULL;
-      game-&gt;setGameDone(GAME_STATE_FINISHED);
-      tw_alert(&quot;Game Over!\n\nYour ship and its contents are lost!&quot;, &quot;Ok&quot;);
+      //tw_alert(&quot;Game Over!\n\nYour ship and its contents are lost!&quot;, &quot;Ok&quot;);
     }
   return;
 }
@@ -324,7 +343,8 @@
   max_enemies = get_config_int(&quot;Gob&quot;, &quot;MaxEnemies&quot;, 32);
   gobenemy = (GobEnemy**) malloc(sizeof(GobEnemy*) * max_enemies);
 
-  enemy_team = new_team();
+  player_team = new_team();
+  enemy_team  = new_team();
 	       
 
   int server_players;
@@ -332,12 +352,14 @@
   server_players = 1;
   log_int(channel_server, server_players);
   _player_control = create_control(channel_server, &quot;Human&quot;, &quot;Config0&quot;);
+  add(new Stars());
+  
+  //StarSystem::m_presenceNewStarBegin = presence;
 
   StarSystem* s = new StarSystem(&quot;FakeSystem_123&quot;, Vector2(0,0));
   _name = &quot;FakeSystem_123&quot;;
   _galaxy.add(s);
 
-  add(new Stars());
 
   for_each_file( (GameConfig::GetGameDirectory() + &quot;scripts/systems/*.py&quot;).c_str(), 
 		 FA_ARCH|FA_RDONLY, 
@@ -346,19 +368,9 @@
   delete s;
   _exec_py_script(GameConfig::GetAbsolutePath(&quot;scripts/start.py&quot;).c_str(), 0, 0);
   
-
-  Ship *ship = create_ship(channel_server, &quot;shosc&quot;, &quot;WussieBot&quot;, 
-			   random(size), random(PI2), enemy_team);
-  add(ship);
-  ship-&gt;die();
-
-  ship = create_ship(channel_server, &quot;shosc&quot;, &quot;WussieBot&quot;, 
-			   random(size), random(PI2), enemy_team);
-  add(ship);
-  ship-&gt;die();
-
-  add ( new RainbowRift() );
   
+  //add ( new RainbowRift() );
+  
   next_add_new_enemy_time = 1000;
 
   this-&gt;change_view(&quot;Hero&quot;);
@@ -397,6 +409,7 @@
 
 int GobGame::add_planet(const std::string&amp; system, const std::string&amp; name, int x, int y)
 {
+  STACKTRACE;
   Planet *p = new Planet (Vector2(x,y), meleedata.planetSprite, 1/*planet_index*/);
   p-&gt;set_name(name);
   add ( p );
@@ -405,6 +418,7 @@
 
 Planet* GobGame::get_planet(const std::string&amp; name)
 {
+  STACKTRACE;
   //  Planet* p = NULL;
   for(std::list&lt;SpaceLocation*&gt;::iterator i= item.begin(); i!= item.end();i++)
     {
@@ -422,6 +436,7 @@
 			     const std::string&amp; buildtype,
 			     const std::string&amp; commander_dialog)
 {
+  STACKTRACE;
   Planet* p = get_planet(planet);
   if(!p)
     {
@@ -574,7 +589,8 @@
 void GobGame::add_new_enemy() 
 {
   STACKTRACE;
-  
+  return;
+
   static char *enemy_types[] = 
     {
       &quot;thrto&quot;, &quot;zfpst&quot;, &quot;shosc&quot;, &quot;dragr&quot;, 
@@ -642,9 +658,23 @@
 
 int GobGame::add_ship(const std::string&amp; system, const std::string&amp; shptype, Vector2 pos, double team )
 {
+  STACKTRACE;
+  if(pos.x==-1)
+    {
+      pos.x = random(map_size).x;
+    }
+  if(pos.y==-1)
+    {
+      pos.y = random(map_size).y;
+    }
+  std::string cur_sys = _name;
+  switch_system(system);
   Ship *ship = create_ship(channel_server, shptype.c_str(), &quot;WussieBot&quot;, 
-			   pos, random(PI2), enemy_team);
+			   pos, random(PI2), team);
   add(ship-&gt;get_ship_phaser());
+  
+  switch_system(cur_sys);
+
   return ship-&gt;get_id();
 }
 
@@ -1231,7 +1261,7 @@
 {
   STACKTRACE;
   switch_system(system);
-  gobplayer.init(game-&gt;new_team());
+  gobplayer.init(player_team);
   add_focus(_player_control, _player_control-&gt;channel);
   gobplayer.new_ship(shiptype(shptype.c_str()));
   gobplayer.ship-&gt;translate(pos);
@@ -1242,6 +1272,7 @@
 /// @param file path to saved data
 std::string GobGame::Save(const std::string&amp; file)
 {
+  STACKTRACE;
   SaveGobGameInfo::getInstance()-&gt;updateSave();
   std::string save_script;
   save_script  = &quot;import twsaveload\n&quot;;
@@ -1256,6 +1287,7 @@
 /// @param file path to saved data
 int GobGame::Load(const std::string&amp; file)
 {
+  STACKTRACE;
   std::string load_script;
   load_script  = &quot;import twsaveload\n&quot;;
   load_script += &quot;data = twsaveload.SaveManager(\&quot;\&quot;\&quot;&quot; + file +&quot;\&quot;\&quot;\&quot;)\n&quot;;

Modified: trunk/source/games/ggob.h
===================================================================
--- trunk/source/games/ggob.h	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/source/games/ggob.h	2005-05-16 18:39:41 UTC (rev 164)
@@ -151,6 +151,7 @@
   ShipPanel *_player_panel;
   Control   * _player_control;
 
+  TeamCode player_team;
   TeamCode enemy_team;
 
   virtual void AddPanel();

Modified: trunk/source/generated/tml.py
===================================================================
--- trunk/source/generated/tml.py	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/source/generated/tml.py	2005-05-16 18:39:41 UTC (rev 164)
@@ -61,6 +61,8 @@
     if _newclass:get_double_flag = staticmethod(_tml.GameAction_get_double_flag)
     __swig_getmethods__[&quot;get_player_ship_id&quot;] = lambda x: _tml.GameAction_get_player_ship_id
     if _newclass:get_player_ship_id = staticmethod(_tml.GameAction_get_player_ship_id)
+    __swig_getmethods__[&quot;get_player_star_system&quot;] = lambda x: _tml.GameAction_get_player_star_system
+    if _newclass:get_player_star_system = staticmethod(_tml.GameAction_get_player_star_system)
     __swig_getmethods__[&quot;set_target&quot;] = lambda x: _tml.GameAction_set_target
     if _newclass:set_target = staticmethod(_tml.GameAction_set_target)
     __swig_getmethods__[&quot;disable_weapon&quot;] = lambda x: _tml.GameAction_disable_weapon
@@ -77,6 +79,14 @@
     if _newclass:guard_point = staticmethod(_tml.GameAction_guard_point)
     __swig_getmethods__[&quot;set_ship_team&quot;] = lambda x: _tml.GameAction_set_ship_team
     if _newclass:set_ship_team = staticmethod(_tml.GameAction_set_ship_team)
+    __swig_getmethods__[&quot;get_enemy_team&quot;] = lambda x: _tml.GameAction_get_enemy_team
+    if _newclass:get_enemy_team = staticmethod(_tml.GameAction_get_enemy_team)
+    __swig_getmethods__[&quot;get_player_team&quot;] = lambda x: _tml.GameAction_get_player_team
+    if _newclass:get_player_team = staticmethod(_tml.GameAction_get_player_team)
+    __swig_getmethods__[&quot;remove_location&quot;] = lambda x: _tml.GameAction_remove_location
+    if _newclass:remove_location = staticmethod(_tml.GameAction_remove_location)
+    __swig_getmethods__[&quot;set_crew&quot;] = lambda x: _tml.GameAction_set_crew
+    if _newclass:set_crew = staticmethod(_tml.GameAction_set_crew)
     def __init__(self, *args):
         _swig_setattr(self, GameAction, 'this', _tml.new_GameAction(*args))
         _swig_setattr(self, GameAction, 'thisown', 1)
@@ -114,6 +124,8 @@
 
 GameAction_get_player_ship_id = _tml.GameAction_get_player_ship_id
 
+GameAction_get_player_star_system = _tml.GameAction_get_player_star_system
+
 GameAction_set_target = _tml.GameAction_set_target
 
 GameAction_disable_weapon = _tml.GameAction_disable_weapon
@@ -130,6 +142,14 @@
 
 GameAction_set_ship_team = _tml.GameAction_set_ship_team
 
+GameAction_get_enemy_team = _tml.GameAction_get_enemy_team
+
+GameAction_get_player_team = _tml.GameAction_get_player_team
+
+GameAction_remove_location = _tml.GameAction_remove_location
+
+GameAction_set_crew = _tml.GameAction_set_crew
+
 class DialogApi(_object):
     __swig_setmethods__ = {}
     __setattr__ = lambda self, name, value: _swig_setattr(self, DialogApi, name, value)

Modified: trunk/source/generated/tml_wrap.cpp
===================================================================
--- trunk/source/generated/tml_wrap.cpp	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/source/generated/tml_wrap.cpp	2005-05-16 18:39:41 UTC (rev 164)
@@ -1348,6 +1348,22 @@
 }
 
 
+static PyObject *_wrap_GameAction_get_player_star_system(PyObject *self, PyObject *args) {
+    PyObject *resultobj;
+    std::string result;
+    
+    if(!PyArg_ParseTuple(args,(char *)&quot;:GameAction_get_player_star_system&quot;)) goto fail;
+    result = GameAction::get_player_star_system();
+    
+    {
+        resultobj = PyString_FromStringAndSize((&amp;result)-&gt;data(),(&amp;result)-&gt;size());
+    }
+    return resultobj;
+    fail:
+    return NULL;
+}
+
+
 static PyObject *_wrap_GameAction_set_target(PyObject *self, PyObject *args) {
     PyObject *resultobj;
     double arg1 ;
@@ -1476,6 +1492,63 @@
 }
 
 
+static PyObject *_wrap_GameAction_get_enemy_team(PyObject *self, PyObject *args) {
+    PyObject *resultobj;
+    int result;
+    
+    if(!PyArg_ParseTuple(args,(char *)&quot;:GameAction_get_enemy_team&quot;)) goto fail;
+    result = (int)GameAction::get_enemy_team();
+    
+    resultobj = PyInt_FromLong((long)result);
+    return resultobj;
+    fail:
+    return NULL;
+}
+
+
+static PyObject *_wrap_GameAction_get_player_team(PyObject *self, PyObject *args) {
+    PyObject *resultobj;
+    int result;
+    
+    if(!PyArg_ParseTuple(args,(char *)&quot;:GameAction_get_player_team&quot;)) goto fail;
+    result = (int)GameAction::get_player_team();
+    
+    resultobj = PyInt_FromLong((long)result);
+    return resultobj;
+    fail:
+    return NULL;
+}
+
+
+static PyObject *_wrap_GameAction_remove_location(PyObject *self, PyObject *args) {
+    PyObject *resultobj;
+    double arg1 ;
+    
+    if(!PyArg_ParseTuple(args,(char *)&quot;d:GameAction_remove_location&quot;,&amp;arg1)) goto fail;
+    GameAction::remove_location(arg1);
+    
+    Py_INCREF(Py_None); resultobj = Py_None;
+    return resultobj;
+    fail:
+    return NULL;
+}
+
+
+static PyObject *_wrap_GameAction_set_crew(PyObject *self, PyObject *args) {
+    PyObject *resultobj;
+    double arg1 ;
+    double arg2 ;
+    
+    if(!PyArg_ParseTuple(args,(char *)&quot;dd:GameAction_set_crew&quot;,&amp;arg1,&amp;arg2)) goto fail;
+    GameAction::set_crew(arg1,arg2);
+    
+    Py_INCREF(Py_None); resultobj = Py_None;
+    return resultobj;
+    fail:
+    return NULL;
+}
+
+
 static PyObject *_wrap_new_GameAction(PyObject *self, PyObject *args) {
     PyObject *resultobj;
     GameAction *result;
@@ -2957,6 +3030,7 @@
 	 { (char *)&quot;GameAction_save_flag&quot;, _wrap_GameAction_save_flag, METH_VARARGS },
 	 { (char *)&quot;GameAction_get_double_flag&quot;, _wrap_GameAction_get_double_flag, METH_VARARGS },
 	 { (char *)&quot;GameAction_get_player_ship_id&quot;, _wrap_GameAction_get_player_ship_id, METH_VARARGS },
+	 { (char *)&quot;GameAction_get_player_star_system&quot;, _wrap_GameAction_get_player_star_system, METH_VARARGS },
 	 { (char *)&quot;GameAction_set_target&quot;, _wrap_GameAction_set_target, METH_VARARGS },
 	 { (char *)&quot;GameAction_disable_weapon&quot;, _wrap_GameAction_disable_weapon, METH_VARARGS },
 	 { (char *)&quot;GameAction_enable_weapon&quot;, _wrap_GameAction_enable_weapon, METH_VARARGS },
@@ -2965,6 +3039,10 @@
 	 { (char *)&quot;GameAction_guard_location&quot;, _wrap_GameAction_guard_location, METH_VARARGS },
 	 { (char *)&quot;GameAction_guard_point&quot;, _wrap_GameAction_guard_point, METH_VARARGS },
 	 { (char *)&quot;GameAction_set_ship_team&quot;, _wrap_GameAction_set_ship_team, METH_VARARGS },
+	 { (char *)&quot;GameAction_get_enemy_team&quot;, _wrap_GameAction_get_enemy_team, METH_VARARGS },
+	 { (char *)&quot;GameAction_get_player_team&quot;, _wrap_GameAction_get_player_team, METH_VARARGS },
+	 { (char *)&quot;GameAction_remove_location&quot;, _wrap_GameAction_remove_location, METH_VARARGS },
+	 { (char *)&quot;GameAction_set_crew&quot;, _wrap_GameAction_set_crew, METH_VARARGS },
 	 { (char *)&quot;new_GameAction&quot;, _wrap_new_GameAction, METH_VARARGS },
 	 { (char *)&quot;delete_GameAction&quot;, _wrap_delete_GameAction, METH_VARARGS },
 	 { (char *)&quot;GameAction_swigregister&quot;, GameAction_swigregister, METH_VARARGS },

Modified: trunk/source/melee/mcbodies.cpp
===================================================================
--- trunk/source/melee/mcbodies.cpp	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/source/melee/mcbodies.cpp	2005-05-16 18:39:41 UTC (rev 164)
@@ -187,11 +187,13 @@
 
 std::string Planet::get_name()
 {
+  STACKTRACE;
   return _name;
 }
 
 void Planet::set_name(const std::string&amp; name)
 {
+  STACKTRACE;
   _name = name;
 }
 

Modified: trunk/source/melee/mcontrol.h
===================================================================
--- trunk/source/melee/mcontrol.h	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/source/melee/mcontrol.h	2005-05-16 18:39:41 UTC (rev 164)
@@ -50,73 +50,75 @@
 
 
   /*! \brief points at the current ship being controlled */
-	Ship *ship;
+  Ship *ship;
   /*! \brief keys currently pressed */
-	TWKeyCode keys;
+  TWKeyCode keys;
   /*! \brief name of instance */
-	char *iname;
-	SpaceObject *target;
-	int index;
-	bool valid_target(SpaceObject *t);
+  char *iname;
+  SpaceObject *target;
+  int index;
+  bool valid_target(SpaceObject *t);
   /*! \brief always-random selection, for the always-random button on the default ship selector */
-	int always_random;
-	public:
+  int always_random;
+ public:
   /*! \brief handles camera focusing on a controls ship */
-	virtual SpaceLocation *get_focus();
-	int rand();
+  virtual SpaceLocation *get_focus();
+  int rand();
   /*! \brief loads configuration data from a ini file.
-	\example  player1.load(&quot;scp.ini&quot;, &quot;Keyboard1&quot;); */
-	virtual void load(const char* inifile, const char* inisection);
+    \example  player1.load(&quot;scp.ini&quot;, &quot;Keyboard1&quot;); */
+  virtual void load(const char* inifile, const char* inisection);
   /*! \brief saves configuration data to a ini file. */
-	virtual void save(const char* inifile, const char* inisection);
+  virtual void save(const char* inifile, const char* inisection);
   /*! \brief presents the ship selection dialog */
-	virtual int choose_ship(VideoWindow *window, char *prompt, class Fleet *fleet);
+  virtual int choose_ship(VideoWindow *window, char *prompt, class Fleet *fleet);
   /*! \brief called whenever the ship being controlled changes 
-	WARNING: select_ship() is not thread-safe */
-	virtual void select_ship(Ship* ship_pointer, const char* ship_name);
+    WARNING: select_ship() is not thread-safe */
+  virtual void select_ship(Ship* ship_pointer, const char* ship_name);
   /*! \brief called every frame of physics */
-	virtual void calculate();
+  virtual void calculate();
+  /// \brief return true if ship going to crush to the planet
+  virtual bool planet_dangerP(){return false;}
   /*! \brief called by calculate... this is where the important stuff goes */
-	virtual int think();
+  virtual int think();
   /*! \brief returns the name of the control type, like &quot;Joystick&quot; */
-	virtual const char *getTypeName() = 0;
+  virtual const char *getTypeName() = 0;
   /*! \brief returns the description of the control, like &quot;NetworkGame(local)_Keyboard0&quot; */
-	virtual char *getDescription();
+  virtual char *getDescription();
   /*! \brief the constructor initializes ship to NULL */
-	Control (const char *name, int channel, ControlType controlType) ;
+  Control (const char *name, int channel, ControlType controlType) ;
   /*! \brief the destructor, which is rarely used */
-	virtual ~Control () ;
+  virtual ~Control () ;
   /*! called by the GUI stuff to setup the controls (calibrate Joystick, set keys, etc.) */
-	virtual void setup();
-	virtual void set_target(int i);
-	virtual void target_stuff();
-	virtual void animate(Frame *space);
-	
-	/*! sets text to the help text for this control.  ie for humans, sets a description
-		of its key controls. */ 
-	virtual void getHelpText( char * text ) { };
-
-
-	enum {_prediction_keys_size = 128};//must be a power of 2
-//half-assed network bypass for prediction
-	TWKeyCode *_prediction_keys;
-	unsigned char _prediction_keys_index;
-
+  virtual void setup();
+  virtual void set_target(int i);
+  virtual void target_stuff();
+  virtual void animate(Frame *space);
+  
+  /*! sets text to the help text for this control.  ie for humans, sets a description
+    of its key controls. */ 
+  virtual void getHelpText( char * text ) { };
+  
+  
+  enum {_prediction_keys_size = 128};//must be a power of 2
+  //half-assed network bypass for prediction
+  TWKeyCode *_prediction_keys;
+  unsigned char _prediction_keys_index;
+  
   /*! \brief for future mid-game lag changes */
-	virtual void _event ( Event *e );
+  virtual void _event ( Event *e );
+  
+ protected:
 	
-protected:
-	
-	/*! the type of controller this is.  See ControlType */
-	ControlType _controlType;
-public:
-	
-	/*! returns this controller's type.  See ControlType */
-	ControlType getControlType() { return _controlType; }
-	
-	/*! returns true if the controller is a human, false otherwise */
-	bool isHuman() { return _controlType==ai_index_human; }
-	};
+  /*! the type of controller this is.  See ControlType */
+  ControlType _controlType;
+ public:
+  
+  /*! returns this controller's type.  See ControlType */
+  ControlType getControlType() { return _controlType; }
+  
+  /*! returns true if the controller is a human, false otherwise */
+  bool isHuman() { return _controlType==ai_index_human; }
+};
 
 extern char selectTitleString[100];
 

Modified: trunk/source/melee/mframe.cpp
===================================================================
--- trunk/source/melee/mframe.cpp	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/source/melee/mframe.cpp	2005-05-16 18:39:41 UTC (rev 164)
@@ -76,118 +76,178 @@
 double MAX_SPEED = 0;
 
 
-void Query::begin (SpaceLocation *qtarget, int qlayers, double qrange) {STACKTRACE
-	if (qrange &lt; 0) {tw_error(&quot;Query::begin - negative range&quot;);}
-	layers = qlayers;
-	range_sqr = qrange * qrange;
-	target = qtarget;
-	current = NULL;
-	target_pos = target-&gt;normal_pos();
-	if ((qrange &lt; map_size.x/2.5) &amp;&amp; (qrange &lt; map_size.y/2.5)) {
-		qx_min = (int)floor((target-&gt;normal_pos().x - qrange) * QUADI_X);
-		qx_max = (int)ceil ((target-&gt;normal_pos().x + qrange) * QUADI_X) + 1;
-		if (qx_min &lt; 0) qx_min += QUADS_X;
-		if (qx_max &gt;= QUADS_X) qx_max -= QUADS_X;
-		qy_min = (int)floor((target-&gt;normal_pos().y - qrange) * QUADI_Y);
-		qy_max = (int)ceil ((target-&gt;normal_pos().y + qrange) * QUADI_Y) + 1;
-		if (qy_min &lt; 0) qy_min += QUADS_Y;
-		if (qy_max &gt;= QUADS_Y) qy_max -= QUADS_Y;
-		}
-	else {
-		qx_min = 0;
-		qx_max = 0;
-		qy_min = 0;
-		qy_max = 0;
-		}
-	qy = qy_min;
-	qx = qx_min;
-	current = physics-&gt;quadrant[qy * QUADS_X + qx];
-	if (!current) next_quadrant();
-	if (!current) return;
-	if (current_invalid()) next();
-	return;
-	}
+void Query::begin (SpaceLocation *qtarget, int qlayers, double qrange) 
+{
+  STACKTRACE;
+  if (qrange &lt; 0) 
+    {
+      tw_error(&quot;Query::begin - negative range&quot;);
+    }
+  layers = qlayers;
+  range_sqr = qrange * qrange;
+  target = qtarget;
+  current = NULL;
+  target_pos = target-&gt;normal_pos();
+  if ((qrange &lt; map_size.x/2.5) &amp;&amp; (qrange &lt; map_size.y/2.5)) 
+    {
+      qx_min = (int)floor((target-&gt;normal_pos().x - qrange) * QUADI_X);
+      qx_max = (int)ceil ((target-&gt;normal_pos().x + qrange) * QUADI_X) + 1;
+      if (qx_min &lt; 0) qx_min += QUADS_X;
+      if (qx_max &gt;= QUADS_X) qx_max -= QUADS_X;
+      qy_min = (int)floor((target-&gt;normal_pos().y - qrange) * QUADI_Y);
+      qy_max = (int)ceil ((target-&gt;normal_pos().y + qrange) * QUADI_Y) + 1;
+      if (qy_min &lt; 0) qy_min += QUADS_Y;
+      if (qy_max &gt;= QUADS_Y) qy_max -= QUADS_Y;
+    }
+  else 
+    {
+      qx_min = 0;
+      qx_max = 0;
+      qy_min = 0;
+      qy_max = 0;
+    }
+  qy = qy_min;
+  qx = qx_min;
 
-void Query::begin (SpaceLocation *qtarget, Vector2 center, int qlayers, double qrange) {STACKTRACE
-	layers = qlayers;
-	range_sqr = qrange * qrange;
-	target = qtarget;
-	current = NULL;
-	target_pos = center;
-	if ((qrange &lt; map_size.x/2.5) &amp;&amp; (qrange &lt; map_size.y/2.5)) {
-		qx_min = (int)floor((target_pos.x - qrange) * QUADI_X);
-		qx_max = (int)ceil ((target_pos.x + qrange) * QUADI_X) + 1;
-		if (qx_min &lt; 0) qx_min += QUADS_X;
-		if (qx_max &gt;= QUADS_X) qx_max -= QUADS_X;
-		qy_min = (int)floor((target_pos.y - qrange) * QUADI_Y);
-		qy_max = (int)ceil ((target_pos.y + qrange) * QUADI_Y) + 1;
-		if (qy_min &lt; 0) qy_min += QUADS_Y;
-		if (qy_max &gt;= QUADS_Y) qy_max -= QUADS_Y;
-		}
-	else {
-		qx_min = 0;
-		qx_max = 0;
-		qy_min = 0;
-		qy_max = 0;
-		}
-	qy = qy_min;
-	qx = qx_min;
-	current = physics-&gt;quadrant[qy * QUADS_X + qx];
-	if (!current) next_quadrant();
-	if (!current) return;
-	if (current_invalid()) next();
-	return;
-	}
+  m_cur_pos = physics-&gt;item.begin();
+  if(m_cur_pos != physics-&gt;item.end())
+    {
+      current = *(physics-&gt;item.begin());
+      if (current_invalid()) 
+	next();
+    }
+  return;
+  /*
+  current = physics-&gt;quadrant[qy * QUADS_X + qx];
+  if (!current) next_quadrant();
+  if (!current) return;
+  if (current_invalid()) next();
+  return;
+  */
+}
 
 
-void Query::next_quadrant () {
-	STACKTRACE
+void Query::begin (SpaceLocation *qtarget, Vector2 center, int qlayers, double qrange) 
+{
+  STACKTRACE;
+  layers = qlayers;
+  range_sqr = qrange * qrange;
+  target = qtarget;
+  current = NULL;
+  target_pos = center;
+  if ((qrange &lt; map_size.x/2.5) &amp;&amp; (qrange &lt; map_size.y/2.5)) 
+    {
+      qx_min = (int)floor((target_pos.x - qrange) * QUADI_X);
+      qx_max = (int)ceil ((target_pos.x + qrange) * QUADI_X) + 1;
+      if (qx_min &lt; 0) qx_min += QUADS_X;
+      if (qx_max &gt;= QUADS_X) qx_max -= QUADS_X;
+      qy_min = (int)floor((target_pos.y - qrange) * QUADI_Y);
+      qy_max = (int)ceil ((target_pos.y + qrange) * QUADI_Y) + 1;
+      if (qy_min &lt; 0) qy_min += QUADS_Y;
+      if (qy_max &gt;= QUADS_Y) qy_max -= QUADS_Y;
+    }
+  else 
+    {
+      qx_min = 0;
+      qx_max = 0;
+      qy_min = 0;
+      qy_max = 0;
+    }
+  qy = qy_min;
+  qx = qx_min;
 
-tail_recurse4:
-	qx += 1;
-	if (qx == QUADS_X) qx = 0;
-	if (qx == qx_max) {
-		qy += 1;
-		if (qy == QUADS_Y) qy = 0;
-		if (qy == qy_max) {
-			current = NULL;
-			qy -= 1;
-			qx -= 1;
-			return;
-			}
-		qx = qx_min;
-		}
-	int tmp = qy * QUADS_X + qx;
-	if (tmp &lt; 0) {tw_error (&quot;tmp was less than 0&quot;);}
-	if (tmp &gt; QUADS_TOTAL) {tw_error (&quot;tmp was too large&quot;);}
-	current = physics-&gt;quadrant[tmp];
-	if (!current) goto tail_recurse4;
-	return;
-	}
 
-void Query::next () {STACKTRACE
-tail_recurse3:
-	if (current == current-&gt;qnext) {tw_error (&quot;Query::next - current = next&quot;);}
-	current = current-&gt;qnext;
-	if (!current) {
-		next_quadrant();
-		if (!current) return;
-		}
-	if (current_invalid()) goto tail_recurse3;
-	return;
-	}
+  m_cur_pos = physics-&gt;item.begin();
+  if(m_cur_pos != physics-&gt;item.end())
+    {
+      current = *(physics-&gt;item.begin());
+      if (current_invalid()) 
+	next();
+    }
+  return;
 
-void Query::end() {
-	}
+  /*  current = physics-&gt;quadrant[qy * QUADS_X + qx];
+  if (!current) next_quadrant();
+  if (!current) return;
+  */
 
+}
 
 
+void Query::next_quadrant () 
+{
+  STACKTRACE;
 
+tail_recurse4:
+  qx += 1;
+  if (qx == QUADS_X) qx = 0;
+  if (qx == qx_max) {
+    qy += 1;
+    if (qy == QUADS_Y) qy = 0;
+    if (qy == qy_max) 
+      {
+	current = NULL;
+	qy -= 1;
+	qx -= 1;
+	return;
+      }
+    qx = qx_min;
+  }
+  int tmp = qy * QUADS_X + qx;
+  if (tmp &lt; 0) {tw_error (&quot;tmp was less than 0&quot;);}
+  if (tmp &gt; QUADS_TOTAL) {tw_error (&quot;tmp was too large&quot;);}
+  current = physics-&gt;quadrant[tmp];
+  if (!current) goto tail_recurse4;
+  return;
+}
 
+void Query::next () 
+{
+  STACKTRACE;
 
+  // Dumb and slow implementaion 
+  if(m_cur_pos==physics-&gt;item.end())
+    {
+      current = NULL;
+      return;
+    }
+  m_cur_pos++;
+  if(m_cur_pos==physics-&gt;item.end())
+    {
+      current = NULL;
+      return;
+    }
+  current = *m_cur_pos;
+  if (current_invalid()) 
+    next();
+  return;
 
+  /*
+    goto tail_recurse3;
+ tail_recurse3:
+  if (current == current-&gt;qnext) 
+    {
+      tw_error (&quot;Query::next - current = next&quot;);
+    }
+  current = current-&gt;qnext;
+  if (!current) 
+    {
+      next_quadrant();
+    if (!current) 
+      return;
+  }
+  if (current_invalid()) goto tail_recurse3;
+  return;
+  */
+}
 
+void Query::end() 
+{
+}
 
+
+
+
 void Query2::begin (SpaceLocation *qtarget, Uint64 attribute_filter, double qrange) {
 	STACKTRACE;
 	if (qrange &lt; 0) {tw_error(&quot;Query::begin - negative range&quot;);}
@@ -218,11 +278,15 @@
 		}
 	qy = qy_min;
 	qx = qx_min;
+
+       
+
 	current = physics-&gt;quadrant[qy * QUADS_X + qx];
 	if (!current) next_quadrant();
 	if (!current) return;
 	if (current_invalid()) next();
 	return;
+	
 	}
 
 void Query2::begin (SpaceLocation *qtarget, Vector2 center, Uint64 attribute_filter, double qrange) {STACKTRACE
@@ -748,7 +812,10 @@
 {
   double tmp;
   
-  if (this == other) {tw_error(&quot;SpaceObject::collide - self!&quot;);}
+  if (this == other) 
+    {
+      tw_error(&quot;SpaceObject::collide - self!&quot;);
+    }
   if((!canCollide(other)) || (!other-&gt;canCollide(this))) return;
   if (!exists() || !other-&gt;exists()) return;
   
@@ -1012,19 +1079,21 @@
   return (ship &lt;&lt; SpaceLocation::ship_shift) | (team &lt;&lt; SpaceLocation::team_shift);
 }
 
-unsigned int Physics::new_ship() {
-	last_ship += 1;
-	return last_ship;
-	}
-TeamCode Physics::new_team() {
-	last_team += 1;
-	return last_team;
-	}
+unsigned int Physics::new_ship() 
+{
+  last_ship += 1;
+  return last_ship;
+}
+TeamCode Physics::new_team() 
+{
+  last_team += 1;
+  return last_team;
+}
 void Physics::switch_team(unsigned int ship, TeamCode team) 
 {
   int j;
   j = (ship &amp; SpaceLocation::ship_mask) | (team &lt;&lt; SpaceLocation::team_shift);
-
+  
   for(std::list&lt;SpaceLocation*&gt;::iterator i = item.begin();i!=item.end();i++)
     {
       if (((*i)-&gt;ally_flag &amp; SpaceLocation::ship_mask) == (ship &lt;&lt; SpaceLocation::ship_shift)) 
@@ -1059,54 +1128,76 @@
 }
 
 
-void Physics::add(SpaceLocation *o) {
-	if (o-&gt;attributes &amp; ATTRIB_INGAME) {tw_error(&quot;addItem - already added&quot;);}
-	if (!o-&gt;isLocation()) {tw_error(&quot;addItem - catastrophic&quot;);}
-	//if (!o-&gt;_serial) _list(o);
+void Physics::add(SpaceLocation *o) 
+{
+  if (o-&gt;attributes &amp; ATTRIB_INGAME) 
+    {
+      tw_error(&quot;addItem - already added&quot;);
+    }
+  if (!o-&gt;isLocation()) 
+    {
+      tw_error(&quot;addItem - catastrophic&quot;);
+    }
+	
 
-	o-&gt;attributes |= ATTRIB_INGAME;
+  o-&gt;attributes |= ATTRIB_INGAME;
+  if(std::find(item.begin(), item.end(), o)==item.end())
+    {
+      item.push_back(o);
+    }
+  else
+    {
+      //      tw_error(&quot;Item already added&quot;);
+    }
+  
 
-	item.push_back(o);
-
-	if (o-&gt;detectable())
+  if (o-&gt;detectable())
+    {
+      Vector2 n = o-&gt;normal_pos();
+      int q = int(n.x * QUADI_X) + int(n.y * QUADI_Y) * QUADS_X;
+      if ((q &lt; 0) || (q &gt; QUADS_TOTAL)) 
 	{
-		Vector2 n = o-&gt;normal_pos();
-		int q = int(n.x * QUADI_X) + 
-			int(n.y * QUADI_Y) * QUADS_X;
-		if ((q &lt; 0) || (q &gt; QUADS_TOTAL)) {tw_error(&quot;bad quadrant&quot;);}
-		o-&gt;qnext = quadrant[q];
-		quadrant[q] = o;
+	  tw_error(&quot;bad quadrant&quot;);
 	}
+      o-&gt;qnext = quadrant[q];
+      quadrant[q] = o;
+    }
 
-	return;
-	}
+  return;
+}
 
 bool Physics::remove(SpaceLocation *o) 
 {
   if (!(o-&gt;attributes &amp; ATTRIB_INGAME)) 
-    {tw_error(&quot;removeItem - not added&quot;);}
+    {
+      tw_error(&quot;removeItem - not added&quot;);
+    }
   o-&gt;attributes &amp;= ~ATTRIB_INGAME;
-  if (!o-&gt;isLocation()) {tw_error(&quot;removeItem - catastrophic&quot;);}
+  if (!o-&gt;isLocation()) 
+    {
+      tw_error(&quot;removeItem - catastrophic&quot;);
+    }
   
   std::list&lt;SpaceLocation*&gt;::iterator i = std::find(item.begin(),item.end(),o);
-  if(i==item.end())
+  if(i!=item.end())
     {
-      return false;
-    }
-  else
-    {
       item.remove(*i);
       return true;
     }
+  return false;
 }
 
-void Physics::add(Presence *p) {
+void Physics::add(Presence *p) 
+{
   if (p-&gt;attributes &amp; ATTRIB_INGAME) 
-    {tw_error(&quot;addPresence - already added&quot;);}
-  if (p-&gt;isLocation()) {
-    add((SpaceLocation*)p);
-    return;
-  }
+    {
+      tw_error(&quot;addPresence - already added&quot;);
+    }
+  if (p-&gt;isLocation()) 
+    {
+      add((SpaceLocation*)p);
+      return;
+    }
   presence.push_back(p);
   return;
 }
@@ -1119,15 +1210,12 @@
     return remove((SpaceLocation*)o);
   o-&gt;attributes &amp;= ~ATTRIB_INGAME;
   std::list&lt;Presence*&gt;::iterator i = std::find(presence.begin(),presence.end(),o);
-  if(i==presence.end())
+  if(i!=presence.end())
     {
-      return false;
-    }
-  else
-    {
       presence.remove(*i);
       return true;
-    }  
+    }
+  return false;
 }
 
 template&lt;class T&gt; bool is_dead_object(T p) 
@@ -1146,6 +1234,13 @@
     return false;
 }
 
+bool Physics::in_itemP(SpaceLocation*l)
+{
+  if(m_valid_item.find(l)!=m_valid_item.end())
+    return true;
+  return false;
+}
+
 void Physics::calculate() 
 {
   int i;
@@ -1196,26 +1291,33 @@
   }
   
   //prepare quadrants stuff
-  {_STACKTRACE(&quot;Physics::calculate() - quadrants stuff&quot;)
-     for(i = 0; i &lt; QUADS_TOTAL; i += 1) {
-       quadrant[i] = NULL;
-     }
-  for(std::list&lt;SpaceLocation*&gt;::iterator i=item.begin();i!=item.end();i++)
-    {
-      if ((*i)-&gt;exists() &amp;&amp; (*i)-&gt;detectable()) 
-	{
-	  Vector2 n = (*i)-&gt;normal_pos();
-	  int q = iround_down(n.x * QUADI_X) + 
-	    iround_down(n.y * QUADI_Y) * QUADS_X;
-	  if ((q &lt; 0) || (q &gt; QUADS_TOTAL)) 
-	    {
-	      tw_error(&quot;bad quadrant&quot;);
-	    }
-	  (*i)-&gt;qnext = quadrant[q];
-	  quadrant[q] = *i;
-	}
-      else (*i)-&gt;qnext = NULL;
-    }
+  {
+    _STACKTRACE(&quot;Physics::calculate() - quadrants stuff&quot;)
+      for(i = 0; i &lt; QUADS_TOTAL; i += 1) {
+	quadrant[i] = NULL;
+      }
+    m_valid_item.clear();
+    for(std::list&lt;SpaceLocation*&gt;::iterator i=item.begin();i!=item.end();i++)
+      {
+	if( (*i)-&gt;exists())
+	  {
+	    m_valid_item.insert(*i);
+	  }
+	if ((*i)-&gt;exists() &amp;&amp; (*i)-&gt;detectable()) 
+	  {
+	    Vector2 n = (*i)-&gt;normal_pos();
+	    int q = iround_down(n.x * QUADI_X) + 
+	      iround_down(n.y * QUADI_Y) * QUADS_X;
+	    if ((q &lt; 0) || (q &gt; QUADS_TOTAL)) 
+	      {
+		tw_error(&quot;bad quadrant&quot;);
+	      }
+	    (*i)-&gt;qnext = quadrant[q];
+	    quadrant[q] = *i;
+	  }
+	else 
+	  (*i)-&gt;qnext = NULL;
+      }
   }
   
   checksync();
@@ -1294,15 +1396,29 @@
   PMASKDATA_FLOAT *tmp;
   int l = 0;
   tmp = new PMASKDATA_FLOAT[item.size()];
+
+  /*
+  std::set&lt;SpaceLocation*&gt; tst;
   for(std::list&lt;SpaceLocation*&gt;::iterator i=item.begin();i!=item.end();i++)
     {
+      tst.insert(*i);
+    }
+  if(tst.size()!=item.size())
+    {
+      tw_error(&quot;AAA&quot;);
+    }
+  */
+  
+  for(std::list&lt;SpaceLocation*&gt;::iterator i=item.begin();i!=item.end();i++)
+    {
       if ((*i) &amp;&amp; (*i)-&gt;exists() &amp;&amp; (*i)-&gt;isObject() &amp;&amp; (*i)-&gt;detectable() ) 
 	{
 	  SpaceObject *o = (SpaceObject *) (*i);
 	  Vector2 p = o-&gt;pos - o-&gt;size / 2;
 	  tmp[l].x = p.x;
 	  tmp[l].y = p.y;
-	  if (tmp[l].y &lt; 0) tmp[l].y += size.y;
+	  if (tmp[l].y &lt; 0) 
+	    tmp[l].y += size.y;
 	  tmp[l].pmask = o-&gt;get_sprite()-&gt;get_pmask(o-&gt;get_sprite_index());
 	  tmp[l].data = o;
 	  l += 1;

Modified: trunk/source/melee/mframe.h
===================================================================
--- trunk/source/melee/mframe.h	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/source/melee/mframe.h	2005-05-16 18:39:41 UTC (rev 164)
@@ -19,6 +19,7 @@
 
 #include &lt;list&gt;
 #include &lt;vector&gt;
+#include &lt;set&gt;
 
 #include &quot;melee.h&quot;
 #include &quot;util/vector2.h&quot;
@@ -69,6 +70,7 @@
 /// \brief melee universe
 class Physics : public BaseClass 
 {
+  std::set&lt;SpaceLocation*&gt; m_valid_item; ///&lt; contain the same information as item (exept that only exising items here)
  public:
   
   std::vector&lt;SpaceLocation*&gt; quadrant;
@@ -77,6 +79,8 @@
   std::list&lt;SpaceLocation*&gt; item;
   std::list&lt;Presence*&gt; presence;
   
+  bool in_itemP(SpaceLocation*l); ///&lt; space location can be found in game item
+
   /// add space location to universe
   void add(SpaceLocation *p);
   /// add presence from universe
@@ -374,18 +378,20 @@
   virtual void inflict_damage(SpaceObject *other);
 };
 
-struct Query 
+class Query 
 {
-  private:
-int layers;
+ private:
+  int layers;
   SpaceLocation *target;
   int qx_min, qx_max;
   int qy_min, qy_max;
   int qx, qy;
   Vector2 target_pos;
   double range_sqr;
+
+  std::list&lt;SpaceLocation*&gt;::iterator m_cur_pos;
   void next_quadrant ();
-  public:
+ public:
   union 
   {
     SpaceObject   *currento;
@@ -396,11 +402,13 @@
   void begin (SpaceLocation *target, Vector2 center, int layers, double range);
   void next ();
   void end();
-  private:
+ private:
   bool current_invalid() 
   {
-    if (!(bit(current-&gt;layer) &amp; layers) || (current == target) || !current-&gt;exists()) return true;
-    if (magnitude_sqr(min_delta(target_pos, current-&gt;normal_pos())) &gt; range_sqr) return true;
+    if (!(bit(current-&gt;layer) &amp; layers) || (current == target) || !current-&gt;exists()) 
+      return true;
+    if (magnitude_sqr(min_delta(target_pos, current-&gt;normal_pos())) &gt; range_sqr) 
+      return true;
     return false;
   }
 };

Modified: trunk/source/melee/mship.cpp
===================================================================
--- trunk/source/melee/mship.cpp	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/source/melee/mship.cpp	2005-05-16 18:39:41 UTC (rev 164)
@@ -295,6 +295,7 @@
   
   hashotspots = true;
   ship_name = &quot;&quot;;
+  m_fire_weapon_disabled = false;
 }
 
 Ship::Ship(Vector2 opos, double shipAngle, ShipData *shipData, unsigned int ally_flag) :
@@ -395,11 +396,13 @@
 
   hashotspots = true;
   ship_name = &quot;&quot;;
+  m_fire_weapon_disabled = false;
 }
 
 
 std::string Ship::get_ship_name()
 {
+  STACKTRACE;
   return ship_name;
 }
 
@@ -861,7 +864,17 @@
   set_target(otarget);
 }
 
+void Ship::disableWeapon()
+{
+  m_fire_weapon_disabled = true;
+}
 
+void Ship::enableWeapon()
+{
+  m_fire_weapon_disabled = false;
+}
+
+
 void Ship::calculate_thrust() {
   STACKTRACE;
   if (thrust)
@@ -883,10 +896,14 @@
     turn_step += turn_rate * frame_time;
 }
 
-void Ship::calculate_fire_weapon() {
+void Ship::calculate_fire_weapon() 
+{
   STACKTRACE;
   weapon_low = FALSE;
 
+  if(m_fire_weapon_disabled)
+    return;
+  
   if (fire_weapon) {
     if (batt &lt; weapon_drain) {
       weapon_low = true;
@@ -916,8 +933,12 @@
 void Ship::calculate_fire_special()
 {
   STACKTRACE;
+  
   special_low = FALSE;
 
+  if(m_fire_weapon_disabled)
+    return;
+
   if(fire_special) {
     if(batt &lt; special_drain) {
       special_low = TRUE;
@@ -986,6 +1007,7 @@
 
 void Ship::chat_with_player()
 {
+  STACKTRACE;
   std::string dialog = GameConfig::GetAbsolutePath( std::string(&quot;dialogs/shp&quot;) + type-&gt;id + &quot;.xml&quot;);
   set_dialog_script(dialog);
   SpaceObject::chat_with_player();

Modified: trunk/source/melee/mship.h
===================================================================
--- trunk/source/melee/mship.h	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/source/melee/mship.h	2005-05-16 18:39:41 UTC (rev 164)
@@ -75,6 +75,7 @@
 /// \brief Exactly what is sounds like
 class Ship : public SpaceObject 
 {
+  bool m_fire_weapon_disabled;
  protected:
   
   std::string ship_name;
@@ -155,6 +156,8 @@
   
   friend class ShipPanel;
   
+
+
   Ship(SpaceLocation *creator, Vector2 opos, double shipAngle, 
        SpaceSprite *osprite) ;
   Ship(Vector2 opos, double shipAngle, ShipData *shipData, 
@@ -182,6 +185,8 @@
   virtual void animate(Frame *frame);
   
   virtual void chat_with_player();
+  virtual void disableWeapon();
+  virtual void enableWeapon();
 
  protected:
     Presence* _target_TeamIndicator;

Modified: trunk/source/other/starmap.cpp
===================================================================
--- trunk/source/other/starmap.cpp	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/source/other/starmap.cpp	2005-05-16 18:39:41 UTC (rev 164)
@@ -24,12 +24,15 @@
 
 #include &lt;sstream&gt;
 
+std::list&lt;Presence*&gt; StarSystem::m_presenceNewStarBegin;
+
 StarSystem::StarSystem(const std::string&amp; name, Vector2 pos)
   :
   _pos(pos),
   _name(name)
 {
   STACKTRACE;
+  _presence = m_presenceNewStarBegin;
 }
 
 StarSystem::~StarSystem()

Modified: trunk/source/other/starmap.h
===================================================================
--- trunk/source/other/starmap.h	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/source/other/starmap.h	2005-05-16 18:39:41 UTC (rev 164)
@@ -33,12 +33,16 @@
   /// name
   std::string _name;
  public:
+  
+  static std::list&lt;Presence*&gt; m_presenceNewStarBegin;
+  
   StarSystem(const std::string&amp; name, Vector2 pos);
   virtual ~StarSystem();
 
   /// SpaceObjects in system
   std::list&lt;SpaceLocation*&gt; _item;
-
+  std::list&lt;Presence*&gt; _presence;
+  
   virtual void add(SpaceLocation* l);
   std::string getName() const;
   std::list&lt;SpaceLocation*&gt; getItem() const;

Modified: trunk/source/python/python_class.cpp
===================================================================
--- trunk/source/python/python_class.cpp	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/source/python/python_class.cpp	2005-05-16 18:39:41 UTC (rev 164)
@@ -136,6 +136,7 @@
 
 void python::exec_function(const std::string&amp; name)
 {
+  STACKTRACE;
   PyObject* evalModule;
   PyObject* evalDict;
   PyObject* pFunc;
@@ -143,6 +144,7 @@
   PyObject* pValue;
 
   evalModule = PyImport_AddModule( (char*)&quot;__main__&quot; );
+  
   if(!evalModule)
     {
       tw_error(&quot;Can't get __main__ module&quot;);
@@ -164,10 +166,10 @@
       tw_error( (std::string(&quot;Call failed: &quot;) + name).c_str());
     }
   pValue = PyObject_CallObject(pFunc, pArgs);
-  Py_DECREF(pArgs);
+  //Py_DECREF(pArgs);
   if (pValue != NULL) 
     {
-      Py_DECREF(pValue);
+      //  Py_DECREF(pValue);
     }
   else 
     {
@@ -177,6 +179,7 @@
 
 void python::exec_class(const std::string&amp; name)
 {
+  STACKTRACE;
   PyObject* evalModule;
   PyObject* evalDict;
   PyObject* pFunc;

Modified: trunk/source/scp.cpp
===================================================================
--- trunk/source/scp.cpp	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/source/scp.cpp	2005-05-16 18:39:41 UTC (rev 164)
@@ -36,6 +36,7 @@
 #include &quot;other/dialogs.h&quot;
 
 #include &quot;tests/testmain.h&quot;
+#include &quot;tml/eventmanager.h&quot;
 
 // standard includes
 #include &lt;iostream&gt;
@@ -811,7 +812,7 @@
     tw_error_exit(&quot;Allegro initialization failed&quot;);
   //install_allegro_gl();
   init_datafile_path();
-  GameConfig::SetGameDirectory(datafile_path + &quot;/test_game&quot;);
+  GameConfig::SetGameDirectory(datafile_path + &quot;/games/test_game&quot;);
   create_user_ini();
   python::init();  
 
@@ -1061,6 +1062,7 @@
     if (__error_flag &amp; 1) throw;
   }
   
+  EventManager::clean();
   python::cleanup();  
   tw_exit(0);
   return 0;
@@ -2081,7 +2083,8 @@
   if(!file_exists(curFile.c_str(), 0, NULL))
     mkdir(curFile.c_str(), 0777);
   
-  for_each_file( (data_full_path(&quot;&quot;)+std::string(&quot;default_ini/ships/shp*.ini&quot;)).c_str(), 
+  std::string path = data_full_path(&quot;&quot;)+std::string(&quot;default_ini/ships/shp*.ini&quot;);
+  for_each_file( path.c_str(), 
 		 FA_ARCH|FA_RDONLY, 
 		 _copy_ship_ini, 0);
   return 0;

Modified: trunk/source/tests/gameconfigtest.cpp
===================================================================
--- trunk/source/tests/gameconfigtest.cpp	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/source/tests/gameconfigtest.cpp	2005-05-16 18:39:41 UTC (rev 164)
@@ -21,11 +21,13 @@
 
 #include &quot;gameconfigtest.h&quot;
 #include &quot;tml/gameconfig.h&quot;
+#include &quot;util/errors.h&quot;
 
 #include &lt;string&gt;
 
 void TestGameConfig::testSetGameDirectory()
 {
+  STACKTRACE;
   std::string game_dir = &quot;/home/yura/gm&quot;;
   GameConfig::SetGameDirectory(&quot;/home/yura/gm&quot;);
   CPPUNIT_ASSERT_EQUAL(game_dir + &quot;/&quot;, GameConfig::GetGameDirectory());
@@ -33,6 +35,7 @@
 
 void TestGameConfig::testGetAbsolutePath()
 {
+  STACKTRACE;
   std::string game_dir = &quot;/home/yura/gm&quot;;
   GameConfig::SetGameDirectory(&quot;gamedata/music&quot;);
   

Modified: trunk/source/tml/eventmanager.cpp
===================================================================
--- trunk/source/tml/eventmanager.cpp	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/source/tml/eventmanager.cpp	2005-05-16 18:39:41 UTC (rev 164)
@@ -37,6 +37,7 @@
 
 void EventManager::clean()
 {
+  STACKTRACE;
   for(twl::EventList::iterator i = g_events.begin(); i!= g_events.end();i++)
     {
       (*i)-&gt;die();
@@ -46,6 +47,7 @@
 
 int EventManager::setSingleTimeEvent(double time, const std::string&amp; script)
 {
+  STACKTRACE;
   TEventSingleTime* e = new TEventSingleTime();
   boost::shared_ptr&lt;TGameEvent&gt; ev( e );
   int id = e-&gt;setUp((int)time,script);
@@ -55,6 +57,7 @@
 
 int EventManager::setRepeatableTimeEvent(double time, const std::string&amp; script)
 {
+  STACKTRACE;
   TEventRepeatableTime* e = new TEventRepeatableTime();
   boost::shared_ptr&lt;TGameEvent&gt; ev( e );
   int id = e-&gt;setUp((int)time,script);
@@ -76,12 +79,20 @@
 
 void EventManager::disableEvent(double id)
 {
-  (*std::find_if(g_events.begin(), g_events.end(), std::bind2nd(find_event_by_id(),id)))-&gt;die();
+  STACKTRACE;
+  std::list&lt;boost::shared_ptr&lt;TGameEvent&gt; &gt;::iterator e = std::find_if(g_events.begin(), 
+								       g_events.end(), 
+								       std::bind2nd(find_event_by_id(),id));
+  if(e!=g_events.end()&amp;&amp;(*e)-&gt;exists())
+    {
+      (*e)-&gt;die();
+    }
 }
 
 
 int EventManager::shipDeathByName(const std::string&amp; name, const std::string&amp; script )
 {
+  STACKTRACE;
   int ret = -1;
   for(std::list&lt;SpaceLocation*&gt;::iterator i = gobgame-&gt;item.begin(); i!= gobgame-&gt;item.end();i++)
     {
@@ -98,6 +109,7 @@
 
 int EventManager::shipDeathByType(const std::string&amp; type, const std::string&amp; script )
 {
+  STACKTRACE;
   TEventShipDeathByType* e = new TEventShipDeathByType();
   boost::shared_ptr&lt;TGameEvent&gt; ev( e );
   int ret = e-&gt;setUp(type, script);
@@ -109,6 +121,7 @@
 template &lt;class T&gt;
 int EventManager::distanceXThen(double obj, double x, double y, double dist, const std::string&amp; script)
 {
+  STACKTRACE;
   std::set&lt;SpaceLocation*&gt;::iterator i = twl::get_location&lt; std::set&lt;SpaceLocation*&gt;::iterator &gt; (m_allSpaceLocations.begin(),m_allSpaceLocations.end(), (int)obj);
   if(i!=m_allSpaceLocations.end())
     {
@@ -123,11 +136,13 @@
 
 int EventManager::distanceMoreThen(double obj, double x, double y, double dist, const std::string&amp; script)
 {
+  STACKTRACE;
   return distanceXThen&lt;TEventDistanceMoreThen1Obj&gt;(obj, x, y, dist, script);
 }
 
 int EventManager::distanceLessThen(double obj, double x, double y, double dist, const std::string&amp; script)
 {
+  STACKTRACE;
   return distanceXThen&lt;TEventDistanceLessThen1Obj&gt;(obj, x, y, dist, script);
 }
 
@@ -135,6 +150,7 @@
 template &lt;class T&gt;
 int EventManager::distanceXThen(double obj1, double obj2, double dist, const std::string&amp; script)
 {
+  STACKTRACE;
   std::set&lt;SpaceLocation*&gt;::iterator i1 = twl::get_location&lt; std::set&lt;SpaceLocation*&gt;::iterator &gt; (m_allSpaceLocations.begin(),m_allSpaceLocations.end(), (int)obj1);
   std::set&lt;SpaceLocation*&gt;::iterator i2 = twl::get_location&lt; std::set&lt;SpaceLocation*&gt;::iterator &gt; (m_allSpaceLocations.begin(),m_allSpaceLocations.end(), (int)obj2);
   if(i1!=m_allSpaceLocations.end()&amp;&amp;i2!=m_allSpaceLocations.end())
@@ -150,11 +166,13 @@
 
 int EventManager::distanceMoreThen(double obj1, double obj2, double dist, const std::string&amp; script)
 {
+  STACKTRACE;
   return distanceXThen&lt;TEventDistanceMoreThen2Obj&gt;(obj1, obj2, dist, script);
 }
 
 int EventManager::distanceLessThen(double obj1, double obj2, double dist, const std::string&amp; script)
 {
+  STACKTRACE;
   return distanceXThen&lt;TEventDistanceLessThen2Obj&gt;(obj1, obj2, dist, script);
 }
 
@@ -218,6 +236,7 @@
 
 void EventManager::calculate()
 {
+  STACKTRACE;
   std::for_each(g_events.begin(), g_events.end(), calcevent);  
   g_events.erase(std::remove_if(g_events.begin(), g_events.end(), std::not1(twl::isexists())),g_events.end());
 }

Modified: trunk/source/tml/gameaction.cpp
===================================================================
--- trunk/source/tml/gameaction.cpp	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/source/tml/gameaction.cpp	2005-05-16 18:39:41 UTC (rev 164)
@@ -31,17 +31,20 @@
 
 void GameAction::clean()
 {
+  STACKTRACE;
   g_string_flag_map.clear();
   g_double_flag_map.clear();
 }
 void GameAction::add_system(const std::string&amp; name, double x, double y)
 {
+  STACKTRACE;
   gobgame-&gt;add_system(name, (int)x, (int)y);
   gobgame-&gt;prepare();
 }
 
 int GameAction::add_planet(const std::string&amp; system, const std::string&amp; name, double x, double y)
 {
+  STACKTRACE;
   return gobgame-&gt;add_planet(system, name, (int)x, (int)y);
 }
 
@@ -53,31 +56,43 @@
 			     const std::string&amp; buildtype,
 			     const std::string&amp; commander_dialog)
 {
+  STACKTRACE;
   return gobgame-&gt;add_orbiter_station(system, planet, gatafile,station_sprite, background_picture, buildtype,commander_dialog);
 }
 
 int GameAction::add_asteroid(const std::string&amp; system, double x, double y, double oangle, double speed)
 {
+  STACKTRACE;
   return gobgame-&gt;add_asteroid(system, Vector2(x,y), (int)oangle, (int)speed);
 }
 
 int GameAction::add_player(const std::string&amp; system, const std::string&amp; shptype, double x, double y)
 {
+  STACKTRACE;
   return gobgame-&gt;add_player(system, shptype, (int)x, (int)y);
 }
 
 int GameAction::add_ship(const std::string&amp; system, const std::string&amp; shptype, double x, double y, double team)
 {
+  STACKTRACE;
   return gobgame-&gt;add_ship(system, shptype, Vector2(x,y), team);
 }
 
 double GameAction::get_player_ship_id()
 {
+  STACKTRACE;
   return gobgame-&gt;gobplayer.ship-&gt;get_id();
 }
 
+std::string GameAction::get_player_star_system()
+{
+  STACKTRACE;
+  return gobgame-&gt;_name;
+}
+
 void GameAction::save_flag(const std::string&amp; name, const std::string&amp; value)
 {
+  STACKTRACE;
   g_string_flag_map[name] = value;
   if(g_string_flag_map.find(name)==g_string_flag_map.end())
   {
@@ -87,6 +102,7 @@
 
 std::string GameAction::get_string_flag(const std::string&amp; name)
 {
+  STACKTRACE;
   if(g_string_flag_map.find(name)==g_string_flag_map.end())
   {
     tw_error( (std::string(&quot;Unable to find global string flag: &quot;) + name).c_str());
@@ -96,11 +112,13 @@
 
 void GameAction::save_flag(const std::string&amp; name, double value)
 {
+  STACKTRACE;
   g_double_flag_map[name] = value;
 }
 
 double GameAction::get_double_flag(const std::string&amp; name)
 {
+  STACKTRACE;
   if(g_double_flag_map.find(name)==g_double_flag_map.end())
   {
     tw_error( (std::string(&quot;Unable to find global double flag: &quot;) + name).c_str());
@@ -111,6 +129,7 @@
 
 void GameAction::set_target(double who, double to)
 {
+  STACKTRACE;
   SpaceLocation* l  =  twl::get_location((int)who);
   SpaceLocation* l2  =  twl::get_location((int)to);
   
@@ -122,10 +141,12 @@
 
 void GameAction::disable_weapon(double who)
 {
+  STACKTRACE;
 }
 
 void GameAction::enable_weapon(double who)
 {
+  STACKTRACE;
 }
 
 template &lt;class T&gt;
@@ -141,6 +162,7 @@
 
 int GameAction::go_to_point(double who, double x, double y, double dist)
 {
+  STACKTRACE;
   return add_point_based_event&lt;TEventOrderMoveToPoint&gt;(who, x, y, dist);
 }
 
@@ -160,19 +182,55 @@
 
 int GameAction::go_to_location(double who, double to, double dist)
 {
+  STACKTRACE;
   return add_location_based_event&lt;TEventOrderMoveToLocation&gt;(who, to, dist);
 }
 
 int GameAction::guard_location(double who, double to, double dist)
 {
+  STACKTRACE;
   return add_location_based_event&lt;TEventGuardLocation&gt;(who, to, dist);
 }
 
 int GameAction::guard_point(double who, double x, double y, double dist)
 {
+  STACKTRACE;
   return add_point_based_event&lt;TEventGuardPoint&gt;(who, x, y, dist);
 }
 
 void GameAction::set_ship_team(double who, double team)
 {
+  STACKTRACE;
 }
+
+int GameAction::get_enemy_team()
+{
+  STACKTRACE;
+  return gobgame-&gt;enemy_team;
+}
+int GameAction::get_player_team()
+{
+  STACKTRACE;
+  return gobgame-&gt;player_team;
+}
+
+void GameAction::remove_location(double id)
+{
+  STACKTRACE;
+  SpaceLocation* l  =  twl::get_location((int)id);
+  if(l &amp;&amp; l-&gt;exists())
+    {
+      l-&gt;die();
+    }
+}
+
+void GameAction::set_crew(double id, double crew)
+{
+  STACKTRACE;
+  SpaceLocation* l  =  twl::get_location((int)id);
+  if(l &amp;&amp; l-&gt;exists() &amp;&amp; l-&gt;isShip())
+    {
+      Ship* s = (Ship*)l;
+      s-&gt;crew = crew;
+    }
+}

Modified: trunk/source/tml/gameaction.h
===================================================================
--- trunk/source/tml/gameaction.h	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/source/tml/gameaction.h	2005-05-16 18:39:41 UTC (rev 164)
@@ -124,6 +124,9 @@
   /// Get player ship id
   static double get_player_ship_id();
 
+  /// Return name of star system where player is
+  static std::string get_player_star_system();
+
   static void set_target(double who, double to);
   
   static void disable_weapon(double who);
@@ -163,7 +166,21 @@
   static int guard_point(double who, double x, double y, double dist);
   
   static void set_ship_team(double who, double team);
-  
+
+  static int get_enemy_team();
+  static int get_player_team();
+
+  /// Remove location from game
+  ///
+  /// @param id location id 
+  static void remove_location(double id);
+
+  /// Set new crew number to ship
+  ///
+  /// @param id ship id
+  /// @param crew new crew
+  static void set_crew(double id, double crew);
+
 };
 
 

Modified: trunk/source/tml/gameconfig.cpp
===================================================================
--- trunk/source/tml/gameconfig.cpp	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/source/tml/gameconfig.cpp	2005-05-16 18:39:41 UTC (rev 164)
@@ -18,11 +18,13 @@
 #include &quot;gameconfig.h&quot;
 #include &quot;scp.h&quot;
 #include &quot;allegro.h&quot;
+#include &quot;util/errors.h&quot;
 
 std::string GameConfig::game_data_dir = &quot;&quot;;
 
 void GameConfig::SetGameDirectory(const std::string&amp; gamedir)
 {
+  STACKTRACE;
   if(!gamedir.length())
     return;
 
@@ -38,11 +40,13 @@
 
 std::string GameConfig::GetGameDirectory()
 {
+  STACKTRACE;
   return game_data_dir;
 }
 
 std::string GameConfig::GetAbsolutePath(const std::string&amp; file)
 {
+  STACKTRACE;
   if(!file.length())
     return &quot;&quot;;
   if(file[0] == '/')

Modified: trunk/source/tml/gamedialog.cpp
===================================================================
--- trunk/source/tml/gamedialog.cpp	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/source/tml/gamedialog.cpp	2005-05-16 18:39:41 UTC (rev 164)
@@ -39,6 +39,7 @@
 static bool g_paused = false;
 void DialogApi::startDialog()
 {
+  STACKTRACE;
   std::cerr&lt;&lt;__FUNCTION__&lt;&lt;&quot;\n&quot;;
   g_paused = game-&gt;is_paused();
   if(!game-&gt;is_paused())
@@ -48,6 +49,7 @@
 
 void DialogApi::endDialog()
 {
+  STACKTRACE;
   std::cerr&lt;&lt;__FUNCTION__&lt;&lt;&quot;\n&quot;;
   if(!g_paused)
     game-&gt;unpause();
@@ -56,6 +58,7 @@
 
 int DialogApi::askPlayer(std::vector&lt;const char*&gt; answers)
 {
+  STACKTRACE;
   std::cerr&lt;&lt;__FUNCTION__&lt;&lt;&quot;\n&quot;;
   MENU *pMenuAnswers = new MENU[answers.size()+1];
   for( unsigned int i=0; i&lt;answers.size(); i++)
@@ -106,6 +109,7 @@
 
 void DialogApi::showText(const std::string&amp; text, int delay, int x, int y)
 {
+  STACKTRACE;
   std::cerr&lt;&lt;__FUNCTION__&lt;&lt;&quot;\n&quot;;
   RGB tmpPal[256];
   memcpy(tmpPal, palette_color, sizeof(RGB) * 256);
@@ -138,6 +142,7 @@
  
 void DialogApi::showAlienPicture(const std::string&amp; path)
 {
+  STACKTRACE;
   std::cerr&lt;&lt;__FUNCTION__&lt;&lt;&quot;\n&quot;;
   std::string pic = GameConfig::GetAbsolutePath(path);
   if(!pic.length())

Modified: trunk/source/tml/gameevent.cpp
===================================================================
--- trunk/source/tml/gameevent.cpp	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/source/tml/gameevent.cpp	2005-05-16 18:39:41 UTC (rev 164)
@@ -22,6 +22,7 @@
 #include &quot;python/python_class.h&quot;
 #include &quot;melee.h&quot;
 #include &quot;melee/mship.h&quot;
+#include &quot;melee/mcontrol.h&quot;
 
 static int generateEventID()
 {
@@ -32,18 +33,19 @@
 
 TGameEvent::TGameEvent()
 {
+  STACKTRACE;
   exist = true;
   id = generateEventID();
-  std::cerr&lt;&lt;&quot;Created event type: &quot;&lt;&lt;type()&lt;&lt;std::endl;
 }
 
 TGameEvent::~TGameEvent()
 {
-  std::cerr&lt;&lt;&quot;Destroyed event type: &quot;&lt;&lt;type()&lt;&lt;std::endl;
+
 }
 
 void TGameEvent::trigger()
 {
+  STACKTRACE;
   // execute function
   //  python::exec_function(_script);
   python::exec_class(_script);
@@ -51,12 +53,14 @@
 
 void TOneTimeEvent::trigger()
 {
+  STACKTRACE;
   TOneTimeEventBase::trigger();
   die();
 }
 
 TEventTime::TEventTime()
 {
+  STACKTRACE;
 }
 
 TEventTime::~TEventTime()
@@ -65,6 +69,7 @@
 
 bool TEventTime::calculate()
 {
+  STACKTRACE;
   if( _spot_time == gobgame-&gt;game_time / 1000)
     {
       trigger();
@@ -75,13 +80,15 @@
 
 int TEventTime::setUp(int time, const std::string&amp; script)
 {
+  STACKTRACE;
   _spot_time = time;
   _script = script;
   return id;
 }
 
 TEventSingleTime::TEventSingleTime()
-{  
+{
+  STACKTRACE;  
 }
 
 TEventSingleTime::~TEventSingleTime()
@@ -90,6 +97,7 @@
 
 bool TEventSingleTime::calculate()
 {
+  STACKTRACE;
   if(TEventTime::calculate())
     {
       die();
@@ -100,6 +108,7 @@
 
 TEventRepeatableTime::TEventRepeatableTime()
 {
+  STACKTRACE;
   interval = -1;
 }
 
@@ -109,6 +118,7 @@
 
 bool TEventRepeatableTime::calculate()
 {
+  STACKTRACE;
   if(TEventRepeatableTimeBase::calculate())
     {
       _spot_time += interval;
@@ -119,6 +129,7 @@
 
 int TEventRepeatableTime::setUp(int time, const std::string&amp; script)
 {
+  STACKTRACE;
   interval = time;
   TEventRepeatableTimeBase::setUp(gobgame-&gt;game_time/1000 + time, script);
   return id;
@@ -131,6 +142,7 @@
 
 int TEventShipDeathByName::setUp(const std::string&amp; script)
 {
+  STACKTRACE;
   _script = script;
   return id;
 }
@@ -138,6 +150,7 @@
 
 TEventShipDeathByType::TEventShipDeathByType()
 {
+  STACKTRACE;
 }
 TEventShipDeathByType::~TEventShipDeathByType()
 {
@@ -145,6 +158,7 @@
 
 int TEventShipDeathByType::setUp(const std::string type, const std::string&amp; script)
 {
+  STACKTRACE;
   _type = type;
   _script = script;
   return id;
@@ -152,6 +166,7 @@
 
 bool TEventShipDeathByType::calculate(Ship* s)
 {
+  STACKTRACE;
   if(_type == s-&gt;type-&gt;id)
     {
       trigger();
@@ -163,6 +178,7 @@
 
 TEventDistance::TEventDistance()
 {
+  STACKTRACE;
 }
 TEventDistance::~TEventDistance()
 {
@@ -171,17 +187,22 @@
 
 bool TEventDistance::calculate()
 {
+  STACKTRACE;
   // check if location doesn't exist, event is invalid
   if(!m_location-&gt;exists()||!m_location2-&gt;exists())
     {
       die();
+      return false;
     }
   return check();
 }
 
 bool TEventDistance::check_less()
 {
-  if(m_location2-&gt;distance(m_location)&lt;m_dist)
+  STACKTRACE;
+  if(gobgame-&gt;in_itemP(m_location)  &amp;&amp; 
+     //gobgame-&gt;in_itemP(m_location2) &amp;&amp; 
+     m_location2-&gt;distance(m_location)&lt;m_dist)
     {
       trigger();
       return true;
@@ -191,7 +212,10 @@
 
 bool TEventDistance::check_more()
 {
-  if(m_location2-&gt;distance(m_location)&gt;m_dist)
+  STACKTRACE;
+  if(gobgame-&gt;in_itemP(m_location)  &amp;&amp; 
+     //gobgame-&gt;in_itemP(m_location2) &amp;&amp; 
+     m_location2-&gt;distance(m_location)&gt;m_dist)
     {
       trigger();
       return true;
@@ -203,6 +227,7 @@
 
 TEventDistanceMoreThen1Obj::TEventDistanceMoreThen1Obj()
 {
+  STACKTRACE;
   m_location2 = new Asteroid();
 }
 
@@ -214,11 +239,13 @@
 
 bool TEventDistanceMoreThen1Obj::check()
 {
+  STACKTRACE;
   return check_more();
 }
 
 int TEventDistanceMoreThen1Obj::setUp(SpaceLocation* l, Vector2 pos, double dist, const std::string&amp; script)
 {
+  STACKTRACE;
   m_location = l;
   m_location2-&gt;pos = Vector2(0,0);
   m_location2-&gt;translate(pos);
@@ -231,6 +258,7 @@
 /////////////////////////////////////////////////////////////////////////////////////////////////////////////
 TEventDistanceLessThen1Obj::TEventDistanceLessThen1Obj()
 {
+  STACKTRACE;
 }
 
 TEventDistanceLessThen1Obj::~TEventDistanceLessThen1Obj()
@@ -239,6 +267,7 @@
 
 bool TEventDistanceLessThen1Obj::check()
 {
+  STACKTRACE;
   return check_less();
 }
 
@@ -247,6 +276,7 @@
 
 TEventDistanceMoreThen2Obj::TEventDistanceMoreThen2Obj()
 {
+  STACKTRACE;
 }
 TEventDistanceMoreThen2Obj::~TEventDistanceMoreThen2Obj()
 {
@@ -254,11 +284,13 @@
 
 bool TEventDistanceMoreThen2Obj::check()
 {
+  STACKTRACE;
   return check_more();
 }
 
 int TEventDistanceMoreThen2Obj::setUp(SpaceLocation* l1, SpaceLocation* l2, double dist, const std::string&amp; script)
 {
+  STACKTRACE;
   m_location  = l1;
   m_location2 = l2;;
   m_dist     = dist;
@@ -269,6 +301,7 @@
 
 TEventDistanceLessThen2Obj::TEventDistanceLessThen2Obj()
 {
+  STACKTRACE;
 }
 
 TEventDistanceLessThen2Obj::~TEventDistanceLessThen2Obj()
@@ -277,6 +310,7 @@
 
 bool TEventDistanceLessThen2Obj::check()
 {
+  STACKTRACE;
   return check_less();
 }
 /////////////////////////////////////////////////////////////////////////////////////////////////////////////
@@ -284,6 +318,7 @@
 
 TEventMoveTerminator::TEventMoveTerminator()
 {
+  STACKTRACE;
 }
 TEventMoveTerminator::~TEventMoveTerminator()
 {
@@ -291,17 +326,20 @@
 
 void TEventMoveTerminator::trigger()
 {
+  STACKTRACE;
   die();
 }
 
 void TEventMoveTerminator::die()
 {
+  STACKTRACE;
   TEventMoveTerminatorBase::die();
   EventManager::disableEvent(m_term_event);
 }
 
 int TEventMoveTerminator::setUp(SpaceLocation* l1, SpaceLocation* l2, double dist, int event_to_terminate)
 {
+  STACKTRACE;
   m_term_event = event_to_terminate;
   return TEventMoveTerminatorBase::setUp(l1,l2, dist, &quot;&quot;);
 }
@@ -311,34 +349,46 @@
 
 TEventOrderMoveToLocation::TEventOrderMoveToLocation()
 {
+  STACKTRACE;
 }
 
 TEventOrderMoveToLocation::~TEventOrderMoveToLocation()
 {
+  if(m_terminator &amp;&amp; m_terminator-&gt;exists())
+    {
+      m_terminator-&gt;die();
+    }
 }
 
 void TEventOrderMoveToLocation::die()
 {
-  if(m_terminator-&gt;exists())
+  STACKTRACE;
+  if(m_terminator &amp;&amp; m_terminator-&gt;exists())
     {
       m_terminator-&gt;die();
     }
-  TEventOrderMoveToLocationBase::die();
 }
 
 bool TEventOrderMoveToLocation::calculate()
 {
-  /*  if(!l1-&gt;exist()||!l2-&gt;exist())
+  STACKTRACE;
+  if(!m_location-&gt;exists()||!m_location2-&gt;exists())
     {
       die();
+      return true;
     }
-  */
-  if(!m_location-&gt;isShip())
+
+  Ship* shp = (Ship*)m_location;
+  if(shp-&gt;death_counter!=-1)
     {
       die();
-      return true;
+      return true;  
     }
-  Ship* shp = (Ship*)m_location;
+
+  
+  //if(shp-&gt;control-&gt;planet_dangerP())
+  //    return false;
+  
   // reset the keys for this ship
   shp-&gt;nextkeys = 0;
 
@@ -386,6 +436,7 @@
 
 int TEventOrderMoveToLocation::setUp(SpaceLocation* l1, SpaceLocation* l2, double dist)
 {
+  STACKTRACE;
   TEventMoveTerminator* te = new TEventMoveTerminator();
   m_terminator = boost::shared_ptr&lt;TGameEvent&gt;(te);
   EventManager::g_events.push_back(m_terminator);
@@ -398,6 +449,7 @@
 
 TEventOrderMoveToPoint::TEventOrderMoveToPoint()
 {
+  STACKTRACE;
   m_location2 = new Asteroid();
 }
 
@@ -408,6 +460,7 @@
 
 int TEventOrderMoveToPoint::setUp(SpaceLocation* l1, Vector2 pos, double dist)
 {
+  STACKTRACE;
   m_location2-&gt;pos = Vector2(0,0);
   m_location2-&gt;translate(pos);
   return TEventOrderMoveToPointBase::setUp(l1, m_location2, dist);
@@ -417,14 +470,20 @@
 ///////////////////////////////////////////////////////////////////////////////////////////////////////
 TEventGuardLocation::TEventGuardLocation()
 {
+  STACKTRACE;
 }
 
 TEventGuardLocation::~TEventGuardLocation()
 {
+  if(m_move_to_location &amp;&amp; m_move_to_location-&gt;exists())
+    {
+      m_move_to_location-&gt;die();
+    }
 }
 
 void TEventGuardLocation::trigger()
 {
+  STACKTRACE;
   if( (bool)m_move_to_location &amp;&amp; m_move_to_location-&gt;exists())
     return;
   
@@ -446,12 +505,14 @@
 
 int TEventGuardLocation::setUp(SpaceLocation* l1, SpaceLocation* l2, double dist)
 {
+  STACKTRACE;
   return TEventGuardLocationBase::setUp(l1, l2, dist, &quot;&quot;);
 }
 
 //////////////////////////////////////////////////////////////////////////////////////////////////
 TEventGuardPoint::TEventGuardPoint()
 {
+  STACKTRACE;
    m_location2 = new Asteroid();
 }
 TEventGuardPoint::~TEventGuardPoint()
@@ -461,6 +522,7 @@
 
 int TEventGuardPoint::setUp(SpaceLocation* l1, Vector2 pos, double dist)
 {
+  STACKTRACE;
   m_location2-&gt;pos = Vector2(0,0);
   m_location2-&gt;translate(pos);
   return TEventGuardPointBase::setUp(l1, m_location2, dist);

Modified: trunk/source/tml/gameevent.h
===================================================================
--- trunk/source/tml/gameevent.h	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/source/tml/gameevent.h	2005-05-16 18:39:41 UTC (rev 164)
@@ -154,6 +154,7 @@
  protected:
   SpaceLocation* m_location;
   SpaceLocation* m_location2; 
+  
   double m_dist;
  protected:
   virtual bool check(){return true;};

Modified: trunk/source/util/sound.cpp
===================================================================
--- trunk/source/util/sound.cpp	2005-05-14 07:38:58 UTC (rev 163)
+++ trunk/source/util/sound.cpp	2005-05-16 18:39:41 UTC (rev 164)
@@ -286,6 +286,7 @@
 
 std::string SoundSystem::playing_music_file()
 {
+  STACKTRACE;
   if(playing_music() &amp;&amp; current_music.length()&gt;0)
     return current_music;
   return &quot;&quot;;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000109.html">[Tw-light-svn] r163 - in trunk/gamedata: . games games/test_game games/test_game/scripts games/test_game/scripts/systems
</A></li>
	<LI>Next message: <A HREF="000111.html">[Tw-light-svn] r165 - in trunk: gamedata/games/test_game/dialogs gamedata/games/test_game/scripts gamedata/games/test_game/scripts/systems gamedata/images/alien gamedata/python source/generated source/melee source/python source/ships source/tml
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#110">[ date ]</a>
              <a href="thread.html#110">[ thread ]</a>
              <a href="subject.html#110">[ subject ]</a>
              <a href="author.html#110">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/tw-light-svn">More information about the Tw-light-svn
mailing list</a><br>
</body></html>
