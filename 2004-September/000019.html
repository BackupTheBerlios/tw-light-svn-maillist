<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Tw-light-svn] r71 - in branches/multiplayer-branch: . Util Util/deditor doc gamedata gamedata/default_ini gamedata/default_ini/ships gamedata/images gamedata/images/ships/shpalabc gamedata/images/ships/shpandgu gamedata/images/ships/shparisk gamedata/images/ships/shpbahbu gamedata/images/ships/shpbipka gamedata/images/ships/shpchebr gamedata/images/ships/shpchmav gamedata/images/ships/shpchoex gamedata/images/ships/shpconca gamedata/images/ships/shpconho gamedata/images/ships/shpdragr gamedata/images/ships/shpdruma gamedata/images/ships/shpearc3 gamedata/images/ships/shpearcr gamedata/images/ships/shpforsh gamedata/images/ships/shpgarty gamedata/images/ships/shpilwav gamedata/images/ships/shpilwsp gamedata/images/ships/shpkahbo gamedata/images/ships/shpkohma gamedata/images/ships/shpkzedr gamedata/images/ships/shpmeltr gamedata/images/ships/shpmmrxf gamedata/images/ships/shpmycpo gamedata/images/ships/shporzne gamedata/images/ships/shppkufu gamedata/images/ships/shprogsq gamedata! /images/ships/shpshosc gamedata/images/ships/shpslypr gamedata/images/ships/shpspael gamedata/images/ships/shpstaba gamedata/images/ships/shpsupbl gamedata/images/ships/shpsyrpe gamedata/images/ships/shptauar gamedata/images/ships/shptauda gamedata/images/ships/shptausl gamedata/images/ships/shptauto gamedata/images/ships/shpthrto gamedata/images/ships/shpumgdr gamedata/images/ships/shputwju gamedata/images/ships/shpvuxin gamedata/images/ships/shpyehte gamedata/images/ships/shpzeksh gamedata/images/ships/shpzfpst gamedata/music gamedata/music/ditty gamedata/ships gamedata/sound gamedata/sound/ships/shpalabc gamedata/sound/ships/shpandgu gamedata/sound/ships/shparisk gamedata/sound/ships/shpbahbu gamedata/sound/ships/shpbipka gamedata/sound/ships/shpchebr gamedata/sound/ships/shpchmav gamedata/sound/ships/shpchoex gamedata/sound/ships/shpconca gamedata/sound/ships/shpconho gamedata/sound/ships/shpdragr gamedata/sound/ships/shpdruma gamedata/sound/ships/shpearc3 gamedata/soun! d/ships/shpearcr gamedata/sound/ships/shpforsh gamedata/sound/! ships/sh
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/tw-light-svn/2004-September/index.html" >
   <LINK REL="made" HREF="mailto:tw-light-svn%40lists.berlios.de?Subject=Re%3A%20%5BTw-light-svn%5D%20r71%20-%20in%20branches/multiplayer-branch%3A%20.%20Util%20Util/deditor%20doc%20gamedata%20gamedata/default_ini%20gamedata/default_ini/ships%20gamedata/images%20gamedata/images/ships/shpalabc%20gamedata/images/ships/shpandgu%20gamedata/images/ships/shparisk%20gamedata/images/ships/shpbahbu%20gamedata/images/ships/shpbipka%20gamedata/images/ships/shpchebr%20gamedata/images/ships/shpchmav%20gamedata/images/ships/shpchoex%20gamedata/images/ships/shpconca%20gamedata/images/ships/shpconho%20gamedata/images/ships/shpdragr%20gamedata/images/ships/shpdruma%20gamedata/images/ships/shpearc3%20gamedata/images/ships/shpearcr%20gamedata/images/ships/shpforsh%20gamedata/images/ships/shpgarty%20gamedata/images/ships/shpilwav%20gamedata/images/ships/shpilwsp%20gamedata/images/ships/shpkahbo%20gamedata/images/ships/shpkohma%20gamedata/images/ships/shpkzedr%20gamedata/images/ships/shpmeltr%20gamedata/images/ships/shpmmrxf%20gamedata/images/ships/shpmycpo%20gamedata/images/ships/shporzne%20gamedata/images/ships/shppkufu%20gamedata/images/ships/shprogsq%20gamedata%21%0A%20/images/ships/shpshosc%20gamedata/images/ships/shpslypr%20gamedata/images/ships/shpspael%20gamedata/images/ships/shpstaba%20gamedata/images/ships/shpsupbl%20gamedata/images/ships/shpsyrpe%20gamedata/images/ships/shptauar%20gamedata/images/ships/shptauda%20gamedata/images/ships/shptausl%20gamedata/images/ships/shptauto%20gamedata/images/ships/shpthrto%20gamedata/images/ships/shpumgdr%20gamedata/images/ships/shputwju%20gamedata/images/ships/shpvuxin%20gamedata/images/ships/shpyehte%20gamedata/images/ships/shpzeksh%20gamedata/images/ships/shpzfpst%20gamedata/music%20gamedata/music/ditty%20gamedata/ships%20gamedata/sound%20gamedata/sound/ships/shpalabc%20gamedata/sound/ships/shpandgu%20gamedata/sound/ships/shparisk%20gamedata/sound/ships/shpbahbu%20gamedata/sound/ships/shpbipka%20gamedata/sound/ships/shpchebr%20gamedata/sound/ships/shpchmav%20gamedata/sound/ships/shpchoex%20gamedata/sound/ships/shpconca%20gamedata/sound/ships/shpconho%20gamedata/sound/ships/shpdragr%20gamedata/sound/ships/shpdruma%20gamedata/sound/ships/shpearc3%20gamedata/soun%21%0A%20d/ships/shpearcr%20gamedata/sound/ships/shpforsh%20gamedata/sound/%21%0A%20ships/sh&In-Reply-To=%3C200409281953.i8SJrDcT001464%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000018.html">
   <LINK REL="Next"  HREF="000020.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Tw-light-svn] r71 - in branches/multiplayer-branch: . Util Util/deditor doc gamedata gamedata/default_ini gamedata/default_ini/ships gamedata/images gamedata/images/ships/shpalabc gamedata/images/ships/shpandgu gamedata/images/ships/shparisk gamedata/images/ships/shpbahbu gamedata/images/ships/shpbipka gamedata/images/ships/shpchebr gamedata/images/ships/shpchmav gamedata/images/ships/shpchoex gamedata/images/ships/shpconca gamedata/images/ships/shpconho gamedata/images/ships/shpdragr gamedata/images/ships/shpdruma gamedata/images/ships/shpearc3 gamedata/images/ships/shpearcr gamedata/images/ships/shpforsh gamedata/images/ships/shpgarty gamedata/images/ships/shpilwav gamedata/images/ships/shpilwsp gamedata/images/ships/shpkahbo gamedata/images/ships/shpkohma gamedata/images/ships/shpkzedr gamedata/images/ships/shpmeltr gamedata/images/ships/shpmmrxf gamedata/images/ships/shpmycpo gamedata/images/ships/shporzne gamedata/images/ships/shppkufu gamedata/images/ships/shprogsq gamedata! /images/ships/shpshosc gamedata/images/ships/shpslypr gamedata/images/ships/shpspael gamedata/images/ships/shpstaba gamedata/images/ships/shpsupbl gamedata/images/ships/shpsyrpe gamedata/images/ships/shptauar gamedata/images/ships/shptauda gamedata/images/ships/shptausl gamedata/images/ships/shptauto gamedata/images/ships/shpthrto gamedata/images/ships/shpumgdr gamedata/images/ships/shputwju gamedata/images/ships/shpvuxin gamedata/images/ships/shpyehte gamedata/images/ships/shpzeksh gamedata/images/ships/shpzfpst gamedata/music gamedata/music/ditty gamedata/ships gamedata/sound gamedata/sound/ships/shpalabc gamedata/sound/ships/shpandgu gamedata/sound/ships/shparisk gamedata/sound/ships/shpbahbu gamedata/sound/ships/shpbipka gamedata/sound/ships/shpchebr gamedata/sound/ships/shpchmav gamedata/sound/ships/shpchoex gamedata/sound/ships/shpconca gamedata/sound/ships/shpconho gamedata/sound/ships/shpdragr gamedata/sound/ships/shpdruma gamedata/sound/ships/shpearc3 gamedata/soun! d/ships/shpearcr gamedata/sound/ships/shpforsh gamedata/sound/! ships/sh</H1>
    <B>Paul Forest at BerliOS</B> 
    <A HREF="mailto:tw-light-svn%40lists.berlios.de?Subject=Re%3A%20%5BTw-light-svn%5D%20r71%20-%20in%20branches/multiplayer-branch%3A%20.%20Util%20Util/deditor%20doc%20gamedata%20gamedata/default_ini%20gamedata/default_ini/ships%20gamedata/images%20gamedata/images/ships/shpalabc%20gamedata/images/ships/shpandgu%20gamedata/images/ships/shparisk%20gamedata/images/ships/shpbahbu%20gamedata/images/ships/shpbipka%20gamedata/images/ships/shpchebr%20gamedata/images/ships/shpchmav%20gamedata/images/ships/shpchoex%20gamedata/images/ships/shpconca%20gamedata/images/ships/shpconho%20gamedata/images/ships/shpdragr%20gamedata/images/ships/shpdruma%20gamedata/images/ships/shpearc3%20gamedata/images/ships/shpearcr%20gamedata/images/ships/shpforsh%20gamedata/images/ships/shpgarty%20gamedata/images/ships/shpilwav%20gamedata/images/ships/shpilwsp%20gamedata/images/ships/shpkahbo%20gamedata/images/ships/shpkohma%20gamedata/images/ships/shpkzedr%20gamedata/images/ships/shpmeltr%20gamedata/images/ships/shpmmrxf%20gamedata/images/ships/shpmycpo%20gamedata/images/ships/shporzne%20gamedata/images/ships/shppkufu%20gamedata/images/ships/shprogsq%20gamedata%21%0A%20/images/ships/shpshosc%20gamedata/images/ships/shpslypr%20gamedata/images/ships/shpspael%20gamedata/images/ships/shpstaba%20gamedata/images/ships/shpsupbl%20gamedata/images/ships/shpsyrpe%20gamedata/images/ships/shptauar%20gamedata/images/ships/shptauda%20gamedata/images/ships/shptausl%20gamedata/images/ships/shptauto%20gamedata/images/ships/shpthrto%20gamedata/images/ships/shpumgdr%20gamedata/images/ships/shputwju%20gamedata/images/ships/shpvuxin%20gamedata/images/ships/shpyehte%20gamedata/images/ships/shpzeksh%20gamedata/images/ships/shpzfpst%20gamedata/music%20gamedata/music/ditty%20gamedata/ships%20gamedata/sound%20gamedata/sound/ships/shpalabc%20gamedata/sound/ships/shpandgu%20gamedata/sound/ships/shparisk%20gamedata/sound/ships/shpbahbu%20gamedata/sound/ships/shpbipka%20gamedata/sound/ships/shpchebr%20gamedata/sound/ships/shpchmav%20gamedata/sound/ships/shpchoex%20gamedata/sound/ships/shpconca%20gamedata/sound/ships/shpconho%20gamedata/sound/ships/shpdragr%20gamedata/sound/ships/shpdruma%20gamedata/sound/ships/shpearc3%20gamedata/soun%21%0A%20d/ships/shpearcr%20gamedata/sound/ships/shpforsh%20gamedata/sound/%21%0A%20ships/sh&In-Reply-To=%3C200409281953.i8SJrDcT001464%40sheep.berlios.de%3E"
       TITLE="[Tw-light-svn] r71 - in branches/multiplayer-branch: . Util Util/deditor doc gamedata gamedata/default_ini gamedata/default_ini/ships gamedata/images gamedata/images/ships/shpalabc gamedata/images/ships/shpandgu gamedata/images/ships/shparisk gamedata/images/ships/shpbahbu gamedata/images/ships/shpbipka gamedata/images/ships/shpchebr gamedata/images/ships/shpchmav gamedata/images/ships/shpchoex gamedata/images/ships/shpconca gamedata/images/ships/shpconho gamedata/images/ships/shpdragr gamedata/images/ships/shpdruma gamedata/images/ships/shpearc3 gamedata/images/ships/shpearcr gamedata/images/ships/shpforsh gamedata/images/ships/shpgarty gamedata/images/ships/shpilwav gamedata/images/ships/shpilwsp gamedata/images/ships/shpkahbo gamedata/images/ships/shpkohma gamedata/images/ships/shpkzedr gamedata/images/ships/shpmeltr gamedata/images/ships/shpmmrxf gamedata/images/ships/shpmycpo gamedata/images/ships/shporzne gamedata/images/ships/shppkufu gamedata/images/ships/shprogsq gamedata! /images/ships/shpshosc gamedata/images/ships/shpslypr gamedata/images/ships/shpspael gamedata/images/ships/shpstaba gamedata/images/ships/shpsupbl gamedata/images/ships/shpsyrpe gamedata/images/ships/shptauar gamedata/images/ships/shptauda gamedata/images/ships/shptausl gamedata/images/ships/shptauto gamedata/images/ships/shpthrto gamedata/images/ships/shpumgdr gamedata/images/ships/shputwju gamedata/images/ships/shpvuxin gamedata/images/ships/shpyehte gamedata/images/ships/shpzeksh gamedata/images/ships/shpzfpst gamedata/music gamedata/music/ditty gamedata/ships gamedata/sound gamedata/sound/ships/shpalabc gamedata/sound/ships/shpandgu gamedata/sound/ships/shparisk gamedata/sound/ships/shpbahbu gamedata/sound/ships/shpbipka gamedata/sound/ships/shpchebr gamedata/sound/ships/shpchmav gamedata/sound/ships/shpchoex gamedata/sound/ships/shpconca gamedata/sound/ships/shpconho gamedata/sound/ships/shpdragr gamedata/sound/ships/shpdruma gamedata/sound/ships/shpearc3 gamedata/soun! d/ships/shpearcr gamedata/sound/ships/shpforsh gamedata/sound/! ships/sh">youbastrd at sheep.berlios.de
       </A><BR>
    <I>Tue Sep 28 21:53:13 CEST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000018.html">[Tw-light-svn] r70 - trunk/Util
</A></li>
        <LI>Next message: <A HREF="000020.html">[Tw-light-svn] r72 - in trunk: source source/libraries/raknet web
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19">[ date ]</a>
              <a href="thread.html#19">[ thread ]</a>
              <a href="subject.html#19">[ subject ]</a>
              <a href="author.html#19">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: youbastrd
Date: 2004-09-28 21:53:03 +0200 (Tue, 28 Sep 2004)
New Revision: 71

Added:
   branches/multiplayer-branch/Util/addStackTrace.pl
   branches/multiplayer-branch/Util/deditor/
   branches/multiplayer-branch/gamedata/gob.dat
   branches/multiplayer-branch/gamedata/images/bspab.jpg
   branches/multiplayer-branch/gamedata/images/ships/
   branches/multiplayer-branch/gamedata/images/stangrop.jpg
   branches/multiplayer-branch/gamedata/music/ditty/
   branches/multiplayer-branch/gamedata/ships/shpmmrxf.txt
   branches/multiplayer-branch/gamedata/ships/shpthrto.txt
   branches/multiplayer-branch/gamedata/ships/shputwju.txt
   branches/multiplayer-branch/gamedata/ships/shpvuxin.txt
   branches/multiplayer-branch/gamedata/sound/ships/
   branches/multiplayer-branch/rawgraphic/
   branches/multiplayer-branch/source/games/gdefender.cpp
   branches/multiplayer-branch/source/games/ggob.cpp
   branches/multiplayer-branch/source/games/ggob.h
   branches/multiplayer-branch/source/libraries/lua/
   branches/multiplayer-branch/source/other/gup.cpp
   branches/multiplayer-branch/source/other/gup.h
   branches/multiplayer-branch/web/3dlogo.jpg
   branches/multiplayer-branch/web/background.jpg
   branches/multiplayer-branch/web/dialog-editor-win32-62.zip
   branches/multiplayer-branch/web/downloads.html
   branches/multiplayer-branch/web/info.html
   branches/multiplayer-branch/web/links.html
   branches/multiplayer-branch/web/team.html
Removed:
   branches/multiplayer-branch/gamedata/images/logo.bmp
   branches/multiplayer-branch/gamedata/ships/shpalabc.dat
   branches/multiplayer-branch/gamedata/ships/shpandgu.dat
   branches/multiplayer-branch/gamedata/ships/shparisk.dat
   branches/multiplayer-branch/gamedata/ships/shpbahbu.dat
   branches/multiplayer-branch/gamedata/ships/shpbipka.dat
   branches/multiplayer-branch/gamedata/ships/shpchebr.dat
   branches/multiplayer-branch/gamedata/ships/shpchmav.dat
   branches/multiplayer-branch/gamedata/ships/shpchoex.dat
   branches/multiplayer-branch/gamedata/ships/shpconca.dat
   branches/multiplayer-branch/gamedata/ships/shpconho.dat
   branches/multiplayer-branch/gamedata/ships/shpdragr.dat
   branches/multiplayer-branch/gamedata/ships/shpdruma.dat
   branches/multiplayer-branch/gamedata/ships/shpearc3.dat
   branches/multiplayer-branch/gamedata/ships/shpearcr.dat
   branches/multiplayer-branch/gamedata/ships/shpforsh.dat
   branches/multiplayer-branch/gamedata/ships/shpgarty.dat
   branches/multiplayer-branch/gamedata/ships/shpilwav.dat
   branches/multiplayer-branch/gamedata/ships/shpilwsp.dat
   branches/multiplayer-branch/gamedata/ships/shpkahbo.dat
   branches/multiplayer-branch/gamedata/ships/shpkohma.dat
   branches/multiplayer-branch/gamedata/ships/shpkzedr.dat
   branches/multiplayer-branch/gamedata/ships/shpmeltr.dat
   branches/multiplayer-branch/gamedata/ships/shpmmrxf.dat
   branches/multiplayer-branch/gamedata/ships/shpmycpo.dat
   branches/multiplayer-branch/gamedata/ships/shporzne.dat
   branches/multiplayer-branch/gamedata/ships/shppkufu.dat
   branches/multiplayer-branch/gamedata/ships/shprogsq.dat
   branches/multiplayer-branch/gamedata/ships/shpshosc.dat
   branches/multiplayer-branch/gamedata/ships/shpslypr.dat
   branches/multiplayer-branch/gamedata/ships/shpspael.dat
   branches/multiplayer-branch/gamedata/ships/shpstaba.dat
   branches/multiplayer-branch/gamedata/ships/shpsupbl.dat
   branches/multiplayer-branch/gamedata/ships/shpsyrpe.dat
   branches/multiplayer-branch/gamedata/ships/shptauar.dat
   branches/multiplayer-branch/gamedata/ships/shptauda.dat
   branches/multiplayer-branch/gamedata/ships/shptausl.dat
   branches/multiplayer-branch/gamedata/ships/shptauto.dat
   branches/multiplayer-branch/gamedata/ships/shpthrto.dat
   branches/multiplayer-branch/gamedata/ships/shpumgdr.dat
   branches/multiplayer-branch/gamedata/ships/shputwju.dat
   branches/multiplayer-branch/gamedata/ships/shpvuxin.dat
   branches/multiplayer-branch/gamedata/ships/shpyehte.dat
   branches/multiplayer-branch/gamedata/ships/shpzeksh.dat
   branches/multiplayer-branch/gamedata/ships/shpzfpst.dat
   branches/multiplayer-branch/source/util/sounds.cpp
   branches/multiplayer-branch/source/util/sounds.h
   branches/multiplayer-branch/vs-files/
   branches/multiplayer-branch/vs-libs/
   branches/multiplayer-branch/web/logo.png
Modified:
   branches/multiplayer-branch/Util/deditor/book.png
   branches/multiplayer-branch/Util/deditor/dialogeditor.ncb
   branches/multiplayer-branch/Util/deditor/dialogeditor.opt
   branches/multiplayer-branch/Util/deditor/dialogeditor.suo
   branches/multiplayer-branch/Util/timewarp.nsi
   branches/multiplayer-branch/doc/Doxyfile
   branches/multiplayer-branch/gamedata/default_ini/client.ini
   branches/multiplayer-branch/gamedata/default_ini/fleets.ini
   branches/multiplayer-branch/gamedata/default_ini/scp.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpalabc.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpandgu.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shparisk.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpbahbu.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpbipka.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpchebr.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpchmav.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpchoex.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpconca.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpconho.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpdragr.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpdruma.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpearc3.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpearcr.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpforsh.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpgarty.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpilwav.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpilwsp.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpkahbo.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpkohma.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpkzedr.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpmeltr.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpmmrxf.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpmycpo.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shporzne.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shppkufu.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shprogsq.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpshosc.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpslypr.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpspael.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpstaba.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpsupbl.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpsyrpe.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shptauar.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shptauda.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shptausl.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shptauto.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpthrto.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpumgdr.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shputwju.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpvuxin.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpyehte.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpzeksh.ini
   branches/multiplayer-branch/gamedata/default_ini/ships/shpzfpst.ini
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHIP_S_000_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_A_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_B_00.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_B_01.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_B_02.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_B_03.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_B_04.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_B_05.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_B_06.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_B_07.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_B_08.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_B_09.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_C_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_D_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_D_01_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_D_02_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_D_03_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_D_04_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_D_05_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_D_06_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_D_07_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_D_08_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_D_09_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_E_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_F_00.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_F_01.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_F_02.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_F_03.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_F_04.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_F_05.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_F_06.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_F_07.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_F_08.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_F_09.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_T0_000_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_T1_000_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X2_0.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X2_1.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X2_2.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X2_3.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X3_E1.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X3_E2.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X4_E1.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X4_E2.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X5_E1.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X5_E2.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X6_E1.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X6_E2.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X7_00.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X7_01.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X7_02.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X7_03.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X7_04.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X7_05.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X7_06.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X7_07.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X7_08.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X7_09.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X7_10.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X7_11.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X8_00.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X8_01.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X8_02.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X8_03.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X8_04.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X8_05.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X8_06.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X8_07.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X8_08.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X8_09.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X8_10.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/SHOT_X8_11.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/ship_p10.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/ship_p11.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/ship_p12.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/ship_p13.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/ship_p20.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/ship_p21.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/ship_p22.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpalabc/ship_p23.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpandgu/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpandgu/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpandgu/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpandgu/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpandgu/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpandgu/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpandgu/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpandgu/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpandgu/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpandgu/SHOT_B01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpandgu/SHOT_B02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpandgu/SHOT_B03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpandgu/SHOT_B04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpandgu/SHOT_B05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpandgu/SHOT_B06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpandgu/SHOT_C01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpandgu/SHOT_EXX_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A11_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A12_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A13_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A14_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A15_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A16_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A17_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A18_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A19_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A20_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A21_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A22_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A23_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A24_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A25_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A26_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A27_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A28_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A29_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A30_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A31_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A32_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A33_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A34_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A35_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A36_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A37_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A38_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A39_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shparisk/SHOT_A40_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpbahbu/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpbahbu/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpbahbu/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpbahbu/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpbahbu/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpbahbu/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpbahbu/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpbahbu/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpbahbu/SHOT_B01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpbipka/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpbipka/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpbipka/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpbipka/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpbipka/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpbipka/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpbipka/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpbipka/SHIP_P07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpbipka/SHIP_P08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpbipka/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpbipka/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpbipka/SHOT_B01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHIP_S_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_A_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_B_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_B_01_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_B_02_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_B_03_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_B_04_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_B_05_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_B_06_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_B_07_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_B_08_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_B_09_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_B_10_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_B_11_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_B_12_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_B_13_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_B_14_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_B_15_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_B_16_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_B_17_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_B_18_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_B_19_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_C_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_D_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_D_01_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_D_02_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_D_03_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_D_04_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_D_05_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_D_06_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_D_07_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_D_08_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_D_09_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_D_10_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_D_11_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_D_12_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_D_13_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_D_14_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_D_15_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_D_16_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_D_17_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_D_18_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_D_19_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchebr/SHOT_E_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A0_00_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A0_01_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A0_02_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A0_03_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A0_04_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A0_05_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A0_06_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A0_07_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A0_08_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A0_09_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A1_00_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A1_01_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A1_02_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A1_03_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A1_04_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A1_05_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A1_06_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A1_07_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A1_08_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A1_09_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A2_00_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A2_01_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A2_02_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A2_03_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A2_04_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A2_05_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A2_06_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A2_07_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A2_08_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A2_09_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A3_00_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A3_01_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A3_02_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A3_03_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A3_04_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A3_05_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A3_06_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A3_07_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A3_08_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_A3_09_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B11_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B12_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B13_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B14_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B15_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B16_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B17_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B18_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B19_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B20_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B21_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B22_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B23_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B24_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B25_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B26_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B27_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B28_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B29_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B30_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B31_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B32_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B33_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B34_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B35_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B36_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B37_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B38_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B39_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B40_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B41_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B42_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B43_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B44_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B45_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B46_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B47_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B48_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B49_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B50_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B51_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B52_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B53_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B54_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B55_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B56_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B57_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B58_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B59_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B60_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B61_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B62_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B63_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchmav/SHOT_B64_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchoex/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchoex/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchoex/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchoex/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchoex/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchoex/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchoex/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchoex/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchoex/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchoex/SHOT_B01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchoex/SHOT_B02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchoex/SHOT_B03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchoex/SHOT_B04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchoex/SHOT_B05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchoex/SHOT_B06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchoex/SHOT_B07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchoex/SHOT_B08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchoex/SHOT_B09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchoex/SHOT_B10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpchoex/SHOT_C01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconca/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconca/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconca/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconca/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconca/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconca/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconca/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconca/SHIP_X00_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconca/SHOT_000_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconca/SHOT_001_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconca/SHOT_002_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconca/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconca/SHOT_E00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconca/SHOT_E01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconca/SHOT_E02_PCS.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconho/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconho/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconho/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconho/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconho/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconho/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconho/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconho/SHIP_P07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconho/SHIP_P08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconho/SHIP_P09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconho/SHIP_P10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconho/SHIP_P11_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconho/SHIP_P12_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconho/SHIP_P13_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconho/SHIP_P14_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconho/SHIP_P15_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconho/SHIP_P16_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconho/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconho/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpconho/SHOT_B01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpdragr/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpdragr/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpdragr/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpdragr/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpdragr/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpdragr/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpdragr/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpdragr/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpdragr/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpdragr/SHOT_B01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpdruma/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpdruma/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpdruma/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpdruma/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpdruma/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpdruma/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpdruma/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpdruma/SHIP_S00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpdruma/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpdruma/SHOT_B01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpdruma/SHOT_B02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpdruma/SHOT_B03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpdruma/SHOT_B04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpdruma/SHOT_B05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHIP_S0_00_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_01_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_02_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_03_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_04_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_05_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_06_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_07_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_08_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_09_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_10_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_11_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_12_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_13_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_14_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_15_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_16_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_17_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_18_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_19_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_20_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_21_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_22_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_23_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_24_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_25_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_26_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_27_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_28_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_29_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_30_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_31_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_A0_XX_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_B0_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_B0_01_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_B0_02_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_B0_03_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_B0_04_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_B0_05_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_B0_06_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_B0_07_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_B0_08_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_B0_09_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_B0_10_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_B0_11_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_B0_12_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_B0_13_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_B0_14_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_B0_15_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_B0_16_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_B0_17_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_B0_18_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_B0_19_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_C0_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/SHOT_D0_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/ship_p00.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/ship_p01.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/ship_p02.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/ship_p03.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/ship_p04.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/ship_p05.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearc3/ship_p06.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearcr/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearcr/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearcr/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearcr/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearcr/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearcr/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearcr/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearcr/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearcr/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearcr/SHOT_B01_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearcr/SHOT_B02_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearcr/SHOT_B03_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearcr/SHOT_B04_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearcr/SHOT_B05_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearcr/SHOT_B06_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearcr/SHOT_B07_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearcr/SHOT_B08_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearcr/SHOT_B09_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpearcr/SHOT_B10_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHIP_SS_000_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0001_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0002_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0003_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0004_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0005_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0006_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0007_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0008_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0009_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0010_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0011_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0012_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0013_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0014_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0015_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0016_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0017_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0018_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0019_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0020_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0021_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0022_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0023_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0024_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0025_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0026_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0027_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0028_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0029_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0030_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0031_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_AR_PRIMARY_0032_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_B01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_B02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_B03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_B04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_B05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_B06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_B07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_B08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_B09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_B10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0001_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0002_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0003_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0004_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0005_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0006_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0007_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0008_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0009_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0010_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0011_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0012_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0013_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0014_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0015_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0016_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0017_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0018_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0019_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0020_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0021_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0022_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0023_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0024_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0025_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0026_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0027_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0028_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0029_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0030_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0031_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_ER_PRIMARY0032_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0000_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0001_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0002_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0003_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0004_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0005_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0006_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0007_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0008_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0009_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0010_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0011_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0012_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0013_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0014_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0015_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0016_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0017_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0018_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0019_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0020_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0021_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0022_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0023_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0024_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0025_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0026_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0027_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0028_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0029_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0030_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpforsh/SHOT_FR_LIGHTNING0031_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpgarty/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpgarty/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpgarty/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpgarty/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpgarty/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpgarty/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpgarty/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpgarty/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpgarty/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpgarty/SHOT_A02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpgarty/SHOT_A03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpgarty/SHOT_B01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpgarty/SHOT_B02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpgarty/SHOT_B03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpgarty/SHOT_B04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpgarty/SHOT_B05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpgarty/SHOT_B06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpgarty/SHOT_B07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpgarty/SHOT_C01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpgarty/SHOT_C02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpgarty/SHOT_C03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpgarty/SHOT_C04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpgarty/SHOT_C05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpgarty/SHOT_C06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpgarty/SHOT_C07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpgarty/SHOT_D01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A11_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A12_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A13_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A14_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A15_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A16_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A17_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A18_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A19_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A20_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A21_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A22_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A23_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A24_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A25_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A26_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A27_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A28_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A29_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A30_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A31_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A32_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A33_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A34_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A35_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A36_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A37_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A38_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A39_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A40_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A41_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A42_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A43_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A44_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A45_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A46_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A47_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A48_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A49_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwav/SHOT_A50_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_A02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_A03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_A04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_A05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_A06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_A07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_A08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_A09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_A10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B11_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B12_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B13_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B14_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B15_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B16_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B17_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B18_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B19_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B20_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B21_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B22_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B23_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B24_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B25_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B26_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B27_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B28_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B29_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B30_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B31_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_B32_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_C01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_C02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_C03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_C04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_C05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_C06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_C07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_C08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_C09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_C10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_C11_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_C12_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_C13_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_C14_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_C15_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_C16_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_C17_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_C18_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_C19_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpilwsp/SHOT_C20_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkahbo/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkahbo/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkahbo/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkahbo/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkahbo/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkahbo/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkahbo/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkahbo/SHIP_P07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkahbo/SHIP_P08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkahbo/SHIP_P09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkahbo/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkahbo/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkahbo/SHOT_B01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkahbo/SHOT_C01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_A02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_A03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_A04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_A05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_A06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_A07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_A08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_A09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_A10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_B01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_B02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_B03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_B04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_B05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_B06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_B07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_B08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_B09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_B10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_B11_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_B12_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_B13_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_B14_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_B15_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_B16_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_B17_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_B18_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_B19_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_B20_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_C01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_C02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_C03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_C04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_C05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_C06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_C07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_C08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_C09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_C10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_C11_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_C12_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_C13_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_C14_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_C15_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_C16_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_C17_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_C18_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_C19_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkohma/SHOT_C20_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHOT_B01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHOT_B02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHOT_B03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHOT_B04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHOT_B05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHOT_B06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHOT_B07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHOT_B08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHOT_B09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHOT_B10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHOT_B11_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHOT_B12_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHOT_B13_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHOT_B14_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHOT_B15_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHOT_B16_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHOT_B17_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHOT_B18_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHOT_B19_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHOT_B20_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpkzedr/SHOT_C01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_A02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_A03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_A04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_A05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_A06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_A07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_A08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_A09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_A10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_B01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_B02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_B03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_B04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_B05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_B06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_B07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_B08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_B09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_B10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_C01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_C02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_C03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_C04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_C05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_C06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_C07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_C08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_C09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_C10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_D01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_D02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_D03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_D04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_D05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_D06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_D07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_D08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_D09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_D10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_E01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_E02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_E03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_E04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_E05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_E06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_E07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_E08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_E09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_E10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_E11_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_E12_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_E13_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_E14_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_E15_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_E16_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_E17_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_E18_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_E19_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_E20_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_F01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_F02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_F03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_F04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_F05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_F06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_F07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_F08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_F09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_F10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_F11_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_F12_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_F13_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_F14_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_F15_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_F16_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_F17_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_F18_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_F19_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_F20_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_G01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_G02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_G03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_G04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_G05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_G06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_G07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_G08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_G09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_G10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_G11_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_G12_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_G13_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_G14_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_G15_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_G16_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_G17_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_G18_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_G19_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_G20_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_H01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_H02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_H03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_H04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_H05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_H06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_H07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_H08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_H09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_H10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_H11_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_H12_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_H13_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_H14_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_H15_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_H16_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_H17_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_H18_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_H19_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_H20_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_I01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_I02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_I03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_I04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_I05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_I06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_I07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_I08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_I09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_I10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_I11_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_I12_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_I13_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_I14_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_I15_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_I16_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_I17_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_I18_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_I19_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_I20_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_J01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_J02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_J03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_J04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_J05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_J06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_J07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_J08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_J09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_J10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_J11_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_J12_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_J13_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_J14_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_J15_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_J16_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_J17_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_J18_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_J19_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmeltr/SHOT_J20_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmmrxf/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmmrxf/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmmrxf/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmmrxf/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmmrxf/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmmrxf/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmmrxf/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmmrxf/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmmrxf/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmmrxf/SHOT_B01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A11_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A12_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A13_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A14_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A15_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A16_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A17_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A18_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A19_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A20_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A21_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A22_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A23_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A24_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A25_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A26_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A27_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A28_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A29_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A30_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A31_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A32_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A33_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A34_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A35_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A36_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A37_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A38_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A39_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A40_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A41_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A42_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A43_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A44_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A45_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A46_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A47_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A48_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A49_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A50_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A51_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A52_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A53_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A54_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A55_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A56_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A57_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A58_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A59_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A60_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A61_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A62_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A63_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_A64_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_B01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_B02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_B03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_B04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_B05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_B06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_B07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_B08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_B09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_B10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_B11_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_B12_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_B13_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_B14_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_B15_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_B16_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_B17_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_B18_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_B19_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpmycpo/SHOT_B20_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHIP_S_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHOT_B_00_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHOT_B_01_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHOT_B_02_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHOT_B_03_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHOT_B_04_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHOT_B_05_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHOT_B_06_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHOT_B_07_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHOT_B_08_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHOT_B_09_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHOT_C01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHOT_C02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHOT_D_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHOT_E_00_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHOT_E_01_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHOT_E_02_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHOT_E_03_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHOT_E_04_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHOT_E_05_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHOT_E_06_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHOT_E_07_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHOT_E_08_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shporzne/SHOT_E_09_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shppkufu/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shppkufu/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shppkufu/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shppkufu/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shppkufu/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shppkufu/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shppkufu/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shppkufu/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shppkufu/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shppkufu/SHOT_A02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shppkufu/SHOT_A03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shppkufu/SHOT_A04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shppkufu/SHOT_A05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shppkufu/SHOT_A06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shppkufu/SHOT_A07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shppkufu/SHOT_A08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shppkufu/SHOT_A09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shppkufu/SHOT_A10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shprogsq/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shprogsq/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shprogsq/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shprogsq/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shprogsq/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shprogsq/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shprogsq/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shprogsq/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shprogsq/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHIP_P07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B11_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B12_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B13_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B14_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B15_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B16_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B17_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B18_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B19_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B20_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B21_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B22_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B23_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B24_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B25_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B26_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B27_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B28_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B29_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpshosc/SHOT_B30_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S11_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S12_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S13_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S14_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S15_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S16_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S17_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S18_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S19_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S20_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S21_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S22_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S23_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S24_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S25_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S26_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S27_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S28_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S29_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S30_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S31_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S32_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S33_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S34_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S35_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S36_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S37_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S38_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S39_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S40_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S41_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S42_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S43_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S44_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S45_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S46_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S47_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S48_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S49_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S50_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S51_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S52_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S53_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S54_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S55_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S56_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S57_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S58_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S59_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S60_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S61_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S62_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S63_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_S64_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpslypr/SHIP_W01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpspael/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpspael/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpspael/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpspael/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpspael/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpspael/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpspael/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpspael/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpspael/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpspael/SHOT_B01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpstaba/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpstaba/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpstaba/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpstaba/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpstaba/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpstaba/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpstaba/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpstaba/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpstaba/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsupbl/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsupbl/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsupbl/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsupbl/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsupbl/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsupbl/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsupbl/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsupbl/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsupbl/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsupbl/SHOT_B01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsupbl/SHOT_B02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsupbl/SHOT_B03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsupbl/SHOT_B04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsupbl/SHOT_B05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsupbl/SHOT_B06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsupbl/SHOT_B07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsupbl/SHOT_B08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsupbl/SHOT_B09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsupbl/SHOT_B10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsyrpe/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsyrpe/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsyrpe/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsyrpe/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsyrpe/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsyrpe/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsyrpe/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsyrpe/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsyrpe/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpsyrpe/SHOT_B01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHIP_S0_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A0_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A0_01_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A0_02_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A0_03_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A0_04_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A0_05_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A0_06_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A0_07_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A0_08_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A0_09_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A0_10_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A0_11_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A0_12_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A0_13_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A0_14_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A0_15_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A0_16_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A0_17_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A0_18_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A0_19_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A1_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A1_01_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A1_02_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A1_03_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A1_04_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A1_05_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A1_06_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A1_07_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A1_08_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A1_09_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A1_10_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A1_11_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A1_12_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A1_13_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A1_14_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A1_15_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A1_16_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A1_17_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A1_18_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A1_19_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A2_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A2_01_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A2_02_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A2_03_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A2_04_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A2_05_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A2_06_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A2_07_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A2_08_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A2_09_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A2_10_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A2_11_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A2_12_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A2_13_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A2_14_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A2_15_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A2_16_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A2_17_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A2_18_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A2_19_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A3_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A3_01_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A3_02_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A3_03_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A3_04_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A3_05_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A3_06_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A3_07_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A3_08_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A3_09_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A3_10_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A3_11_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A3_12_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A3_13_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A3_14_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A3_15_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A3_16_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A3_17_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A3_18_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_A3_19_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_AX_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_B_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_B_01_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_B_02_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_B_03_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_B_04_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_B_05_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_B_06_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_B_07_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_B_08_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_B_09_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_C01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_C02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_C03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_C04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_C05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_C06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_C07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_C08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_C09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_C10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_C11_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_C12_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_F_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_F_01_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_F_02_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_F_03_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_F_04_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_F_05_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_F_06_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_F_07_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_F_08_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_F_09_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_F_10_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_F_11_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_F_12_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_F_13_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_F_14_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_F_15_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_F_16_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_F_17_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_F_18_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_F_19_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauar/SHOT_X0_00_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHIP_S_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_B_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_C0_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_C1_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_D_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_D_01_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_D_02_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_D_03_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_D_04_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_D_05_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_D_06_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_D_07_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_D_08_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_D_09_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_D_10_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_D_11_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_D_12_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_D_13_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_D_14_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_D_15_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_D_16_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_D_17_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_D_18_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_D_19_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_E_00_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_E_01_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_E_02_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_E_03_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_E_04_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_E_05_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_E_06_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_E_07_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_E_08_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauda/SHOT_E_09_TGA.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptausl/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptausl/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptausl/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptausl/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptausl/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptausl/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptausl/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptausl/SHIP_S00_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHIP_S00_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_A00_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_A01_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_A02_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_A03_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_A04_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_A05_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_B00_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_B01_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_B02_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_B03_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_B04_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_B05_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_B06_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_B07_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_B08_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_B09_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_B10_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_B11_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_C00_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_C01_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_C02_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_C03_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_C04_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_C05_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_D00_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_D01_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_D02_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_D03_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_D04_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_D05_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_D06_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_D07_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_D08_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_D09_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_D10_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_D11_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_E0000_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_E0001_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_E0002_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_E0003_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_E0004_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_E0005_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_E0006_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_E0007_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_E0008_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_E0009_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_E0010_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_E0011_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shptauto/SHOT_F00_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B11_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B12_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B13_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B14_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B15_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B16_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B17_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B18_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B19_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B20_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B21_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B22_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B23_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B24_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B25_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B26_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B27_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B28_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B29_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B30_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B31_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B32_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B33_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B34_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B35_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B36_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B37_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B38_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B39_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpthrto/SHOT_B40_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpumgdr/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpumgdr/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpumgdr/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpumgdr/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpumgdr/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpumgdr/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpumgdr/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpumgdr/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpumgdr/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpumgdr/SHOT_A02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpumgdr/SHOT_A03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpumgdr/SHOT_A04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpumgdr/SHOT_A05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpumgdr/SHOT_A06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shputwju/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shputwju/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shputwju/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shputwju/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shputwju/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shputwju/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shputwju/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shputwju/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shputwju/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpvuxin/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpvuxin/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpvuxin/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpvuxin/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpvuxin/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpvuxin/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpvuxin/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpvuxin/SHIP_S00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpvuxin/SHOT_000_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpvuxin/SHOT_001_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpvuxin/SHOT_002_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpvuxin/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpvuxin/SHOT_A02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpvuxin/SHOT_A03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpvuxin/SHOT_A04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpvuxin/SHOT_A05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpvuxin/SHOT_A06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpvuxin/SHOT_A07_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpvuxin/SHOT_A08_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpvuxin/SHOT_A09_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpvuxin/SHOT_A10_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpvuxin/SHOT_A11_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpvuxin/SHOT_E00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpvuxin/SHOT_E01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpvuxin/SHOT_E02_PCS.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpyehte/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpyehte/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpyehte/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpyehte/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpyehte/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpyehte/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpyehte/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpyehte/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpyehte/SHOT_A00_BMP.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpyehte/SHOT_B01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzeksh/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzeksh/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzeksh/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzeksh/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzeksh/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzeksh/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzeksh/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzeksh/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzeksh/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzeksh/SHOT_A02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzeksh/SHOT_A03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzeksh/SHOT_A04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzeksh/SHOT_A05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzeksh/SHOT_B01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzeksh/SHOT_B02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzeksh/SHOT_B03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzeksh/SHOT_B04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzeksh/SHOT_B05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzeksh/SHOT_B06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzfpst/SHIP_P00_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzfpst/SHIP_P01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzfpst/SHIP_P02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzfpst/SHIP_P03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzfpst/SHIP_P04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzfpst/SHIP_P05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzfpst/SHIP_P06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzfpst/SHIP_S01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzfpst/SHOT_A01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzfpst/SHOT_A02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzfpst/SHOT_A03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzfpst/SHOT_A04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzfpst/SHOT_A05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzfpst/SHOT_A06_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzfpst/SHOT_B01_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzfpst/SHOT_B02_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzfpst/SHOT_B03_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzfpst/SHOT_B04_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzfpst/SHOT_B05_PCX.bmp
   branches/multiplayer-branch/gamedata/images/ships/shpzfpst/SHOT_B06_PCX.bmp
   branches/multiplayer-branch/gamedata/ingame.txt
   branches/multiplayer-branch/gamedata/music/ditty/aladitty.xm
   branches/multiplayer-branch/gamedata/music/ditty/andditty.mod
   branches/multiplayer-branch/gamedata/music/ditty/ariditty.mod
   branches/multiplayer-branch/gamedata/music/ditty/bladitty.mod
   branches/multiplayer-branch/gamedata/music/ditty/cheditty.mod
   branches/multiplayer-branch/gamedata/music/ditty/chmditty.mod
   branches/multiplayer-branch/gamedata/music/ditty/druditty.mod
   branches/multiplayer-branch/gamedata/music/ditty/forditty.s3m
   branches/multiplayer-branch/gamedata/music/ditty/humditty.mod
   branches/multiplayer-branch/gamedata/music/ditty/ilwditty.mod
   branches/multiplayer-branch/gamedata/music/ditty/melditty.mod
   branches/multiplayer-branch/gamedata/music/ditty/mmrditty.mod
   branches/multiplayer-branch/gamedata/music/ditty/mycditty.mod
   branches/multiplayer-branch/gamedata/music/ditty/orzditty.mod
   branches/multiplayer-branch/gamedata/music/ditty/pkuditty.mod
   branches/multiplayer-branch/gamedata/music/ditty/shoditty.mod
   branches/multiplayer-branch/gamedata/music/ditty/slyditty.mod
   branches/multiplayer-branch/gamedata/music/ditty/spaditty.mod
   branches/multiplayer-branch/gamedata/music/ditty/supditty.mod
   branches/multiplayer-branch/gamedata/music/ditty/syrditty.mod
   branches/multiplayer-branch/gamedata/music/ditty/tauditty.xm
   branches/multiplayer-branch/gamedata/music/ditty/thrditty.mod
   branches/multiplayer-branch/gamedata/music/ditty/umgditty.mod
   branches/multiplayer-branch/gamedata/music/ditty/urqditty.mod
   branches/multiplayer-branch/gamedata/music/ditty/utwditty.mod
   branches/multiplayer-branch/gamedata/music/ditty/vuxditty.mod
   branches/multiplayer-branch/gamedata/music/ditty/yehditty.mod
   branches/multiplayer-branch/gamedata/music/ditty/zoqditty.mod
   branches/multiplayer-branch/gamedata/readme.html
   branches/multiplayer-branch/gamedata/ships/COPYING.txt
   branches/multiplayer-branch/gamedata/ships/shpalabc.txt
   branches/multiplayer-branch/gamedata/ships/shpandgu.txt
   branches/multiplayer-branch/gamedata/ships/shparisk.txt
   branches/multiplayer-branch/gamedata/ships/shpbipka.txt
   branches/multiplayer-branch/gamedata/ships/shpchebr.txt
   branches/multiplayer-branch/gamedata/ships/shpchmav.txt
   branches/multiplayer-branch/gamedata/ships/shpchoex.txt
   branches/multiplayer-branch/gamedata/ships/shpconca.txt
   branches/multiplayer-branch/gamedata/ships/shpconho.txt
   branches/multiplayer-branch/gamedata/ships/shpdruma.txt
   branches/multiplayer-branch/gamedata/ships/shpearc3.txt
   branches/multiplayer-branch/gamedata/ships/shpearcr.txt
   branches/multiplayer-branch/gamedata/ships/shpforsh.txt
   branches/multiplayer-branch/gamedata/ships/shpgarty.txt
   branches/multiplayer-branch/gamedata/ships/shpilwav.txt
   branches/multiplayer-branch/gamedata/ships/shpilwsp.txt
   branches/multiplayer-branch/gamedata/ships/shpkahbo.txt
   branches/multiplayer-branch/gamedata/ships/shpkohma.txt
   branches/multiplayer-branch/gamedata/ships/shpkzedr.txt
   branches/multiplayer-branch/gamedata/ships/shpmeltr.txt
   branches/multiplayer-branch/gamedata/ships/shpmycpo.txt
   branches/multiplayer-branch/gamedata/ships/shporzne.txt
   branches/multiplayer-branch/gamedata/ships/shprogsq.txt
   branches/multiplayer-branch/gamedata/ships/shpspael.txt
   branches/multiplayer-branch/gamedata/ships/shpsupbl.txt
   branches/multiplayer-branch/gamedata/ships/shpyehte.txt
   branches/multiplayer-branch/gamedata/ships/shpzfpst.txt
   branches/multiplayer-branch/gamedata/sound/ships/shpalabc/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpalabc/WAVE_A02_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpalabc/WAVE_A03_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpalabc/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpalabc/WAVE_B02_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpalabc/WAVE_C01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpalabc/WAVE_C02_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpandgu/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpandgu/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shparisk/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shparisk/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpbahbu/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpbahbu/WAVE_A02_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpbahbu/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpbipka/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpbipka/WAVE_A02_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpbipka/WAVE_A03_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpbipka/WAVE_A04_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpbipka/WAVE_A05_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpbipka/WAVE_A06_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpbipka/WAVE_A07_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpbipka/WAVE_A08_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpbipka/WAVE_A09_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpbipka/WAVE_A10_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpbipka/WAVE_A11_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpbipka/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpchebr/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpchebr/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpchebr/WAVE_C01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpchebr/WAVE_C02_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpchebr/WAVE_C03_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpchmav/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpchmav/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpchmav/WAVE_C01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpchoex/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpchoex/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpchoex/WAVE_C01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpchoex/WAVE_C02_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpconca/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpconca/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpconca/WAVE_B02_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpconho/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpconho/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpdragr/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpdragr/WAVE_A02_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpdragr/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpdruma/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpdruma/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpearc3/WAVE_A00_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpearc3/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpearc3/WAVE_B00_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpearc3/WAVE_C00_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpearcr/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpearcr/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpforsh/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpforsh/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpforsh/WAVE_B02_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpforsh/WAVE_B03_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpgarty/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpgarty/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpgarty/WAVE_C01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpgarty/WAVE_C02_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpgarty/WAVE_C03_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpilwav/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpilwav/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpilwav/WAVE_B02_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpilwsp/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpilwsp/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpilwsp/WAVE_C01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpkahbo/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpkahbo/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpkohma/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpkohma/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpkzedr/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpkzedr/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpkzedr/WAVE_C01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpkzedr/WAVE_C02_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpmeltr/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpmeltr/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpmmrxf/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpmmrxf/WAVE_A02_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpmmrxf/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpmycpo/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpmycpo/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shporzne/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shporzne/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shporzne/WAVE_C01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shporzne/WAVE_C02_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shporzne/WAVE_C03_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shppkufu/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shppkufu/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shppkufu/WAVE_B02_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shppkufu/WAVE_B03_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shppkufu/WAVE_B04_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shppkufu/WAVE_B05_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shppkufu/WAVE_B06_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shppkufu/WAVE_B07_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shppkufu/WAVE_B08_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shppkufu/WAVE_B09_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shppkufu/WAVE_B10_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shppkufu/WAVE_B11_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shppkufu/WAVE_B12_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shppkufu/WAVE_B13_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shppkufu/WAVE_B14_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shppkufu/WAVE_C01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shprogsq/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shprogsq/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpshosc/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpshosc/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpslypr/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpslypr/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpspael/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpspael/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpstaba/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpstaba/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpsupbl/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpsyrpe/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpsyrpe/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpsyrpe/WAVE_C01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shptauar/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shptauar/WAVE_A02_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shptauar/WAVE_A03_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shptauar/WAVE_A04_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shptauar/WAVE_A05_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shptauar/WAVE_A06_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shptauar/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shptauar/WAVE_C01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shptauar/WAVE_C02_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shptauar/WAVE_C03_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shptauar/WAVE_C04_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shptauda/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shptauda/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shptauda/WAVE_B02_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shptausl/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shptausl/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shptausl/WAVE_B02_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shptausl/WAVE_B03_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shptauto/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shptauto/WAVE_A02_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shptauto/WAVE_C01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shptauto/WAVE_C02_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpthrto/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpthrto/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpumgdr/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpumgdr/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shputwju/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shputwju/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpvuxin/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpvuxin/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpvuxin/WAVE_B02_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpyehte/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpyehte/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpzeksh/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpzeksh/WAVE_B01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpzeksh/WAVE_B02_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpzeksh/WAVE_B03_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpzfpst/WAVE_A01_WAV.wav
   branches/multiplayer-branch/gamedata/sound/ships/shpzfpst/WAVE_B01_WAV.wav
   branches/multiplayer-branch/makefile
   branches/multiplayer-branch/rawgraphic/PkunkQueen.jpg
   branches/multiplayer-branch/rawgraphic/SpathiMain.jpg
   branches/multiplayer-branch/source/ais/c_input.cpp
   branches/multiplayer-branch/source/ais/c_other.cpp
   branches/multiplayer-branch/source/ais/c_wussie.cpp
   branches/multiplayer-branch/source/doxygen.cpp
   branches/multiplayer-branch/source/frame.cpp
   branches/multiplayer-branch/source/games/gflmelee.cpp
   branches/multiplayer-branch/source/gui.cpp
   branches/multiplayer-branch/source/input.cpp
   branches/multiplayer-branch/source/melee.h
   branches/multiplayer-branch/source/melee/manim.cpp
   branches/multiplayer-branch/source/melee/mcbodies.cpp
   branches/multiplayer-branch/source/melee/mcontrol.cpp
   branches/multiplayer-branch/source/melee/mfleet.cpp
   branches/multiplayer-branch/source/melee/mframe.cpp
   branches/multiplayer-branch/source/melee/mframe.h
   branches/multiplayer-branch/source/melee/mgame.cpp
   branches/multiplayer-branch/source/melee/mgame.h
   branches/multiplayer-branch/source/melee/mhelpers.cpp
   branches/multiplayer-branch/source/melee/mitems.cpp
   branches/multiplayer-branch/source/melee/mlog.cpp
   branches/multiplayer-branch/source/melee/mmain.cpp
   branches/multiplayer-branch/source/melee/mmath.cpp
   branches/multiplayer-branch/source/melee/mnet1.cpp
   branches/multiplayer-branch/source/melee/moptions.cpp
   branches/multiplayer-branch/source/melee/mship.cpp
   branches/multiplayer-branch/source/melee/mship.h
   branches/multiplayer-branch/source/melee/mshot.cpp
   branches/multiplayer-branch/source/melee/mshot.h
   branches/multiplayer-branch/source/melee/mshpdata.cpp
   branches/multiplayer-branch/source/melee/mshppan.cpp
   branches/multiplayer-branch/source/melee/msprite.cpp
   branches/multiplayer-branch/source/melee/mtarget.cpp
   branches/multiplayer-branch/source/melee/mview.cpp
   branches/multiplayer-branch/source/other/dialogs.cpp
   branches/multiplayer-branch/source/other/dialogs.h
   branches/multiplayer-branch/source/other/nullphas.cpp
   branches/multiplayer-branch/source/other/objanim.cpp
   branches/multiplayer-branch/source/other/orbit.cpp
   branches/multiplayer-branch/source/other/planet3d.cpp
   branches/multiplayer-branch/source/other/radar.cpp
   branches/multiplayer-branch/source/other/shippart.cpp
   branches/multiplayer-branch/source/other/twconfig.cpp
   branches/multiplayer-branch/source/other/twconfig.h
   branches/multiplayer-branch/source/other/vbodies.cpp
   branches/multiplayer-branch/source/other/vtarget.cpp
   branches/multiplayer-branch/source/sc1ships/shpandgu.cpp
   branches/multiplayer-branch/source/sc1ships/shparisk.cpp
   branches/multiplayer-branch/source/sc1ships/shpchebr.cpp
   branches/multiplayer-branch/source/sc1ships/shpearcr.cpp
   branches/multiplayer-branch/source/sc1ships/shpilwav.cpp
   branches/multiplayer-branch/source/sc1ships/shpkzedr.cpp
   branches/multiplayer-branch/source/sc1ships/shpmmrxf.cpp
   branches/multiplayer-branch/source/sc1ships/shpmycpo.cpp
   branches/multiplayer-branch/source/sc1ships/shpshosc.cpp
   branches/multiplayer-branch/source/sc1ships/shpspael.cpp
   branches/multiplayer-branch/source/sc1ships/shpsyrpe.cpp
   branches/multiplayer-branch/source/sc1ships/shpumgdr.cpp
   branches/multiplayer-branch/source/sc1ships/shpvuxin.cpp
   branches/multiplayer-branch/source/sc1ships/shpyehte.cpp
   branches/multiplayer-branch/source/sc2ships/shpchmav.cpp
   branches/multiplayer-branch/source/sc2ships/shpdruma.cpp
   branches/multiplayer-branch/source/sc2ships/shpkohma.cpp
   branches/multiplayer-branch/source/sc2ships/shpmeltr.cpp
   branches/multiplayer-branch/source/sc2ships/shporzne.cpp
   branches/multiplayer-branch/source/sc2ships/shppkufu.cpp
   branches/multiplayer-branch/source/sc2ships/shpslypr.cpp
   branches/multiplayer-branch/source/sc2ships/shpsupbl.cpp
   branches/multiplayer-branch/source/sc2ships/shpthrto.cpp
   branches/multiplayer-branch/source/sc2ships/shputwju.cpp
   branches/multiplayer-branch/source/sc2ships/shpzfpst.cpp
   branches/multiplayer-branch/source/scp.cpp
   branches/multiplayer-branch/source/scp.h
   branches/multiplayer-branch/source/ship.h
   branches/multiplayer-branch/source/ships/shpaktgu.cpp
   branches/multiplayer-branch/source/ships/shpalabc.cpp
   branches/multiplayer-branch/source/ships/shpbahbu.cpp
   branches/multiplayer-branch/source/ships/shpbipka.cpp
   branches/multiplayer-branch/source/ships/shpbogce.cpp
   branches/multiplayer-branch/source/ships/shpchoex.cpp
   branches/multiplayer-branch/source/ships/shpconca.cpp
   branches/multiplayer-branch/source/ships/shpconho.cpp
   branches/multiplayer-branch/source/ships/shpdragr.cpp
   branches/multiplayer-branch/source/ships/shpearc3.cpp
   branches/multiplayer-branch/source/ships/shpforsh.cpp
   branches/multiplayer-branch/source/ships/shpgarty.cpp
   branches/multiplayer-branch/source/ships/shpilwsp.cpp
   branches/multiplayer-branch/source/ships/shpkahbo.cpp
   branches/multiplayer-branch/source/ships/shprogsq.cpp
   branches/multiplayer-branch/source/ships/shpstaba.cpp
   branches/multiplayer-branch/source/ships/shptauar.cpp
   branches/multiplayer-branch/source/ships/shptauda.cpp
   branches/multiplayer-branch/source/ships/shptaume.cpp
   branches/multiplayer-branch/source/ships/shptausl.cpp
   branches/multiplayer-branch/source/ships/shptaust.cpp
   branches/multiplayer-branch/source/ships/shptauto.cpp
   branches/multiplayer-branch/source/ships/shpwolmi.cpp
   branches/multiplayer-branch/source/ships/shpyusra.cpp
   branches/multiplayer-branch/source/ships/shpzeksh.cpp
   branches/multiplayer-branch/source/twgui/twbutton.cpp
   branches/multiplayer-branch/source/twgui/twbuttontypes.cpp
   branches/multiplayer-branch/source/twgui/twgui.cpp
   branches/multiplayer-branch/source/twgui/twhelpers.cpp
   branches/multiplayer-branch/source/twgui/twmenuexamples.cpp
   branches/multiplayer-branch/source/twgui/twpopup.cpp
   branches/multiplayer-branch/source/twgui/twwindow.cpp
   branches/multiplayer-branch/source/twgui/utils.cpp
   branches/multiplayer-branch/source/util/aastr.c
   branches/multiplayer-branch/source/util/base.cpp
   branches/multiplayer-branch/source/util/errors.cpp
   branches/multiplayer-branch/source/util/errors.h
   branches/multiplayer-branch/source/util/history.cpp
   branches/multiplayer-branch/source/util/random.cpp
   branches/multiplayer-branch/source/util/sound.cpp
   branches/multiplayer-branch/source/util/sound.h
   branches/multiplayer-branch/source/util/vector2.cpp
   branches/multiplayer-branch/sources.lst
   branches/multiplayer-branch/web/index.html
   branches/multiplayer-branch/web/style.css
   branches/multiplayer-branch/web/update.sh
Log:
(multiplayer-branch) re-synching with latest release, 

Copied: branches/multiplayer-branch/Util/addStackTrace.pl (from rev 69, trunk/Util/addStackTrace.pl)


Property changes on: branches/multiplayer-branch/Util/addStackTrace.pl
___________________________________________________________________
Name: svn:executable
   + *

Copied: branches/multiplayer-branch/Util/deditor (from rev 69, trunk/Util/deditor)

Modified: branches/multiplayer-branch/Util/timewarp.nsi
===================================================================
--- branches/multiplayer-branch/Util/timewarp.nsi	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/Util/timewarp.nsi	2004-09-28 19:53:03 UTC (rev 71)
@@ -124,24 +124,6 @@
 
 SectionEnd
 
-Section &quot;Source&quot;
-  SetOutPath $INSTDIR
-  File &quot;..\makefile&quot;
-  File &quot;..\tw-light.rc&quot;
-  File &quot;..\tw-light.ico&quot;
-  File &quot;..\sources.lst&quot;
-  File &quot;..\install-sh&quot;
-
-  SetOutPath $INSTDIR\source
-  File /r &quot;..\source\*.*&quot;
-
-;  SetOutPath $INSTDIR\tests
-;  File /r &quot;..\tests\*.*&quot;
-  
-  SetOutPath $INSTDIR\mingw-libs
-  File /r &quot;..\mingw-libs\*.*&quot;
-
-SectionEnd
 ;--------------------------------
 
 ; Uninstaller

Modified: branches/multiplayer-branch/doc/Doxyfile
===================================================================
--- branches/multiplayer-branch/doc/Doxyfile	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/doc/Doxyfile	2004-09-28 19:53:03 UTC (rev 71)
@@ -4,7 +4,7 @@
 # General configuration options
 #---------------------------------------------------------------------------
 PROJECT_NAME           = TW-Light
-PROJECT_NUMBER         = 0.1b2
+PROJECT_NUMBER         = 0.3b69
 OUTPUT_DIRECTORY       = ./
 OUTPUT_LANGUAGE        = English
 USE_WINDOWS_ENCODING   = YES

Modified: branches/multiplayer-branch/gamedata/default_ini/client.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/client.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/client.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,69 +1,67 @@
-[System]
-AutoUnload = 0
-
-[Video]
-ScreenWidth = 800
-ScreenHeight = 600
-
-BitsPerPixel = 32
-;valid = values are 8 (ugly), 15, 16, 24 (slow), and 32
-
-FullScreen = 1
-; = 0 = windowed, 1 = fullscreen
-
-;This = will select the theme by its string name. The names for the non-bitmap
-;themes = are: &quot;GTK&quot;, &quot;Win95&quot;, &quot;Photon&quot;, &quot;BeOS&quot;, &quot;NeXTStep&quot;, &quot;ASE&quot;, &quot;Allegro&quot;.
-GuiTheme = Photon
-
-Gamma = 45
-;gamma = gamma correction, should be between 0 and 255
-
-
-
-[Sound]
-SoundOn = 2
-MusicOn = 2
-SoundVolume = 140
-MusicVolume = 115
-
-
-[Planet]
-PlanetDimension = 3
-PlanetUsespec = 1
-
-[View]
-View = Enemy
-;determines = where the camera goes
-InterpolateFrames = 1
-;0 = low quality, 1 = high quality
-Mip_min = 0
-;from = 0 to 3?  0 = normal, 1 = low quality, 2 = very low quality, ...
-Mip_max = 10
-;from = 0 to 3?  0 = high quality, 99 = normal
-Mip_bias = 0
-;from = -3? to 3?  0 = normal, -1 = high quality, 1 = low quality, 2 = very low quality
-;(Hero, = Enemy, Enemy_Discrete, Split, Everything)
-MinimumFrameRate = 15.0
-; = determines the worst-case frameskipping (between 5 and 15 recommended)
-FPS_Time = 250
-; = milliseconds per time the FPS is updated.
-
-Key_zoomin = EQUALS
-Key_zoomout = MINUS
-Key_alter1 = 0
-Key_alter2 = 9
-
-
-[Rendering]
-AA_Mode = 35
-
-
-[Stars]
-quality = 5
-;recomended = quality settings are 1, 2, and 5
-
-
-[Menu]
-SelectGame = 0
-
-
+[System]
+AutoUnload = 0
+
+[Video]
+ScreenWidth = 800
+ScreenHeight = 600
+
+BitsPerPixel = 32
+;valid = values are 8 (ugly), 15, 16, 24 (slow), and 32
+
+FullScreen = 1
+; = 0 = windowed, 1 = fullscreen
+
+;This will select the theme by its string name. The names for the non-bitmap
+;themes are: &quot;GTK&quot;, &quot;Win95&quot;, &quot;Photon&quot;, &quot;BeOS&quot;, &quot;NeXTStep&quot;, &quot;ASE&quot;, &quot;Allegro&quot;.
+GuiTheme = Photon
+
+Gamma = 45
+;gamma = gamma correction, should be between 0 and 255
+
+
+
+[Sound]
+SoundVolume = 0.5
+MusicVolume = 0.5
+
+
+[Planet]
+PlanetDimension = 3
+PlanetUsespec = 1
+
+[View]
+View = Enemy
+;determines = where the camera goes
+InterpolateFrames = 1
+;0 = low quality, 1 = high quality
+Mip_min = 0
+;from = 0 to 3?  0 = normal, 1 = low quality, 2 = very low quality, ...
+Mip_max = 10
+;from = 0 to 3?  0 = high quality, 99 = normal
+Mip_bias = 0
+;from = -3? to 3?  0 = normal, -1 = high quality, 1 = low quality, 2 = very low quality
+;(Hero, = Enemy, Enemy_Discrete, Split, Everything)
+MinimumFrameRate = 15.0
+; = determines the worst-case frameskipping (between 5 and 15 recommended)
+FPS_Time = 250
+; = milliseconds per time the FPS is updated.
+
+Key_zoomin = EQUALS
+Key_zoomout = MINUS
+Key_alter1 = 0
+Key_alter2 = 9
+
+
+[Rendering]
+AA_Mode = 35
+
+
+[Stars]
+quality = 5
+;recomended = quality settings are 1, 2, and 5
+
+
+[Menu]
+SelectGame = 0
+
+

Modified: branches/multiplayer-branch/gamedata/default_ini/fleets.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/fleets.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/fleets.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,124 +1,75 @@
-[Player1]
-Slot0 = shosc
-Slot1 = andgu
-Slot2 = arisk
-Slot3 = bahbu
-Slot4 = bipka
-Slot5 = chebr
-Slot6 = chmav
-Slot7 = choex
-Slot8 = conca
-Slot9 = conho
-Slot10 = djila
-Slot11 = dragr
-Slot12 = druma
-Slot13 = earc2
-Slot14 = earc3
-Slot15 = earcr
-Slot16 = forsh
-Slot17 = garty
-Slot18 = hydcr
-Slot19 = ilwav
-Slot20 = ilwsp
-Slot21 = kahbo
-Slot22 = kohma
-Slot23 = kzedr
-Slot24 = meltr
-Size = 1
-MaxFleetCost = 500
-Name = Player1
-Type = Keyboard/Joystick
-Team = 1
-Channel = 12
-StartingFleetCost = 633
-StartingFleetSize = 24
-Slot25 = mmrxf
-Slot26 = mycpo
-Slot27 = orzne
-Slot28 = pkufu
-Slot29 = rekas
-Slot30 = shosc
-Slot31 = slypr
-Slot32 = spael
-Slot33 = staba
-Slot34 = supbl
-Slot35 = syrpe
-Slot36 = tauar
-Slot37 = tauda
-Slot38 = tausl
-Slot39 = tauto
-Slot40 = thrto
-Slot41 = umgdr
-Slot42 = utwju
-Slot43 = vuxin
-Slot44 = yehte
-Slot45 = zeksh
-Slot46 = zfpst
-
-[Player2]
-Slot0 = shosc
-Slot1 = andgu
-Slot2 = arisk
-Slot3 = bahbu
-Slot4 = bipka
-Slot5 = chebr
-Slot6 = chmav
-Slot7 = choex
-Slot8 = conca
-Slot9 = conho
-Slot10 = djila
-Slot11 = dragr
-Slot12 = druma
-Slot13 = earc2
-Slot14 = earc3
-Slot15 = earcr
-Slot16 = forsh
-Slot17 = garty
-Slot18 = hydcr
-Slot19 = ilwav
-Size = 1
-MaxFleetCost = 500
-Name = Player2
-Type = WussieBot
-Team = 2
-Channel = 12
-StartingFleetCost = 513
-StartingFleetSize = 22
-Slot20 = ilwsp
-Slot21 = kahbo
-Slot22 = kohma
-Slot23 = kzedr
-Slot24 = meltr
-Slot25 = mmrxf
-Slot26 = mycpo
-Slot27 = orzne
-Slot28 = pkufu
-Slot29 = rekas
-Slot30 = shosc
-Slot31 = slypr
-Slot32 = spael
-Slot33 = staba
-Slot34 = supbl
-Slot35 = syrpe
-Slot36 = tauar
-Slot37 = tauda
-Slot38 = tausl
-Slot39 = tauto
-Slot40 = thrto
-Slot41 = umgdr
-Slot42 = utwju
-Slot43 = vuxin
-Slot44 = yehte
-Slot45 = zeksh
-Slot46 = zfpst
-
-[Player3]
-Slot0 = alabc
-Slot1 = staba
-Size = 2
-MaxFleetCost = 500
-Type = WussieBot
-Team = 2
-Channel = 12
-StartingFleetCost = 513
-StartingFleetSize = 22
+[Player1]
+Slot0 = earcr
+Slot1 = thrto
+Slot2 = chebr
+Slot3 = orzne
+Slot4 = druma
+Slot5 = meltr
+Slot6 = chmav
+Slot7 = kohma
+Slot8 = utwju
+Slot9 = andgu
+Slot10 = ilwav
+Slot11 = kzedr
+Slot12 = yehte
+Slot13 = syrpe
+Slot14 = spael
+Slot15 = vuxin
+Slot16 = umgdr
+Slot17 = supbl
+Slot18 = pkufu
+Slot19 = slypr
+Slot20 = arisk
+Slot21 = zfpst
+Slot22 = mycpo
+Slot23 = mmrxf
+Slot24 = shosc
+Size = 25
+MaxFleetCost = 500
+Name = Player1
+Type = Keyboard/Joystick
+Team = 1
+Channel = 12
+StartingFleetCost = 633
+StartingFleetSize = 24
+
+[Player2]
+Slot0 = tauar
+Slot1 = tauda
+Slot2 = hydcr
+Slot3 = forsh
+Slot4 = dragr
+Slot5 = tausl
+Slot6 = tauto
+Slot7 = garty
+Slot8 = djila
+Slot9 = zeksh
+Slot10 = conca
+Slot11 = choex
+Slot12 = conho
+Slot13 = ilwsp
+Slot14 = rekas
+Slot15 = bahbu
+Slot16 = bipka
+Slot17 = earc2
+Slot18 = earc3
+Slot19 = kahbo
+Size = 20
+MaxFleetCost = 500
+Name = Player2
+Type = WussieBot
+Team = 2
+Channel = 12
+StartingFleetCost = 513
+StartingFleetSize = 22
+
+[Player3]
+Slot0 = alabc
+Slot1 = staba
+Size = 2
+MaxFleetCost = 500
+Type = WussieBot
+Team = 2
+Channel = 12
+StartingFleetCost = 513
+StartingFleetSize = 22

Modified: branches/multiplayer-branch/gamedata/default_ini/scp.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/scp.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/scp.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,188 +1,188 @@
-[Limits]
-MaxPlayers = 20
-MaxConfigurations = 4
-MaxTeams = 20
-
-
-[Config0]
-Thrust = 84
-Left = 82
-Right = 83
-Fire = 67
-AltFire = 63
-Special = 108
-Next_Target = 65
-Prev_Target = 66
-Closest_Target = 16
-Backwards = 85
-Extra1 = 0
-Extra2 = 0
-Extra3 = 0
-Extra4 = 0
-Extra5 = 0
-Extra6 = 28
-
-[Config1]
-Backwards = 19
-Thrust = 23
-Left = 1
-Right = 4
-Fire = 10
-AltFire = 14
-Special = 11
-Next_Target = 6
-Prev_Target = 7
-Closest_Target = 7
-Extra1 = 0
-Extra2 = 0
-Extra3 = 0
-Extra4 = 0
-Extra5 = 0
-Extra6 = 29
-
-
-[Config2]
-Thrust = 0
-Left = 0
-Right = 0
-Fire = 0
-AltFire = 0
-Special = 0
-Next_Target = 0
-Prev_Target = 0
-Closest_Target = 0
-
-
-[Config3]
-Thrust = 0
-Left = 0
-Right = 0
-Fire = 0
-AltFire = 0
-Special = 0
-Next_Target = 0
-Prev_Target = 0
-Closest_Target = 0
-
-
-[Player1]
-Type = Human
-Config = 0
-Team = 1
-
-
-[Player2]
-Type = Human
-Config = 1
-Team = 2
-
-
-[Player3]
-Type = none
-Config = 2
-Team = 2
-
-
-[Player4]
-Type = none
-Config = 3
-Team = 2
-
-
-[Player5]
-Type = none
-Config = 0
-Team = 2
-
-
-[Player6]
-Type = none
-Config = 1
-Team = 2
-
-
-[Player7]
-Type = none
-Config = 2
-Team = 1
-
-
-[Player8]
-Type = none
-Config = 3
-Team = 1
-
-
-[Player9]
-Type = none
-Config = 0
-Team = 0
-
-
-[Player10]
-Type = none
-Config = 0
-Team = 0
-
-
-[Player11]
-Type = none
-Config = 0
-Team = 0
-
-
-[Player12]
-Type = none
-Config = 0
-Team = 0
-
-
-[Player13]
-Type = none
-Config = 0
-Team = 0
-
-
-[Player14]
-Type = none
-Config = 1
-Team = 0
-
-
-[Player15]
-Type = none
-Config = 2
-Team = 0
-
-
-[Player16]
-Type = none
-Config = 3
-Team = 0
-
-
-[Player17]
-Type = none
-Config = 0
-Team = 0
-
-
-[Player18]
-Type = none
-Config = 1
-Team = 0
-
-
-[Player19]
-Type = none
-Config = 2
-Team = 0
-
-
-[Player20]
-Type = none
-Config = 3
-Team = 0
-
-
-
+[Limits]
+MaxPlayers = 20
+MaxConfigurations = 4
+MaxTeams = 6
+
+
+[Config0]
+Thrust = 84
+Left = 82
+Right = 83
+Fire = 67
+AltFire = 63
+Special = 106
+Next_Target = 65
+Prev_Target = 66
+Closest_Target = 16
+Backwards = 85
+Extra1 = 0
+Extra2 = 0
+Extra3 = 0
+Extra4 = 0
+Extra5 = 0
+Extra6 = 0
+
+[Config1]
+Backwards = 19
+Thrust = 23
+Left = 1
+Right = 4
+Fire = 10
+AltFire = 14
+Special = 11
+Next_Target = 6
+Prev_Target = 7
+Closest_Target = 7
+Extra1 = 0
+Extra2 = 0
+Extra3 = 0
+Extra4 = 0
+Extra5 = 0
+Extra6 = 0
+
+
+[Config2]
+Thrust = 0
+Left = 0
+Right = 0
+Fire = 0
+AltFire = 0
+Special = 0
+Next_Target = 0
+Prev_Target = 0
+Closest_Target = 0
+
+
+[Config3]
+Thrust = 0
+Left = 0
+Right = 0
+Fire = 0
+AltFire = 0
+Special = 0
+Next_Target = 0
+Prev_Target = 0
+Closest_Target = 0
+
+
+[Player1]
+Type = Human
+Config = 0
+Team = 1
+
+
+[Player2]
+Type = WussieBot
+Config = 1
+Team = 2
+
+
+[Player3]
+Type = WussieBot
+Config = 2
+Team = 2
+
+
+[Player4]
+Type = none
+Config = 3
+Team = 2
+
+
+[Player5]
+Type = none
+Config = 0
+Team = 2
+
+
+[Player6]
+Type = none
+Config = 1
+Team = 2
+
+
+[Player7]
+Type = none
+Config = 2
+Team = 1
+
+
+[Player8]
+Type = none
+Config = 3
+Team = 1
+
+
+[Player9]
+Type = none
+Config = 0
+Team = 0
+
+
+[Player10]
+Type = none
+Config = 0
+Team = 0
+
+
+[Player11]
+Type = none
+Config = 0
+Team = 0
+
+
+[Player12]
+Type = none
+Config = 0
+Team = 0
+
+
+[Player13]
+Type = none
+Config = 0
+Team = 0
+
+
+[Player14]
+Type = none
+Config = 1
+Team = 0
+
+
+[Player15]
+Type = none
+Config = 2
+Team = 0
+
+
+[Player16]
+Type = none
+Config = 3
+Team = 0
+
+
+[Player17]
+Type = none
+Config = 0
+Team = 0
+
+
+[Player18]
+Type = none
+Config = 1
+Team = 0
+
+
+[Player19]
+Type = none
+Config = 2
+Team = 0
+
+
+[Player20]
+Type = none
+Config = 3
+Team = 0
+
+
+

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpalabc.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpalabc.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpalabc.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,27 +1,28 @@
 [Info]
-TWCost  = 90
+TWCost = 90
 Name1 = Alary
 Name2 = BattleCruiser
 Origin = TWs
 Coders = Tau
 code = AlaryBC
+Version = 65M
 
 [Ship]
-Crew           = 42
-CrewMax        = 42
-Batt           = 42
-BattMax        = 42
-SpeedMax       = 20
-AccelRate      = 4
-TurnRate       = 8
+Crew = 42
+CrewMax = 42
+Batt = 42
+BattMax = 42
+SpeedMax = 20
+AccelRate = 4
+TurnRate = 8
 RechargeAmount = 1
-RechargeRate   = 2
-WeaponDrain    = 24
-WeaponRate     = 18
-SpecialDrain   = 2
-SpecialRate    = 6
-HotspotRate    = 5
-Mass           = 75
+RechargeRate = 2
+WeaponDrain = 24
+WeaponRate = 18
+SpecialDrain = 2
+SpecialRate = 6
+HotspotRate = 5
+Mass = 75
 EnginesArmour = 12
 
 [Weapon]
@@ -29,7 +30,7 @@
 Accel = 8
 TurnRate = 17
 Lifetime = 5200
-Armour   = 3
+Armour = 3
 Proximity = 15
 WarheadRange = 39.5
 WarheadVelocity = 62
@@ -87,3 +88,149 @@
 CaptName3 = Khryslth
 CaptName4 = J'kyyrf
 CaptName5 = Vyxyrm
+
+[Music]
+Victory = music/ditty/aladitty.xm
+
+[Sound]
+WeaponSample0 = sound/ships/shpalabc/WAVE_A01_WAV.wav
+WeaponSample1 = sound/ships/shpalabc/WAVE_A02_WAV.wav
+WeaponSample2 = sound/ships/shpalabc/WAVE_A03_WAV.wav
+
+SpecialSample0 = sound/ships/shpalabc/WAVE_B01_WAV.wav
+SpecialSample1 = sound/ships/shpalabc/WAVE_B02_WAV.wav
+
+ExtraSample0 = sound/ships/shpalabc/WAVE_C01_WAV.wav
+ExtraSample1 = sound/ships/shpalabc/WAVE_C02_WAV.wav
+
+
+[Objects]
+ShipSprites = 1r128
+WeaponSprites = 1r +alpha
+WeaponSamples = 3
+WeaponExplosion = 10 +alpha
+SpecialSprites = 1r +alpha
+SpecialSamples = 2
+SpecialExplosion = 10 +alpha
+ExtraSprites = 1r +alpha
+ExtraSamples = 2
+ExtraExplosion = 10 +alpha
+ExtraExtraSprites0_ = 1r128 +alpha
+ExtraExtraSprites1_ = 1r128 +alpha
+ExtraExtraSprites2_ = 4 +alpha
+ExtraExtraSprites3_ = 2 +alpha
+ExtraExtraSprites4_ = 2 +alpha
+ExtraExtraSprites5_ = 2 +alpha
+ExtraExtraSprites6_ = 2 +alpha
+ExtraExtraSprites7_ = 12 +alpha
+ExtraExtraSprites8_ = 12 +alpha
+PanelBitmaps = 15
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpalabc/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpalabc/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpalabc/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpalabc/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpalabc/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpalabc/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpalabc/SHIP_P06_PCX.bmp
+PanelBitmaps7 = images/ships/shpalabc/ship_p10.bmp
+PanelBitmaps8 = images/ships/shpalabc/ship_p11.bmp
+PanelBitmaps9 = images/ships/shpalabc/ship_p12.bmp
+PanelBitmaps10 = images/ships/shpalabc/ship_p13.bmp
+PanelBitmaps11 = images/ships/shpalabc/ship_p20.bmp
+PanelBitmaps12 = images/ships/shpalabc/ship_p21.bmp
+PanelBitmaps13 = images/ships/shpalabc/ship_p22.bmp
+PanelBitmaps14 = images/ships/shpalabc/ship_p23.bmp
+
+
+ShipSprites0 = images/ships/shpalabc/SHIP_S_000_TGA.bmp
+
+WeaponSprites0 = images/ships/shpalabc/SHOT_A_00_TGA.bmp
+
+WeaponExplosion0 = images/ships/shpalabc/SHOT_B_00.bmp
+WeaponExplosion1 = images/ships/shpalabc/SHOT_B_01.bmp
+WeaponExplosion2 = images/ships/shpalabc/SHOT_B_02.bmp
+WeaponExplosion3 = images/ships/shpalabc/SHOT_B_03.bmp
+WeaponExplosion4 = images/ships/shpalabc/SHOT_B_04.bmp
+WeaponExplosion5 = images/ships/shpalabc/SHOT_B_05.bmp
+WeaponExplosion6 = images/ships/shpalabc/SHOT_B_06.bmp
+WeaponExplosion7 = images/ships/shpalabc/SHOT_B_07.bmp
+WeaponExplosion8 = images/ships/shpalabc/SHOT_B_08.bmp
+WeaponExplosion9 = images/ships/shpalabc/SHOT_B_09.bmp
+
+
+SpecialSprites0 = images/ships/shpalabc/SHOT_C_00_TGA.bmp
+
+SpecialExplosion0 = images/ships/shpalabc/SHOT_D_00_TGA.bmp
+SpecialExplosion1 = images/ships/shpalabc/SHOT_D_01_TGA.bmp
+SpecialExplosion2 = images/ships/shpalabc/SHOT_D_02_TGA.bmp
+SpecialExplosion3 = images/ships/shpalabc/SHOT_D_03_TGA.bmp
+SpecialExplosion4 = images/ships/shpalabc/SHOT_D_04_TGA.bmp
+SpecialExplosion5 = images/ships/shpalabc/SHOT_D_05_TGA.bmp
+SpecialExplosion6 = images/ships/shpalabc/SHOT_D_06_TGA.bmp
+SpecialExplosion7 = images/ships/shpalabc/SHOT_D_07_TGA.bmp
+SpecialExplosion8 = images/ships/shpalabc/SHOT_D_08_TGA.bmp
+SpecialExplosion9 = images/ships/shpalabc/SHOT_D_09_TGA.bmp
+
+ExtraSprites0 = images/ships/shpalabc/SHOT_E_00_TGA.bmp
+
+ExtraExplosion0 = images/ships/shpalabc/SHOT_F_00.bmp
+ExtraExplosion1 = images/ships/shpalabc/SHOT_F_01.bmp
+ExtraExplosion2 = images/ships/shpalabc/SHOT_F_02.bmp
+ExtraExplosion3 = images/ships/shpalabc/SHOT_F_03.bmp
+ExtraExplosion4 = images/ships/shpalabc/SHOT_F_04.bmp
+ExtraExplosion5 = images/ships/shpalabc/SHOT_F_05.bmp
+ExtraExplosion6 = images/ships/shpalabc/SHOT_F_06.bmp
+ExtraExplosion7 = images/ships/shpalabc/SHOT_F_07.bmp
+ExtraExplosion8 = images/ships/shpalabc/SHOT_F_08.bmp
+ExtraExplosion9 = images/ships/shpalabc/SHOT_F_09.bmp
+
+
+ExtraExtraSprites0_0 = images/ships/shpalabc/SHOT_T0_000_TGA.bmp
+
+ExtraExtraSprites1_0 = images/ships/shpalabc/SHOT_T1_000_TGA.bmp
+
+ExtraExtraSprites2_0 = images/ships/shpalabc/SHOT_X2_0.bmp
+ExtraExtraSprites2_1 = images/ships/shpalabc/SHOT_X2_1.bmp
+ExtraExtraSprites2_2 = images/ships/shpalabc/SHOT_X2_2.bmp
+ExtraExtraSprites2_3 = images/ships/shpalabc/SHOT_X2_3.bmp
+
+ExtraExtraSprites3_0 = images/ships/shpalabc/SHOT_X3_E1.bmp
+ExtraExtraSprites3_1 = images/ships/shpalabc/SHOT_X3_E2.bmp
+
+ExtraExtraSprites4_0 = images/ships/shpalabc/SHOT_X4_E1.bmp
+ExtraExtraSprites4_1 = images/ships/shpalabc/SHOT_X4_E2.bmp
+
+ExtraExtraSprites5_0 = images/ships/shpalabc/SHOT_X5_E1.bmp
+ExtraExtraSprites5_1 = images/ships/shpalabc/SHOT_X5_E2.bmp
+
+ExtraExtraSprites6_0 = images/ships/shpalabc/SHOT_X6_E1.bmp
+ExtraExtraSprites6_1 = images/ships/shpalabc/SHOT_X6_E2.bmp
+
+ExtraExtraSprites7_0 = images/ships/shpalabc/SHOT_X7_00.bmp
+ExtraExtraSprites7_1 = images/ships/shpalabc/SHOT_X7_01.bmp
+ExtraExtraSprites7_2 = images/ships/shpalabc/SHOT_X7_02.bmp
+ExtraExtraSprites7_3 = images/ships/shpalabc/SHOT_X7_03.bmp
+ExtraExtraSprites7_4 = images/ships/shpalabc/SHOT_X7_04.bmp
+ExtraExtraSprites7_5 = images/ships/shpalabc/SHOT_X7_05.bmp
+ExtraExtraSprites7_6 = images/ships/shpalabc/SHOT_X7_06.bmp
+ExtraExtraSprites7_7 = images/ships/shpalabc/SHOT_X7_07.bmp
+ExtraExtraSprites7_8 = images/ships/shpalabc/SHOT_X7_08.bmp
+ExtraExtraSprites7_9 = images/ships/shpalabc/SHOT_X7_09.bmp
+ExtraExtraSprites7_10 = images/ships/shpalabc/SHOT_X7_10.bmp
+ExtraExtraSprites7_11 = images/ships/shpalabc/SHOT_X7_11.bmp
+
+ExtraExtraSprites8_0 = images/ships/shpalabc/SHOT_X8_00.bmp
+ExtraExtraSprites8_1 = images/ships/shpalabc/SHOT_X8_01.bmp
+ExtraExtraSprites8_2 = images/ships/shpalabc/SHOT_X8_02.bmp
+ExtraExtraSprites8_3 = images/ships/shpalabc/SHOT_X8_03.bmp
+ExtraExtraSprites8_4 = images/ships/shpalabc/SHOT_X8_04.bmp
+ExtraExtraSprites8_5 = images/ships/shpalabc/SHOT_X8_05.bmp
+ExtraExtraSprites8_6 = images/ships/shpalabc/SHOT_X8_06.bmp
+ExtraExtraSprites8_7 = images/ships/shpalabc/SHOT_X8_07.bmp
+ExtraExtraSprites8_8 = images/ships/shpalabc/SHOT_X8_08.bmp
+ExtraExtraSprites8_9 = images/ships/shpalabc/SHOT_X8_09.bmp
+ExtraExtraSprites8_10 = images/ships/shpalabc/SHOT_X8_10.bmp
+ExtraExtraSprites8_11 = images/ships/shpalabc/SHOT_X8_11.bmp
+

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpandgu.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpandgu.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpandgu.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -7,6 +7,7 @@
 Origin = UQM
 Code = AndrosynthGuardian
 Coders = The Fly
+Version = 65M
 
 [Ship]
 Crew = 20
@@ -77,3 +78,50 @@
 CaptName14 = NECRO-99
 CaptName15 = HAL-2001
 CaptName16 = SR-71
+
+[Music]
+Victory = music/ditty/andditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpandgu/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpandgu/WAVE_B01_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 1r11 +alpha
+WeaponSamples = 1
+WeaponExplosion = 6 +alpha
+SpecialSprites = 1r +alpha
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 1
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpandgu/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpandgu/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpandgu/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpandgu/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpandgu/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpandgu/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpandgu/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shpandgu/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shpandgu/SHOT_A01_PCX.bmp
+
+WeaponExplosion0 = images/ships/shpandgu/SHOT_B01_PCX.bmp
+WeaponExplosion1 = images/ships/shpandgu/SHOT_B02_PCX.bmp
+WeaponExplosion2 = images/ships/shpandgu/SHOT_B03_PCX.bmp
+WeaponExplosion3 = images/ships/shpandgu/SHOT_B04_PCX.bmp
+WeaponExplosion4 = images/ships/shpandgu/SHOT_B05_PCX.bmp
+WeaponExplosion5 = images/ships/shpandgu/SHOT_B06_PCX.bmp
+
+
+SpecialSprites0 = images/ships/shpandgu/SHOT_C01_PCX.bmp
+
+ExtraSprites0 = images/ships/shpandgu/SHOT_EXX_BMP.bmp

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shparisk.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shparisk.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shparisk.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -8,6 +8,7 @@
 Origin = UQM
 Coders = The Fly
 Code = ArilouSkiff
+Version = 65M
 
 [Ship]
 Crew = 6
@@ -60,3 +61,78 @@
 CaptName14 = Yipyapi
 CaptName15 = Ropilup
 CaptName16 = Wolwali
+
+[Music]
+Victory = music/ditty/ariditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shparisk/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shparisk/WAVE_B01_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 0
+WeaponSamples = 1
+WeaponExplosion = 0
+SpecialSprites = 40 +alpha
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 0
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shparisk/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shparisk/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shparisk/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shparisk/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shparisk/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shparisk/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shparisk/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shparisk/SHIP_S01_PCX.bmp
+
+SpecialSprites0 = images/ships/shparisk/SHOT_A01_PCX.bmp
+SpecialSprites1 = images/ships/shparisk/SHOT_A02_PCX.bmp
+SpecialSprites2 = images/ships/shparisk/SHOT_A03_PCX.bmp
+SpecialSprites3 = images/ships/shparisk/SHOT_A04_PCX.bmp
+SpecialSprites4 = images/ships/shparisk/SHOT_A05_PCX.bmp
+SpecialSprites5 = images/ships/shparisk/SHOT_A06_PCX.bmp
+SpecialSprites6 = images/ships/shparisk/SHOT_A07_PCX.bmp
+SpecialSprites7 = images/ships/shparisk/SHOT_A08_PCX.bmp
+SpecialSprites8 = images/ships/shparisk/SHOT_A09_PCX.bmp
+SpecialSprites9 = images/ships/shparisk/SHOT_A10_PCX.bmp
+SpecialSprites10 = images/ships/shparisk/SHOT_A11_PCX.bmp
+SpecialSprites11 = images/ships/shparisk/SHOT_A12_PCX.bmp
+SpecialSprites12 = images/ships/shparisk/SHOT_A13_PCX.bmp
+SpecialSprites13 = images/ships/shparisk/SHOT_A14_PCX.bmp
+SpecialSprites14 = images/ships/shparisk/SHOT_A15_PCX.bmp
+SpecialSprites15 = images/ships/shparisk/SHOT_A16_PCX.bmp
+SpecialSprites16 = images/ships/shparisk/SHOT_A17_PCX.bmp
+SpecialSprites17 = images/ships/shparisk/SHOT_A18_PCX.bmp
+SpecialSprites18 = images/ships/shparisk/SHOT_A19_PCX.bmp
+SpecialSprites19 = images/ships/shparisk/SHOT_A20_PCX.bmp
+SpecialSprites20 = images/ships/shparisk/SHOT_A21_PCX.bmp
+SpecialSprites21 = images/ships/shparisk/SHOT_A22_PCX.bmp
+SpecialSprites22 = images/ships/shparisk/SHOT_A23_PCX.bmp
+SpecialSprites23 = images/ships/shparisk/SHOT_A24_PCX.bmp
+SpecialSprites24 = images/ships/shparisk/SHOT_A25_PCX.bmp
+SpecialSprites25 = images/ships/shparisk/SHOT_A26_PCX.bmp
+SpecialSprites26 = images/ships/shparisk/SHOT_A27_PCX.bmp
+SpecialSprites27 = images/ships/shparisk/SHOT_A28_PCX.bmp
+SpecialSprites28 = images/ships/shparisk/SHOT_A29_PCX.bmp
+SpecialSprites29 = images/ships/shparisk/SHOT_A30_PCX.bmp
+SpecialSprites30 = images/ships/shparisk/SHOT_A31_PCX.bmp
+SpecialSprites31 = images/ships/shparisk/SHOT_A32_PCX.bmp
+SpecialSprites32 = images/ships/shparisk/SHOT_A33_PCX.bmp
+SpecialSprites33 = images/ships/shparisk/SHOT_A34_PCX.bmp
+SpecialSprites34 = images/ships/shparisk/SHOT_A35_PCX.bmp
+SpecialSprites35 = images/ships/shparisk/SHOT_A36_PCX.bmp
+SpecialSprites36 = images/ships/shparisk/SHOT_A37_PCX.bmp
+SpecialSprites37 = images/ships/shparisk/SHOT_A38_PCX.bmp
+SpecialSprites38 = images/ships/shparisk/SHOT_A39_PCX.bmp
+SpecialSprites39 = images/ships/shparisk/SHOT_A40_PCX.bmp
+

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpbahbu.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpbahbu.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpbahbu.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,44 +1,45 @@
 [Info]
 Origin = TW
-TWCost  = 20
+TWCost = 20
 Name = Bahoid Buzzsaw
 Name1 = Bahoid
 Name2 = Buzzsaw
 Coders = Reddish
 Code = BahaoidBuzzsaw
+Version = 65M
 
 [Ship]
-Crew           = 24
-CrewMax        = 24
-Batt           = 20
-BattMax        = 20
-SpeedMax       = 25
-AccelRate      = 6
-TurnRate       = 4
+Crew = 24
+CrewMax = 24
+Batt = 20
+BattMax = 20
+SpeedMax = 25
+AccelRate = 6
+TurnRate = 4
 RechargeAmount = 1
-RechargeRate   = 4
-WeaponDrain    = 0
-WeaponRate     = 0
-SpecialDrain   = 4
-SpecialRate    = 10
-HotspotRate    = 2
-Mass           = 12
+RechargeRate = 4
+WeaponDrain = 0
+WeaponRate = 0
+SpecialDrain = 4
+SpecialRate = 10
+HotspotRate = 2
+Mass = 12
 
 [Weapon]
-Range    = 2
-Damage   = 1
-Speed    = .8
-Color    = 10
+Range = 2
+Damage = 1
+Speed = .8
+Color = 10
 
 [Special]
-Range    = 20
+Range = 20
 Velocity = 10
-Damage   = 6
-Armour   = 10
-Timer    = 13000
-Radius   = 8
-Seek     = 5.5
-VelSeek  = 120
+Damage = 6
+Armour = 10
+Timer = 13000
+Radius = 8
+Seek = 5.5
+VelSeek = 120
 Number = 2
 
 [AI3_Default]
@@ -50,3 +51,38 @@
 Special3 = Back
 Special4 = Homing
 
+[Music]
+Victory = music/ditty/ariditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpbahbu/WAVE_A01_WAV.wav
+WeaponSample1 = sound/ships/shpbahbu/WAVE_A02_WAV.wav
+
+SpecialSample0 = sound/ships/shpbahbu/WAVE_B01_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 0
+WeaponSamples = 2
+WeaponExplosion = 0
+SpecialSprites = 1r
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 0
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpbahbu/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpbahbu/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpbahbu/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpbahbu/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpbahbu/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpbahbu/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpbahbu/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shpbahbu/SHIP_S01_PCX.bmp
+
+SpecialSprites0 = images/ships/shpbahbu/SHOT_B01_PCX.bmp

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpbipka.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpbipka.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpbipka.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -8,6 +8,7 @@
 Sfx = Forevian
 Ditty = Forevian
 Code = BipoleKatamaran
+Version = 65M
 
 [Ship]
 Crew = 12
@@ -48,3 +49,53 @@
 Special = Proximity
 Special_Range = 8
 Plus_Fire = Special
+
+[Music]
+Victory = music/ditty/ariditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpbipka/WAVE_A01_WAV.wav
+WeaponSample1 = sound/ships/shpbipka/WAVE_A02_WAV.wav
+WeaponSample2 = sound/ships/shpbipka/WAVE_A03_WAV.wav
+WeaponSample3 = sound/ships/shpbipka/WAVE_A04_WAV.wav
+WeaponSample4 = sound/ships/shpbipka/WAVE_A05_WAV.wav
+WeaponSample5 = sound/ships/shpbipka/WAVE_A06_WAV.wav
+WeaponSample6 = sound/ships/shpbipka/WAVE_A07_WAV.wav
+WeaponSample7 = sound/ships/shpbipka/WAVE_A08_WAV.wav
+WeaponSample8 = sound/ships/shpbipka/WAVE_A09_WAV.wav
+WeaponSample9 = sound/ships/shpbipka/WAVE_A10_WAV.wav
+WeaponSample10 = sound/ships/shpbipka/WAVE_A11_WAV.wav
+
+SpecialSample0 = sound/ships/shpbipka/WAVE_B01_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 1r
+WeaponSamples = 11
+WeaponExplosion = 0
+SpecialSprites = 1r
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 0
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 9
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpbipka/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpbipka/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpbipka/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpbipka/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpbipka/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpbipka/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpbipka/SHIP_P06_PCX.bmp
+PanelBitmaps7 = images/ships/shpbipka/SHIP_P07_PCX.bmp
+PanelBitmaps8 = images/ships/shpbipka/SHIP_P08_PCX.bmp
+
+
+ShipSprites0 = images/ships/shpbipka/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shpbipka/SHOT_A01_PCX.bmp
+
+SpecialSprites0 = images/ships/shpbipka/SHOT_B01_PCX.bmp
+

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpchebr.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpchebr.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpchebr.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -7,6 +7,7 @@
 Origin = UQM
 Coders = The Fly
 Code = ChenjesuBroodhome
+Version = 65M
 
 [Ship]
 Crew = 36
@@ -67,3 +68,89 @@
 CaptName14 = Vrroww
 CaptName15 = Zznaz
 CaptName16 = Zzzhmm
+
+[Music]
+Victory = music/ditty/cheditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpchebr/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpchebr/WAVE_B01_WAV.wav
+
+ExtraSample0 = sound/ships/shpchebr/WAVE_C01_WAV.wav
+ExtraSample1 = sound/ships/shpchebr/WAVE_C02_WAV.wav
+ExtraSample2 = sound/ships/shpchebr/WAVE_C03_WAV.wav
+
+[Objects]
+
+ShipSprites = 1r
+WeaponSprites = 1r
+WeaponSamples = 1
+WeaponExplosion = 20 +alpha
+SpecialSprites = 1r
+SpecialSamples = 1
+SpecialExplosion = 20 +alpha
+ExtraSprites = 1r
+ExtraSamples = 3
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpchebr/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpchebr/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpchebr/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpchebr/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpchebr/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpchebr/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpchebr/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shpchebr/SHIP_S_00_TGA.bmp
+
+WeaponSprites0 = images/ships/shpchebr/SHOT_A_00_TGA.bmp
+
+WeaponExplosion0 = images/ships/shpchebr/SHOT_B_00_TGA.bmp
+WeaponExplosion1 = images/ships/shpchebr/SHOT_B_01_TGA.bmp
+WeaponExplosion2 = images/ships/shpchebr/SHOT_B_02_TGA.bmp
+WeaponExplosion3 = images/ships/shpchebr/SHOT_B_03_TGA.bmp
+WeaponExplosion4 = images/ships/shpchebr/SHOT_B_04_TGA.bmp
+WeaponExplosion5 = images/ships/shpchebr/SHOT_B_05_TGA.bmp
+WeaponExplosion6 = images/ships/shpchebr/SHOT_B_06_TGA.bmp
+WeaponExplosion7 = images/ships/shpchebr/SHOT_B_07_TGA.bmp
+WeaponExplosion8 = images/ships/shpchebr/SHOT_B_08_TGA.bmp
+WeaponExplosion9 = images/ships/shpchebr/SHOT_B_09_TGA.bmp
+WeaponExplosion10 = images/ships/shpchebr/SHOT_B_10_TGA.bmp
+WeaponExplosion11 = images/ships/shpchebr/SHOT_B_11_TGA.bmp
+WeaponExplosion12 = images/ships/shpchebr/SHOT_B_12_TGA.bmp
+WeaponExplosion13 = images/ships/shpchebr/SHOT_B_13_TGA.bmp
+WeaponExplosion14 = images/ships/shpchebr/SHOT_B_14_TGA.bmp
+WeaponExplosion15 = images/ships/shpchebr/SHOT_B_15_TGA.bmp
+WeaponExplosion16 = images/ships/shpchebr/SHOT_B_16_TGA.bmp
+WeaponExplosion17 = images/ships/shpchebr/SHOT_B_17_TGA.bmp
+WeaponExplosion18 = images/ships/shpchebr/SHOT_B_18_TGA.bmp
+WeaponExplosion19 = images/ships/shpchebr/SHOT_B_19_TGA.bmp
+
+SpecialSprites0 = images/ships/shpchebr/SHOT_C_00_TGA.bmp
+
+SpecialExplosion0 = images/ships/shpchebr/SHOT_D_00_TGA.bmp
+SpecialExplosion1 = images/ships/shpchebr/SHOT_D_01_TGA.bmp
+SpecialExplosion2 = images/ships/shpchebr/SHOT_D_02_TGA.bmp
+SpecialExplosion3 = images/ships/shpchebr/SHOT_D_03_TGA.bmp
+SpecialExplosion4 = images/ships/shpchebr/SHOT_D_04_TGA.bmp
+SpecialExplosion5 = images/ships/shpchebr/SHOT_D_05_TGA.bmp
+SpecialExplosion6 = images/ships/shpchebr/SHOT_D_06_TGA.bmp
+SpecialExplosion7 = images/ships/shpchebr/SHOT_D_07_TGA.bmp
+SpecialExplosion8 = images/ships/shpchebr/SHOT_D_08_TGA.bmp
+SpecialExplosion9 = images/ships/shpchebr/SHOT_D_09_TGA.bmp
+SpecialExplosion10 = images/ships/shpchebr/SHOT_D_10_TGA.bmp
+SpecialExplosion11 = images/ships/shpchebr/SHOT_D_11_TGA.bmp
+SpecialExplosion12 = images/ships/shpchebr/SHOT_D_12_TGA.bmp
+SpecialExplosion13 = images/ships/shpchebr/SHOT_D_13_TGA.bmp
+SpecialExplosion14 = images/ships/shpchebr/SHOT_D_14_TGA.bmp
+SpecialExplosion15 = images/ships/shpchebr/SHOT_D_15_TGA.bmp
+SpecialExplosion16 = images/ships/shpchebr/SHOT_D_16_TGA.bmp
+SpecialExplosion17 = images/ships/shpchebr/SHOT_D_17_TGA.bmp
+SpecialExplosion18 = images/ships/shpchebr/SHOT_D_18_TGA.bmp
+SpecialExplosion19 = images/ships/shpchebr/SHOT_D_19_TGA.bmp
+
+ExtraSprites0 = images/ships/shpchebr/SHOT_E_00_TGA.bmp

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpchmav.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpchmav.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpchmav.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -7,6 +7,7 @@
 Origin = UQM
 Coders = The Fly
 Code = ChmmrAvatar
+Version = 65M
 
 [Ship]
 Crew = 42
@@ -62,3 +63,145 @@
 CaptName14 = Tzrtzn
 CaptName15 = Kztztz
 CaptName16 = Mrnkzt
+
+[Music]
+Victory = music/ditty/chmditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpchmav/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpchmav/WAVE_B01_WAV.wav
+
+ExtraSample0 = sound/ships/shpchmav/WAVE_C01_WAV.wav
+
+[Objects]
+
+ShipSprites = 1r
+WeaponSprites = 0
+WeaponSamples = 1
+WeaponExplosion = 40 +alpha
+SpecialSprites = 0
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 64
+ExtraSamples = 1
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpchmav/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpchmav/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpchmav/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpchmav/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpchmav/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpchmav/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpchmav/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shpchmav/SHIP_S01_PCX.bmp
+
+WeaponExplosion0 = images/ships/shpchmav/SHOT_A0_00_BMP.bmp
+WeaponExplosion1 = images/ships/shpchmav/SHOT_A0_01_BMP.bmp
+WeaponExplosion2 = images/ships/shpchmav/SHOT_A0_02_BMP.bmp
+WeaponExplosion3 = images/ships/shpchmav/SHOT_A0_03_BMP.bmp
+WeaponExplosion4 = images/ships/shpchmav/SHOT_A0_04_BMP.bmp
+WeaponExplosion5 = images/ships/shpchmav/SHOT_A0_05_BMP.bmp
+WeaponExplosion6 = images/ships/shpchmav/SHOT_A0_06_BMP.bmp
+WeaponExplosion7 = images/ships/shpchmav/SHOT_A0_07_BMP.bmp
+WeaponExplosion8 = images/ships/shpchmav/SHOT_A0_08_BMP.bmp
+WeaponExplosion9 = images/ships/shpchmav/SHOT_A0_09_BMP.bmp
+WeaponExplosion10 = images/ships/shpchmav/SHOT_A1_00_BMP.bmp
+WeaponExplosion11 = images/ships/shpchmav/SHOT_A1_01_BMP.bmp
+WeaponExplosion12 = images/ships/shpchmav/SHOT_A1_02_BMP.bmp
+WeaponExplosion13 = images/ships/shpchmav/SHOT_A1_03_BMP.bmp
+WeaponExplosion14 = images/ships/shpchmav/SHOT_A1_04_BMP.bmp
+WeaponExplosion15 = images/ships/shpchmav/SHOT_A1_05_BMP.bmp
+WeaponExplosion16 = images/ships/shpchmav/SHOT_A1_06_BMP.bmp
+WeaponExplosion17 = images/ships/shpchmav/SHOT_A1_07_BMP.bmp
+WeaponExplosion18 = images/ships/shpchmav/SHOT_A1_08_BMP.bmp
+WeaponExplosion19 = images/ships/shpchmav/SHOT_A1_09_BMP.bmp
+WeaponExplosion20 = images/ships/shpchmav/SHOT_A2_00_BMP.bmp
+WeaponExplosion21 = images/ships/shpchmav/SHOT_A2_01_BMP.bmp
+WeaponExplosion22 = images/ships/shpchmav/SHOT_A2_02_BMP.bmp
+WeaponExplosion23 = images/ships/shpchmav/SHOT_A2_03_BMP.bmp
+WeaponExplosion24 = images/ships/shpchmav/SHOT_A2_04_BMP.bmp
+WeaponExplosion25 = images/ships/shpchmav/SHOT_A2_05_BMP.bmp
+WeaponExplosion26 = images/ships/shpchmav/SHOT_A2_06_BMP.bmp
+WeaponExplosion27 = images/ships/shpchmav/SHOT_A2_07_BMP.bmp
+WeaponExplosion28 = images/ships/shpchmav/SHOT_A2_08_BMP.bmp
+WeaponExplosion29 = images/ships/shpchmav/SHOT_A2_09_BMP.bmp
+WeaponExplosion30 = images/ships/shpchmav/SHOT_A3_00_BMP.bmp
+WeaponExplosion31 = images/ships/shpchmav/SHOT_A3_01_BMP.bmp
+WeaponExplosion32 = images/ships/shpchmav/SHOT_A3_02_BMP.bmp
+WeaponExplosion33 = images/ships/shpchmav/SHOT_A3_03_BMP.bmp
+WeaponExplosion34 = images/ships/shpchmav/SHOT_A3_04_BMP.bmp
+WeaponExplosion35 = images/ships/shpchmav/SHOT_A3_05_BMP.bmp
+WeaponExplosion36 = images/ships/shpchmav/SHOT_A3_06_BMP.bmp
+WeaponExplosion37 = images/ships/shpchmav/SHOT_A3_07_BMP.bmp
+WeaponExplosion38 = images/ships/shpchmav/SHOT_A3_08_BMP.bmp
+WeaponExplosion39 = images/ships/shpchmav/SHOT_A3_09_BMP.bmp
+
+ExtraSprites0 = images/ships/shpchmav/SHOT_B01_PCX.bmp
+ExtraSprites1 = images/ships/shpchmav/SHOT_B02_PCX.bmp
+ExtraSprites2 = images/ships/shpchmav/SHOT_B03_PCX.bmp
+ExtraSprites3 = images/ships/shpchmav/SHOT_B04_PCX.bmp
+ExtraSprites4 = images/ships/shpchmav/SHOT_B05_PCX.bmp
+ExtraSprites5 = images/ships/shpchmav/SHOT_B06_PCX.bmp
+ExtraSprites6 = images/ships/shpchmav/SHOT_B07_PCX.bmp
+ExtraSprites7 = images/ships/shpchmav/SHOT_B08_PCX.bmp
+ExtraSprites8 = images/ships/shpchmav/SHOT_B09_PCX.bmp
+ExtraSprites9 = images/ships/shpchmav/SHOT_B10_PCX.bmp
+ExtraSprites10 = images/ships/shpchmav/SHOT_B11_PCX.bmp
+ExtraSprites11 = images/ships/shpchmav/SHOT_B12_PCX.bmp
+ExtraSprites12 = images/ships/shpchmav/SHOT_B13_PCX.bmp
+ExtraSprites13 = images/ships/shpchmav/SHOT_B14_PCX.bmp
+ExtraSprites14 = images/ships/shpchmav/SHOT_B15_PCX.bmp
+ExtraSprites15 = images/ships/shpchmav/SHOT_B16_PCX.bmp
+ExtraSprites16 = images/ships/shpchmav/SHOT_B17_PCX.bmp
+ExtraSprites17 = images/ships/shpchmav/SHOT_B18_PCX.bmp
+ExtraSprites18 = images/ships/shpchmav/SHOT_B19_PCX.bmp
+ExtraSprites19 = images/ships/shpchmav/SHOT_B20_PCX.bmp
+ExtraSprites20 = images/ships/shpchmav/SHOT_B21_PCX.bmp
+ExtraSprites21 = images/ships/shpchmav/SHOT_B22_PCX.bmp
+ExtraSprites22 = images/ships/shpchmav/SHOT_B23_PCX.bmp
+ExtraSprites23 = images/ships/shpchmav/SHOT_B24_PCX.bmp
+ExtraSprites24 = images/ships/shpchmav/SHOT_B25_PCX.bmp
+ExtraSprites25 = images/ships/shpchmav/SHOT_B26_PCX.bmp
+ExtraSprites26 = images/ships/shpchmav/SHOT_B27_PCX.bmp
+ExtraSprites27 = images/ships/shpchmav/SHOT_B28_PCX.bmp
+ExtraSprites28 = images/ships/shpchmav/SHOT_B29_PCX.bmp
+ExtraSprites29 = images/ships/shpchmav/SHOT_B30_PCX.bmp
+ExtraSprites30 = images/ships/shpchmav/SHOT_B31_PCX.bmp
+ExtraSprites31 = images/ships/shpchmav/SHOT_B32_PCX.bmp
+ExtraSprites32 = images/ships/shpchmav/SHOT_B33_PCX.bmp
+ExtraSprites33 = images/ships/shpchmav/SHOT_B34_PCX.bmp
+ExtraSprites34 = images/ships/shpchmav/SHOT_B35_PCX.bmp
+ExtraSprites35 = images/ships/shpchmav/SHOT_B36_PCX.bmp
+ExtraSprites36 = images/ships/shpchmav/SHOT_B37_PCX.bmp
+ExtraSprites37 = images/ships/shpchmav/SHOT_B38_PCX.bmp
+ExtraSprites38 = images/ships/shpchmav/SHOT_B39_PCX.bmp
+ExtraSprites39 = images/ships/shpchmav/SHOT_B40_PCX.bmp
+ExtraSprites40 = images/ships/shpchmav/SHOT_B41_PCX.bmp
+ExtraSprites41 = images/ships/shpchmav/SHOT_B42_PCX.bmp
+ExtraSprites42 = images/ships/shpchmav/SHOT_B43_PCX.bmp
+ExtraSprites43 = images/ships/shpchmav/SHOT_B44_PCX.bmp
+ExtraSprites44 = images/ships/shpchmav/SHOT_B45_PCX.bmp
+ExtraSprites45 = images/ships/shpchmav/SHOT_B46_PCX.bmp
+ExtraSprites46 = images/ships/shpchmav/SHOT_B47_PCX.bmp
+ExtraSprites47 = images/ships/shpchmav/SHOT_B48_PCX.bmp
+ExtraSprites48 = images/ships/shpchmav/SHOT_B49_PCX.bmp
+ExtraSprites49 = images/ships/shpchmav/SHOT_B50_PCX.bmp
+ExtraSprites50 = images/ships/shpchmav/SHOT_B51_PCX.bmp
+ExtraSprites51 = images/ships/shpchmav/SHOT_B52_PCX.bmp
+ExtraSprites52 = images/ships/shpchmav/SHOT_B53_PCX.bmp
+ExtraSprites53 = images/ships/shpchmav/SHOT_B54_PCX.bmp
+ExtraSprites54 = images/ships/shpchmav/SHOT_B55_PCX.bmp
+ExtraSprites55 = images/ships/shpchmav/SHOT_B56_PCX.bmp
+ExtraSprites56 = images/ships/shpchmav/SHOT_B57_PCX.bmp
+ExtraSprites57 = images/ships/shpchmav/SHOT_B58_PCX.bmp
+ExtraSprites58 = images/ships/shpchmav/SHOT_B59_PCX.bmp
+ExtraSprites59 = images/ships/shpchmav/SHOT_B60_PCX.bmp
+ExtraSprites60 = images/ships/shpchmav/SHOT_B61_PCX.bmp
+ExtraSprites61 = images/ships/shpchmav/SHOT_B62_PCX.bmp
+ExtraSprites62 = images/ships/shpchmav/SHOT_B63_PCX.bmp
+ExtraSprites63 = images/ships/shpchmav/SHOT_B64_PCX.bmp

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpchoex.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpchoex.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpchoex.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,56 +1,57 @@
 [Info]
-TWCost  = 14
+TWCost = 14
 Name1 = Chorali
 Name2 = Extractor
 Origin = TW
 Coder = Culture20
 Code = ChoraliExtractor
+Version = 65M
 
 [Ship]
-Crew           = 18
-CrewMax        = 18
-Batt           = 20
-BattMax        = 20
-SpeedMax       = 46	; 40
-AccelRate      = 10
-TurnRate       = 2
+Crew = 18
+CrewMax = 18
+Batt = 20
+BattMax = 20
+SpeedMax = 46	; 40
+AccelRate = 10
+TurnRate = 2
 RechargeAmount = 1
-RechargeRate   = 3
-WeaponDrain    = 8
-WeaponRate     = 4
-SpecialDrain   = 1
-SpecialRate    = 0
-HotspotRate    = 4
-Mass           = 14
+RechargeRate = 3
+WeaponDrain = 8
+WeaponRate = 4
+SpecialDrain = 1
+SpecialRate = 0
+HotspotRate = 4
+Mass = 14
 
 [Weapon]
-Frames   = 6000
-Damage   = 1
+Frames = 6000
+Damage = 1
 
 [AsteroidMissile]
-Range    = 40	; 60
+Range = 40	; 60
 Velocity = 55	; 80
-Damage   = 2
-Armour   = 1
+Damage = 2
+Armour = 1
 TurnRate = 2
 
 [Special]
-Force    = 255
+Force = 255
 
 [Tractor]
-Range    = 6
-PushForce= 14
-PullForce= 1.5	; 1.0
-MaxColorR   = 0
-MaxColorG   = 160
-MaxColorB   = 255
-MinColorR   = 0
-MinColorG   = 0
-MinColorB   = 160
-Rate     = 1
-Damage   = 0
+Range = 6
+PushForce = 14
+PullForce = 1.5	; 1.0
+MaxColorR = 0
+MaxColorG = 160
+MaxColorB = 255
+MinColorR = 0
+MinColorG = 0
+MinColorB = 160
+Rate = 1
+Damage = 0
 MaxBeams = 3
-Spread   = 60
+Spread = 60
 
 [AI3_Default]
 Weapon_Range = 9
@@ -66,3 +67,54 @@
 CaptName5 = Keyrt
 CaptName6 = Ulurt
 CaptName7 = Treakzk
+
+[Music]
+Victory = music/ditty/cheditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpchoex/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpchoex/WAVE_B01_WAV.wav
+
+ExtraSample0 = sound/ships/shpchoex/WAVE_C01_WAV.wav
+ExtraSample1 = sound/ships/shpchoex/WAVE_C01_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 1r
+WeaponSamples = 1
+WeaponExplosion = 0
+SpecialSprites = 10
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 1r
+ExtraSamples = 2
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpchoex/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpchoex/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpchoex/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpchoex/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpchoex/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpchoex/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpchoex/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shpchoex/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shpchoex/SHOT_A01_PCX.bmp
+
+SpecialSprites0 = images/ships/shpchoex/SHOT_B01_PCX.bmp
+SpecialSprites1 = images/ships/shpchoex/SHOT_B02_PCX.bmp
+SpecialSprites2 = images/ships/shpchoex/SHOT_B03_PCX.bmp
+SpecialSprites3 = images/ships/shpchoex/SHOT_B04_PCX.bmp
+SpecialSprites4 = images/ships/shpchoex/SHOT_B05_PCX.bmp
+SpecialSprites5 = images/ships/shpchoex/SHOT_B06_PCX.bmp
+SpecialSprites6 = images/ships/shpchoex/SHOT_B07_PCX.bmp
+SpecialSprites7 = images/ships/shpchoex/SHOT_B08_PCX.bmp
+SpecialSprites8 = images/ships/shpchoex/SHOT_B09_PCX.bmp
+SpecialSprites9 = images/ships/shpchoex/SHOT_B10_PCX.bmp
+
+ExtraSprites0 = images/ships/shpchoex/SHOT_C01_PCX.bmp

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpconca.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpconca.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpconca.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -5,6 +5,7 @@
 Origin = TW
 Coders = Corona688
 Code = ConfedCargotran
+Version = 65M
 
 [Ship]
 Crew = 6
@@ -38,3 +39,48 @@
 Weapon_Range = 20
 Special = Mine
 Special2 = Proximity
+
+[Music]
+Victory = music/ditty/cheditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpconca/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpconca/WAVE_B01_WAV.wav
+SpecialSample1 = sound/ships/shpconca/WAVE_B02_WAV.wav
+
+[Objects]
+
+ShipSprites = 1r
+WeaponSprites = 3r
+WeaponSamples = 1
+WeaponExplosion = 0
+SpecialSprites = 1r
+SpecialSamples = 2
+SpecialExplosion = 0
+ExtraSprites = 3r
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpconca/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpconca/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpconca/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpconca/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpconca/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpconca/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpconca/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shpconca/SHIP_X00_BMP.bmp
+
+WeaponSprites0 = images/ships/shpconca/SHOT_000_PCX.bmp
+WeaponSprites1 = images/ships/shpconca/SHOT_001_PCX.bmp
+WeaponSprites2 = images/ships/shpconca/SHOT_002_PCX.bmp
+
+SpecialSprites0 = images/ships/shpconca/SHOT_A01_PCX.bmp
+
+ExtraSprites0 = images/ships/shpconca/SHOT_E00_PCX.bmp
+ExtraSprites1 = images/ships/shpconca/SHOT_E01_PCX.bmp
+ExtraSprites2 = images/ships/shpconca/SHOT_E02_PCS.bmp

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpconho.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpconho.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpconho.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -6,6 +6,7 @@
 Origin = TW
 Coders = Slag-786B
 Code = ConfederationHornet
+Version = 65M
 
 [Ship]
 Crew = 1
@@ -56,3 +57,50 @@
 Special = Front
 Special2 = Proximity
 Special_Range = 18
+
+[Music]
+Victory = music/ditty/cheditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpconho/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpconho/WAVE_B01_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 1r
+WeaponSamples = 1
+WeaponExplosion = 0
+SpecialSprites = 1r
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 0
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 17
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpconho/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpconho/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpconho/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpconho/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpconho/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpconho/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpconho/SHIP_P06_PCX.bmp
+PanelBitmaps7 = images/ships/shpconho/SHIP_P07_PCX.bmp
+PanelBitmaps8 = images/ships/shpconho/SHIP_P08_PCX.bmp
+PanelBitmaps9 = images/ships/shpconho/SHIP_P09_PCX.bmp
+PanelBitmaps10 = images/ships/shpconho/SHIP_P10_PCX.bmp
+PanelBitmaps11 = images/ships/shpconho/SHIP_P11_PCX.bmp
+PanelBitmaps12 = images/ships/shpconho/SHIP_P12_PCX.bmp
+PanelBitmaps13 = images/ships/shpconho/SHIP_P13_PCX.bmp
+PanelBitmaps14 = images/ships/shpconho/SHIP_P14_PCX.bmp
+PanelBitmaps15 = images/ships/shpconho/SHIP_P15_PCX.bmp
+PanelBitmaps16 = images/ships/shpconho/SHIP_P16_PCX.bmp
+
+
+ShipSprites0 = images/ships/shpconho/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shpconho/SHOT_A01_PCX.bmp
+
+SpecialSprites0 = images/ships/shpconho/SHOT_B01_PCX.bmp

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpdragr.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpdragr.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpdragr.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -5,6 +5,7 @@
 Origin = TW
 Coders = Launchpad
 Code = DraxGryphon
+Version = 65M
 
 [Ship]
 Crew = 24
@@ -52,3 +53,42 @@
 NumNames = 2
 CaptName1 = Resquel
 CaptName2 = Quiszin
+
+[Music]
+Victory = music/ditty/cheditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpdragr/WAVE_A01_WAV.wav
+WeaponSample1 = sound/ships/shpdragr/WAVE_A02_WAV.wav
+
+SpecialSample0 = sound/ships/shpdragr/WAVE_B01_WAV.wav
+
+[Objects]
+
+ShipSprites = 1r
+WeaponSprites = 1r
+WeaponSamples = 2
+WeaponExplosion = 0
+SpecialSprites = 1r
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 0
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpdragr/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpdragr/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpdragr/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpdragr/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpdragr/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpdragr/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpdragr/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shpdragr/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shpdragr/SHOT_A01_PCX.bmp
+
+SpecialSprites0 = images/ships/shpdragr/SHOT_B01_PCX.bmp

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpdruma.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpdruma.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpdruma.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -6,6 +6,7 @@
 Origin = UQM
 Coders = The Fly
 Code = DruugeMauler
+Version = 65M
 
 [Ship]
 Crew = 14
@@ -54,3 +55,43 @@
 CaptName14 = Piini
 CaptName15 = Soopi
 CaptName16 = Peeru
+
+[Music]
+Victory = music/ditty/druditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpdruma/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpdruma/WAVE_B01_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 1r
+WeaponSamples = 1
+WeaponExplosion = 5
+SpecialSprites = 0
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 0
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpdruma/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpdruma/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpdruma/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpdruma/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpdruma/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpdruma/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpdruma/SHIP_P06_PCX.bmp
+
+ShipSprites0 = images/ships/shpdruma/SHIP_S00_PCX.bmp
+
+WeaponSprites0 = images/ships/shpdruma/SHOT_A01_PCX.bmp
+
+WeaponExplosion0 = images/ships/shpdruma/SHOT_B01_PCX.bmp
+WeaponExplosion1 = images/ships/shpdruma/SHOT_B02_PCX.bmp
+WeaponExplosion2 = images/ships/shpdruma/SHOT_B03_PCX.bmp
+WeaponExplosion3 = images/ships/shpdruma/SHOT_B04_PCX.bmp
+WeaponExplosion4 = images/ships/shpdruma/SHOT_B05_PCX.bmp

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpearc3.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpearc3.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpearc3.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -5,6 +5,7 @@
 Origin = TW
 Coders = Tau
 Code = EarthlingCruiserMk3
+Version = 65M
 
 [Ship]
 Crew = 24
@@ -61,3 +62,98 @@
 CaptName14 = Buck
 CaptName15 = Solo
 CaptName16 = Belt
+
+[Music]
+Victory = music/ditty/humditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpearc3/WAVE_A00_WAV.wav
+WeaponSample1 = sound/ships/shpearc3/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpearc3/WAVE_B00_WAV.wav
+
+ExtraSample0 = sound/ships/shpearc3/WAVE_C00_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 33 +alpha
+WeaponSamples = 2
+WeaponExplosion = 20 +alpha
+SpecialSprites = 1 +alpha
+SpecialSamples = 1
+SpecialExplosion = 1 +alpha
+ExtraSprites = 0
+ExtraSamples = 1
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpearc3/ship_p00.bmp
+PanelBitmaps1 = images/ships/shpearc3/ship_p01.bmp
+PanelBitmaps2 = images/ships/shpearc3/ship_p02.bmp
+PanelBitmaps3 = images/ships/shpearc3/ship_p03.bmp
+PanelBitmaps4 = images/ships/shpearc3/ship_p04.bmp
+PanelBitmaps5 = images/ships/shpearc3/ship_p05.bmp
+PanelBitmaps6 = images/ships/shpearc3/ship_p06.bmp
+
+ShipSprites0 = images/ships/shpearc3/SHIP_S0_00_BMP.bmp
+
+WeaponSprites0 = images/ships/shpearc3/SHOT_A0_00_TGA.bmp
+WeaponSprites1 = images/ships/shpearc3/SHOT_A0_01_TGA.bmp
+WeaponSprites2 = images/ships/shpearc3/SHOT_A0_02_TGA.bmp
+WeaponSprites3 = images/ships/shpearc3/SHOT_A0_03_TGA.bmp
+WeaponSprites4 = images/ships/shpearc3/SHOT_A0_04_TGA.bmp
+WeaponSprites5 = images/ships/shpearc3/SHOT_A0_05_TGA.bmp
+WeaponSprites6 = images/ships/shpearc3/SHOT_A0_06_TGA.bmp
+WeaponSprites7 = images/ships/shpearc3/SHOT_A0_07_TGA.bmp
+WeaponSprites8 = images/ships/shpearc3/SHOT_A0_08_TGA.bmp
+WeaponSprites9 = images/ships/shpearc3/SHOT_A0_09_TGA.bmp
+WeaponSprites10 = images/ships/shpearc3/SHOT_A0_10_TGA.bmp
+WeaponSprites11 = images/ships/shpearc3/SHOT_A0_11_TGA.bmp
+WeaponSprites12 = images/ships/shpearc3/SHOT_A0_12_TGA.bmp
+WeaponSprites13 = images/ships/shpearc3/SHOT_A0_13_TGA.bmp
+WeaponSprites14 = images/ships/shpearc3/SHOT_A0_14_TGA.bmp
+WeaponSprites15 = images/ships/shpearc3/SHOT_A0_15_TGA.bmp
+WeaponSprites16 = images/ships/shpearc3/SHOT_A0_16_TGA.bmp
+WeaponSprites17 = images/ships/shpearc3/SHOT_A0_17_TGA.bmp
+WeaponSprites18 = images/ships/shpearc3/SHOT_A0_18_TGA.bmp
+WeaponSprites19 = images/ships/shpearc3/SHOT_A0_19_TGA.bmp
+WeaponSprites20 = images/ships/shpearc3/SHOT_A0_20_TGA.bmp
+WeaponSprites21 = images/ships/shpearc3/SHOT_A0_21_TGA.bmp
+WeaponSprites22 = images/ships/shpearc3/SHOT_A0_22_TGA.bmp
+WeaponSprites23 = images/ships/shpearc3/SHOT_A0_23_TGA.bmp
+WeaponSprites24 = images/ships/shpearc3/SHOT_A0_24_TGA.bmp
+WeaponSprites25 = images/ships/shpearc3/SHOT_A0_25_TGA.bmp
+WeaponSprites26 = images/ships/shpearc3/SHOT_A0_26_TGA.bmp
+WeaponSprites27 = images/ships/shpearc3/SHOT_A0_27_TGA.bmp
+WeaponSprites28 = images/ships/shpearc3/SHOT_A0_28_TGA.bmp
+WeaponSprites29 = images/ships/shpearc3/SHOT_A0_29_TGA.bmp
+WeaponSprites30 = images/ships/shpearc3/SHOT_A0_30_TGA.bmp
+WeaponSprites31 = images/ships/shpearc3/SHOT_A0_31_TGA.bmp
+WeaponSprites32 = images/ships/shpearc3/SHOT_A0_XX_TGA.bmp
+
+WeaponExplosion0 = images/ships/shpearc3/SHOT_B0_00_TGA.bmp
+WeaponExplosion1 = images/ships/shpearc3/SHOT_B0_01_TGA.bmp
+WeaponExplosion2 = images/ships/shpearc3/SHOT_B0_02_TGA.bmp
+WeaponExplosion3 = images/ships/shpearc3/SHOT_B0_03_TGA.bmp
+WeaponExplosion4 = images/ships/shpearc3/SHOT_B0_04_TGA.bmp
+WeaponExplosion5 = images/ships/shpearc3/SHOT_B0_05_TGA.bmp
+WeaponExplosion6 = images/ships/shpearc3/SHOT_B0_06_TGA.bmp
+WeaponExplosion7 = images/ships/shpearc3/SHOT_B0_07_TGA.bmp
+WeaponExplosion8 = images/ships/shpearc3/SHOT_B0_08_TGA.bmp
+WeaponExplosion9 = images/ships/shpearc3/SHOT_B0_09_TGA.bmp
+WeaponExplosion10 = images/ships/shpearc3/SHOT_B0_10_TGA.bmp
+WeaponExplosion11 = images/ships/shpearc3/SHOT_B0_11_TGA.bmp
+WeaponExplosion12 = images/ships/shpearc3/SHOT_B0_12_TGA.bmp
+WeaponExplosion13 = images/ships/shpearc3/SHOT_B0_13_TGA.bmp
+WeaponExplosion14 = images/ships/shpearc3/SHOT_B0_14_TGA.bmp
+WeaponExplosion15 = images/ships/shpearc3/SHOT_B0_15_TGA.bmp
+WeaponExplosion16 = images/ships/shpearc3/SHOT_B0_16_TGA.bmp
+WeaponExplosion17 = images/ships/shpearc3/SHOT_B0_17_TGA.bmp
+WeaponExplosion18 = images/ships/shpearc3/SHOT_B0_18_TGA.bmp
+WeaponExplosion19 = images/ships/shpearc3/SHOT_B0_19_TGA.bmp
+
+SpecialSprites0 = images/ships/shpearc3/SHOT_C0_00_TGA.bmp
+
+SpecialExplosion0 = images/ships/shpearc3/SHOT_D0_00_TGA.bmp

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpearcr.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpearcr.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpearcr.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -7,6 +7,7 @@
 Origin = UQM
 Coders = The Fly
 Code = EarthlingCruiser
+Version = 65M
 
 [Ship]
 Crew = 18
@@ -61,3 +62,49 @@
 CaptName14 = Buck
 CaptName15 = Solo
 CaptName16 = Belt
+
+[Music]
+Victory = music/ditty/humditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpearcr/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpearcr/WAVE_B01_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 1r
+WeaponSamples = 1
+WeaponExplosion = 10 +alpha
+SpecialSprites = 0
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 0
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpearcr/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpearcr/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpearcr/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpearcr/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpearcr/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpearcr/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpearcr/SHIP_P06_PCX.bmp
+
+ShipSprites0 = images/ships/shpearcr/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shpearcr/SHOT_A01_PCX.bmp
+
+WeaponExplosion0 = images/ships/shpearcr/SHOT_B01_BMP.bmp
+WeaponExplosion1 = images/ships/shpearcr/SHOT_B02_BMP.bmp
+WeaponExplosion2 = images/ships/shpearcr/SHOT_B03_BMP.bmp
+WeaponExplosion3 = images/ships/shpearcr/SHOT_B04_BMP.bmp
+WeaponExplosion4 = images/ships/shpearcr/SHOT_B05_BMP.bmp
+WeaponExplosion5 = images/ships/shpearcr/SHOT_B06_BMP.bmp
+WeaponExplosion6 = images/ships/shpearcr/SHOT_B07_BMP.bmp
+WeaponExplosion7 = images/ships/shpearcr/SHOT_B08_BMP.bmp
+WeaponExplosion8 = images/ships/shpearcr/SHOT_B09_BMP.bmp
+WeaponExplosion9 = images/ships/shpearcr/SHOT_B10_BMP.bmp
+

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpforsh.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpforsh.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpforsh.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -4,6 +4,7 @@
 Name2 = Shocker
 Origin = TW
 Code = ForevianShocker
+Version = 65M
 
 [Ship]
 Crew = 42
@@ -46,3 +47,148 @@
 CaptName3 = Desussel
 CaptName4 = Fssres
 
+[Music]
+Victory = music/ditty/forditty.s3m
+
+[Sound]
+WeaponSample0 = sound/ships/shpforsh/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpforsh/WAVE_B01_WAV.wav
+SpecialSample1 = sound/ships/shpforsh/WAVE_B02_WAV.wav
+SpecialSample2 = sound/ships/shpforsh/WAVE_B03_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 32
+WeaponSamples = 1
+WeaponExplosion = 0
+SpecialSprites = 10
+SpecialSamples = 3
+SpecialExplosion = 0
+ExtraSprites = 32
+ExtraSamples = 0
+ExtraExplosion = 32
+PanelBitmaps = 7
+
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpforsh/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpforsh/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpforsh/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpforsh/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpforsh/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpforsh/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpforsh/SHIP_P06_PCX.bmp
+
+ShipSprites0 = images/ships/shpforsh/SHIP_SS_000_BMP.bmp
+
+WeaponSprites0 = images/ships/shpforsh/SHOT_AR_PRIMARY_0001_BMP.bmp
+WeaponSprites1 = images/ships/shpforsh/SHOT_AR_PRIMARY_0002_BMP.bmp
+WeaponSprites2 = images/ships/shpforsh/SHOT_AR_PRIMARY_0003_BMP.bmp
+WeaponSprites3 = images/ships/shpforsh/SHOT_AR_PRIMARY_0004_BMP.bmp
+WeaponSprites4 = images/ships/shpforsh/SHOT_AR_PRIMARY_0005_BMP.bmp
+WeaponSprites5 = images/ships/shpforsh/SHOT_AR_PRIMARY_0006_BMP.bmp
+WeaponSprites6 = images/ships/shpforsh/SHOT_AR_PRIMARY_0007_BMP.bmp
+WeaponSprites7 = images/ships/shpforsh/SHOT_AR_PRIMARY_0008_BMP.bmp
+WeaponSprites8 = images/ships/shpforsh/SHOT_AR_PRIMARY_0009_BMP.bmp
+WeaponSprites9 = images/ships/shpforsh/SHOT_AR_PRIMARY_0010_BMP.bmp
+WeaponSprites10 = images/ships/shpforsh/SHOT_AR_PRIMARY_0011_BMP.bmp
+WeaponSprites11 = images/ships/shpforsh/SHOT_AR_PRIMARY_0012_BMP.bmp
+WeaponSprites12 = images/ships/shpforsh/SHOT_AR_PRIMARY_0013_BMP.bmp
+WeaponSprites13 = images/ships/shpforsh/SHOT_AR_PRIMARY_0014_BMP.bmp
+WeaponSprites14 = images/ships/shpforsh/SHOT_AR_PRIMARY_0015_BMP.bmp
+WeaponSprites15 = images/ships/shpforsh/SHOT_AR_PRIMARY_0016_BMP.bmp
+WeaponSprites16 = images/ships/shpforsh/SHOT_AR_PRIMARY_0017_BMP.bmp
+WeaponSprites17 = images/ships/shpforsh/SHOT_AR_PRIMARY_0018_BMP.bmp
+WeaponSprites18 = images/ships/shpforsh/SHOT_AR_PRIMARY_0019_BMP.bmp
+WeaponSprites19 = images/ships/shpforsh/SHOT_AR_PRIMARY_0020_BMP.bmp
+WeaponSprites20 = images/ships/shpforsh/SHOT_AR_PRIMARY_0021_BMP.bmp
+WeaponSprites21 = images/ships/shpforsh/SHOT_AR_PRIMARY_0022_BMP.bmp
+WeaponSprites22 = images/ships/shpforsh/SHOT_AR_PRIMARY_0023_BMP.bmp
+WeaponSprites23 = images/ships/shpforsh/SHOT_AR_PRIMARY_0024_BMP.bmp
+WeaponSprites24 = images/ships/shpforsh/SHOT_AR_PRIMARY_0025_BMP.bmp
+WeaponSprites25 = images/ships/shpforsh/SHOT_AR_PRIMARY_0026_BMP.bmp
+WeaponSprites26 = images/ships/shpforsh/SHOT_AR_PRIMARY_0027_BMP.bmp
+WeaponSprites27 = images/ships/shpforsh/SHOT_AR_PRIMARY_0028_BMP.bmp
+WeaponSprites28 = images/ships/shpforsh/SHOT_AR_PRIMARY_0029_BMP.bmp
+WeaponSprites29 = images/ships/shpforsh/SHOT_AR_PRIMARY_0030_BMP.bmp
+WeaponSprites30 = images/ships/shpforsh/SHOT_AR_PRIMARY_0031_BMP.bmp
+WeaponSprites31 = images/ships/shpforsh/SHOT_AR_PRIMARY_0032_BMP.bmp
+
+SpecialSprites0 = images/ships/shpforsh/SHOT_B01_PCX.bmp
+SpecialSprites1 = images/ships/shpforsh/SHOT_B02_PCX.bmp
+SpecialSprites2 = images/ships/shpforsh/SHOT_B03_PCX.bmp
+SpecialSprites3 = images/ships/shpforsh/SHOT_B04_PCX.bmp
+SpecialSprites4 = images/ships/shpforsh/SHOT_B05_PCX.bmp
+SpecialSprites5 = images/ships/shpforsh/SHOT_B06_PCX.bmp
+SpecialSprites6 = images/ships/shpforsh/SHOT_B07_PCX.bmp
+SpecialSprites7 = images/ships/shpforsh/SHOT_B08_PCX.bmp
+SpecialSprites8 = images/ships/shpforsh/SHOT_B09_PCX.bmp
+SpecialSprites9 = images/ships/shpforsh/SHOT_B10_PCX.bmp
+
+ExtraSprites0 = images/ships/shpforsh/SHOT_ER_PRIMARY0001_BMP.bmp
+ExtraSprites1 = images/ships/shpforsh/SHOT_ER_PRIMARY0002_BMP.bmp
+ExtraSprites2 = images/ships/shpforsh/SHOT_ER_PRIMARY0003_BMP.bmp
+ExtraSprites3 = images/ships/shpforsh/SHOT_ER_PRIMARY0004_BMP.bmp
+ExtraSprites4 = images/ships/shpforsh/SHOT_ER_PRIMARY0005_BMP.bmp
+ExtraSprites5 = images/ships/shpforsh/SHOT_ER_PRIMARY0006_BMP.bmp
+ExtraSprites6 = images/ships/shpforsh/SHOT_ER_PRIMARY0007_BMP.bmp
+ExtraSprites7 = images/ships/shpforsh/SHOT_ER_PRIMARY0008_BMP.bmp
+ExtraSprites8 = images/ships/shpforsh/SHOT_ER_PRIMARY0009_BMP.bmp
+ExtraSprites9 = images/ships/shpforsh/SHOT_ER_PRIMARY0010_BMP.bmp
+ExtraSprites10 = images/ships/shpforsh/SHOT_ER_PRIMARY0011_BMP.bmp
+ExtraSprites11 = images/ships/shpforsh/SHOT_ER_PRIMARY0012_BMP.bmp
+ExtraSprites12 = images/ships/shpforsh/SHOT_ER_PRIMARY0013_BMP.bmp
+ExtraSprites13 = images/ships/shpforsh/SHOT_ER_PRIMARY0014_BMP.bmp
+ExtraSprites14 = images/ships/shpforsh/SHOT_ER_PRIMARY0015_BMP.bmp
+ExtraSprites15 = images/ships/shpforsh/SHOT_ER_PRIMARY0016_BMP.bmp
+ExtraSprites16 = images/ships/shpforsh/SHOT_ER_PRIMARY0017_BMP.bmp
+ExtraSprites17 = images/ships/shpforsh/SHOT_ER_PRIMARY0018_BMP.bmp
+ExtraSprites18 = images/ships/shpforsh/SHOT_ER_PRIMARY0019_BMP.bmp
+ExtraSprites19 = images/ships/shpforsh/SHOT_ER_PRIMARY0020_BMP.bmp
+ExtraSprites20 = images/ships/shpforsh/SHOT_ER_PRIMARY0021_BMP.bmp
+ExtraSprites21 = images/ships/shpforsh/SHOT_ER_PRIMARY0022_BMP.bmp
+ExtraSprites22 = images/ships/shpforsh/SHOT_ER_PRIMARY0023_BMP.bmp
+ExtraSprites23 = images/ships/shpforsh/SHOT_ER_PRIMARY0024_BMP.bmp
+ExtraSprites24 = images/ships/shpforsh/SHOT_ER_PRIMARY0025_BMP.bmp
+ExtraSprites25 = images/ships/shpforsh/SHOT_ER_PRIMARY0026_BMP.bmp
+ExtraSprites26 = images/ships/shpforsh/SHOT_ER_PRIMARY0027_BMP.bmp
+ExtraSprites27 = images/ships/shpforsh/SHOT_ER_PRIMARY0028_BMP.bmp
+ExtraSprites28 = images/ships/shpforsh/SHOT_ER_PRIMARY0029_BMP.bmp
+ExtraSprites29 = images/ships/shpforsh/SHOT_ER_PRIMARY0030_BMP.bmp
+ExtraSprites30 = images/ships/shpforsh/SHOT_ER_PRIMARY0031_BMP.bmp
+ExtraSprites31 = images/ships/shpforsh/SHOT_ER_PRIMARY0032_BMP.bmp
+
+ExtraExplosion0 = images/ships/shpforsh/SHOT_FR_LIGHTNING0000_BMP.bmp
+ExtraExplosion1 = images/ships/shpforsh/SHOT_FR_LIGHTNING0001_BMP.bmp
+ExtraExplosion2 = images/ships/shpforsh/SHOT_FR_LIGHTNING0002_BMP.bmp
+ExtraExplosion3 = images/ships/shpforsh/SHOT_FR_LIGHTNING0003_BMP.bmp
+ExtraExplosion4 = images/ships/shpforsh/SHOT_FR_LIGHTNING0004_BMP.bmp
+ExtraExplosion5 = images/ships/shpforsh/SHOT_FR_LIGHTNING0005_BMP.bmp
+ExtraExplosion6 = images/ships/shpforsh/SHOT_FR_LIGHTNING0006_BMP.bmp
+ExtraExplosion7 = images/ships/shpforsh/SHOT_FR_LIGHTNING0007_BMP.bmp
+ExtraExplosion8 = images/ships/shpforsh/SHOT_FR_LIGHTNING0008_BMP.bmp
+ExtraExplosion9 = images/ships/shpforsh/SHOT_FR_LIGHTNING0009_BMP.bmp
+ExtraExplosion10 = images/ships/shpforsh/SHOT_FR_LIGHTNING0010_BMP.bmp
+ExtraExplosion11 = images/ships/shpforsh/SHOT_FR_LIGHTNING0011_BMP.bmp
+ExtraExplosion12 = images/ships/shpforsh/SHOT_FR_LIGHTNING0012_BMP.bmp
+ExtraExplosion13 = images/ships/shpforsh/SHOT_FR_LIGHTNING0013_BMP.bmp
+ExtraExplosion14 = images/ships/shpforsh/SHOT_FR_LIGHTNING0014_BMP.bmp
+ExtraExplosion15 = images/ships/shpforsh/SHOT_FR_LIGHTNING0015_BMP.bmp
+ExtraExplosion16 = images/ships/shpforsh/SHOT_FR_LIGHTNING0016_BMP.bmp
+ExtraExplosion17 = images/ships/shpforsh/SHOT_FR_LIGHTNING0017_BMP.bmp
+ExtraExplosion18 = images/ships/shpforsh/SHOT_FR_LIGHTNING0018_BMP.bmp
+ExtraExplosion19 = images/ships/shpforsh/SHOT_FR_LIGHTNING0019_BMP.bmp
+ExtraExplosion20 = images/ships/shpforsh/SHOT_FR_LIGHTNING0020_BMP.bmp
+ExtraExplosion21 = images/ships/shpforsh/SHOT_FR_LIGHTNING0021_BMP.bmp
+ExtraExplosion22 = images/ships/shpforsh/SHOT_FR_LIGHTNING0022_BMP.bmp
+ExtraExplosion23 = images/ships/shpforsh/SHOT_FR_LIGHTNING0023_BMP.bmp
+ExtraExplosion24 = images/ships/shpforsh/SHOT_FR_LIGHTNING0024_BMP.bmp
+ExtraExplosion25 = images/ships/shpforsh/SHOT_FR_LIGHTNING0025_BMP.bmp
+ExtraExplosion26 = images/ships/shpforsh/SHOT_FR_LIGHTNING0026_BMP.bmp
+ExtraExplosion27 = images/ships/shpforsh/SHOT_FR_LIGHTNING0027_BMP.bmp
+ExtraExplosion28 = images/ships/shpforsh/SHOT_FR_LIGHTNING0028_BMP.bmp
+ExtraExplosion29 = images/ships/shpforsh/SHOT_FR_LIGHTNING0029_BMP.bmp
+ExtraExplosion30 = images/ships/shpforsh/SHOT_FR_LIGHTNING0030_BMP.bmp
+ExtraExplosion31 = images/ships/shpforsh/SHOT_FR_LIGHTNING0031_BMP.bmp
+              

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpgarty.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpgarty.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpgarty.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -6,6 +6,7 @@
 Original = Idea = Kwon
 Coders = Tamaraw
 Code = GarashTyrant
+Version = 65M
 
 [Ship]
 Crew = 42
@@ -62,3 +63,61 @@
 CaptName4 = Hordrosk
 CaptName5 = Ghelgor
 CaptName6 = R'dalkrorth
+
+[Music]
+Victory = music/ditty/cheditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpgarty/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpgarty/WAVE_B01_WAV.wav
+
+ExtraSample0 = sound/ships/shpgarty/WAVE_C01_WAV.wav
+ExtraSample0 = sound/ships/shpgarty/WAVE_C02_WAV.wav
+ExtraSample0 = sound/ships/shpgarty/WAVE_C03_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 3r
+WeaponSamples = 1
+WeaponExplosion = 7
+SpecialSprites = 7
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 1r
+ExtraSamples = 3
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpgarty/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpgarty/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpgarty/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpgarty/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpgarty/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpgarty/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpgarty/SHIP_P06_PCX.bmp
+
+ShipSprites0 = images/ships/shpgarty/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shpgarty/SHOT_A01_PCX.bmp
+WeaponSprites1 = images/ships/shpgarty/SHOT_A02_PCX.bmp
+WeaponSprites2 = images/ships/shpgarty/SHOT_A03_PCX.bmp
+
+WeaponExplosion0 = images/ships/shpgarty/SHOT_B01_PCX.bmp
+WeaponExplosion1 = images/ships/shpgarty/SHOT_B02_PCX.bmp
+WeaponExplosion2 = images/ships/shpgarty/SHOT_B03_PCX.bmp
+WeaponExplosion3 = images/ships/shpgarty/SHOT_B04_PCX.bmp
+WeaponExplosion4 = images/ships/shpgarty/SHOT_B05_PCX.bmp
+WeaponExplosion5 = images/ships/shpgarty/SHOT_B06_PCX.bmp
+WeaponExplosion6 = images/ships/shpgarty/SHOT_B07_PCX.bmp
+
+SpecialSprites0 = images/ships/shpgarty/SHOT_C01_PCX.bmp
+SpecialSprites1 = images/ships/shpgarty/SHOT_C02_PCX.bmp
+SpecialSprites2 = images/ships/shpgarty/SHOT_C03_PCX.bmp
+SpecialSprites3 = images/ships/shpgarty/SHOT_C04_PCX.bmp
+SpecialSprites4 = images/ships/shpgarty/SHOT_C05_PCX.bmp
+SpecialSprites5 = images/ships/shpgarty/SHOT_C06_PCX.bmp
+SpecialSprites6 = images/ships/shpgarty/SHOT_C07_PCX.bmp
+
+ExtraSprites0 = images/ships/shpgarty/SHOT_D01_PCX.bmp

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpilwav.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpilwav.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpilwav.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -7,6 +7,7 @@
 Origin = UQM
 Coders = The Fly
 Code = IlwrathAvenger
+Version = 65M
 
 [Ship]
 Crew = 22
@@ -54,3 +55,89 @@
 CaptName14 = Lurgo
 CaptName15 = Regorjo
 CaptName16 = Manglor
+
+[Music]
+Victory = music/ditty/ilwditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpilwav/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpilwav/WAVE_B01_WAV.wav
+SpecialSample1 = sound/ships/shpilwav/WAVE_B02_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 50
+WeaponSamples = 1
+WeaponExplosion = 0
+SpecialSprites = 0
+SpecialSamples = 2
+SpecialExplosion = 0
+ExtraSprites = 0
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpilwav/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpilwav/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpilwav/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpilwav/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpilwav/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpilwav/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpilwav/SHIP_P06_PCX.bmp
+
+ShipSprites0 = images/ships/shpilwav/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shpilwav/SHOT_A01_PCX.bmp
+WeaponSprites1 = images/ships/shpilwav/SHOT_A02_PCX.bmp
+WeaponSprites2 = images/ships/shpilwav/SHOT_A03_PCX.bmp
+WeaponSprites3 = images/ships/shpilwav/SHOT_A04_PCX.bmp
+WeaponSprites4 = images/ships/shpilwav/SHOT_A05_PCX.bmp
+WeaponSprites5 = images/ships/shpilwav/SHOT_A06_PCX.bmp
+WeaponSprites6 = images/ships/shpilwav/SHOT_A07_PCX.bmp
+WeaponSprites7 = images/ships/shpilwav/SHOT_A08_PCX.bmp
+WeaponSprites8 = images/ships/shpilwav/SHOT_A09_PCX.bmp
+WeaponSprites9 = images/ships/shpilwav/SHOT_A10_PCX.bmp
+WeaponSprites10 = images/ships/shpilwav/SHOT_A11_PCX.bmp
+WeaponSprites11 = images/ships/shpilwav/SHOT_A12_PCX.bmp
+WeaponSprites12 = images/ships/shpilwav/SHOT_A13_PCX.bmp
+WeaponSprites13 = images/ships/shpilwav/SHOT_A14_PCX.bmp
+WeaponSprites14 = images/ships/shpilwav/SHOT_A15_PCX.bmp
+WeaponSprites15 = images/ships/shpilwav/SHOT_A16_PCX.bmp
+WeaponSprites16 = images/ships/shpilwav/SHOT_A17_PCX.bmp
+WeaponSprites17 = images/ships/shpilwav/SHOT_A18_PCX.bmp
+WeaponSprites18 = images/ships/shpilwav/SHOT_A19_PCX.bmp
+WeaponSprites19 = images/ships/shpilwav/SHOT_A20_PCX.bmp
+WeaponSprites20 = images/ships/shpilwav/SHOT_A21_PCX.bmp
+WeaponSprites21 = images/ships/shpilwav/SHOT_A22_PCX.bmp
+WeaponSprites22 = images/ships/shpilwav/SHOT_A23_PCX.bmp
+WeaponSprites23 = images/ships/shpilwav/SHOT_A24_PCX.bmp
+WeaponSprites24 = images/ships/shpilwav/SHOT_A25_PCX.bmp
+WeaponSprites25 = images/ships/shpilwav/SHOT_A26_PCX.bmp
+WeaponSprites26 = images/ships/shpilwav/SHOT_A27_PCX.bmp
+WeaponSprites27 = images/ships/shpilwav/SHOT_A28_PCX.bmp
+WeaponSprites28 = images/ships/shpilwav/SHOT_A29_PCX.bmp
+WeaponSprites29 = images/ships/shpilwav/SHOT_A30_PCX.bmp
+WeaponSprites30 = images/ships/shpilwav/SHOT_A31_PCX.bmp
+WeaponSprites31 = images/ships/shpilwav/SHOT_A32_PCX.bmp
+WeaponSprites32 = images/ships/shpilwav/SHOT_A33_PCX.bmp
+WeaponSprites33 = images/ships/shpilwav/SHOT_A34_PCX.bmp
+WeaponSprites34 = images/ships/shpilwav/SHOT_A35_PCX.bmp
+WeaponSprites35 = images/ships/shpilwav/SHOT_A36_PCX.bmp
+WeaponSprites36 = images/ships/shpilwav/SHOT_A37_PCX.bmp
+WeaponSprites37 = images/ships/shpilwav/SHOT_A38_PCX.bmp
+WeaponSprites38 = images/ships/shpilwav/SHOT_A39_PCX.bmp
+WeaponSprites39 = images/ships/shpilwav/SHOT_A40_PCX.bmp
+WeaponSprites40 = images/ships/shpilwav/SHOT_A41_PCX.bmp
+WeaponSprites41 = images/ships/shpilwav/SHOT_A42_PCX.bmp
+WeaponSprites42 = images/ships/shpilwav/SHOT_A43_PCX.bmp
+WeaponSprites43 = images/ships/shpilwav/SHOT_A44_PCX.bmp
+WeaponSprites44 = images/ships/shpilwav/SHOT_A45_PCX.bmp
+WeaponSprites45 = images/ships/shpilwav/SHOT_A46_PCX.bmp
+WeaponSprites46 = images/ships/shpilwav/SHOT_A47_PCX.bmp
+WeaponSprites47 = images/ships/shpilwav/SHOT_A48_PCX.bmp
+WeaponSprites48 = images/ships/shpilwav/SHOT_A49_PCX.bmp
+WeaponSprites49 = images/ships/shpilwav/SHOT_A50_PCX.bmp
+                                              
+

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpilwsp.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpilwsp.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpilwsp.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -8,6 +8,7 @@
 Gfx = Forevian
 Ditty = Forevian
 Code = IlwrathSpider
+Version = 65M
 
 [Ship]
 Crew = 22
@@ -45,3 +46,103 @@
 Weapon = Precedence
 Weapon_Range = 5
 Special = Mine
+
+[Music]
+Victory = music/ditty/ilwditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpilwsp/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpilwsp/WAVE_B01_WAV.wav
+
+ExtraSample0 = sound/ships/shpilwsp/WAVE_C01_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 10
+WeaponSamples = 1
+WeaponExplosion = 0
+SpecialSprites = 32
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 20
+ExtraSamples = 1
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpilwsp/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpilwsp/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpilwsp/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpilwsp/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpilwsp/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpilwsp/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpilwsp/SHIP_P06_PCX.bmp
+
+ShipSprites0 = images/ships/shpilwsp/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shpilwsp/SHOT_A01_PCX.bmp
+WeaponSprites1 = images/ships/shpilwsp/SHOT_A02_PCX.bmp
+WeaponSprites2 = images/ships/shpilwsp/SHOT_A03_PCX.bmp
+WeaponSprites3 = images/ships/shpilwsp/SHOT_A04_PCX.bmp
+WeaponSprites4 = images/ships/shpilwsp/SHOT_A05_PCX.bmp
+WeaponSprites5 = images/ships/shpilwsp/SHOT_A06_PCX.bmp
+WeaponSprites6 = images/ships/shpilwsp/SHOT_A07_PCX.bmp
+WeaponSprites7 = images/ships/shpilwsp/SHOT_A08_PCX.bmp
+WeaponSprites8 = images/ships/shpilwsp/SHOT_A09_PCX.bmp
+WeaponSprites9 = images/ships/shpilwsp/SHOT_A10_PCX.bmp
+                                              
+SpecialSprites0 = images/ships/shpilwsp/SHOT_B01_PCX.bmp
+SpecialSprites1 = images/ships/shpilwsp/SHOT_B02_PCX.bmp
+SpecialSprites2 = images/ships/shpilwsp/SHOT_B03_PCX.bmp
+SpecialSprites3 = images/ships/shpilwsp/SHOT_B04_PCX.bmp
+SpecialSprites4 = images/ships/shpilwsp/SHOT_B05_PCX.bmp
+SpecialSprites5 = images/ships/shpilwsp/SHOT_B06_PCX.bmp
+SpecialSprites6 = images/ships/shpilwsp/SHOT_B07_PCX.bmp
+SpecialSprites7 = images/ships/shpilwsp/SHOT_B08_PCX.bmp
+SpecialSprites8 = images/ships/shpilwsp/SHOT_B09_PCX.bmp
+SpecialSprites9 = images/ships/shpilwsp/SHOT_B10_PCX.bmp
+SpecialSprites10 = images/ships/shpilwsp/SHOT_B11_PCX.bmp
+SpecialSprites11 = images/ships/shpilwsp/SHOT_B12_PCX.bmp
+SpecialSprites12 = images/ships/shpilwsp/SHOT_B13_PCX.bmp
+SpecialSprites13 = images/ships/shpilwsp/SHOT_B14_PCX.bmp
+SpecialSprites14 = images/ships/shpilwsp/SHOT_B15_PCX.bmp
+SpecialSprites15 = images/ships/shpilwsp/SHOT_B16_PCX.bmp
+SpecialSprites16 = images/ships/shpilwsp/SHOT_B17_PCX.bmp
+SpecialSprites17 = images/ships/shpilwsp/SHOT_B18_PCX.bmp
+SpecialSprites18 = images/ships/shpilwsp/SHOT_B19_PCX.bmp
+SpecialSprites19 = images/ships/shpilwsp/SHOT_B20_PCX.bmp
+SpecialSprites20 = images/ships/shpilwsp/SHOT_B21_PCX.bmp
+SpecialSprites21 = images/ships/shpilwsp/SHOT_B22_PCX.bmp
+SpecialSprites22 = images/ships/shpilwsp/SHOT_B23_PCX.bmp
+SpecialSprites23 = images/ships/shpilwsp/SHOT_B24_PCX.bmp
+SpecialSprites24 = images/ships/shpilwsp/SHOT_B25_PCX.bmp
+SpecialSprites25 = images/ships/shpilwsp/SHOT_B26_PCX.bmp
+SpecialSprites26 = images/ships/shpilwsp/SHOT_B27_PCX.bmp
+SpecialSprites27 = images/ships/shpilwsp/SHOT_B28_PCX.bmp
+SpecialSprites28 = images/ships/shpilwsp/SHOT_B29_PCX.bmp
+SpecialSprites29 = images/ships/shpilwsp/SHOT_B30_PCX.bmp
+SpecialSprites30 = images/ships/shpilwsp/SHOT_B31_PCX.bmp
+SpecialSprites31 = images/ships/shpilwsp/SHOT_B32_PCX.bmp
+
+ExtraSprites0 = images/ships/shpilwsp/SHOT_C01_PCX.bmp
+ExtraSprites1 = images/ships/shpilwsp/SHOT_C02_PCX.bmp
+ExtraSprites2 = images/ships/shpilwsp/SHOT_C03_PCX.bmp
+ExtraSprites3 = images/ships/shpilwsp/SHOT_C04_PCX.bmp
+ExtraSprites4 = images/ships/shpilwsp/SHOT_C05_PCX.bmp
+ExtraSprites5 = images/ships/shpilwsp/SHOT_C06_PCX.bmp
+ExtraSprites6 = images/ships/shpilwsp/SHOT_C07_PCX.bmp
+ExtraSprites7 = images/ships/shpilwsp/SHOT_C08_PCX.bmp
+ExtraSprites8 = images/ships/shpilwsp/SHOT_C09_PCX.bmp
+ExtraSprites9 = images/ships/shpilwsp/SHOT_C10_PCX.bmp
+ExtraSprites10 = images/ships/shpilwsp/SHOT_C11_PCX.bmp
+ExtraSprites11 = images/ships/shpilwsp/SHOT_C12_PCX.bmp
+ExtraSprites12 = images/ships/shpilwsp/SHOT_C13_PCX.bmp
+ExtraSprites13 = images/ships/shpilwsp/SHOT_C14_PCX.bmp
+ExtraSprites14 = images/ships/shpilwsp/SHOT_C15_PCX.bmp
+ExtraSprites15 = images/ships/shpilwsp/SHOT_C16_PCX.bmp
+ExtraSprites16 = images/ships/shpilwsp/SHOT_C17_PCX.bmp
+ExtraSprites17 = images/ships/shpilwsp/SHOT_C18_PCX.bmp
+ExtraSprites18 = images/ships/shpilwsp/SHOT_C19_PCX.bmp
+ExtraSprites19 = images/ships/shpilwsp/SHOT_C20_PCX.bmp
+

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpkahbo.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpkahbo.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpkahbo.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -5,6 +5,7 @@
 Origin = TW
 Coders = Launchpad
 Code = KahrBoomerang
+Version = 65M
 
 [Ship]
 Crew = 18
@@ -82,3 +83,44 @@
 BattRecharge = 2
 
 
+[Music]
+Victory = music/ditty/ilwditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpkahbo/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpkahbo/WAVE_B01_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 1r
+WeaponSamples = 1
+WeaponExplosion = 0
+SpecialSprites = 1r
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 1r
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 10
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpkahbo/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpkahbo/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpkahbo/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpkahbo/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpkahbo/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpkahbo/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpkahbo/SHIP_P06_PCX.bmp
+PanelBitmaps7 = images/ships/shpkahbo/SHIP_P07_PCX.bmp
+PanelBitmaps8 = images/ships/shpkahbo/SHIP_P08_PCX.bmp
+PanelBitmaps9 = images/ships/shpkahbo/SHIP_P09_PCX.bmp
+
+
+ShipSprites0 = images/ships/shpkahbo/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shpkahbo/SHOT_A01_PCX.bmp
+
+SpecialSprites0 = images/ships/shpkahbo/SHOT_B01_PCX.bmp
+
+ExtraSprites0 = images/ships/shpkahbo/SHOT_C01_PCX.bmp

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpkohma.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpkohma.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpkohma.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -7,6 +7,7 @@
 Origin = UQM
 Coders = The Fly
 Code = KohrAhMarauder
+Version = 65M
 
 [Ship]
 Crew = 42
@@ -65,3 +66,90 @@
 CaptName14 = Death 47
 CaptName15 = Death 53
 CaptName16 = Death 83
+
+[Music]
+Victory = music/ditty/bladitty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpkohma/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpkohma/WAVE_B01_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 10
+WeaponSamples = 1
+WeaponExplosion = 20
+SpecialSprites = 20 +alpha
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 0
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpkohma/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpkohma/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpkohma/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpkohma/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpkohma/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpkohma/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpkohma/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shpkohma/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shpkohma/SHOT_A01_PCX.bmp
+WeaponSprites1 = images/ships/shpkohma/SHOT_A02_PCX.bmp
+WeaponSprites2 = images/ships/shpkohma/SHOT_A03_PCX.bmp
+WeaponSprites3 = images/ships/shpkohma/SHOT_A04_PCX.bmp
+WeaponSprites4 = images/ships/shpkohma/SHOT_A05_PCX.bmp
+WeaponSprites5 = images/ships/shpkohma/SHOT_A06_PCX.bmp
+WeaponSprites6 = images/ships/shpkohma/SHOT_A07_PCX.bmp
+WeaponSprites7 = images/ships/shpkohma/SHOT_A08_PCX.bmp
+WeaponSprites8 = images/ships/shpkohma/SHOT_A09_PCX.bmp
+WeaponSprites9 = images/ships/shpkohma/SHOT_A10_PCX.bmp
+
+                   
+WeaponExplosion0 = images/ships/shpkohma/SHOT_B01_PCX.bmp
+WeaponExplosion1 = images/ships/shpkohma/SHOT_B02_PCX.bmp
+WeaponExplosion2 = images/ships/shpkohma/SHOT_B03_PCX.bmp
+WeaponExplosion3 = images/ships/shpkohma/SHOT_B04_PCX.bmp
+WeaponExplosion4 = images/ships/shpkohma/SHOT_B05_PCX.bmp
+WeaponExplosion5 = images/ships/shpkohma/SHOT_B06_PCX.bmp
+WeaponExplosion6 = images/ships/shpkohma/SHOT_B07_PCX.bmp
+WeaponExplosion7 = images/ships/shpkohma/SHOT_B08_PCX.bmp
+WeaponExplosion8 = images/ships/shpkohma/SHOT_B09_PCX.bmp
+WeaponExplosion9 = images/ships/shpkohma/SHOT_B10_PCX.bmp
+WeaponExplosion10 = images/ships/shpkohma/SHOT_B11_PCX.bmp
+WeaponExplosion11 = images/ships/shpkohma/SHOT_B12_PCX.bmp
+WeaponExplosion12 = images/ships/shpkohma/SHOT_B13_PCX.bmp
+WeaponExplosion13 = images/ships/shpkohma/SHOT_B14_PCX.bmp
+WeaponExplosion14 = images/ships/shpkohma/SHOT_B15_PCX.bmp
+WeaponExplosion15 = images/ships/shpkohma/SHOT_B16_PCX.bmp
+WeaponExplosion16 = images/ships/shpkohma/SHOT_B17_PCX.bmp
+WeaponExplosion17 = images/ships/shpkohma/SHOT_B18_PCX.bmp
+WeaponExplosion18 = images/ships/shpkohma/SHOT_B19_PCX.bmp
+WeaponExplosion19 = images/ships/shpkohma/SHOT_B20_PCX.bmp
+
+SpecialSprites0 = images/ships/shpkohma/SHOT_C01_PCX.bmp
+SpecialSprites1 = images/ships/shpkohma/SHOT_C02_PCX.bmp
+SpecialSprites2 = images/ships/shpkohma/SHOT_C03_PCX.bmp
+SpecialSprites3 = images/ships/shpkohma/SHOT_C04_PCX.bmp
+SpecialSprites4 = images/ships/shpkohma/SHOT_C05_PCX.bmp
+SpecialSprites5 = images/ships/shpkohma/SHOT_C06_PCX.bmp
+SpecialSprites6 = images/ships/shpkohma/SHOT_C07_PCX.bmp
+SpecialSprites7 = images/ships/shpkohma/SHOT_C08_PCX.bmp
+SpecialSprites8 = images/ships/shpkohma/SHOT_C09_PCX.bmp
+SpecialSprites9 = images/ships/shpkohma/SHOT_C10_PCX.bmp
+SpecialSprites10 = images/ships/shpkohma/SHOT_C11_PCX.bmp
+SpecialSprites11 = images/ships/shpkohma/SHOT_C12_PCX.bmp
+SpecialSprites12 = images/ships/shpkohma/SHOT_C13_PCX.bmp
+SpecialSprites13 = images/ships/shpkohma/SHOT_C14_PCX.bmp
+SpecialSprites14 = images/ships/shpkohma/SHOT_C15_PCX.bmp
+SpecialSprites15 = images/ships/shpkohma/SHOT_C16_PCX.bmp
+SpecialSprites16 = images/ships/shpkohma/SHOT_C17_PCX.bmp
+SpecialSprites17 = images/ships/shpkohma/SHOT_C18_PCX.bmp
+SpecialSprites18 = images/ships/shpkohma/SHOT_C19_PCX.bmp
+SpecialSprites19 = images/ships/shpkohma/SHOT_C20_PCX.bmp

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpkzedr.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpkzedr.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpkzedr.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -8,6 +8,7 @@
 Origin = UQM
 Coders = The Fly
 Code = KzerZaDreadnought
+Version = 65M
 
 [Ship]
 Crew = 42
@@ -61,3 +62,65 @@
 CaptName14 = Lord 783
 CaptName15 = Lord 52
 CaptName16 = Lord 21
+
+[Music]
+Victory = music/ditty/urqditty.mod
+
+
+[Sound]
+WeaponSample0 = sound/ships/shpkzedr/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpkzedr/WAVE_B01_WAV.wav
+
+ExtraSample0 = sound/ships/shpkzedr/WAVE_C01_WAV.wav
+ExtraSample1 = sound/ships/shpkzedr/WAVE_C02_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 1r
+WeaponSamples = 1
+WeaponExplosion = 20 +alpha
+SpecialSprites = 1r
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 0
+ExtraSamples = 2
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpkzedr/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpkzedr/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpkzedr/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpkzedr/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpkzedr/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpkzedr/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpkzedr/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shpkzedr/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shpkzedr/SHOT_A01_PCX.bmp
+
+WeaponExplosion0 = images/ships/shpkzedr/SHOT_B01_PCX.bmp
+WeaponExplosion1 = images/ships/shpkzedr/SHOT_B02_PCX.bmp
+WeaponExplosion2 = images/ships/shpkzedr/SHOT_B03_PCX.bmp
+WeaponExplosion3 = images/ships/shpkzedr/SHOT_B04_PCX.bmp
+WeaponExplosion4 = images/ships/shpkzedr/SHOT_B05_PCX.bmp
+WeaponExplosion5 = images/ships/shpkzedr/SHOT_B06_PCX.bmp
+WeaponExplosion6 = images/ships/shpkzedr/SHOT_B07_PCX.bmp
+WeaponExplosion7 = images/ships/shpkzedr/SHOT_B08_PCX.bmp
+WeaponExplosion8 = images/ships/shpkzedr/SHOT_B09_PCX.bmp
+WeaponExplosion9 = images/ships/shpkzedr/SHOT_B10_PCX.bmp
+WeaponExplosion10 = images/ships/shpkzedr/SHOT_B11_PCX.bmp
+WeaponExplosion11 = images/ships/shpkzedr/SHOT_B12_PCX.bmp
+WeaponExplosion12 = images/ships/shpkzedr/SHOT_B13_PCX.bmp
+WeaponExplosion13 = images/ships/shpkzedr/SHOT_B14_PCX.bmp
+WeaponExplosion14 = images/ships/shpkzedr/SHOT_B15_PCX.bmp
+WeaponExplosion15 = images/ships/shpkzedr/SHOT_B16_PCX.bmp
+WeaponExplosion16 = images/ships/shpkzedr/SHOT_B17_PCX.bmp
+WeaponExplosion17 = images/ships/shpkzedr/SHOT_B18_PCX.bmp
+WeaponExplosion18 = images/ships/shpkzedr/SHOT_B19_PCX.bmp
+WeaponExplosion19 = images/ships/shpkzedr/SHOT_B20_PCX.bmp
+
+SpecialSprites0 = images/ships/shpkzedr/SHOT_C01_PCX.bmp

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpmeltr.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpmeltr.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpmeltr.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -6,6 +6,7 @@
 Origin = UQM
 Coders = The Fly
 Code = MelnormeTrader
+Version = 65M
 
 [Ship]
 Crew = 20
@@ -65,3 +66,202 @@
 CaptName14 = Black
 CaptName15 = Bluish
 CaptName16 = Purple
+
+[Music]
+Victory = music/ditty/melditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpmeltr/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpmeltr/WAVE_B01_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 40 +alpha
+WeaponSamples = 1
+WeaponExplosion = 80 +alpha
+SpecialSprites = 20 +alpha
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 20
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpmeltr/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpmeltr/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpmeltr/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpmeltr/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpmeltr/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpmeltr/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpmeltr/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shpmeltr/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shpmeltr/SHOT_A01_PCX.bmp
+WeaponSprites1 = images/ships/shpmeltr/SHOT_A02_PCX.bmp
+WeaponSprites2 = images/ships/shpmeltr/SHOT_A03_PCX.bmp
+WeaponSprites3 = images/ships/shpmeltr/SHOT_A04_PCX.bmp
+WeaponSprites4 = images/ships/shpmeltr/SHOT_A05_PCX.bmp
+WeaponSprites5 = images/ships/shpmeltr/SHOT_A06_PCX.bmp
+WeaponSprites6 = images/ships/shpmeltr/SHOT_A07_PCX.bmp
+WeaponSprites7 = images/ships/shpmeltr/SHOT_A08_PCX.bmp
+WeaponSprites8 = images/ships/shpmeltr/SHOT_A09_PCX.bmp
+WeaponSprites9 = images/ships/shpmeltr/SHOT_A10_PCX.bmp
+WeaponSprites10 = images/ships/shpmeltr/SHOT_B01_PCX.bmp
+WeaponSprites11 = images/ships/shpmeltr/SHOT_B02_PCX.bmp
+WeaponSprites12 = images/ships/shpmeltr/SHOT_B03_PCX.bmp
+WeaponSprites13 = images/ships/shpmeltr/SHOT_B04_PCX.bmp
+WeaponSprites14 = images/ships/shpmeltr/SHOT_B05_PCX.bmp
+WeaponSprites15 = images/ships/shpmeltr/SHOT_B06_PCX.bmp
+WeaponSprites16 = images/ships/shpmeltr/SHOT_B07_PCX.bmp
+WeaponSprites17 = images/ships/shpmeltr/SHOT_B08_PCX.bmp
+WeaponSprites18 = images/ships/shpmeltr/SHOT_B09_PCX.bmp
+WeaponSprites19 = images/ships/shpmeltr/SHOT_B10_PCX.bmp
+WeaponSprites20 = images/ships/shpmeltr/SHOT_C01_PCX.bmp
+WeaponSprites21 = images/ships/shpmeltr/SHOT_C02_PCX.bmp
+WeaponSprites22 = images/ships/shpmeltr/SHOT_C03_PCX.bmp
+WeaponSprites23 = images/ships/shpmeltr/SHOT_C04_PCX.bmp
+WeaponSprites24 = images/ships/shpmeltr/SHOT_C05_PCX.bmp
+WeaponSprites25 = images/ships/shpmeltr/SHOT_C06_PCX.bmp
+WeaponSprites26 = images/ships/shpmeltr/SHOT_C07_PCX.bmp
+WeaponSprites27 = images/ships/shpmeltr/SHOT_C08_PCX.bmp
+WeaponSprites28 = images/ships/shpmeltr/SHOT_C09_PCX.bmp
+WeaponSprites29 = images/ships/shpmeltr/SHOT_C10_PCX.bmp
+WeaponSprites30 = images/ships/shpmeltr/SHOT_D01_PCX.bmp
+WeaponSprites31 = images/ships/shpmeltr/SHOT_D02_PCX.bmp
+WeaponSprites32 = images/ships/shpmeltr/SHOT_D03_PCX.bmp
+WeaponSprites33 = images/ships/shpmeltr/SHOT_D04_PCX.bmp
+WeaponSprites34 = images/ships/shpmeltr/SHOT_D05_PCX.bmp
+WeaponSprites35 = images/ships/shpmeltr/SHOT_D06_PCX.bmp
+WeaponSprites36 = images/ships/shpmeltr/SHOT_D07_PCX.bmp
+WeaponSprites37 = images/ships/shpmeltr/SHOT_D08_PCX.bmp
+WeaponSprites38 = images/ships/shpmeltr/SHOT_D09_PCX.bmp
+WeaponSprites39 = images/ships/shpmeltr/SHOT_D10_PCX.bmp
+
+
+
+WeaponExplosion0 = images/ships/shpmeltr/SHOT_E01_PCX.bmp
+WeaponExplosion1 = images/ships/shpmeltr/SHOT_E02_PCX.bmp
+WeaponExplosion2 = images/ships/shpmeltr/SHOT_E03_PCX.bmp
+WeaponExplosion3 = images/ships/shpmeltr/SHOT_E04_PCX.bmp
+WeaponExplosion4 = images/ships/shpmeltr/SHOT_E05_PCX.bmp
+WeaponExplosion5 = images/ships/shpmeltr/SHOT_E06_PCX.bmp
+WeaponExplosion6 = images/ships/shpmeltr/SHOT_E07_PCX.bmp
+WeaponExplosion7 = images/ships/shpmeltr/SHOT_E08_PCX.bmp
+WeaponExplosion8 = images/ships/shpmeltr/SHOT_E09_PCX.bmp
+WeaponExplosion9 = images/ships/shpmeltr/SHOT_E10_PCX.bmp
+WeaponExplosion10 = images/ships/shpmeltr/SHOT_E11_PCX.bmp
+WeaponExplosion11 = images/ships/shpmeltr/SHOT_E12_PCX.bmp
+WeaponExplosion12 = images/ships/shpmeltr/SHOT_E13_PCX.bmp
+WeaponExplosion13 = images/ships/shpmeltr/SHOT_E14_PCX.bmp
+WeaponExplosion14 = images/ships/shpmeltr/SHOT_E15_PCX.bmp
+WeaponExplosion15 = images/ships/shpmeltr/SHOT_E16_PCX.bmp
+WeaponExplosion16 = images/ships/shpmeltr/SHOT_E17_PCX.bmp
+WeaponExplosion17 = images/ships/shpmeltr/SHOT_E18_PCX.bmp
+WeaponExplosion18 = images/ships/shpmeltr/SHOT_E19_PCX.bmp
+WeaponExplosion19 = images/ships/shpmeltr/SHOT_E20_PCX.bmp
+WeaponExplosion20 = images/ships/shpmeltr/SHOT_F01_PCX.bmp
+WeaponExplosion21 = images/ships/shpmeltr/SHOT_F02_PCX.bmp
+WeaponExplosion22 = images/ships/shpmeltr/SHOT_F03_PCX.bmp
+WeaponExplosion23 = images/ships/shpmeltr/SHOT_F04_PCX.bmp
+WeaponExplosion24 = images/ships/shpmeltr/SHOT_F05_PCX.bmp
+WeaponExplosion25 = images/ships/shpmeltr/SHOT_F06_PCX.bmp
+WeaponExplosion26 = images/ships/shpmeltr/SHOT_F07_PCX.bmp
+WeaponExplosion27 = images/ships/shpmeltr/SHOT_F08_PCX.bmp
+WeaponExplosion28 = images/ships/shpmeltr/SHOT_F09_PCX.bmp
+WeaponExplosion29 = images/ships/shpmeltr/SHOT_F10_PCX.bmp
+WeaponExplosion30 = images/ships/shpmeltr/SHOT_F11_PCX.bmp
+WeaponExplosion31 = images/ships/shpmeltr/SHOT_F12_PCX.bmp
+WeaponExplosion32 = images/ships/shpmeltr/SHOT_F13_PCX.bmp
+WeaponExplosion33 = images/ships/shpmeltr/SHOT_F14_PCX.bmp
+WeaponExplosion34 = images/ships/shpmeltr/SHOT_F15_PCX.bmp
+WeaponExplosion35 = images/ships/shpmeltr/SHOT_F16_PCX.bmp
+WeaponExplosion36 = images/ships/shpmeltr/SHOT_F17_PCX.bmp
+WeaponExplosion37 = images/ships/shpmeltr/SHOT_F18_PCX.bmp
+WeaponExplosion38 = images/ships/shpmeltr/SHOT_F19_PCX.bmp
+WeaponExplosion39 = images/ships/shpmeltr/SHOT_F20_PCX.bmp
+WeaponExplosion40 = images/ships/shpmeltr/SHOT_G01_PCX.bmp
+WeaponExplosion41 = images/ships/shpmeltr/SHOT_G02_PCX.bmp
+WeaponExplosion42 = images/ships/shpmeltr/SHOT_G03_PCX.bmp
+WeaponExplosion43 = images/ships/shpmeltr/SHOT_G04_PCX.bmp
+WeaponExplosion44 = images/ships/shpmeltr/SHOT_G05_PCX.bmp
+WeaponExplosion45 = images/ships/shpmeltr/SHOT_G06_PCX.bmp
+WeaponExplosion46 = images/ships/shpmeltr/SHOT_G07_PCX.bmp
+WeaponExplosion47 = images/ships/shpmeltr/SHOT_G08_PCX.bmp
+WeaponExplosion48 = images/ships/shpmeltr/SHOT_G09_PCX.bmp
+WeaponExplosion49 = images/ships/shpmeltr/SHOT_G10_PCX.bmp
+WeaponExplosion50 = images/ships/shpmeltr/SHOT_G11_PCX.bmp
+WeaponExplosion51 = images/ships/shpmeltr/SHOT_G12_PCX.bmp
+WeaponExplosion52 = images/ships/shpmeltr/SHOT_G13_PCX.bmp
+WeaponExplosion53 = images/ships/shpmeltr/SHOT_G14_PCX.bmp
+WeaponExplosion54 = images/ships/shpmeltr/SHOT_G15_PCX.bmp
+WeaponExplosion55 = images/ships/shpmeltr/SHOT_G16_PCX.bmp
+WeaponExplosion56 = images/ships/shpmeltr/SHOT_G17_PCX.bmp
+WeaponExplosion57 = images/ships/shpmeltr/SHOT_G18_PCX.bmp
+WeaponExplosion58 = images/ships/shpmeltr/SHOT_G19_PCX.bmp
+WeaponExplosion59 = images/ships/shpmeltr/SHOT_G20_PCX.bmp
+WeaponExplosion60 = images/ships/shpmeltr/SHOT_H01_PCX.bmp
+WeaponExplosion61 = images/ships/shpmeltr/SHOT_H02_PCX.bmp
+WeaponExplosion62 = images/ships/shpmeltr/SHOT_H03_PCX.bmp
+WeaponExplosion63 = images/ships/shpmeltr/SHOT_H04_PCX.bmp
+WeaponExplosion64 = images/ships/shpmeltr/SHOT_H05_PCX.bmp
+WeaponExplosion65 = images/ships/shpmeltr/SHOT_H06_PCX.bmp
+WeaponExplosion66 = images/ships/shpmeltr/SHOT_H07_PCX.bmp
+WeaponExplosion67 = images/ships/shpmeltr/SHOT_H08_PCX.bmp
+WeaponExplosion68 = images/ships/shpmeltr/SHOT_H09_PCX.bmp
+WeaponExplosion69 = images/ships/shpmeltr/SHOT_H10_PCX.bmp
+WeaponExplosion70 = images/ships/shpmeltr/SHOT_H11_PCX.bmp
+WeaponExplosion71 = images/ships/shpmeltr/SHOT_H12_PCX.bmp
+WeaponExplosion72 = images/ships/shpmeltr/SHOT_H13_PCX.bmp
+WeaponExplosion73 = images/ships/shpmeltr/SHOT_H14_PCX.bmp
+WeaponExplosion74 = images/ships/shpmeltr/SHOT_H15_PCX.bmp
+WeaponExplosion75 = images/ships/shpmeltr/SHOT_H16_PCX.bmp
+WeaponExplosion76 = images/ships/shpmeltr/SHOT_H17_PCX.bmp
+WeaponExplosion77 = images/ships/shpmeltr/SHOT_H18_PCX.bmp
+WeaponExplosion78 = images/ships/shpmeltr/SHOT_H19_PCX.bmp
+WeaponExplosion79 = images/ships/shpmeltr/SHOT_H20_PCX.bmp
+
+SpecialSprites0 = images/ships/shpmeltr/SHOT_I01_PCX.bmp
+SpecialSprites1 = images/ships/shpmeltr/SHOT_I02_PCX.bmp
+SpecialSprites2 = images/ships/shpmeltr/SHOT_I03_PCX.bmp
+SpecialSprites3 = images/ships/shpmeltr/SHOT_I04_PCX.bmp
+SpecialSprites4 = images/ships/shpmeltr/SHOT_I05_PCX.bmp
+SpecialSprites5 = images/ships/shpmeltr/SHOT_I06_PCX.bmp
+SpecialSprites6 = images/ships/shpmeltr/SHOT_I07_PCX.bmp
+SpecialSprites7 = images/ships/shpmeltr/SHOT_I08_PCX.bmp
+SpecialSprites8 = images/ships/shpmeltr/SHOT_I09_PCX.bmp
+SpecialSprites9 = images/ships/shpmeltr/SHOT_I10_PCX.bmp
+SpecialSprites10 = images/ships/shpmeltr/SHOT_I11_PCX.bmp
+SpecialSprites11 = images/ships/shpmeltr/SHOT_I12_PCX.bmp
+SpecialSprites12 = images/ships/shpmeltr/SHOT_I13_PCX.bmp
+SpecialSprites13 = images/ships/shpmeltr/SHOT_I14_PCX.bmp
+SpecialSprites14 = images/ships/shpmeltr/SHOT_I15_PCX.bmp
+SpecialSprites15 = images/ships/shpmeltr/SHOT_I16_PCX.bmp
+SpecialSprites16 = images/ships/shpmeltr/SHOT_I17_PCX.bmp
+SpecialSprites17 = images/ships/shpmeltr/SHOT_I18_PCX.bmp
+SpecialSprites18 = images/ships/shpmeltr/SHOT_I19_PCX.bmp
+SpecialSprites19 = images/ships/shpmeltr/SHOT_I20_PCX.bmp
+
+ExtraSprites0 = images/ships/shpmeltr/SHOT_J01_PCX.bmp
+ExtraSprites1 = images/ships/shpmeltr/SHOT_J02_PCX.bmp
+ExtraSprites2 = images/ships/shpmeltr/SHOT_J03_PCX.bmp
+ExtraSprites3 = images/ships/shpmeltr/SHOT_J04_PCX.bmp
+ExtraSprites4 = images/ships/shpmeltr/SHOT_J05_PCX.bmp
+ExtraSprites5 = images/ships/shpmeltr/SHOT_J06_PCX.bmp
+ExtraSprites6 = images/ships/shpmeltr/SHOT_J07_PCX.bmp
+ExtraSprites7 = images/ships/shpmeltr/SHOT_J08_PCX.bmp
+ExtraSprites8 = images/ships/shpmeltr/SHOT_J09_PCX.bmp
+ExtraSprites9 = images/ships/shpmeltr/SHOT_J10_PCX.bmp
+ExtraSprites10 = images/ships/shpmeltr/SHOT_J11_PCX.bmp
+ExtraSprites11 = images/ships/shpmeltr/SHOT_J12_PCX.bmp
+ExtraSprites12 = images/ships/shpmeltr/SHOT_J13_PCX.bmp
+ExtraSprites13 = images/ships/shpmeltr/SHOT_J14_PCX.bmp
+ExtraSprites14 = images/ships/shpmeltr/SHOT_J15_PCX.bmp
+ExtraSprites15 = images/ships/shpmeltr/SHOT_J16_PCX.bmp
+ExtraSprites16 = images/ships/shpmeltr/SHOT_J17_PCX.bmp
+ExtraSprites17 = images/ships/shpmeltr/SHOT_J18_PCX.bmp
+ExtraSprites18 = images/ships/shpmeltr/SHOT_J19_PCX.bmp
+ExtraSprites19 = images/ships/shpmeltr/SHOT_J20_PCX.bmp

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpmmrxf.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpmmrxf.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpmmrxf.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -7,6 +7,7 @@
 Origin = UQM
 Coders = The Fly
 Code = MmrnmhrmXForm
+Version = 65M
 
 [Ship]
 Crew = 20
@@ -85,3 +86,41 @@
 CaptName15 = Nhuh-na
 CaptName16 = Hrnm-hm
 CaptName17 = Mnm-hmm
+
+[Music]
+Victory = music/ditty/mmrditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpmmrxf/WAVE_A01_WAV.wav
+WeaponSample1 = sound/ships/shpmmrxf/WAVE_A02_WAV.wav
+
+SpecialSample0 = sound/ships/shpmmrxf/WAVE_B01_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 1r
+WeaponSamples = 2
+WeaponExplosion = 0
+SpecialSprites = 1r
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 0
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpmmrxf/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpmmrxf/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpmmrxf/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpmmrxf/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpmmrxf/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpmmrxf/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpmmrxf/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shpmmrxf/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shpmmrxf/SHOT_A01_PCX.bmp
+
+SpecialSprites0 = images/ships/shpmmrxf/SHOT_B01_PCX.bmp

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpmycpo.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpmycpo.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpmycpo.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -7,6 +7,7 @@
 Origin = UQM
 Coders = The Fly
 Code = MyconPodship
+Version = 65M
 
 [Ship]
 Crew = 20
@@ -55,3 +56,124 @@
 CaptName14 = Yush
 CaptName15 = Zaloop
 CaptName16 = Znuff
+
+[Music]
+Victory = music/ditty/mycditty.mod
+
+
+[Sound]
+WeaponSample0 = sound/ships/shpmycpo/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpmycpo/WAVE_B01_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 64 +alpha
+WeaponSamples = 1
+WeaponExplosion = 20 +alpha
+SpecialSprites = 0
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 0
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpmycpo/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpmycpo/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpmycpo/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpmycpo/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpmycpo/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpmycpo/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpmycpo/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shpmycpo/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shpmycpo/SHOT_A01_PCX.bmp
+WeaponSprites1 = images/ships/shpmycpo/SHOT_A02_PCX.bmp
+WeaponSprites2 = images/ships/shpmycpo/SHOT_A03_PCX.bmp
+WeaponSprites3 = images/ships/shpmycpo/SHOT_A04_PCX.bmp
+WeaponSprites4 = images/ships/shpmycpo/SHOT_A05_PCX.bmp
+WeaponSprites5 = images/ships/shpmycpo/SHOT_A06_PCX.bmp
+WeaponSprites6 = images/ships/shpmycpo/SHOT_A07_PCX.bmp
+WeaponSprites7 = images/ships/shpmycpo/SHOT_A08_PCX.bmp
+WeaponSprites8 = images/ships/shpmycpo/SHOT_A09_PCX.bmp
+WeaponSprites9 = images/ships/shpmycpo/SHOT_A10_PCX.bmp
+WeaponSprites10 = images/ships/shpmycpo/SHOT_A11_PCX.bmp
+WeaponSprites11 = images/ships/shpmycpo/SHOT_A12_PCX.bmp
+WeaponSprites12 = images/ships/shpmycpo/SHOT_A13_PCX.bmp
+WeaponSprites13 = images/ships/shpmycpo/SHOT_A14_PCX.bmp
+WeaponSprites14 = images/ships/shpmycpo/SHOT_A15_PCX.bmp
+WeaponSprites15 = images/ships/shpmycpo/SHOT_A16_PCX.bmp
+WeaponSprites16 = images/ships/shpmycpo/SHOT_A17_PCX.bmp
+WeaponSprites17 = images/ships/shpmycpo/SHOT_A18_PCX.bmp
+WeaponSprites18 = images/ships/shpmycpo/SHOT_A19_PCX.bmp
+WeaponSprites19 = images/ships/shpmycpo/SHOT_A20_PCX.bmp
+WeaponSprites20 = images/ships/shpmycpo/SHOT_A21_PCX.bmp
+WeaponSprites21 = images/ships/shpmycpo/SHOT_A22_PCX.bmp
+WeaponSprites22 = images/ships/shpmycpo/SHOT_A23_PCX.bmp
+WeaponSprites23 = images/ships/shpmycpo/SHOT_A24_PCX.bmp
+WeaponSprites24 = images/ships/shpmycpo/SHOT_A25_PCX.bmp
+WeaponSprites25 = images/ships/shpmycpo/SHOT_A26_PCX.bmp
+WeaponSprites26 = images/ships/shpmycpo/SHOT_A27_PCX.bmp
+WeaponSprites27 = images/ships/shpmycpo/SHOT_A28_PCX.bmp
+WeaponSprites28 = images/ships/shpmycpo/SHOT_A29_PCX.bmp
+WeaponSprites29 = images/ships/shpmycpo/SHOT_A30_PCX.bmp
+WeaponSprites30 = images/ships/shpmycpo/SHOT_A31_PCX.bmp
+WeaponSprites31 = images/ships/shpmycpo/SHOT_A32_PCX.bmp
+WeaponSprites32 = images/ships/shpmycpo/SHOT_A33_PCX.bmp
+WeaponSprites33 = images/ships/shpmycpo/SHOT_A34_PCX.bmp
+WeaponSprites34 = images/ships/shpmycpo/SHOT_A35_PCX.bmp
+WeaponSprites35 = images/ships/shpmycpo/SHOT_A36_PCX.bmp
+WeaponSprites36 = images/ships/shpmycpo/SHOT_A37_PCX.bmp
+WeaponSprites37 = images/ships/shpmycpo/SHOT_A38_PCX.bmp
+WeaponSprites38 = images/ships/shpmycpo/SHOT_A39_PCX.bmp
+WeaponSprites39 = images/ships/shpmycpo/SHOT_A40_PCX.bmp
+WeaponSprites40 = images/ships/shpmycpo/SHOT_A41_PCX.bmp
+WeaponSprites41 = images/ships/shpmycpo/SHOT_A42_PCX.bmp
+WeaponSprites42 = images/ships/shpmycpo/SHOT_A43_PCX.bmp
+WeaponSprites43 = images/ships/shpmycpo/SHOT_A44_PCX.bmp
+WeaponSprites44 = images/ships/shpmycpo/SHOT_A45_PCX.bmp
+WeaponSprites45 = images/ships/shpmycpo/SHOT_A46_PCX.bmp
+WeaponSprites46 = images/ships/shpmycpo/SHOT_A47_PCX.bmp
+WeaponSprites47 = images/ships/shpmycpo/SHOT_A48_PCX.bmp
+WeaponSprites48 = images/ships/shpmycpo/SHOT_A49_PCX.bmp
+WeaponSprites49 = images/ships/shpmycpo/SHOT_A50_PCX.bmp
+WeaponSprites50 = images/ships/shpmycpo/SHOT_A51_PCX.bmp
+WeaponSprites51 = images/ships/shpmycpo/SHOT_A52_PCX.bmp
+WeaponSprites52 = images/ships/shpmycpo/SHOT_A53_PCX.bmp
+WeaponSprites53 = images/ships/shpmycpo/SHOT_A54_PCX.bmp
+WeaponSprites54 = images/ships/shpmycpo/SHOT_A55_PCX.bmp
+WeaponSprites55 = images/ships/shpmycpo/SHOT_A56_PCX.bmp
+WeaponSprites56 = images/ships/shpmycpo/SHOT_A57_PCX.bmp
+WeaponSprites57 = images/ships/shpmycpo/SHOT_A58_PCX.bmp
+WeaponSprites58 = images/ships/shpmycpo/SHOT_A59_PCX.bmp
+WeaponSprites59 = images/ships/shpmycpo/SHOT_A60_PCX.bmp
+WeaponSprites60 = images/ships/shpmycpo/SHOT_A61_PCX.bmp
+WeaponSprites61 = images/ships/shpmycpo/SHOT_A62_PCX.bmp
+WeaponSprites62 = images/ships/shpmycpo/SHOT_A63_PCX.bmp
+WeaponSprites63 = images/ships/shpmycpo/SHOT_A64_PCX.bmp
+
+WeaponExplosion0 = images/ships/shpmycpo/SHOT_B01_PCX.bmp
+WeaponExplosion1 = images/ships/shpmycpo/SHOT_B02_PCX.bmp
+WeaponExplosion2 = images/ships/shpmycpo/SHOT_B03_PCX.bmp
+WeaponExplosion3 = images/ships/shpmycpo/SHOT_B04_PCX.bmp
+WeaponExplosion4 = images/ships/shpmycpo/SHOT_B05_PCX.bmp
+WeaponExplosion5 = images/ships/shpmycpo/SHOT_B06_PCX.bmp
+WeaponExplosion6 = images/ships/shpmycpo/SHOT_B07_PCX.bmp
+WeaponExplosion7 = images/ships/shpmycpo/SHOT_B08_PCX.bmp
+WeaponExplosion8 = images/ships/shpmycpo/SHOT_B09_PCX.bmp
+WeaponExplosion9 = images/ships/shpmycpo/SHOT_B10_PCX.bmp
+WeaponExplosion10 = images/ships/shpmycpo/SHOT_B11_PCX.bmp
+WeaponExplosion11 = images/ships/shpmycpo/SHOT_B12_PCX.bmp
+WeaponExplosion12 = images/ships/shpmycpo/SHOT_B13_PCX.bmp
+WeaponExplosion13 = images/ships/shpmycpo/SHOT_B14_PCX.bmp
+WeaponExplosion14 = images/ships/shpmycpo/SHOT_B15_PCX.bmp
+WeaponExplosion15 = images/ships/shpmycpo/SHOT_B16_PCX.bmp
+WeaponExplosion16 = images/ships/shpmycpo/SHOT_B17_PCX.bmp
+WeaponExplosion17 = images/ships/shpmycpo/SHOT_B18_PCX.bmp
+WeaponExplosion18 = images/ships/shpmycpo/SHOT_B19_PCX.bmp
+WeaponExplosion19 = images/ships/shpmycpo/SHOT_B20_PCX.bmp
+

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shporzne.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shporzne.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shporzne.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -6,6 +6,7 @@
 Origin = UQM
 Coders = The Fly
 Code = OrzNemesis
+Version = 65M
 
 [Ship]
 Crew = 16
@@ -67,3 +68,70 @@
 CaptName14 = *Smell*
 CaptName15 = *Juice*
 CaptName16 = *Squirt*
+
+[Music]
+Victory = music/ditty/orzditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shporzne/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shporzne/WAVE_B01_WAV.wav
+SpecialSample1 = sound/ships/shporzne/WAVE_B02_WAV.wav
+
+ExtraSample0 = sound/ships/shporzne/WAVE_C01_WAV.wav
+ExtraSample1 = sound/ships/shporzne/WAVE_C02_WAV.wav
+ExtraSample2 = sound/ships/shporzne/WAVE_C03_WAV.wav
+
+[Objects]
+ShipSprites = 1r +alpha
+WeaponSprites = 1r
+WeaponSamples = 1
+WeaponExplosion = 10 +alpha
+SpecialSprites = 2
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 1r +alpha
+ExtraSamples = 3
+ExtraExplosion = 10 +alpha
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shporzne/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shporzne/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shporzne/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shporzne/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shporzne/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shporzne/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shporzne/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shporzne/SHIP_S_00_TGA.bmp
+
+WeaponSprites0 = images/ships/shporzne/SHOT_A01_PCX.bmp
+
+WeaponExplosion0 = images/ships/shporzne/SHOT_B_00_BMP.bmp
+WeaponExplosion1 = images/ships/shporzne/SHOT_B_01_BMP.bmp
+WeaponExplosion2 = images/ships/shporzne/SHOT_B_02_BMP.bmp
+WeaponExplosion3 = images/ships/shporzne/SHOT_B_03_BMP.bmp
+WeaponExplosion4 = images/ships/shporzne/SHOT_B_04_BMP.bmp
+WeaponExplosion5 = images/ships/shporzne/SHOT_B_05_BMP.bmp
+WeaponExplosion6 = images/ships/shporzne/SHOT_B_06_BMP.bmp
+WeaponExplosion7 = images/ships/shporzne/SHOT_B_07_BMP.bmp
+WeaponExplosion8 = images/ships/shporzne/SHOT_B_08_BMP.bmp
+WeaponExplosion9 = images/ships/shporzne/SHOT_B_09_BMP.bmp
+
+SpecialSprites0 = images/ships/shporzne/SHOT_C01_PCX.bmp
+SpecialSprites1 = images/ships/shporzne/SHOT_C02_PCX.bmp
+
+ExtraSprites0 = images/ships/shporzne/SHOT_D_00_TGA.bmp
+
+ExtraExplosion0 = images/ships/shporzne/SHOT_E_00_BMP.bmp
+ExtraExplosion1 = images/ships/shporzne/SHOT_E_01_BMP.bmp
+ExtraExplosion2 = images/ships/shporzne/SHOT_E_02_BMP.bmp
+ExtraExplosion3 = images/ships/shporzne/SHOT_E_03_BMP.bmp
+ExtraExplosion4 = images/ships/shporzne/SHOT_E_04_BMP.bmp
+ExtraExplosion5 = images/ships/shporzne/SHOT_E_05_BMP.bmp
+ExtraExplosion6 = images/ships/shporzne/SHOT_E_06_BMP.bmp
+ExtraExplosion7 = images/ships/shporzne/SHOT_E_07_BMP.bmp
+ExtraExplosion8 = images/ships/shporzne/SHOT_E_08_BMP.bmp
+ExtraExplosion9 = images/ships/shporzne/SHOT_E_09_BMP.bmp

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shppkufu.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shppkufu.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shppkufu.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -6,6 +6,7 @@
 Origin = UQM
 Coders = The Fly
 Code = PkunkFury
+Version = 65M
 
 [Ship]
 Crew = 8
@@ -53,3 +54,61 @@
 CaptName14 = Jay
 CaptName15 = Screech
 CaptName16 = Twitter
+
+[Music]
+Victory = music/ditty/pkuditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shppkufu/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shppkufu/WAVE_B01_WAV.wav
+SpecialSample1 = sound/ships/shppkufu/WAVE_B02_WAV.wav
+SpecialSample2 = sound/ships/shppkufu/WAVE_B03_WAV.wav
+SpecialSample3 = sound/ships/shppkufu/WAVE_B04_WAV.wav
+SpecialSample4 = sound/ships/shppkufu/WAVE_B05_WAV.wav
+SpecialSample5 = sound/ships/shppkufu/WAVE_B06_WAV.wav
+SpecialSample6 = sound/ships/shppkufu/WAVE_B07_WAV.wav
+SpecialSample7 = sound/ships/shppkufu/WAVE_B08_WAV.wav
+SpecialSample8 = sound/ships/shppkufu/WAVE_B09_WAV.wav
+SpecialSample9 = sound/ships/shppkufu/WAVE_B10_WAV.wav
+SpecialSample10 = sound/ships/shppkufu/WAVE_B11_WAV.wav
+SpecialSample11 = sound/ships/shppkufu/WAVE_B12_WAV.wav
+SpecialSample12 = sound/ships/shppkufu/WAVE_B13_WAV.wav
+SpecialSample13 = sound/ships/shppkufu/WAVE_B14_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 10 +alpha
+WeaponSamples = 1
+WeaponExplosion = 0
+SpecialSprites = 0
+SpecialSamples = 14
+SpecialExplosion = 0
+ExtraSprites = 0
+ExtraSamples = 1
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shppkufu/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shppkufu/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shppkufu/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shppkufu/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shppkufu/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shppkufu/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shppkufu/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shppkufu/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shppkufu/SHOT_A01_PCX.bmp
+WeaponSprites1 = images/ships/shppkufu/SHOT_A02_PCX.bmp
+WeaponSprites2 = images/ships/shppkufu/SHOT_A03_PCX.bmp
+WeaponSprites3 = images/ships/shppkufu/SHOT_A04_PCX.bmp
+WeaponSprites4 = images/ships/shppkufu/SHOT_A05_PCX.bmp
+WeaponSprites5 = images/ships/shppkufu/SHOT_A06_PCX.bmp
+WeaponSprites6 = images/ships/shppkufu/SHOT_A07_PCX.bmp
+WeaponSprites7 = images/ships/shppkufu/SHOT_A08_PCX.bmp
+WeaponSprites8 = images/ships/shppkufu/SHOT_A09_PCX.bmp
+WeaponSprites9 = images/ships/shppkufu/SHOT_A10_PCX.bmp
+

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shprogsq.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shprogsq.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shprogsq.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -4,8 +4,9 @@
 Name1 = Rogue
 Name2 = Squadron
 Coders = GeomanNL
-; idea: this version, GeomanNL, but similar ideas were given by many people as well.
+; = idea: this version, GeomanNL, but similar ideas were given by many people as well.
 Code = RogueSquadron
+Version = 65M
 
 [Ship]
 Crew = 11
@@ -25,11 +26,11 @@
 Mass = 10
 
 [Weapon]
-Range    = 40
-Damage   = 1
+Range = 40
+Damage = 1
 Velocity = 100
-Color    = 0x0FFFF00	; yellow
-Length   = 20.0
+Color = 0x0FFFF00	; yellow
+Length = 20.0
 
 [Fighter]
 Crew = 2
@@ -41,7 +42,7 @@
 EvadeRotationPerSec = 720	; can do 2 turn / second to evade some object
 SuicideDamage = 1
 
-; rest is equal to mothership
+; = rest is equal to mothership
 
 [AI3_Default]
 Weapon = Missile
@@ -49,36 +50,36 @@
 SpecialFreq = 10
 
 [Formations]
-; assume the leader heads upward
-; each formation needs CrewMax entries
-; if you've casualties only the first Crew entries are used, so the order in which
-;     you define the positions is important.
-; position (0,0) is for the leader; should always be there.
+; = assume the leader heads upward
+; = each formation needs CrewMax entries
+; = if you've casualties only the first Crew entries are used, so the order in which
+; = you define the positions is important.
+; = position (0,0) is for the leader; should always be there.
 
 Nformations = 5
 
-; formation 1:
-;   ( x y ) sets
+; = formation 1:
+; = ( x y ) sets
 
-; column
+; = column
 Formation01 = 0 0  0 -100  0 -200  0 -300  0 -400  0 -500  0 -600  0 -700  0 -800  0 -900  0 -1000
 
-; row
-Formation02 =  0 0  -100 0  100 0  -200 0  200 0  -300 0  300 0  -400 0  400 0  -500 0  500 0
+; = row
+Formation02 = 0 0  -100 0  100 0  -200 0  200 0  -300 0  300 0  -400 0  400 0  -500 0  500 0
 
-; V
+; = V
 Formation03 = 0 0  -50 -50  50 -50  -100 -100  100 -100  -150 -150  150 -150  -200 -200  200 -200  -250 -250  250 -250
 
-; Circle (disabled)
+; = Circle (disabled)
 ;Formation04 = 0 0  -182 -117  198 -229  -57 -392  -151 -331  108 -32  -108 -32  57 -392  -198 -229  182 -117  151 -331
 
-; Box
+; = Box
 Formation04 = 0 0  -100 -100  0 -100  100 -100  -100 -200  0 -200  100 -200  -100 -300  0 -300  100 -300  0 -400
 
-; Tightly packed Box
+; = Tightly packed Box
 Formation05 = 0 0  -50 -50  0 -50  50 -50  -50 -100  0 -100  50 -100  -50 -150  0 -150  50 -150  0 -200
 
-; Two Rows (disabled)
+; = Two Rows (disabled)
 ;Formation06 = -150 0  -150 100  150 100  -150 200  150 200  -150 300  150 300  -150 400  150 400  -150 500  150 500
 
 [Names]
@@ -89,3 +90,38 @@
 CaptName4 = Delta
 CaptName5 = Red L.
 CaptName6 = Blue L.
+
+[Music]
+Victory = music/ditty/pkuditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shprogsq/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shprogsq/WAVE_B01_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 1r
+WeaponSamples = 1
+WeaponExplosion = 0
+SpecialSprites = 0
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 0
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shprogsq/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shprogsq/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shprogsq/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shprogsq/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shprogsq/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shprogsq/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shprogsq/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shprogsq/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shprogsq/SHOT_A01_PCX.bmp

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpshosc.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpshosc.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpshosc.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -7,6 +7,7 @@
 Origin = UQM
 Coders = The Fly
 Code = ShofixtiScout
+Version = 65M
 
 [Ship]
 Crew = 6
@@ -60,3 +61,70 @@
 CaptName14 = Tora-3
 CaptName15 = Tofu
 CaptName16 = Kimba
+
+[Music]
+Victory = music/ditty/shoditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpshosc/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpshosc/WAVE_B01_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 1r
+WeaponSamples = 1
+WeaponExplosion = 0
+SpecialSprites = 30 +alpha
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 0
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 8
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpshosc/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpshosc/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpshosc/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpshosc/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpshosc/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpshosc/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpshosc/SHIP_P06_PCX.bmp
+PanelBitmaps7 = images/ships/shpshosc/SHIP_P07_PCX.bmp
+
+ShipSprites0 = images/ships/shpshosc/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shpshosc/SHOT_A01_PCX.bmp
+
+SpecialSprites0 = images/ships/shpshosc/SHOT_B01_PCX.bmp
+SpecialSprites1 = images/ships/shpshosc/SHOT_B02_PCX.bmp
+SpecialSprites2 = images/ships/shpshosc/SHOT_B03_PCX.bmp
+SpecialSprites3 = images/ships/shpshosc/SHOT_B04_PCX.bmp
+SpecialSprites4 = images/ships/shpshosc/SHOT_B05_PCX.bmp
+SpecialSprites5 = images/ships/shpshosc/SHOT_B06_PCX.bmp
+SpecialSprites6 = images/ships/shpshosc/SHOT_B07_PCX.bmp
+SpecialSprites7 = images/ships/shpshosc/SHOT_B08_PCX.bmp
+SpecialSprites8 = images/ships/shpshosc/SHOT_B09_PCX.bmp
+SpecialSprites9 = images/ships/shpshosc/SHOT_B10_PCX.bmp
+SpecialSprites10 = images/ships/shpshosc/SHOT_B11_PCX.bmp
+SpecialSprites11 = images/ships/shpshosc/SHOT_B12_PCX.bmp
+SpecialSprites12 = images/ships/shpshosc/SHOT_B13_PCX.bmp
+SpecialSprites13 = images/ships/shpshosc/SHOT_B14_PCX.bmp
+SpecialSprites14 = images/ships/shpshosc/SHOT_B15_PCX.bmp
+SpecialSprites15 = images/ships/shpshosc/SHOT_B16_PCX.bmp
+SpecialSprites16 = images/ships/shpshosc/SHOT_B17_PCX.bmp
+SpecialSprites17 = images/ships/shpshosc/SHOT_B18_PCX.bmp
+SpecialSprites18 = images/ships/shpshosc/SHOT_B19_PCX.bmp
+SpecialSprites19 = images/ships/shpshosc/SHOT_B20_PCX.bmp
+SpecialSprites20 = images/ships/shpshosc/SHOT_B21_PCX.bmp
+SpecialSprites21 = images/ships/shpshosc/SHOT_B22_PCX.bmp
+SpecialSprites22 = images/ships/shpshosc/SHOT_B23_PCX.bmp
+SpecialSprites23 = images/ships/shpshosc/SHOT_B24_PCX.bmp
+SpecialSprites24 = images/ships/shpshosc/SHOT_B25_PCX.bmp
+SpecialSprites25 = images/ships/shpshosc/SHOT_B26_PCX.bmp
+SpecialSprites26 = images/ships/shpshosc/SHOT_B27_PCX.bmp
+SpecialSprites27 = images/ships/shpshosc/SHOT_B28_PCX.bmp
+SpecialSprites28 = images/ships/shpshosc/SHOT_B29_PCX.bmp
+SpecialSprites29 = images/ships/shpshosc/SHOT_B30_PCX.bmp
+

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpslypr.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpslypr.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpslypr.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -6,6 +6,7 @@
 Origin = UQM
 Coders = The Fly (weapon update: GeomanNL)
 Code = SlylandroProbe
+Version = 65M
 
 [Ship]
 Crew = 12
@@ -41,3 +42,100 @@
 [Names]
 NumNames = 1
 CaptName1 = 2418-B
+
+[Music]
+Victory = music/ditty/slyditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpslypr/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpslypr/WAVE_B01_WAV.wav
+
+[Objects]
+ShipSprites = 64
+WeaponSprites = 0
+WeaponSamples = 1
+WeaponExplosion = 1
+SpecialSprites = 0
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 0
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpslypr/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpslypr/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpslypr/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpslypr/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpslypr/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpslypr/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpslypr/SHIP_P06_PCX.bmp
+
+ShipSprites0 = images/ships/shpslypr/SHIP_S01_PCX.bmp
+ShipSprites1 = images/ships/shpslypr/SHIP_S02_PCX.bmp
+ShipSprites2 = images/ships/shpslypr/SHIP_S03_PCX.bmp
+ShipSprites3 = images/ships/shpslypr/SHIP_S04_PCX.bmp
+ShipSprites4 = images/ships/shpslypr/SHIP_S05_PCX.bmp
+ShipSprites5 = images/ships/shpslypr/SHIP_S06_PCX.bmp
+ShipSprites6 = images/ships/shpslypr/SHIP_S07_PCX.bmp
+ShipSprites7 = images/ships/shpslypr/SHIP_S08_PCX.bmp
+ShipSprites8 = images/ships/shpslypr/SHIP_S09_PCX.bmp
+ShipSprites9 = images/ships/shpslypr/SHIP_S10_PCX.bmp
+ShipSprites10 = images/ships/shpslypr/SHIP_S11_PCX.bmp
+ShipSprites11 = images/ships/shpslypr/SHIP_S12_PCX.bmp
+ShipSprites12 = images/ships/shpslypr/SHIP_S13_PCX.bmp
+ShipSprites13 = images/ships/shpslypr/SHIP_S14_PCX.bmp
+ShipSprites14 = images/ships/shpslypr/SHIP_S15_PCX.bmp
+ShipSprites15 = images/ships/shpslypr/SHIP_S16_PCX.bmp
+ShipSprites16 = images/ships/shpslypr/SHIP_S17_PCX.bmp
+ShipSprites17 = images/ships/shpslypr/SHIP_S18_PCX.bmp
+ShipSprites18 = images/ships/shpslypr/SHIP_S19_PCX.bmp
+ShipSprites19 = images/ships/shpslypr/SHIP_S20_PCX.bmp
+ShipSprites20 = images/ships/shpslypr/SHIP_S21_PCX.bmp
+ShipSprites21 = images/ships/shpslypr/SHIP_S22_PCX.bmp
+ShipSprites22 = images/ships/shpslypr/SHIP_S23_PCX.bmp
+ShipSprites23 = images/ships/shpslypr/SHIP_S24_PCX.bmp
+ShipSprites24 = images/ships/shpslypr/SHIP_S25_PCX.bmp
+ShipSprites25 = images/ships/shpslypr/SHIP_S26_PCX.bmp
+ShipSprites26 = images/ships/shpslypr/SHIP_S27_PCX.bmp
+ShipSprites27 = images/ships/shpslypr/SHIP_S28_PCX.bmp
+ShipSprites28 = images/ships/shpslypr/SHIP_S29_PCX.bmp
+ShipSprites29 = images/ships/shpslypr/SHIP_S30_PCX.bmp
+ShipSprites30 = images/ships/shpslypr/SHIP_S31_PCX.bmp
+ShipSprites31 = images/ships/shpslypr/SHIP_S32_PCX.bmp
+ShipSprites32 = images/ships/shpslypr/SHIP_S33_PCX.bmp
+ShipSprites33 = images/ships/shpslypr/SHIP_S34_PCX.bmp
+ShipSprites34 = images/ships/shpslypr/SHIP_S35_PCX.bmp
+ShipSprites35 = images/ships/shpslypr/SHIP_S36_PCX.bmp
+ShipSprites36 = images/ships/shpslypr/SHIP_S37_PCX.bmp
+ShipSprites37 = images/ships/shpslypr/SHIP_S38_PCX.bmp
+ShipSprites38 = images/ships/shpslypr/SHIP_S39_PCX.bmp
+ShipSprites39 = images/ships/shpslypr/SHIP_S40_PCX.bmp
+ShipSprites40 = images/ships/shpslypr/SHIP_S41_PCX.bmp
+ShipSprites41 = images/ships/shpslypr/SHIP_S42_PCX.bmp
+ShipSprites42 = images/ships/shpslypr/SHIP_S43_PCX.bmp
+ShipSprites43 = images/ships/shpslypr/SHIP_S44_PCX.bmp
+ShipSprites44 = images/ships/shpslypr/SHIP_S45_PCX.bmp
+ShipSprites45 = images/ships/shpslypr/SHIP_S46_PCX.bmp
+ShipSprites46 = images/ships/shpslypr/SHIP_S47_PCX.bmp
+ShipSprites47 = images/ships/shpslypr/SHIP_S48_PCX.bmp
+ShipSprites48 = images/ships/shpslypr/SHIP_S49_PCX.bmp
+ShipSprites49 = images/ships/shpslypr/SHIP_S50_PCX.bmp
+ShipSprites50 = images/ships/shpslypr/SHIP_S51_PCX.bmp
+ShipSprites51 = images/ships/shpslypr/SHIP_S52_PCX.bmp
+ShipSprites52 = images/ships/shpslypr/SHIP_S53_PCX.bmp
+ShipSprites53 = images/ships/shpslypr/SHIP_S54_PCX.bmp
+ShipSprites54 = images/ships/shpslypr/SHIP_S55_PCX.bmp
+ShipSprites55 = images/ships/shpslypr/SHIP_S56_PCX.bmp
+ShipSprites56 = images/ships/shpslypr/SHIP_S57_PCX.bmp
+ShipSprites57 = images/ships/shpslypr/SHIP_S58_PCX.bmp
+ShipSprites58 = images/ships/shpslypr/SHIP_S59_PCX.bmp
+ShipSprites59 = images/ships/shpslypr/SHIP_S60_PCX.bmp
+ShipSprites60 = images/ships/shpslypr/SHIP_S61_PCX.bmp
+ShipSprites61 = images/ships/shpslypr/SHIP_S62_PCX.bmp
+ShipSprites62 = images/ships/shpslypr/SHIP_S63_PCX.bmp
+ShipSprites63 = images/ships/shpslypr/SHIP_S64_PCX.bmp
+
+WeaponExplosion0 = images/ships/shpslypr/SHIP_W01_PCX.bmp

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpspael.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpspael.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpspael.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -7,6 +7,7 @@
 Origin = UQM
 Coders = The Fly
 Code = SpathiEluder
+Version = 65M
 
 [Ship]
 Crew = 30
@@ -61,3 +62,40 @@
 CaptName14 = Snelopy
 CaptName15 = Bwinkin
 CaptName16 = Whuff
+
+[Music]
+Victory = music/ditty/spaditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpspael/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpspael/WAVE_B01_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 1r
+WeaponSamples = 1
+WeaponExplosion = 0
+SpecialSprites = 1r
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 0
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpspael/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpspael/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpspael/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpspael/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpspael/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpspael/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpspael/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shpspael/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shpspael/SHOT_A01_PCX.bmp
+
+SpecialSprites0 = images/ships/shpspael/SHOT_B01_PCX.bmp

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpstaba.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpstaba.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpstaba.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -6,6 +6,7 @@
 Coders = UAF :) sort off, thanks to the creators of the other ships I
 ; = used their code for this ship :)
 Code = StarBase
+Version = 65M
 
 [Ship]
 Crew = 42
@@ -43,8 +44,44 @@
 HealColor = 1
 Range = 7
 
-[AI3_Default] 
-Special = Defense 
-SpecialFreq = 3 
+[AI3_Default]
+Special = Defense
+SpecialFreq = 3
 Reserve_Battery = 10
-Weapon = Sides
\ No newline at end of file
+Weapon = Sides
+
+[Music]
+Victory = music/ditty/spaditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpstaba/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpstaba/WAVE_B01_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 1r
+WeaponSamples = 1
+WeaponExplosion = 0
+SpecialSprites = 0
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 0
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpstaba/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpstaba/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpstaba/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpstaba/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpstaba/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpstaba/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpstaba/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shpstaba/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shpstaba/SHOT_A01_PCX.bmp
+

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpsupbl.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpsupbl.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpsupbl.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -6,6 +6,7 @@
 Origin = UQM
 Coders = The Fly
 Code = SupoxBlade
+Version = 65M
 
 [Ship]
 Crew = 12
@@ -51,3 +52,49 @@
 CaptName14 = Stem
 CaptName15 = Bramble
 CaptName16 = Thicket
+
+[Music]
+Victory = music/ditty/supditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpsupbl/WAVE_A01_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 1r
+WeaponSamples = 1
+WeaponExplosion = 10
+SpecialSprites = 0
+SpecialSamples = 0
+SpecialExplosion = 0
+ExtraSprites = 0
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpsupbl/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpsupbl/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpsupbl/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpsupbl/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpsupbl/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpsupbl/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpsupbl/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shpsupbl/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shpsupbl/SHOT_A01_PCX.bmp
+
+WeaponExplosion0 = images/ships/shpsupbl/SHOT_B01_PCX.bmp
+WeaponExplosion1 = images/ships/shpsupbl/SHOT_B02_PCX.bmp
+WeaponExplosion2 = images/ships/shpsupbl/SHOT_B03_PCX.bmp
+WeaponExplosion3 = images/ships/shpsupbl/SHOT_B04_PCX.bmp
+WeaponExplosion4 = images/ships/shpsupbl/SHOT_B05_PCX.bmp
+WeaponExplosion5 = images/ships/shpsupbl/SHOT_B06_PCX.bmp
+WeaponExplosion6 = images/ships/shpsupbl/SHOT_B07_PCX.bmp
+WeaponExplosion7 = images/ships/shpsupbl/SHOT_B08_PCX.bmp
+WeaponExplosion8 = images/ships/shpsupbl/SHOT_B09_PCX.bmp
+WeaponExplosion9 = images/ships/shpsupbl/SHOT_B10_PCX.bmp
+
+

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpsyrpe.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpsyrpe.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpsyrpe.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -7,6 +7,7 @@
 Origin = UQM
 Coders = The Fly
 Code = SyreenPenetrator
+Version = 65M
 
 [Ship]
 Crew = 12
@@ -59,3 +60,42 @@
 CaptName14 = Aelita
 CaptName15 = Alura
 CaptName16 = Dale
+
+[Music]
+Victory = music/ditty/syrditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpsyrpe/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpsyrpe/WAVE_B01_WAV.wav
+
+ExtraSample0 = sound/ships/shpsyrpe/WAVE_C01_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 1r
+WeaponSamples = 1
+WeaponExplosion = 0
+SpecialSprites = 1r32 +alpha
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 0
+ExtraSamples = 1
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpsyrpe/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpsyrpe/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpsyrpe/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpsyrpe/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpsyrpe/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpsyrpe/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpsyrpe/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shpsyrpe/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shpsyrpe/SHOT_A01_PCX.bmp
+
+SpecialSprites0 = images/ships/shpsyrpe/SHOT_B01_PCX.bmp

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shptauar.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shptauar.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shptauar.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,27 +1,28 @@
 [Info]
-TWCost  = 30
+TWCost = 30
 Name1 = Tau
 Name2 = Archon
 Origin = TW
 Coders = Tau (and Jad)
 Code = TauArchon
+Version = 65M
 
 [Ship]
-Crew           = 42
-CrewMax        = 42
-Batt           = 42
-BattMax        = 42
-SpeedMax       = 30
-AccelRate      = 5.7
-TurnRate       = 4.2
+Crew = 42
+CrewMax = 42
+Batt = 42
+BattMax = 42
+SpeedMax = 30
+AccelRate = 5.7
+TurnRate = 4.2
 RechargeAmount = 1
-RechargeRate   = 2.5
-WeaponDrain    = 3
-WeaponRate     = -0.5
-SpecialDrain   = 5
-SpecialRate    = 0
-HotspotRate    = 5
-Mass           = 23
+RechargeRate = 2.5
+WeaponDrain = 3
+WeaponRate = -0.5
+SpecialDrain = 5
+SpecialRate = 0
+HotspotRate = 5
+Mass = 23
 
 CoolDownThenCharge = 1
 
@@ -37,11 +38,11 @@
 SoundTimer = 250
 DoReactiveDamage = 1
 
-; The steps the ship takes to damage a ship
-; set DamageSteps to 0 to return to original (all batt first) style
+; = The steps the ship takes to damage a ship
+; = set DamageSteps to 0 to return to original (all batt first) style
 DamageSteps = 2
 
-; Batt = 1, Crew = 0.
+; = Batt = 1, Crew = 0.
 Step1 = 1
 Step2 = 0
 
@@ -54,3 +55,200 @@
 [AI3_Default]
 Special = Defense
 SpecialFreq = 1
+
+[Music]
+Victory = music/ditty/tauditty.xm
+
+[Sound]
+WeaponSample0 = sound/ships/shptauar/WAVE_A01_WAV.wav
+WeaponSample1 = sound/ships/shptauar/WAVE_A02_WAV.wav
+WeaponSample2 = sound/ships/shptauar/WAVE_A03_WAV.wav
+WeaponSample3 = sound/ships/shptauar/WAVE_A04_WAV.wav
+WeaponSample4 = sound/ships/shptauar/WAVE_A05_WAV.wav
+WeaponSample5 = sound/ships/shptauar/WAVE_A06_WAV.wav
+
+SpecialSample0 = sound/ships/shptauar/WAVE_B01_WAV.wav
+
+ExtraSample0 = sound/ships/shptauar/WAVE_C01_WAV.wav
+ExtraSample1 = sound/ships/shptauar/WAVE_C02_WAV.wav
+ExtraSample2 = sound/ships/shptauar/WAVE_C03_WAV.wav
+ExtraSample3 = sound/ships/shptauar/WAVE_C04_WAV.wav
+
+[Objects]
+ShipSprites = 1r +alpha
+WeaponSprites = 81 +alpha
+WeaponSamples = 6
+WeaponExplosion = 10 +alpha
+SpecialSprites = 0
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 12
+ExtraSamples = 4
+ExtraExplosion = 20 +alpha
+ExtraExtraSprites0_ = 1r +alpha
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shptauar/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shptauar/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shptauar/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shptauar/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shptauar/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shptauar/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shptauar/SHIP_P06_PCX.bmp
+
+ShipSprites0 = images/ships/shptauar/SHIP_S0_00_TGA.bmp
+
+WeaponSprites0 = images/ships/shptauar/SHOT_A0_00_TGA.bmp
+WeaponSprites1 = images/ships/shptauar/SHOT_A0_01_TGA.bmp
+WeaponSprites2 = images/ships/shptauar/SHOT_A0_02_TGA.bmp
+WeaponSprites3 = images/ships/shptauar/SHOT_A0_03_TGA.bmp
+WeaponSprites4 = images/ships/shptauar/SHOT_A0_04_TGA.bmp
+WeaponSprites5 = images/ships/shptauar/SHOT_A0_05_TGA.bmp
+WeaponSprites6 = images/ships/shptauar/SHOT_A0_06_TGA.bmp
+WeaponSprites7 = images/ships/shptauar/SHOT_A0_07_TGA.bmp
+WeaponSprites8 = images/ships/shptauar/SHOT_A0_08_TGA.bmp
+WeaponSprites9 = images/ships/shptauar/SHOT_A0_09_TGA.bmp
+WeaponSprites10 = images/ships/shptauar/SHOT_A0_10_TGA.bmp
+WeaponSprites11 = images/ships/shptauar/SHOT_A0_11_TGA.bmp
+WeaponSprites12 = images/ships/shptauar/SHOT_A0_12_TGA.bmp
+WeaponSprites13 = images/ships/shptauar/SHOT_A0_13_TGA.bmp
+WeaponSprites14 = images/ships/shptauar/SHOT_A0_14_TGA.bmp
+WeaponSprites15 = images/ships/shptauar/SHOT_A0_15_TGA.bmp
+WeaponSprites16 = images/ships/shptauar/SHOT_A0_16_TGA.bmp
+WeaponSprites17 = images/ships/shptauar/SHOT_A0_17_TGA.bmp
+WeaponSprites18 = images/ships/shptauar/SHOT_A0_18_TGA.bmp
+WeaponSprites19 = images/ships/shptauar/SHOT_A0_19_TGA.bmp
+WeaponSprites20 = images/ships/shptauar/SHOT_A1_00_TGA.bmp
+WeaponSprites21 = images/ships/shptauar/SHOT_A1_01_TGA.bmp
+WeaponSprites22 = images/ships/shptauar/SHOT_A1_02_TGA.bmp
+WeaponSprites23 = images/ships/shptauar/SHOT_A1_03_TGA.bmp
+WeaponSprites24 = images/ships/shptauar/SHOT_A1_04_TGA.bmp
+WeaponSprites25 = images/ships/shptauar/SHOT_A1_05_TGA.bmp
+WeaponSprites26 = images/ships/shptauar/SHOT_A1_06_TGA.bmp
+WeaponSprites27 = images/ships/shptauar/SHOT_A1_07_TGA.bmp
+WeaponSprites28 = images/ships/shptauar/SHOT_A1_08_TGA.bmp
+WeaponSprites29 = images/ships/shptauar/SHOT_A1_09_TGA.bmp
+WeaponSprites30 = images/ships/shptauar/SHOT_A1_10_TGA.bmp
+WeaponSprites31 = images/ships/shptauar/SHOT_A1_11_TGA.bmp
+WeaponSprites32 = images/ships/shptauar/SHOT_A1_12_TGA.bmp
+WeaponSprites33 = images/ships/shptauar/SHOT_A1_13_TGA.bmp
+WeaponSprites34 = images/ships/shptauar/SHOT_A1_14_TGA.bmp
+WeaponSprites35 = images/ships/shptauar/SHOT_A1_15_TGA.bmp
+WeaponSprites36 = images/ships/shptauar/SHOT_A1_16_TGA.bmp
+WeaponSprites37 = images/ships/shptauar/SHOT_A1_17_TGA.bmp
+WeaponSprites38 = images/ships/shptauar/SHOT_A1_18_TGA.bmp
+WeaponSprites39 = images/ships/shptauar/SHOT_A1_19_TGA.bmp
+WeaponSprites40 = images/ships/shptauar/SHOT_A2_00_TGA.bmp
+WeaponSprites41 = images/ships/shptauar/SHOT_A2_01_TGA.bmp
+WeaponSprites42 = images/ships/shptauar/SHOT_A2_02_TGA.bmp
+WeaponSprites43 = images/ships/shptauar/SHOT_A2_03_TGA.bmp
+WeaponSprites44 = images/ships/shptauar/SHOT_A2_04_TGA.bmp
+WeaponSprites45 = images/ships/shptauar/SHOT_A2_05_TGA.bmp
+WeaponSprites46 = images/ships/shptauar/SHOT_A2_06_TGA.bmp
+WeaponSprites47 = images/ships/shptauar/SHOT_A2_07_TGA.bmp
+WeaponSprites48 = images/ships/shptauar/SHOT_A2_08_TGA.bmp
+WeaponSprites49 = images/ships/shptauar/SHOT_A2_09_TGA.bmp
+WeaponSprites50 = images/ships/shptauar/SHOT_A2_10_TGA.bmp
+WeaponSprites51 = images/ships/shptauar/SHOT_A2_11_TGA.bmp
+WeaponSprites52 = images/ships/shptauar/SHOT_A2_12_TGA.bmp
+WeaponSprites53 = images/ships/shptauar/SHOT_A2_13_TGA.bmp
+WeaponSprites54 = images/ships/shptauar/SHOT_A2_14_TGA.bmp
+WeaponSprites55 = images/ships/shptauar/SHOT_A2_15_TGA.bmp
+WeaponSprites56 = images/ships/shptauar/SHOT_A2_16_TGA.bmp
+WeaponSprites57 = images/ships/shptauar/SHOT_A2_17_TGA.bmp
+WeaponSprites58 = images/ships/shptauar/SHOT_A2_18_TGA.bmp
+WeaponSprites59 = images/ships/shptauar/SHOT_A2_19_TGA.bmp
+WeaponSprites60 = images/ships/shptauar/SHOT_A3_00_TGA.bmp
+WeaponSprites61 = images/ships/shptauar/SHOT_A3_01_TGA.bmp
+WeaponSprites62 = images/ships/shptauar/SHOT_A3_02_TGA.bmp
+WeaponSprites63 = images/ships/shptauar/SHOT_A3_03_TGA.bmp
+WeaponSprites64 = images/ships/shptauar/SHOT_A3_04_TGA.bmp
+WeaponSprites65 = images/ships/shptauar/SHOT_A3_05_TGA.bmp
+WeaponSprites66 = images/ships/shptauar/SHOT_A3_06_TGA.bmp
+WeaponSprites67 = images/ships/shptauar/SHOT_A3_07_TGA.bmp
+WeaponSprites68 = images/ships/shptauar/SHOT_A3_08_TGA.bmp
+WeaponSprites69 = images/ships/shptauar/SHOT_A3_09_TGA.bmp
+WeaponSprites70 = images/ships/shptauar/SHOT_A3_10_TGA.bmp
+WeaponSprites71 = images/ships/shptauar/SHOT_A3_11_TGA.bmp
+WeaponSprites72 = images/ships/shptauar/SHOT_A3_12_TGA.bmp
+WeaponSprites73 = images/ships/shptauar/SHOT_A3_13_TGA.bmp
+WeaponSprites74 = images/ships/shptauar/SHOT_A3_14_TGA.bmp
+WeaponSprites75 = images/ships/shptauar/SHOT_A3_15_TGA.bmp
+WeaponSprites76 = images/ships/shptauar/SHOT_A3_16_TGA.bmp
+WeaponSprites77 = images/ships/shptauar/SHOT_A3_17_TGA.bmp
+WeaponSprites78 = images/ships/shptauar/SHOT_A3_18_TGA.bmp
+WeaponSprites79 = images/ships/shptauar/SHOT_A3_19_TGA.bmp
+WeaponSprites80 = images/ships/shptauar/SHOT_AX_00_TGA.bmp
+
+
+WeaponExplosion0 = images/ships/shptauar/SHOT_B_00_TGA.bmp
+WeaponExplosion1 = images/ships/shptauar/SHOT_B_01_TGA.bmp
+WeaponExplosion2 = images/ships/shptauar/SHOT_B_02_TGA.bmp
+WeaponExplosion3 = images/ships/shptauar/SHOT_B_03_TGA.bmp
+WeaponExplosion4 = images/ships/shptauar/SHOT_B_04_TGA.bmp
+WeaponExplosion5 = images/ships/shptauar/SHOT_B_05_TGA.bmp
+WeaponExplosion6 = images/ships/shptauar/SHOT_B_06_TGA.bmp
+WeaponExplosion7 = images/ships/shptauar/SHOT_B_07_TGA.bmp
+WeaponExplosion8 = images/ships/shptauar/SHOT_B_08_TGA.bmp
+WeaponExplosion9 = images/ships/shptauar/SHOT_B_09_TGA.bmp
+
+SpecialSprites0 = images/ships/shptauar/SHOT_C0_00_TGA.bmp
+SpecialSprites1 = images/ships/shptauar/SHOT_C1_00_TGA.bmp
+
+SpecialExplosion0 = images/ships/shptauar/SHOT_D_00_TGA.bmp
+SpecialExplosion1 = images/ships/shptauar/SHOT_D_01_TGA.bmp
+SpecialExplosion2 = images/ships/shptauar/SHOT_D_02_TGA.bmp
+SpecialExplosion3 = images/ships/shptauar/SHOT_D_03_TGA.bmp
+SpecialExplosion4 = images/ships/shptauar/SHOT_D_04_TGA.bmp
+SpecialExplosion5 = images/ships/shptauar/SHOT_D_05_TGA.bmp
+SpecialExplosion6 = images/ships/shptauar/SHOT_D_06_TGA.bmp
+SpecialExplosion7 = images/ships/shptauar/SHOT_D_07_TGA.bmp
+SpecialExplosion8 = images/ships/shptauar/SHOT_D_08_TGA.bmp
+SpecialExplosion9 = images/ships/shptauar/SHOT_D_09_TGA.bmp
+SpecialExplosion10 = images/ships/shptauar/SHOT_D_10_TGA.bmp
+SpecialExplosion11 = images/ships/shptauar/SHOT_D_11_TGA.bmp
+SpecialExplosion12 = images/ships/shptauar/SHOT_D_12_TGA.bmp
+SpecialExplosion13 = images/ships/shptauar/SHOT_D_13_TGA.bmp
+SpecialExplosion14 = images/ships/shptauar/SHOT_D_14_TGA.bmp
+SpecialExplosion15 = images/ships/shptauar/SHOT_D_15_TGA.bmp
+SpecialExplosion16 = images/ships/shptauar/SHOT_D_16_TGA.bmp
+SpecialExplosion17 = images/ships/shptauar/SHOT_D_17_TGA.bmp
+SpecialExplosion18 = images/ships/shptauar/SHOT_D_18_TGA.bmp
+SpecialExplosion19 = images/ships/shptauar/SHOT_D_19_TGA.bmp
+
+ExtraSprites0 = images/ships/shptauar/SHOT_C01_PCX.bmp
+ExtraSprites1 = images/ships/shptauar/SHOT_C02_PCX.bmp
+ExtraSprites2 = images/ships/shptauar/SHOT_C03_PCX.bmp
+ExtraSprites3 = images/ships/shptauar/SHOT_C04_PCX.bmp
+ExtraSprites4 = images/ships/shptauar/SHOT_C05_PCX.bmp
+ExtraSprites5 = images/ships/shptauar/SHOT_C06_PCX.bmp
+ExtraSprites6 = images/ships/shptauar/SHOT_C07_PCX.bmp
+ExtraSprites7 = images/ships/shptauar/SHOT_C08_PCX.bmp
+ExtraSprites8 = images/ships/shptauar/SHOT_C09_PCX.bmp
+ExtraSprites9 = images/ships/shptauar/SHOT_C10_PCX.bmp
+ExtraSprites10 = images/ships/shptauar/SHOT_C11_PCX.bmp
+ExtraSprites11 = images/ships/shptauar/SHOT_C12_PCX.bmp
+
+ExtraExplosion0 = images/ships/shptauar/SHOT_F_00_TGA.bmp
+ExtraExplosion1 = images/ships/shptauar/SHOT_F_01_TGA.bmp
+ExtraExplosion2 = images/ships/shptauar/SHOT_F_02_TGA.bmp
+ExtraExplosion3 = images/ships/shptauar/SHOT_F_03_TGA.bmp
+ExtraExplosion4 = images/ships/shptauar/SHOT_F_04_TGA.bmp
+ExtraExplosion5 = images/ships/shptauar/SHOT_F_05_TGA.bmp
+ExtraExplosion6 = images/ships/shptauar/SHOT_F_06_TGA.bmp
+ExtraExplosion7 = images/ships/shptauar/SHOT_F_07_TGA.bmp
+ExtraExplosion8 = images/ships/shptauar/SHOT_F_08_TGA.bmp
+ExtraExplosion9 = images/ships/shptauar/SHOT_F_09_TGA.bmp
+ExtraExplosion10 = images/ships/shptauar/SHOT_F_10_TGA.bmp
+ExtraExplosion11 = images/ships/shptauar/SHOT_F_11_TGA.bmp
+ExtraExplosion12 = images/ships/shptauar/SHOT_F_12_TGA.bmp
+ExtraExplosion13 = images/ships/shptauar/SHOT_F_13_TGA.bmp
+ExtraExplosion14 = images/ships/shptauar/SHOT_F_14_TGA.bmp
+ExtraExplosion15 = images/ships/shptauar/SHOT_F_15_TGA.bmp
+ExtraExplosion16 = images/ships/shptauar/SHOT_F_16_TGA.bmp
+ExtraExplosion17 = images/ships/shptauar/SHOT_F_17_TGA.bmp
+ExtraExplosion18 = images/ships/shptauar/SHOT_F_18_TGA.bmp
+ExtraExplosion19 = images/ships/shptauar/SHOT_F_19_TGA.bmp
+
+ExtraExtraSprites0_0 = images/ships/shptauar/SHOT_X0_00_BMP.bmp

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shptauda.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shptauda.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shptauda.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,27 +1,28 @@
 [Info]
-TWCost  = 12
+TWCost = 12
 Name1 = Tau
 Name2 = Dagger
 Origin = TW
 Coders = Tau
 Code = TauDagger
+Version = 65M
 
 [Ship]
-Crew           = 8
-CrewMax        = 8
-Batt           = 12
-BattMax        = 12
-SpeedMax       = 47
-AccelRate      = 13
-TurnRate       = 1
+Crew = 8
+CrewMax = 8
+Batt = 12
+BattMax = 12
+SpeedMax = 47
+AccelRate = 13
+TurnRate = 1
 RechargeAmount = 1
-RechargeRate   = 3
-WeaponDrain    = 6
-WeaponRate     = 11
-SpecialDrain   = 12
-SpecialRate    = 0
-HotspotRate    = 1
-Mass           = 6
+RechargeRate = 3
+WeaponDrain = 6
+WeaponRate = 11
+SpecialDrain = 12
+SpecialRate = 0
+HotspotRate = 1
+Mass = 6
 
 [Weapon]
 Range = 4.5
@@ -35,3 +36,73 @@
 Armour = 3
 Recoil = 60
 
+[Music]
+Victory = music/ditty/tauditty.xm
+
+[Sound]
+WeaponSample0 = sound/ships/shptauda/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shptauda/WAVE_B01_WAV.wav
+SpecialSample1 = sound/ships/shptauda/WAVE_B02_WAV.wav
+
+[Objects]
+ShipSprites = 1r +alpha
+WeaponSprites = 0
+WeaponSamples = 1
+WeaponExplosion = 1 +alpha
+SpecialSprites = 2r +alpha
+SpecialSamples = 2
+SpecialExplosion = 20 +alpha
+ExtraSprites = 10 +alpha
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shptauda/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shptauda/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shptauda/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shptauda/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shptauda/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shptauda/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shptauda/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shptauda/SHIP_S_00_TGA.bmp
+
+WeaponExplosion0 = images/ships/shptauda/SHOT_B_00_TGA.bmp
+
+SpecialSprites0 = images/ships/shptauda/SHOT_C0_00_TGA.bmp
+SpecialSprites1 = images/ships/shptauda/SHOT_C1_00_TGA.bmp
+
+SpecialExplosion0 = images/ships/shptauda/SHOT_D_00_TGA.bmp
+SpecialExplosion1 = images/ships/shptauda/SHOT_D_01_TGA.bmp
+SpecialExplosion2 = images/ships/shptauda/SHOT_D_02_TGA.bmp
+SpecialExplosion3 = images/ships/shptauda/SHOT_D_03_TGA.bmp
+SpecialExplosion4 = images/ships/shptauda/SHOT_D_04_TGA.bmp
+SpecialExplosion5 = images/ships/shptauda/SHOT_D_05_TGA.bmp
+SpecialExplosion6 = images/ships/shptauda/SHOT_D_06_TGA.bmp
+SpecialExplosion7 = images/ships/shptauda/SHOT_D_07_TGA.bmp
+SpecialExplosion8 = images/ships/shptauda/SHOT_D_08_TGA.bmp
+SpecialExplosion9 = images/ships/shptauda/SHOT_D_09_TGA.bmp
+SpecialExplosion10 = images/ships/shptauda/SHOT_D_10_TGA.bmp
+SpecialExplosion11 = images/ships/shptauda/SHOT_D_11_TGA.bmp
+SpecialExplosion12 = images/ships/shptauda/SHOT_D_12_TGA.bmp
+SpecialExplosion13 = images/ships/shptauda/SHOT_D_13_TGA.bmp
+SpecialExplosion14 = images/ships/shptauda/SHOT_D_14_TGA.bmp
+SpecialExplosion15 = images/ships/shptauda/SHOT_D_15_TGA.bmp
+SpecialExplosion16 = images/ships/shptauda/SHOT_D_16_TGA.bmp
+SpecialExplosion17 = images/ships/shptauda/SHOT_D_17_TGA.bmp
+SpecialExplosion18 = images/ships/shptauda/SHOT_D_18_TGA.bmp
+SpecialExplosion19 = images/ships/shptauda/SHOT_D_19_TGA.bmp
+
+ExtraSprites0 = images/ships/shptauda/SHOT_E_00_TGA.bmp
+ExtraSprites1 = images/ships/shptauda/SHOT_E_01_TGA.bmp
+ExtraSprites2 = images/ships/shptauda/SHOT_E_02_TGA.bmp
+ExtraSprites3 = images/ships/shptauda/SHOT_E_03_TGA.bmp
+ExtraSprites4 = images/ships/shptauda/SHOT_E_04_TGA.bmp
+ExtraSprites5 = images/ships/shptauda/SHOT_E_05_TGA.bmp
+ExtraSprites6 = images/ships/shptauda/SHOT_E_06_TGA.bmp
+ExtraSprites7 = images/ships/shptauda/SHOT_E_07_TGA.bmp
+ExtraSprites8 = images/ships/shptauda/SHOT_E_08_TGA.bmp
+ExtraSprites9 = images/ships/shptauda/SHOT_E_09_TGA.bmp

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shptausl.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shptausl.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shptausl.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,32 +1,33 @@
 [Info]
 Origin = TW
-TWCost  = 20
+TWCost = 20
 Name1 = Tau
 Name2 = Slider
 Coders = Tau
 Code = TauSlider
+Version = 65M
 
 [Ship]
-Crew           = 22
-CrewMax        = 22
-Batt           = 22
-BattMax        = 22
-SpeedMax       = 42
-AccelRate      = 9
-TurnRate       = 1
+Crew = 22
+CrewMax = 22
+Batt = 22
+BattMax = 22
+SpeedMax = 42
+AccelRate = 9
+TurnRate = 1
 RechargeAmount = 1
-RechargeRate   = 2
-WeaponDrain    = 3
-WeaponRate     = 1
-SpecialDrain   = 3
-SpecialRate    = 4
-HotspotRate    = 3
-Mass           = 16
+RechargeRate = 2
+WeaponDrain = 3
+WeaponRate = 1
+SpecialDrain = 3
+SpecialRate = 4
+HotspotRate = 3
+Mass = 16
 
 [Weapon]
-Range    = 15
+Range = 15
 Velocity = 110
-Length  = 10
+Length = 10
 
 [Special]
 Range0 = 0
@@ -41,3 +42,37 @@
 SubVelocity = 2
 
 
+[Music]
+Victory = music/ditty/tauditty.xm
+
+[Sound]
+WeaponSample0 = sound/ships/shptausl/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shptausl/WAVE_B01_WAV.wav
+SpecialSample1 = sound/ships/shptausl/WAVE_B02_WAV.wav
+SpecialSample1 = sound/ships/shptausl/WAVE_B03_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 0
+WeaponSamples = 1
+WeaponExplosion = 0
+SpecialSprites = 0
+SpecialSamples = 3
+SpecialExplosion = 0
+ExtraSprites = 0
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shptausl/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shptausl/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shptausl/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shptausl/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shptausl/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shptausl/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shptausl/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shptausl/SHIP_S00_BMP.bmp

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shptauto.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shptauto.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shptauto.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,40 +1,41 @@
 [Info]
 Origin = TW
-TWCost  = 22
+TWCost = 22
 Name1 = Tau
 Name2 = Torrent
 Coders = Tau
-Ditty  = Lestat
+Ditty = Lestat
 Code = TauTor
+Version = 65M
 
 [Ship]
-Crew           = 20
-CrewMax        = 20
-Batt           = 20
-BattMax        = 20
-SpeedMax       = 50
-AccelRate      = 5
-TurnRate       = 3
+Crew = 20
+CrewMax = 20
+Batt = 20
+BattMax = 20
+SpeedMax = 50
+AccelRate = 5
+TurnRate = 3
 RechargeAmount = 1
-RechargeRate   = 3
-WeaponDrain    = 10
-WeaponRate     = 20
-SpecialDrain   = 1
-SpecialRate    = 1
-HotspotRate    = 1
-Mass           = 21
+RechargeRate = 3
+WeaponDrain = 10
+WeaponRate = 20
+SpecialDrain = 1
+SpecialRate = 1
+HotspotRate = 1
+Mass = 21
 
 [Weapon]
-Range    = 50
+Range = 50
 Velocity = 130
-Damage   = 6
-Armour   = 999
+Damage = 6
+Armour = 999
 
 [Special]
-Range    = 14
+Range = 14
 Velocity = 80
-Damage   = 2
-Armour   = 1
+Damage = 2
+Armour = 1
 
 [Extra]
 StartDrain = 6
@@ -49,3 +50,93 @@
 BattRecharge = 1
 Special = Proximity
 Special_Range = 10
+
+[Music]
+Victory = music/ditty/tauditty.xm
+
+[Sound]
+WeaponSample0 = sound/ships/shptauto/WAVE_A01_WAV.wav
+WeaponSample1 = sound/ships/shptauto/WAVE_A02_WAV.wav
+
+ExtraSample0 = sound/ships/shptauto/WAVE_C01_WAV.wav
+ExtraSample1 = sound/ships/shptauto/WAVE_C02_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 6
+WeaponSamples = 2
+WeaponExplosion = 12
+SpecialSprites = 6
+SpecialSamples = 0
+SpecialExplosion = 12
+ExtraSprites = 12
+ExtraSamples = 2
+ExtraExplosion = 1r
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shptauto/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shptauto/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shptauto/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shptauto/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shptauto/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shptauto/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shptauto/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shptauto/SHIP_S00_BMP.bmp
+
+WeaponSprites0 = images/ships/shptauto/SHOT_A00_BMP.bmp
+WeaponSprites1 = images/ships/shptauto/SHOT_A01_BMP.bmp
+WeaponSprites2 = images/ships/shptauto/SHOT_A02_BMP.bmp
+WeaponSprites3 = images/ships/shptauto/SHOT_A03_BMP.bmp
+WeaponSprites4 = images/ships/shptauto/SHOT_A04_BMP.bmp
+WeaponSprites5 = images/ships/shptauto/SHOT_A05_BMP.bmp
+
+WeaponExplosion0 = images/ships/shptauto/SHOT_B00_BMP.bmp
+WeaponExplosion1 = images/ships/shptauto/SHOT_B01_BMP.bmp
+WeaponExplosion2 = images/ships/shptauto/SHOT_B02_BMP.bmp
+WeaponExplosion3 = images/ships/shptauto/SHOT_B03_BMP.bmp
+WeaponExplosion4 = images/ships/shptauto/SHOT_B04_BMP.bmp
+WeaponExplosion5 = images/ships/shptauto/SHOT_B05_BMP.bmp
+WeaponExplosion6 = images/ships/shptauto/SHOT_B06_BMP.bmp
+WeaponExplosion7 = images/ships/shptauto/SHOT_B07_BMP.bmp
+WeaponExplosion8 = images/ships/shptauto/SHOT_B08_BMP.bmp
+WeaponExplosion9 = images/ships/shptauto/SHOT_B09_BMP.bmp
+WeaponExplosion10 = images/ships/shptauto/SHOT_B10_BMP.bmp
+WeaponExplosion11 = images/ships/shptauto/SHOT_B11_BMP.bmp
+
+SpecialSprites0 = images/ships/shptauto/SHOT_C00_BMP.bmp
+SpecialSprites1 = images/ships/shptauto/SHOT_C01_BMP.bmp
+SpecialSprites2 = images/ships/shptauto/SHOT_C02_BMP.bmp
+SpecialSprites3 = images/ships/shptauto/SHOT_C03_BMP.bmp
+SpecialSprites4 = images/ships/shptauto/SHOT_C04_BMP.bmp
+SpecialSprites5 = images/ships/shptauto/SHOT_C05_BMP.bmp
+
+SpecialExplosion0 = images/ships/shptauto/SHOT_D00_BMP.bmp
+SpecialExplosion1 = images/ships/shptauto/SHOT_D01_BMP.bmp
+SpecialExplosion2 = images/ships/shptauto/SHOT_D02_BMP.bmp
+SpecialExplosion3 = images/ships/shptauto/SHOT_D03_BMP.bmp
+SpecialExplosion4 = images/ships/shptauto/SHOT_D04_BMP.bmp
+SpecialExplosion5 = images/ships/shptauto/SHOT_D05_BMP.bmp
+SpecialExplosion6 = images/ships/shptauto/SHOT_D06_BMP.bmp
+SpecialExplosion7 = images/ships/shptauto/SHOT_D07_BMP.bmp
+SpecialExplosion8 = images/ships/shptauto/SHOT_D08_BMP.bmp
+SpecialExplosion9 = images/ships/shptauto/SHOT_D09_BMP.bmp
+SpecialExplosion10 = images/ships/shptauto/SHOT_D10_BMP.bmp
+SpecialExplosion11 = images/ships/shptauto/SHOT_D11_BMP.bmp
+
+ExtraSprites0 = images/ships/shptauto/SHOT_E0000_BMP.bmp
+ExtraSprites1 = images/ships/shptauto/SHOT_E0001_BMP.bmp
+ExtraSprites2 = images/ships/shptauto/SHOT_E0002_BMP.bmp
+ExtraSprites3 = images/ships/shptauto/SHOT_E0003_BMP.bmp
+ExtraSprites4 = images/ships/shptauto/SHOT_E0004_BMP.bmp
+ExtraSprites5 = images/ships/shptauto/SHOT_E0005_BMP.bmp
+ExtraSprites6 = images/ships/shptauto/SHOT_E0006_BMP.bmp
+ExtraSprites7 = images/ships/shptauto/SHOT_E0007_BMP.bmp
+ExtraSprites8 = images/ships/shptauto/SHOT_E0008_BMP.bmp
+ExtraSprites9 = images/ships/shptauto/SHOT_E0009_BMP.bmp
+ExtraSprites10 = images/ships/shptauto/SHOT_E0010_BMP.bmp
+ExtraSprites11 = images/ships/shptauto/SHOT_E0011_BMP.bmp
+
+ExtraExplosion0 = images/ships/shptauto/SHOT_F00_BMP.bmp

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpthrto.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpthrto.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpthrto.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -6,6 +6,7 @@
 Origin = UQM
 Coders = The Fly
 Code = ThraddashTorch
+Version = 65M
 
 [Ship]
 Crew = 8
@@ -58,3 +59,81 @@
 CaptName14 = Fkank
 CaptName15 = Pdump
 CaptName16 = Whumps
+
+[Music]
+Victory = music/ditty/thrditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpthrto/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpthrto/WAVE_B01_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 1r
+WeaponSamples = 1
+WeaponExplosion = 0
+SpecialSprites = 39 +alpha
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 0
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpthrto/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpthrto/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpthrto/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpthrto/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpthrto/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpthrto/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpthrto/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shpthrto/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shpthrto/SHOT_A01_PCX.bmp
+
+SpecialSprites0 = images/ships/shpthrto/SHOT_B02_PCX.bmp
+SpecialSprites1 = images/ships/shpthrto/SHOT_B03_PCX.bmp
+SpecialSprites2 = images/ships/shpthrto/SHOT_B04_PCX.bmp
+SpecialSprites3 = images/ships/shpthrto/SHOT_B05_PCX.bmp
+SpecialSprites4 = images/ships/shpthrto/SHOT_B06_PCX.bmp
+SpecialSprites5 = images/ships/shpthrto/SHOT_B07_PCX.bmp
+SpecialSprites6 = images/ships/shpthrto/SHOT_B08_PCX.bmp
+SpecialSprites7 = images/ships/shpthrto/SHOT_B09_PCX.bmp
+SpecialSprites8 = images/ships/shpthrto/SHOT_B10_PCX.bmp
+SpecialSprites9 = images/ships/shpthrto/SHOT_B11_PCX.bmp
+SpecialSprites10 = images/ships/shpthrto/SHOT_B12_PCX.bmp
+SpecialSprites11 = images/ships/shpthrto/SHOT_B13_PCX.bmp
+SpecialSprites12 = images/ships/shpthrto/SHOT_B14_PCX.bmp
+SpecialSprites13 = images/ships/shpthrto/SHOT_B15_PCX.bmp
+SpecialSprites14 = images/ships/shpthrto/SHOT_B16_PCX.bmp
+SpecialSprites15 = images/ships/shpthrto/SHOT_B17_PCX.bmp
+SpecialSprites16 = images/ships/shpthrto/SHOT_B18_PCX.bmp
+SpecialSprites17 = images/ships/shpthrto/SHOT_B19_PCX.bmp
+SpecialSprites18 = images/ships/shpthrto/SHOT_B20_PCX.bmp
+SpecialSprites19 = images/ships/shpthrto/SHOT_B21_PCX.bmp
+SpecialSprites20 = images/ships/shpthrto/SHOT_B22_PCX.bmp
+SpecialSprites21 = images/ships/shpthrto/SHOT_B23_PCX.bmp
+SpecialSprites22 = images/ships/shpthrto/SHOT_B24_PCX.bmp
+SpecialSprites23 = images/ships/shpthrto/SHOT_B25_PCX.bmp
+SpecialSprites24 = images/ships/shpthrto/SHOT_B26_PCX.bmp
+SpecialSprites25 = images/ships/shpthrto/SHOT_B27_PCX.bmp
+SpecialSprites26 = images/ships/shpthrto/SHOT_B28_PCX.bmp
+SpecialSprites27 = images/ships/shpthrto/SHOT_B29_PCX.bmp
+SpecialSprites28 = images/ships/shpthrto/SHOT_B30_PCX.bmp
+SpecialSprites29 = images/ships/shpthrto/SHOT_B31_PCX.bmp
+SpecialSprites30 = images/ships/shpthrto/SHOT_B32_PCX.bmp
+SpecialSprites31 = images/ships/shpthrto/SHOT_B33_PCX.bmp
+SpecialSprites32 = images/ships/shpthrto/SHOT_B34_PCX.bmp
+SpecialSprites33 = images/ships/shpthrto/SHOT_B35_PCX.bmp
+SpecialSprites34 = images/ships/shpthrto/SHOT_B36_PCX.bmp
+SpecialSprites35 = images/ships/shpthrto/SHOT_B37_PCX.bmp
+SpecialSprites36 = images/ships/shpthrto/SHOT_B38_PCX.bmp
+SpecialSprites37 = images/ships/shpthrto/SHOT_B39_PCX.bmp
+SpecialSprites38 = images/ships/shpthrto/SHOT_B40_PCX.bmp
+
+
+

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpumgdr.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpumgdr.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpumgdr.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -7,6 +7,7 @@
 Origin = UQM
 Coders = The Fly
 Code = UmgahDrone
+Version = 65M
 
 [Ship]
 Crew = 10
@@ -55,3 +56,44 @@
 CaptName14 = Kterbi'a
 CaptName15 = Chup'he
 CaptName16 = I'buba
+
+[Music]
+Victory = music/ditty/umgditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpumgdr/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpumgdr/WAVE_B01_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 6r +noaa
+WeaponSamples = 1
+WeaponExplosion = 0
+SpecialSprites = 0
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 0
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpumgdr/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpumgdr/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpumgdr/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpumgdr/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpumgdr/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpumgdr/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpumgdr/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shpumgdr/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shpumgdr/SHOT_A01_PCX.bmp
+WeaponSprites1 = images/ships/shpumgdr/SHOT_A02_PCX.bmp
+WeaponSprites2 = images/ships/shpumgdr/SHOT_A03_PCX.bmp
+WeaponSprites3 = images/ships/shpumgdr/SHOT_A04_PCX.bmp
+WeaponSprites4 = images/ships/shpumgdr/SHOT_A05_PCX.bmp
+WeaponSprites5 = images/ships/shpumgdr/SHOT_A06_PCX.bmp
+

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shputwju.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shputwju.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shputwju.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -6,6 +6,7 @@
 Origin = UQM
 Coders = The Fly
 Code = UtwigJugger
+Version = 65M
 
 [Ship]
 Crew = 20
@@ -52,3 +53,39 @@
 CaptName14 = Thory
 CaptName15 = Jujuby
 CaptName16 = Erog
+
+[Music]
+Victory = music/ditty/utwditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shputwju/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shputwju/WAVE_B01_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 1r
+WeaponSamples = 1
+WeaponExplosion = 0
+SpecialSprites = 0
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 0
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shputwju/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shputwju/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shputwju/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shputwju/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shputwju/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shputwju/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shputwju/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shputwju/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shputwju/SHOT_A01_PCX.bmp
+

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpvuxin.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpvuxin.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpvuxin.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -7,6 +7,7 @@
 Origin = UQM
 Coders = The Fly
 Code = VuxIntruder
+Version = 65M
 
 [Ship]
 Crew = 20
@@ -60,3 +61,58 @@
 CaptName14 = ZOG
 CaptName15 = ORZ
 CaptName16 = ZEK
+
+[Music]
+Victory = music/ditty/vuxditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpvuxin/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpvuxin/WAVE_B01_WAV.wav
+SpecialSample1 = sound/ships/shpvuxin/WAVE_B02_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 3r
+WeaponSamples = 1
+WeaponExplosion = 0
+SpecialSprites = 11
+SpecialSamples = 2
+SpecialExplosion = 0
+ExtraSprites = 3r
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpvuxin/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpvuxin/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpvuxin/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpvuxin/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpvuxin/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpvuxin/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpvuxin/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shpvuxin/SHIP_S00_PCX.bmp
+
+WeaponSprites0 = images/ships/shpvuxin/SHOT_000_PCX.bmp
+WeaponSprites1 = images/ships/shpvuxin/SHOT_001_PCX.bmp
+WeaponSprites2 = images/ships/shpvuxin/SHOT_002_PCX.bmp
+
+SpecialSprites0 = images/ships/shpvuxin/SHOT_A01_PCX.bmp
+SpecialSprites1 = images/ships/shpvuxin/SHOT_A02_PCX.bmp
+SpecialSprites2 = images/ships/shpvuxin/SHOT_A03_PCX.bmp
+SpecialSprites3 = images/ships/shpvuxin/SHOT_A04_PCX.bmp
+SpecialSprites4 = images/ships/shpvuxin/SHOT_A05_PCX.bmp
+SpecialSprites5 = images/ships/shpvuxin/SHOT_A06_PCX.bmp
+SpecialSprites6 = images/ships/shpvuxin/SHOT_A07_PCX.bmp
+SpecialSprites7 = images/ships/shpvuxin/SHOT_A08_PCX.bmp
+SpecialSprites8 = images/ships/shpvuxin/SHOT_A09_PCX.bmp
+SpecialSprites9 = images/ships/shpvuxin/SHOT_A10_PCX.bmp
+SpecialSprites10 = images/ships/shpvuxin/SHOT_A11_PCX.bmp
+              
+ExtraSprites0 = images/ships/shpvuxin/SHOT_E00_PCX.bmp
+ExtraSprites1 = images/ships/shpvuxin/SHOT_E01_PCX.bmp
+ExtraSprites2 = images/ships/shpvuxin/SHOT_E02_PCS.bmp
+

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpyehte.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpyehte.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpyehte.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -7,6 +7,7 @@
 Origin = UQM
 Coders = The Fly
 Code = YehatTerminator
+Version = 65M
 
 [Ship]
 Crew = 20
@@ -56,3 +57,40 @@
 CaptName14 = Geep-eep
 CaptName15 = Zeep-eep
 CaptName16 = Neep-eep
+
+[Music]
+Victory = music/ditty/yehditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpyehte/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpyehte/WAVE_B01_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 1r
+WeaponSamples = 1
+WeaponExplosion = 0
+SpecialSprites = 1r
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 0
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpyehte/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpyehte/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpyehte/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpyehte/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpyehte/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpyehte/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpyehte/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shpyehte/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shpyehte/SHOT_A00_BMP.bmp
+
+SpecialSprites0 = images/ships/shpyehte/SHOT_B01_PCX.bmp

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpzeksh.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpzeksh.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpzeksh.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -5,6 +5,7 @@
 Origin = TW
 Coders = Richardyzo
 Code = ZekfahanShocker
+Version = 65M
 
 [Ship]
 Crew = 42
@@ -35,3 +36,52 @@
 Damage = 4
 Armour = 99
 Frames = 2550
+
+[Music]
+Victory = music/ditty/vuxditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpzeksh/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpzeksh/WAVE_B01_WAV.wav
+SpecialSample1 = sound/ships/shpzeksh/WAVE_B02_WAV.wav
+SpecialSample2 = sound/ships/shpzeksh/WAVE_B03_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 5
+WeaponSamples = 1
+WeaponExplosion = 0
+SpecialSprites = 6
+SpecialSamples = 3
+SpecialExplosion = 0
+ExtraSprites = 0
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpzeksh/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpzeksh/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpzeksh/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpzeksh/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpzeksh/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpzeksh/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpzeksh/SHIP_P06_PCX.bmp
+
+
+ShipSprites0 = images/ships/shpzeksh/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shpzeksh/SHOT_A01_PCX.bmp
+WeaponSprites1 = images/ships/shpzeksh/SHOT_A02_PCX.bmp
+WeaponSprites2 = images/ships/shpzeksh/SHOT_A03_PCX.bmp
+WeaponSprites3 = images/ships/shpzeksh/SHOT_A04_PCX.bmp
+WeaponSprites4 = images/ships/shpzeksh/SHOT_A05_PCX.bmp
+
+
+SpecialSprites0 = images/ships/shpzeksh/SHOT_B01_PCX.bmp
+SpecialSprites1 = images/ships/shpzeksh/SHOT_B02_PCX.bmp
+SpecialSprites2 = images/ships/shpzeksh/SHOT_B03_PCX.bmp
+SpecialSprites3 = images/ships/shpzeksh/SHOT_B04_PCX.bmp
+SpecialSprites4 = images/ships/shpzeksh/SHOT_B05_PCX.bmp
+SpecialSprites5 = images/ships/shpzeksh/SHOT_B06_PCX.bmp

Modified: branches/multiplayer-branch/gamedata/default_ini/ships/shpzfpst.ini
===================================================================
--- branches/multiplayer-branch/gamedata/default_ini/ships/shpzfpst.ini	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/default_ini/ships/shpzfpst.ini	2004-09-28 19:53:03 UTC (rev 71)
@@ -6,6 +6,7 @@
 Origin = UQM
 Coders = The Fly
 Code = ZoqFotPikStinger
+Version = 65M
 
 [Ship]
 Crew = 10
@@ -33,7 +34,7 @@
 [Special]
 Damage = 12		;4
 Licking = 0		;1
-; 0 makes it use &quot;flat&quot; damage
+; = 0 makes it use &quot;flat&quot; damage
 
 [AI3_Default]
 Tactic = Direct
@@ -60,3 +61,50 @@
 CaptName14 = TikTok
 CaptName15 = MikMok
 CaptName16 = SikSok
+
+[Music]
+Victory = music/ditty/zoqditty.mod
+
+[Sound]
+WeaponSample0 = sound/ships/shpzfpst/WAVE_A01_WAV.wav
+
+SpecialSample0 = sound/ships/shpzfpst/WAVE_B01_WAV.wav
+
+[Objects]
+ShipSprites = 1r
+WeaponSprites = 6
+WeaponSamples = 1
+WeaponExplosion = 0
+SpecialSprites = 6r
+SpecialSamples = 1
+SpecialExplosion = 0
+ExtraSprites = 0
+ExtraSamples = 0
+ExtraExplosion = 0
+PanelBitmaps = 7
+
+[Graphic]
+PanelBitmaps0 = images/ships/shpzfpst/SHIP_P00_PCX.bmp
+PanelBitmaps1 = images/ships/shpzfpst/SHIP_P01_PCX.bmp
+PanelBitmaps2 = images/ships/shpzfpst/SHIP_P02_PCX.bmp
+PanelBitmaps3 = images/ships/shpzfpst/SHIP_P03_PCX.bmp
+PanelBitmaps4 = images/ships/shpzfpst/SHIP_P04_PCX.bmp
+PanelBitmaps5 = images/ships/shpzfpst/SHIP_P05_PCX.bmp
+PanelBitmaps6 = images/ships/shpzfpst/SHIP_P06_PCX.bmp
+
+ShipSprites0 = images/ships/shpzfpst/SHIP_S01_PCX.bmp
+
+WeaponSprites0 = images/ships/shpzfpst/SHOT_A01_PCX.bmp
+WeaponSprites1 = images/ships/shpzfpst/SHOT_A02_PCX.bmp
+WeaponSprites2 = images/ships/shpzfpst/SHOT_A03_PCX.bmp
+WeaponSprites3 = images/ships/shpzfpst/SHOT_A04_PCX.bmp
+WeaponSprites4 = images/ships/shpzfpst/SHOT_A05_PCX.bmp
+WeaponSprites5 = images/ships/shpzfpst/SHOT_A06_PCX.bmp
+
+SpecialSprites0 = images/ships/shpzfpst/SHOT_B01_PCX.bmp
+SpecialSprites1 = images/ships/shpzfpst/SHOT_B02_PCX.bmp
+SpecialSprites2 = images/ships/shpzfpst/SHOT_B03_PCX.bmp
+SpecialSprites3 = images/ships/shpzfpst/SHOT_B04_PCX.bmp
+SpecialSprites4 = images/ships/shpzfpst/SHOT_B05_PCX.bmp
+SpecialSprites5 = images/ships/shpzfpst/SHOT_B06_PCX.bmp
+

Copied: branches/multiplayer-branch/gamedata/gob.dat (from rev 69, trunk/gamedata/gob.dat)


Property changes on: branches/multiplayer-branch/gamedata/gob.dat
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Copied: branches/multiplayer-branch/gamedata/images/bspab.jpg (from rev 69, trunk/gamedata/images/bspab.jpg)


Property changes on: branches/multiplayer-branch/gamedata/images/bspab.jpg
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Deleted: branches/multiplayer-branch/gamedata/images/logo.bmp
===================================================================
(Binary files differ)

Copied: branches/multiplayer-branch/gamedata/images/ships (from rev 69, trunk/gamedata/images/ships)

Copied: branches/multiplayer-branch/gamedata/images/stangrop.jpg (from rev 69, trunk/gamedata/images/stangrop.jpg)


Property changes on: branches/multiplayer-branch/gamedata/images/stangrop.jpg
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Modified: branches/multiplayer-branch/gamedata/ingame.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ingame.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ingame.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,98 +1,113 @@
 Global keys:
-        F1 brings up the help screen
-        F2 brings up the options menu
-        F3 switches camera focus
-        F4 is fast-forward (speeds up in-game time greatly)
-        F5 displays fleet status
-        F7 changes game tic rate (physics quality)
-        F8 changes camera mode
-        F10 quits (so does ESCAPE)
-        F11 saves screenshots
-        F12 displays framerates / performance data
-        - zooms out on some viewing modes.
-        + (or =) zooms in on some viewing modes.
-        0 and 9 also effect the camera in some viewing modes.
-        ctrl+T = toggle team indicators on/off
-        ctrl+H = toggle healthbar indicators on/off
+  F1 brings up the help screen
+  F2 brings up the options menu
+  F3 switches camera focus
+  F4 is fast-forward (speeds up in-game time greatly)
+  F5 displays fleet status
+  F7 changes game tic rate (physics quality)
+  F8 changes camera mode
+  F10 quits (so does ESCAPE)
+  F11 saves screenshots
+  F12 displays framerates / performance data
+  - zooms out on some viewing modes.
+  + (or =) zooms in on some viewing modes.
+  0 and 9 also effect the camera in some viewing modes.
+  ctrl+T = toggle team indicators on/off
+  ctrl+H = toggle healthbar indicators on/off
 
 Melee:  
+  Starts a battle with the current team settings.
 
-	Starts a battle with the current team settings.
-
 Extras Menu:
 
-	Play Game:
-               Select different gametypes.  For this version, only Melee is available.
-	Key Tester:
-               Use this utility to check keys combination for conflicts.
-	Show License:
-		Shows the license of this program.
-	Ship Info:
-		Here you can get detail information about every 
-             ship in the game.  Disabled in this release, sorry!
-	Diagnostic:
-                Show comlile options and version information. 
-	Main Menu:
-                This returns to the main menu.
-		
+  Play Game:
+    Select different gametypes.  Currently:
+    1) Melee - simple starfleet combat
+    2) GOB - Game goals:
+              Avoid dieing.  
+              Try to get as bad-ass a ship as you can.  
+              Kill lots of enemies.
 
+       If you survive for long enough and accumulate 
+       enough wealth, you will eventually be able to 
+       purchase the &quot;Hyper Dynamo&quot; upgrade.  Once you
+       get that, you can basically consider yourself 
+       to have won the game. Try to win Gob with as 
+       many different ships as you can.  
+
+    3) Defender - protect starbase as long as you can
+
+  Key Tester:
+    Use this utility to check keys combination for conflicts.
+  Show License:
+    Shows the license of this program.
+  Ship Info:
+    Here you can get detail information about every 
+    ship in the game.  
+  Diagnostic:
+    Show comlile options and version information. 
+  Main Menu:
+    This returns to the main menu.	
+
 Teams:
 
-        Select Controller:
-                Select the player (i.e. &quot;Player 1&quot; or &quot;Player 2&quot;)
-              you wish to alter from the list on the left, and
-              the controller (i.e. &quot;Keyboard&quot;, &quot;MoronBot&quot;) you
-              want to control that player from the list on the
-              left.  Then either click on the &quot;Select
-              Controller&quot; button or double click on the
-              controller name.
-	Change Team #: 
-	        This switches the player allys. 
-	      Note that team 0 mean no allys.
-        Change Config #:
-                 This switches the configuration used by the
-               currently highlighted controller.  
-        Edit Configuration:
-                 This is used to setup up keys when the currently
-               highlighted player is using the keyboard.  It
-               may eventually allow the configuration of AIs
-               and calibration of joysticks.
-        Edit Fleet:
-                 This button brings up the fleet selection menu for
-               the currently highlighted player.  
-        Main Menu:
-                 This returns to the main menu.
+  Select Controller:
+    Select the player (i.e. &quot;Player 1&quot; or &quot;Player 2&quot;)
+    you wish to alter from the list on the left, and
+    the controller (i.e. &quot;Keyboard&quot;, &quot;MoronBot&quot;) you
+    want to control that player from the list on the
+    left.  Then either click on the &quot;Select
+    Controller&quot; button or double click on the
+    controller name.
+  Change Team #: 
+    This switches the player allys. 
+    Note that team 0 mean no allys.
+  Change Config #:
+    This switches the configuration used by the
+    currently highlighted controller.  
+  Edit Configuration:
+    This is used to setup up keys when the currently
+    highlighted player is using the keyboard.  It
+    may eventually allow the configuration of AIs
+    and calibration of joysticks.
+  Edit Fleet:
+    This button brings up the fleet selection menu for
+    the currently highlighted player.  
+  Main Menu:
+    This returns to the main menu.
 
 Options:
 
-        Most things on this menu are self-explanatory, but a few
-          need special mention.
+  Most things on this menu are self-explanatory, but a few
+  need special mention.
 
-        Gamma correction:
-                This makes things brighter during combat.  This
-                  should not be changed from the middle of combat,
-                  or colors could get weird.  
-        Antialiasing:
-                If this box is checked then TimeWarp will use
-                  higher quality graphics, but run slower.  
-        Color Depth:
-                You cannot change this from the middle of combat.  
-        Camera Mode:
-                This allows you to control what is shown on your
-                  screen in combat.  
+  Gamma correction:
+    This makes things brighter during combat.  This
+    should not be changed from the middle of combat,
+    or colors could get weird.  
+  Antialiasing:
+    If this box is checked then TimeWarp will use
+    higher quality graphics, but run slower.  
+  Color Depth:
+    You cannot change this from the middle of combat.  
+  Camera Mode:
+    This allows you to control what is shown on your
+    screen in combat.  
 
-                &quot;Enemy_Discrete&quot;
-                  is just like Star Control on the PC, where
-                  the camera moved to keep both you and your
-                  enemy onscreen, and zoomed in by factors of
-                  2.
-                &quot;Enemy&quot;
-                  is like Star Control on the Genesis or 3DO,
-                  where the camera zoomed in smoothly.
-                &quot;Hero&quot;
-                  makes the camera stay focused on Player 1,
-                  and zoom in/out when + and - are pressed.
-                &quot;Everything&quot;
-                  makes the camera stay on the planet and zoom
-                  way out so that everything is visible.  This
-                  mode is slightly buggy (visual artifacts).  
+    &quot;Enemy_Discrete&quot;
+       is just like Star Control on the PC, where
+       the camera moved to keep both you and your
+       enemy onscreen, and zoomed in by factors of 2.
+
+     &quot;Enemy&quot;
+       is like Star Control on the Genesis or 3DO,
+       where the camera zoomed in smoothly.
+
+     &quot;Hero&quot;
+       makes the camera stay focused on Player 1,
+       and zoom in/out when + and - are pressed.
+
+     &quot;Everything&quot;
+       makes the camera stay on the planet and zoom
+       way out so that everything is visible.  This
+       mode is slightly buggy (visual artifacts).  

Copied: branches/multiplayer-branch/gamedata/music/ditty (from rev 69, trunk/gamedata/music/ditty)

Modified: branches/multiplayer-branch/gamedata/readme.html
===================================================================
--- branches/multiplayer-branch/gamedata/readme.html	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/readme.html	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,218 +1,54 @@
-&lt;html&gt;
-&lt;head&gt;
-    &lt;title&gt;TW-Light Readme&lt;/title&gt;
-&lt;/head&gt;
-&lt;body&gt;
-
-&lt;h1&gt;TW-Light Readme&lt;/h1&gt;
-
-&lt;h2&gt;Overview: What is TW-Light?&lt;/h2&gt;
-
+&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
+&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html;charset=iso-8859-1&quot;&gt;
+&lt;title&gt;TW-Light: TW-Light&lt;/title&gt;
+&lt;link href=&quot;doxygen.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;
+&lt;/head&gt;&lt;body&gt;
+&lt;!-- Generated by Doxygen 1.3.8 --&gt;
+&lt;h1&gt;TW-Light &lt;/h1&gt;
 &lt;p&gt;
-TW-Light is lightweighted version of Star Control: TimeWarp.
-Currently it includes only a combat portion with the best TW ships but 
-without network support. There are some plans to expand it to include an 
-epic adventure.
-&lt;/p&gt;
-
-&lt;h2&gt;Getting Started&lt;/h2&gt;
-
-&lt;p&gt;
-&lt;pre&gt;
-Melee:  Starts a battle.  In battle the following keys do stuff:
-        F1 brings up the help screen (this file, at the moment)
-        F2 brings up the options menu
-        F3 switches camera focus
-        F4 is fast-forward (speeds up in-game time greatly)
-        F5 displays fleet status
-        F7 changes game tic rate (physics quality)
-        F8 changes camera mode
-        F9 creates planets (silly &quot;feature&quot;)
-        F10 quits (so does ESCAPE)
-        F11 saves screenshots
-        F12 displays framerates / performance data
-        - zooms out on some viewing modes.
-        + (or =) zooms in on some viewing modes.
-        0 and 9 also effect the camera in some viewing modes.
-        ctrl+T = toggle team indicators on/off
-        ctrl+H = toggle healthbar indicators on/off
-        Also, if some controllers are set to keyboard, customizable
-        buttons may cause ship actions.  Be default these are:
-        Config 0:
-                left:   Keypad 4
-                thrust: Keypad 8
-                right:  Keypad 6
-                fire:   Quote (&quot;)
-                special:Semicolon (;)
-                next:   Closebrace (])
-                prev:   Openbrace ([)
-                near:   P
-        Config 1:
-                left:   A
-                thrust: S
-                right:  D
-                fire:   B
-                special:V
-                next:   F
-                prev:   G
-                near:   H
-Extended Menu:
-	Play Game:
-               Same as &quot;Melee&quot; now
-	Key Tester:
-               Use this utility to check keys combination for conflicts.
-	Ship Info:
-		Here you can get detail information about every 
-             ship in the game.
-	Diagnostic:
-                Show comlile options and version information. 
-	Main Menu:
-                This returns to the main menu.
-		
-Teams:
-        Select Controller:
-                Select the player (i.e. &quot;Player 1&quot; or &quot;Player 2&quot;)
-              you wish to alter from the list on the left, and
-              the controller (i.e. &quot;Keyboard&quot;, &quot;MoronBot&quot;) you
-              want to control that player from the list on the
-              left.  Then either click on the &quot;Select
-              Controller&quot; button or double click on the
-              controller name.
-	Change Team #: 
-	        This switches the player allys. 
-	      Note that team 0 mean no allys.
-        Change Config #:
-                 This switches the configuration used by the
-               currently highlighted controller.  
-        Edit Configuration:
-                 This is used to setup up keys when the currently
-               highlighted player is using the keyboard.  It
-               may eventually allow the configuration of AIs
-               and calibration of joysticks.
-        Edit Fleet:
-                 This button brings up the fleet selection menu for
-               the currently highlighted player.  
-        Main Menu:
-                 This returns to the main menu.
-Options:
-        Most things on this menu are self-explanatory, but a few
-          need special mention.
-
-        Gamma correction:
-                This makes things brighter during combat.  This
-                  should not be changed from the middle of combat,
-                  or colors could get weird.  
-        Antialiasing:
-                If this box is checked then TimeWarp will use
-                  higher quality graphics, but run slower.  
-        Color Depth:
-                You cannot change this from the middle of combat.  
-        Camera Mode:
-                This allows you to control what is shown on your
-                  screen in combat.  
-
-                &quot;Enemy_Discrete&quot;
-                  is just like Star Control on the PC, where
-                  the camera moved to keep both you and your
-                  enemy onscreen, and zoomed in by factors of
-                  2.
-                &quot;Enemy&quot;
-                  is like Star Control on the Genesis or 3DO,
-                  where the camera zoomed in smoothly.
-                &quot;Hero&quot;
-                  makes the camera stay focused on Player 1,
-                  and zoom in/out when + and - are pressed.
-                &quot;Everything&quot;
-                  makes the camera stay on the planet and zoom
-                  way out so that everything is visible.  This
-                  mode is slightly buggy (visual artifacts).  
-&lt;/pre&gt;
-&lt;/p&gt;
-
-&lt;h2&gt;Development&lt;/h2&gt;
-&lt;p&gt;
-  &lt;ul&gt;
-	&lt;li&gt;Introduce the most interesting and cool TimeWarp ships&lt;/li&gt;
-	&lt;li&gt;Simplify and fix melee engine&lt;/li&gt;
-	&lt;li&gt;Add TimeWarp Markup Language (TML) support&lt;/li&gt;
-	&lt;li&gt;Write plot&lt;/li&gt;
-	&lt;li&gt;Implement plot with TML&lt;/li&gt;
-  &lt;/ul&gt;
-&lt;/p&gt;
-
-&lt;h4&gt;Introduce the most interesting and cool TimeWarp ships&lt;/h4&gt;
-&lt;p&gt;
-Currently TW-Light includes the following ships:&lt;br&gt;
+&lt;h3 align=&quot;center&quot;&gt;0.3b69 &lt;/h3&gt;&lt;h2&gt;&lt;a class=&quot;anchor&quot; name=&quot;overview_sec&quot;&gt;
+Overview: What is TW-Light?&lt;/a&gt;&lt;/h2&gt;
+TW-Light is an open source clone/sequel to the epic cross-genre game Star Control II. Currently it includes only a combat portion, although epic adventure part that is called TW:Legacies is actively developed now.&lt;h2&gt;&lt;a class=&quot;anchor&quot; name=&quot;getting_started_sec&quot;&gt;
+Getting Started&lt;/a&gt;&lt;/h2&gt;
 &lt;ul&gt;
-	&lt;li&gt;Alary Battlecruiser&lt;/li&gt;
-	&lt;li&gt;Bipole Katamaran&lt;/li&gt;
-	&lt;li&gt;The Chorali Extractor&lt;/li&gt;
-	&lt;li&gt;Confed Cargotran&lt;/li&gt;
-	&lt;li&gt;Confederation Hornet&lt;/li&gt;
-	&lt;li&gt;Djinni Lancer&lt;/li&gt;
-	&lt;li&gt;Drax Griffon&lt;/li&gt;
-	&lt;li&gt;Earthling Crusader MK2&lt;/li&gt;
-	&lt;li&gt;Earthling Crusader MK3&lt;/li&gt;
-	&lt;li&gt;Zekfahan Shocker&lt;/li&gt;
-	&lt;li&gt;Garash Tyrant&lt;/li&gt;
-	&lt;li&gt;Hydrovar&lt;/li&gt;
-	&lt;li&gt;Ilwrath Spider&lt;/li&gt;
-	&lt;li&gt;Kahr Boomerang&lt;/li&gt;
-	&lt;li&gt;Re-Koj Assassin&lt;/li&gt;
-	&lt;li&gt;Rogue Squadron&lt;/li&gt;
-	&lt;li&gt;Tau Archon&lt;/li&gt;
-	&lt;li&gt;Tau Dagger&lt;/li&gt;
-	&lt;li&gt;Tau Slider&lt;/li&gt;
-	&lt;li&gt;Tau Torrent&lt;/li&gt;
-	&lt;li&gt;Zekfahan Shocker&lt;/li&gt;
-&lt;/ul&gt;
-&lt;/p&gt;
-
-&lt;h4&gt;Simplify and fix melee engine&lt;/h4&gt;
+&lt;li&gt;Melee: Starts a battle. In battle the following keys do stuff:&lt;ul&gt;
+&lt;li&gt;F1 brings up the help screen (this file, at the moment)&lt;/li&gt;&lt;li&gt;F2 brings up the options menu&lt;/li&gt;&lt;li&gt;F3 switches camera focus&lt;/li&gt;&lt;li&gt;F4 is fast-forward (speeds up in-game time greatly)&lt;/li&gt;&lt;li&gt;F5 displays fleet status&lt;/li&gt;&lt;li&gt;F7 changes game tic rate (physics quality)&lt;/li&gt;&lt;li&gt;F8 changes camera mode&lt;/li&gt;&lt;li&gt;F9 creates planets (silly &quot;feature&quot;)&lt;/li&gt;&lt;li&gt;F10 quits (so does ESCAPE)&lt;/li&gt;&lt;li&gt;F11 saves screenshots&lt;/li&gt;&lt;li&gt;F12 displays framerates / performance data&lt;/li&gt;&lt;li&gt;- zooms out on some viewing modes.&lt;/li&gt;&lt;li&gt;+ (or =) zooms in on some viewing modes.&lt;/li&gt;&lt;li&gt;0 also effect the camera in some viewing modes.&lt;/li&gt;&lt;li&gt;ctrl+T = toggle team indicators on/off&lt;/li&gt;&lt;li&gt;ctrl+H = toggle healthbar indicators on/off&lt;/li&gt;&lt;li&gt;Also, if some controllers are set to keyboard, customizable&lt;/li&gt;&lt;li&gt;buttons may cause ship actions. Be default these are:&lt;/li&gt;&lt;li&gt;Config 0:&lt;ul&gt;
+&lt;li&gt;left: Keypad 4&lt;/li&gt;&lt;li&gt;thrust: Keypad 8&lt;/li&gt;&lt;li&gt;right: Keypad 6&lt;/li&gt;&lt;li&gt;fire: Enter&lt;/li&gt;&lt;li&gt;special:Ctrl&lt;/li&gt;&lt;li&gt;next: Closebrace (])&lt;/li&gt;&lt;li&gt;prev: Openbrace ([)&lt;/li&gt;&lt;li&gt;near: P&lt;/li&gt;&lt;/ul&gt;
+&lt;/li&gt;&lt;/ul&gt;
+&lt;/li&gt;&lt;/ul&gt;
 &lt;p&gt;
-  We are working on it.
-&lt;/p&gt;
-
-&lt;h4&gt;Add TimeWarp Markup Language (TML) support&lt;/h4&gt;
+See ingame help for controls description.&lt;h2&gt;&lt;a class=&quot;anchor&quot; name=&quot;development&quot;&gt;
+Development&lt;/a&gt;&lt;/h2&gt;
+Full developer documentation can be produced using doxygen tool.&lt;p&gt;
+Following documents describes some of the issues concerning contributing to TW-Light&lt;ul&gt;
+&lt;li&gt;&lt;a class=&quot;el&quot; href=&quot;coding_page.html&quot;&gt;A guide to a few of the wierder issues with programming for TW-Light.&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a class=&quot;el&quot; href=&quot;howto_document.html&quot;&gt;Document your code&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;
 &lt;p&gt;
-  No progress.
-&lt;/p&gt;
-
-&lt;h4&gt;Write plot&lt;/h4&gt;
-&lt;p&gt;
-  No progress.
-&lt;/p&gt;
-
-&lt;h4&gt;Implement plot with TML&lt;/h4&gt;
-&lt;p&gt;
-  No progress.
-&lt;/p&gt;
-
-&lt;h2&gt;License&lt;/h2&gt;
-
-&lt;p&gt;
-  Copyright (C) 2004 &lt;a href=mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/tw-light-svn">yurand at land.ru</A>&gt;Yura Semashko aka Yurand&lt;/a&gt;&lt;br&gt;
-  Copyright (C) 2001-2004  TimeWarp development team&lt;br&gt;
-&lt;br&gt;
-  This program is free software; you can redistribute it and/or modify &lt;br&gt;
-  it under the terms of the GNU General Public License as published by &lt;br&gt;
-  the Free Software Foundation; either version 2 of the License, or    &lt;br&gt;
-  (at your option) any later version. &lt;br&gt;
-                                          &lt;br&gt;
-  This program is distributed in the hope that it will be useful,&lt;br&gt;
-  but WITHOUT ANY WARRANTY; without even the implied warranty of&lt;br&gt;
-  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&lt;br&gt;
-  GNU General Public License for more details.
-&lt;/p&gt;
-
-&lt;h2&gt;Credits&lt;/h2&gt;
-&lt;pre&gt;
-
-  TW-Light is derivative work from &lt;a href=&quot;<A HREF="http://timewarp.sf.net/">http://timewarp.sf.net/</A>&quot;&gt;Star Control: TimeWarp&lt;/a&gt;
-
-&lt;/pre&gt;
-
-
-&lt;/div&gt;
+Currently we are working on the following tasks:&lt;p&gt;
+&lt;ul&gt;
+&lt;li&gt;Introduce the most interesting and cool TimeWarp ships&lt;/li&gt;&lt;li&gt;Simplify and fix melee engine&lt;/li&gt;&lt;li&gt;Add TimeWarp Markup Language (TML) support&lt;/li&gt;&lt;li&gt;Write plot&lt;/li&gt;&lt;li&gt;Implement plot with TML&lt;/li&gt;&lt;/ul&gt;
+&lt;h3&gt;&lt;a class=&quot;anchor&quot; name=&quot;intoro&quot;&gt;
+Introduce the most interesting and cool TimeWarp ships&lt;/a&gt;&lt;/h3&gt;
+Currently TW-Light includes the following ships:&lt;p&gt;
+&lt;ul&gt;
+&lt;li&gt;Alary Battlecruiser&lt;/li&gt;&lt;li&gt;Bipole Katamaran&lt;/li&gt;&lt;li&gt;The Chorali Extractor&lt;/li&gt;&lt;li&gt;Confed Cargotran&lt;/li&gt;&lt;li&gt;Confederation Hornet&lt;/li&gt;&lt;li&gt;Drax Griffon&lt;/li&gt;&lt;li&gt;Earthling Crusader MK3&lt;/li&gt;&lt;li&gt;Zekfahan Shocker&lt;/li&gt;&lt;li&gt;Garash Tyrant&lt;/li&gt;&lt;li&gt;Ilwrath Spider&lt;/li&gt;&lt;li&gt;Kahr Boomerang&lt;/li&gt;&lt;li&gt;Re-Koj Assassin&lt;/li&gt;&lt;li&gt;Rogue Squadron&lt;/li&gt;&lt;li&gt;Tau Archon&lt;/li&gt;&lt;li&gt;Tau Dagger&lt;/li&gt;&lt;li&gt;Tau Slider&lt;/li&gt;&lt;li&gt;Tau Torrent&lt;/li&gt;&lt;li&gt;Zekfahan Shocker&lt;/li&gt;&lt;/ul&gt;
+&lt;h3&gt;&lt;a class=&quot;anchor&quot; name=&quot;simplyfy_subsec&quot;&gt;
+Simplify and fix melee engine&lt;/a&gt;&lt;/h3&gt;
+Almost done.&lt;h3&gt;&lt;a class=&quot;anchor&quot; name=&quot;TML_subsec&quot;&gt;
+Add TimeWarp Markup Language (TML) support&lt;/a&gt;&lt;/h3&gt;
+No progress.&lt;h3&gt;&lt;a class=&quot;anchor&quot; name=&quot;plot_subsec&quot;&gt;
+Write plot&lt;/a&gt;&lt;/h3&gt;
+The Plot is fully writen.&lt;h3&gt;&lt;a class=&quot;anchor&quot; name=&quot;plot_impl_subsec&quot;&gt;
+Implement plot with TML&lt;/a&gt;&lt;/h3&gt;
+No progress.&lt;h2&gt;&lt;a class=&quot;anchor&quot; name=&quot;licene_sec&quot;&gt;
+License&lt;/a&gt;&lt;/h2&gt;
+Copyright (C) 2004 &lt;a href=&quot;mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/tw-light-svn">yurand at land.ru</A>&quot;&gt;Yura Semashko aka Yurand&lt;/a&gt; Copyright (C) 2001-2004 TimeWarp development team&lt;p&gt;
+This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.&lt;p&gt;
+This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.&lt;h2&gt;&lt;a class=&quot;anchor&quot; name=&quot;credits_sec&quot;&gt;
+Credits&lt;/a&gt;&lt;/h2&gt;
+&lt;ul&gt;
+&lt;li&gt;TW-Light is derivative work from &lt;a href=&quot;timewarp.sourceforge.net&quot;&gt;Star Control: TimeWarp&lt;/a&gt;&lt;/li&gt;&lt;li&gt;Some code and documents were taken from &lt;a href=&quot;www.wesnoth.org&quot;&gt;Battle for Wesnoth&lt;/a&gt;&lt;/li&gt;&lt;li&gt;UQM Ships description were taken from Ultronomicon (&lt;a href=&quot;<A HREF="http://uqm.stack.nl/wiki/">http://uqm.stack.nl/wiki/</A>&quot;&gt;<A HREF="http://uqm.stack.nl/wiki/&lt;/a">http://uqm.stack.nl/wiki/&lt;/a</A>&gt;)&lt;/li&gt;&lt;li&gt;Some battle music were written by Robeter Productions Inc. &lt;/li&gt;&lt;/ul&gt;
+&lt;hr size=&quot;1&quot;&gt;&lt;address style=&quot;align: right;&quot;&gt;&lt;small&gt;Generated on Mon Sep 27 22:11:45 2004 for TW-Light by
+&lt;a href=&quot;<A HREF="http://www.doxygen.org/index.html">http://www.doxygen.org/index.html</A>&quot;&gt;
+&lt;img src=&quot;doxygen.png&quot; alt=&quot;doxygen&quot; align=&quot;middle&quot; border=0 &gt;&lt;/a&gt; 1.3.8 &lt;/small&gt;&lt;/address&gt;
 &lt;/body&gt;
-&lt;/head&gt;
+&lt;/html&gt;

Modified: branches/multiplayer-branch/gamedata/ships/COPYING.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/COPYING.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/COPYING.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,369 +1,370 @@
-
-    Some contents data files may contain content from The Ur-Quan Masters project.
-    Used by permission from Toys For Bob.  The UQM license appears below.
-
-----------------------------------------------------------------------------
-    The Ur-Quan Masters
-    Copyright (C) 1992, 2002 Toys for Bob, Inc.
-
-    This program is free software; you can redistribute it and/or modify
-    it under the terms of the GNU General Public License as published by
-    the Free Software Foundation; either version 2 of the License, or
-    (at your option) any later version.
-
-    This program is distributed in the hope that it will be entertaining,
-    but WITHOUT ANY WARRANTY; without even the implied warranty of
-    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-    GNU General Public License for more details.  A copy of the
-    General Public License is included at the end of this document.
-
-    The content -- voiceovers, dialogue, graphics, and music -- are
-    copyright (C) 1992, 1993, 2002 Toys for Bob, Inc. or their
-    respective creators.  The content may be copied freely as part of
-    a distribution of The Ur-Quan Masters.  All other rights are reserved.
-
-    (Side Note: The content will become more freely redistributable
-     and reusable in later releases.)
-
-----------------------------------------------------------------------------
-
-		    GNU GENERAL PUBLIC LICENSE
-		       Version 2, June 1991
-
- Copyright (C) 1989, 1991 Free Software Foundation, Inc.
-     59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
- Everyone is permitted to copy and distribute verbatim copies
- of this license document, but changing it is not allowed.
-
-			    Preamble
-
-  The licenses for most software are designed to take away your
-freedom to share and change it.  By contrast, the GNU General Public
-License is intended to guarantee your freedom to share and change free
-software--to make sure the software is free for all its users.  This
-General Public License applies to most of the Free Software
-Foundation's software and to any other program whose authors commit to
-using it.  (Some other Free Software Foundation software is covered by
-the GNU Library General Public License instead.)  You can apply it to
-your programs, too.
-
-  When we speak of free software, we are referring to freedom, not
-price.  Our General Public Licenses are designed to make sure that you
-have the freedom to distribute copies of free software (and charge for
-this service if you wish), that you receive source code or can get it
-if you want it, that you can change the software or use pieces of it
-in new free programs; and that you know you can do these things.
-
-  To protect your rights, we need to make restrictions that forbid
-anyone to deny you these rights or to ask you to surrender the rights.
-These restrictions translate to certain responsibilities for you if you
-distribute copies of the software, or if you modify it.
-
-  For example, if you distribute copies of such a program, whether
-gratis or for a fee, you must give the recipients all the rights that
-you have.  You must make sure that they, too, receive or can get the
-source code.  And you must show them these terms so they know their
-rights.
-
-  We protect your rights with two steps: (1) copyright the software, and
-(2) offer you this license which gives you legal permission to copy,
-distribute and/or modify the software.
-
-  Also, for each author's protection and ours, we want to make certain
-that everyone understands that there is no warranty for this free
-software.  If the software is modified by someone else and passed on, we
-want its recipients to know that what they have is not the original, so
-that any problems introduced by others will not reflect on the original
-authors' reputations.
-
-  Finally, any free program is threatened constantly by software
-patents.  We wish to avoid the danger that redistributors of a free
-program will individually obtain patent licenses, in effect making the
-program proprietary.  To prevent this, we have made it clear that any
-patent must be licensed for everyone's free use or not licensed at all.
-
-  The precise terms and conditions for copying, distribution and
-modification follow.
-
-		    GNU GENERAL PUBLIC LICENSE
-   TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION
-
-  0. This License applies to any program or other work which contains
-a notice placed by the copyright holder saying it may be distributed
-under the terms of this General Public License.  The &quot;Program&quot;, below,
-refers to any such program or work, and a &quot;work based on the Program&quot;
-means either the Program or any derivative work under copyright law:
-that is to say, a work containing the Program or a portion of it,
-either verbatim or with modifications and/or translated into another
-language.  (Hereinafter, translation is included without limitation in
-the term &quot;modification&quot;.)  Each licensee is addressed as &quot;you&quot;.
-
-Activities other than copying, distribution and modification are not
-covered by this License; they are outside its scope.  The act of
-running the Program is not restricted, and the output from the Program
-is covered only if its contents constitute a work based on the
-Program (independent of having been made by running the Program).
-Whether that is true depends on what the Program does.
-
-  1. You may copy and distribute verbatim copies of the Program's
-source code as you receive it, in any medium, provided that you
-conspicuously and appropriately publish on each copy an appropriate
-copyright notice and disclaimer of warranty; keep intact all the
-notices that refer to this License and to the absence of any warranty;
-and give any other recipients of the Program a copy of this License
-along with the Program.
-
-You may charge a fee for the physical act of transferring a copy, and
-you may at your option offer warranty protection in exchange for a fee.
-
-  2. You may modify your copy or copies of the Program or any portion
-of it, thus forming a work based on the Program, and copy and
-distribute such modifications or work under the terms of Section 1
-above, provided that you also meet all of these conditions:
-
-    a) You must cause the modified files to carry prominent notices
-    stating that you changed the files and the date of any change.
-
-    b) You must cause any work that you distribute or publish, that in
-    whole or in part contains or is derived from the Program or any
-    part thereof, to be licensed as a whole at no charge to all third
-    parties under the terms of this License.
-
-    c) If the modified program normally reads commands interactively
-    when run, you must cause it, when started running for such
-    interactive use in the most ordinary way, to print or display an
-    announcement including an appropriate copyright notice and a
-    notice that there is no warranty (or else, saying that you provide
-    a warranty) and that users may redistribute the program under
-    these conditions, and telling the user how to view a copy of this
-    License.  (Exception: if the Program itself is interactive but
-    does not normally print such an announcement, your work based on
-    the Program is not required to print an announcement.)
-
-These requirements apply to the modified work as a whole.  If
-identifiable sections of that work are not derived from the Program,
-and can be reasonably considered independent and separate works in
-themselves, then this License, and its terms, do not apply to those
-sections when you distribute them as separate works.  But when you
-distribute the same sections as part of a whole which is a work based
-on the Program, the distribution of the whole must be on the terms of
-this License, whose permissions for other licensees extend to the
-entire whole, and thus to each and every part regardless of who wrote it.
-
-Thus, it is not the intent of this section to claim rights or contest
-your rights to work written entirely by you; rather, the intent is to
-exercise the right to control the distribution of derivative or
-collective works based on the Program.
-
-In addition, mere aggregation of another work not based on the Program
-with the Program (or with a work based on the Program) on a volume of
-a storage or distribution medium does not bring the other work under
-the scope of this License.
-
-  3. You may copy and distribute the Program (or a work based on it,
-under Section 2) in object code or executable form under the terms of
-Sections 1 and 2 above provided that you also do one of the following:
-
-    a) Accompany it with the complete corresponding machine-readable
-    source code, which must be distributed under the terms of Sections
-    1 and 2 above on a medium customarily used for software interchange; or,
-
-    b) Accompany it with a written offer, valid for at least three
-    years, to give any third party, for a charge no more than your
-    cost of physically performing source distribution, a complete
-    machine-readable copy of the corresponding source code, to be
-    distributed under the terms of Sections 1 and 2 above on a medium
-    customarily used for software interchange; or,
-
-    c) Accompany it with the information you received as to the offer
-    to distribute corresponding source code.  (This alternative is
-    allowed only for noncommercial distribution and only if you
-    received the program in object code or executable form with such
-    an offer, in accord with Subsection b above.)
-
-The source code for a work means the preferred form of the work for
-making modifications to it.  For an executable work, complete source
-code means all the source code for all modules it contains, plus any
-associated interface definition files, plus the scripts used to
-control compilation and installation of the executable.  However, as a
-special exception, the source code distributed need not include
-anything that is normally distributed (in either source or binary
-form) with the major components (compiler, kernel, and so on) of the
-operating system on which the executable runs, unless that component
-itself accompanies the executable.
-
-If distribution of executable or object code is made by offering
-access to copy from a designated place, then offering equivalent
-access to copy the source code from the same place counts as
-distribution of the source code, even though third parties are not
-compelled to copy the source along with the object code.
-
-  4. You may not copy, modify, sublicense, or distribute the Program
-except as expressly provided under this License.  Any attempt
-otherwise to copy, modify, sublicense or distribute the Program is
-void, and will automatically terminate your rights under this License.
-However, parties who have received copies, or rights, from you under
-this License will not have their licenses terminated so long as such
-parties remain in full compliance.
-
-  5. You are not required to accept this License, since you have not
-signed it.  However, nothing else grants you permission to modify or
-distribute the Program or its derivative works.  These actions are
-prohibited by law if you do not accept this License.  Therefore, by
-modifying or distributing the Program (or any work based on the
-Program), you indicate your acceptance of this License to do so, and
-all its terms and conditions for copying, distributing or modifying
-the Program or works based on it.
-
-  6. Each time you redistribute the Program (or any work based on the
-Program), the recipient automatically receives a license from the
-original licensor to copy, distribute or modify the Program subject to
-these terms and conditions.  You may not impose any further
-restrictions on the recipients' exercise of the rights granted herein.
-You are not responsible for enforcing compliance by third parties to
-this License.
-
-  7. If, as a consequence of a court judgment or allegation of patent
-infringement or for any other reason (not limited to patent issues),
-conditions are imposed on you (whether by court order, agreement or
-otherwise) that contradict the conditions of this License, they do not
-excuse you from the conditions of this License.  If you cannot
-distribute so as to satisfy simultaneously your obligations under this
-License and any other pertinent obligations, then as a consequence you
-may not distribute the Program at all.  For example, if a patent
-license would not permit royalty-free redistribution of the Program by
-all those who receive copies directly or indirectly through you, then
-the only way you could satisfy both it and this License would be to
-refrain entirely from distribution of the Program.
-
-If any portion of this section is held invalid or unenforceable under
-any particular circumstance, the balance of the section is intended to
-apply and the section as a whole is intended to apply in other
-circumstances.
-
-It is not the purpose of this section to induce you to infringe any
-patents or other property right claims or to contest validity of any
-such claims; this section has the sole purpose of protecting the
-integrity of the free software distribution system, which is
-implemented by public license practices.  Many people have made
-generous contributions to the wide range of software distributed
-through that system in reliance on consistent application of that
-system; it is up to the author/donor to decide if he or she is willing
-to distribute software through any other system and a licensee cannot
-impose that choice.
-
-This section is intended to make thoroughly clear what is believed to
-be a consequence of the rest of this License.
-
-  8. If the distribution and/or use of the Program is restricted in
-certain countries either by patents or by copyrighted interfaces, the
-original copyright holder who places the Program under this License
-may add an explicit geographical distribution limitation excluding
-those countries, so that distribution is permitted only in or among
-countries not thus excluded.  In such case, this License incorporates
-the limitation as if written in the body of this License.
-
-  9. The Free Software Foundation may publish revised and/or new versions
-of the General Public License from time to time.  Such new versions will
-be similar in spirit to the present version, but may differ in detail to
-address new problems or concerns.
-
-Each version is given a distinguishing version number.  If the Program
-specifies a version number of this License which applies to it and &quot;any
-later version&quot;, you have the option of following the terms and conditions
-either of that version or of any later version published by the Free
-Software Foundation.  If the Program does not specify a version number of
-this License, you may choose any version ever published by the Free Software
-Foundation.
-
-  10. If you wish to incorporate parts of the Program into other free
-programs whose distribution conditions are different, write to the author
-to ask for permission.  For software which is copyrighted by the Free
-Software Foundation, write to the Free Software Foundation; we sometimes
-make exceptions for this.  Our decision will be guided by the two goals
-of preserving the free status of all derivatives of our free software and
-of promoting the sharing and reuse of software generally.
-
-			    NO WARRANTY
-
-  11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY
-FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN
-OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES
-PROVIDE THE PROGRAM &quot;AS IS&quot; WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED
-OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
-MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS
-TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE
-PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,
-REPAIR OR CORRECTION.
-
-  12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
-WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR
-REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,
-INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING
-OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED
-TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY
-YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER
-PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE
-POSSIBILITY OF SUCH DAMAGES.
-
-		     END OF TERMS AND CONDITIONS
-
-	    How to Apply These Terms to Your New Programs
-
-  If you develop a new program, and you want it to be of the greatest
-possible use to the public, the best way to achieve this is to make it
-free software which everyone can redistribute and change under these terms.
-
-  To do so, attach the following notices to the program.  It is safest
-to attach them to the start of each source file to most effectively
-convey the exclusion of warranty; and each file should have at least
-the &quot;copyright&quot; line and a pointer to where the full notice is found.
-
-    &lt;one line to give the program's name and a brief idea of what it does.&gt;
-    Copyright (C) &lt;year&gt;  &lt;name of author&gt;
-
-    This program is free software; you can redistribute it and/or modify
-    it under the terms of the GNU General Public License as published by
-    the Free Software Foundation; either version 2 of the License, or
-    (at your option) any later version.
-
-    This program is distributed in the hope that it will be useful,
-    but WITHOUT ANY WARRANTY; without even the implied warranty of
-    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-    GNU General Public License for more details.
-
-    You should have received a copy of the GNU General Public License
-    along with this program; if not, write to the Free Software
-    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-
-
-Also add information on how to contact you by electronic and paper mail.
-
-If the program is interactive, make it output a short notice like this
-when it starts in an interactive mode:
-
-    Gnomovision version 69, Copyright (C) year  name of author
-    Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
-    This is free software, and you are welcome to redistribute it
-    under certain conditions; type `show c' for details.
-
-The hypothetical commands `show w' and `show c' should show the appropriate
-parts of the General Public License.  Of course, the commands you use may
-be called something other than `show w' and `show c'; they could even be
-mouse-clicks or menu items--whatever suits your program.
-
-You should also get your employer (if you work as a programmer) or your
-school, if any, to sign a &quot;copyright disclaimer&quot; for the program, if
-necessary.  Here is a sample; alter the names:
-
-  Yoyodyne, Inc., hereby disclaims all copyright interest in the program
-  `Gnomovision' (which makes passes at compilers) written by James Hacker.
-
-  &lt;signature of Ty Coon&gt;, 1 April 1989
-  Ty Coon, President of Vice
-
-This General Public License does not permit incorporating your program into
-proprietary programs.  If your program is a subroutine library, you may
-consider it more useful to permit linking proprietary applications with the
-library.  If this is what you want to do, use the GNU Library General
-Public License instead of this License.
+    Some contents text files may contain content from Ultronomicon (<A HREF="http://uqm.stack.nl/wiki/">http://uqm.stack.nl/wiki/</A>)
+    
+    Some contents data files may contain content from The Ur-Quan Masters project.
+    Used by permission from Toys For Bob.  The UQM license appears below.
+
+----------------------------------------------------------------------------
+    The Ur-Quan Masters
+    Copyright (C) 1992, 2002 Toys for Bob, Inc.
+
+    This program is free software; you can redistribute it and/or modify
+    it under the terms of the GNU General Public License as published by
+    the Free Software Foundation; either version 2 of the License, or
+    (at your option) any later version.
+
+    This program is distributed in the hope that it will be entertaining,
+    but WITHOUT ANY WARRANTY; without even the implied warranty of
+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+    GNU General Public License for more details.  A copy of the
+    General Public License is included at the end of this document.
+
+    The content -- voiceovers, dialogue, graphics, and music -- are
+    copyright (C) 1992, 1993, 2002 Toys for Bob, Inc. or their
+    respective creators.  The content may be copied freely as part of
+    a distribution of The Ur-Quan Masters.  All other rights are reserved.
+
+    (Side Note: The content will become more freely redistributable
+     and reusable in later releases.)
+
+----------------------------------------------------------------------------
+
+		    GNU GENERAL PUBLIC LICENSE
+		       Version 2, June 1991
+
+ Copyright (C) 1989, 1991 Free Software Foundation, Inc.
+     59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+ Everyone is permitted to copy and distribute verbatim copies
+ of this license document, but changing it is not allowed.
+
+			    Preamble
+
+  The licenses for most software are designed to take away your
+freedom to share and change it.  By contrast, the GNU General Public
+License is intended to guarantee your freedom to share and change free
+software--to make sure the software is free for all its users.  This
+General Public License applies to most of the Free Software
+Foundation's software and to any other program whose authors commit to
+using it.  (Some other Free Software Foundation software is covered by
+the GNU Library General Public License instead.)  You can apply it to
+your programs, too.
+
+  When we speak of free software, we are referring to freedom, not
+price.  Our General Public Licenses are designed to make sure that you
+have the freedom to distribute copies of free software (and charge for
+this service if you wish), that you receive source code or can get it
+if you want it, that you can change the software or use pieces of it
+in new free programs; and that you know you can do these things.
+
+  To protect your rights, we need to make restrictions that forbid
+anyone to deny you these rights or to ask you to surrender the rights.
+These restrictions translate to certain responsibilities for you if you
+distribute copies of the software, or if you modify it.
+
+  For example, if you distribute copies of such a program, whether
+gratis or for a fee, you must give the recipients all the rights that
+you have.  You must make sure that they, too, receive or can get the
+source code.  And you must show them these terms so they know their
+rights.
+
+  We protect your rights with two steps: (1) copyright the software, and
+(2) offer you this license which gives you legal permission to copy,
+distribute and/or modify the software.
+
+  Also, for each author's protection and ours, we want to make certain
+that everyone understands that there is no warranty for this free
+software.  If the software is modified by someone else and passed on, we
+want its recipients to know that what they have is not the original, so
+that any problems introduced by others will not reflect on the original
+authors' reputations.
+
+  Finally, any free program is threatened constantly by software
+patents.  We wish to avoid the danger that redistributors of a free
+program will individually obtain patent licenses, in effect making the
+program proprietary.  To prevent this, we have made it clear that any
+patent must be licensed for everyone's free use or not licensed at all.
+
+  The precise terms and conditions for copying, distribution and
+modification follow.
+
+		    GNU GENERAL PUBLIC LICENSE
+   TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION
+
+  0. This License applies to any program or other work which contains
+a notice placed by the copyright holder saying it may be distributed
+under the terms of this General Public License.  The &quot;Program&quot;, below,
+refers to any such program or work, and a &quot;work based on the Program&quot;
+means either the Program or any derivative work under copyright law:
+that is to say, a work containing the Program or a portion of it,
+either verbatim or with modifications and/or translated into another
+language.  (Hereinafter, translation is included without limitation in
+the term &quot;modification&quot;.)  Each licensee is addressed as &quot;you&quot;.
+
+Activities other than copying, distribution and modification are not
+covered by this License; they are outside its scope.  The act of
+running the Program is not restricted, and the output from the Program
+is covered only if its contents constitute a work based on the
+Program (independent of having been made by running the Program).
+Whether that is true depends on what the Program does.
+
+  1. You may copy and distribute verbatim copies of the Program's
+source code as you receive it, in any medium, provided that you
+conspicuously and appropriately publish on each copy an appropriate
+copyright notice and disclaimer of warranty; keep intact all the
+notices that refer to this License and to the absence of any warranty;
+and give any other recipients of the Program a copy of this License
+along with the Program.
+
+You may charge a fee for the physical act of transferring a copy, and
+you may at your option offer warranty protection in exchange for a fee.
+
+  2. You may modify your copy or copies of the Program or any portion
+of it, thus forming a work based on the Program, and copy and
+distribute such modifications or work under the terms of Section 1
+above, provided that you also meet all of these conditions:
+
+    a) You must cause the modified files to carry prominent notices
+    stating that you changed the files and the date of any change.
+
+    b) You must cause any work that you distribute or publish, that in
+    whole or in part contains or is derived from the Program or any
+    part thereof, to be licensed as a whole at no charge to all third
+    parties under the terms of this License.
+
+    c) If the modified program normally reads commands interactively
+    when run, you must cause it, when started running for such
+    interactive use in the most ordinary way, to print or display an
+    announcement including an appropriate copyright notice and a
+    notice that there is no warranty (or else, saying that you provide
+    a warranty) and that users may redistribute the program under
+    these conditions, and telling the user how to view a copy of this
+    License.  (Exception: if the Program itself is interactive but
+    does not normally print such an announcement, your work based on
+    the Program is not required to print an announcement.)
+
+These requirements apply to the modified work as a whole.  If
+identifiable sections of that work are not derived from the Program,
+and can be reasonably considered independent and separate works in
+themselves, then this License, and its terms, do not apply to those
+sections when you distribute them as separate works.  But when you
+distribute the same sections as part of a whole which is a work based
+on the Program, the distribution of the whole must be on the terms of
+this License, whose permissions for other licensees extend to the
+entire whole, and thus to each and every part regardless of who wrote it.
+
+Thus, it is not the intent of this section to claim rights or contest
+your rights to work written entirely by you; rather, the intent is to
+exercise the right to control the distribution of derivative or
+collective works based on the Program.
+
+In addition, mere aggregation of another work not based on the Program
+with the Program (or with a work based on the Program) on a volume of
+a storage or distribution medium does not bring the other work under
+the scope of this License.
+
+  3. You may copy and distribute the Program (or a work based on it,
+under Section 2) in object code or executable form under the terms of
+Sections 1 and 2 above provided that you also do one of the following:
+
+    a) Accompany it with the complete corresponding machine-readable
+    source code, which must be distributed under the terms of Sections
+    1 and 2 above on a medium customarily used for software interchange; or,
+
+    b) Accompany it with a written offer, valid for at least three
+    years, to give any third party, for a charge no more than your
+    cost of physically performing source distribution, a complete
+    machine-readable copy of the corresponding source code, to be
+    distributed under the terms of Sections 1 and 2 above on a medium
+    customarily used for software interchange; or,
+
+    c) Accompany it with the information you received as to the offer
+    to distribute corresponding source code.  (This alternative is
+    allowed only for noncommercial distribution and only if you
+    received the program in object code or executable form with such
+    an offer, in accord with Subsection b above.)
+
+The source code for a work means the preferred form of the work for
+making modifications to it.  For an executable work, complete source
+code means all the source code for all modules it contains, plus any
+associated interface definition files, plus the scripts used to
+control compilation and installation of the executable.  However, as a
+special exception, the source code distributed need not include
+anything that is normally distributed (in either source or binary
+form) with the major components (compiler, kernel, and so on) of the
+operating system on which the executable runs, unless that component
+itself accompanies the executable.
+
+If distribution of executable or object code is made by offering
+access to copy from a designated place, then offering equivalent
+access to copy the source code from the same place counts as
+distribution of the source code, even though third parties are not
+compelled to copy the source along with the object code.
+
+  4. You may not copy, modify, sublicense, or distribute the Program
+except as expressly provided under this License.  Any attempt
+otherwise to copy, modify, sublicense or distribute the Program is
+void, and will automatically terminate your rights under this License.
+However, parties who have received copies, or rights, from you under
+this License will not have their licenses terminated so long as such
+parties remain in full compliance.
+
+  5. You are not required to accept this License, since you have not
+signed it.  However, nothing else grants you permission to modify or
+distribute the Program or its derivative works.  These actions are
+prohibited by law if you do not accept this License.  Therefore, by
+modifying or distributing the Program (or any work based on the
+Program), you indicate your acceptance of this License to do so, and
+all its terms and conditions for copying, distributing or modifying
+the Program or works based on it.
+
+  6. Each time you redistribute the Program (or any work based on the
+Program), the recipient automatically receives a license from the
+original licensor to copy, distribute or modify the Program subject to
+these terms and conditions.  You may not impose any further
+restrictions on the recipients' exercise of the rights granted herein.
+You are not responsible for enforcing compliance by third parties to
+this License.
+
+  7. If, as a consequence of a court judgment or allegation of patent
+infringement or for any other reason (not limited to patent issues),
+conditions are imposed on you (whether by court order, agreement or
+otherwise) that contradict the conditions of this License, they do not
+excuse you from the conditions of this License.  If you cannot
+distribute so as to satisfy simultaneously your obligations under this
+License and any other pertinent obligations, then as a consequence you
+may not distribute the Program at all.  For example, if a patent
+license would not permit royalty-free redistribution of the Program by
+all those who receive copies directly or indirectly through you, then
+the only way you could satisfy both it and this License would be to
+refrain entirely from distribution of the Program.
+
+If any portion of this section is held invalid or unenforceable under
+any particular circumstance, the balance of the section is intended to
+apply and the section as a whole is intended to apply in other
+circumstances.
+
+It is not the purpose of this section to induce you to infringe any
+patents or other property right claims or to contest validity of any
+such claims; this section has the sole purpose of protecting the
+integrity of the free software distribution system, which is
+implemented by public license practices.  Many people have made
+generous contributions to the wide range of software distributed
+through that system in reliance on consistent application of that
+system; it is up to the author/donor to decide if he or she is willing
+to distribute software through any other system and a licensee cannot
+impose that choice.
+
+This section is intended to make thoroughly clear what is believed to
+be a consequence of the rest of this License.
+
+  8. If the distribution and/or use of the Program is restricted in
+certain countries either by patents or by copyrighted interfaces, the
+original copyright holder who places the Program under this License
+may add an explicit geographical distribution limitation excluding
+those countries, so that distribution is permitted only in or among
+countries not thus excluded.  In such case, this License incorporates
+the limitation as if written in the body of this License.
+
+  9. The Free Software Foundation may publish revised and/or new versions
+of the General Public License from time to time.  Such new versions will
+be similar in spirit to the present version, but may differ in detail to
+address new problems or concerns.
+
+Each version is given a distinguishing version number.  If the Program
+specifies a version number of this License which applies to it and &quot;any
+later version&quot;, you have the option of following the terms and conditions
+either of that version or of any later version published by the Free
+Software Foundation.  If the Program does not specify a version number of
+this License, you may choose any version ever published by the Free Software
+Foundation.
+
+  10. If you wish to incorporate parts of the Program into other free
+programs whose distribution conditions are different, write to the author
+to ask for permission.  For software which is copyrighted by the Free
+Software Foundation, write to the Free Software Foundation; we sometimes
+make exceptions for this.  Our decision will be guided by the two goals
+of preserving the free status of all derivatives of our free software and
+of promoting the sharing and reuse of software generally.
+
+			    NO WARRANTY
+
+  11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY
+FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN
+OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES
+PROVIDE THE PROGRAM &quot;AS IS&quot; WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED
+OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
+MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS
+TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE
+PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,
+REPAIR OR CORRECTION.
+
+  12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
+WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR
+REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,
+INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING
+OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED
+TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY
+YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER
+PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE
+POSSIBILITY OF SUCH DAMAGES.
+
+		     END OF TERMS AND CONDITIONS
+
+	    How to Apply These Terms to Your New Programs
+
+  If you develop a new program, and you want it to be of the greatest
+possible use to the public, the best way to achieve this is to make it
+free software which everyone can redistribute and change under these terms.
+
+  To do so, attach the following notices to the program.  It is safest
+to attach them to the start of each source file to most effectively
+convey the exclusion of warranty; and each file should have at least
+the &quot;copyright&quot; line and a pointer to where the full notice is found.
+
+    &lt;one line to give the program's name and a brief idea of what it does.&gt;
+    Copyright (C) &lt;year&gt;  &lt;name of author&gt;
+
+    This program is free software; you can redistribute it and/or modify
+    it under the terms of the GNU General Public License as published by
+    the Free Software Foundation; either version 2 of the License, or
+    (at your option) any later version.
+
+    This program is distributed in the hope that it will be useful,
+    but WITHOUT ANY WARRANTY; without even the implied warranty of
+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+    GNU General Public License for more details.
+
+    You should have received a copy of the GNU General Public License
+    along with this program; if not, write to the Free Software
+    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+
+
+Also add information on how to contact you by electronic and paper mail.
+
+If the program is interactive, make it output a short notice like this
+when it starts in an interactive mode:
+
+    Gnomovision version 69, Copyright (C) year  name of author
+    Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
+    This is free software, and you are welcome to redistribute it
+    under certain conditions; type `show c' for details.
+
+The hypothetical commands `show w' and `show c' should show the appropriate
+parts of the General Public License.  Of course, the commands you use may
+be called something other than `show w' and `show c'; they could even be
+mouse-clicks or menu items--whatever suits your program.
+
+You should also get your employer (if you work as a programmer) or your
+school, if any, to sign a &quot;copyright disclaimer&quot; for the program, if
+necessary.  Here is a sample; alter the names:
+
+  Yoyodyne, Inc., hereby disclaims all copyright interest in the program
+  `Gnomovision' (which makes passes at compilers) written by James Hacker.
+
+  &lt;signature of Ty Coon&gt;, 1 April 1989
+  Ty Coon, President of Vice
+
+This General Public License does not permit incorporating your program into
+proprietary programs.  If your program is a subroutine library, you may
+consider it more useful to permit linking proprietary applications with the
+library.  If this is what you want to do, use the GNU Library General
+Public License instead of this License.

Deleted: branches/multiplayer-branch/gamedata/ships/shpalabc.dat
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/gamedata/ships/shpalabc.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/shpalabc.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/shpalabc.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,50 +1,39 @@
-Alary Battlecruiser (v.2.3)
-===========================
-
-Weapon:
--------
-Heavy &quot;fire and forget&quot; MIRV torpedo. The torpedo is extremely slow though
-(even warheads have lower-than-average velocity).
-
-Note: Torpedo itself will not do damage on collisions (only launched warheads will). 
-
-Turrets:
---------
-Press &quot;special&quot; to turn them on or off (look in the upper-right corner
-of the &quot;captain screen&quot; to see current state). When on, turrets will
-automatically shoot on possible targets in range. Priority list is
-(descending): your target, any enemy ship, non-damaging things,
-heavy shots.
-
-Note: Turrets can be damaged (disabled).
-
-Engines:
---------
-
-Note: Engines can be damaged, crippling an already slow ship.
-
-Shield:
--------
-Automatic absorbance shield can block most of the incoming damage.
-Does not work when/if overloaded by continuous heavy fire.
-The shield status indicator is located in the upper-left corner
-of the &quot;captain screen&quot;
-
-Note: Shield does cover turrets and engines.
-
-
-Quirk #1:
----------
-Damage (even direct) cut in half (to make this ship really tough
-without going over 42 crew (for aesthetic reasons)).
-
-Quirk #2:
----------
-&quot;Slow death&quot; (beware of turret fire).
-
-
------------------------------------
-*Tau* &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/tw-light-svn">twships at tau137.com</A>&gt;
-
-
-Last updated on 31 Jan 2003.
+Alary Battlecruiser (v.2.3)
+===========================
+
+Weapon:
+-------
+Heavy &quot;fire and forget&quot; MIRV torpedo. The torpedo is extremely slow though (even warheads have lower-than-average velocity).
+
+Note: Torpedo itself will not do damage on collisions (only launched warheads will). 
+
+Turrets:
+--------
+Press &quot;special&quot; to turn them on or off (look in the upper-right corner of the &quot;captain screen&quot; to see current state). When on, turrets will automatically shoot on possible targets in range. Priority list is (descending): your target, any enemy ship, non-damaging things, heavy shots.
+
+Note: Turrets can be damaged (disabled).
+
+Engines:
+--------
+
+Note: Engines can be damaged, crippling an already slow ship.
+
+Shield:
+-------
+Automatic absorbance shield can block most of the incoming damage. Does not work when/if overloaded by continuous heavy fire. The shield status indicator is located in the upper-left corner of the &quot;captain screen&quot;
+
+Note: Shield does cover turrets and engines.
+
+
+Quirk #1:
+---------
+Damage (even direct) cut in half (to make this ship really tough without going over 42 crew (for aesthetic reasons)). 
+
+Quirk #2:
+---------
+&quot;Slow death&quot; (beware of turret fire).
+
+
+-----------------------------------
+*Tau* &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/tw-light-svn">twships at tau137.com</A>&gt;
+

Deleted: branches/multiplayer-branch/gamedata/ships/shpandgu.dat
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/gamedata/ships/shpandgu.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/shpandgu.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/shpandgu.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,27 +1,3 @@
-The Androsynth Guardian is one of the original ships
-from Star Control 1.  They were on the Hierarchy side.  
+The Androsynth Guardians main weapon fires acid bubbles that slowly home in on enemies using the Chaos(tm) tracking system.  
 
-The Androsynth Guardians main weapon fires acid
-bubbles that slowly home in on enemies using the
-Chaos(tm) tracking system.  
-
-It's special weapon transforms it into a flaming comet,
-which is extremely fast and maneuverable, and inflicts
-damage upon impact.  
-
-
-Androsynth are modified humans.  They have numbers in
-their names, and are frequently clones, and are
-heavily genetically modified.  They have a history of
-being oppressed by the rest of humankind, and hate
-humans as a result.  Androsynth seem to be much more
-technologically advanced than normal humans.  
-
-In Star Control 2, the Androsynth were apparently dead
-before the game started ; their homeworld showed signs
-of some horrific struggle, strongly reminiscent of the
-writtings of science fiction / horror author Howard
-Philips Lovecraft III.
-The implication is that all Androsynch were killed (or
-worse) by the Orz or some race related to the Orz.  
-
+It's special weapon transforms it into a flaming comet, which is extremely fast and maneuverable, and inflicts damage upon impact.  
\ No newline at end of file

Deleted: branches/multiplayer-branch/gamedata/ships/shparisk.dat
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/gamedata/ships/shparisk.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/shparisk.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/shparisk.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,28 +1,50 @@
-The Arilou Skiff is one of the original ships from
-Star Control 1.  They were on the Alliance side.  
+Overview
 
-The Arilou Skiffs main weapon is a short range
-auto-aiming laser.  
+After the discovery of relativity by German-American physicist Albert Einstein in the early 20th century, Terran scientists were disappointed to discover that conventional physics cannot allow normal objects to travel faster than light in TrueSpace. Even after the discoveries of FTL (faster-than-light) technology and HyperSpace travel (thanks to the aid of the Chenjesu), they again encountered a second stumbling block on the limit of power produced by an engine. &quot;If only we could control inertia...,&quot; the scientists complained again and again. Enter the Arilou Lalee'lay Skiff.
 
-It's special weapon is a short range hyperspace shunt
-(random teleport).
+Utilized mainly as a means of conveyance in TrueSpace and piloted by the pacifistic Arilou, the blue saucer-shaped Skiff is designed mainly for exploratory missions and boasts minimal defensive weaponry, but it has one envious quality: an inertialess drive.
 
-Arilou ships are extremely maneuverable, and contain
-advanced inertialess drives that stop the ship instantly
-when it stops thrusting.  
 
-Discrepancy: In SC1 &amp; SC2, Arilou Skiffs always auto-aimed
-straight towards their enemy if they had one, otherwise
-straight.  In TimeWarp, where there can be multiple
-enemies, it auto-aims at the closest enemy if one is close,
-or fires straight forward otherwise.  
+Speed and control
 
-Arilou look like little classic aliens: little green men.  
+When not travelling at FTL speeds, the Skiff flies, or rather glides, through TrueSpace at extremely fast speeds (though not as quickly as the nimble Spathi Eluder, nee Discriminator, or Pkunk Fury). Its inertialess drive gives it the smallest turning radius in the galaxy -- 0 m! -- and of course the turning rate itself can't be beat. No inertia also means instant acceleration (and deceleration), as well as no gravitational effects from planetary objects or anything else for that matter! Surprisingly enough, the helm contains no physical controls at all; the captain telepathically controls the ship, thus requiring only a skeleton crew to operate it!
 
-In Star Control 2, the Arilou were mysterious and aloof
-creatures that has been stalking humanity for centuries, 
-and maybe have been involved in the origin of the human
-race.  They expressed special dislike for the Orz.  They
-and the Orz were the two races in SC2 that came from other
-dimensions.  
 
+Armament
+
+Primary
+
+The Skiff's main and only true weapon is a ventral 360-degree short range auto-aiming laser. Meant to simply deter prowlers and pirates from seiging the ship and to surgically cease the roamings of stray space debris, it can be used as an offensive weapon with limited results. Damage is minimal and technique and timing are crucial. Two of the major drawbacks of the targeting system are that:
+
+1. it only tracks the ion trails from warp-drive capable exhaust systems thereby neglecting smaller craft such as Ur-Quan slave ships or Orz marines.
+2. it has a discrete firing pattern, limiting the direction in which it can fire. 
+
+Particular skillful captains are able to minimize the shortcomings of the limited weaponry with carefully-timed firing and cunning tactics.
+
+Secondary
+
+Utilizing the power of the inertialess drive, the secondary armament is a short-range HyperSpace shunt transportation device allowing instantaneous teleportation. While extremely useful in making a quick exit from a heated sortie, the range is limited once again to a single yet significant factor. Range is determined using fourth-dimensional QuasiSpatial movement, which is heavily distorted by FTL sub-spatial harmonics, particularly near starship warp drives. Thus Skiffs hardly have the ability to attempt a long-range teleportation when even a FTL-capable ship as small as a Umgah Drone is nearby. Additionally, the shunt is nearly impossible to guide due to the relatively minute range (on a galactic scale) that the Skiff is able to teleport when such an object is close by. Because of this, undesirable results often occur and, in the small chance of materializing inside of a planetary object or even another ship, can prove to be fatal. However, such catastrophic occurences ar!
 e still extremely rare.
+
+
+Layout and design
+
+Due to the telepathic nature of the Arilou, few conventional devices other than a hull that can withstand TrueSpace and a weak laser are needed to produce the shell of the Skiff. However, the building and implementation of the inertialess drive and the HyperSpace shunt teleporter are beyond current human techonology, not to mention finding a superlative telepathic crew of midgets who can bond to the ship's internal systems. Still, the hull of the Skiff is as simple as it gets: tall enough for a 1.5-meter tall person; and perfectly round for uniform psionic harmonics; and blue -- very, very blue... oh, and headlights. The guts... well, that's a little bit tougher to explain.
+
+Miscellaneous
+
+Tactics
+
+Due to the difficulty in winning a dogfight through brute-force, Arilou captains have been forced to take more clever methods of vanquishing foes. The following are three of the most commonly used methods.
+
+* Gun and run 
+
+Agility and speed are the two strongest attributes of the Skiff. Why not exploit them? Heading directly into enemy fire can be advatangeous given the opponent's barrage is slow enough and the Skiff's captain is nimble enough. Once close enough to the enemy ship, even the directionally-challenged auto-aiming laser can do its job without missing. Leave enough fuel for a quick jump, and &gt;poof&lt; the Skiff is out of harm's way! 
+
+* Planetary ambush 
+
+With no inertia, the Skiff is the only vehicle entirely immune to gravitational effects from nearby planets even when it's sitting right next to it! Letting the bloodlust overcome an adversary's judgment, the perceptive Arilou captain can capitalize on such egregious foolhardiness. Sitting on the far side of the planet as the enemy ship approaces, the opponent cannot both aim accurately and guide his ship to safe course (with some exceptions, eg. the Supox). Seizing such opportunities nets maximal damage to the opponent as he slingshots past the ambushing Skiff without ever having the ability to fire a single shot at the clever Arilou! 
+
+* Cyborg shimmy 
+
+With the reactions of a well-timed computer, an expert Skiff captain can sometimes approach an enemy vessel in a direction that it can't even fire! This feint requires split-second timing at the helm that no human could possibly match! It's even more devastating for the ship captain who can't quite catch his Arilou Lalee'lay opponent off-guard! 
+

Deleted: branches/multiplayer-branch/gamedata/ships/shpbahbu.dat
===================================================================
(Binary files differ)

Deleted: branches/multiplayer-branch/gamedata/ships/shpbipka.dat
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/gamedata/ships/shpbipka.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/shpbipka.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/shpbipka.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,17 +1,14 @@
-Bipole Katamaran
-
-For a stone-like race. Maybe Taalo...
-
-Primary Weapon:
-  Both sideships have a simple projectile cannon.
-  
-Special:
-  Increases the distance between the sideships (if both exist) or accelerates
-  backwards (if only one of them exists).
-
-Notes:
-  This ship is made up of two 'sideships' each of which can survive the
-  destruction of the other. Their crew and battery is kept track of independently
-  but is shown on the panel summed.
-
- * created by: <A HREF="https://lists.berlios.de/mailman/listinfo/tw-light-svn">cyhawk at sch.bme.hu</A> and <A HREF="https://lists.berlios.de/mailman/listinfo/tw-light-svn">forevian at freemail.hu</A>
+Bipole Katamaran
+
+For a stone-like race. Maybe Taalo...
+
+Primary Weapon:
+  Both sideships have a simple projectile cannon.
+  
+Special:
+  Increases the distance between the sideships (if both exist) or accelerates backwards (if only one of them exists).
+
+Notes:
+  This ship is made up of two 'sideships' each of which can survive the destruction of the other. Their crew and battery is kept track of independently but is shown on the panel summed.
+
+ * created by: <A HREF="https://lists.berlios.de/mailman/listinfo/tw-light-svn">cyhawk at sch.bme.hu</A> and <A HREF="https://lists.berlios.de/mailman/listinfo/tw-light-svn">forevian at freemail.hu</A>

Deleted: branches/multiplayer-branch/gamedata/ships/shpchebr.dat
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/gamedata/ships/shpchebr.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/shpchebr.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/shpchebr.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,18 +1,8 @@
-The Chenjesu Broodhome is one of the original ships
-from Star Control 1.  They were on the Alliance side.
-They were the most powerfull and wise member of the
-Alliance.  
+The Chenjesu Broodhome main weapon fires crystals that keep traveling until you lift the fire button, when they explode into many small fragments.  
 
-The Chenjesu Broodhome main weapon fires crystals
-that keep traveling until you lift the fire button,
-when they explode into many small fragments.  
+It's special weapon launches DOGIs that seek the Chenjesu's target and drain their battery.  
 
-It's special weapon launches DOGIs that seek the
-Chenjesu's target and drain their battery.  
-
 Chenjesu are a crystaline life form.  
 
-In Star Control 2, the Chenjesu were imprisoned on
-their homeworld with the Mmrnmhrmm before the game
-started, slowly transforming into Chmmr.  
+In Star Control 2, the Chenjesu were imprisoned on their homeworld with the Mmrnmhrmm before the game started, slowly transforming into Chmmr.  
 

Deleted: branches/multiplayer-branch/gamedata/ships/shpchmav.dat
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/gamedata/ships/shpchmav.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/shpchmav.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/shpchmav.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,18 +1,9 @@
-The Chmmr Avatar is one of the original ships
-from Star Control 2.
-
 The ship's main weapon consists of an uberlaser.
 
-Three defense satellites circle the ship. Each is
-equipped with a short-range auto-targeting laser.
+Three defense satellites circle the ship. Each is equipped with a short-range auto-targeting laser.
 
 The special is a tractor beam with unlimited range.
 
-The Chmmr are a race born of two races, the Chenjesu 
-and the Mrmnmhrm, in an attempt to save the latter from 
-extinction.  The Chmmr are immensely powerful, hyper-
-intelligent, and possibly somewhat schizophenic.  
+The Chmmr are a race born of two races, the Chenjesu and the Mrmnmhrm, in an attempt to save the latter from extinction.  The Chmmr are immensely powerful, hyper-intelligent, and possibly somewhat schizophenic.  
 
-The Chmmr were slave-shielded by the Ur-Quan, but 
-when set free provided a valuable contribution to
-the fight for freedom.
\ No newline at end of file
+The Chmmr were slave-shielded by the Ur-Quan, but when set free provided a valuable contribution to the fight for freedom.
\ No newline at end of file

Deleted: branches/multiplayer-branch/gamedata/ships/shpchoex.dat
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/gamedata/ships/shpchoex.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/shpchoex.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/shpchoex.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,30 +1,30 @@
-The Chorali Extractor
-CrewMax        = 10
-BattMax        = 20
-SpeedMax       = 40
-AccelRate      = 10
-TurnRate       = 2
-I've got the speed/turning set medium/high to compensate for my lack of skill.
-
-Appearance: Currently, it's a shiny gold colored ship.  It's physically large, but that's only because I wanted to have a spinning asteroid as part of the ship.  The front of the ship is flanged outward; this is where the ship's tractor beam comes from.
-
-Weapon: Multi-Use Tractor Beam.  
-Cost: 8 to activate or deactivate prematurely
-Range:6 (from center of ship)
-Time: The Beam lasts for 6000 frames (not sure what that is in seconds, 6?)
-Description:  The Chorali use their tractor beams for just about everything.  They didn't invent the beams, they found the technology on a dead world and replicated it, but they can at least come up with new uses.  First, the beams will draw any matter they come in contact with (currently just ships and asteroids, I tried to get the cargo chain from the confed cargotran to work, but I'm not sure what way would be proper).  The beams also turn any ships they draw, so that they will not continue to fire at the Extractor (watch out for B.U.T.T. missles). If the object is drawn completely to the Extractor, it will be held stationary (no thrust or turning, fire &amp; special still work) until the beam's duration is done.  If the fire button is pressed while an asteroid is held, the asteroid is lobbed at high velocity towards the current target.  Weak long range tractor beams will occasionally correct the trajectory of the missile. 
-[AsteroidMissile]
-Range    = 60
-Velocity = 80
-Damage   = 2
-Armour   = 1
-TurnRate = 2
-The beams will also push away any objects that the onboard computer thinks are dangerous.  Currently, the only homing missiles it can keep at bay are Mycon plasmoids and Khor-Ah blades.
-
-
-Special:  Planet-Fall.
-Cost: 1
-Rate: 0
-The Chorali have discovered that their tractor beams can also be used on nearby planets with surpising success.  If the beams are not focused, they will draw the ship towards the planet.  Used in combination with the main weapon, the Extractor can force enemy ships to crash into the planet.
-
-Quirk: If the highly focused beams of the main weapon are used on the planet, chunks of matter are lifted from the planet, making asteroids (of a non-regenerating type, to keep the amount of permanent asteroids to a minimum).
+The Chorali Extractor
+CrewMax        = 10
+BattMax        = 20
+SpeedMax       = 40
+AccelRate      = 10
+TurnRate       = 2
+I've got the speed/turning set medium/high to compensate for my lack of skill.
+
+Appearance: Currently, it's a shiny gold colored ship.  It's physically large, but that's only because I wanted to have a spinning asteroid as part of the ship.  The front of the ship is flanged outward; this is where the ship's tractor beam comes from.
+
+Weapon: Multi-Use Tractor Beam.  
+Cost: 8 to activate or deactivate prematurely
+Range:6 (from center of ship)
+Time: The Beam lasts for 6000 frames (not sure what that is in seconds, 6?)
+Description:  The Chorali use their tractor beams for just about everything.  They didn't invent the beams, they found the technology on a dead world and replicated it, but they can at least come up with new uses.  First, the beams will draw any matter they come in contact with (currently just ships and asteroids, I tried to get the cargo chain from the confed cargotran to work, but I'm not sure what way would be proper).  The beams also turn any ships they draw, so that they will not continue to fire at the Extractor (watch out for B.U.T.T. missles). If the object is drawn completely to the Extractor, it will be held stationary (no thrust or turning, fire &amp; special still work) until the beam's duration is done.  If the fire button is pressed while an asteroid is held, the asteroid is lobbed at high velocity towards the current target.  Weak long range tractor beams will occasionally correct the trajectory of the missile. 
+[AsteroidMissile]
+Range    = 60
+Velocity = 80
+Damage   = 2
+Armour   = 1
+TurnRate = 2
+The beams will also push away any objects that the onboard computer thinks are dangerous.  Currently, the only homing missiles it can keep at bay are Mycon plasmoids and Khor-Ah blades.
+
+
+Special:  Planet-Fall.
+Cost: 1
+Rate: 0
+The Chorali have discovered that their tractor beams can also be used on nearby planets with surpising success.  If the beams are not focused, they will draw the ship towards the planet.  Used in combination with the main weapon, the Extractor can force enemy ships to crash into the planet.
+
+Quirk: If the highly focused beams of the main weapon are used on the planet, chunks of matter are lifted from the planet, making asteroids (of a non-regenerating type, to keep the amount of permanent asteroids to a minimum).

Deleted: branches/multiplayer-branch/gamedata/ships/shpconca.dat
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/gamedata/ships/shpconca.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/shpconca.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/shpconca.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,28 +1,28 @@
-Ship		- Confed Cargotran
-Class		- Commercial cargo tug
-Crew		- 6
-Battery		- 4
-Acceleration	- Awe-inspiring
-Turning		- Average
-Top speed	- Slower than an Earthling Cruiser
-Creator		- Corona688, <A HREF="https://lists.berlios.de/mailman/listinfo/tw-light-svn">tsm at accesscomm.ca</A>
-
-Weapons:
- Primary 	- Weak short-range laser
- Secondary	- Decelerate, straightens out the chain
- Teritary	- fire + special, ditch the cargo
-
-Weaknesses:	This is NOT a military vessel, and is not meant to
- enter combat.  It's single weapon is only really meant to crack
- asteroids.  Even worse, the structural integrity field used to
- chain the cargo containers behind it means that any damage on them is 
- transferred to the tug.  If forced to enter combat, the captain's
- only recourse is to ditch the cargo entirely and take refuge in the
- slowly growing cloud of containers.
-
-Strengths:	No military strengths.
-
-Quirks:		Although the tug itself has terrific acceleration, this
- is more than offset by the kilotons of cargo it tows.  If caught in a
- gravity well, the cargo can easily haul the whole mess into the planet
+Ship		- Confed Cargotran
+Class		- Commercial cargo tug
+Crew		- 6
+Battery		- 4
+Acceleration	- Awe-inspiring
+Turning		- Average
+Top speed	- Slower than an Earthling Cruiser
+Creator		- Corona688, <A HREF="https://lists.berlios.de/mailman/listinfo/tw-light-svn">tsm at accesscomm.ca</A>
+
+Weapons:
+ Primary 	- Weak short-range laser
+ Secondary	- Decelerate, straightens out the chain
+ Teritary	- fire + special, ditch the cargo
+
+Weaknesses:	This is NOT a military vessel, and is not meant to
+ enter combat.  It's single weapon is only really meant to crack
+ asteroids.  Even worse, the structural integrity field used to
+ chain the cargo containers behind it means that any damage on them is 
+ transferred to the tug.  If forced to enter combat, the captain's
+ only recourse is to ditch the cargo entirely and take refuge in the
+ slowly growing cloud of containers.
+
+Strengths:	No military strengths.
+
+Quirks:		Although the tug itself has terrific acceleration, this
+ is more than offset by the kilotons of cargo it tows.  If caught in a
+ gravity well, the cargo can easily haul the whole mess into the planet
  unless the captain jettisons it immediately.
\ No newline at end of file

Deleted: branches/multiplayer-branch/gamedata/ships/shpconho.dat
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/gamedata/ships/shpconho.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/shpconho.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/shpconho.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,56 +1,56 @@
-Ship          - Confederation Hornet
-Class         - Medium Range Light Fighter
-crew          - 1
-battery       - 10
-accelleration - Good
-Turning       - Very Good
-Top Speed     - Very Good
-
-Weapons
- Primary   - Dual Ball Laser Cannons
- Secondary - Torpedoes (Direct Damage Missles, Slightly Homing)
-
-Extra - Recharging Shield
- Can absorb 8 points of damage, readout in crew-bar
-
-Limitations
- - killed instantly by any direct damage
-   - current known direct damages include :
-     - running into a planet
-     - Orz Marines
-     - Narool Acid
-     - *NEW* Torpedoes
-
-Strong-Points
- - Extremely Manouverable, an excellent pilot can challenge any ship in space
- - Strong destructive capability for a light fighter (lasers do 1 damage each, Torpedoes do 4)
- - Recharging Shield + High Manouverability = longer life, there is no suffering from length in battle
- - Perfect for circling enemies.
-
-/**************************************************************************************/
-03/02/2001
-  - corrected minor bug (i was 1 pixle off when blitting shield pictures)
-  - changed colors around ship in panel to all blue shades
-
-/**********/
-
-03/01/2001
-Torpedoes Implimented
-  - still 4 damage, but now split across normal and direct, (3 and 1 respectively)
-
-Shield Indicator Overlay Implimented
-  - Displays a color around the ship in the panel indicating how your shield is faring.
-
-mshppan.cpp updated to solve a problem with graphic artifacts being left when a hornet's dying, fixed now - if there are any side affects let me know.
-
-/**********/
-
-02/27/2001
-  - Shield indicator bar all blue now.
-  - added homing to missles.
-  - Minor initialization changes to strenthen ship. (not truly necessary in my opinion)
-
-/**********/
-
-02/26/2001
+Ship          - Confederation Hornet
+Class         - Medium Range Light Fighter
+crew          - 1
+battery       - 10
+accelleration - Good
+Turning       - Very Good
+Top Speed     - Very Good
+
+Weapons
+ Primary   - Dual Ball Laser Cannons
+ Secondary - Torpedoes (Direct Damage Missles, Slightly Homing)
+
+Extra - Recharging Shield
+ Can absorb 8 points of damage, readout in crew-bar
+
+Limitations
+ - killed instantly by any direct damage
+   - current known direct damages include :
+     - running into a planet
+     - Orz Marines
+     - Narool Acid
+     - *NEW* Torpedoes
+
+Strong-Points
+ - Extremely Manouverable, an excellent pilot can challenge any ship in space
+ - Strong destructive capability for a light fighter (lasers do 1 damage each, Torpedoes do 4)
+ - Recharging Shield + High Manouverability = longer life, there is no suffering from length in battle
+ - Perfect for circling enemies.
+
+/**************************************************************************************/
+03/02/2001
+  - corrected minor bug (i was 1 pixle off when blitting shield pictures)
+  - changed colors around ship in panel to all blue shades
+
+/**********/
+
+03/01/2001
+Torpedoes Implimented
+  - still 4 damage, but now split across normal and direct, (3 and 1 respectively)
+
+Shield Indicator Overlay Implimented
+  - Displays a color around the ship in the panel indicating how your shield is faring.
+
+mshppan.cpp updated to solve a problem with graphic artifacts being left when a hornet's dying, fixed now - if there are any side affects let me know.
+
+/**********/
+
+02/27/2001
+  - Shield indicator bar all blue now.
+  - added homing to missles.
+  - Minor initialization changes to strenthen ship. (not truly necessary in my opinion)
+
+/**********/
+
+02/26/2001
 First release, most features implimented
\ No newline at end of file

Deleted: branches/multiplayer-branch/gamedata/ships/shpdragr.dat
===================================================================
(Binary files differ)

Deleted: branches/multiplayer-branch/gamedata/ships/shpdruma.dat
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/gamedata/ships/shpdruma.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/shpdruma.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/shpdruma.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,21 +1,19 @@
+ General Overview
 
-The Druuge Mauler is one of the original ships
-from Star Control 2.
+One of the single most troublesome ships in the game. The Mauler is slow, ungainly reactions make it a difficult ship to play with. Mastering the correct usage of the high-recoil cannon is not easy and the slow battery regeneration turns the Mauler into a vulnerable ship. To compensate for the Mauler's weak battery recharging, Druuge captains have been known to order lower-ranking crew members to be thrown into the furnace. Yet, when correctly used against certain ships, the Mauler can prove a deadly adversary. Correct usage of recoil effects would allow for great targeting and quick evasion.
 
-The Druuge Mauler is essentially a flying long range
-cannon. The projectiles it fires have some mass,
-which provide backwards momentum for the Druuge and
-the enemy ships.
+Main Weapon: High-Recoil Cannon
 
-The special is somewhat gruesome - the Druuge throw
-their crew into their nuclear furnaces to create
-instantaneous battery reserve.
+Takes four points of battery and does six points of damage. The high-recoil cannon's fast shots can pummel an unwary enemy from long distance. The recoil itself can propel the Mauler into &#8220;hyperspacing speed&#8221; which can be a double-edged sword. The recoil-effect, combined with the Furnace, nominate the Mauler as one of the few ships that are actually DANGEROUS to a Chmmr Avatar. Aiming takes a while to master but the shots are hard to evade.
 
-The Druuge are a race living in a dystopian 
-corporate society, with an emphasis on trade, 
-profit, and cruelty.  
+Special System: The Furnace
 
-The Druuge trade slaves, fuel and artifacts. They
-were responsible for the death of the Gg in order
-to save their own skin when the Kohr-Ah approached.
+At first, this appears to be the single most useless special system available. Throwing a crewman into the furnace to fill half-way of the battery. But when thinking of the possible action &#8211; The Mauler actually never runs out of battery power. This is especially useful against the Avatar where you can use the high-recoil cannon and the supply of battery power to keep out of the Avatar's Tractor-and-Laser tactic, pummeling it to dust. Other than that, it is recommended that you be as cheap as possible on throwing people into the furnace.
 
+Tactical Overview
+
+The Mauler is a very specific ship. It has its advantages only versus specific ships. It is very vulnerable.
+
+Strong against: Chmmr Avatar. Shofixti Scout - The high-recoil would allow the Mauler to stay out of the Glory Device&#8217;s range and it only needs one hit to send the Scout to hell. The Ilwrath Avenger will have a hard time against it too. When flown really masterfully it can also tear ships such as the Earthling (Humans) Cruiser apart.
+
+Weak Against: Whoa. What not? The Marauder's spinning blades, the Arilou Skiff can easily lay an ambush, the VUX Limpets, The Slylandro Probe and Pkunk Fury speed. The X-form&#8217;s long-range missiles, the Kzer-za Dreadnought]&#8217;s fighters, Chenjesu Broodhome DOGIs, the Orz Nemesis marines and the Mycon Podship Can easily wear-down the crew complement. The Utwig Jugger loves meeting the Mauler in battle. 
\ No newline at end of file

Deleted: branches/multiplayer-branch/gamedata/ships/shpearc3.dat
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/gamedata/ships/shpearc3.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/shpearc3.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/shpearc3.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,24 +1,24 @@
-EARTHLING CRUISER MK3
-
-This ship represents yet another attempt to make a worthy &quot;new generation&quot; Earthling ship.
-Started a along time ago, it would never be competed if it was not for Starwreck, which
-inspired that last effort needed to bring this ship to life.  And, sure enough, this attempt
-brings the Earthling Cruiser a step or two closer to its 'Treck predecessors (which is not
-necessarily a bad thing).
-
-Primary weapon on this ship is the proton torpedo launcher, capable of firing highly destructive
-projectiles at long range.  Advanced targeting system automatically tracks all major targets in range
-and calculates optimum firing angle.  However, the launcher itself is limited to a relatively small
-firing arc, and can take some time to aim in on target.  The limited accuracy is an inherited problem
-of all existing proton torpedo launchers.
-
-Secondary weapon system is the short-range point defense laser (PDL).  The beam can be fired
-in short bursts, with some time required to cool down the emitter.   Each burst is automatically
-aimed at the nearest non-friendly object.  If the object is destroyed or is out of range, PDL can
-quickly acquire a new target.  This weapon is especially effective against projectile weapons.
-----------------------------
-
-
-*Tau* &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/tw-light-svn">twships at tau137.com</A>&gt;
-
-30 Jan 2003
+EARTHLING CRUISER MK3
+
+This ship represents yet another attempt to make a worthy &quot;new generation&quot; Earthling ship.
+Started a along time ago, it would never be competed if it was not for Starwreck, which
+inspired that last effort needed to bring this ship to life.  And, sure enough, this attempt
+brings the Earthling Cruiser a step or two closer to its 'Treck predecessors (which is not
+necessarily a bad thing).
+
+Primary weapon on this ship is the proton torpedo launcher, capable of firing highly destructive
+projectiles at long range.  Advanced targeting system automatically tracks all major targets in range
+and calculates optimum firing angle.  However, the launcher itself is limited to a relatively small
+firing arc, and can take some time to aim in on target.  The limited accuracy is an inherited problem
+of all existing proton torpedo launchers.
+
+Secondary weapon system is the short-range point defense laser (PDL).  The beam can be fired
+in short bursts, with some time required to cool down the emitter.   Each burst is automatically
+aimed at the nearest non-friendly object.  If the object is destroyed or is out of range, PDL can
+quickly acquire a new target.  This weapon is especially effective against projectile weapons.
+----------------------------
+
+
+*Tau* &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/tw-light-svn">twships at tau137.com</A>&gt;
+
+30 Jan 2003

Deleted: branches/multiplayer-branch/gamedata/ships/shpearcr.dat
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/gamedata/ships/shpearcr.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/shpearcr.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/shpearcr.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,15 +1,6 @@
-The Earthling Cruiser is one of the original ships
-from Star Control 1.  They were on the Alliance side.
-Earthlings, needless to say, are humans.  
+The Earthling Cruiser is a slow vessel with a devastating arsenal of weapons. A Cruiser can hold its own against other ships as long as it maintains a safe distance from its opponent.
 
-The main weapon is very long range nuclear missiles
-that home in on enemies.  (surplus MX missiles)
+The Cruiser's primary weapon is a guided nuclear missile. The missile's tracking is not perfect, but it's fairly accurate and will do a good amount of damage unless the enemy can shield itself upon impact or shoot down the missile.
 
-It's special weapon fires point defense lasers at
-nearby objects.  (surplus SDI systems)
+The Cruiser's alternate weapon is a point-defense laser system, based on mid-1980s &quot;Star Wars&quot; missile defense technology, that fires lasers at enemy ships, projectiles, asteroids, or anything else that is close to the Earthling ship. 
 
-
-In Star Control 2, most earthlings were imprisoned on
-Earth, but you, the player, were a rogue Earthling in
-a spaceship that was an ancient alien artifact 100,000
-years old.  

Deleted: branches/multiplayer-branch/gamedata/ships/shpforsh.dat
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/gamedata/ships/shpforsh.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/shpforsh.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/shpforsh.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,22 +1,22 @@
-----------------
-Zekfahan Shocker
-----------------
-
-The primary is the same but the graphics made it necessary
-to put the guns closer. If you think this a major drawback,
-I might redesign it to feature the original barrel distances.
-
-The secondary now is a chain lightning weapon. It will bounce
-towards every non-planet object after a hit, including the
-shocker itself. It does a reducing amount of damage with
-each bouncing, and the shocker is immune to its shot.
-
-Thanks for Richardyzo for allowing me to rework his ship idea.
-(I've done it because the original one had some copyright
-issues with StarCraft.)
-
-I'd like to thank &quot;the coder&quot; also for doing me this job.
-
-Have fun with the new Shocker! Richardyzo, I hope you enjoy it!
-
-	Forevian
+----------------
+Zekfahan Shocker
+----------------
+
+The primary is the same but the graphics made it necessary
+to put the guns closer. If you think this a major drawback,
+I might redesign it to feature the original barrel distances.
+
+The secondary now is a chain lightning weapon. It will bounce
+towards every non-planet object after a hit, including the
+shocker itself. It does a reducing amount of damage with
+each bouncing, and the shocker is immune to its shot.
+
+Thanks for Richardyzo for allowing me to rework his ship idea.
+(I've done it because the original one had some copyright
+issues with StarCraft.)
+
+I'd like to thank &quot;the coder&quot; also for doing me this job.
+
+Have fun with the new Shocker! Richardyzo, I hope you enjoy it!
+
+	Forevian

Deleted: branches/multiplayer-branch/gamedata/ships/shpgarty.dat
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/gamedata/ships/shpgarty.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/shpgarty.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/shpgarty.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,32 +1,32 @@
-Ship          - Garash Tyrant
-Class         - Behemoth
-crew          - 42
-battery       - 42
-acceleration  - Poor
-Turning       - Very Good
-Top Speed     - Average
-
-Weapons
- Primary   - Charging weapon (damage depending on charge)
-  Stage 1: acts as shield and good at ramming
-  Stage 2: can be released.
-  Stage 3: same as stage two but a little bit powerful.
- Secondary - Repulsar wave  
-  Knockbacks opponent.
-  Knockouts control over ship at a very limited time.
-  Inflicts a modest damage.
-
-Weaknesses
- Slow rate of fire
- Cannot shoot at whim (there's a minimum charge required to shoot)
- Cannot hold on to the shot indefinitely (auto released at some max time   limit)
- Very big ship (easy to hit with high armored shots)
- 
- 
-Strenghts
- Good at long range.
- Good defense vs low armoured shots.
- Good at pillboxing tactics.
- Very good versus low range ships.
- Very powerful shot (absorbs everything or any other form of shots!)
-
+Ship          - Garash Tyrant
+Class         - Behemoth
+crew          - 42
+battery       - 42
+acceleration  - Poor
+Turning       - Very Good
+Top Speed     - Average
+
+Weapons
+ Primary   - Charging weapon (damage depending on charge)
+  Stage 1: acts as shield and good at ramming
+  Stage 2: can be released.
+  Stage 3: same as stage two but a little bit powerful.
+ Secondary - Repulsar wave  
+  Knockbacks opponent.
+  Knockouts control over ship at a very limited time.
+  Inflicts a modest damage.
+
+Weaknesses
+ Slow rate of fire
+ Cannot shoot at whim (there's a minimum charge required to shoot)
+ Cannot hold on to the shot indefinitely (auto released at some max time   limit)
+ Very big ship (easy to hit with high armored shots)
+ 
+ 
+Strenghts
+ Good at long range.
+ Good defense vs low armoured shots.
+ Good at pillboxing tactics.
+ Very good versus low range ships.
+ Very powerful shot (absorbs everything or any other form of shots!)
+

Deleted: branches/multiplayer-branch/gamedata/ships/shpilwav.dat
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/gamedata/ships/shpilwav.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/shpilwav.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/shpilwav.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,6 +1,3 @@
-The Ilwrath Avenger is one of the original ships
-from Star Control 1.  They were on the Hierarchy side.
-
 The Avengers main weapon spouts short range hellfire
 in front of the ship.
 
@@ -11,10 +8,3 @@
 Discrepancy: cloaking in TimeWarp is much more powerfull
 than in SC1/2 because the camera position does not
 reveal their position.  
-
-Ilwrath look like spiders.  In SC1 they have 5 legs, in
-SC2 8 legs.  
-
-In Star Control 2, Ilwrath are depicted as the ultimate
-in villany and cruelty, but not very powerfull.  
-

Deleted: branches/multiplayer-branch/gamedata/ships/shpilwsp.dat
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/gamedata/ships/shpilwsp.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/shpilwsp.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/shpilwsp.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,16 +1,16 @@
-Ilwrath Spider
-
-During the war against the Traddash the Ilwrath could salvage some Traddash
-technology and came out with this new prototype. (non-official concept)
-
-Primary Weapon:
-  Improved dual version of the original flamethrowers partially based on the Torch's
-  after burners.
-  
-Special:
-  Strange smoke that stops everything for a small amount of time. Even projectiles.
-  The smoke completly adsorbs laser.
-
- * created by: DOS and <A HREF="https://lists.berlios.de/mailman/listinfo/tw-light-svn">cyhawk at sch.bme.hu</A> and <A HREF="https://lists.berlios.de/mailman/listinfo/tw-light-svn">forevian at freemail.hu</A>
- * thank for the folks at Shipboard for suggesting some elements -- I don't
+Ilwrath Spider
+
+During the war against the Traddash the Ilwrath could salvage some Traddash
+technology and came out with this new prototype. (non-official concept)
+
+Primary Weapon:
+  Improved dual version of the original flamethrowers partially based on the Torch's
+  after burners.
+  
+Special:
+  Strange smoke that stops everything for a small amount of time. Even projectiles.
+  The smoke completly adsorbs laser.
+
+ * created by: DOS and <A HREF="https://lists.berlios.de/mailman/listinfo/tw-light-svn">cyhawk at sch.bme.hu</A> and <A HREF="https://lists.berlios.de/mailman/listinfo/tw-light-svn">forevian at freemail.hu</A>
+ * thank for the folks at Shipboard for suggesting some elements -- I don't
    remember their name and right now I'm lazy to check the topic
\ No newline at end of file

Deleted: branches/multiplayer-branch/gamedata/ships/shpkahbo.dat
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/gamedata/ships/shpkahbo.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/shpkahbo.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/shpkahbo.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,12 +1,12 @@
-Kahr Boomerang
-
-This ship has characteristics close to the Yehat Terminator.
-
-Weapon (3)
-Press Special to select (can be done at any time)
-
-Small boomerang : 1 damage that bounces of ships, short range. No limit.
-Medium boomerang : 3 damage, long range (otherwise same as small). limit 4.
-Large boomerang : 5 damage, controlable range, when you release fire will return.  If turning ship when released it will turn in rotation direction of ship.  Also industuctable like Kohr-ah FIRED system. Limit 1
-
+Kahr Boomerang
+
+This ship has characteristics close to the Yehat Terminator.
+
+Weapon (3)
+Press Special to select (can be done at any time)
+
+Small boomerang : 1 damage that bounces of ships, short range. No limit.
+Medium boomerang : 3 damage, long range (otherwise same as small). limit 4.
+Large boomerang : 5 damage, controlable range, when you release fire will return.  If turning ship when released it will turn in rotation direction of ship.  Also industuctable like Kohr-ah FIRED system. Limit 1
+
 Enjoy
\ No newline at end of file

Deleted: branches/multiplayer-branch/gamedata/ships/shpkohma.dat
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/gamedata/ships/shpkohma.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/shpkohma.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/shpkohma.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,31 +1,8 @@
+A very powerful vessel rivaling the Kzer-Za Dreadnought. Armed with spinning sawblades and a destructive F.R.I.E.D. system.
 
-The Kohr-Ah Marauder is one of the original
-ships from Star Control 2. They are hostiles.
+The sawblades will travel until the fire button is released, effectively giving them unlimited range. Ideal for placing one in the line of travel of the enemy. The blades come with a short-range homing capability.
 
-The main consists of blades which can travel
-a long way until fire is released. Ideal for
-placing one in the line of travel of the enemy.
-The blades come with a short-range homing
-capability.
+The FRIED aka Fiery Ring of Inevitable, Eternal Destruction is a ring of superheated plasma that expands from the Marauder and F.R.I.E.S. anything in its path. If a FRIED shot and an enemy projectile collide, the FRIED will always win. This property makes them good for defense. Using FRIED consumes half of the maximum battery.
 
-The special is named FRIED (fiery ring of 
-inevitable and eternal destruction).  It spawns 
-a ring of fiery spheres.  If your velocity 
-relative to a target is very high you can 
-sometimes hit the target with many (3 to 5) 
-FRIED shots from a single ring, inflicting 
-substancial damage.  If a FRIED shot and an 
-enemy projectile collide, the FRIED will always 
-win.  This property makes them good for defense.  
-Using FRIED consumes half of the maximum battery.  
+Overall, the Ur-Quan Kohr-Ah Marauder is one of the most powerful ships in the Quadrant.  
 
-They resemble black caterpillars.  
-
-The Kohr-Ah are the black offshoot of the 
-Ur-Quan race. They were bread by the Dnyarri 
-as warriors. The Kohr-Ah philosophy is to 
-&quot;cleanse&quot; the universe of anything that shows 
-signs of intelligence, on the theory that the 
-only viable defense is a preemptive strike.  
-
-

Deleted: branches/multiplayer-branch/gamedata/ships/shpkzedr.dat
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/gamedata/ships/shpkzedr.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/shpkzedr.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/shpkzedr.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,33 +1,6 @@
-The Ur-Quan Dreadnought is one of the original ships
-from Star Control 1.  They were on the Hierarchy side.
-In fact, they were the founders and masters of the
-Urquan Hierarchy (i.e. the main badguy).  In Star
-Control 2, their name was changed to the Ur-Quan
-Kzer-Za, sometimes called green Urquan, to distinguish
-them from the black urquan, the Ur-Quan Kohr-Ah.  
+The Ur-Quan Kzer-Za Dreadnought is the mainstay of the Hierarchy fleets. A fully-crewed Dreadnought can crush most opponents with ease.
 
-The Dreadnoughts main weapon fires fusion blasts.  It
-fires fairly quickly, does a lot of damage, and has a
-decent range.  
+The Dreadnought's fusion cannon can destroy small ships in one or two hits. Additionally, the Ur-Quan captain can send out small, one-man fighter ships armed with lasers to harass the enemy. Each fighter has only a limited supply of air and fuel and must return to the Dreadnought after several seconds. 
 
-The Dreadnoughts special weapon launches 2 fighter ships
-which seek out enemies and kill them.  These fighters can
-do enourmous damage, but launching them costs crew, which
-is regained when the fighter returns.  
 
-Urquan are green catepillar-like creatures.
 
-In Star Control 2, the Urquan are the guys who imprisoned
-everyone under force shields, so they seem like the badguy.
-But they are much more complex than that.  Urquan are
-mighty, proud, arrogant, kind, masochistic, and ultimately
-tragic.  The Urquan overcame their predatory nature long ago
-to be a part of a mutually beneficial galactic society, but
-a horrific struggle 20,000 years ago destroyed galactic
-civilization and permanently warped the urquans view of the
-universe.  Now they go around enslaving and imprisoning other
-races, with the best of intentions.  Parts of their history are
-reminiscient of the writtings of science fiction author Larry
-Niven.  
-
-

Deleted: branches/multiplayer-branch/gamedata/ships/shpmeltr.dat
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/gamedata/ships/shpmeltr.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/shpmeltr.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/shpmeltr.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,21 +1 @@
-
-The Melnorme Trader is one of the original ships
-from Star Control 2; neutrals.
-
-The main consists of a light sphere. This can be
-charged to do more damage upon release. When fully
-charged, the weapon sphere can absorb enemy fire
-and act as a small shield.
-
-Special fires some field with long range, which on
-impact puts the enemy into an uncontrollable spin,
-disabling the rotation controls.  This field 
-can pass right through most defenses.  
-
-The Melnorme are cyclopses.  
-
-The Melnorme are neutral traders, apparently without
-a homeworld. They provide a wealth of information
-and technology in exchange for data on lifeforms.
-Their origins are a mystery, they could be
-descendants of the Mael-Num, a Milieu race.
+A large, moderate speed ship with moderate to slow turning. Primary fire is an energy bolt that can be charged up. Low charge doe minimal damage, however a fully charged shot can cause grevious damage. A charging shot can also act as a shield vrs incoming fire. The secondary weapon is a stun shot that causes an effected enemy to spin helplessly. The cannot activate their secondary weapons or their turning jets. They can still activate their primary weapon and thrusters.

Deleted: branches/multiplayer-branch/gamedata/ships/shpmmrxf.dat
===================================================================
(Binary files differ)

Copied: branches/multiplayer-branch/gamedata/ships/shpmmrxf.txt (from rev 69, trunk/gamedata/ships/shpmmrxf.txt)

Deleted: branches/multiplayer-branch/gamedata/ships/shpmycpo.dat
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/gamedata/ships/shpmycpo.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/shpmycpo.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/shpmycpo.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,26 +1,7 @@
+The Mycon podship is a large medium speed, slow turning ship. It's primary weapon is a slow moving long-range homing plasma burst. It's damage decreases the longer the plasma has been in flight (as the plasma disperses). At short range, damage is very high. At long range, damage is very low. Enemy fire that strikes the plasma disperses it and reduces it's damage potential.
 
-The Mycon Podship is one of the original ships
-from Star Control 1.  They were on the Hierarchy side.
+The secondary ability of the podship is to regrow it's own crew. It is piloted by talking fungi after all!
 
-They formed an important addition to the UQ fleets,
-whom they joined of their free will - accepting that
-the UQ were &quot;inevitable&quot;. Their help guaranteed UQ
-victory over Earth defence forces.
+One other notable feature of the podship is it's ability to commit suicide by ramming it's own plasma bursts. Due to the plasma'a low speed, plasma launched in the direction of travel while the ship is at speed stand a good chance of being &quot;over-run&quot; by the ship itself. Due to the high damage of the fresh plasma, this is often fatal. Take extra care when using a gravity whip manuver.
 
-The main consists of a very long range, semi-sentient
-homing plasmoid. This weapon loses power slowly with
-distance. A full battery is just enough for 2 plasmoids.
-
-The special creates new crew, but this drains the whole
-battery.
-
-The Mycon are a fungi like race, living in and on
-steaming hot lava worlds. Their &quot;ships&quot; are probably
-of organic origin. They can quickly produce new
-individuals from spores in a hot radiative environment.
-They have a shared memory, which is somewhat incoherent ;)
-
-The Mycon were mostly important for their hostile
-relation with the Syreen in star control 2.
-
-
+Certain other highly manuverable ships can also cause the plasma to strike the podship that launched it. 
\ No newline at end of file

Deleted: branches/multiplayer-branch/gamedata/ships/shporzne.dat
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/gamedata/ships/shporzne.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/shporzne.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/shporzne.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,37 +1,21 @@
-The Orz Nemesis is one of the original ships
-from Star Control 2.
+ General Overview
 
-The main weapon consists of a gun turret with 
-mediumrange.
+Always a worthy adversary. Underestimating the Nemesis would likely be the last mistake anyone can ever make. Like its name suggests, the Orz ship is a goddess of revenge, coming to inflict pain and vengeance on the galaxy. The Nemesis is fairly quick and has a fair turn-rate. Never, under any circumstances, chase after the nemesis!
 
-Special allows you to rotate the turret, which is
-not that useful a feature, but looks nice.  You 
-do this by holding down special and pressing the 
-turn buttons.  
+Main Weapon/Special system: Rotating Howitzer
 
-The second special launches Orz space marines,
-which can use a planet's gravity field to achieve
-high velocities and board the enemy; once on board,
-they can kill a random amount of crew. They can
-stay in space indefinitely, but return when the
-target is destroyed.  To launch marines, press 
-both the special key and the fire key at the same 
-time.  
+The Howitzer inflicts deadly damage and its shots are fast and medium-ranged. The rotational turret allows usage as a strafing weapon or as a backwards utilized attacker-repellent.
 
-The Orz are a fish-like creatures, who need the
-safe environment of a space suit to walk around
-in space.
 
-The Orz come from an alien dimension they call
-*below*. They've a suspicious connection to the
-disappearance of the Androsynths. Though the
-story implies that they could pose a big threat,
-they're friendly and of minor importance in the game.
+Special Action: Marines (GoGos)
 
-The Orz are an strange race, with childish sillyness 
-and simplicity, an undercurrent of a Lovecraftian 
-horror theme, and an overall very friendly attitude.  
-It's implied in SC2 that you should be afraid of them, 
-but for practical purposes allying with them is easy, 
-useful, and harmless.  The Arilou seem to particularly 
-dislike the Orz.  
+Using their armored exo-skeleton, Orzine marines exit the ship from the aft portholes and enter an enemy ship by burning a hole in the hull. They then start roaming the enemy ship&#8217;s corridors, killing every crewman in sight. Especially useful in large groups, the marines can blast a ship entirely by themselves. Warlike creatures such as Ur-Quan, Chmmr, Yehat and Shofixti usually put up a better resistance than peaceful or cowardly creatures like the Spathi, Chenjesu and Mycon. The marine tactic of using a planet wrap-around slingshot maneuver to gain speed aids them against some ships.
+
+Tactical Overview
+
+A very effective ship that rarely fails.
+
+Strong against: Kzer-Za Dreadnought and to some degree Kohr-Ah Marauder are both in danger. The Chenjesu Broodhome is virtually helpless against the marines as is the VUX Intruder and the Mycon Podship. The marines cling on to the Yehat Terminator until the shield goes down and while they are repelled by the Utwig Jugger Shield, no fuel is gained and so they can be used to take down the Jugger&#8217;s shield. Showing the Chmmr Avatar your aft and blasting her with the howitzer is a tricky thing but the Nemesis can break through the tractor beam and as soon as the Zap-sats are down, the Avatar is marine-meat
+
+Weak against: The Pkunk Fury, Slylandro Probe and Arilou Skiff can effortlessly pull out of marine&#8217;s grasp and use hit-n-run attacks to whack the unready Nemesis. The Androsynth Guardian is a bit tricky &#8211; if she get stuck without battery she&#8217;s Marine-meat but the Comet form destroys marines on impact and the Nemesis&#8217;s aft section appears to have been designed exactly to be wedged by a wicked blazer. So long as they manage to evade the marines, The X-form and the Spathi Eluder can pose a pain in the butt to any Nemesis captain. A very hot Shofixti Scout pilot can evade the marines long enough to use a wrap-around slingshot maneuver to catch the Nemesis unaware.
+

Deleted: branches/multiplayer-branch/gamedata/ships/shppkufu.dat
===================================================================
(Binary files differ)

Deleted: branches/multiplayer-branch/gamedata/ships/shprogsq.dat
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/gamedata/ships/shprogsq.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/shprogsq.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/shprogsq.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,16 +1,16 @@
-
-Rogue Squadron
-
-background:
-
-A rogue squadron of former UQ crew, now lawless scavengers of the universe, a curious mixture of different races in a simple general ship design which is harmless on its own, but can be dangerous in large numbers.
-
-How to use this ship:
-
-main = pulse laser
-
-special = choose formations.
-
-In the ini file, you can edit formations. A formation is a list of x y points relative to the leader ship which you have to give a position (0,0), entered on a single line. The must be exactly as many x y pairs as there are crew members. I use an odd number of crew (11) to make the ships start in a symmetrical pattern around the leader.
-
-In melee, the player controls position (0,0) of the grid, which is indicated by a small arrow. Ships are distributed relative to the player position and angle.
+
+Rogue Squadron
+
+background:
+
+A rogue squadron of former UQ crew, now lawless scavengers of the universe, a curious mixture of different races in a simple general ship design which is harmless on its own, but can be dangerous in large numbers.
+
+How to use this ship:
+
+main = pulse laser
+
+special = choose formations.
+
+In the ini file, you can edit formations. A formation is a list of x y points relative to the leader ship which you have to give a position (0,0), entered on a single line. The must be exactly as many x y pairs as there are crew members. I use an odd number of crew (11) to make the ships start in a symmetrical pattern around the leader.
+
+In melee, the player controls position (0,0) of the grid, which is indicated by a small arrow. Ships are distributed relative to the player position and angle.

Deleted: branches/multiplayer-branch/gamedata/ships/shpshosc.dat
===================================================================
(Binary files differ)

Deleted: branches/multiplayer-branch/gamedata/ships/shpslypr.dat
===================================================================
(Binary files differ)

Deleted: branches/multiplayer-branch/gamedata/ships/shpspael.dat
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/gamedata/ships/shpspael.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/shpspael.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/shpspael.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,22 +1,28 @@
+Overview
 
-The Spathi Eluder is one of the original ships
-from Star Control 1.  They were on the Alliance side.
+The multi-colored Spathi Eluder, formerly known as the Discriminator, remains bulk of the Spathi fleet even 20 years after the War. Its construction, though seemingly chaotic, is carefully designed to mimic its crew's natural attributes: paranoia, elusiveness, and cowardice.
 
-Their role in sc1:
+Speed and Control
 
-The main weapon is a short range, fast firing,
-cannon. Only to be used in unfortunate close
-encounters!
+The Eluder is one of the fastest ships in the galaxy, both in top speed and acceleration, and has a turning radius an Arilou Lalee'lay would be jealous of. Though agility would be a mighty boon for most brute-force fighter ships, the Eluder is anything but brute... or a force... or even a fighter, for that matter. The fact is the thrusters primary use isn't for speeding into battle, but rather for speeding away from it! From this perspective, the Eluder performs admirably! The helm of the Eluder is quite large and is typically manned by two Spathi at once, but in times of emergency (mainly when he's the only crew member left) the captain usually whips into a adrenaline-filled panicked frenzy and finds the ability to man both halves of the helm nearly simultaneously by himself!
 
-The special consists of BUTT missiles, backward
-utilizing tracking torpedoes. Those are ideal for
-those who are afraid to turn and face their enemies.
-Very effective in combination with the high speed
-of the Eluder.
+Armament
 
-The Spathi are insectoids.
+Primary
 
-In star control 2, the Spathi formed a cowardly
-race, who were very funny ;)
+The Eluder's main weaponary consists of a quick-firing, short-range, low-impact plasma pellet. Great for sneak attacks and guerilla tactics or just to finish off a severely-handicapped adversary (which are the only direct attacks a Spathi would consider), the plasma pellet is otherwise limited in its usefulness.
 
+Secondary
 
+The secondary weaponry epitomizes the essence of true Spathi-ness due to its ability to do the most damage while the Eluder is in full retreat! The Backwards Utility Tracking Torpedo (B.U.T.T.) is a medium-range, low-impact conventional space torpedo with a good automated guidance system and moderate speed and manuevering. Fired from the rear of the craft, B.U.T.T. missiles do most of the dirty work in the dogfights as Eluders make their way away from the fray. Enemy captains foolish enough to think it can run down an Eluder usually end up learning a fatal lesson in space warfare.
+
+Ship Layout and Design
+
+From the outside, the Eluder consists of many bubble-shaped, solid-colored cabins joined together by smaller white corridors. The intention of having so many large seemingly crew-filled projections is in part to obfuscate enemy into targeting the decoy cabins and to direct enemy fire away from the main bridge. However, in practice, enemy weapons seem to incapacitate the same amount of crew no matter where the Eluder is damaged. This is most likely due to the fact that even in the safety of a large starship, the crew is bound to hide in every nook, cranny, and hole the ship has to offer in the case of direct combat. And, unfortunate for the Spathi, there are many of these crannies throughout the ship as it was Spathi engineers who designed it to begin with, making the seemingly crew-filled decoy cabins actually full of petrified crew members. To make matters worse, even the crew itself can be confused by the ship layout. In fact, the random cabin configuration has fooled man!
 y a green-eared Spathi captain who haven't grown used to the ship's odd design, especially as they're slinking away from the bridge during particularly nasty dogfights.
+
+Miscellaneous
+
+A small note should be added that it may be possible that perhaps a few jet-black Eluders exist. The legends of the Black Spathi Squandron, lead by a small band of courageous, brave Spathi rebels, who attempt to lead its brethren to freedom, have been passed down for several generations. However, the credibility of this legend is dubious at best seeing as how even the most courageous Spathi in the known universe are little short of &quot;completely terrified.&quot; 
+
+
+

Deleted: branches/multiplayer-branch/gamedata/ships/shpstaba.dat
===================================================================
(Binary files differ)

Deleted: branches/multiplayer-branch/gamedata/ships/shpsupbl.dat
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/gamedata/ships/shpsupbl.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/shpsupbl.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/shpsupbl.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,14 +1,19 @@
+ General review
 
-The Supox Blade is one of the original ships
-from Star Control 2.
+The Blade is a largely underrated ship. It's rapid fire capability can pound an unwary enemy and the lateral thrusting, when properly used, is nearly as good as the Arilou Hyperspace shunts in evading shots. The Blade is quick and agile with a fair turn-rate, allowing it to considerably hamper enemy targeting efforts. Its slender form makes it harder to hit her.
 
-The main weapon consists of a rapid-fire forward
-cannon.
+Main Weapon: Sprout Gun
 
-The special allows the ship to move almost instantly
-left, right, back, like a leaf in the wind.
+The rapid-fire Sprout Gun may cause small damage but it sure fires fast. Even when out of battery, the gun&#8217;s firing rate remains high and it's range, equaling the Ur-Quan Kzer-Za Dreadnought and the Syreen Penetrator can prove deadly.
 
-The Supox are the only sentient plant species known.
+Special System: Lateral Thrusting System
 
-The Supox formed peaceful allies of the Utwig, whom
-they helped in their time of distress.
+It takes a hell lot of practice to master the tricky Lateral Thrusting System but when correctly used, the Lateral Thrusting can be used to sidestep shots or strafe into a firing position. Especially effective against slow-firing ships such as the Dreadnought or Kohr-Ah Marauder.
+
+Tactical Overview
+
+The Blade is a fair adversary that shouldn't be taken lightly.
+
+Strong against: Syreen Penetrator, Kzer-Za Dreadnought, VUX Intruder, Ilwrath Avenger, Utwig Jugger.
+
+Weak against: Chenjesu Broodhome The crystalline shards put the Lateral-Sidestepping into a real problem. Arilou Skiff, Slylandro Probe and Pkunk Fury can convey quick hit-n-run attacks on the Blade. Chmmr Avatar. 

Deleted: branches/multiplayer-branch/gamedata/ships/shpsyrpe.dat
===================================================================
(Binary files differ)

Deleted: branches/multiplayer-branch/gamedata/ships/shptauar.dat
===================================================================
(Binary files differ)

Deleted: branches/multiplayer-branch/gamedata/ships/shptauda.dat
===================================================================
(Binary files differ)

Deleted: branches/multiplayer-branch/gamedata/ships/shptausl.dat
===================================================================
(Binary files differ)

Deleted: branches/multiplayer-branch/gamedata/ships/shptauto.dat
===================================================================
(Binary files differ)

Deleted: branches/multiplayer-branch/gamedata/ships/shpthrto.dat
===================================================================
(Binary files differ)

Copied: branches/multiplayer-branch/gamedata/ships/shpthrto.txt (from rev 69, trunk/gamedata/ships/shpthrto.txt)

Deleted: branches/multiplayer-branch/gamedata/ships/shpumgdr.dat
===================================================================
(Binary files differ)

Deleted: branches/multiplayer-branch/gamedata/ships/shputwju.dat
===================================================================
(Binary files differ)

Copied: branches/multiplayer-branch/gamedata/ships/shputwju.txt (from rev 69, trunk/gamedata/ships/shputwju.txt)

Deleted: branches/multiplayer-branch/gamedata/ships/shpvuxin.dat
===================================================================
(Binary files differ)

Copied: branches/multiplayer-branch/gamedata/ships/shpvuxin.txt (from rev 69, trunk/gamedata/ships/shpvuxin.txt)

Deleted: branches/multiplayer-branch/gamedata/ships/shpyehte.dat
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/gamedata/ships/shpyehte.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/shpyehte.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/shpyehte.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,21 +1,3 @@
+The Yehat Terminator is a moderately slow but agile and strong ship that can deal serious damage at close range.
 
-The Yehat Terminator is one of the original ships
-from Star Control 1.  They were on the Alliance side.
-
-Main is a dual, fast firing gun of intermediate range.
-
-Special spawns a shield, needed because their home
-system was located in a nebula and the shield was
-used to reduce friction.
-
-The Yehat are pterodactyl-like creatures.
-
-In Star Control 2, the Yehat are proud warriors, but who
-are under the ruling of a Queen whom they always respected,
-but who chose the side of the dishonorable Ur-Quan. On top
-of this, they suffer from great guilt about the great
-sacrifice of the Shofixti, a race which they uplifted and
-admired. They loathe the Pkunk, who are a peace-loving
-offshoot of the Yehat race. In short, the Yehat are a very
-unhappy race.
-
+Terminators are armed with twin short-range rapid-fire ion cannons. In addition, Terminators are equipped with an energy shield that will block almost all attacks. An Orz Nemesis's space marines, a VUX Intruder's limpets, and a Shofixti Scout's Glory Device detonation are some of the few (but not all) attacks that can penetrate the Terminators shield. Energy generation, though fast, is not sufficient for constant firing and shielding. Proper timing, sensible weapon useage and conservation of energy for shields are of paramount importance. 
\ No newline at end of file

Deleted: branches/multiplayer-branch/gamedata/ships/shpzeksh.dat
===================================================================
(Binary files differ)

Deleted: branches/multiplayer-branch/gamedata/ships/shpzfpst.dat
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/gamedata/ships/shpzfpst.txt
===================================================================
--- branches/multiplayer-branch/gamedata/ships/shpzfpst.txt	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/gamedata/ships/shpzfpst.txt	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,22 +1,3 @@
+The Zoq-Fot-Pik Stinger is a light vessel which can outrun and outmaneuver most other ships but cannot sustain much damage.
 
-The Zoqfotpik Stinger is one of the original ships
-from Star Control 2.
-
-Its normal weapon is a short range pellet gun, 
-which throws around small projectiles in a wide 
-arc.
-
-Its special weapon is a &quot;tongue&quot;, able to 
-inflict some major damage at VERY short range.  
-
-The Zoq, Fot and Pik are three species who evolved
-together with the Zebranky on a single world. They
-worked together to destroy the predatory Zebranky,
-and form a cooperative society.
-
-They were close to Ur-Quan territory and, though
-unnoticed by them, were close to extinction due to
-fights between the Kzer-Za and Kohr-Ah taking place
-in their systems. They were very eager to get help
-against this threat.
-
+The Stinger's main weapon is a short-range cannon that can be used to deflect incoming attacks from some other ships. Its alternate weapon is a &quot;tongue&quot; that shoots superheated plasma into the enemy's ship, inflicting incredible damage. However, the Stinger must be right next to its target to hit it with the tongue attack. 

Copied: branches/multiplayer-branch/gamedata/sound/ships (from rev 69, trunk/gamedata/sound/ships)

Modified: branches/multiplayer-branch/makefile
===================================================================
--- branches/multiplayer-branch/makefile	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/makefile	2004-09-28 19:53:03 UTC (rev 71)
@@ -7,7 +7,7 @@
 #                          {TEST=1}                                            #
 #                                                                              #
 # Define win32=1    when compiling with Mingw32 gcc compiler for windows       #
-# Define debug=1    when you want to build debug version of TimeWarp           #         
+# Define debug=1    when you want to build debug version of TimeWarp           #
 # Define xmingw=1   when compiling  win32 binary with Mingw gcc crosscompiler  #
 # Define DATAPATH   to specify where datafile stored (*nix version only)       #
 # Define EXECPATH   to specify where executable should be placed               #
@@ -16,12 +16,12 @@
 # Running just make builds the release version of TimeWarp for *nix            #
 # (Linux, FreeBSD, ...)                                                        #
 #                                                                              #
-# The game depends on Allegro (4.0.x) library, so you need to install it       #
-# before running                                                               #
+# The game depends on Allegro (4.0.x), SDL, SDL_mixer with ogg support         # 
+# libraries, so you need to install them before running.                       #
 #                                                                              #
 ################################################################################
 
-PRODUCTVERSION = 0.2
+PRODUCTVERSION = 0.3
 
 SVNVERSION = ${shell svnversion .}
 
@@ -74,7 +74,7 @@
         source/other source/ships source/sc1ships source/sc2ships \
         source/twgui source/util source/libraries/alogg \
         source/libraries/jpgalleg source/libraries/jgmod source/libraries/cppunit \
-        source/libraries/raknet
+        source/libraries/raknet source/libraries/lua source/libraries/lua/lib
 
 #FILELIST= ${shell find source -type f &quot;(&quot; -name &quot;*.c&quot; -o -name &quot;*.cpp&quot; &quot;)&quot;}
 FILELIST= ${shell cat sources.lst}
@@ -121,7 +121,8 @@
 	LIBS += ${shell allegro-config --libs} -pthread ${shell sdl-config --libs}
 endif
 
-CFLAGS += -I./source -I./source/libraries
+CFLAGS += -I./source -I./source/libraries -I./source/libraries/lua
+
 ifdef TEST
 CFLAGS += -DTEST ${shell cppunit-config --cflags }
 LIBS += ${shell cppunit-config --libs }
@@ -186,6 +187,8 @@
 	svn export . $(EXPDIR)
 	$(RM) $(EXPDIR)/web/*
 	rmdir $(EXPDIR)/web
+	$(RM) $(EXPDIR)/rawgraphic/*
+	rmdir $(EXPDIR)/rawgraphic
 	echo &quot;TW-Light $(PRODUCTVERSION)r$(SVNVERSION) - $(TIMESTAMP)&quot; &gt;$(EXPDIR)/gamedata/version.txt
 	echo &quot;!define VER_VERSION $(PRODUCTVERSION)&quot; &gt;$(EXPDIR)/Util/ver
 	echo &quot;!define VER_SVNVERSION $(SVNVERSION)&quot;  &gt;$(EXPDIR)/Util/svnver
@@ -195,24 +198,17 @@
 
 update_source_list:
 	find source -type f &quot;(&quot; -name &quot;*.c&quot; -o -name &quot;*.cpp&quot; &quot;)&quot; &gt;sources.lst
+
+add_stacktrace:
+	find source -name '*.cpp'|grep -v 'libraries'|grep -v 'errors.cpp'|grep -v 'utils.cpp'|xargs ./Util/addStackTrace.pl 
+
 install:
 	./install-sh $(NAME) $(EXECPATH)/$(NAME)
 	./install-sh gamedata $(DATAPATH)
 
 uninstall:
 	$(RM) $(EXECPATH)/$(NAME)
-	$(RM) $(DATAPATH)/ships/shp*.dat
-	$(RM) $(DATAPATH)/*.dat
-	$(RM) $(DATAPATH)/*.html
-	$(RM) $(DATAPATH)/*.txt
-	$(RM) $(DATAPATH)/palette
-	$(RM) $(DATAPATH)/ships/shp*.txt
-	rmdir $(DATAPATH)/ships
-	$(RM) $(DATAPATH)/default_ini/*.ini
-	$(RM) $(DATAPATH)/default_ini/ships/shp*.ini
-	rmdir $(DATAPATH)/default_ini/ships
-	rmdir $(DATAPATH)/default_ini
-	rmdir $(DATAPATH)
+	$(RM) -r $(DATAPATH)
 
 
 -include $(DEPS)

Copied: branches/multiplayer-branch/rawgraphic (from rev 69, trunk/rawgraphic)

Modified: branches/multiplayer-branch/source/ais/c_input.cpp
===================================================================
--- branches/multiplayer-branch/source/ais/c_input.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ais/c_input.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,7 +1,6 @@
-/* $Id: c_input.cpp,v 1.2 2004/08/03 11:37:21 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -23,7 +22,6 @@
 #include &lt;stdio.h&gt;
 #include &lt;string.h&gt;
 #include &quot;melee.h&quot;
-REGISTER_FILE
 #include &quot;ais.h&quot;
 #include &quot;melee/mship.h&quot;
 #include &quot;gui.h&quot;
@@ -39,54 +37,65 @@
 
 
 
-int my_bitmap_proc( int msg, DIALOG* d, int c ){
-	if( msg == MSG_END &amp;&amp; d-&gt;dp ){
-		destroy_bitmap( (BITMAP*)d-&gt;dp );
-		d-&gt;dp = NULL;
-	}
+int my_bitmap_proc( int msg, DIALOG* d, int c )
+{
+  if( msg == MSG_END &amp;&amp; d-&gt;dp )
+    {
+      destroy_bitmap( (BITMAP*)d-&gt;dp );
+      d-&gt;dp = NULL;
+    }
 
-	if( msg != MSG_DRAW || d-&gt;dp ) return d_bitmap_proc( msg, d, c );
-	return D_O_K;
+  if( msg != MSG_DRAW || d-&gt;dp ) 
+    return d_bitmap_proc( msg, d, c );
+  return D_O_K;
 }
 
-int my_list_proc( int msg, DIALOG* d, int c ){
-	int old_d1 = d-&gt;d1;
-	Fleet *fleet = (Fleet*)d-&gt;dp3;
-	int ret = d_list_proc2( msg, d, c );
-	if( d-&gt;d1 != old_d1 || msg == MSG_START ){
-		ShipType* type = fleet-&gt;getShipType(d-&gt;d1);
+int my_list_proc( int msg, DIALOG* d, int c )
+{
+  int old_d1 = d-&gt;d1;
+  Fleet *fleet = (Fleet*)d-&gt;dp3;
+  int ret = d_list_proc2( msg, d, c );
+  if( d-&gt;d1 != old_d1 || msg == MSG_START )
+    {
+      ShipType* type = fleet-&gt;getShipType(d-&gt;d1);
+      
+      ASSERT(type != NULL);
 
-        ASSERT(type != NULL);
+      selectDialog[SELECT_DIALOG_TITLE].flags |= D_DIRTY;
+      sprintf(selectTitleString, &quot;%s\n%s\n%d of %d points&quot;, 
+	      selectShipPrompt,
+	      (type != NULL) ? type-&gt;name : 0,
+	      (type != NULL) ? type-&gt;cost : 0,
+	      fleet-&gt;getCost());
+      
+      tw_set_config_file(type-&gt;data-&gt;ini);
 
-        selectDialog[SELECT_DIALOG_TITLE].flags |= D_DIRTY;
-        sprintf(selectTitleString, &quot;%s\n%s\n%d of %d points&quot;, 
-            selectShipPrompt,
-            (type != NULL) ? type-&gt;name : 0,
-            (type != NULL) ? type-&gt;cost : 0,
-            fleet-&gt;getCost());
-
-		BITMAP* panel = NULL;
-		DATAFILE* data = load_datafile_object( type-&gt;data-&gt;file, &quot;SHIP_P00_PCX&quot; );
-
-		if( data ){
-			BITMAP* bmp = (BITMAP*)data-&gt;dat;
-			panel = create_bitmap_ex( bitmap_color_depth(screen), bmp-&gt;w, bmp-&gt;h );
-			blit( bmp, panel, 0, 0, 0, 0, bmp-&gt;w, bmp-&gt;h );
-			unload_datafile_object( data );
-			data = load_datafile_object( type-&gt;data-&gt;file, &quot;SHIP_P01_PCX&quot; );
-			bmp = (BITMAP*)data-&gt;dat;
-			blit( bmp, panel, 0, 0, 4, 65, bmp-&gt;w, bmp-&gt;h );
-			unload_datafile_object( data );
-			color_correct_bitmap( panel, 0 );
-		}
-
-		if( selectDialog[SELECT_DIALOG_PIC].dp ) destroy_bitmap( (BITMAP*)selectDialog[SELECT_DIALOG_PIC].dp );
-		selectDialog[SELECT_DIALOG_PIC].dp = panel;
-		scare_mouse();
-		SEND_MESSAGE( &amp;selectDialog[SELECT_DIALOG_PIC], MSG_DRAW, 0 );
-		unscare_mouse();
+      BITMAP* panel = load_bitmap(data_full_path(get_config_string(&quot;Graphic&quot;, 
+								   &quot;PanelBitmaps0&quot;, 
+								   &quot;&quot;)).c_str(), NULL);
+      if(panel)
+	{
+	  BITMAP* bmp = load_bitmap(data_full_path(get_config_string(&quot;Graphic&quot;, 
+								     &quot;PanelBitmaps1&quot;, 
+								     &quot;&quot;)).c_str(), NULL);
+	  blit( bmp, panel, 0, 0, 4, 65, bmp-&gt;w, bmp-&gt;h );
+	  destroy_bitmap(bmp);
+	  color_correct_bitmap( panel, 0 );
 	}
-	return ret;
+      else
+	{
+	  tw_error(&quot;Unable to load ship pannel!!\n%s&quot;, 
+		   data_full_path(get_config_string(&quot;Graphic&quot;, &quot;PanelBitmaps0&quot;, &quot;&quot;)).c_str());
+	}
+      
+      if( selectDialog[SELECT_DIALOG_PIC].dp ) 
+	destroy_bitmap( (BITMAP*)selectDialog[SELECT_DIALOG_PIC].dp );
+      selectDialog[SELECT_DIALOG_PIC].dp = panel;
+      scare_mouse();
+      SEND_MESSAGE( &amp;selectDialog[SELECT_DIALOG_PIC], MSG_DRAW, 0 );
+      unscare_mouse();
+    }
+  return ret;
 }
 
 void calibrate_joysticks() 
@@ -217,12 +226,14 @@
 /*! \brief Get control name */
 const char *ControlHuman::getTypeName() 
 {
+  STACKTRACE;
   return &quot;Keyboard/Joystick&quot;;
 }
 
 /*! \brief Process get input from player */
 int ControlHuman::think() 
 {
+  STACKTRACE;
   int r = 0;
   if (key_pressed(thrust))  r |= keyflag::thrust;
   if (key_pressed(back))    r |= keyflag::back;
@@ -245,10 +256,11 @@
 
 ControlHuman::ControlHuman(const char *name, int channel) : Control(name, channel, ai_index_human) 
 {
+  STACKTRACE;
 };
 
 int ControlHuman::choose_ship(VideoWindow *window, char * prompt, Fleet *fleet) {
-	STACKTRACE;
+  STACKTRACE;
 	int ret = -1, slot = 0;
 	if (fleet-&gt;getSize() == 0) {tw_error (&quot;Empty fleet! (prompt:%s)&quot;, prompt);}
 	selectDialog[SELECT_DIALOG_LIST].dp3 = fleet;
@@ -279,6 +291,7 @@
 
 /*! returns help text for this controller ie keys to use this controller*/
 void ControlHuman::getHelpText(char * text) {
+  STACKTRACE;
 	char line[80] = &quot;&quot;;
 	char desc[80] = &quot;&quot;;
 
@@ -299,6 +312,7 @@
 /*! \brief setap players keys */
 void ControlHuman::setup() 
 {
+  STACKTRACE;
   int i, t = 0;
   int last = 0;
   while (true) 

Modified: branches/multiplayer-branch/source/ais/c_other.cpp
===================================================================
--- branches/multiplayer-branch/source/ais/c_other.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ais/c_other.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,7 +1,6 @@
-/* $Id: c_other.cpp,v 1.1.1.1 2004/08/01 10:21:19 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -21,16 +20,17 @@
 #endif
 
 #include &quot;ais.h&quot;
-REGISTER_FILE
 
 /*! \brief Get control name */
 const char *ControlVegetable::getTypeName() 
 {
+  STACKTRACE;
   return &quot;VegetableBot&quot;;
 }
 /*! \brief This AI do nothing */
 int ControlVegetable::think() 
 {
+  STACKTRACE;
   return 0;
 }
 /*! \brief This function do nothing
@@ -38,6 +38,7 @@
 */
 int ControlVegetable::choose_ship(VideoWindow *window, char * prompt, class Fleet *fleet ) 
 {
+  STACKTRACE;
   return -1;
 }
 
@@ -47,6 +48,7 @@
 
 const char *ControlMoron::getTypeName() 
 {
+  STACKTRACE;
   return &quot;MoronBot&quot;;
 }
 
@@ -92,6 +94,7 @@
 /*! \brief Summon stupid_bot() */
 int ControlMoron::think()
 {
+  STACKTRACE;
   if (ship)
     return stupid_bot(ship);
   else
@@ -100,6 +103,7 @@
 
 ControlMoron::ControlMoron(const char *name, int channel) : Control(name, channel, ai_index_moron) 
 {
+  STACKTRACE;
 }
 
 

Modified: branches/multiplayer-branch/source/ais/c_wussie.cpp
===================================================================
--- branches/multiplayer-branch/source/ais/c_wussie.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ais/c_wussie.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,4 +1,3 @@
-/* $Id: c_wussie.cpp,v 1.2 2004/08/01 21:26:15 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
                     <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>

Modified: branches/multiplayer-branch/source/doxygen.cpp
===================================================================
--- branches/multiplayer-branch/source/doxygen.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/doxygen.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,7 +1,6 @@
-/* $Id: doxygen.cpp,v 1.3 2004/08/07 13:10:51 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -19,9 +18,9 @@
  * 
  *  \section overview_sec Overview: What is TW-Light?
  *  
- *  TW-Light is lightweighted version of Star Control: TimeWarp. Currently it includes only a combat 
- *  portion with the best TW ships but without network support. There are some plans to expand it to 
- *  include an epic adventure. 
+ *  TW-Light is an open source clone/sequel to the epic cross-genre game Star Control II. 
+ *  Currently it includes only a combat portion, although epic adventure part that is 
+ *  called TW:Legacies is actively developed now. 
  *
  *  \section getting_started_sec Getting Started
  * 
@@ -39,7 +38,7 @@
  *       - F12 displays framerates / performance data
  *       - - zooms out on some viewing modes.
  *       - + (or =) zooms in on some viewing modes.
- *       - 0 and 9 also effect the camera in some viewing modes.
+ *       - 0 also effect the camera in some viewing modes.
  *       - ctrl+T = toggle team indicators on/off
  *       - ctrl+H = toggle healthbar indicators on/off
  *       - Also, if some controllers are set to keyboard, customizable
@@ -48,94 +47,20 @@
  *               - left:   Keypad 4
  *               - thrust: Keypad 8
  *               - right:  Keypad 6
- *               - fire:   Quote (&quot;)
- *               -  special:Semicolon (;)
+ *               - fire:   Enter 
+ *               -  special:Ctrl 
  *               - next:   Closebrace (])
  *               - prev:   Openbrace ([)
  *               - near:   P
- *       - Config 1:
- *               - left:   A
- *               - thrust: S
- *               - right:  D
- *               - fire:   B
- *               - special:V
- *               - next:   F
- *               - prev:   G
- *               - near:   H
- * - Extended Menu:
- *	- Play Game:
- *              - Same as &quot;Melee&quot; now
- *      - Key Tester:
- *              - Use this utility to check keys combination for conflicts.
- *	- Ship Info:
- *		- Here you can get detail information about every ship in the game.
- * 	- Diagnostic:
- *              - Show comlile options and version information. 
- *	- Main Menu:
- *              - This returns to the main menu.
- *		
- * - Teams:
- *      - Select Controller:
- *             - Select the player (i.e. &quot;Player 1&quot; or &quot;Player 2&quot;)
- *              you wish to alter from the list on the left, and
- *              the controller (i.e. &quot;Keyboard&quot;, &quot;MoronBot&quot;) you
- *              want to control that player from the list on the
- *             left.  Then either click on the &quot;Select
- *             Controller&quot; button or double click on the
- *             controller name.
- *	- Change Team #: 
- *	       - This switches the player allys. 
- *	      Note that team 0 mean no allys.
- *      - Change Config #:
- *             -   This switches the configuration used by the
- *              currently highlighted controller.  
- *      - Edit Configuration:
- *             -   This is used to setup up keys when the currently
- *              highlighted player is using the keyboard.  It
- *              may eventually allow the configuration of AIs
- *              and calibration of joysticks.
- *      - Edit Fleet:
- *             -   This button brings up the fleet selection menu for
- *              the currently highlighted player.  
- *      - Main Menu:
- *             -   This returns to the main menu.
- * - Options:
- *      -  Most things on this menu are self-explanatory, but a few
- *         need special mention.
- *
- *      - Gamma correction:
- *             -  This makes things brighter during combat.  This
- *                 should not be changed from the middle of combat,
- *                 or colors could get weird.  
- *      - Antialiasing:
- *             -  If this box is checked then TimeWarp will use
- *                higher quality graphics, but run slower.  
- *      - Color Depth:
- *             -  You cannot change this from the middle of combat.  
- *      -  Camera Mode:
- *             -  This allows you to control what is shown on your
- *                 screen in combat.  
- *
- *             - &quot;Enemy_Discrete&quot;
- *                 is just like Star Control on the PC, where
- *                 the camera moved to keep both you and your
- *                 enemy onscreen, and zoomed in by factors of
- *                 2.
- *             -  &quot;Enemy&quot;
- *                 is like Star Control on the Genesis or 3DO,
- *                 where the camera zoomed in smoothly.
- *             -  &quot;Hero&quot;
- *                 makes the camera stay focused on Player 1,
- *                 and zoom in/out when + and - are pressed.
- *             -  &quot;Everything&quot;
- *                 makes the camera stay on the planet and zoom
- *                 way out so that everything is visible.  This
- *                 mode is slightly buggy (visual artifacts).  
- *
+ * 
+ *   See ingame help for controls description.
+ *  
  * \section development Development
  * 
+ * Full developer documentation can be produced using doxygen tool.
+ * 
  * Following documents describes some of the issues concerning contributing 
- * to Timewarp
+ * to TW-Light
  * 		- \ref coding_page
  * 		- \ref howto_document
  *  
@@ -156,13 +81,10 @@
  *   - The Chorali Extractor
  *   - Confed Cargotran
  *   - Confederation Hornet
- *   - Djinni Lancer
  *   - Drax Griffon
- *   - Earthling Crusader MK2
  *   - Earthling Crusader MK3
  *   - Zekfahan Shocker
  *   - Garash Tyrant
- *   - Hydrovar
  *   - Ilwrath Spider
  *   - Kahr Boomerang
  *   - Re-Koj Assassin
@@ -175,7 +97,7 @@
  *
  * \subsection simplyfy_subsec Simplify and fix melee engine
  * 
- *  We are working on it.
+ *  Almost done.
  * 
  * \subsection TML_subsec Add TimeWarp Markup Language (TML) support
  * 
@@ -183,7 +105,7 @@
  * 
  * \subsection plot_subsec Write plot
  * 
- *  No progress.
+ *  The Plot is fully writen.
  *
  * \subsection plot_impl_subsec  Implement plot with TML
  * 
@@ -206,8 +128,10 @@
  *
  * \section credits_sec Credits
  *
- * TW-Light is derivative work from &lt;a href=&quot;timewarp.sourceforge.net&quot;&gt;Star Control: TimeWarp&lt;/a&gt;
-
+ * - TW-Light is derivative work from &lt;a href=&quot;timewarp.sourceforge.net&quot;&gt;Star Control: TimeWarp&lt;/a&gt;
+ * - Some code and documents were taken from &lt;a href=&quot;www.wesnoth.org&quot;&gt;Battle for Wesnoth&lt;/a&gt;
+ * - UQM Ships description were taken from Ultronomicon (<A HREF="http://uqm.stack.nl/wiki/">http://uqm.stack.nl/wiki/</A>)
+ * - Some battle music were written by Robeter Productions Inc. 
  */
 
  /*! \page coding_page A guide to a few of the wierder issues with programming for TW-Light.  
@@ -252,23 +176,15 @@
  * \section trivial_conventions_sec Trivial Conventions
  * 
  * It would be nice if the following conventions were followed in TW-Light code:
- * -#  The proper indentation amount is 1 tab.  If you don't like that (or if
- * your editor produces spaces when you hit tab), then try 2 spaces instead.
- * If you don't like that either, AT LEAST BE INTERNALLY CONSISTENT IN YOUR
- * INDENTATION POLICY!  YES, THIS MEANS YOU!!!
- * -#  In the same vein, do not use an editor that transparently replaces N
- * spaces with the &quot;equivalent&quot; tabs.  Or, if you must do so, make sure that
- * your indentation amount exactly matches the tab size.  Otherwise your
- * indentation will apear totally fucked up on other editors with different tab
- * sizes.  And don't use an editor that replaces tabs with spaces either.  
- * Don't use strange characters in file names.  To be specific, the 26 
+ * -#  The proper indentation amount is 2 spaces. If you don't like it, AT LEAST 
+ * BE INTERNALLY CONSISTENT IN YOUR INDENTATION POLICY!  YES, THIS MEANS YOU!!!
+ * -#  Don't use strange characters in file names.  To be specific, the 26 
  * english characters and underscores and up to one period per file name 
  * are okay.  I guess numbers would be ok too.  Use lower case letters, 
  * never upper case.  
  * -# Don't name two source files exactly the same thing, even if they're in 
  * different directories. The same rule applies to headers.  
- * -# All source files should have extensions of either .cpp or .h .  No .c 
- * or .cc files.  Exception: .c files are permitted in the util directory.  
+ * -# All source files should have extensions of either .c .cpp or .h .  No .cc files.    
  * 
  * \section collisions_sec Collisions
  * 
@@ -300,10 +216,11 @@
  * \section report_error_sec Reporting Errors
  * 
  * If you wish to report an error condition, you can say something like:
+ * //simple error message&lt;br&gt;
  * tw_error(&quot;Oh no! an error occured!&quot;);
- * //simple error message
+ * //error message using more complex printf-style stuff&lt;br&gt;
  * tw_error(&quot;This error was brought to you by the letter %c and the number %d&quot;, 'g', 3);
- * //error message using more complex printf-style stuff
+ * 
  * When you report an error in this manner, a box will pop up and tell
  * the user your message, and the source file and line number from which
  * tw_error() was called.  The user will be presented with a number of buttons,

Modified: branches/multiplayer-branch/source/frame.cpp
===================================================================
--- branches/multiplayer-branch/source/frame.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/frame.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -24,7 +24,6 @@
 #include &lt;stdio.h&gt;
 #include &lt;memory.h&gt;
 #include &quot;melee.h&quot;
-REGISTER_FILE
 #include &quot;frame.h&quot;
 
 extern FILE* debug_file;
@@ -126,6 +125,7 @@
 
 Frame::Frame(int max_items) 
 {
+  STACKTRACE;
   window = new VideoWindow();
   window-&gt;preinit();
   surface = NULL;
@@ -166,6 +166,7 @@
 /*! \brief weild code to enlarge amount of items */
 void Frame::enlarge_list(int increment) 
 {
+  STACKTRACE;
   DirtyItem *temp;
   
   temp = item;
@@ -223,42 +224,49 @@
 /*! \brief Add pixel item to item list */
 void Frame::add_pixel(int x, int y)
 {
+  STACKTRACE;
   add_to_list(x, y, 0, 0, erase_pixel, draw_pixel);
 }
 
 /*! \brief Add box item to item list */
 void Frame::add_box(double x, double y, double w, double h)
 {
+  STACKTRACE;
   add_to_list((int)x, (int)y, (int)w, (int)h, erase_box, draw_box);
 }
 
 /*! \brief Add circle item to item list */
 void Frame::add_circle(int x, int y, int a, int b)
 {
+  STACKTRACE;
   add_to_list(x, y, a, b, erase_circle, draw_circle);
 }
 
 /*! \brief to be deleted? */
 void Frame::add_old_circle(int x, int y, int a, int b)
 {
+  STACKTRACE;
   add_to_old_list(x, y, a, b, erase_circle, draw_circle);
 }
 
 /*! \brief to be deleted? */
 void Frame::add_line(int x, int y, int a, int b)
 {
+  STACKTRACE;
   add_to_list(x, y, a, b, erase_line, draw_line);
 }
 
 /*! \brief to be deleted? */
 void Frame::add_old_pixel(int x, int y)
 {
+  STACKTRACE;
   add_to_old_list(x, y, 0, 0, erase_pixel, draw_pixel);
 }
 
 /*! \brief to be deleted? */
 void Frame::add_old_box(int x, int y, int a, int b)
 {
+  STACKTRACE;
   add_to_old_list(
 		  x, 
 		  y, 
@@ -271,6 +279,7 @@
 /*! \brief to be deleted? */
 void Frame::add_old_line(int x, int y, int a, int b)
 {
+  STACKTRACE;
   add_to_old_list(x, y, a, b, erase_line, draw_line);
 }
 

Copied: branches/multiplayer-branch/source/games/gdefender.cpp (from rev 69, trunk/source/games/gdefender.cpp)

Modified: branches/multiplayer-branch/source/games/gflmelee.cpp
===================================================================
--- branches/multiplayer-branch/source/games/gflmelee.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/games/gflmelee.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,7 +1,7 @@
 /* $Id: gflmelee.cpp,v 1.1.1.1 2004/08/01 10:21:21 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -27,7 +27,6 @@
 #include &quot;other/radar.h&quot;
 #include &quot;melee/mshppan.h&quot;
 
-REGISTER_FILE
 #include &quot;melee/mframe.h&quot;
 #include &quot;melee/mgame.h&quot;
 #include &quot;melee/mmain.h&quot;
@@ -181,6 +180,7 @@
 
 StatsManager::StatsManager()
 {
+  STACKTRACE;
   Nships = 0;
   // no stats yet :)
 
@@ -466,6 +466,7 @@
 
 YRadar::YRadar(Control *ocontroller, double Size, TeamCode hteam, char *datafilename, bool rel, int shape)
 {
+  STACKTRACE;
   relative_angle = rel;
   display_shape = shape;
   
@@ -533,11 +534,13 @@
 
 void YRadar::toggleActive()
 {
+  STACKTRACE;
   active^=1;
 }
 
 void YRadar::setSize(double Size)
 {
+  STACKTRACE;
   size=Size;
 }
 
@@ -685,6 +688,7 @@
 
 ImIndicator::ImIndicator(SpaceLocation *o)
 {
+  STACKTRACE;
   showme = o;
   
   bmp = create_bitmap_ex( bitmap_color_depth(screen), ImIndicatorSize, ImIndicatorSize);

Copied: branches/multiplayer-branch/source/games/ggob.cpp (from rev 69, trunk/source/games/ggob.cpp)

Copied: branches/multiplayer-branch/source/games/ggob.h (from rev 69, trunk/source/games/ggob.h)

Modified: branches/multiplayer-branch/source/gui.cpp
===================================================================
--- branches/multiplayer-branch/source/gui.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/gui.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -26,7 +26,6 @@
 #endif
 #include &lt;allegro/internal/aintern.h&gt;
 #include &quot;melee.h&quot;
-REGISTER_FILE
 
 #include &quot;scp.h&quot;
 #include &quot;gui.h&quot;
@@ -66,31 +65,32 @@
 {
   int f, g, h;
   if (0) ;
-  else if (videosystem.width &lt;= 250) g = 0;
-  else if (videosystem.width &lt;= 320) g = 1;
-  else if (videosystem.width &lt;= 400) g = 2;
-  else if (videosystem.width &lt;= 640) g = 3;
-  else if (videosystem.width &lt;= 800) g = 4;
-  else if (videosystem.width &lt;= 1024) g = 5;
-  else if (videosystem.width &lt;= 1280) g = 6;
-  else if (videosystem.width &lt;= 1600) g = 7;
+  else if (videosystem-&gt;width &lt;= 250) g = 0;
+  else if (videosystem-&gt;width &lt;= 320) g = 1;
+  else if (videosystem-&gt;width &lt;= 400) g = 2;
+  else if (videosystem-&gt;width &lt;= 640) g = 3;
+  else if (videosystem-&gt;width &lt;= 800) g = 4;
+  else if (videosystem-&gt;width &lt;= 1024) g = 5;
+  else if (videosystem-&gt;width &lt;= 1280) g = 6;
+  else if (videosystem-&gt;width &lt;= 1600) g = 7;
   else g = 8;
   if (0) ;
-  else if (videosystem.height &lt;= 180) h = 0;
-  else if (videosystem.height &lt;= 240) h = 1;
-  else if (videosystem.height &lt;= 300) h = 2;
-  else if (videosystem.height &lt;= 480) h = 3;
-  else if (videosystem.height &lt;= 600) h = 4;
-  else if (videosystem.height &lt;= 768) h = 5;
-  else if (videosystem.height &lt;= 1024) h = 6;
-  else if (videosystem.height &lt;= 1280) h = 7;
+  else if (videosystem-&gt;height &lt;= 180) h = 0;
+  else if (videosystem-&gt;height &lt;= 240) h = 1;
+  else if (videosystem-&gt;height &lt;= 300) h = 2;
+  else if (videosystem-&gt;height &lt;= 480) h = 3;
+  else if (videosystem-&gt;height &lt;= 600) h = 4;
+  else if (videosystem-&gt;height &lt;= 768) h = 5;
+  else if (videosystem-&gt;height &lt;= 1024) h = 6;
+  else if (videosystem-&gt;height &lt;= 1280) h = 7;
   else h = 8;
   f = (c + g + h + 1) / 2;
-  return videosystem.get_font(f);
+  return videosystem-&gt;get_font(f);
 }
 
 void TW_Dialog_Player::redraw() 
 {
+  STACKTRACE;
   int i;
   if (!player) return;
   for (i = 0; player-&gt;dialog[i].proc; i++) player-&gt;dialog[i].flags |= D_DIRTY;
@@ -100,6 +100,7 @@
 
 void TW_Dialog_Player::_event( Event * e) 
 {
+  STACKTRACE;
   switch (e-&gt;type) 
     {
     case Event::VIDEO: {
@@ -111,11 +112,13 @@
 
 void TW_Dialog_Player::init(VideoWindow *w, DIALOG *d, int focus) 
 {
+  STACKTRACE;
   dialog = d;
   window = w;
   ifocus = focus;
   player = NULL;
-  if (!window) window = &amp;videosystem.window;
+  if (!window) 
+    window = &amp;videosystem-&gt;window;
   window-&gt;add_callback(this);
   int i;
   for (i = 0; d[i].proc; i += 1) ;
@@ -163,6 +166,7 @@
 }
 void TW_Dialog_Player::deinit() 
 {
+  STACKTRACE;
   int i;
   window-&gt;remove_callback(this);
   dialog[length].d2 -= 1;
@@ -189,7 +193,8 @@
 }
 int TW_Dialog_Player::update() 
 {
-  videosystem.poll_redraw();
+  STACKTRACE;
+  videosystem-&gt;poll_redraw();
   BITMAP *old = screen;
   screen = subscreen;
   if (!player) player = init_dialog(dialog, ifocus);
@@ -210,7 +215,8 @@
 {
   int return_value;
   TW_Dialog_Player bob;
-  if (!window) window = &amp;videosystem.window;
+  if (!window) 
+    window = &amp;videosystem-&gt;window;
   bob.init(window, d, index);
   
   while (keypressed()) readkey();
@@ -226,11 +232,13 @@
 {
   BITMAP *tmp;
   int n, i, return_value;
-  if (!window) window = &amp;videosystem.window;
+  if (!window) 
+    window = &amp;videosystem-&gt;window;
   for (n = 0; d[n].proc; n += 1) ;
-  if (!window-&gt;surface) error (&quot;tw_dialog_pre - no drawing surface&quot;);
+  if (!window-&gt;surface) 
+    tw_error (&quot;tw_dialog_pre - no drawing surface&quot;);
   if ((index &gt;= n) || (index &lt; 0)) 
-    error(&quot;tw_dialog - index invalid&quot;);
+    tw_error(&quot;tw_dialog - index invalid&quot;);
   
   TW_Dialog_Player bob;
   bob.init( window, d, index);
@@ -722,17 +730,17 @@
     case MSG_END:
       if (d-&gt;flags &amp; D_DISABLED) 
 	{
-	  tw_sound.play_sound(menuDisabled);
+	  tw_sound-&gt;play_sound(menuDisabled, 0.5);
         }
       else 
 	{
-	  tw_sound.play_sound(menuAccept);
+	  tw_sound-&gt;play_sound(menuAccept, 0.25);
         }
       break;
 
     case MSG_GOTFOCUS:
       {
-	tw_sound.play_sound(menuFocus);
+	tw_sound-&gt;play_sound(menuFocus, 0.5);
 	break;
       }
     };

Modified: branches/multiplayer-branch/source/input.cpp
===================================================================
--- branches/multiplayer-branch/source/input.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/input.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -25,7 +25,6 @@
 #endif
 
 #include &quot;melee.h&quot;
-REGISTER_FILE
 
 #define JOY_NUM_BITS       3
 #define JOY_NUM_SHIFT     12
@@ -420,7 +419,7 @@
 {
   if (which_key &amp; 0x8000) 
     {
-      error (&quot;key_pressed - bad key&quot;);
+      tw_error (&quot;key_pressed - bad key&quot;);
       return 0;
     }
 
@@ -451,7 +450,7 @@
 	case 3: return joy[joy_num].stick[joy_stick].axis[joy_axi].pos;
 	default: return 0;
 	}
-      error (&quot;key_pressed - bad key???&quot;);
+      tw_error (&quot;key_pressed - bad key???&quot;);
       return 0;
     }
   

Copied: branches/multiplayer-branch/source/libraries/lua (from rev 69, trunk/source/libraries/lua)

Modified: branches/multiplayer-branch/source/melee/manim.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/manim.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/melee/manim.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;melee.h&quot;
-REGISTER_FILE
 
 
 #include &quot;ship.h&quot;
@@ -35,27 +34,27 @@
   frame_step(frame_length),
   scale(_scale),
   transparency(0)
-{STACKTRACE
-   if (frame_size &lt;= 0) 
-     {
-       tw_error(&quot;Animation::Animation - frame_size == %d&quot;, frame_size);
-       frame_size = 1;
-     }
- sprite_index = first_frame;
- layer = LAYER_HOTSPOTS;
- set_depth(depth);
- collide_flag_anyone = collide_flag_sameteam = collide_flag_sameship = 0;
- mass = 0;
- 
- // it's got no physical interaction with the rest of the world, so, remove it
- // from the query list:
- attributes |= ATTRIB_UNDETECTABLE;
+{
+  STACKTRACE;
+  if (frame_size &lt;= 0) 
+    {
+      tw_error(&quot;Animation::Animation - frame_size == %d&quot;, frame_size);
+      frame_size = 1;
+    }
+  sprite_index = first_frame;
+  layer = LAYER_HOTSPOTS;
+  set_depth(depth);
+  collide_flag_anyone = collide_flag_sameteam = collide_flag_sameship = 0;
+  mass = 0;
+  
+  // it's got no physical interaction with the rest of the world, so, remove it
+  // from the query list:
+  attributes |= ATTRIB_UNDETECTABLE;
 }
 
 void Animation::calculate() 
 {
   STACKTRACE;
-  
   frame_step -= frame_time;
   while (frame_step &lt; 0) 
     {

Modified: branches/multiplayer-branch/source/melee/mcbodies.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mcbodies.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/melee/mcbodies.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -15,11 +15,11 @@
 GNU General Public License for more details.
 */
 
+#include &quot;util/sound.h&quot;
 #include &lt;allegro.h&gt;
 #include &lt;string.h&gt;
 #include &lt;stdio.h&gt;
 #include &quot;melee.h&quot;
-REGISTER_FILE
 #include &quot;id.h&quot;
 #include &quot;scp.h&quot;
 #include &quot;frame.h&quot;
@@ -33,7 +33,7 @@
 #include &quot;other/twconfig.h&quot;
 
 Asteroid::Asteroid() 
-:	SpaceObject(NULL, random(map_size), random(PI2), meleedata.asteroidSprite), explosion(meleedata.asteroidExplosionSprite)
+:	SpaceObject(NULL, random(map_size), random(PI2), game-&gt;meleedata.asteroidSprite), explosion(game-&gt;meleedata.asteroidExplosionSprite)
 {
   STACKTRACE;
   collide_flag_sameteam = ALL_LAYERS;
@@ -64,7 +64,8 @@
   SpaceObject::calculate();
 }
 
-int Asteroid::handle_damage(SpaceLocation *source, double normal, double direct) {
+int Asteroid::handle_damage(SpaceLocation *source, double normal, double direct) 
+{
   STACKTRACE;
   if (!exists()) 
     return 0;
@@ -78,9 +79,9 @@
   return 1;
 }
 
-void Asteroid::death() {
-  STACKTRACE;
-			  
+void Asteroid::death() 
+{
+  STACKTRACE;		  
   Animation *a = new Animation(this, pos,
 			       explosion, 0, explosion-&gt;frames(), time_ratio, get_depth());
   a-&gt;match_velocity(this);
@@ -116,15 +117,37 @@
 {
   STACKTRACE;
   int i = 1;
-  if (other-&gt;isShip()) {
-    i = (int) ceil(((Ship*)other)-&gt;crew / 3.0);
-  }
-  if (other-&gt;mass == 0) other-&gt;state = 0;
+  if (other-&gt;isShip()) 
+    {
+      i = (int) ceil(((Ship*)other)-&gt;crew / 3.0);
+    }
+  if (other-&gt;mass == 0) 
+    other-&gt;state = 0;
   damage(other, 0, i);
   i /= 2;
   if (i &gt;= BOOM_SAMPLES) i = BOOM_SAMPLES - 1;
   if (!other-&gt;isShot()) 
-    play_sound((SAMPLE *)(melee[MELEE_BOOM + i].dat));
+    {
+      switch(i)
+	{
+	case 0:
+	  tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL01_WAV.wav&quot;));
+	  break;
+	case 1:
+	  tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL02_WAV.wav&quot;));
+	  break;
+	case 2:
+	  tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL03_WAV.wav&quot;));
+	  break;
+	case 3:
+	  tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL04_WAV.wav&quot;));
+	  break;
+	default:
+	  {
+	    tw_error(&quot;Unknown BOOM sound&quot;);
+	  }
+	}
+    }
   return;
 }
 
@@ -190,7 +213,6 @@
 			  int aa_mode
 			  ) 
 {
-  STACKTRACE;
   int i;
   double wx, wy;
   RNG_FS rng;
@@ -247,7 +269,6 @@
  int aa_mode
  ) 
 {
-  STACKTRACE;
   int i;
   double wx, wy;
   RNG_FS rng;
@@ -346,93 +367,103 @@
 
 Stars::Stars()
 {
-	STACKTRACE;
-
-	int i;
-	v = NULL;
-	set_depth(DEPTH_STARS);
-	DATAFILE *stardat = load_datafile(data_full_path(&quot;stars.dat&quot;).c_str());
-	if (!stardat) {
-		tw_error(&quot;stars.dat not found!&quot;);
-		num_pics = 0;
-		pic = NULL;
-		num_stars = 0;
-		num_layers = 0;
-		return;
-	}
-	for (i = 0; (stardat[i].type == DAT_RLE_SPRITE) || (stardat[i].type == DAT_BITMAP); i += 1) ;
-	num_pics = i;
-	pic = new SpaceSprite*[num_pics];
-	seed = rng.raw64();
-	for(i = 0; i &lt; num_pics; i++) {
-		pic[i] = new SpaceSprite(&amp;stardat[i], 1, 
-			SpaceSprite::ALPHA | 
-			SpaceSprite::MASKED | 
-			SpaceSprite::IRREGULAR | 
-			SpaceSprite::MIPMAPED
-		);
-	}
-	game-&gt;log_file(&quot;server.ini&quot;);
-	width = get_config_int(&quot;Stars&quot;, &quot;Width&quot;, 4000);
-	height = get_config_int(&quot;Stars&quot;, &quot;Height&quot;, 4000);
-	num_stars = get_config_int(&quot;Stars&quot;, &quot;Number&quot;, 150);
-	num_layers = get_config_int(&quot;Stars&quot;, &quot;Layers&quot;, 5);
-	field_depth = get_config_int(&quot;Stars&quot;, &quot;Depth&quot;, 192);
-	tw_set_config_file(&quot;client.ini&quot;);
-	aa_mode = get_config_int(&quot;Stars&quot;, &quot;Quality&quot;, 5);
-	unload_datafile(stardat);
+  STACKTRACE;
+  int i;
+  v = NULL;
+  set_depth(DEPTH_STARS);
+  DATAFILE *stardat = load_datafile(data_full_path(&quot;stars.dat&quot;).c_str());
+  if (!stardat) 
+    {
+      tw_error(&quot;stars.dat not found!&quot;);
+      num_pics = 0;
+      pic = NULL;
+      num_stars = 0;
+      num_layers = 0;
+      return;
+    }
+  for (i = 0; (stardat[i].type == DAT_RLE_SPRITE) || (stardat[i].type == DAT_BITMAP); i += 1) ;
+  num_pics = i;
+  pic = new SpaceSprite*[num_pics];
+  seed = rng.raw64();
+  for(i = 0; i &lt; num_pics; i++) 
+    {
+      pic[i] = new SpaceSprite(&amp;stardat[i], 1, 
+			       SpaceSprite::ALPHA | 
+			       SpaceSprite::MASKED | 
+			       SpaceSprite::IRREGULAR | 
+			       SpaceSprite::MIPMAPED
+			       );
+    }
+  game-&gt;log_file(&quot;server.ini&quot;);
+  width = get_config_int(&quot;Stars&quot;, &quot;Width&quot;, 4000);
+  height = get_config_int(&quot;Stars&quot;, &quot;Height&quot;, 4000);
+  num_stars = get_config_int(&quot;Stars&quot;, &quot;Number&quot;, 150);
+  num_layers = get_config_int(&quot;Stars&quot;, &quot;Layers&quot;, 5);
+  field_depth = get_config_int(&quot;Stars&quot;, &quot;Depth&quot;, 192);
+  tw_set_config_file(&quot;client.ini&quot;);
+  aa_mode = get_config_int(&quot;Stars&quot;, &quot;Quality&quot;, 5);
+  unload_datafile(stardat);
 }
-Stars::~Stars() {STACKTRACE
-	int i;
-	for(i = 0; i &lt; num_pics; i++) delete pic[i];
-	delete[] pic;
-	}
+Stars::~Stars() 
+{
+  int i;
+  for(i = 0; i &lt; num_pics; i++) delete pic[i];
+  delete[] pic;
+}
 
 
-void Stars::animate(Frame *space) {STACKTRACE
-	if (v &amp;&amp; (space_view != *v)) return;
+void Stars::animate(Frame *space) 
+{
+  STACKTRACE;
+  if (v &amp;&amp; (space_view != *v)) return;
 
-	double d = space_zoom;
-	double w = width * d;
-	double h = height * d;
-	int x, y, layer;
-	for (layer = 0; layer &lt; num_layers; layer += 1) {
-		d = space_zoom * pow(1.0 - field_depth / 260.0, (num_layers-layer)/(double)num_layers);
-		for (y = 0; y * h &lt; space-&gt;surface-&gt;h; y+=1) {
-			for (x = 0; x * w &lt; space-&gt;surface-&gt;w; x+=1) {
-				if (aa_mode &amp; 0x80000000) {
-					_draw_starfield_cached ( 
-						space, 
-						pic[layer%num_pics], 
-						0,
-						num_stars / num_layers,
-						(x+0.5)*w, (y+0.5)*h, 
-						-space_center_nowrap.x * d + space_view_size.x / 2, 
-						-space_center_nowrap.y * d + space_view_size.y / 2, 
-						w, h, 
-						w, h, 
-						d + d*fabs(50.0-(((game-&gt;game_time / 10 + layer * 70)) % 100)) / 100.0,
-						seed + layer,
-						aa_mode
-					);
-				}
-				else {
-					_draw_starfield_raw ( 
-						space, 
-						pic[layer%num_pics], 0, 1,
-						num_stars / num_layers,
-						(x+0.5)*w, (y+0.5)*h, 
-						-space_center_nowrap.x * d + space_view_size.x / 2, 
-						-space_center_nowrap.y * d + space_view_size.y / 2, 
-						w, h, 
-						w, h, 
-						d + d*fabs(50.0-(((game-&gt;game_time / 10 + layer * 70)) % 100)) / 100.0,
-						seed + layer,
-						aa_mode &amp; 0x7fffFFFF
-					);
-				}
-			}
+  double d = space_zoom;
+  double w = width * d;
+  double h = height * d;
+  int x, y, layer;
+  for (layer = 0; layer &lt; num_layers; layer += 1) 
+    {
+      d = space_zoom * pow(1.0 - field_depth / 260.0, (num_layers-layer)/(double)num_layers);
+      for (y = 0; y * h &lt; space-&gt;surface-&gt;h; y+=1) 
+	{
+	  for (x = 0; x * w &lt; space-&gt;surface-&gt;w; x+=1) 
+	    {
+	      if (aa_mode &amp; 0x80000000) 
+		{
+		  _draw_starfield_cached 
+		    ( 
+		     space, 
+		     pic[layer%num_pics], 
+		     0,
+		     num_stars / num_layers,
+		     (x+0.5)*w, (y+0.5)*h, 
+		     -space_center_nowrap.x * d + space_view_size.x / 2, 
+		     -space_center_nowrap.y * d + space_view_size.y / 2, 
+		     w, h, 
+		     w, h, 
+		     d + d*fabs(50.0-(((game-&gt;game_time / 10 + layer * 70)) % 100)) / 100.0,
+		     seed + layer,
+		     aa_mode
+		     );
 		}
+	      else 
+		{
+		  _draw_starfield_raw ( 
+				       space, 
+				       pic[layer%num_pics], 0, 1,
+				       num_stars / num_layers,
+				       (x+0.5)*w, (y+0.5)*h, 
+				       -space_center_nowrap.x * d + space_view_size.x / 2, 
+				       -space_center_nowrap.y * d + space_view_size.y / 2, 
+				       w, h, 
+				       w, h, 
+				       d + d*fabs(50.0-(((game-&gt;game_time / 10 + layer * 70)) % 100)) / 100.0,
+				       seed + layer,
+				       aa_mode &amp; 0x7fffFFFF
+				       );
+		}
+	    }
 	}
-	return;
+    }
+  return;
 }

Modified: branches/multiplayer-branch/source/melee/mcontrol.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mcontrol.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/melee/mcontrol.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -20,7 +20,6 @@
 #include &lt;allegro.h&gt;
 
 #include &quot;melee.h&quot;
-REGISTER_FILE
 #include &quot;ais.h&quot;
 #include &quot;id.h&quot;
 
@@ -33,10 +32,6 @@
 #include &quot;scp.h&quot;
 #include &quot;other/dialogs.h&quot;
 
-
-
-
-
 const char num_controls = 4;
 static char *gcc_sucks_dick[num_controls + 2] = 
 		{
@@ -52,7 +47,6 @@
 
 void animate_target(Frame *frame, SpaceLocation *t, int dx, int dy, int r, int c) 
 {
-  STACKTRACE;
   return;
 }
 
@@ -60,8 +54,8 @@
 
 
 
-int control2number(const char *name) {
-  STACKTRACE;
+int control2number(const char *name) 
+{
   if (!name) 
     return 0;
   for (int i = 0; i &lt; num_controls+1; i += 1) 
@@ -74,10 +68,9 @@
 
 Control *getController(const char *type, const char *name, int channel) 
 {
-  STACKTRACE;
   if ((channel != -1) &amp;&amp; (channel &amp; Game::_channel_buffered)) 
     {
-      error(&quot;getController - invalid channel # %d&quot;, channel);
+      tw_error(&quot;getController - invalid channe&quot;);
     }
   switch (control2number(type)) 
     {
@@ -92,12 +85,14 @@
 
 int Control::rand() 
 {
+  STACKTRACE;
   if (channel == Game::channel_none) 
     return random();
   return (::rand() ^ ((::rand() &lt;&lt; 12) + (::rand() &lt;&lt;24))) &amp; 0x7fffffff;
 }
 
-void Control::setup() {}
+void Control::setup() {
+  STACKTRACE;}
 void Control::select_ship(Ship* ship_pointer, const char* ship_name) 
 {
   STACKTRACE;
@@ -116,10 +111,12 @@
 
 void Control::load(const char* inifile, const char* inisection) 
 {
+  STACKTRACE;
   return;
 }
 void Control::save(const char* inifile, const char* inisection) 
 {
+  STACKTRACE;
   return;
 }
 SpaceLocation *Control::get_focus() 
@@ -131,9 +128,9 @@
 }
 
 
-int Control::choose_ship(VideoWindow *window, char * prompt, Fleet *fleet) {
-	STACKTRACE;
-
+int Control::choose_ship(VideoWindow *window, char * prompt, Fleet *fleet) 
+{
+  STACKTRACE;
 	//automatically select a random ship, without interrupting the user.
 	// HumanControl is where a user can select a ship herself.
 		
@@ -143,80 +140,91 @@
 	slot = rand() % fleet-&gt;getSize();
 	return slot ;
 }
-void Control::set_target(int i) {
-	STACKTRACE;
-	if (i &gt;= targets-&gt;N) {tw_error(&quot;oscar hamburger!!!!!!!!!&quot;);}
-	if (i == -1) {
-		index = i;
-		target = NULL;
-		return;
-		}
-	if (!valid_target(targets-&gt;item[i])) {tw_error(&quot;oscer hambuger&quot;);}
-	index = i;
-	target = targets-&gt;item[index];
-	return;
+void Control::set_target(int i) 
+{
+  STACKTRACE;
+  if (i &gt;= targets-&gt;N) {tw_error(&quot;oscar hamburger!!!!!!!!!&quot;);}
+  if (i == -1) 
+    {
+      index = i;
+      target = NULL;
+      return;
+    }
+  if (!valid_target(targets-&gt;item[i])) {tw_error(&quot;oscer hambuger&quot;);}
+  index = i;
+  target = targets-&gt;item[index];
+  return;
+}
+
+void Control::target_stuff() 
+{
+  STACKTRACE;
+  if (index == -1) 
+    {
+      if (targets-&gt;N) 
+	{
+	  index = random() % targets-&gt;N;
+	  target = targets-&gt;item[index];
+	  goto validate;
 	}
-void Control::target_stuff() {STACKTRACE;
-	if (index == -1) {
-		if (targets-&gt;N) {
-			index = random() % targets-&gt;N;
-			target = targets-&gt;item[index];
-			goto validate;
-			}
-		else {
-			goto done;
-			}
-		}
-blah:
-	if (index &gt;= targets-&gt;N) {
-		if (targets-&gt;N) {
-			index -= 1;
-			if (index &lt; 0) index = 0;
-			goto blah;
-			}
-		else {
-			index = -1;
-			target = NULL;
-			goto change;
-			}
-		}
-	if (target == targets-&gt;item[index]) {
-		goto done;
-		}
-	else goto search;
-search:
-	int o;
-	o = index;
-	for (index = 0; index &lt; targets-&gt;N; index += 1) {
+      else 
+	{
+	  goto done;
+	}
+    }
+ blah:
+  if (index &gt;= targets-&gt;N) 
+    {
+      if (targets-&gt;N) 
+	{
+	  index -= 1;
+	  if (index &lt; 0) index = 0;
+	  goto blah;
+	}
+      else 
+	{
+	  index = -1;
+	  target = NULL;
+	  goto change;
+	}
+    }
+  if (target == targets-&gt;item[index]) 
+    {
+      goto done;
+    }
+  else goto search;
+ search:
+  int o;
+  o = index;
+  for (index = 0; index &lt; targets-&gt;N; index += 1) {
 		if (targets-&gt;item[index] == target) {
-			goto done;
-			}
+		  goto done;
 		}
+  }
 	index = o;
-validate:
+ validate:
 	if (!ship) {
-		goto done;
-		}
+	  goto done;
+	}
 	int start;
 	start = index;
 	while (!valid_target(targets-&gt;item[index])) {
-		index = (index + 1) % targets-&gt;N;
-		if (index == start) {
-			index = -1;
-			target = NULL;
+	  index = (index + 1) % targets-&gt;N;
+	  if (index == start) {
+	    index = -1;
+	    target = NULL;
 			goto change;
-			}
-		}
+	  }
+	}
 	target = targets-&gt;item[index];
-change:
-done:
+ change:
+ done:
 	return;
-	}
+}
 
 void Control::calculate() 
 {
-  STACKTRACE;
-  
+  STACKTRACE; 
   if (!exists()) 
     return;
 
@@ -284,12 +292,12 @@
 char *Control::getDescription() 
 {
   STACKTRACE;
-  return iname;
+   return iname;
 }
 void Control::_event(Event *e) 
 {
   STACKTRACE;
-  //add code for lag increase / decrease here
+   //add code for lag increase / decrease here
   return;
 }
 Control::Control(const char *name, int _channel, ControlType controlType) : temporary(false), target_sign_color(255), 
@@ -307,22 +315,22 @@
       _prediction_keys_index = 0;
       if (channel &amp; Game::_channel_buffered) 
 	{
-	  error(&quot;Control::Control - invalid channel!&quot;);
+	  tw_error(&quot;invalid channel!&quot;);
 	}
     }
   iname = strdup(name);
 }
 Control::~Control() 
 {
-  STACKTRACE;
-  if (_prediction_keys) delete[] _prediction_keys;
+   if (_prediction_keys) delete[] _prediction_keys;
 }
 bool Control::die() 
 {
+  STACKTRACE;
   if (channel == Game::channel_none) 
     return Presence::die();
   // controls CANNOT arbitrarily be killed off, because the deal with networking directly
-  error(&quot;controls cannot be killed&quot;);
+  tw_error(&quot;controls cannot be killed&quot;);
   //the error can be removed eventually... 
   //I just want to find out if anything is actually calling this
   //because before this function was added, that would have resulted in a desynch
@@ -331,6 +339,7 @@
 
 bool Control::valid_target(SpaceObject *t) 
 {
+  STACKTRACE;
   // GEO: this error sometimes occur, unknown why.
   // speculation: it happened with a wasx clone; perhaps its mother died before
   // and since it shared control, and didn't check for a dead mother before the

Modified: branches/multiplayer-branch/source/melee/mfleet.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mfleet.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/melee/mfleet.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -23,7 +23,6 @@
 #include &lt;allegro.h&gt;
 
 #include &quot;melee.h&quot;
-REGISTER_FILE
 #include &quot;mfleet.h&quot;
 
 #include &quot;other/twconfig.h&quot;
@@ -77,14 +76,15 @@
 	reference_fleet-&gt;Sort();
 }
 
-    Fleet::Fleet() {STACKTRACE
+    Fleet::Fleet() {
+  STACKTRACE;
         cost = 0;
         maxFleetCost = (FleetCost)FLEET_COST_DEFAULT;
         memset(title, '\0', MAX_TITLE_LENGTH);
     };
 
     void Fleet::reset() {
-		STACKTRACE;
+  STACKTRACE;
         ships.clear();
         this-&gt;cost = 0;
         memset(title, '\0', MAX_TITLE_LENGTH);
@@ -121,7 +121,8 @@
 #define READ(a) if (int(s+sizeof(a))&gt;psize) {delete k;tw_error (&quot;deserialize_fleet - bad!&quot;);}memcpy(&amp;a, &amp;buffy[s], sizeof(a)); s += sizeof(a);
 #define READ2(a,b) if (b+s&gt;psize) {delete k;tw_error (&quot;deserialize_fleet - bad!&quot;);}memcpy(&amp;a, &amp;buffy[s], b); s += b;
 
-void Fleet::deserialize(void *data, int psize) {        
+void Fleet::deserialize(void *data, int psize) {
+  STACKTRACE;        
   unsigned char *buffy = (unsigned char *) data;
   int s = 0;
   int j;
@@ -177,6 +178,7 @@
        
 
     int Fleet::addShipType(ShipType * type) {
+  STACKTRACE;
         if ( (getSize() &gt;= MAX_FLEET_SIZE) || (type == NULL))
             return -1;
 
@@ -187,6 +189,7 @@
     }
 
     void Fleet::addFleet(Fleet * fleetToAdd) {
+  STACKTRACE;
         for (int i=0; i&lt;fleetToAdd-&gt;getSize(); i++)
             addShipType(fleetToAdd-&gt;getShipType(i));
     }
@@ -199,14 +202,16 @@
     
     }
 
-    ShipType * Fleet::getShipType(int slot) {STACKTRACE
+    ShipType * Fleet::getShipType(int slot) {
+  STACKTRACE;
         if ( (slot&lt;0) || (slot&gt;=(int)ships.size()))
             return NULL;
 
         return ships[slot];
     }
 
-    void Fleet::save(const char *filename, const char *section) {STACKTRACE
+    void Fleet::save(const char *filename, const char *section) {
+  STACKTRACE;
         int count = 0;
         char slot_str[8];
     
@@ -228,7 +233,8 @@
         set_config_int(section, &quot;MaxFleetCost&quot;, getMaxCost());
     }
 
-    void Fleet::load(const char *filename, const char *section) {STACKTRACE
+    void Fleet::load(const char *filename, const char *section) {
+  STACKTRACE;
         int i, count;
         ShipType *type;
         char slot_str[8];
@@ -386,6 +392,7 @@
 };
 
 void Fleet::Sort(SortingMethod sortMethod, bool ascending, int startIndex, int endIndex) {
+  STACKTRACE;
   MyFleetListType::iterator _begin, _end;
   int _size = ships.size();
   
@@ -465,6 +472,7 @@
 }
 
 int Fleet::getNextFleetEntryByCharacter(unsigned int currentShip, char c) {
+  STACKTRACE;
         
         ASSERT(ships.at(currentShip) != NULL);
         ASSERT(currentShip &lt; ships.size());

Modified: branches/multiplayer-branch/source/melee/mframe.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mframe.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/melee/mframe.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -15,6 +15,7 @@
 GNU General Public License for more details.
 */
 
+#include &quot;util/sound.h&quot;
 #include &lt;allegro.h&gt;
 #ifdef WIN32
 #include &lt;winalleg.h&gt;
@@ -25,7 +26,6 @@
 #include &lt;functional&gt;
 
 #include &quot;melee.h&quot;
-REGISTER_FILE
 #include &quot;id.h&quot;
 #include &quot;frame.h&quot;
 #include &quot;util/aastr.h&quot;
@@ -38,6 +38,7 @@
 #include &quot;mcbodies.h&quot;
 #include &quot;util/pmask.h&quot;
 #include &quot;other/twconfig.h&quot;
+#include &quot;scp.h&quot;
 
 int total_presences;
 
@@ -67,7 +68,7 @@
 int physics_time = 0;
 int render_time = 0;
 int frame_time = 1;
-DATAFILE *melee = NULL;
+//DATAFILE *melee = NULL;
 Vector2 map_size;
 double MAX_SPEED = 0;
 
@@ -173,7 +174,8 @@
 	return;
 	}
 
-void Query::end() {STACKTRACE
+void Query::end() {
+  STACKTRACE;
 	}
 
 
@@ -293,11 +295,13 @@
 	return;
 	}
 
-void Query2::end() {STACKTRACE
+void Query2::end() {
+  STACKTRACE;
 	}
 
 
-Presence::Presence() {STACKTRACE
+Presence::Presence() {
+  STACKTRACE;
 	total_presences += 1;
 	attributes = 0;
 	state = 1;
@@ -364,10 +368,12 @@
 	return ((attributes &amp; ATTRIB_SYNCHED) != 0);
 	}
 
-SpaceLocation *Presence::get_focus() {STACKTRACE
+SpaceLocation *Presence::get_focus() {
+  STACKTRACE;
 	return NULL;
 	}
-SpaceLocation *SpaceLocation::get_focus() {STACKTRACE
+SpaceLocation *SpaceLocation::get_focus() {
+  STACKTRACE;
 	return this;
 	}
 
@@ -382,7 +388,8 @@
 	collide_flag_sameteam(0),
 	collide_flag_sameship(0)
 
-{STACKTRACE
+{
+  STACKTRACE;
 	id |= SPACE_LOCATION;
 	attributes |= ATTRIB_SYNCHED;
 	attributes |= ATTRIB_LOCATION;
@@ -407,7 +414,8 @@
 
 	}
 
-bool SpaceLocation::change_owner(SpaceLocation *new_owner) {STACKTRACE
+bool SpaceLocation::change_owner(SpaceLocation *new_owner) {
+  STACKTRACE;
 	if (new_owner) {
 		ally_flag = new_owner-&gt;ally_flag;
 		ship = new_owner-&gt;ship;
@@ -421,7 +429,8 @@
 	return true;
 	}
 
-void SpaceLocation::death() {STACKTRACE
+void SpaceLocation::death() {
+  STACKTRACE;
 }
 
 double SpaceLocation::get_angle_ex() const
@@ -455,7 +464,8 @@
 }
 
 double SpaceLocation::distance(SpaceLocation *l)
-{STACKTRACE
+{
+  STACKTRACE;
   return(distance_from(normal_pos(), l-&gt;normal_pos()));
 }
 
@@ -473,6 +483,7 @@
 
 void SpaceLocation::change_vel(Vector2 dvel)
 {
+  STACKTRACE;
 	vel += dvel;
 }
 
@@ -480,6 +491,7 @@
 */
 void SpaceLocation::change_pos(Vector2 dpos)
 {
+  STACKTRACE;
 	pos = normalize(pos + dpos);
 }
 
@@ -487,23 +499,28 @@
 */
 void SpaceLocation::change_pos(double scale)
 {
+  STACKTRACE;
 	pos *= scale;
 }
 
-void SpaceLocation::ship_died() {STACKTRACE
+void SpaceLocation::ship_died() {
+  STACKTRACE;
 	ship = NULL;
 }
 void SpaceLocation::target_died() {
+  STACKTRACE;
 	target = NULL;
 }
 
-double SpaceLocation::trajectory_angle(SpaceLocation *l) {STACKTRACE
+double SpaceLocation::trajectory_angle(SpaceLocation *l) {
+  STACKTRACE;
 	return ::trajectory_angle(pos, l-&gt;normal_pos());
 }
 
 
 bool inline SpaceLocation::detectable()
 {
+  STACKTRACE;
 	int i;
 	i = attributes &amp; ATTRIB_UNDETECTABLE;
 
@@ -514,6 +531,7 @@
 
 
 int SpaceLocation::canCollide(SpaceLocation *other) {
+  STACKTRACE;
 	if (!detectable()) return 0;
 	if (sameShip(other)) return ((1 &lt;&lt; other-&gt;layer) &amp; collide_flag_sameship);
 	else if (sameTeam(other)) return ((1 &lt;&lt; other-&gt;layer) &amp; collide_flag_sameteam);
@@ -527,6 +545,7 @@
 
 void SpaceLocation::set_team(TeamCode k)
 {
+  STACKTRACE;
 	ally_flag &amp;= ~team_mask;
 	ally_flag |= k &lt;&lt; team_shift;
 }
@@ -544,14 +563,17 @@
 }
 
 void Presence::set_depth(double d) {
+  STACKTRACE;
 	_depth = int(floor(ldexp(d, 8)));
 }
 
 double Presence::get_depth() {
+  STACKTRACE;
 	return ldexp((double)_depth, -8);
 }
 
-Planet *SpaceLocation::nearest_planet() {STACKTRACE
+Planet *SpaceLocation::nearest_planet() {
+  STACKTRACE;
 	Planet *p = NULL;
 	double r = 99999999;
 	Query q;
@@ -568,120 +590,147 @@
 	}
 	return p;
 }
-void SpaceLocation::play_sound (SAMPLE *sample, int vol, int freq) {STACKTRACE
-	physics-&gt;play_sound(sample, this, vol, freq);
-	return;
+
+int SpaceLocation::translate( Vector2 delta) 
+{
+  STACKTRACE;
+  pos = normalize ( pos + delta, map_size );
+  return true;
 }
-void SpaceLocation::play_sound2 (SAMPLE *sample, int vol, int freq) {STACKTRACE
-	physics-&gt;play_sound2(sample, this, vol, freq);
-	return;
-}
-int SpaceLocation::translate( Vector2 delta) {STACKTRACE
-	pos = normalize ( pos + delta, map_size );
-	return true;
-}
 
-int SpaceLocation::accelerate(SpaceLocation *source, double angle, double velocity, double max_speed) {STACKTRACE
-	_accelerate(angle, velocity, max_speed);
-	return true;
+int SpaceLocation::accelerate(SpaceLocation *source, double angle, double velocity, double max_speed) 
+{
+  STACKTRACE;
+  _accelerate(angle, velocity, max_speed);
+  return true;
 }
-int SpaceLocation::accelerate(SpaceLocation *source, Vector2 delta_v, double max_speed) {STACKTRACE
-	_accelerate(delta_v, max_speed);
-	return true;
+int SpaceLocation::accelerate(SpaceLocation *source, Vector2 delta_v, double max_speed) 
+{
+  STACKTRACE;
+  _accelerate(delta_v, max_speed);
+  return true;
 }
-void SpaceLocation::_accelerate(double angle, double velocity, double max_speed) {STACKTRACE
-	double ovm, nvm;
-	Vector2 nv;
+void SpaceLocation::_accelerate(double angle, double velocity, double max_speed) 
+{
+  STACKTRACE;
+  double ovm, nvm;
+  Vector2 nv;
 
-	ovm = magnitude_sqr(vel);
-	nv = vel + unit_vector(angle) * velocity;
-	nvm = magnitude_sqr(nv);
-	if ((nvm &lt;= max_speed * max_speed) || (nvm &lt;= ovm)) {
-		vel = nv;
-	}
-	else {
-		if (ovm &lt;= max_speed * max_speed) ovm = max_speed;
-		else ovm = sqrt(ovm);
-		vel = nv * ovm / (ovm + velocity);
-	}
-	return;
+  ovm = magnitude_sqr(vel);
+  nv = vel + unit_vector(angle) * velocity;
+  nvm = magnitude_sqr(nv);
+  if ((nvm &lt;= max_speed * max_speed) || (nvm &lt;= ovm)) 
+    {
+      vel = nv;
+    }
+  else 
+    {
+      if (ovm &lt;= max_speed * max_speed) ovm = max_speed;
+      else ovm = sqrt(ovm);
+      vel = nv * ovm / (ovm + velocity);
+    }
+  return;
 }
-void SpaceLocation::_accelerate(Vector2 delta_v, double max_speed) {STACKTRACE
-	double ovm, nvm;
-	Vector2 nv;
 
-	ovm = magnitude_sqr(vel);
-	nv = vel + delta_v;
-	nvm = magnitude_sqr(nv);
-	if ((nvm &lt;= max_speed * max_speed) || (nvm &lt;= ovm)) {
-		//if new velocity is slow, handle normally
-		//if new velocity is fast, but we're decelerating, still handle normally
-		vel = nv;
-	}
-	else {
-		if (ovm &lt;= max_speed * max_speed) ovm = max_speed;
-		else ovm = sqrt(ovm);
-		//otherwise, slow down closer to the maximum speed
-		//but only when turning, particularly turning fast
-		vel = nv * ovm / (ovm + magnitude(delta_v));
-	}
-	return;
+void SpaceLocation::_accelerate(Vector2 delta_v, double max_speed) 
+{
+  STACKTRACE;
+  double ovm, nvm;
+  Vector2 nv;
+
+  ovm = magnitude_sqr(vel);
+  nv = vel + delta_v;
+  nvm = magnitude_sqr(nv);
+  if ((nvm &lt;= max_speed * max_speed) || (nvm &lt;= ovm)) 
+    {
+      //if new velocity is slow, handle normally
+      //if new velocity is fast, but we're decelerating, still handle normally
+      vel = nv;
+    }
+  else 
+    {
+      if (ovm &lt;= max_speed * max_speed) ovm = max_speed;
+      else ovm = sqrt(ovm);
+      //otherwise, slow down closer to the maximum speed
+      //but only when turning, particularly turning fast
+      vel = nv * ovm / (ovm + magnitude(delta_v));
+    }
+  return;
 }
 
-int SpaceLocation::accelerate_gravwhip(SpaceLocation *source, double angle, double velocity, double max_speed) {STACKTRACE
+int SpaceLocation::accelerate_gravwhip(SpaceLocation *source, 
+				       double angle, 
+				       double velocity, 
+				       double max_speed) 
+{
+  STACKTRACE;
 	Planet *p = nearest_planet();
 	if (!p) return SpaceLocation::accelerate(source, angle, velocity, max_speed);
 	double tmp;
 	tmp = distance(p) / p-&gt;gravity_range;
 	if (tmp &gt; 1) return SpaceLocation::accelerate(source, angle, velocity, max_speed);
-	return SpaceLocation::accelerate(source, angle, velocity, max_speed * (p-&gt;gravity_whip * tmp + 1) + tmp * p-&gt;gravity_whip2);
+	return SpaceLocation::accelerate(source, angle, 
+					 velocity, 
+					 max_speed * (p-&gt;gravity_whip * tmp + 1) + 
+					 tmp * p-&gt;gravity_whip2);
 }
 
-void SpaceLocation::animate(Frame* f) {
+void SpaceLocation::animate(Frame* f) 
+{
   STACKTRACE;
 }
 
-void SpaceLocation::calculate() {STACKTRACE
-	if (target &amp;&amp; !target-&gt;exists()) {
-		target_died();
-	}
-	if (ship &amp;&amp; !ship-&gt;exists()) {
-		ship_died();
-	}
-	return;
+void SpaceLocation::calculate() 
+{
+  STACKTRACE;
+  if (target &amp;&amp; !target-&gt;exists()) 
+    {
+      target_died();
+    }
+  if (ship &amp;&amp; !ship-&gt;exists()) 
+    {
+      ship_died();
+    }
+  return;
 }
 
-void SpaceObject::set_sprite(SpaceSprite *new_sprite) {STACKTRACE
-	sprite = new_sprite;
-	size = new_sprite-&gt;size();
+void SpaceObject::set_sprite(SpaceSprite *new_sprite) 
+{
+  STACKTRACE;
+  sprite = new_sprite;
+  size = new_sprite-&gt;size();
 }
 
-void SpaceObject::calculate() {STACKTRACE
-	SpaceLocation::calculate();
-	if ((attributes &amp; ATTRIB_STANDARD_INDEX) &amp;&amp; sprite) {
-		sprite_index = get_index(angle, PI/2, sprite-&gt;frames());
-	}
-	return;
+void SpaceObject::calculate() 
+{
+  STACKTRACE;
+  SpaceLocation::calculate();
+  if ((attributes &amp; ATTRIB_STANDARD_INDEX) &amp;&amp; sprite) 
+    {
+      sprite_index = get_index(angle, PI/2, sprite-&gt;frames());
+    }
+  return;
 }
 
 SpaceObject::SpaceObject(SpaceLocation *creator, Vector2 opos, 
-	double oangle, SpaceSprite *osprite) 
-	:
-	SpaceLocation(creator, opos, oangle),
-	size(osprite-&gt;width(), osprite-&gt;height()),
-	mass(0),
-	sprite(osprite),
-	sprite_index(0)
-	{STACKTRACE
-	attributes |= ATTRIB_OBJECT;
-	if (game &amp;&amp; game-&gt;friendly_fire) collide_flag_sameteam = ALL_LAYERS;
-	collide_flag_sameship = 0;
-	collide_flag_anyone = ALL_LAYERS;
-	id = SPACE_OBJECT;
+			 double oangle, SpaceSprite *osprite) 
+  :
+  SpaceLocation(creator, opos, oangle),
+  size(osprite-&gt;width(), osprite-&gt;height()),
+  mass(0),
+  sprite(osprite),
+  sprite_index(0)
+{
+  STACKTRACE;
+  attributes |= ATTRIB_OBJECT;
+  if (game &amp;&amp; game-&gt;friendly_fire) collide_flag_sameteam = ALL_LAYERS;
+  collide_flag_sameship = 0;
+  collide_flag_anyone = ALL_LAYERS;
+  id = SPACE_OBJECT;
+  
+  isblockingweapons = true;
+}
 
-	isblockingweapons = true;
-	}
-
 void SpaceObject::animate(Frame *space) 
 {
   STACKTRACE;
@@ -707,18 +756,10 @@
   dp.y = min_delta(p1.y, p2.y, map_size.y);
   p2 = p1 - dp - other-&gt;size / 2;
   p1 = p1 - size / 2;
-  
-  /*	x1 = (int)(normal_x() - (w / 2.0));
-	y1 = (int)(normal_y() - (h / 2.0));
-	dx = min_delta(normal_x(), other-&gt;normal_x(), map_size.x);
-	dy = min_delta(normal_y(), other-&gt;normal_y(), Y_MAX);
-	x2 = (int)(normal_x() - dx - ((other-&gt;w) / 2.0));
-	y2 = (int)(normal_y() - dy - ((other-&gt;h) / 2.0));*/
-  
+    
   if (!sprite-&gt;collide((int)p1.x, (int)p1.y, sprite_index, (int)p2.x, (int)p2.y, 
 		       other-&gt;sprite_index, other-&gt;sprite)) 
     return;
-  //sprite-&gt;collide(x1, y1, sprite_index, x2, y2, other-&gt;sprite_index, other-&gt;sprite);
 
   inflict_damage(other);
   other-&gt;inflict_damage(this);
@@ -744,20 +785,17 @@
   tmp = dot_product(dv, _dp);
   tmp = ( -2 * tmp );
   tmp = tmp * (mass * other-&gt;mass) / (mass + other-&gt;mass);
-  if (tmp &gt;= 0) {
-    //vel += _dp * tmp / mass;
-    //other-&gt;vel -= _dp * tmp / other-&gt;mass;
-    change_vel(_dp * tmp / mass);
-    other-&gt;change_vel( -_dp * tmp / other-&gt;mass);
-  }
+  if (tmp &gt;= 0) 
+    {
+      change_vel(_dp * tmp / mass);
+      other-&gt;change_vel( -_dp * tmp / other-&gt;mass);
+    }
   
   Vector2 nd;
 	nd = unit_vector(dp);
 	nd /= (mass + other-&gt;mass);
 	while (sprite-&gt;collide((int)p1.x, (int)p1.y, sprite_index, (int)p2.x, (int)p2.y, 
 			       other-&gt;sprite_index, other-&gt;sprite)) {
-	  //pos = normalize(pos + nd * other-&gt;mass);
-	  //other-&gt;pos = normalize(other-&gt;pos - nd * mass);
 	  change_pos(nd * other-&gt;mass);
 	  other-&gt;change_pos(-nd * mass);
 	  
@@ -773,7 +811,8 @@
 }
 
 double SpaceObject::collide_ray(Vector2 lp1, Vector2 lp2, double llength)
-{STACKTRACE
+{
+  STACKTRACE;
 	int collide_x = (int)(lp2.x);
 	int collide_y = (int)(lp2.y);
 	Vector2 d;
@@ -790,19 +829,45 @@
 	return(llength);
 }
 
-void SpaceObject::inflict_damage(SpaceObject *other) {STACKTRACE
-	int i;
-	if (damage_factor &gt; 0) {
-		i = iround_down(damage_factor / 2);
-		if(i &gt;= BOOM_SAMPLES) i = BOOM_SAMPLES - 1;
-		play_sound((SAMPLE *)(melee[MELEE_BOOM + i].dat));
-		damage(other, damage_factor);
-		}
-	else damage(other, 0);
-	return;
+void SpaceObject::inflict_damage(SpaceObject *other) 
+{
+  STACKTRACE;
+  int i;
+  if (damage_factor &gt; 0) 
+    {
+      i = iround_down(damage_factor / 2);
+      if(i &gt;= BOOM_SAMPLES) 
+	i = BOOM_SAMPLES - 1;
+      
+      // temporary code
+      switch(i)
+	{
+	  case 0:
+	    tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL01_WAV.wav&quot;));
+	    break;
+	  case 1:
+	    tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL02_WAV.wav&quot;));
+	    break;
+	  case 2:
+	    tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL03_WAV.wav&quot;));
+	    break;
+	  case 3:
+	    tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL04_WAV.wav&quot;));
+	    break;
+	default:
+	  {
+	    tw_error(&quot;Unknown BOOM sound %d&quot;, i);
+	  }
 	}
+      damage(other, damage_factor);
+    }
+  else 
+    damage(other, 0);
+  return;
+}
 
-void SpaceObject::death() {STACKTRACE
+void SpaceObject::death() {
+  STACKTRACE;
 	if (attributes &amp; ATTRIB_NOTIFY_ON_DEATH) {
 		physics-&gt;object_died(this, NULL);
 		attributes &amp;= ~ ATTRIB_NOTIFY_ON_DEATH;
@@ -815,7 +880,8 @@
 	SpaceLocation(creator, lpos, langle),
 	length(llength),
 	color(lcolor)
-	{STACKTRACE
+	{
+  STACKTRACE;
 	id = SPACE_LINE;
 	attributes |= ATTRIB_LINE;// | ATTRIB_COLLIDE_STATIC;
 	layer = LAYER_LINES;
@@ -845,21 +911,41 @@
   return(length);
 }
 
-void SpaceLine::inflict_damage(SpaceObject *other) {STACKTRACE
-	int i;
-	i = iround_down(damage_factor / 2);
-	if(i &gt;= BOOM_SAMPLES)
-		i = BOOM_SAMPLES - 1;
-	play_sound((SAMPLE *)(melee[MELEE_BOOM + i].dat));
-	damage(other, damage_factor);
-	collide_flag_anyone = collide_flag_sameship = collide_flag_sameteam = 0;
-	physics-&gt;add(new Animation( this, 
-			pos + edge(), meleedata.sparkSprite, 0, 
-			SPARK_FRAMES, 50, DEPTH_EXPLOSIONS));
-	return;
-	}
+void SpaceLine::inflict_damage(SpaceObject *other) 
+{
+  STACKTRACE;
+  int i;
+  i = iround_down(damage_factor / 2);
+  if(i &gt;= BOOM_SAMPLES)
+    i = BOOM_SAMPLES - 1;
 
-void SpaceLine::animate(Frame *space) {
+  // temporary code
+  switch(i)
+    {
+    case 0:
+      tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL01_WAV.wav&quot;));
+      break;
+    case 1:
+      tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL02_WAV.wav&quot;));
+      break;
+    case 2:
+      tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL03_WAV.wav&quot;));
+      break;
+    case 3:
+      tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL04_WAV.wav&quot;));
+      break;
+    }
+
+  damage(other, damage_factor);
+  collide_flag_anyone = collide_flag_sameship = collide_flag_sameteam = 0;
+  physics-&gt;add(new Animation( this, 
+			      pos + edge(), game-&gt;meleedata.sparkSprite, 0, 
+			      SPARK_FRAMES, 50, DEPTH_EXPLOSIONS));
+  return;
+}
+
+void SpaceLine::animate(Frame *space) 
+{
   STACKTRACE;
   
   Vector2 p1 = corner( pos );
@@ -915,10 +1001,12 @@
 }
 
 unsigned int Physics::new_ship() {
+  STACKTRACE;
 	last_ship += 1;
 	return last_ship;
 	}
 TeamCode Physics::new_team() {
+  STACKTRACE;
 	last_team += 1;
 	return last_team;
 	}
@@ -965,7 +1053,7 @@
 
 
 void Physics::add(SpaceLocation *o) {
-	STACKTRACE;
+  STACKTRACE;
 	if (o-&gt;attributes &amp; ATTRIB_INGAME) {tw_error(&quot;addItem - already added&quot;);}
 	if (!o-&gt;isLocation()) {tw_error(&quot;addItem - catastrophic&quot;);}
 	//if (!o-&gt;_serial) _list(o);
@@ -1055,8 +1143,9 @@
     return false;
 }
 
-void Physics::calculate() {
-  _STACKTRACE(&quot;Physics::calculate()&quot;);
+void Physics::calculate() 
+{
+  STACKTRACE;
   int i;
   
   //adjust time
@@ -1195,8 +1284,9 @@
 }
 
 
-void Physics::collide() {
-  _STACKTRACE(&quot;Physics::collide()&quot;);
+void Physics::collide() 
+{
+  STACKTRACE;
   PMASKDATA_FLOAT *tmp;
   int l = 0;
   tmp = new PMASKDATA_FLOAT[item.size()];
@@ -1250,7 +1340,8 @@
   return;
 }
 
-void Physics::prepare() {STACKTRACE
+void Physics::prepare() {
+  STACKTRACE;
 	::physics_time = this-&gt;game_time;
 	::render_time = this-&gt;game_time;
 	::frame_time = this-&gt;frame_time;
@@ -1259,7 +1350,7 @@
 	return;
 }
 int Physics::checksum() {
-  _STACKTRACE(&quot;Physics::checksum&quot;);
+  STACKTRACE;
   Uint32 g = 0;
   for(std::list&lt;SpaceLocation*&gt;::iterator i=item.begin();i!=item.end();i++)
     {
@@ -1273,23 +1364,10 @@
     }
   return g;// + (tw_random_state_checksum()) &amp; 255));
 }
-void Physics::dump_state ( const char *file_name ) {
-  STACKTRACE;
-  //unimplemented
+void Physics::dump_state ( const char *file_name ) 
+{
 }
-void Physics::play_sound (SAMPLE *sample, SpaceLocation *source, int vol, int freq) {
-  STACKTRACE;
-  sound.play(sample, vol, 128, iround(freq * turbo));
-  return;
-}
-void Physics::play_sound2 (SAMPLE *sample, SpaceLocation *source, int vol, int freq) {
-  STACKTRACE;
-  sound.stop(sample);
-  play_sound(sample, source, vol, freq);
-  return;
-}
 
-
 void Physics::log_file (const char *fname)
 {
   tw_set_config_file(fname);
@@ -1298,12 +1376,14 @@
 
 void Physics::ship_died(Ship *who, SpaceLocation *source)
 {
+  STACKTRACE;
 	// nothing ...
 }
 
 
 void Physics::object_died(SpaceObject *who, SpaceLocation *source)
 {
+  STACKTRACE;
   if (who &amp;&amp; who-&gt;isShip())
     {
       ship_died((Ship*)who, source);

Modified: branches/multiplayer-branch/source/melee/mframe.h
===================================================================
--- branches/multiplayer-branch/source/melee/mframe.h	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/melee/mframe.h	2004-09-28 19:53:03 UTC (rev 71)
@@ -29,7 +29,7 @@
 extern Vector2 map_size;
 extern double MAX_SPEED;
 
-extern DATAFILE *melee;
+//extern DATAFILE *melee;
 
 typedef unsigned int TeamCode;
 
@@ -37,368 +37,380 @@
 class Planet;
 class Presence;
 
-
 enum {
-	ATTRIB_SYNCHED         =    (1&lt;&lt;0), 
-	ATTRIB_LOGGED =             (1&lt;&lt;1), 
-	ATTRIB_INGAME =             (1&lt;&lt;2), 
+  ATTRIB_SYNCHED         =    (1&lt;&lt;0), 
+  ATTRIB_LOGGED          =    (1&lt;&lt;1), 
+  ATTRIB_INGAME          =    (1&lt;&lt;2), 
+  
+  ATTRIB_TARGET          =    (1&lt;&lt;3),
+  ATTRIB_FOCUS           =    (1&lt;&lt;4),
+  ATTRIB_ACTIVE_FOCUS    =    (1&lt;&lt;5),
+  
+  ATTRIB_NOTIFY_ON_DEATH =    (1&lt;&lt;6),
+  
+  ATTRIB_STANDARD_INDEX  =    (1&lt;&lt;7),
+  ATTRIB_STRICT_RECT     =    (1&lt;&lt;8),
+  
+  ATTRIB_COLLIDE_STATIC  =    (1&lt;&lt;9),
+  
+  ATTRIB_LOCATION        =    (1&lt;&lt;10), 
+  ATTRIB_OBJECT          =    (1&lt;&lt;11), 
+  ATTRIB_LINE            =    (1&lt;&lt;12),
+  ATTRIB_SHOT            =    (1&lt;&lt;13), 
+  ATTRIB_SHIP            =    (1&lt;&lt;14),
 
-	ATTRIB_TARGET =             (1&lt;&lt;3),
-	ATTRIB_FOCUS  =             (1&lt;&lt;4),
-	ATTRIB_ACTIVE_FOCUS =       (1&lt;&lt;5),
-
-	ATTRIB_NOTIFY_ON_DEATH =    (1&lt;&lt;6),
-
-	ATTRIB_STANDARD_INDEX =     (1&lt;&lt;7),
-	ATTRIB_STRICT_RECT =        (1&lt;&lt;8),
-
-	ATTRIB_COLLIDE_STATIC =     (1&lt;&lt;9),
-
-	//ATTRIB_BOUNCY         //currently, anything that has mass
-	//ATTRIB_MASSFULL       //anything that has mass
-	//ATTRIB_CREWED         //currently, only ships with green crew
-	//ATTRIB_ORGANIC        //currently, only ships with green crew
-	//ATTRIB_SENTIENT       //currently, only ships
-	//ATTRIB_NEUTRAL        //asteroids &amp; planets
-	//ATTRIB_CONTACT_DANGER //things to avoid
-
-	ATTRIB_LOCATION =           (1&lt;&lt;10), 
-	ATTRIB_OBJECT =             (1&lt;&lt;11), 
-	ATTRIB_LINE =               (1&lt;&lt;12),
-	ATTRIB_SHOT =               (1&lt;&lt;13), 
-	ATTRIB_SHIP =               (1&lt;&lt;14),
-
-	// this hides objects from queries = important in case there are many objects (hide hotspots!!)!
-	ATTRIB_UNDETECTABLE =       (1&lt;&lt;15)
+  // this hides objects from queries = important in case there are many objects (hide hotspots!!)!
+  ATTRIB_UNDETECTABLE    =    (1&lt;&lt;15)
 };
 
+/// \brief melee universe
+class Physics : public BaseClass 
+{
+ public:
+  
+  std::vector&lt;SpaceLocation*&gt; quadrant;
+  friend struct Query;
+  
+  std::list&lt;SpaceLocation*&gt; item;
+  
+  std::list&lt;Presence*&gt; presence;
+  
+  /// add space location to universe
+  void add(SpaceLocation *p);
+  /// add presence from universe
+  void add(Presence *p);
+  /// remove space location to universe
+  bool remove(SpaceLocation *o);
+  /// remove presence from universe
+  bool remove(Presence *p) ;
+  
+  TeamCode last_team;
+  unsigned int last_ship;
 
-class Physics : public BaseClass {
-	public:
-
-	std::vector&lt;SpaceLocation*&gt; quadrant;
-	friend struct Query;
-
-	//int num_items, max_items;
-	std::list&lt;SpaceLocation*&gt; item;
-
-	//int num_presences, max_presences;
-	std::list&lt;Presence*&gt; presence;
-
-	void add(SpaceLocation *p);
-	void add(Presence *p);
-	bool remove(SpaceLocation *o);
-	bool remove(Presence *p) ;
-
-	TeamCode last_team;
-	unsigned int last_ship;
-
-	protected:
-	virtual void collide();
-
-	public:
-	virtual unsigned int new_ship();
-	virtual TeamCode new_team();
-	unsigned int get_code(unsigned int ship, TeamCode team) ;
-	virtual void merge_teams ( TeamCode team1, TeamCode team2) ; //causes team1 and team2 to be the same team (changes members of team2 to being members of team1 instead)
-	virtual void switch_team ( unsigned int ship,  TeamCode team ) ; //causes ship to join team.  if ship was already on an old team, ship betrays that team.  
-
-	int frame_number; //the total number of frames that have passed so far
-	int frame_time;
-	int game_time;
-	double max_speed;
-	Vector2 size;
-	double turbo;
-
-	virtual void prepare();
-
-	virtual void calculate();
-	virtual void animate(Frame *frame);
-
-	/*Presence *find_serial(int serial);
-	int _find_serial(int serial);*/
-
-	virtual void play_sound (SAMPLE *sample, SpaceLocation *source, int vol = 255, int freq = 1000);
-	virtual void play_sound2 (SAMPLE *sample, SpaceLocation *source, int vol = 255, int freq = 1000);
-
-	virtual void preinit();
-	virtual void init();
-	virtual ~Physics();
-	virtual void destroy_all();
-
-	virtual int checksum();
-	virtual void dump_state ( const char *file_name );
-
-	// moved ROB - from mgame to here.
-	bool friendly_fire;
-	double shot_relativity;
-
-	// to init parameters of space-objects...
-	virtual void log_file (const char *fname);
-
-	// to handle the death of objects in the game ...
-	virtual void object_died(SpaceObject *who, SpaceLocation *source);
-	virtual void ship_died(Ship *who, SpaceLocation *source);
+ protected:
+  /// \brief calculate which object collide
+  virtual void collide();
+  
+ public:
+  virtual unsigned int new_ship();
+  virtual TeamCode new_team();
+  unsigned int get_code(unsigned int ship, TeamCode team) ;
+  /// \brief causes team1 and team2 to be the same team (changes members of team2 to 
+  /// being members of team1 instead)
+  virtual void merge_teams ( TeamCode team1, TeamCode team2) ; 
+  /// causes ship to join team.  if ship was already on an old team, ship betrays that team.  
+  virtual void switch_team ( unsigned int ship,  TeamCode team ) ; 
+  
+  /// the total number of frames that have passed so far
+  int frame_number; 
+  int frame_time;
+  int game_time;
+  double max_speed;
+  Vector2 size;
+  double turbo;
+  
+  virtual void prepare();
+  
+  virtual void calculate();
+  virtual void animate(Frame *frame);
+    
+  virtual void preinit();
+  virtual void init();
+  virtual ~Physics();
+  virtual void destroy_all();
+  
+  virtual int checksum();
+  virtual void dump_state ( const char *file_name );
+  
+  bool friendly_fire;  ///&lt; is friendly fire damage
+  double shot_relativity;
+  
+  /// to init parameters of space-objects...
+  virtual void log_file (const char *fname);
+  
+  /// to handle the death of objects in the game ...
+  virtual void object_died(SpaceObject *who, SpaceLocation *source);
+  virtual void ship_died(Ship *who, SpaceLocation *source);
 };
 
 /// \brief Any item in the game
-class Presence : public BaseClass { 
-	friend class Physics;
-	public:
+class Presence : public BaseClass 
+{ 
+  friend class Physics;
+ public:
+  int    id;           ///&lt; id code, indicates what type it is
+  int attributes;      ///&lt; describes it
+  signed char state;   ///&lt; may be set to any positive value if alive, or 0 to kill it
 
-	int    id;            // id code, indicates what type it is
-	int attributes;       // describes it
-	signed char state;    // may be set to any positive value if alive, or 0 to kill it
-	//private: int _serial; // unique reference number
-	public:
-	int _depth;  // determines rendering order ; read/write with set_depth, get_depth
-	void set_depth(double d);
-	double get_depth();
-	friend int compare_depth (const void *_a, const void *_b) ;
-
-	inline void add(SpaceLocation *o) {physics-&gt;add(o);}
-	inline void add(Presence *p) {physics-&gt;add(p);}
-
-	virtual void animate(Frame *space); //displays ? on screen (NOT permitted to affect game physics in any way)
-
-	virtual void calculate(); //advance the item frame_time milliseconds in time
-	inline bool exists() {return state &gt; 0;};  //returns 0 if dead, non-zero if alive
-	Presence();
-	virtual ~Presence();  // called when a presence is deallocated
-	virtual SpaceLocation *get_focus();
-
-	virtual bool die(); // calling this kills a presence (returns true on success)
-	virtual void death();
-
-	bool isLocation() const ;  //returns true if it is the specified engine-defined type
-	bool isLine() const ;
-	bool isObject() const ;
-	bool isAsteroid() const ;
-	bool isPlanet() const ;
-	bool isShip() const ;
-	bool isShot() const;
-	bool isSynched() const;
-
+ public:
+  int _depth;    ///&lt; determines rendering order ; read/write with set_depth, get_depth
+  void set_depth(double d);
+  double get_depth();
+  friend int compare_depth (const void *_a, const void *_b) ;
+  
+  inline void add(SpaceLocation *o) {physics-&gt;add(o);}
+  inline void add(Presence *p) {physics-&gt;add(p);}
+  
+  /// displays ? on screen (NOT permitted to affect game physics in any way)
+  virtual void animate(Frame *space); 
+  
+  virtual void calculate(); ///&lt; advance the item frame_time milliseconds in time
+  inline bool exists() {return state &gt; 0;};  ///&lt; returns 0 if dead, non-zero if alive
+  Presence();
+  virtual ~Presence();      ///&lt; called when a presence is deallocated
+  virtual SpaceLocation *get_focus();
+  
+  virtual bool die();       ///&lt; calling this kills a presence (returns true on success)
+  virtual void death();
+  
+  bool isLocation() const ;  ///&lt; returns true if it is the specified engine-defined type
+  bool isLine() const ;      ///&lt; returns true if it is the specified engine-defined type
+  bool isObject() const ;    ///&lt; returns true if it is the specified engine-defined type
+  bool isAsteroid() const ;  ///&lt; returns true if it is the specified engine-defined type
+  bool isPlanet() const ;    ///&lt; returns true if it is the specified engine-defined type
+  bool isShip() const ;      ///&lt; returns true if it is the specified engine-defined type
+  bool isShot() const;       ///&lt; returns true if it is the specified engine-defined type
+  bool isSynched() const;    ///&lt; returns true if it is the specified engine-defined type
+  
 };
 
-/// \brief any item in the game that has a location
-class SpaceLocation : public Presence { // base class for all items in game
-	friend class Physics;
-	friend struct Query;
+/// \brief any item in the game that has a location, base class for all items in game
+class SpaceLocation : public Presence 
+{ 
+  friend class Physics;
+  friend struct Query;
 
-protected: public: //aught to be protected, but we're lazy
-	Vector2 pos;
-	union {
-		SpaceObject   *qnexto;
-		SpaceLine     *qnextl;
-		SpaceLocation *qnext;
-	};
-	public:
-	int    layer;       // effects collisions &amp; queries... (will be phased out eventually)
-protected: <A HREF="public://aught">public://aught</A> to be protected, but we're lazy
-	Vector2 vel;
-	double angle;        // the angle it's facing (sometimes not very meaningfull)
+ protected: public: 
+  //aught to be protected, but we're lazy
+  Vector2 pos;
+  union 
+  {
+    SpaceObject   *qnexto;
+    SpaceLine     *qnextl;
+    SpaceLocation *qnext;
+  };
+ public:
+  int    layer;       ///&lt; effects collisions &amp; queries... (will be phased out eventually)
+ protected: <A HREF="public://aught">public://aught</A> to be protected, but we're lazy
+  Vector2 vel;
+  double angle;       ///&lt; the angle it's facing (sometimes not very meaningfull)
+  
+  enum { 
+    team_bits = 14, ship_bits =  18, 
+    team_shift = 0, ship_shift = 14, 
+    team_mask = ((1&lt;&lt;team_bits)-1) &lt;&lt; team_shift,
+    ship_mask = ((1&lt;&lt;ship_bits)-1) &lt;&lt; ship_shift
+  };
+  unsigned int ally_flag;
 
+ public:
 
-	enum { 
-			team_bits = 14, ship_bits =  18, 
-			team_shift = 0, ship_shift = 14, 
-			team_mask = ((1&lt;&lt;team_bits)-1) &lt;&lt; team_shift,
-			ship_mask = ((1&lt;&lt;ship_bits)-1) &lt;&lt; ship_shift
-		};
-	unsigned int ally_flag;
+  Ship *ship;          ///&lt; the ship it's associated with
+  ShipData *data;      ///&lt; the data module it depends upon
+  SpaceObject *target; ///&lt; it's target, if it has one
 
-	public:
+  inline  bool sameShip (const SpaceLocation *other) {return ally_flag == other-&gt;ally_flag;}
+  virtual bool sameTeam (const SpaceLocation *other) const;
+  TeamCode get_team() const;
+  void set_team(TeamCode k);
+  
+  virtual void ship_died();
+  virtual void target_died();
+  virtual bool change_owner(SpaceLocation *new_owner);
+  
+  
+  double damage_factor;         ///&lt; the damage this item inflicts
+  
+  int collide_flag_anyone;   ///&lt; mask for which layers it can collide with for non-allies
+  int collide_flag_sameteam; ///&lt; mask for which layers it can collide with for allies
+  int collide_flag_sameship; ///&lt; mask for which layers it can collide with objects associated with the same ship
 
-	Ship *ship;          // the ship it's associated with
-	ShipData *data;      // the data module it depends upon
-	SpaceObject *target; // it's target, if it has one
+  int damage(SpaceLocation *who, double normal, double direct = 0) 
+    { 
+      return who-&gt;handle_damage(this, normal, direct); 
+    }
 
-	inline  bool sameShip (const SpaceLocation *other) {return ally_flag == other-&gt;ally_flag;}
-	virtual bool sameTeam (const SpaceLocation *other) const;
-	TeamCode get_team() const;
-	void set_team(TeamCode k);
+  /// \return (this is a lie)
+  /// -1 = benefitted from damage
+  ///  0 = ignored damage
+  ///  1 = took damage normally
+  ///  2 = reduced damage
+  virtual int handle_damage(SpaceLocation *source, double normal, double direct = 0);
+  virtual int handle_fuel_sap(SpaceLocation *source, double normal);
+  virtual double handle_speed_loss(SpaceLocation *source, double normal);
+  
+  virtual void change_vel(Vector2 dvel);
+  virtual void change_pos(Vector2 dpos);
+  virtual void change_pos(double scale);
 
-	virtual void ship_died();
-	virtual void target_died();
-	virtual bool change_owner(SpaceLocation *new_owner);
+  SpaceLocation(SpaceLocation *creator, Vector2 lpos, double langle);
+  virtual void death();      ///&lt; called after an item is killed
+  virtual ~SpaceLocation();  ///&lt; called when an item is deallocated
 
+  double get_angle() const;  
+  Vector2 get_vel() const {return vel;}
 
-	double damage_factor;         // the damage this item inflicts
+  virtual double get_angle_ex() const; ///&lt; stupid helper for camera
 
-	int    collide_flag_anyone;   // mask for which layers it can collide with for non-allies
-	int    collide_flag_sameteam; // mask for which layers it can collide with for allies
-	int    collide_flag_sameship; // mask for which layers it can collide with objects associated with the same ship
+  int getID() const;
 
+  virtual SpaceLocation *get_focus();
 
+  /// returns the x,y coordinates, and normalizes it (0 &lt;= pos.x &lt; map_size.x), (0 &lt;= pos.y &lt; map_size.y)
+  Vector2 normal_pos() const;          
+  Vector2 nearest_pos(SpaceLocation *l) const;
+  double distance(SpaceLocation *l);
+  double trajectory_angle(SpaceLocation *l);
 
-	int damage(SpaceLocation *who, double normal, double direct = 0) { return who-&gt;handle_damage(this, normal, direct); }
-	/*handle_damage returns: (this is a lie)
-		-1 = benefitted from damage
-		 0 = ignored damage
-		 1 = took damage normally
-		 2 = reduced damage
-	*/
-	virtual int handle_damage(SpaceLocation *source, double normal, double direct = 0);
-	virtual int handle_fuel_sap(SpaceLocation *source, double normal);
-	virtual double handle_speed_loss(SpaceLocation *source, double normal);
-
-	virtual void change_vel(Vector2 dvel);
-	virtual void change_pos(Vector2 dpos);
-	virtual void change_pos(double scale);
-
-	SpaceLocation(SpaceLocation *creator, Vector2 lpos, double langle);
-	virtual void death();      // called after an item is killed
-	virtual ~SpaceLocation();  // called when an item is deallocated
-
-	double get_angle() const;        // various public functions for reading otherwise protected data
-	Vector2 get_vel() const {return vel;}
-
-	virtual double get_angle_ex() const; // stupid helper for camera
-
-	int getID() const;
-
-	virtual SpaceLocation *get_focus();
-
-	Vector2 normal_pos() const;          // returns the x,y coordinates, and normalizes it (0 &lt;= pos.x &lt; map_size.x), (0 &lt;= pos.y &lt; map_size.y)
-	Vector2 nearest_pos(SpaceLocation *l) const;
-	double distance(SpaceLocation *l);
-	double trajectory_angle(SpaceLocation *l);
-
-	virtual double isProtected() const;  // returns 0 normally, or a positive number if shielded
-	virtual double isInvisible() const;  // returns 0 normally, or a positive number if cloaked
+  virtual double isProtected() const;  ///&lt; returns 0 normally, or a positive number if shielded
+  virtual double isInvisible() const;  ///&lt; returns 0 normally, or a positive number if cloaked
 	
-	// this is used in queries, to see if it's detectable and should be examined.
-	virtual bool detectable();
+  /// this is used in queries, to see if it's detectable and should be examined.
+  virtual bool detectable();
 
-	Planet *nearest_planet(); //returns the nearest planet, or NULL if no planets are nearby
+  Planet *nearest_planet(); ///&lt; returns the nearest planet, or NULL if no planets are nearby
 
-	virtual int canCollide(SpaceLocation *other); // returns 0 if collision impossible
+  virtual int canCollide(SpaceLocation *other); ///&lt; returns 0 if collision impossible
 
-	virtual int translate(Vector2 rel_pos); //moves an object (returns non-zero on success)
-	int translate(double rel_x, double rel_y) {return translate(Vector2(rel_x,rel_y));}
-	void _accelerate(double angle, double vel, double max_speed=MAX_SPEED); //accelerates an object by vel at angle, to a maximum of max_speed
-	void _accelerate(Vector2 delta_v, double max_speed=MAX_SPEED); //changes an objects velocity by delta_v, to a maximum of max_speed
-	virtual int accelerate(SpaceLocation *source, double angle, double vel, double max_speed=MAX_SPEED); //accelerates an object by vel at angle, to a maximum of max_speed
-	virtual int accelerate(SpaceLocation *source, Vector2 delta_v, double max_speed=MAX_SPEED); //changes an objects velocity by delta_v, to a maximum of max_speed
-	virtual int accelerate_gravwhip(SpaceLocation *source, double angle, double velocity, double max_speed) ; //accelerates an object, with gravity whip
-	void match_velocity(SpaceLocation *other) {vel = other-&gt;vel;}
+  virtual int translate(Vector2 rel_pos); ///&lt; moves an object (returns non-zero on success)
+  int translate(double rel_x, double rel_y) {return translate(Vector2(rel_x,rel_y));}
+  /// accelerates an object by vel at angle, to a maximum of max_speed
+  void _accelerate(double angle, double vel, double max_speed=MAX_SPEED); 
+  /// changes an objects velocity by delta_v, to a maximum of max_speed
+  void _accelerate(Vector2 delta_v, double max_speed=MAX_SPEED); 
+  /// accelerates an object by vel at angle, to a maximum of max_speed
+  virtual int accelerate(SpaceLocation *source, double angle, double vel, double max_speed=MAX_SPEED); 
+  /// changes an objects velocity by delta_v, to a maximum of max_speed
+  virtual int accelerate(SpaceLocation *source, Vector2 delta_v, double max_speed=MAX_SPEED); 
+  /// accelerates an object, with gravity whip
+  virtual int accelerate_gravwhip(SpaceLocation *source, double angle, double velocity, 
+				  double max_speed); 
+  void match_velocity(SpaceLocation *other) {vel = other-&gt;vel;}
 
-	virtual void animate(Frame *space); //displays an object on screen (NOT permitted to affect game physics in any way)
-	virtual void calculate(); //advance the item frame_time milliseconds in time
-
-	void play_sound (SAMPLE *sample, int vol = 256, int freq = 1000); //plays a sound
-	void play_sound2 (SAMPLE *sample, int vol = 256, int freq = 1000);//like play_sound, only stops the previous sound
+  /// displays an object on screen (NOT permitted to affect game physics in any way)
+  virtual void animate(Frame *space); 
+  /// advance the item frame_time milliseconds in time
+  virtual void calculate(); 
 };
 
 /// \brief any item with a sprite (only SpaceObjects can bounce)
-class SpaceObject : public SpaceLocation {
-	public:
-	Vector2 size;      //size of sprite
-	double  mass; //mass of object
-	bool isblockingweapons;	// this object blocks weaponry (shots)
-	protected:
-	SpaceSprite *sprite; //the pictures that this object looks like
-	int          sprite_index; //which one of those pictures is active at the moment
+class SpaceObject : public SpaceLocation 
+{
+ public:
+  Vector2 size; ///&lt; size of sprite
+  double  mass; ///&lt; mass of object
+  bool isblockingweapons; ///&lt; this object blocks weaponry (shots)
+ protected:
+  SpaceSprite *sprite; ///&lt; the pictures that this object looks like
+  int sprite_index;    ///&lt; which one of those pictures is active at the moment
 
-	public:
-	SpaceObject(SpaceLocation *creator, Vector2 opos, double oangle, 
-			SpaceSprite *osprite);
-	virtual void death();      // called after an item is killed
+ public:
+  SpaceObject(SpaceLocation *creator, Vector2 opos, double oangle, 
+	      SpaceSprite *osprite);
+  virtual void death();      ///&lt; called after an item is killed
 
-	SpaceSprite *get_sprite() const {return sprite;}
-	int get_sprite_index() const {return sprite_index;}
+  SpaceSprite *get_sprite() const {return sprite;}
+  int get_sprite_index() const {return sprite_index;}
+  
+  Vector2 get_size() const {return size;}
+  
+  virtual void animate(Frame *space);
+  virtual void calculate();
+  virtual void collide(SpaceObject *other);
+  virtual double collide_ray(Vector2 lpos1, Vector2 lpos2, double llength);
 
-	Vector2 get_size() const {return size;}
-
-	virtual void animate(Frame *space);
-	virtual void calculate();
-	virtual void collide(SpaceObject *other);
-	virtual double collide_ray(Vector2 lpos1, Vector2 lpos2, double llength);
-
-	virtual void inflict_damage(SpaceObject *other);
-
-	virtual void set_sprite ( SpaceSprite *sprite );
+  virtual void inflict_damage(SpaceObject *other);
+  
+  virtual void set_sprite ( SpaceSprite *sprite );
 };
 
-/// \brief an item that appears as a line.  these can only collide with SpaceObjects, but not other lines.  
-class SpaceLine : public SpaceLocation {
-	protected:
-	double length;
-	int    color;
+/// an item that appears as a line.  these can only collide with SpaceObjects, but not other lines.  
+class SpaceLine : public SpaceLocation 
+{
+ protected:
+  double length;
+  int    color;
 
-	public:
-	SpaceLine(SpaceLocation *creator, Vector2 lpos, double langle, 
-		double llength, int lcolor);
-
-	Vector2 edge() const;
-	double edge_x() const;
-	double edge_y() const;
-	double get_length() const;
-
-	virtual void animate(Frame *space);
-	virtual void collide(SpaceObject *o);
-	virtual void inflict_damage(SpaceObject *other);
+ public:
+  SpaceLine(SpaceLocation *creator, Vector2 lpos, double langle, 
+	    double llength, int lcolor);
+  
+  Vector2 edge() const;
+  double edge_x() const;
+  double edge_y() const;
+  double get_length() const;
+  
+  virtual void animate(Frame *space);
+  virtual void collide(SpaceObject *o);
+  virtual void inflict_damage(SpaceObject *other);
 };
 
-struct Query {
-	private:
-	int layers;
-	SpaceLocation *target;
-	int qx_min, qx_max;
-	int qy_min, qy_max;
-	int qx, qy;
-	Vector2 target_pos;
-	double range_sqr;
-	void next_quadrant ();
-	public:
-	union {
-		SpaceObject   *currento;
-		SpaceLine     *currentl;
-		SpaceLocation *current;
-	};
-	void begin (SpaceLocation *target, int layers, double range);
-	void begin (SpaceLocation *target, Vector2 center, int layers, double range);
-	void next ();
-	void end();
-	private:
-	bool current_invalid() {
-		if (!(bit(current-&gt;layer) &amp; layers) || (current == target) || !current-&gt;exists()) return true;
-		if (magnitude_sqr(min_delta(target_pos, current-&gt;normal_pos())) &gt; range_sqr) return true;
-		return false;
-	}
+struct Query 
+{
+  private:
+int layers;
+  SpaceLocation *target;
+  int qx_min, qx_max;
+  int qy_min, qy_max;
+  int qx, qy;
+  Vector2 target_pos;
+  double range_sqr;
+  void next_quadrant ();
+  public:
+  union 
+  {
+    SpaceObject   *currento;
+    SpaceLine     *currentl;
+    SpaceLocation *current;
+  };
+  void begin (SpaceLocation *target, int layers, double range);
+  void begin (SpaceLocation *target, Vector2 center, int layers, double range);
+  void next ();
+  void end();
+  private:
+  bool current_invalid() 
+  {
+    if (!(bit(current-&gt;layer) &amp; layers) || (current == target) || !current-&gt;exists()) return true;
+    if (magnitude_sqr(min_delta(target_pos, current-&gt;normal_pos())) &gt; range_sqr) return true;
+    return false;
+  }
 };
 
 inline Uint64 REQUIRE_ATTRIBUTES(Uint32 a) {return a | (Uint64(a) &lt;&lt; 32);}
 inline Uint64 PROHIBIT_ATTRIBUTES(Uint32 a) {return Uint64(a) &lt;&lt; 32;}
 
-struct Query2 {
-	private:
-	int attributes_desired;
-	int attributes_mask;
-	SpaceLocation *target;
-	int qx_min, qx_max;
-	int qy_min, qy_max;
-	int qx, qy;
-	Vector2 target_pos;
-	double range_sqr;
-	void next_quadrant ();
-	public:
-	union {
-		SpaceObject   *currento;
-		SpaceLine     *currentl;
-		SpaceLocation *current;
-	};
-	void begin (SpaceLocation *target, Uint64 attribute_filter, double range);
-	void begin (SpaceLocation *target, Vector2 center, Uint64 attribute_filter, double range);
-	void next ();
-	void end();
-	private:
-	bool current_invalid() {
-		if (((current-&gt;attributes &amp; attributes_mask) != attributes_desired) || (current == target) || !current-&gt;exists()) return true;
-		if (magnitude_sqr(min_delta(target_pos, current-&gt;normal_pos())) &gt; range_sqr) return true;
-		return false;
-	}
+struct Query2 
+{
+  private:
+int attributes_desired;
+  int attributes_mask;
+  SpaceLocation *target;
+  int qx_min, qx_max;
+  int qy_min, qy_max;
+  int qx, qy;
+  Vector2 target_pos;
+  double range_sqr;
+  void next_quadrant ();
+  public:
+  union {
+    SpaceObject   *currento;
+    SpaceLine     *currentl;
+    SpaceLocation *current;
+  };
+  void begin (SpaceLocation *target, Uint64 attribute_filter, double range);
+  void begin (SpaceLocation *target, Vector2 center, Uint64 attribute_filter, double range);
+  void next ();
+  void end();
+  private:
+  bool current_invalid() 
+  {
+    if (((current-&gt;attributes &amp; attributes_mask) != attributes_desired) || 
+	(current == target) || !current-&gt;exists()) 
+      return true;
+    if (magnitude_sqr(min_delta(target_pos, current-&gt;normal_pos())) &gt; range_sqr) 
+      return true;
+    return false;
+  }
 };
 
 #endif // __MFRAME_H__

Modified: branches/multiplayer-branch/source/melee/mgame.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mgame.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/melee/mgame.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,7 +1,7 @@
 /* $Id: mgame.cpp,v 1.5 2004/08/08 17:36:06 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -15,21 +15,16 @@
 GNU General Public License for more details.
 */
 
-//#define REVERSE_CONNECT
-//for debuging
-
 #include &lt;exception&gt;
 using std::exception;
-#include &lt;typeinfo&gt;//
+#include &lt;typeinfo&gt;
 
 #include &lt;stdio.h&gt;
 #include &lt;string.h&gt;
-//#include &lt;stdlib.h&gt;//
-#include &lt;string.h&gt;
+
 #include &lt;allegro.h&gt;
 
 #include &quot;melee.h&quot;
-REGISTER_FILE
 #include &quot;scp.h&quot;
 #include &quot;util/history.h&quot;
 #include &quot;util/get_time.h&quot;
@@ -57,78 +52,78 @@
 
 int random_seed[2];
 
-MeleeData meleedata;
 
 MeleeData::MeleeData()
 {
-	panelSprite             = NULL;
-	kaboomSprite            = NULL;
-	hotspotSprite           = NULL;
-	sparkSprite             = NULL;
-	asteroidExplosionSprite = NULL;
-	asteroidSprite          = NULL;
-	planetSprite            = NULL;
-	xpl1Sprite              = NULL;
+  STACKTRACE;
+  
+  DATAFILE*  melee = load_datafile(data_full_path(&quot;melee.dat&quot;).c_str());
+  
+  if (!melee) 
+    tw_error(&quot;Error loading melee data\n&quot;);
 
-	planet_victory		= &quot;&quot;;	
-
-	melee = NULL;
+  panelSprite = new SpaceSprite(&amp;melee[MELEE_PANEL], 
+				PANEL_FRAMES, SpaceSprite::IRREGULAR);
+  kaboomSprite = new SpaceSprite(&amp;melee[MELEE_KABOOM], KABOOM_FRAMES,
+				 SpaceSprite::ALPHA | SpaceSprite::MASKED | 
+				 SpaceSprite::MIPMAPED);
+  hotspotSprite = new SpaceSprite(&amp;melee[MELEE_HOTSPOT], HOTSPOT_FRAMES,
+				  SpaceSprite::ALPHA | SpaceSprite::MASKED | 
+				  SpaceSprite::MIPMAPED);
+  sparkSprite = new SpaceSprite(&amp;melee[MELEE_SPARK], SPARK_FRAMES,
+				SpaceSprite::ALPHA | SpaceSprite::MASKED | 
+				SpaceSprite::MIPMAPED | 
+				SpaceSprite::MATCH_SCREEN_FORMAT);
+  asteroidExplosionSprite = new SpaceSprite(&amp;melee[MELEE_ASTEROIDEXPLOSION], 
+					    ASTEROIDEXPLOSION_FRAMES);
+  asteroidSprite = new SpaceSprite(&amp;melee[MELEE_ASTEROID], ASTEROID_FRAMES);
+  planetSprite = new SpaceSprite(&amp;melee[MELEE_PLANET], PLANET_FRAMES);
+  xpl1Sprite = new SpaceSprite(&amp;melee[MELEE_XPL1], XPL1_FRAMES,
+			       SpaceSprite::ALPHA | SpaceSprite::MASKED | 
+			       SpaceSprite::MIPMAPED);
+  unload_datafile(melee);
 }
 
-
-
-void MeleeData::init()
+MeleeData::~MeleeData()
 {
-  melee = load_datafile(data_full_path(&quot;melee.dat&quot;).c_str());
-  if (!melee) tw_error(&quot;Error loading melee data\n&quot;);
-
-  meleedata.panelSprite             = new SpaceSprite(&amp;melee[MELEE_PANEL], 
-						      PANEL_FRAMES, SpaceSprite::IRREGULAR);
-  meleedata.kaboomSprite            = new SpaceSprite(&amp;melee[MELEE_KABOOM], KABOOM_FRAMES,
-						      SpaceSprite::ALPHA | SpaceSprite::MASKED | 
-						      SpaceSprite::MIPMAPED);
-  meleedata.hotspotSprite           = new SpaceSprite(&amp;melee[MELEE_HOTSPOT], HOTSPOT_FRAMES,
-						      SpaceSprite::ALPHA | SpaceSprite::MASKED | 
-						      SpaceSprite::MIPMAPED);
-  meleedata.sparkSprite             = new SpaceSprite(&amp;melee[MELEE_SPARK], SPARK_FRAMES,
-						      SpaceSprite::ALPHA | SpaceSprite::MASKED | 
-						      SpaceSprite::MIPMAPED | 
-						      SpaceSprite::MATCH_SCREEN_FORMAT);
-  meleedata.asteroidExplosionSprite = new SpaceSprite(&amp;melee[MELEE_ASTEROIDEXPLOSION], 
-						      ASTEROIDEXPLOSION_FRAMES);
-  meleedata.asteroidSprite          = new SpaceSprite(&amp;melee[MELEE_ASTEROID], ASTEROID_FRAMES);
-  meleedata.planetSprite            = new SpaceSprite(&amp;melee[MELEE_PLANET], PLANET_FRAMES);
-  meleedata.xpl1Sprite              = new SpaceSprite(&amp;melee[MELEE_XPL1], XPL1_FRAMES,
-						      SpaceSprite::ALPHA | SpaceSprite::MASKED | 
-						      SpaceSprite::MIPMAPED);
-  
-  //planet_victory = (Music*) (melee[MELEE_PLANET+PLANET_FRAMES].dat);
-  char tmp[20] = {0};
-  sprintf(tmp, &quot;%d&quot;, MELEE_PLANET+PLANET_FRAMES);
-  planet_victory = std::string(&quot;melee.dat#&quot;) + tmp;
+  STACKTRACE;
+  if(panelSprite)
+    {
+      delete panelSprite;
+    }
+  if(kaboomSprite)
+    {
+      delete kaboomSprite;
+    }
+  if(hotspotSprite)
+    {
+      delete hotspotSprite;
+    }
+  if(sparkSprite)
+    {
+      delete sparkSprite;
+    }
+  if(asteroidExplosionSprite)
+    {
+      delete asteroidExplosionSprite;
+    }
+  if(asteroidSprite)
+    {
+      delete asteroidSprite;
+    }
+  if(planetSprite)
+    {
+      delete planetSprite;
+    }
+  if(xpl1Sprite)
+    {
+      delete xpl1Sprite;
+    }
 }
 
-void MeleeData::deinit()
-{
-	panelSprite             = NULL;
-	kaboomSprite            = NULL;
-	hotspotSprite           = NULL;
-	sparkSprite             = NULL;
-	asteroidExplosionSprite = NULL;
-	asteroidSprite          = NULL;
-	planetSprite            = NULL;
-	xpl1Sprite              = NULL;
 
-	planet_victory		= &quot;&quot;;		
 
-	unload_datafile(melee);
-	
-	melee = NULL;
-}
 
-
-
-
 int interpolate_frames = false;
 
 
@@ -159,177 +154,208 @@
 	game_names[num_games] = NULL;
 }
 
-Game *GameType::new_game() {STACKTRACE
-	Game *tmp = _new_game();
-	tmp-&gt;preinit();
-	tmp-&gt;type = this;
-	return tmp;
+Game *GameType::new_game() 
+{
+  STACKTRACE;
+  Game *tmp = _new_game();
+  tmp-&gt;preinit();
+  tmp-&gt;type = this;
+  return tmp;
 }
 
-GameType *gametype (const char *name) {STACKTRACE
-	GameType ** g;
-	for (g = games; *g; g ++)
-		if (!strcmp((*g)-&gt;name, name))
-			return *g;
+GameType *gametype (const char *name) 
+{
+  GameType ** g;
+  for (g = games; *g; g ++)
+    if (!strcmp((*g)-&gt;name, name))
+      return *g;
 	return NULL;
 }
 
-void __checksync( const char *fname, int line) {
-	if (!game) {
-		error(&quot;request to compare checksums without a valid game\nfrom file %f, line %d&quot;, fname, line);
-		return;
-	}
+void __checksync( const char *fname, int line) 
+{
+  if (!game) 
+    {
+      tw_error(&quot;request to compare checksums without a valid game&quot;);
+      return;
+    }
 #	ifdef LOTS_OF_CHECKSUMS
-	game-&gt;compare_checksums();
+  game-&gt;compare_checksums();
 #	endif
 }
 
 
 
-void Game::_event(Event *e) {
-	switch (e-&gt;type) {
-		case Event::VIDEO: {
-			if (game_done)
-				return;
-			if (e-&gt;subtype == VideoEvent::REDRAW)
-				this-&gt;redraw();
-		} break;
-		case Event::TW_CONFIG: {
-			ConfigEvent *c = (ConfigEvent*)e;
-			switch (c-&gt;subtype) {
-			case ConfigEvent::SET: {
-					if (0) ;
-					else if (!strcmp(c-&gt;name, &quot;server.ini/game/shotrelativity&quot;)) {
-						double v = atof(c-&gt;value);
-						this-&gt;shot_relativity = v;
-					}
-					else if (!strcmp(c-&gt;name, &quot;server.ini/game/friendlyfire&quot;)) {
-						int v = atoi(c-&gt;value);
-						this-&gt;friendly_fire = (bool) v;
-					}
-				} break;
-			}
-			std::list&lt;BaseClass*&gt;b_presence;
-			std::copy(presence.begin(),presence.end(),back_inserter(b_presence));
-			issue_event(b_presence, e);
-			std::list&lt;BaseClass*&gt; b_item;
-			std::copy(item.begin(),item.end(),std::back_inserter(b_item));
-			issue_event(b_item, e);
-		} break;
-	}
+void Game::_event(Event *e) 
+{
+  STACKTRACE;
+  switch (e-&gt;type) 
+    {
+    case Event::VIDEO: 
+      {
+	if (game_done)
+	  return;
+	if (e-&gt;subtype == VideoEvent::REDRAW)
+	  this-&gt;redraw();
+      } break;
+    case Event::TW_CONFIG: 
+      {
+	ConfigEvent *c = (ConfigEvent*)e;
+	switch (c-&gt;subtype) 
+	  {
+	  case ConfigEvent::SET: 
+	    {
+	      if (0) ;
+	      else if (!strcmp(c-&gt;name, &quot;server.ini/game/shotrelativity&quot;)) 
+		{
+		  double v = atof(c-&gt;value);
+		  this-&gt;shot_relativity = v;
+		}
+	      else if (!strcmp(c-&gt;name, &quot;server.ini/game/friendlyfire&quot;)) {
+		int v = atoi(c-&gt;value);
+		this-&gt;friendly_fire = (bool) v;
+	      }
+	    } break;
+	  }
+	std::list&lt;BaseClass*&gt;b_presence;
+	std::copy(presence.begin(),presence.end(),back_inserter(b_presence));
+	issue_event(b_presence, e);
+	std::list&lt;BaseClass*&gt; b_item;
+	std::copy(item.begin(),item.end(),std::back_inserter(b_item));
+	issue_event(b_item, e);
+      } break;
+    }
 }
 
-void Game::add_focus(Presence *new_focus, int channel) {
-	if ((channel != -1) &amp;&amp; !log-&gt;playback &amp;&amp; !(log-&gt;get_direction(channel) &amp; Log::direction_write))
-		return;
-	num_focuses += 1;
-	focus = (Presence **) realloc(focus, sizeof(Presence *) * num_focuses);
-	focus[num_focuses - 1] = new_focus;
-	new_focus-&gt;attributes |= ATTRIB_FOCUS;
-	if (num_focuses == 1) new_focus-&gt;attributes |= ATTRIB_ACTIVE_FOCUS;
-	if (focus_index == -1) focus_index = 0;
+void Game::add_focus(Presence *new_focus, int channel) 
+{
+  STACKTRACE;
+  if ((channel != -1) &amp;&amp; !log-&gt;playback &amp;&amp; !(log-&gt;get_direction(channel) &amp; Log::direction_write))
+    return;
+  num_focuses += 1;
+  focus = (Presence **) realloc(focus, sizeof(Presence *) * num_focuses);
+  focus[num_focuses - 1] = new_focus;
+  new_focus-&gt;attributes |= ATTRIB_FOCUS;
+  if (num_focuses == 1) new_focus-&gt;attributes |= ATTRIB_ACTIVE_FOCUS;
+  if (focus_index == -1) focus_index = 0;
 }
 
 
 void Game::prepare() {
+  STACKTRACE;
 #ifdef _MSC_VER
-	_asm { finit }
+  _asm { finit }
 #elif defined(__GCC__) &amp;&amp; defined(__i386__)
-	asm(&quot;finit&quot;);
+  asm(&quot;finit&quot;);
 #endif
-	Physics::prepare();
-	::game = this;
-	::targets = &gametargets;
-	return;
+  Physics::prepare();
+  ::game = this;
+  ::targets = &gametargets;
+  return;
 }
 
-void Game::set_resolution(int screen_x, int screen_y) {
-	int view_x, view_y;
-	view_x = screen_x;
-	view_y = screen_y;
-	redraw();
-	return;
+void Game::set_resolution(int screen_x, int screen_y) 
+{
+  STACKTRACE;
+  int view_x, view_y;
+  view_x = screen_x;
+  view_y = screen_y;
+  redraw();
+  return;
 }
 
-void Game::redraw() {STACKTRACE
-	if (!window-&gt;surface) return;
-	scare_mouse();
-	window-&gt;lock();
-	rectfill(window-&gt;surface, window-&gt;x, window-&gt;y, window-&gt;x+window-&gt;w-1, window-&gt;y+window-&gt;h-1, pallete_color[8]);
-	FULL_REDRAW += 1;
-	view-&gt;refresh();
-	view-&gt;animate(this);
-	FULL_REDRAW -= 1;
-	window-&gt;unlock();
-	unscare_mouse();
-	return;
+void Game::redraw() 
+{
+  STACKTRACE;
+  if (!window-&gt;surface) return;
+  scare_mouse();
+  window-&gt;lock();
+  rectfill(window-&gt;surface, window-&gt;x, window-&gt;y, window-&gt;x+window-&gt;w-1, window-&gt;y+window-&gt;h-1, pallete_color[8]);
+  FULL_REDRAW += 1;
+  view-&gt;refresh();
+  view-&gt;animate(this);
+  FULL_REDRAW -= 1;
+  window-&gt;unlock();
+  unscare_mouse();
+  return;
 }
 
-Ship *Game::create_ship(const char *id, Control *c, Vector2 pos, double angle, int team) {STACKTRACE
-	ShipType *type = shiptype(id);
-	if (!type)
-	{tw_error(&quot;Game::create_ship - bad ship id (%s)&quot;, id);}
-	log_file(type-&gt;file);
-	if (team == 0) team = new_team();
-	Ship *s = type-&gt;get_ship(pos, angle, get_code(new_ship(), team));
-	if (c)
-		c-&gt;select_ship(s, id);
-	gametargets.add(s);
-	s-&gt;attributes |= ATTRIB_NOTIFY_ON_DEATH;
-	return s;
+Ship *Game::create_ship(const char *id, Control *c, Vector2 pos, double angle, int team) 
+{
+  STACKTRACE;
+  ShipType *type = shiptype(id);
+  if (!type)
+    {tw_error(&quot;Game::create_ship - bad ship id (%s)&quot;, id);}
+  log_file(type-&gt;file);
+  if (team == 0) team = new_team();
+  Ship *s = type-&gt;get_ship(pos, angle, get_code(new_ship(), team));
+  if (c)
+    c-&gt;select_ship(s, id);
+  gametargets.add(s);
+  s-&gt;attributes |= ATTRIB_NOTIFY_ON_DEATH;
+  return s;
 }
 
-Ship *Game::create_ship(int channel, const char *id, const char *control, Vector2 pos, double angle, int team) {STACKTRACE
-	Control *c = create_control(channel, control);
-	if (!c)
-	{tw_error(&quot;bad Control type!&quot;);}
-	c-&gt;temporary = true;
-	Ship *s = create_ship(id, c, pos, angle, team);
-	return s;
+Ship *Game::create_ship(int channel, const char *id, const char *control, Vector2 pos, double angle, int team) 
+{
+  STACKTRACE;
+  Control *c = create_control(channel, control);
+  if (!c)
+    {tw_error(&quot;bad Control type!&quot;);}
+  c-&gt;temporary = true;
+  Ship *s = create_ship(id, c, pos, angle, team);
+  return s;
 }
 
-void Game::increase_latency() {STACKTRACE
-	if (CHECKSUM_CHANNEL) {
-		log-&gt;buffer(channel_server + Game::_channel_buffered, NULL, 2);
-		log-&gt;buffer(channel_client + Game::_channel_buffered, NULL, 2);
-		if (log-&gt;playback) 
-			log-&gt;buffer(channel_playback + Game::_channel_buffered, NULL, 1);
-		log-&gt;flush();
-	}
-	lag_frames += 1;
+void Game::increase_latency() 
+{
+  STACKTRACE;
+  if (CHECKSUM_CHANNEL) {
+    log-&gt;buffer(channel_server + Game::_channel_buffered, NULL, 2);
+    log-&gt;buffer(channel_client + Game::_channel_buffered, NULL, 2);
+    if (log-&gt;playback) 
+      log-&gt;buffer(channel_playback + Game::_channel_buffered, NULL, 1);
+    log-&gt;flush();
+  }
+  lag_frames += 1;
 }
 
-void Game::decrease_latency() {
-	STACKTRACE;
-	if (lag_frames &lt;= 1) {tw_error(&quot;latency decreased too far&quot;);}
-	if (CHECKSUM_CHANNEL) {
-		log-&gt;unbuffer(channel_server + Game::_channel_buffered, NULL, 2);
-		log-&gt;unbuffer(channel_client + Game::_channel_buffered, NULL, 2);
-		if (log-&gt;playback) 
-			log-&gt;unbuffer(channel_playback + Game::_channel_buffered, NULL, 1);
-	}
-	lag_frames -= 1;
+void Game::decrease_latency() 
+{
+  STACKTRACE;
+  if (lag_frames &lt;= 1) {tw_error(&quot;latency decreased too far&quot;);}
+  if (CHECKSUM_CHANNEL) {
+    log-&gt;unbuffer(channel_server + Game::_channel_buffered, NULL, 2);
+    log-&gt;unbuffer(channel_client + Game::_channel_buffered, NULL, 2);
+    if (log-&gt;playback) 
+      log-&gt;unbuffer(channel_playback + Game::_channel_buffered, NULL, 1);
+  }
+  lag_frames -= 1;
 }
 
-int Game::is_local (int channel) {
-	return (log-&gt;get_direction (channel) &amp; Log::direction_write);
+int Game::is_local (int channel) 
+{
+  return (log-&gt;get_direction (channel) &amp; Log::direction_write);
 }
-void Game::log_file (const char *fname) {STACKTRACE
-	log-&gt;log_file(fname);
+void Game::log_file (const char *fname) 
+{
+  log-&gt;log_file(fname);
 }
 
-void Game::log_fleet(int channel, Fleet *fleet) {STACKTRACE
-	int fl;
-	void *tmpdata = fleet-&gt;serialize(&amp;fl);
-	char buffer[16384];
+void Game::log_fleet(int channel, Fleet *fleet) 
+{
+  STACKTRACE;
+  int fl;
+  void *tmpdata = fleet-&gt;serialize(&amp;fl);
+  char buffer[16384];
 
-	if (fl &gt; 16000)	{tw_error(&quot;blah&quot;);}
-	memcpy(buffer, tmpdata, fl);
-	free(tmpdata);
-	log_int(channel, fl);
-	if (fl &gt; 16000)	{tw_error(&quot;blah&quot;);}
-	log_data(channel, buffer, fl);
-	fleet-&gt;deserialize(buffer, fl);
+  if (fl &gt; 16000)	{tw_error(&quot;blah&quot;);}
+  memcpy(buffer, tmpdata, fl);
+  free(tmpdata);
+  log_int(channel, fl);
+  if (fl &gt; 16000)	{tw_error(&quot;blah&quot;);}
+  log_data(channel, buffer, fl);
+  fleet-&gt;deserialize(buffer, fl);
 }
 
 Control *Game::create_control (int channel, const char *type, char *config, char *file) {STACKTRACE
@@ -350,12 +376,14 @@
 }
 
 void Game::log_char(int channel, char &amp;data) {
+  STACKTRACE;
 	if (!log) return;
 	log-&gt;log  (channel, &amp;data, 1);
 	return;
 }
 
 void Game::log_short(int channel, short &amp;data) {
+  STACKTRACE;
 	if (!log) return;
 	data = intel_ordering_short(data);	
 	log-&gt;log  (channel, &amp;data, sizeof(short));
@@ -364,6 +392,7 @@
 }
 
 void Game::log_int(int channel, int &amp;data) {
+  STACKTRACE;
 	if (!log) return;
 	data = intel_ordering(data);
 	log-&gt;log  (channel, &amp;data, sizeof(int));
@@ -371,13 +400,15 @@
 	return;
 }
 
-void Game::log_data(int channel, void *data, int size) {STACKTRACE
+void Game::log_data(int channel, void *data, int size) {
+  STACKTRACE;
 	if (!log) return;
 	log-&gt;log  (channel, data, size);
 	return;
 }
 
-void Game::idle(int time) {STACKTRACE
+void Game::idle(int time) {
+  STACKTRACE;
 	if (log-&gt;listen()) return;
 	::idle(time);
 	return;
@@ -385,15 +416,13 @@
 
 void Game::animate(Frame *frame) 
 {
-  _STACKTRACE(&quot;Game::animate(Frame*)&quot;);
+  STACKTRACE;
   Physics::animate(frame);
 }
 
 void Game::animate() 
 {
-  
-  _STACKTRACE(&quot;Game::animate(void)&quot;);
-
+  STACKTRACE;
   double t = get_time();
   paused_time = 0;
   view-&gt;animate(this);
@@ -402,7 +431,8 @@
   return;
 }
 
-bool Game::game_ready() {STACKTRACE
+bool Game::game_ready() {
+  STACKTRACE;
 	if (CHECKSUM_CHANNEL == 0) return 1;
 	if (log-&gt;playback) {
 		return (log-&gt;ready(channel_server + Game::_channel_buffered) != 0);
@@ -422,8 +452,11 @@
 	return true;
 }
 
-void Game::handle_desynch(int local_checksum, int server_checksum, int client_checksum) {STACKTRACE
-	error(&quot;Game Desynchronized\nTime=%d Frame=%d\nClient=%d Server=%d Local=%d&quot;, game_time, frame_number, (int)client_checksum, (int)server_checksum, (int)local_checksum);
+void Game::handle_desynch(int local_checksum, int server_checksum, int client_checksum) 
+{
+  STACKTRACE;
+  //  tw_error(&quot;Game Desynchronized\nTime=%d Frame=%d\nClient=%d Server=%d Local=%d&quot;, game_time, frame_number, (int)client_checksum, (int)server_checksum, (int)local_checksum);
+  tw_error(&quot;Game Desynchronized&quot;);
 }
 
 //static int old_num_items;
@@ -435,239 +468,165 @@
 //if a game is killed due to an error, this may be executed
 void handle_game_error ( Game *game )
 {
-	log_debug(&quot;handle_game_error() executed\n&quot;);
-	if (game-&gt;log) {
-		game-&gt;log-&gt;save(&quot;error.dmo&quot;);
-		log_debug(&quot;Demo recording saved to error.dmo\n&quot;);
-	}
-/*
-	FILE *f;
-
-	f = fopen(&quot;error.log&quot;, &quot;a&quot;);
-	if (!f) return;
-
-	if (exitmessage)
-		fprintf(f, &quot;\n\n-------- error report, with message [%s]\n&quot;, exitmessage);
-	else
-		fprintf(f, &quot;\n\n-------- error report, unknown error\n&quot;);
-	//fprintf(f, &quot;-------- showing in-game objects --------\n&quot;);
-	fprintf(f, &quot;timewarp version = %s\n&quot;, tw_version());
-
-	if (game)
-		fprintf(f, &quot;lag_frames = %i&quot;, game-&gt;lag_frames);
-	else
-		fprintf(f, &quot;no game defined&quot;);
-
-	time_t t;
-	tm *td;
-	t = ::time(0);
-	td = ::localtime(&amp;t);
-	// month: 0=januari
-	fprintf(f, &quot;local time = %i-%02i-%02i %02i:%02i\n\n&quot;, td-&gt;tm_mday, td-&gt;tm_mon+1, 1900+td-&gt;tm_year,
-		td-&gt;tm_hour, td-&gt;tm_min);
-
-	if (physics)
-	{
-		fprintf(f, &quot;name, pos(x,y), vel(x,y), state, obj-pointer(this), ship-pointer(ship), target pointer(target)\n\n&quot;);
-		
-		int i;
-		for (i = 0; i &lt; physics-&gt;num_items; i += 1)
-		{
-			SpaceLocation *s;
-			s = physics-&gt;item[i];
-			
-			if (!(s &amp;&amp; s-&gt;exists() &amp;&amp; s-&gt;detectable()))
-				continue;
-			
-			int is = s-&gt;state;
-			Vector2 p = s-&gt;pos;
-			Vector2 v = s-&gt;vel;
-			
-			// set &quot;enable run-type information&quot; for this feature
-			// (rebuild all after changing that option)
-			fprintf(f, &quot;%30s %11.3e %011.3e %11.3e %11.3e %3i 0x%08X 0x%08X 0x%08X\n&quot;,
-				typeid(*s).name(), p.x, p.y, v.x, v.y, is, (unsigned int)s, (unsigned int)s-&gt;ship, (unsigned int)s-&gt;target );
-		}
-	} else {
-		fprintf(f, &quot;No physics defined\n&quot;);
-	}
-
-	#ifdef DO_STACKTRACE
-	//char *s = tw_error_str;
-//	fprintf(f, &quot;%s\n&quot;, tw_error_str);
-	//free(s);	// cause s was allocated with malloc().
-
-	fprintf(f, &quot;\nPROCLIST: level of call, line number in file, file name (top=most recent call)\n\n&quot;);
-
-	const char *fname = 0;
-	int *linenum = 0, *level = 0;
-
-	int i;
-	i = 0;	// start with the most recent one.
-	while (	get_stacklist_info(i, &amp;fname, &amp;linenum, &amp;level) )
-	{
-		++i;	// go on until it's a full circle
-		if (fname &amp;&amp; linenum &amp;&amp; level)
-			fprintf(f, &quot;%2i   %4i  %s\n&quot;, *level, *linenum, fname);
-	}
-
-	fprintf(f, &quot;\nPROCSTACK: level of call, line number in file, file name (top=most recent call)\n\n&quot;);
-
-	// also, read the &quot;other&quot; stack info ...
-	i = 0;
-	while ( get_stacktrace_info( i, &amp;fname, &amp;linenum, &amp;level) )
-	{
-		++i;
-		if (fname &amp;&amp; linenum &amp;&amp; level)
-			fprintf(f, &quot;%2i   %4i  %s\n&quot;, *level, *linenum, fname);
-	}
-
-	#endif
-
-	fprintf(f, &quot;----------------- end error log ---------------------\n&quot;);
-
-	fclose(f);
-	*/
+  log_debug(&quot;handle_game_error() executed\n&quot;);
+  if (game-&gt;log) 
+    {
+      game-&gt;log-&gt;save(&quot;error.dmo&quot;);
+      log_debug(&quot;Demo recording saved to error.dmo\n&quot;);
+    }
 }
 
 
-void Game::compare_checksums() {STACKTRACE
-	unsigned char local_checksum = checksum() &amp; 255;
-	unsigned char client_checksum = local_checksum;
-	unsigned char server_checksum = local_checksum;
-	bool desync = false;
+void Game::compare_checksums() 
+{
+  STACKTRACE;
+  unsigned char local_checksum = checksum() &amp; 255;
+  unsigned char client_checksum = local_checksum;
+  unsigned char server_checksum = local_checksum;
+  bool desync = false;
+  
+  log_char(channel_server + CHECKSUM_CHANNEL, server_checksum);
+  if (lag_frames)
+    log_char(channel_client + CHECKSUM_CHANNEL, client_checksum);
+  
+  if (server_checksum != client_checksum)
+    desync = true;
+  if (log-&gt;playback) {
+    if (lag_frames) 
+      log_char (channel_playback + CHECKSUM_CHANNEL, local_checksum);
+    if (local_checksum != server_checksum) desync = true;
+  }
 
-	log_char(channel_server + CHECKSUM_CHANNEL, server_checksum);
-	if (lag_frames)
-		log_char(channel_client + CHECKSUM_CHANNEL, client_checksum);
-
-	if (server_checksum != client_checksum)
-		desync = true;
-	if (log-&gt;playback) {
-		if (lag_frames) 
-			log_char (channel_playback + CHECKSUM_CHANNEL, local_checksum);
-		if (local_checksum != server_checksum) desync = true;
-	}
-
-	this-&gt;local_checksum = local_checksum;
-	this-&gt;client_checksum = client_checksum;
-	this-&gt;server_checksum = server_checksum;
-
-	if (desync)
-	{
-		handle_desynch(local_checksum, server_checksum, client_checksum);
-	}
+  this-&gt;local_checksum = local_checksum;
+  this-&gt;client_checksum = client_checksum;
+  this-&gt;server_checksum = server_checksum;
+  
+  if (desync)
+    {
+      handle_desynch(local_checksum, server_checksum, client_checksum);
+    }
 }
 
-void Game::do_game_events() {_STACKTRACE(&quot;Game::do_game_events()&quot;)
-	int i;
+void Game::do_game_events() 
+{
+  STACKTRACE;
+  int i;
 
-	//transmit from server
-	if (log-&gt;get_direction(channel_server) &amp; Log::direction_write) {
-		COMPILE_TIME_ASSERT(sizeof(events_waiting) == sizeof(char));
-		log-&gt;buffer( channel_server + _channel_buffered, &amp;events_waiting, sizeof(events_waiting) );
-		for (i = 0; i &lt; events_waiting; i += 1) {
-			log-&gt;buffer ( channel_server + _channel_buffered, waiting_events[i], waiting_events[i]-&gt;size );
-		}
-		//deallocate transmitted events
-		for (i = 0; i &lt; events_waiting; i += 1) free(waiting_events[i]);
-		events_waiting = 0;
-	}
-
-	//transmit from client
-	if (log-&gt;get_direction(channel_client) &amp; Log::direction_write) {
-		COMPILE_TIME_ASSERT(sizeof(events_waiting) == sizeof(char));
-		log-&gt;buffer( channel_client + _channel_buffered, &amp;events_waiting, sizeof(events_waiting) );
-		for (i = 0; i &lt; events_waiting; i += 1) {
-			log-&gt;buffer ( channel_client + _channel_buffered, waiting_events[i], waiting_events[i]-&gt;size );
-		}
-		//deallocate transmitted events
-		for (i = 0; i &lt; events_waiting; i += 1) free(waiting_events[i]);
-		events_waiting = 0;
-	}
-
-	//double-check transmission
-	if (events_waiting) {
-		tw_error(&quot;Game::do_game_events - events weren't sent properly&quot;);
-		for (i = 0; i &lt; events_waiting; i += 1) free(waiting_events[i]);
-		events_waiting = 0;
-	}
-
-	//recieve
-	char ne;
-	COMPILE_TIME_ASSERT(sizeof(events_waiting) == sizeof(ne));
-	char buffy[1024];
-
-	//recieve from server
-	log-&gt;unbuffer(channel_server + _channel_buffered, &amp;ne, sizeof(ne));
-	for (i = 0; i &lt; ne; i += 1) {
-		char *tmp = buffy;
-		log-&gt;unbuffer(channel_server + _channel_buffered, &amp;buffy, sizeof(GameEvent));
-		int s = ((GameEvent*)tmp)-&gt;size;
-		if (s &gt; 1024) {
-			tmp = (char *)malloc(s);
-			memcpy(tmp, buffy, sizeof(GameEvent));
-		}
+  //transmit from server
+  if (log-&gt;get_direction(channel_server) &amp; Log::direction_write) {
+    COMPILE_TIME_ASSERT(sizeof(events_waiting) == sizeof(char));
+    log-&gt;buffer( channel_server + _channel_buffered, &amp;events_waiting, sizeof(events_waiting) );
+    for (i = 0; i &lt; events_waiting; i += 1) {
+      log-&gt;buffer ( channel_server + _channel_buffered, waiting_events[i], waiting_events[i]-&gt;size );
+    }
+    //deallocate transmitted events
+    for (i = 0; i &lt; events_waiting; i += 1) free(waiting_events[i]);
+    events_waiting = 0;
+  }
+  
+  //transmit from client
+  if (log-&gt;get_direction(channel_client) &amp; Log::direction_write) {
+    COMPILE_TIME_ASSERT(sizeof(events_waiting) == sizeof(char));
+    log-&gt;buffer( channel_client + _channel_buffered, &amp;events_waiting, sizeof(events_waiting) );
+    for (i = 0; i &lt; events_waiting; i += 1) {
+      log-&gt;buffer ( channel_client + _channel_buffered, waiting_events[i], waiting_events[i]-&gt;size );
+    }
+    //deallocate transmitted events
+    for (i = 0; i &lt; events_waiting; i += 1) free(waiting_events[i]);
+    events_waiting = 0;
+  }
+  
+  //double-check transmission
+  if (events_waiting) {
+    tw_error(&quot;Game::do_game_events - events weren't sent properly&quot;);
+    for (i = 0; i &lt; events_waiting; i += 1) free(waiting_events[i]);
+    events_waiting = 0;
+  }
+  
+  //recieve
+  char ne;
+  COMPILE_TIME_ASSERT(sizeof(events_waiting) == sizeof(ne));
+  char buffy[1024];
+  
+  //recieve from server
+  log-&gt;unbuffer(channel_server + _channel_buffered, &amp;ne, sizeof(ne));
+  for (i = 0; i &lt; ne; i += 1) {
+    char *tmp = buffy;
+    log-&gt;unbuffer(channel_server + _channel_buffered, &amp;buffy, sizeof(GameEvent));
+    int s = ((GameEvent*)tmp)-&gt;size;
+    if (s &gt; 1024) {
+      tmp = (char *)malloc(s);
+      memcpy(tmp, buffy, sizeof(GameEvent));
+    }
 		log-&gt;unbuffer(channel_server + _channel_buffered, tmp + sizeof(GameEvent), s - sizeof(GameEvent));
 		handle_game_event ( channel_server, ((GameEvent*)tmp));
 		if (tmp != buffy) free(tmp);
-	}
-
-
-	//recieve from client
-	log-&gt;unbuffer(channel_client + _channel_buffered, &amp;ne, sizeof(ne));
-	for (i = 0; i &lt; ne; i += 1) {
-		char *tmp = buffy;
-		log-&gt;unbuffer(channel_client + _channel_buffered, &amp;buffy, sizeof(GameEvent));
-		int s = ((GameEvent*)tmp)-&gt;size;
-		if (s &gt; 1024) {
-			tmp = (char *)malloc(s);
-			memcpy(tmp, buffy, sizeof(GameEvent));
+  }
+  
+  
+  //recieve from client
+  log-&gt;unbuffer(channel_client + _channel_buffered, &amp;ne, sizeof(ne));
+  for (i = 0; i &lt; ne; i += 1) {
+    char *tmp = buffy;
+    log-&gt;unbuffer(channel_client + _channel_buffered, &amp;buffy, sizeof(GameEvent));
+    int s = ((GameEvent*)tmp)-&gt;size;
+    if (s &gt; 1024) {
+      tmp = (char *)malloc(s);
+      memcpy(tmp, buffy, sizeof(GameEvent));
 		}
-		log-&gt;unbuffer(channel_client + _channel_buffered, tmp + sizeof(GameEvent), s - sizeof(GameEvent));
-		handle_game_event ( channel_client, ((GameEvent*)tmp));
-		if (tmp != buffy) free(tmp);
-	}
+    log-&gt;unbuffer(channel_client + _channel_buffered, tmp + sizeof(GameEvent), s - sizeof(GameEvent));
+    handle_game_event ( channel_client, ((GameEvent*)tmp));
+    if (tmp != buffy) free(tmp);
+  }
 }
 
-void Game::handle_game_event ( int source, class GameEvent *event ) {STACKTRACE
-	if ((event-&gt;type &lt;= event_invalid) || (event-&gt;type &gt;= event_last)) {
-		tw_error(&quot;Game::handle_game_event - Bad event type: %d&quot;, event-&gt;type);
-	}
-	switch (event-&gt;type) {
-		case event_change_lag: ((GameEventChangeLag*)event)-&gt;execute(source);
-		break;
-		case event_message: ((GameEventMessage*)event)-&gt;execute(source);
-		break;
-	}
+void Game::handle_game_event ( int source, class GameEvent *event ) 
+{
+  STACKTRACE;
+  if ((event-&gt;type &lt;= event_invalid) || (event-&gt;type &gt;= event_last)) 
+    {
+      tw_error(&quot;Game::handle_game_event - Bad event type: %d&quot;, event-&gt;type);
+    }
+  switch (event-&gt;type) 
+    {
+    case event_change_lag: ((GameEventChangeLag*)event)-&gt;execute(source);
+      break;
+    case event_message: ((GameEventMessage*)event)-&gt;execute(source);
+      break;
+    }
 }
 
-void Game::send_game_event ( class GameEvent *event ) {STACKTRACE
-	if (events_waiting == maximum_events_waiting) {
-		tw_error(&quot;too many GameEvents&quot;);
-		return;
-	}
-	if (!waiting_events) waiting_events = new GameEvent*[maximum_events_waiting];
-	waiting_events[events_waiting] = event;
-	events_waiting += 1;
+void Game::send_game_event ( class GameEvent *event ) 
+{
+  STACKTRACE;
+  if (events_waiting == maximum_events_waiting) 
+    {
+      tw_error(&quot;too many GameEvents&quot;);
+      return;
+    }
+  if (!waiting_events) waiting_events = new GameEvent*[maximum_events_waiting];
+  waiting_events[events_waiting] = event;
+  events_waiting += 1;
 }
 
 
-void Game::calculate() {_STACKTRACE(&quot;Game::calculate&quot;)
-	int i;
-	double t = get_time();
-	int active_focus_destroyed = false;
-
-
-	paused_time = 0;
-	compare_checksums();
-	do_game_events();
-
-	for (i = 0; i &lt; num_focuses; i += 1) {
-		if (!focus[i]-&gt;exists()) {
-			num_focuses -= 1;
-			if (focus_index == i) {
-				focus[i]-&gt;attributes &amp;= ~ATTRIB_ACTIVE_FOCUS;
+void Game::calculate() 
+{
+  STACKTRACE;
+  int i;
+  double t = get_time();
+  int active_focus_destroyed = false;
+  
+  
+  paused_time = 0;
+  compare_checksums();
+  do_game_events();
+  
+  for (i = 0; i &lt; num_focuses; i += 1) {
+    if (!focus[i]-&gt;exists()) {
+      num_focuses -= 1;
+      if (focus_index == i) {
+	focus[i]-&gt;attributes &amp;= ~ATTRIB_ACTIVE_FOCUS;
 				active_focus_destroyed = 1;
 				focus_index -= 1;
 				if (num_focuses &amp;&amp; (focus_index &lt; 0))
@@ -698,6 +657,7 @@
 
 void Game::play() 
 {
+  STACKTRACE;
   set_resolution(window-&gt;w, window-&gt;h);
   prepare();
   if (is_paused()) 
@@ -707,14 +667,16 @@
       play_music();
       while(!game_done) 
 	{
+	  if(!tw_sound-&gt;playing_music())
+	    play_music();
+	  
 	  unsigned int time = get_time();
 	  poll_input();
-	  videosystem.poll_redraw();
+	  videosystem-&gt;poll_redraw();
 	  if ((next_tic_time &lt;= time) &amp;&amp; (next_render_time &gt; game_time) &amp;&amp; game_ready()) 
 	    {
 	      _STACKTRACE(&quot;Game::play - Game physics&quot;)
 		calculate();
-	      if (auto_unload) unload_unused_ship_data();
 	      log-&gt;flush();
 	      log-&gt;listen();
 	      if (key[KEY_F4])
@@ -774,33 +736,36 @@
 
 void Game::ship_died(Ship *who, SpaceLocation *source)
 {
+  STACKTRACE;
   if (source &amp;&amp; source-&gt;data) 
     {
       std::string tmp = &quot;&quot;;
       //if (source &amp;&amp; source-&gt;ship &amp;&amp; source-&gt;ship-&gt;data) tmp = source-&gt;ship-&gt;data-&gt;moduleVictory;
       // note: it's not guaranteed that a ship exists longer than its weapon, while data keep existing, right ?
       
-      /* temporary commented: Yurand
       if (source &amp;&amp; source-&gt;exists()) 
 	tmp = source-&gt;data-&gt;moduleVictory;
       if (!tmp.empty()) 
-	tw_sound.play_sound(tmp);
-      */
+	{
+	  tw_sound-&gt;play_music(data_full_path(tmp), 1);
+	}
       
     }
-	return;
+  return;
 }
 
 
 void Game::object_died(SpaceObject *who, SpaceLocation *source)
 {
+  STACKTRACE;
 	if (who &amp;&amp; who-&gt;isShip())
 	{
 		ship_died((Ship*)who, source);
 	}
 }
 
-void Game::fps() {STACKTRACE
+void Game::fps() {
+  STACKTRACE;
 	if ((!log-&gt;playback) &amp;&amp; ((log-&gt;type == Log::log_net1server) || (log-&gt;type == Log::log_net1client))) {
 		int ping = ((NetLog*)log)-&gt;ping;
 		char *tt = &quot;good&quot;;
@@ -855,6 +820,7 @@
 
 void Game::preinit() 
 {
+  STACKTRACE;
   Physics::preinit();
   //	meleedata.planetSprite = meleedata.asteroidSprite = meleedata.asteroidExplosionSprite = meleedata.hotspotSprite = meleedata.kaboomSprite = meleedata.panelSprite = meleedata.sparkSprite = meleedata.xpl1Sprite = NULL;
   // you should reset it here (again), cause there can be subgames of this type.
@@ -877,75 +843,77 @@
   music = &quot;&quot;;
 }
 
-void Game::init(Log *_log) {_STACKTRACE(&quot;Game::init&quot;)
-	int i;
+void Game::init(Log *_log) 
+{
+  STACKTRACE;
+  int i;
 
-	game_done = false;
-	log = _log;
-	if (!log) {
-		log = new Log();
-		log-&gt;init();
-	}
-
-	lag_frames = 0;
-	show_fps = 0;
-	game_time = 0;
-	frame_time = 1;
-	frame_number = 0;
-	hiccup_margin = 100;
-	next_tic_time = get_time();
-	next_render_time = game_time;
-	next_fps_time = game_time;
-	view_locked = false;
-	physics_locked = false;
-	if (log-&gt;type != Log::log_normal || log-&gt;playback) physics_locked = true;
-	local_checksum = client_checksum = server_checksum = 0;
-
-	Physics::init();
-	prepare();
-
-	if (!window) {
-		window = new VideoWindow();
-		window-&gt;preinit();
-	}
-
-	tw_set_config_file(&quot;client.ini&quot;);
-	change_view(get_config_string(&quot;View&quot;, &quot;View&quot;, &quot;Hero&quot;)); 
-
-	window-&gt;add_callback(this);
-
-	if (!log-&gt;playback) {
-		switch (log-&gt;type) {
-			case Log::log_normal: {
-			}
+  game_done = false;
+  log = _log;
+  if (!log) {
+    log = new Log();
+    log-&gt;init();
+  }
+  
+  lag_frames = 0;
+  show_fps = 0;
+  game_time = 0;
+  frame_time = 1;
+  frame_number = 0;
+  hiccup_margin = 100;
+  next_tic_time = get_time();
+  next_render_time = game_time;
+  next_fps_time = game_time;
+  view_locked = false;
+  physics_locked = false;
+  if (log-&gt;type != Log::log_normal || log-&gt;playback) physics_locked = true;
+  local_checksum = client_checksum = server_checksum = 0;
+  
+  Physics::init();
+  prepare();
+  
+  if (!window) {
+    window = new VideoWindow();
+    window-&gt;preinit();
+  }
+  
+  tw_set_config_file(&quot;client.ini&quot;);
+  change_view(get_config_string(&quot;View&quot;, &quot;View&quot;, &quot;Hero&quot;)); 
+  
+  window-&gt;add_callback(this);
+  
+  if (!log-&gt;playback) {
+    switch (log-&gt;type) {
+    case Log::log_normal: {
+    }
+      break;
+    case Log::log_net1server: {
+    }
+      break;
+    case Log::log_net1client: {
+    }
 			break;
-			case Log::log_net1server: {
-			}
-			break;
-			case Log::log_net1client: {
-			}
-			break;
-			default: {
-				tw_error(&quot;Knee!&quot;);
-			}
-			break;
-		}
-	}
-
-/* CONTENTS OF CHANNEL channel_init :
-
-offset	size	format		data
-0		4		int			log type number
+    default: {
+      tw_error(&quot;Knee!&quot;);
+    }
+      break;
+    }
+  }
+  
+  /* CONTENTS OF CHANNEL channel_init :
+     
+  offset	size	format		data
+  0		4		int			log type number
 4		4		int			size of game type name
 8		?		char[]		game type name
 ?		4		int			lag frames
 
-*/
-	int tmp = log-&gt;type;
-	log_int(channel_init, tmp);
-	if (log-&gt;playback) log-&gt;type = tmp;
+  */
+  int tmp = log-&gt;type;
+  log_int(channel_init, tmp);
+  if (log-&gt;playback) log-&gt;type = tmp;
 
-	char buffy[128];
+  char buffy[128];
 	i = strlen(type-&gt;name);
 	memcpy(buffy, type-&gt;name, i);
 	if (i &gt; 127) {tw_error(&quot;long gamename1&quot;);}
@@ -1001,7 +969,8 @@
 	return;
 }
 
-void Game::init_lag() {STACKTRACE
+void Game::init_lag() {
+  STACKTRACE;
 	if ((log-&gt;type == Log::log_net1server) || (log-&gt;type == Log::log_net1client)) {
 		int lag_time = 0;//get_config_int(&quot;Network&quot;, &quot;Lag&quot;, 200);
 		char blah = 0;
@@ -1033,7 +1002,8 @@
 	}
 }
 
-void Game::change_view(View *new_view) {STACKTRACE//this function looks wrong to me
+void Game::change_view(View *new_view) {
+  STACKTRACE;//this function looks wrong to me
 	View *v = new_view;
 	v-&gt;preinit();
 	v-&gt;init(view);
@@ -1052,7 +1022,8 @@
 	return;
 }
 
-void Game::change_view(const char * name) {STACKTRACE
+void Game::change_view(const char * name) {
+  STACKTRACE;
 	View *v = get_view(name, view);
 	if (!v)	{tw_error(&quot;Game::change_view - invalid view name&quot;);}
 	if (view)
@@ -1081,7 +1052,7 @@
 	delete tic_history; tic_history = NULL;
 	delete render_history; render_history = NULL;
 
-	tw_sound.play_music(std::string(&quot;&quot;));
+	tw_sound-&gt;play_music(std::string(&quot;&quot;));
 
 	message.out(&quot;deleteing game objects&quot;);
 	destroy_all();
@@ -1096,6 +1067,7 @@
 
 bool Game::is_paused() 
 {
+  STACKTRACE;
   if (time_paused != -1) 
     return true;
   return false;
@@ -1103,6 +1075,7 @@
 
 void Game::pause() 
 {
+  STACKTRACE;
   if (time_paused != -1) 
     tw_error (&quot;can't pause -- already paused&quot;);
   time_paused = get_time();
@@ -1110,6 +1083,7 @@
 
 void Game::unpause() 
 {
+  STACKTRACE;
   if (time_paused == -1) 
     tw_error (&quot;can't unpause -- not paused&quot;);
   redraw();
@@ -1120,6 +1094,7 @@
 
 void Game::save_screenshot() 
 {
+  STACKTRACE;
   static int shot_index = 0;
   char path[80];
 
@@ -1149,6 +1124,7 @@
 
 bool Game::handle_key(int k) 
 {
+  STACKTRACE;
   switch (k &gt;&gt; 8) 
     {
 #if !defined _DEBUG
@@ -1177,7 +1153,7 @@
     case KEY_F1: 
       {// help
 	pause();
-	show_file(data_full_path(&quot;ingame.txt&quot;).c_str());
+	show_file(data_full_path(&quot;ingame.txt&quot;));
 	unpause();
 	return true;
       }
@@ -1279,29 +1255,37 @@
   return false;
 }
 
-int Game::set_frame_time(int t) {STACKTRACE
+int Game::set_frame_time(int t) {
+  STACKTRACE;
 	this-&gt;frame_time = t;
 	prepare();
 	return 1;
 }
 
-int Game::set_turbo(double t) {STACKTRACE
-	this-&gt;normal_turbo = t;
-	prepare();
-	return 1;
+int Game::set_turbo(double t) 
+{
+  STACKTRACE;
+  this-&gt;normal_turbo = t;
+  prepare();
+  return 1;
 }
 
-double Game::get_turbo() {
-	return this-&gt;normal_turbo;
+double Game::get_turbo() 
+{
+  STACKTRACE;
+  return this-&gt;normal_turbo;
 }
 
 void Game::play_music() 
 {
-  tw_sound.play_music(data_full_path(&quot;music/Robeter-battle-music-remix.ogg&quot;));
+  STACKTRACE;
+  tw_sound-&gt;play_music(data_full_path(&quot;music/Robeter-battle-music-remix.ogg&quot;));
   return;
 }
 
-void Game::quit(const char *message) { 
-	game_done = true;
+void Game::quit(const char *message) 
+{
+  STACKTRACE; 
+  game_done = true;
 }
 

Modified: branches/multiplayer-branch/source/melee/mgame.h
===================================================================
--- branches/multiplayer-branch/source/melee/mgame.h	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/melee/mgame.h	2004-09-28 19:53:03 UTC (rev 71)
@@ -27,15 +27,17 @@
 extern int random_seed[2];
 extern int interpolate_frames;
 
-class GameType {
-	private:
-	Game *(*_new_game)();
-	public:
-	double order;
-	char *name;
-	Game *new_game();
-	GameType ( const char *name, Game *(*new_game)(), double order = 0);
-	};
+class GameType 
+{
+ private:
+  Game *(*_new_game)();
+ public:
+  double order;
+  char *name;
+  Game *new_game();
+  GameType ( const char *name, Game *(*new_game)(), double order = 0);
+};
+
 extern int num_games;
 extern char **game_names;
 extern GameType **games;
@@ -43,26 +45,23 @@
 GameType *gametype(const char *name);
 
 
-// these are default data used in ships and game objects, which in principle, should be
-// independent of the (normal) game type.
+/// \brief these are default data used in ships and game objects, which in principle, should be
+/// independent of the (normal) game type.
 class MeleeData
 {
-public:
-	MeleeData();
-
-	void init();
-	void deinit();
+ public:
+  MeleeData();
+  ~MeleeData();
 	
-	SpaceSprite *planetSprite;
-	SpaceSprite *asteroidSprite;
-	SpaceSprite *asteroidExplosionSprite;
-	SpaceSprite *sparkSprite;
-	SpaceSprite *hotspotSprite;
-	SpaceSprite *kaboomSprite;
-	SpaceSprite *panelSprite;
-	SpaceSprite *xpl1Sprite;
-
-	std::string planet_victory;
+  SpaceSprite *planetSprite;
+  SpaceSprite *asteroidSprite;
+  SpaceSprite *asteroidExplosionSprite;
+  SpaceSprite *sparkSprite;
+  SpaceSprite *hotspotSprite;
+  SpaceSprite *kaboomSprite;
+  SpaceSprite *panelSprite;
+  SpaceSprite *xpl1Sprite;
+  
 };
 
 
@@ -71,6 +70,8 @@
  public:
   GameType *type;
   
+  MeleeData meleedata;
+  
   enum 
     {
       channel_none = -1,    /**&lt; not a valid channel */

Modified: branches/multiplayer-branch/source/melee/mhelpers.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mhelpers.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/melee/mhelpers.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -25,7 +25,6 @@
 #include &lt;stdio.h&gt;
 #include &lt;string.h&gt;
 #include &lt;assert.h&gt;
-#include &quot;util/sounds.h&quot;
 #include &quot;other/dialogs.h&quot;
 
 #include &quot;melee/mmain.h&quot;
@@ -42,37 +41,25 @@
 Byte Ordering (endianness)
 	offers invert_ordering, intel_ordering, motorola_ordering, 
 	normal versions are 32 bit; and short versions of each are 16 bit
-File Registration System
-	keeps a list of linked files &amp; compile times
-VideoSystem
-	sets screen resolutions, color formats, color transforms, fonts
-	gets screen surface
-	records redraw event times
-SoundSystem
-	inits sound hardware
-	plays sounds
-	loads sounds
 
-SC2 Unit Conversion
-Help Dialog
 
+
 */
 
 #define PLATFORM_IS_ALLEGRO
 
 #if defined PLATFORM_IS_ALLEGRO
-	#include &lt;allegro.h&gt;
-	#if defined ALLEGRO_MSVC
-		#include &lt;winalleg.h&gt;
-		#include &lt;windows.h&gt;
-	#endif
+#include &lt;allegro.h&gt;
+#if defined ALLEGRO_MSVC
+#include &lt;winalleg.h&gt;
+#include &lt;windows.h&gt;
+#endif
 #else
-	#error unknown platform (allegro?)
+#error unknown platform (allegro?)
 #endif
 
 
 #include &quot;melee.h&quot;
-REGISTER_FILE
 
 #include &quot;scp.h&quot;
 
@@ -83,536 +70,539 @@
 volatile int debug_value = 0;
 
 
-
-
-
-
-
-
 /*------------------------------
-		File Registration System
-------------------------------*/
-registered_file_type *registered_files = NULL;
-int num_registered_files = 0;
-void _register_file (char *fname, char *fdate, char *ftime) {
-	registered_files = (registered_file_type*) realloc(registered_files, sizeof(registered_file_type) * (num_registered_files+1));
-	registered_files[num_registered_files].fname = fname;
-	registered_files[num_registered_files].fdate = fdate;
-	registered_files[num_registered_files].ftime = ftime;
-	num_registered_files += 1;
-	return;
-	}
-
-
-/*------------------------------
 		Video mode
 ------------------------------*/
-int  GFX_TIMEWARP_WINDOW =  
-#if defined DJGPP
-	GFX_AUTODETECT
-#else
-//	GFX_OPENGL_WINDOWED
-	GFX_AUTODETECT_WINDOWED
-	//GFX_GDI
-#endif
-;
-int GFX_TIMEWARP_FULLSCREEN = 
-GFX_AUTODETECT_FULLSCREEN
-//GFX_AUTODETECT
-;
+int  GFX_TIMEWARP_WINDOW =  GFX_AUTODETECT_WINDOWED;
+int GFX_TIMEWARP_FULLSCREEN = GFX_AUTODETECT_FULLSCREEN;
 
+VideoSystem* videosystem = NULL;
 
-VideoSystem videosystem;
-
-static void tw_display_switch_out() {
+static void tw_display_switch_out() 
+{
 }
 
-static void tw_display_switch_in() {
-	if (get_time() &gt; videosystem.last_poll + 1000) {
-		videosystem.redraw();
-	}
-	else videosystem.screen_corrupted = true;
+static void tw_display_switch_in() 
+{
+  if (get_time() &gt; videosystem-&gt;last_poll + 1000) 
+    {
+      videosystem-&gt;redraw();
+    }
+  else 
+    videosystem-&gt;screen_corrupted = true;
 }
 
 static int _gamma = -1;
 static unsigned char _gamma_map[256];
-int get_gamma() {
-	return _gamma;
+int get_gamma() 
+{
+  return _gamma;
 }
-void set_gamma(int gamma) {
-	if (gamma &lt; 0) gamma = 0;
-	if (gamma &gt; 255) gamma = 255;
-	_gamma = gamma;
-	int i;
-	for (i = 0; i &lt; 256; i += 1) {
-		_gamma_map[i] = iround_down(256 * pow(i / 255.5, 1-gamma/258.));
-	}
-	return;
+
+void set_gamma(int gamma) 
+{
+  if (gamma &lt; 0) 
+    gamma = 0;
+  if (gamma &gt; 255) 
+    gamma = 255;
+  _gamma = gamma;
+  int i;
+  for (i = 0; i &lt; 256; i += 1) 
+    {
+      _gamma_map[i] = iround_down(256 * pow(i / 255.5, 1-gamma/258.));
+    }
+  return;
 }
-void gamma_color_effects (RGB *c) {
-	if (!c-&gt;filler) {
-		c-&gt;r = _gamma_map[c-&gt;r];
-		c-&gt;g = _gamma_map[c-&gt;g];
-		c-&gt;b = _gamma_map[c-&gt;b];
+
+void gamma_color_effects (RGB *c) 
+{
+  if (!c-&gt;filler) 
+    {
+      c-&gt;r = _gamma_map[c-&gt;r];
+      c-&gt;g = _gamma_map[c-&gt;g];
+      c-&gt;b = _gamma_map[c-&gt;b];
+    }
+  else 
+    {
+      int alpha = (c-&gt;filler ^ 255) + 1;
+      int r, g, b;
+      r = (c-&gt;r &lt;&lt; 8) / alpha;
+      g = (c-&gt;g &lt;&lt; 8) / alpha;
+      b = (c-&gt;b &lt;&lt; 8) / alpha;
+      if ((r | g | b) &gt; 255) 
+	{
+	  tw_error(&quot;gamma_color_effects : premultiplied alpha color invalid&quot;);
 	}
-	else {
-		int alpha = (c-&gt;filler ^ 255) + 1;
-		int r, g, b;
-		r = (c-&gt;r &lt;&lt; 8) / alpha;
-		g = (c-&gt;g &lt;&lt; 8) / alpha;
-		b = (c-&gt;b &lt;&lt; 8) / alpha;
-		if ((r | g | b) &gt; 255) {
-			tw_error(&quot;gamma_color_effects : premultiplied alpha color invalid&quot;);
-		}
-		r = _gamma_map[r];
-		g = _gamma_map[g];
-		b = _gamma_map[b];
-		r = (r * alpha) &gt;&gt; 8;
-		g = (g * alpha) &gt;&gt; 8;
-		b = (b * alpha) &gt;&gt; 8;
-		c-&gt;r = r;
-		c-&gt;g = g;
-		c-&gt;b = b;
-	}
-	return;
-	}
-int tw_color (RGB c) {
-	videosystem.color_effects(&amp;c);
-	return makecol(c.r, c.g, c.b);
+      r = _gamma_map[r];
+      g = _gamma_map[g];
+      b = _gamma_map[b];
+      r = (r * alpha) &gt;&gt; 8;
+      g = (g * alpha) &gt;&gt; 8;
+      b = (b * alpha) &gt;&gt; 8;
+      c-&gt;r = r;
+      c-&gt;g = g;
+      c-&gt;b = b;
+    }
+  return;
 }
-int tw_color (int r, int g, int b) {
-	RGB c = {r,g,b};
-	return makecol(c.r, c.g, c.b);
+
+int tw_color (RGB c) 
+{
+  videosystem-&gt;color_effects(&amp;c);
+  return makecol(c.r, c.g, c.b);
 }
-int VideoSystem::poll_redraw() {
-	last_poll = get_time();
-	if (screen_corrupted) {
-		screen_corrupted = false;
-		videosystem.redraw();
-		return 1;
-	}
-	return 0;
+
+int tw_color (int r, int g, int b) 
+{
+  RGB c = {r,g,b};
+  return makecol(c.r, c.g, c.b);
 }
-void VideoSystem::preinit() {STACKTRACE
-	int i;
-	surface = NULL;
-	width = -1;
-	height = -1;
-	bpp = -1;
-	fullscreen = false;
-	font_data = NULL;
-	basic_font = NULL;
-	palette = (RGB*)malloc(sizeof(RGB) * 256);
-	if (1) {
-		FILE *f = fopen(data_full_path(&quot;palette&quot;).c_str(), &quot;rb&quot;);
-		if (f) {
-			for (i = 0; i &lt; 256; i += 1) {
-				palette[i].r = fgetc(f);
-				palette[i].g = fgetc(f);
-				palette[i].b = fgetc(f);
-				palette[i].filler = 0;
-			}
-			fclose(f);
-		}
-	}
-	else {
-		enum {
-			r_levels = 6,
-			g_levels = 6,
-			b_levels = 6,
-			total_levels = r_levels * g_levels * b_levels
-		};
-		COMPILE_TIME_ASSERT(total_levels &lt; 256);
-		for (i = 0; i &lt; 256; i += 1) {
-			if (i &lt; total_levels) {
-				int j = 1;
-				palette[i].r = ((i/j)%r_levels) * 255 / r_levels;
-				j *= r_levels;
-				palette[i].g = ((i/j)%g_levels) * 255 / g_levels;
-				j *= g_levels;
-				palette[i].b = ((i/j)%b_levels) * 255 / b_levels;
-				j *= b_levels;
-			}
-			else {
-				palette[i].r = 0;
-				palette[i].g = 0;
-				palette[i].b = 0;
-				palette[i].filler = 0;
-			}
-			/*palette[i].r = (((i &gt;&gt; 0) &amp; (bit(red_bits)-1)) * 255) / (bit(red_bits)-1);
-			palette[i].g = (((i &gt;&gt; red_bits) &amp; (bit(green_bits)-1)) * 255) / (bit(green_bits)-1);
-			palette[i].b = (((i &gt;&gt; (red_bits+green_bits)) &amp; (bit(blue_bits)-1)) * 255) / (bit(blue_bits)-1);*/
-		}
-	}
-	color_effects = gamma_color_effects;
 
-	screen_corrupted = false;
-	last_poll = -1;
-	window.preinit();
-	window.init( &amp;window );
-	window.locate(0,0,0,0,  0,1,0,1);
+int VideoSystem::poll_redraw() 
+{
+  STACKTRACE;
+  last_poll = get_time();
+  if (screen_corrupted) 
+    {
+      screen_corrupted = false;
+      videosystem-&gt;redraw();
+      return 1;
+    }
+  return 0;
 }
-FONT *VideoSystem::get_font(int s) {STACKTRACE
-	if (!font_data) {
-		if (basic_font) return basic_font;
-		if (!font) {
-			tw_error_exit(&quot;VideoSystem::get_font - something horribly wrong!&quot;);
-			return font;
-		}
+
+void VideoSystem::preinit() 
+{
+  STACKTRACE;
+  int i;
+  surface = NULL;
+  width = -1;
+  height = -1;
+  bpp = -1;
+  fullscreen = false;
+  font_data = NULL;
+  basic_font = NULL;
+  palette = (RGB*)malloc(sizeof(RGB) * 256);
+
+  FILE *f = fopen(data_full_path(&quot;palette&quot;).c_str(), &quot;rb&quot;);
+  if (f) 
+    {
+      for (i = 0; i &lt; 256; i += 1) 
+	{
+	  palette[i].r = fgetc(f);
+	  palette[i].g = fgetc(f);
+	  palette[i].b = fgetc(f);
+	  palette[i].filler = 0;
 	}
-	if (s &lt; 0) s = 0;
-	if (s &gt; 7) s = 7;
-	return (FONT*) font_data[s].dat;
+      fclose(f);
+    } 
+  
+  color_effects = gamma_color_effects;
+  
+  screen_corrupted = false;
+  last_poll = -1;
+  window.preinit();
+  window.init( &amp;window );
+  window.locate(0,0,0,0,  0,1,0,1);
 }
-void VideoSystem::set_palette(RGB *new_palette) {STACKTRACE
-	memcpy(palette, new_palette, sizeof(RGB) * 256);
-	update_colors();
-	return;
-}
-void VideoSystem::update_colors() {STACKTRACE
-	RGB tmp[256];
-	if (!palette) return;
-	memcpy(tmp, palette, sizeof(RGB) * 256);
-	int i;	
-	for (i = 1; i &lt; 256; i += 1) {
-		color_effects(&amp;tmp[i]);
-		tmp[i].r = ((unsigned int)(tmp[i].r) * 63) / 255;
-		tmp[i].g = ((unsigned int)(tmp[i].g) * 63) / 255;
-		tmp[i].b = ((unsigned int)(tmp[i].b) * 63) / 255;
+
+FONT *VideoSystem::get_font(int s) 
+{
+  STACKTRACE;
+  if (!font_data) 
+    {
+      if (basic_font) 
+	return basic_font;
+      if (!font) 
+	{
+	  tw_error_exit(&quot;VideoSystem::get_font - something horribly wrong!&quot;);
+	  return font;
 	}
-	if (rgb_map) create_rgb_table ( rgb_map, tmp, NULL);
-	::set_palette(tmp);
-	return;
+    }
+  if (s &lt; 0) s = 0;
+  if (s &gt; 7) s = 7;
+  return (FONT*) font_data[s].dat;
 }
-void VideoSystem::redraw() {
-	VideoEvent ve;
-	ve.type = Event::VIDEO;
-	ve.subtype = VideoEvent::REDRAW;
-	ve.window = &window;
-	window._event(&amp;ve);
-	//clear_to_color(surface, palette_color[4]);
+
+void VideoSystem::set_palette(RGB *new_palette) 
+{
+  STACKTRACE;
+  memcpy(palette, new_palette, sizeof(RGB) * 256);
+  update_colors();
+  return;
 }
-int VideoSystem::set_resolution (int width, int height, int bpp, int fullscreen) {STACKTRACE
-	VideoEvent ve;
-	ve.type = Event::VIDEO;
-	ve.window = &window;
-	if (width == 0) width = this-&gt;width;
-	if (height == 0) height = this-&gt;height;
-	if (bpp == 0) bpp = this-&gt;bpp;
-	if (!basic_font) basic_font = font;
-	if (!font_data) font_data = load_datafile(&quot;fonts.dat&quot;);
-	if ((bpp == this-&gt;bpp) &amp;&amp; (width == this-&gt;width) &amp;&amp; (height == this-&gt;height) &amp;&amp; (fullscreen == this-&gt;fullscreen)) return true;
-	if ((width &lt; 300) || (height &lt; 200)) {
-		char buffy[512];
-		sprintf(buffy, &quot;Error switching to graphics mode\n(%dx%d @ %d bit)\nresolution too low&quot;, width, height, bpp);
-		if (this-&gt;bpp == -1) {
-			tw_error_exit(buffy);
-		}
-		tw_alert (buffy, &quot;Continue&quot;);
-		return false;
-	}
-	ve.subtype = VideoEvent::INVALID;
-	window._event(&amp;ve);
-	surface = NULL;
-	set_color_depth(bpp);
-	if ( set_gfx_mode((fullscreen ? GFX_TIMEWARP_FULLSCREEN : GFX_TIMEWARP_WINDOW), width, height, 0, 0)) {
-		const char *part1 = &quot;Error switching to graphics mode&quot;;
-		char part2[256];
-		sprintf (part2, &quot;(%dx%d @ %d bit)&quot;, width, height, bpp);
-		const char *part3 = allegro_error;
-		if (this-&gt;bpp == -1) {
-			char buffy[1024];
-			sprintf(buffy, &quot;%s\n%s\n%s&quot;, part1, part2, part3);
-			tw_error_exit(buffy);
-		}
-		set_color_depth(this-&gt;bpp);
-		set_gfx_mode((this-&gt;fullscreen ? GFX_TIMEWARP_FULLSCREEN : GFX_TIMEWARP_WINDOW), this-&gt;width, this-&gt;height, 0, 0);
-		alert (part1, part2, part3, &quot;Continue&quot;, NULL, ' ', '\n');
-		surface = screen;
-		ve.subtype = VideoEvent::VALID;
-		window._event(&amp;ve);
-		surface = NULL;
-		redraw();
-		return false;
-	}
-	surface = screen;
-	if (set_display_switch_mode(SWITCH_BACKAMNESIA) == -1)
-		set_display_switch_mode(SWITCH_BACKGROUND);
-	set_display_switch_callback(SWITCH_IN, tw_display_switch_in);
-	set_display_switch_callback(SWITCH_OUT, tw_display_switch_out);
 
-	int owidth, oheight, obpp, ogamma, ofullscreen;
-	owidth = this-&gt;width; oheight = this-&gt;height; obpp = this-&gt;bpp; 
-	ogamma = this-&gt;gamma; ofullscreen = this-&gt;fullscreen;
+void VideoSystem::update_colors() 
+{
+  STACKTRACE;
+  RGB tmp[256];
+  if (!palette) return;
+  memcpy(tmp, palette, sizeof(RGB) * 256);
+  int i;	
+  for (i = 1; i &lt; 256; i += 1) 
+    {
+      color_effects(&amp;tmp[i]);
+      tmp[i].r = ((unsigned int)(tmp[i].r) * 63) / 255;
+      tmp[i].g = ((unsigned int)(tmp[i].g) * 63) / 255;
+      tmp[i].b = ((unsigned int)(tmp[i].b) * 63) / 255;
+    }
+  if (rgb_map) 
+    create_rgb_table ( rgb_map, tmp, NULL);
+  ::set_palette(tmp);
+  return;
+}
 
-	this-&gt;width = width;
-	this-&gt;height = height;
-	this-&gt;bpp = bpp;
-	//this-&gt;gamma = gamma;
-	this-&gt;fullscreen = fullscreen;
-	update_colors();
-	if (font_data) font = (FONT *)(font_data[15].dat);
-	else font = basic_font;
-	if (bpp == 8) {
-		if (!rgb_map) rgb_map = (RGB_MAP*)malloc(1&lt;&lt;15);
-		RGB tmp[256];
-		memcpy(tmp, palette, sizeof(RGB) * 256);
-		int i;	
-		for (i = 0; i &lt; 256; i += 1) {
-			tmp[i].r = ((unsigned int)(tmp[i].r) * 63) / 255;
-			tmp[i].g = ((unsigned int)(tmp[i].g) * 63) / 255;
-			tmp[i].b = ((unsigned int)(tmp[i].b) * 63) / 255;
-		}
-		create_rgb_table ( rgb_map, tmp, NULL);
+void VideoSystem::redraw() 
+{
+  STACKTRACE;
+  VideoEvent ve;
+  ve.type = Event::VIDEO;
+  ve.subtype = VideoEvent::REDRAW;
+  ve.window = &window;
+  window._event(&amp;ve);
+}
+
+int VideoSystem::set_resolution (int width, int height, int bpp, int fullscreen) 
+{
+  VideoEvent ve;
+  ve.type = Event::VIDEO;
+  ve.window = &window;
+  if (width == 0) 
+    width = this-&gt;width;
+  if (height == 0) 
+    height = this-&gt;height;
+  if (bpp == 0) 
+    bpp = this-&gt;bpp;
+  if (!basic_font) 
+    basic_font = font;
+  if (!font_data) 
+    font_data = load_datafile(&quot;fonts.dat&quot;);
+  if ((bpp == this-&gt;bpp) &amp;&amp; 
+      (width == this-&gt;width) &amp;&amp; 
+      (height == this-&gt;height) &amp;&amp; 
+      (fullscreen == this-&gt;fullscreen)) 
+    return true;
+
+  if ((width &lt; 300) || (height &lt; 200)) 
+    {
+      char buffy[512];
+      sprintf(buffy, &quot;Error switching to graphics mode\n(%dx%d @ %d bit)\nresolution too low&quot;, width, height, bpp);
+      if (this-&gt;bpp == -1) 
+	{
+	  tw_error_exit(buffy);
 	}
-	if (obpp != bpp) {
-		ve.subtype = VideoEvent::CHANGE_BPP;
-		window._event(&amp;ve);
+      tw_alert (buffy, &quot;Continue&quot;);
+      return false;
+    }
+  ve.subtype = VideoEvent::INVALID;
+  window._event(&amp;ve);
+  surface = NULL;
+  set_color_depth(bpp);
+  if ( set_gfx_mode((fullscreen ? GFX_TIMEWARP_FULLSCREEN : GFX_TIMEWARP_WINDOW), width, height, 0, 0)) 
+    {
+      const char *part1 = &quot;Error switching to graphics mode&quot;;
+      char part2[256];
+      sprintf (part2, &quot;(%dx%d @ %d bit)&quot;, width, height, bpp);
+      const char *part3 = allegro_error;
+      if (this-&gt;bpp == -1) 
+	{
+	  char buffy[1024];
+	  sprintf(buffy, &quot;%s\n%s\n%s&quot;, part1, part2, part3);
+	  tw_error_exit(buffy);
 	}
-	if ((owidth != width) || (oheight != height)) {
-		ve.subtype = VideoEvent::RESIZE;
-		window._event(&amp;ve);
+      set_color_depth(this-&gt;bpp);
+      set_gfx_mode((this-&gt;fullscreen ? GFX_TIMEWARP_FULLSCREEN : GFX_TIMEWARP_WINDOW), 
+		   this-&gt;width, this-&gt;height, 0, 0);
+      alert (part1, part2, part3, &quot;Continue&quot;, NULL, ' ', '\n');
+      surface = screen;
+      ve.subtype = VideoEvent::VALID;
+      window._event(&amp;ve);
+      surface = NULL;
+      redraw();
+      return false;
+    }
+  surface = screen;
+  if (set_display_switch_mode(SWITCH_BACKAMNESIA) == -1)
+    set_display_switch_mode(SWITCH_BACKGROUND);
+  set_display_switch_callback(SWITCH_IN, tw_display_switch_in);
+  set_display_switch_callback(SWITCH_OUT, tw_display_switch_out);
+  
+  int owidth, oheight, obpp, ogamma, ofullscreen;
+  owidth = this-&gt;width; oheight = this-&gt;height; obpp = this-&gt;bpp; 
+  ogamma = this-&gt;gamma; ofullscreen = this-&gt;fullscreen;
+
+  this-&gt;width = width;
+  this-&gt;height = height;
+  this-&gt;bpp = bpp;
+  this-&gt;fullscreen = fullscreen;
+  update_colors();
+  if (font_data) 
+    font = (FONT *)(font_data[15].dat);
+  else 
+    font = basic_font;
+  if (bpp == 8) 
+    {
+      if (!rgb_map) rgb_map = (RGB_MAP*)malloc(1&lt;&lt;15);
+      RGB tmp[256];
+      memcpy(tmp, palette, sizeof(RGB) * 256);
+      int i;	
+      for (i = 0; i &lt; 256; i += 1) 
+	{
+	  tmp[i].r = ((unsigned int)(tmp[i].r) * 63) / 255;
+	  tmp[i].g = ((unsigned int)(tmp[i].g) * 63) / 255;
+	  tmp[i].b = ((unsigned int)(tmp[i].b) * 63) / 255;
 	}
-
-	ve.subtype = VideoEvent::VALID;
-	window._event(&amp;ve);
-
-	redraw();
-	return true;
+      create_rgb_table ( rgb_map, tmp, NULL);
+  }
+  if (obpp != bpp) 
+    {
+      ve.subtype = VideoEvent::CHANGE_BPP;
+      window._event(&amp;ve);
+    }
+  if ((owidth != width) || (oheight != height)) 
+    {
+      ve.subtype = VideoEvent::RESIZE;
+      window._event(&amp;ve);
+    }
+  
+  ve.subtype = VideoEvent::VALID;
+  window._event(&amp;ve);
+  
+  redraw();
+  return true;
 }
 
-
-
-struct VW_lock_data {
-	short int x, y, w, h;
+struct VW_lock_data 
+{
+  short int x, y, w, h;
 };
 
-void VideoWindow::lock ( ) {
-	//int i = lock_level;
-	lock_level += 1;
-	//if (!surface) return;
-	if (lock_level == 1) {
-/*		if (!lock_data) lock_data = (VW_lock_data*)malloc(sizeof(VW_lock_data));
-		if (w &amp;&amp; h) {
-			lock_data[i].x = surface-&gt;cl;
-			lock_data[i].y = surface-&gt;ct;
-			lock_data[i].w = surface-&gt;cr - surface-&gt;cl;
-			lock_data[i].h = surface-&gt;cb - surface-&gt;ct;
-			set_clip(surface, x, y, x+w-1, y+h-1);
-		}
-		else {
-			lock_data[i].x = 0;
-			lock_data[i].y = 0;
-			lock_data[i].w = 0;
-			lock_data[i].h = 0;
-		}*/
-		set_clip(surface, x, y, x+w-1, y+h-1);
-		acquire_bitmap(surface);
-	}
+void VideoWindow::lock ( ) 
+{
+  lock_level += 1;
+  if (lock_level == 1) 
+    {
+      set_clip(surface, x, y, x+w-1, y+h-1);
+      acquire_bitmap(surface);
+    }
 }
-void VideoWindow::unlock ( ) {
-	//int i = lock_level - 1;
-	if (lock_level == 0) {
-		tw_error(&quot;VideoWindow unlocked too many times&quot;);
-		return;
-	}
-	lock_level -= 1;
-	//if (!surface) return;
-/*	if (w &amp;&amp; h) {
-		set_clip(surface, lock_data[i].x, lock_data[i].y,
-			lock_data[i].x + lock_data[i].w - 1,
-			lock_data[i].y + lock_data[i].h - 1
-			);
-	}*/
-	if (lock_level == 0) {
-		release_bitmap(surface);
-		set_clip(surface, 0, 0, surface-&gt;w-1, surface-&gt;h-1);
-	}
+
+void VideoWindow::unlock ( ) 
+{
+  if (lock_level == 0) {
+    tw_error(&quot;VideoWindow unlocked too many times&quot;);
+    return;
+  }
+  lock_level -= 1;
+  if (lock_level == 0) 
+    {
+      release_bitmap(surface);
+      set_clip(surface, 0, 0, surface-&gt;w-1, surface-&gt;h-1);
+    }
 }
+
 #define VideoWindow_callbacklist_units 4
-void VideoWindow::match ( VideoWindow *old ) {
-	if (lock_level) {tw_error(&quot;VideoWindow - illegal while locked&quot;);}
-	if (!parent &amp;&amp; old-&gt;parent) init( old-&gt;parent );
-	locate ( 
-		old-&gt;const_x, old-&gt;propr_x, 
-		old-&gt;const_y, old-&gt;propr_y, 
-		old-&gt;const_w, old-&gt;propr_w,
-		old-&gt;const_h, old-&gt;propr_h
-		);
-	return;
+void VideoWindow::match ( VideoWindow *old ) 
+{
+  if (lock_level) 
+    {
+      tw_error(&quot;VideoWindow - illegal while locked&quot;);
+    }
+  if (!parent &amp;&amp; old-&gt;parent) 
+    init( old-&gt;parent );
+  locate 
+    ( 
+     old-&gt;const_x, old-&gt;propr_x, 
+     old-&gt;const_y, old-&gt;propr_y, 
+     old-&gt;const_w, old-&gt;propr_w,
+     old-&gt;const_h, old-&gt;propr_h
+     );
+  return;
 }
-void VideoWindow::hide() {
-	locate(0,0,0,0,0,0,0,0);
-	return;
+
+void VideoWindow::hide() 
+{
+  STACKTRACE;
+  locate(0,0,0,0,0,0,0,0);
+  return;
 }
-void VideoWindow::add_callback( BaseClass *callee ) {
-  //int i;
-  //	for (i = 0; i &lt; num_callbacks; i += 1) {
-  //	if (callback_list[i] == callee) {tw_error(&quot;adding VideoWindow callback twice&quot;);}
-  //}
+
+void VideoWindow::add_callback( BaseClass *callee ) 
+{
+  STACKTRACE;
   std::list&lt;BaseClass*&gt;::iterator cb = std::find(callback_list.begin(),callback_list.end(), callee);
   if(cb != callback_list.end())
     {
       tw_error(&quot;adding VideoWindow callback twice&quot;);
     }
   callback_list.push_back(callee);
-  //	if (!(num_callbacks &amp; (VideoWindow_callbacklist_units-1))) {
-  //	callback_list = (BaseClass**) realloc(callback_list, sizeof(BaseClass*) * 
-  //		(num_callbacks + VideoWindow_callbacklist_units) );
-  //}
-  //callback_list[num_callbacks] = callee;
-  //num_callbacks += 1;
   return;
 }
 
-void VideoWindow::remove_callback( BaseClass *callee ) {
-  //int i;
-  //	for (i = 0; i &lt; num_callbacks; i += 1) {
-  //	if (callback_list[i] == callee) {
-  //		callback_list[i] = callback_list[num_callbacks-1];
-  //		num_callbacks -= 1;
-  //		if (!(num_callbacks &amp; (VideoWindow_callbacklist_units-1))) callback_list = (BaseClass**)
-  //			realloc(callback_list, sizeof(BaseClass*) * (num_callbacks) );
-  //		return;
-  //	}
-  //}
+void VideoWindow::remove_callback( BaseClass *callee ) 
+{
+  STACKTRACE;
   callback_list.remove(callee);
   return;
 }
-void VideoWindow::event(int subtype) {
-	if (lock_level) {tw_error(&quot;VideoWindow - illegal while locked&quot;);}
-	VideoEvent ve;
-	ve.type = Event::VIDEO;
-	ve.subtype = subtype;
-	ve.window = this;
-	issue_event( callback_list, &amp;ve);
-	return;
+
+void VideoWindow::event(int subtype) 
+{
+  STACKTRACE;
+  if (lock_level) 
+    {tw_error(&quot;VideoWindow - illegal while locked&quot;);}
+  VideoEvent ve;
+  ve.type = Event::VIDEO;
+  ve.subtype = subtype;
+  ve.window = this;
+  issue_event( callback_list, &amp;ve);
+  return;
 }
-void VideoWindow::update_pos() {
-	if (lock_level) {tw_error(&quot;VideoWindow - illegal while locked&quot;);}
-	int nx = 0, ny = 0, nw = 0, nh = 0;
-	if (parent == this) {
-		surface = videosystem.surface;
-		if (surface) {
-			nx = 0;
-			ny = 0;
-			nw = videosystem.width;
-			nh = videosystem.height;
-		}
+
+void VideoWindow::update_pos() 
+{
+  STACKTRACE;
+  if (lock_level) 
+    {tw_error(&quot;VideoWindow - illegal while locked&quot;);}
+  int nx = 0, ny = 0, nw = 0, nh = 0;
+  if (parent == this) 
+    {
+      surface = videosystem-&gt;surface;
+      if (surface) 
+	{
+	  nx = 0;
+	  ny = 0;
+	  nw = videosystem-&gt;width;
+	  nh = videosystem-&gt;height;
 	}
-	else {
-		if (parent) surface = parent-&gt;surface;
-		else surface = NULL;
-		if (surface) {
-			nx = parent-&gt;x;
-			ny = parent-&gt;y;
-			nw = parent-&gt;w;
-			nh = parent-&gt;h;
-		}
-	}
-
-	x = nx + iround_up(const_x + propr_x * nw - 0.05);
-	y = ny + iround_up(const_y + propr_y * nh - 0.05);
-	w = iround_down(const_w + propr_w * nw + 0.05);
-	h = iround_down(const_h + propr_h * nh + 0.05);
-
-	if ((w &lt;= 0) || (h &lt;= 0)) surface = NULL;
-	return;
+    }
+  else 
+    {
+      if (parent) surface = parent-&gt;surface;
+      else surface = NULL;
+      if (surface) {
+	nx = parent-&gt;x;
+	ny = parent-&gt;y;
+	nw = parent-&gt;w;
+	nh = parent-&gt;h;
+      }
+    }
+  
+  x = nx + iround_up(const_x + propr_x * nw - 0.05);
+  y = ny + iround_up(const_y + propr_y * nh - 0.05);
+  w = iround_down(const_w + propr_w * nw + 0.05);
+  h = iround_down(const_h + propr_h * nh + 0.05);
+  
+  if ((w &lt;= 0) || (h &lt;= 0)) surface = NULL;
+  return;
 }
 
-void VideoWindow::_event( Event *e ) {
-	if (e-&gt;type == Event::VIDEO) {
-		const VideoEvent *ve = (const VideoEvent *) e;
-		if (ve-&gt;window != parent) {tw_error (&quot;VideoWindow event not from parent?&quot;);}
-		VideoEvent nve;
-		nve.type = Event::VIDEO;
-		nve.window = this;
-		nve.subtype = ve-&gt;subtype;
-		switch (ve-&gt;subtype) {
-			case VideoEvent::RESIZE : {
-				update_pos();
-			} break;
-			case VideoEvent::INVALID: {
-				x = y = w = h = 0;
-				surface = NULL;
-			} break;
-			case VideoEvent::VALID: {
-				update_pos();
-			} break;
-			case VideoEvent::REDRAW: {
-				//update_pos();
-			} break;
-		}
-		issue_event( callback_list, &amp;nve);
+void VideoWindow::_event( Event *e ) 
+{
+  STACKTRACE;
+  if (e-&gt;type == Event::VIDEO) 
+    {
+      const VideoEvent *ve = (const VideoEvent *) e;
+      if (ve-&gt;window != parent) {tw_error (&quot;VideoWindow event not from parent?&quot;);}
+      VideoEvent nve;
+      nve.type = Event::VIDEO;
+      nve.window = this;
+      nve.subtype = ve-&gt;subtype;
+      switch (ve-&gt;subtype) 
+	{
+	case VideoEvent::RESIZE : 
+	  {
+	    update_pos();
+	  } 
+	break;
+	case VideoEvent::INVALID: 
+	  {
+	    x = y = w = h = 0;
+	    surface = NULL;
+	  } 
+	  break;
+	case VideoEvent::VALID: 
+	  {
+	    update_pos();
+	  } 
+	  break;
+	case VideoEvent::REDRAW: 
+	  {	    
+	  } break;
 	}
-	else {tw_error ( &quot;VideoWindow got non-video event&quot; );}
-	return;
+      issue_event( callback_list, &amp;nve);
+    }
+  else {tw_error ( &quot;VideoWindow got non-video event&quot; );}
+  return;
 }
 
-void VideoWindow::preinit () {
-	parent = NULL;
-	surface = NULL;
-	callback_list.clear();
+void VideoWindow::preinit () 
+{
+  parent = NULL;
+  surface = NULL;
+  callback_list.clear();
+  
+  lock_level = 0;
+  
+  const_x = const_y = const_w = const_h = 0;
+  propr_x = propr_y = 0;
+  propr_w = propr_h = 1;
+  x = y = w = h = 0;
+  return;
+}
 
-	lock_level = 0;
+void VideoWindow::init ( VideoWindow *parent_window) 
+{
+  if (lock_level) 
+    {tw_error(&quot;VideoWindow - illegal while locked&quot;);}
+  if (parent) 
+    parent-&gt;remove_callback( this );
+  parent = parent_window;
 
-	const_x = const_y = const_w = const_h = 0;
-	propr_x = propr_y = 0;
-	propr_w = propr_h = 1;
-	x = y = w = h = 0;
-	return;
+  if (parent &amp;&amp; (parent != this)) 
+    parent-&gt;add_callback ( this );
+  update_pos();
+  event(VideoEvent::RESIZE);
+  event(VideoEvent::REDRAW);
+  return;
 }
-void VideoWindow::init ( VideoWindow *parent_window) {
-	if (lock_level) {tw_error(&quot;VideoWindow - illegal while locked&quot;);}
-	if (parent) parent-&gt;remove_callback( this );
-	parent = parent_window;
-	//if (parent == this) {tw_error(&quot;VideoWindow - incest&quot;);}
-	if (parent &amp;&amp; (parent != this)) parent-&gt;add_callback ( this );
-	update_pos();
-	event(VideoEvent::RESIZE);
-	event(VideoEvent::REDRAW);
-	return;
+
+void VideoWindow::locate ( double x1, double x2, 
+			   double y1, double y2, 
+			   double w1, double w2, 
+			   double h1, double h2) 
+{
+  if (lock_level) {tw_error(&quot;VideoWindow - illegal while locked&quot;);}
+  const_x = x1;
+  propr_x = x2;
+  const_y = y1;
+  propr_y = y2;
+  const_w = w1;
+  propr_w = w2;
+  const_h = h1;
+  propr_h = h2;
+  update_pos();
+  event(VideoEvent::RESIZE);
+  event(VideoEvent::REDRAW);
+  return;
 }
-void VideoWindow::locate ( double x1, double x2, double y1, double y2, double w1, double w2, double h1, double h2) {
-	if (lock_level) {tw_error(&quot;VideoWindow - illegal while locked&quot;);}
-	const_x = x1;
-	propr_x = x2;
-	const_y = y1;
-	propr_y = y2;
-	const_w = w1;
-	propr_w = w2;
-	const_h = h1;
-	propr_h = h2;
-	update_pos();
-	event(VideoEvent::RESIZE);
-	event(VideoEvent::REDRAW);
-	return;
+
+void VideoWindow::deinit() 
+{
+  STACKTRACE;
+  if (lock_level) {tw_error(&quot;VideoWindow - illegal while locked&quot;);}
+  if (parent) {
+    parent-&gt;remove_callback( this );
+    parent = NULL;
+  }
+  if (callback_list.size()) 
+    {tw_error(&quot;VideowWindow - deinit illegal while child windows remain&quot;);}
 }
-void VideoWindow::deinit() {
-	if (lock_level) {tw_error(&quot;VideoWindow - illegal while locked&quot;);}
-	if (parent) {
-		parent-&gt;remove_callback( this );
-		parent = NULL;
-	}
-	if (callback_list.size()) 
-		{tw_error(&quot;VideowWindow - deinit illegal while child windows remain&quot;);}
-	/*for (int i = 0; i &lt; num_callbacks; i += 1) {
-		Event e;
-		e.type = 
-		callback_list[i]-&gt;_event(e);
-	}*/
 
-	//free(callback_list);
-	//callback_list = NULL;
-	//num_callbacks = 0;
-	callback_list.clear();
-	
-//	free(lock_data);
-//	lock_data = NULL;
+VideoWindow::~VideoWindow() 
+{
+  deinit();
 }
-VideoWindow::~VideoWindow() {
-	deinit();
-}
 
 
 /*------------------------------
@@ -620,60 +610,71 @@
 ------------------------------*/
 int time_ratio; //1000 milliseconds / SC2 framerate
 double distance_ratio;
-void init_sc2_unit_conversion() {
-	}
-int scale_frames(double value) {
-	return (int)((value + 1) * time_ratio);
-	}
-double scale_turning (double turn_rate) {
-//  turn_rate = 20.0 / ((turn_rate + 1.0) * 5.0);	
-	return (PI2 / 16) / (turn_rate + 1.0) / time_ratio;
-	}
-double scale_velocity (double velocity) {
-//  velocity = velocity / 7.5;
-//velocity = x sc2pixels / sc2frame
-//velocity = y twpixels / twframe
-//velocity = x (1. / 1600) / (50ms)
-//velocity = y (1. / 3840) / (1ms)
-// y = x * (3840 / 1600) / 50
-// WTF????
-	return velocity * distance_ratio / time_ratio;
-	}
-double scale_acceleration (double acceleration, double raw_hotspot_rate) {
-//  accel_rate = accel_rate / 100.0;
-	return acceleration * distance_ratio / (1 + raw_hotspot_rate) / time_ratio / time_ratio; 
-	}
-double scale_range (double range) {
-	return range * 40;
-	}
 
+/// \brief SC2 Unit Conversion
+void init_sc2_unit_conversion() 
+{
+}
+/// \brief SC2 Unit Conversion
+int scale_frames(double value) 
+{
+  return (int)((value + 1) * time_ratio);
+}
+/// \brief SC2 Unit Conversion
+double scale_turning (double turn_rate) 
+{
+  return (PI2 / 16) / (turn_rate + 1.0) / time_ratio;
+}
+/// \brief SC2 Unit Conversion
+double scale_velocity (double velocity) 
+{
+  return velocity * distance_ratio / time_ratio;
+}
 
-void show_file(const char *file) {
-	int i;
-	char *willy;
-	PACKFILE *f;
-	f = pack_fopen (file, F_READ);
-	if (!f) {
-		willy = (char*) malloc(strlen(file)+1);
-		sprintf(willy, &quot;Failed to load file \&quot;%s\&quot;&quot;, file);
-	}
-	else {
-		i = file_size(file);
-		willy = (char*)malloc(i+1);
-		i = pack_fread (willy, i, f);
-		pack_fclose(f);
-		willy[i] = 0;
-	}
-	show_text(willy);
-	free(willy);
-	return;
+/// \brief SC2 Unit Conversion
+double scale_acceleration (double acceleration, double raw_hotspot_rate) 
+{
+  return acceleration * distance_ratio / (1 + raw_hotspot_rate) / time_ratio / time_ratio; 
 }
-void show_text(const char *text) {
-	help_dialog[2].dp = (void *) text;
-	help_dialog[2].d1 = 0;
-	help_dialog[2].d2 = 0;
-	tw_popup_dialog(&amp;videosystem.window, help_dialog, 1);
-	return;
+/// \brief SC2 Unit Conversion
+double scale_range (double range) 
+{
+  return range * 40;
 }
 
-	
+/// \brief show file in pupup dialog
+void show_file(std::string file) 
+{
+  int i;
+  char *willy;
+  PACKFILE *f;
+  f = pack_fopen (file.c_str(), F_READ);
+  if (!f) 
+    {
+      willy = (char*) malloc(file.size()+1);
+      sprintf(willy, &quot;Failed to load file \&quot;%s\&quot;&quot;, file.c_str());
+    }
+  else 
+    {
+      i = file_size(file.c_str());
+      willy = (char*)malloc(i+1);
+      i = pack_fread (willy, i, f);
+      pack_fclose(f);
+      willy[i] = 0;
+    }
+  show_text(willy);
+  free(willy);
+  return;
+}
+
+/// \brief show text in popup dialog
+void show_text(std::string text) 
+{
+  help_dialog[2].dp = (void *) text.c_str();
+  help_dialog[2].d1 = 0;
+  help_dialog[2].d2 = 0;
+  tw_popup_dialog(&amp;videosystem-&gt;window, help_dialog, 1);
+  return;
+}
+
+

Modified: branches/multiplayer-branch/source/melee/mitems.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mitems.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/melee/mitems.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -17,7 +17,6 @@
 
 #include &lt;allegro.h&gt;
 #include &quot;melee.h&quot;
-REGISTER_FILE
 
 
 #include &quot;frame.h&quot;
@@ -31,6 +30,7 @@
 
 HealthBar::HealthBar(Ship *creator, int *toggle)
 {
+  STACKTRACE;
 	scale = 2.0;
 	bartoggle = toggle;
 	mother = creator;
@@ -38,7 +38,7 @@
 
 void HealthBar::calculate()
 {
-	STACKTRACE
+  STACKTRACE;
 
 	if ( !(mother &amp;&amp; mother-&gt;exists()) )
 	{
@@ -51,7 +51,7 @@
 
 void HealthBar::draw_bar(Ship *s, double yoffs, int len, double H, double fraction, int col1, int col2, Frame *space)
 {
-	STACKTRACE
+  STACKTRACE;
 
 	Vector2 center;
 	int d;
@@ -87,7 +87,7 @@
 
 void HealthBar::animate(Frame *space)
 {
-	STACKTRACE
+  STACKTRACE;
 
 	if (!*bartoggle)
 		return;
@@ -112,10 +112,12 @@
 
 
 
-Indicator::Indicator() : Presence() {STACKTRACE
+Indicator::Indicator() : Presence() {
+  STACKTRACE;
 	}
 
-bool Indicator::coords(Frame *space, SpaceLocation *l, Vector2 *pos, Vector2 *a_pos) {STACKTRACE
+bool Indicator::coords(Frame *space, SpaceLocation *l, Vector2 *pos, Vector2 *a_pos) {
+  STACKTRACE;
 	Vector2 p = corner(l-&gt;normal_pos());
 	Vector2 op = p;
 
@@ -146,12 +148,14 @@
 	return true;
 	}
 
-BlinkyIndicator::BlinkyIndicator(SpaceObject *target, int color) : Indicator() {STACKTRACE
+BlinkyIndicator::BlinkyIndicator(SpaceObject *target, int color) : Indicator() {
+  STACKTRACE;
 	this-&gt;target = target;
 	this-&gt;color = color;
 	}
 
 void BlinkyIndicator::animate(Frame *space) {
+  STACKTRACE;
 	if ((game-&gt;game_time &gt;&gt; 8) &amp; 1) return;
 	Vector2 p;
 	int a = coords(space, target, &amp;p);
@@ -176,17 +180,20 @@
 	}
 	return;
 	}
-void BlinkyIndicator::calculate() {STACKTRACE
+void BlinkyIndicator::calculate() {
+  STACKTRACE;
 	if (!target-&gt;exists()) die();
 	}
 
-WedgeIndicator::WedgeIndicator(SpaceLocation *target, int length, int color) : Indicator() {STACKTRACE
+WedgeIndicator::WedgeIndicator(SpaceLocation *target, int length, int color) : Indicator() {
+  STACKTRACE;
 	this-&gt;target = target;
 	this-&gt;length = length;
 	this-&gt;color = color;
 	}
 
 void WedgeIndicator::animate(Frame *space) {
+  STACKTRACE;
 	double a, a2;
 	Vector2 p, p2, tmp;
 	if (target-&gt;isInvisible() &gt; 0.5) return;
@@ -208,6 +215,7 @@
 	return;
 	}
 void WedgeIndicator::calculate() {
+  STACKTRACE;
 	if (!target-&gt;exists()) die();
 	}
 
@@ -224,7 +232,8 @@
 	accelerate(this, angle + PI/2 + PI*(random()&amp;1), 0.15, MAX_SPEED);
 	}
 
-void Orbiter::calculate() {STACKTRACE
+void Orbiter::calculate() {
+  STACKTRACE;
 	angle = trajectory_angle(center) + PI;
 	sprite_index = get_index(angle);
 	double r = distance(center) / radius;

Modified: branches/multiplayer-branch/source/melee/mlog.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mlog.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/melee/mlog.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -30,7 +30,8 @@
 //				Logging stuff
 ////////////////////////////////////////////////////////////////////////
 
-void Log::init() {STACKTRACE
+void Log::init() {
+  STACKTRACE;
 	log_len  = NULL;
 	log_size = NULL;
 	log_pos  = NULL;
@@ -93,7 +94,8 @@
 	if (log_dir[channel] &amp; direction_read) _unlog ( channel, data, size);
 	return;
 }
-void Log::_log(int channel, const void *data, int size) {STACKTRACE
+void Log::_log(int channel, const void *data, int size) {
+  STACKTRACE;
 	log_len[channel] += size;
 	while (log_len[channel] &gt; log_size[channel]) {
 		if (log_size[channel]) log_size[channel] = log_size[channel] * 2;
@@ -104,7 +106,7 @@
 	return;
 }
 void Log::_unlog(int channel, void *data, int size) {
-	STACKTRACE;
+  STACKTRACE;
 	if (log_len[channel] &lt; log_pos[channel] + size) {tw_error (&quot;Game::_unlog - went past end (%d+%d/%d on %d)&quot;, log_pos[channel], size, log_len[channel], channel);}
 	memcpy(data, log_data[channel]+log_pos[channel], size);
 	log_pos[channel] += size;
@@ -158,7 +160,7 @@
 	return;
 }
 void Log::expand_logs(int num_channels) {
-	STACKTRACE;
+  STACKTRACE;
 	int old_log_num = log_num;
 	if (num_channels &lt;= log_num) { tw_error (&quot;Log::expand_logs - shrinking logs?&quot;); }
 	log_num = num_channels;
@@ -177,12 +179,13 @@
 	return;
 }
 int Log::ready(int channel) {
+  STACKTRACE;
 	if (channel &lt; 0) { tw_error (&quot;log_ready - negative channel!&quot;); }
 	if (channel &gt;= log_num) return 0;
 	return log_len[channel] - log_pos[channel];
 }
 int Log::file_ready(const char *fname, void **location) {
-	STACKTRACE;
+  STACKTRACE;
 	if (log_num &lt;= channel_file_data) return -1;
 	int i = 0, j = 0;
 	while (i &lt; log_len[channel_file_names]) {
@@ -208,6 +211,7 @@
 	return -1;
 }
 void Log::log_file(const char *fname) {
+  STACKTRACE;
 	void *loc;
 	if (!(log_dir[channel_file_data] &amp; direction_read)) {
 		set_config_file(home_ini_full_path(fname).c_str());
@@ -250,7 +254,8 @@
 	return;
 }
 
-void Log::deinit() {STACKTRACE
+void Log::deinit() {
+  STACKTRACE;
 	return;
 }
 
@@ -296,14 +301,17 @@
 }
 
 void Log::flush() {
+  STACKTRACE;
 	return;
 }
 
 bool Log::listen() {
+  STACKTRACE;
 	return false;
 }
 
 void Log::reset() {
+  STACKTRACE;
 	int i;
 	for (i = 0 ; i &lt; this-&gt;log_num; i += 1) {
 		log_pos[i] = 0;
@@ -313,7 +321,8 @@
 
 
 
-void PlaybackLog::init() {STACKTRACE
+void PlaybackLog::init() {
+  STACKTRACE;
 	Log::init();
 	playback = true;
 	default_direction = Log::direction_read;
@@ -329,7 +338,7 @@
 }
 
 void PlaybackLog::set_all_directions( char direction ) {
-	STACKTRACE;
+  STACKTRACE;
 	tw_error(&quot;set_all_directions - your not supposed to do that in a demo playback!&quot;);
 	return;
 }

Modified: branches/multiplayer-branch/source/melee/mmain.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mmain.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/melee/mmain.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -22,7 +22,6 @@
 #include &lt;allegro.h&gt;
 
 #include &quot;melee.h&quot;
-REGISTER_FILE
 #include &quot;scp.h&quot;
 #include &quot;frame.h&quot;
 
@@ -96,7 +95,8 @@
 	return i;
 	}
 
-void NormalGame::init_objects() {STACKTRACE
+void NormalGame::init_objects() {
+  STACKTRACE;
 	int i;
 	add(new Stars());
 	Planet *planet = create_planet();
@@ -107,7 +107,8 @@
 	for (i = 0; i &lt; num_asteroids; i += 1) add(new Asteroid());
 	}
 
-void NormalGame::init_players() {STACKTRACE
+void NormalGame::init_players() {
+  STACKTRACE;
 	switch (log-&gt;type) {
 		case Log::log_normal: {
 			for (int i = 0; true; i += 1) {
@@ -196,6 +197,7 @@
 }
 
 void NormalGame::set_resolution(int screen_x, int screen_y) {
+  STACKTRACE;
 	int view_x, view_y;
 	view_x = screen_x;
 	view_y = screen_y;
@@ -209,6 +211,7 @@
 	}
 
 void NormalGame::preinit() {
+  STACKTRACE;
 	Game::preinit();
 	player_control = NULL;
 	player_name = NULL;
@@ -224,7 +227,8 @@
 	gameEnding = false;
 	gameEndingTime = DefaultEndingTime;
 	}
-void NormalGame::init(Log *_log) {STACKTRACE
+void NormalGame::init(Log *_log) {
+  STACKTRACE;
 	Game::init(_log);
 
 	team_table_size = 0;
@@ -282,7 +286,8 @@
 	}
 
 static int kill_all_delay_counter = 0;
-void NormalGame::calculate() {STACKTRACE
+void NormalGame::calculate() {
+  STACKTRACE;
 	Game::calculate();
 	if (next_choose_new_ships_time &lt;= game_time) {
 		choose_new_ships();
@@ -318,7 +323,8 @@
 	return;
 	}
 
-void NormalGame::ship_died(Ship *who, SpaceLocation *source) {STACKTRACE
+void NormalGame::ship_died(Ship *who, SpaceLocation *source) {
+  STACKTRACE;
 	char victimName[80] = &quot;&quot;;
 	char killerName[80] = &quot;&quot;;
 	int victimID = -1;
@@ -380,7 +386,8 @@
 	return;
 	}
 
-void NormalGame::display_stats() {STACKTRACE
+void NormalGame::display_stats() {
+  STACKTRACE;
 	pause();
 	int i;
 	for (i = 0; i &lt; num_players; i += 1) {
@@ -405,7 +412,7 @@
 }
 bool NormalGame::handle_key(int k)
 {
-	STACKTRACE;
+  STACKTRACE;
 	switch (k &gt;&gt; 8) {
 		default: {
 			return Game::handle_key(k);
@@ -455,180 +462,190 @@
 
 
 
-void NormalGame::choose_new_ships() {STACKTRACE
-	char tmp[40];
-	int i;
-	pause();
-	//message.out(&quot;Selecting ships...&quot;, 1000);
-	int *slot = new int[num_players];
-	//choose ships and send them across network
-	for (i = 0; i &lt; num_players; i += 1) {
-		slot[i] = -2;
-		if (player_control[i]-&gt;ship) {
-			}
-		else {
-//			if (player_panel[i]) player_panel[i]-&gt;window-&gt;hide();
-//			player_panel[i] = NULL;
-			sprintf (tmp, &quot;Player%d&quot;, i+1);
-			Fleet *fleet = player_fleet[i];
-			if (fleet-&gt;getSize() == 0) continue;
-			char buffy[512];
+void NormalGame::choose_new_ships() 
+{
+  STACKTRACE;
+  char tmp[40];
+  int i;
+  pause();
 
-            if (strlen(fleet-&gt;getTitle()) != 0) 
-                sprintf(buffy, &quot;%s\n%s\n&quot;, player_name[i], fleet-&gt;getTitle());
-            else
-                sprintf(buffy, &quot;%s\n&quot;, player_name[i]);
+  int *slot = new int[num_players];
+  //choose ships and send them across network
+  for (i = 0; i &lt; num_players; i += 1) 
+    {
+      slot[i] = -2;
+      if (player_control[i]-&gt;ship) 
+	{
+	}
+      else 
+	{
+	  sprintf (tmp, &quot;Player%d&quot;, i+1);
+	  Fleet *fleet = player_fleet[i];
+	  if (fleet-&gt;getSize() == 0) continue;
+	  char buffy[512];
+	  
+	  if (strlen(fleet-&gt;getTitle()) != 0) 
+	    sprintf(buffy, &quot;%s\n%s\n&quot;, player_name[i], fleet-&gt;getTitle());
+	  else
+	    sprintf(buffy, &quot;%s\n&quot;, player_name[i]);
+	  
+	  slot[i] = player_control[i]-&gt;choose_ship(window, buffy, fleet);
+	  if (player_control[i]-&gt;channel != channel_none) {
+	    slot[i] = intel_ordering(slot[i]);
+	    log-&gt;buffer(player_control[i]-&gt;channel, &amp;slot[i], sizeof(int));
+	    log-&gt;flush();
+	  }
+	}
+    }
+  //recieve the ships that were chosen
+  log-&gt;listen();
+  for (i = 0; i &lt; num_players; i += 1) 
+    {
+      if (slot[i] == -2) continue;
+      if (player_control[i]-&gt;channel != channel_none) 
+	{
+	  log-&gt;unbuffer(player_control[i]-&gt;channel, &amp;slot[i], sizeof(int));
+	  slot[i] = intel_ordering(slot[i]);
+	}
+    }
+  //create the ships that were chosen
+  for (i = 0; i &lt; num_players; i += 1) 
+    {
+      if (slot[i] == -2) continue;
+      sprintf (tmp, &quot;Player%d&quot;, i+1);
 
-			slot[i] = player_control[i]-&gt;choose_ship(window, buffy, fleet);
-			if (player_control[i]-&gt;channel != channel_none) {
-				slot[i] = intel_ordering(slot[i]);
-				log-&gt;buffer(player_control[i]-&gt;channel, &amp;slot[i], sizeof(int));
-				log-&gt;flush();
-				//slot[i] = intel_ordering(slot[i]);
-				}
-			}
-		}
-	//recieve the ships that were chosen
-	log-&gt;listen();
-	for (i = 0; i &lt; num_players; i += 1) {
-		if (slot[i] == -2) continue;
-		if (player_control[i]-&gt;channel != channel_none) {
-			log-&gt;unbuffer(player_control[i]-&gt;channel, &amp;slot[i], sizeof(int));
-			slot[i] = intel_ordering(slot[i]);
-			}
-		}
-	//create the ships that were chosen
-	for (i = 0; i &lt; num_players; i += 1) {
-		if (slot[i] == -2) continue;
-		sprintf (tmp, &quot;Player%d&quot;, i+1);
-		//fleet-&gt;load(&quot;./fleets.tmp&quot;, tmp);
-		Fleet *fleet = player_fleet[i];
-		if (slot[i] == -1) slot[i] = random() % fleet-&gt;getSize();
-		if (slot[i] &lt; 0 || slot[i] &gt;= fleet-&gt;getSize()) {tw_error(&quot;trying to load invalid ship&quot;);}
-		Ship *s = create_ship(fleet-&gt;getShipType(slot[i])-&gt;id, player_control[i], random(size), random(PI2), player_team[i]);
-		if (!s) {tw_error(&quot;unable to create ship&quot;);}
-		fleet-&gt;clear_slot(slot[i]);
-		fleet-&gt;Sort();
-		//fleet-&gt;save(&quot;./fleets.tmp&quot;, tmp);
-		s-&gt;locate();
-		add ( new WedgeIndicator ( s, 30, i+1 ) );
-		ShipPanel *panel = new ShipPanel(s);
-		panel-&gt;window-&gt;init(window);
-		panel-&gt;window-&gt;locate(
-			0, 0.9,
-			0, i * (100.0/480), 
-			0, 0.1,
-			0, (100.0/480)
-			);
-		add(panel);
-		add(s-&gt;get_ship_phaser());
-
-		// add a healthbar for the ship, and also a team indicator.
-		add(new HealthBar(s, &amp;indhealthtoggle));
-		add(new TeamIndicator(s, &amp;indteamtoggle));
-
+      Fleet *fleet = player_fleet[i];
+      if (slot[i] == -1) slot[i] = random() % fleet-&gt;getSize();
+      if (slot[i] &lt; 0 || slot[i] &gt;= fleet-&gt;getSize()) {tw_error(&quot;trying to load invalid ship&quot;);}
+      Ship *s = create_ship(fleet-&gt;getShipType(slot[i])-&gt;id, player_control[i], random(size), random(PI2), player_team[i]);
+      if (!s) {tw_error(&quot;unable to create ship&quot;);}
+      fleet-&gt;clear_slot(slot[i]);
+      fleet-&gt;Sort();
+      
+      s-&gt;locate();
+      add ( new WedgeIndicator ( s, 30, i+1 ) );
+      ShipPanel *panel = new ShipPanel(s);
+      panel-&gt;window-&gt;init(window);
+      panel-&gt;window-&gt;locate(
+			    0, 0.9,
+			    0, i * (100.0/480), 
+			    0, 0.1,
+			    0, (100.0/480)
+			    );
+      add(panel);
+      add(s-&gt;get_ship_phaser());
+      
+      // add a healthbar for the ship, and also a team indicator.
+      add(new HealthBar(s, &amp;indhealthtoggle));
+      add(new TeamIndicator(s, &amp;indteamtoggle));
+      
+      
+      // CHECK FILE SIZES !! to intercept desynch before they happen.
+      int myfsize, otherfsize;
+      
+      myfsize = 0;
+      otherfsize = myfsize;
+      if (player_control[i]-&gt;channel != channel_none) 
+	{
+	  log_int(player_control[i]-&gt;channel, otherfsize);
+	}
+      
+      if (otherfsize != myfsize)
+	{
+	  // the player who loads the ship doesn't get this message, cause his own file is identical by default
+	  tw_error(&quot;DAT files have different size! This may cause a desynch. Press Retry to continue&quot;);
+	}
 		
-		// CHECK FILE SIZES !! to intercept desynch before they happen.
-		int myfsize, otherfsize;
-
-		myfsize = file_size(s-&gt;type-&gt;data-&gt;file);
-		otherfsize = myfsize;
-		if (player_control[i]-&gt;channel != channel_none) {
-			log_int(player_control[i]-&gt;channel, otherfsize);
-		}
-
-		if (otherfsize != myfsize)
-		{
-			// the player who loads the ship doesn't get this message, cause his own file is identical by default
-			tw_error(&quot;DAT files have different size! This may cause a desynch. Press Retry to continue&quot;);
-		}
 		
+    }
+  delete[] slot;
+  //message.out(&quot;Finished selecting ships...&quot;, 1500);
+  unpause();
+  return;
+}
 
-		}
-	delete[] slot;
-	//message.out(&quot;Finished selecting ships...&quot;, 1500);
-	unpause();
-	return;
+bool NormalGame::isGameDone() 
+{
+  STACKTRACE;
+  /*! we'll only check this every now and again, to avoid bogging down the engine.  */  
+  enum { IterationsToSkip = 30 };
+  static long iterationsToSkip = IterationsToSkip;
+  
+  /*! */
+  if (gameEnding) {
+    /*! how long do we wait after a victory before exiting the game? */
+    if (--gameEndingTime &gt; 0)
+      return Game::isGameDone();
+    else {
+      game_done = true;
+    }
+  }
+  
+  if (iterationsToSkip-- &lt;=0 ) {
+    iterationsToSkip = IterationsToSkip;
+    
+    //determine how many teams are still alive
+    unsigned numAliveTeams = 0;
+    TeamCode * teams = (TeamCode*)calloc(MAX_TEAMS, sizeof(TeamCode));
+    
+    for (int i=0; i&lt;num_players; i++) {
+      
+      //check for: 
+      //* does the player have any ships left in her fleet?
+      //* is the player controlling a ship right now?
+      if ( ( player_fleet[i] &amp;&amp; 
+	     player_fleet[i]-&gt;getSize() &gt; 0)
+	   ||
+	   (player_control[i] &amp;&amp;
+	    player_control[i]-&gt;ship)
+	   )
+	{
+	  if (teams[ player_team[i] ] == 0)
+	    numAliveTeams++;
+	  teams[ player_team[i] ]++;
 	}
-
-bool NormalGame::isGameDone() {
-	/*! we'll only check this every now and again, to avoid bogging down the engine.  */  
-	enum { IterationsToSkip = 30 };
-	static long iterationsToSkip = IterationsToSkip;
-	
-	/*! */
-	if (gameEnding) {
-		/*! how long do we wait after a victory before exiting the game? */
-		if (--gameEndingTime &gt; 0)
-			return Game::isGameDone();
-		else {
-			game_done = true;
-		}
-	}
-	
-	if (iterationsToSkip-- &lt;=0 ) {
-		iterationsToSkip = IterationsToSkip;
-		
-	    //determine how many teams are still alive
-	    unsigned numAliveTeams = 0;
-	    TeamCode * teams = (TeamCode*)calloc(MAX_TEAMS, sizeof(TeamCode));
-
-	    for (int i=0; i&lt;num_players; i++) {
-	  	    
-	  	    //check for: 
-	  	    //* does the player have any ships left in her fleet?
-	  	    //* is the player controlling a ship right now?
-	  	    if ( ( player_fleet[i] &amp;&amp; 
-	  	    	   player_fleet[i]-&gt;getSize() &gt; 0)
-	  	    	||
-	  	    	 (player_control[i] &amp;&amp;
-	  	    	  player_control[i]-&gt;ship)
-	  	    	)
-	  	    {
-	  	    	if (teams[ player_team[i] ] == 0)
-	  	    		numAliveTeams++;
-	  	    	teams[ player_team[i] ]++;
-	  	    }
-	    }
-	    
-	    //either there's one team left standing, or none. :)
-	    // either way, the game is over.
-	    //we delay ending the game a few seconds for dramatic effect
-	    if (numAliveTeams &lt;= 1) {
-	    	gameEnding = true;
-	    	if (numAliveTeams==1) {
-	    		for (int i=0; i&lt;num_players; i++) {
-	    			if ( ( player_fleet[i] &amp;&amp; 
-	  	    	   		   player_fleet[i]-&gt;getSize() &gt; 0)
-	  	    			||
-	  	    	 		  (player_control[i] &amp;&amp;
-	  	    	           player_control[i]-&gt;ship) )
-	  	    	    {
-	  	    	    	if (player_control[i]-&gt;isHuman())
-	    					message.print(8000,15,&quot;%s won the match!&quot;, player_name[i]);
-	    				else
-	    					message.print(8000,15,&quot;%s won the match!&quot;, control_name[ player_control[i]-&gt;getControlType() ]);
+    }
+    
+    //either there's one team left standing, or none. :)
+    // either way, the game is over.
+    //we delay ending the game a few seconds for dramatic effect
+    if (numAliveTeams &lt;= 1) {
+      gameEnding = true;
+      if (numAliveTeams==1) {
+	for (int i=0; i&lt;num_players; i++) {
+	  if ( ( player_fleet[i] &amp;&amp; 
+		 player_fleet[i]-&gt;getSize() &gt; 0)
+	       ||
+	       (player_control[i] &amp;&amp;
+		player_control[i]-&gt;ship) )
+	    {
+	      if (player_control[i]-&gt;isHuman())
+		message.print(8000,15,&quot;%s won the match!&quot;, player_name[i]);
+	      else
+		message.print(8000,15,&quot;%s won the match!&quot;, control_name[ player_control[i]-&gt;getControlType() ]);
 	    				break;
-	    			}
-	    		}
-	    	} else {
-	    		message.print(8000,15,&quot;Match ends in a draw!&quot;);
-	    	}
 	    }
-	    free(teams);
 	}
-    return Game::isGameDone();
+      } else {
+	message.print(8000,15,&quot;Match ends in a draw!&quot;);
+      }
+    }
+    free(teams);
+  }
+  return Game::isGameDone();
 }
 
 // this should be places elsewhere I think ...
 TeamIndicator::TeamIndicator(Ship *s, int *atoggle)
 {
+  STACKTRACE;
 	indtoggle = atoggle;
 	mother = s;
 }
 
 void TeamIndicator::calculate()
 {
+  STACKTRACE;
 	if ( !(mother &amp;&amp; mother-&gt;exists()) )
 	{
 		mother = 0;
@@ -638,6 +655,7 @@
 }
 
 void TeamIndicator::animate(Frame *space) {
+  STACKTRACE;
   if (!*indtoggle)
     return;
   
@@ -662,6 +680,7 @@
   
 }
 void NormalGame::showHelpText() {
+  STACKTRACE;
 	const char * file = data_full_path(&quot;ingame.txt&quot;).c_str();
 	char text[10000] = &quot;&quot;;
 	char controlHelp[3000] = &quot;&quot;;

Modified: branches/multiplayer-branch/source/melee/mmath.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mmath.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/melee/mmath.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -17,7 +17,6 @@
 
 
 #include &quot;melee.h&quot;
-REGISTER_FILE
 #include &quot;mview.h&quot;
 
 #include &quot;util/vector2.h&quot;

Modified: branches/multiplayer-branch/source/melee/mnet1.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mnet1.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/melee/mnet1.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -20,11 +20,9 @@
 #include &lt;string.h&gt;
 #include &lt;allegro.h&gt;
 #include &quot;melee.h&quot;
-REGISTER_FILE
 #include &quot;mnet1.h&quot;
 #include &quot;mview.h&quot;
 #include &quot;mcontrol.h&quot;
-//#include &quot;mcbodies.h&quot;
 #include &quot;scp.h&quot;
 
 GameEventMessage::GameEventMessage (const char *text)
@@ -35,7 +33,8 @@
 	size = sizeof(GameEvent) + l;
 	type = Game::event_message;
 }
-void GameEventMessage::execute( int source ) {STACKTRACE
+void GameEventMessage::execute( int source ) {
+  STACKTRACE;
 	char buffy[64+max_message_length];
 	char *tmp = buffy;
 	int c = 15;
@@ -49,7 +48,8 @@
 	::message.out(buffy, 6000, c);
 }
 
-void GameEventChangeLag::execute( int source ) {STACKTRACE
+void GameEventChangeLag::execute( int source ) {
+  STACKTRACE;
 	if (source != Game::channel_server) return;
 	if (old_lag != game-&gt;lag_frames) return;
 	int i;
@@ -113,39 +113,50 @@
 		}
 	}
 
-void NetLog::init() {STACKTRACE
+void NetLog::init() {
+  STACKTRACE;
 	}
-void NetLog::deinit() {STACKTRACE
+void NetLog::deinit() {
+  STACKTRACE;
 	}
 
 NetLog::~NetLog() {STACKTRACE
 	}
 
 void NetLog::send_packet() {
+  STACKTRACE;
 	}
 void NetLog::recv_packet() {
+  STACKTRACE;
 	}
 
 void NetLog::expand_logs(int num_channels) {
+  STACKTRACE;
 	return;
 	}
 
 void NetLog::_log(int channel, const void *data, int size) {
+  STACKTRACE;
 }
 void NetLog::_unlog(int channel, void *data, int size) {
+  STACKTRACE;
 	return;
 	}
 
 void NetLog::log_file(const char *fname) {
+  STACKTRACE;
 }
 
 void NetLog::flush() {
+  STACKTRACE;
 }
 
 bool NetLog::listen() {
+  STACKTRACE;
 return false;
 }
 
 int NetLog::ready(int channel) {
+  STACKTRACE;
 return 0;
 }

Modified: branches/multiplayer-branch/source/melee/moptions.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/moptions.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/melee/moptions.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -25,7 +25,6 @@
 #include &lt;string.h&gt;
 
 #include &quot;melee.h&quot;
-REGISTER_FILE
 
 #include &quot;moptions.h&quot;
 #include &quot;scp.h&quot;
@@ -37,9 +36,9 @@
 #include &quot;util/sound.h&quot;
 
 /*
-
+  
 -	master menu
-		client.ini
+                 client.ini
 -			video mode
 				exit (exit menu)
 				apply (use settings)
@@ -79,356 +78,390 @@
 */
 
 
-void options_menu (Game *game) {STACKTRACE
-	int a;
-	while (true) {
-		a = tw_popup_dialog(NULL, options_dialog, 0);
-		switch (a) {
-			default: 
-			case DIALOG_OPTIONS_DONE: {
-				return;
-				}
-			break;
-			case DIALOG_OPTIONS_VIDEO: {
-				video_menu(game);
-				}
-			break;
-			case DIALOG_OPTIONS_AUDIO: {
-				audio_menu(game);
-				}
-			break;
-			case DIALOG_OPTIONS_CONFIG: {
-				config_menu(game);
-				}
-			break;
-			case DIALOG_OPTIONS_PHYSICS: {
-				physics_menu(game);
-				}
-			break;
-			case DIALOG_OPTIONS_DEFAULT: {
-				}
-			break;
-			}
-		}
-	return;
+/// \brief Show option dialog 
+void options_menu (Game *game) 
+{
+  int a;
+  while (true) 
+    {
+      a = tw_popup_dialog(NULL, options_dialog, 0);
+      switch (a) 
+	{
+	default: 
+	case DIALOG_OPTIONS_DONE: 
+	  {
+	    return;
+	  }
+	  break;
+	case DIALOG_OPTIONS_VIDEO: 
+	  {
+	    video_menu(game);
+	  }
+	  break;
+	case DIALOG_OPTIONS_AUDIO: 
+	  {
+	    audio_menu(game);
+	  }
+	  break;
+	case DIALOG_OPTIONS_CONFIG: 
+	  {
+	    config_menu(game);
+	  }
+	  break;
+	case DIALOG_OPTIONS_PHYSICS: 
+	  {
+	    physics_menu(game);
+	  }
+	  break;
+	case DIALOG_OPTIONS_DEFAULT: 
+	  {
+	  }
+	  break;
 	}
+    }
+  return;
+}
 
-
-bool confirmVideoChanges() {    
-    int choice = -1;
-    while (-1 != (choice = tw_popup_dialog(NULL, confirmVideoDialog, 0))) {        
-        switch (choice) {
-        case DIALOG_CONFIRM_VIDEO_YES:
-            return true;
+/// \brief Show Confirm video changes dialog
+bool confirmVideoChanges() 
+{    
+  int choice = -1;
+  while (-1 != (choice = tw_popup_dialog(NULL, confirmVideoDialog, 0))) 
+    {        
+      switch (choice) 
+	{
+	case DIALOG_CONFIRM_VIDEO_YES:
+	  return true;
         case DIALOG_CONFIRM_VIDEO_NO:
-            return false;
+	  return false;
         }
     }
-    return false;
+  return false;
 }
 
-char *resolution[] = { 
-	&quot;640x480&quot;, &quot;800x600&quot;, &quot;1024x768&quot;, &quot;1280x1024&quot;, &quot;Custom&quot;, NULL
-	};
-char *color_depth[] = { 
-	&quot;8&quot;, &quot;15&quot;, &quot;16&quot;, &quot;24&quot;, &quot;32&quot;, NULL
-	};
+char *resolution[] = 
+  { 
+    &quot;640x480&quot;, &quot;800x600&quot;, &quot;1024x768&quot;, &quot;1280x1024&quot;, &quot;Custom&quot;, NULL
+  };
+char *color_depth[] = 
+  { 
+    &quot;8&quot;, &quot;15&quot;, &quot;16&quot;, &quot;24&quot;, &quot;32&quot;, NULL
+  };
 
-int handleGammaSliderChange(void *dp3, int d2) {
-    set_gamma(d2);
-    return d2;
+/// \brief Set gamma function
+int handleGammaSliderChange(void *dp3, int d2) 
+{
+  set_gamma(d2);
+  return d2;
 }
 
-
-void video_menu (Game *game) {STACKTRACE
-	int choice = -1;
-    bool done = false;
-    
-	while ( (choice != DIALOG_VIDEO_EXIT) &amp;&amp; (!done) ) {
-		sprintf(dialog_string[3], &quot;%dx%d&quot;, videosystem.width, videosystem.height);
-
-
-        //set index for resolution
-        int x=-1, y=-1, x2, y2, i, bpp, bpp2, fs;
-        x2 = videosystem.width;
-        y2 = videosystem.height;
-        for (i = 0; resolution[i+1]; i += 1) {
-            x = strtol(resolution[i], NULL, 10);
-            y = strtol(strchr(resolution[i], 'x') + 1, NULL, 10);
-            if ((x == x2) &amp;&amp; (y == y2)) break;
+/// brief Show video menu dialog
+void video_menu (Game *game) 
+{
+  int choice = -1;
+  bool done = false;
+  
+  while ( (choice != DIALOG_VIDEO_EXIT) &amp;&amp; (!done) ) 
+    {
+      sprintf(dialog_string[3], &quot;%dx%d&quot;, videosystem-&gt;width, videosystem-&gt;height);
+      
+      
+      //set index for resolution
+      int x=-1, y=-1, x2, y2, i, bpp, bpp2, fs;
+      x2 = videosystem-&gt;width;
+      y2 = videosystem-&gt;height;
+      for (i = 0; resolution[i+1]; i += 1) 
+	{
+	  x = strtol(resolution[i], NULL, 10);
+	  y = strtol(strchr(resolution[i], 'x') + 1, NULL, 10);
+	  if ((x == x2) &amp;&amp; (y == y2)) 
+	    break;
         }
-        if(!resolution[0]) { tw_error(&quot;Resolution error&quot;); }
-        	
-        video_dialog[DIALOG_VIDEO_RESLIST].d1 = i;
-        //set index for bpp
-        bpp = videosystem.bpp;
-        for (i = 0; true; i += 1) {
-            if (!color_depth[i]) { tw_error(&quot;video_menu - current bpp invalid?&quot;); }
-            if (strtol(color_depth[i], NULL, 10) == bpp) break;
-        }
-        video_dialog[DIALOG_VIDEO_BPPLIST].d1 = i;
+      if(!resolution[0]) 
+	{ 
+	  tw_error(&quot;Resolution error&quot;); 
+	}
+      
+      video_dialog[DIALOG_VIDEO_RESLIST].d1 = i;
+      //set index for bpp
+      bpp = videosystem-&gt;bpp;
+      for (i = 0; true; i += 1) 
+	{
+	  if (!color_depth[i]) 
+	    { 
+	      tw_error(&quot;video_menu - current bpp invalid?&quot;); 
+	    }
+	  if (strtol(color_depth[i], NULL, 10) == bpp) 
+	    break;
+	}
+      video_dialog[DIALOG_VIDEO_BPPLIST].d1 = i;
         
-        //set button for fullscreen
-        video_dialog[DIALOG_VIDEO_FULLSCREEN].flags = videosystem.fullscreen ? D_SELECTED : 0;
+      //set button for fullscreen
+      video_dialog[DIALOG_VIDEO_FULLSCREEN].flags = videosystem-&gt;fullscreen ? D_SELECTED : 0;
 
-        int startfs = video_dialog[DIALOG_VIDEO_FULLSCREEN].flags;
+      int startfs = video_dialog[DIALOG_VIDEO_FULLSCREEN].flags;
+      
+      
+      //set gamma correction
+      video_dialog[DIALOG_VIDEO_GAMMA_SLIDER].d2 = get_gamma();
 
-        
-        //set gamma correction
-        video_dialog[DIALOG_VIDEO_GAMMA_SLIDER].d2 = get_gamma();
+      //do the dialog
+      choice = tw_popup_dialog(NULL, video_dialog, 0);
+      if (choice == -1) 
+	choice = DIALOG_VIDEO_EXIT;
 
-		//do the dialog
-		choice = tw_popup_dialog(NULL, video_dialog, 0);
-		if (choice == -1) choice = DIALOG_VIDEO_EXIT;
+      //set resolution
+      i = video_dialog[DIALOG_VIDEO_RESLIST].d1;
+      char *tmp = resolution[i];
+      if (!resolution[i+1]) 
+	tmp = dialog_string[3];
+      x2 = strtol(tmp, NULL, 10);
+      y2 = strtol(strchr(tmp, 'x') + 1, NULL, 10);
+      
+      //set bpp from menu
+      i = video_dialog[DIALOG_VIDEO_BPPLIST].d1;
+      bpp2 = strtol(color_depth[i], NULL, 10);
+      
+      //set fullscreen from menu
+      fs = video_dialog[DIALOG_VIDEO_FULLSCREEN].flags &amp; D_SELECTED;
+      
+      switch (choice) 
+	{
+	case DIALOG_VIDEO_GET_DEFAULT:
+	  tw_set_config_file(&quot;client.ini&quot;);
+	  bpp2   = get_config_int(&quot;Video&quot;, &quot;BitsPerPixel&quot;, 16);
+	  x2     = get_config_int(&quot;Video&quot;, &quot;ScreenWidth&quot;, 640);
+	  y2     = get_config_int(&quot;Video&quot;, &quot;ScreenHeight&quot;, 480);
+	  fs     = get_config_int(&quot;Video&quot;, &quot;FullScreen&quot;, false);
+	  set_gamma(get_config_int(&quot;Video&quot;, &quot;Gamma&quot;, 128));
+	  
+	  videosystem-&gt;set_resolution(x2, y2, bpp2, fs);
+	  break;
+	  
+	  
+	case DIALOG_VIDEO_SET_DEFAULT:
+	  if ((bpp2 != bpp) &amp;&amp; game) 
+	    {
+	      tw_alert (&quot;Color depths cannot be changed in\nthe middle of a game\nin this version&quot;, &quot;Okay&quot;);
+	    }
+	  else 
+	    {
+	      done = true;
+	    }
+	  break;
 
-		//set resolution
-		i = video_dialog[DIALOG_VIDEO_RESLIST].d1;
-		char *tmp = resolution[i];
-		if (!resolution[i+1]) tmp = dialog_string[3];
-		x2 = strtol(tmp, NULL, 10);
-		y2 = strtol(strchr(tmp, 'x') + 1, NULL, 10);
-
-		//set bpp from menu
-		i = video_dialog[DIALOG_VIDEO_BPPLIST].d1;
-        bpp2 = strtol(color_depth[i], NULL, 10);
-        
-        //set fullscreen from menu
-        fs = video_dialog[DIALOG_VIDEO_FULLSCREEN].flags &amp; D_SELECTED;
-        
-        switch (choice) {
-            case DIALOG_VIDEO_GET_DEFAULT:
-                tw_set_config_file(&quot;client.ini&quot;);
-                bpp2   = get_config_int(&quot;Video&quot;, &quot;BitsPerPixel&quot;, 16);
-                x2     = get_config_int(&quot;Video&quot;, &quot;ScreenWidth&quot;, 640);
-                y2     = get_config_int(&quot;Video&quot;, &quot;ScreenHeight&quot;, 480);
-                fs     = get_config_int(&quot;Video&quot;, &quot;FullScreen&quot;, false);
-                set_gamma(get_config_int(&quot;Video&quot;, &quot;Gamma&quot;, 128));
-
-                videosystem.set_resolution(x2, y2, bpp2, fs);
-                break;
-            
-           
-             case DIALOG_VIDEO_SET_DEFAULT:
-                 if ((bpp2 != bpp) &amp;&amp; game) {
-                     tw_alert (&quot;Color depths cannot be changed in\nthe middle of a game\nin this version&quot;, &quot;Okay&quot;);
-                 }
-                 else {
-                     done = true;
-                 }
-                 break;
-
-             case DIALOG_VIDEO_BPPLIST:
-             case DIALOG_VIDEO_RESLIST:
-                 break;
-
-             case DIALOG_VIDEO_GAMMA_SLIDER:
-                 set_gamma(video_dialog[DIALOG_VIDEO_GAMMA_SLIDER].d2);
-                 break;
-
-             case DIALOG_VIDEO_EXIT:
-             case -1:
-                 return;
-                 break;
+	case DIALOG_VIDEO_BPPLIST:
+	case DIALOG_VIDEO_RESLIST:
+	  break;
+	  
+	case DIALOG_VIDEO_GAMMA_SLIDER:
+	  set_gamma(video_dialog[DIALOG_VIDEO_GAMMA_SLIDER].d2);
+	  break;
+	  
+	case DIALOG_VIDEO_EXIT:
+	case -1:
+	  return;
+	  break;
         }
-        
-        if ( (x2 != x) ||
-             (y2 != y) ||
-             (bpp != bpp2) ||
-             (startfs != fs) )
+      
+      if ( (x2 != x) ||
+	   (y2 != y) ||
+	   (bpp != bpp2) ||
+	   (startfs != fs) )
         {
-            set_gamma(video_dialog[DIALOG_VIDEO_GAMMA_SLIDER].d2);
-
-            //try to set video mode.  If it does not work, back out, and do not confirm
-            //the changes.
-            if ( ! videosystem.set_resolution(x2, y2, bpp2, fs))  {
-                done = false;
+	  set_gamma(video_dialog[DIALOG_VIDEO_GAMMA_SLIDER].d2);
+	  
+	  //try to set video mode.  If it does not work, back out, and do not confirm
+	  //the changes.
+	  if ( ! videosystem-&gt;set_resolution(x2, y2, bpp2, fs))  
+	    {
+	      done = false;
+	    }
+	  else 
+	    {
+	    //if the video mode was actually set, confirm the changes
+	    if (confirmVideoChanges()) 
+	      {
+		tw_set_config_file(&quot;client.ini&quot;);
+		set_config_int(&quot;Video&quot;, &quot;BitsPerPixel&quot;, bpp2);
+		set_config_int(&quot;Video&quot;, &quot;ScreenWidth&quot;, x2);
+		set_config_int(&quot;Video&quot;, &quot;ScreenHeight&quot;, y2);
+		set_config_int(&quot;Video&quot;, &quot;FullScreen&quot;, fs);
+		set_config_int(&quot;Video&quot;, &quot;Gamma&quot;, get_gamma());
+		return;
+	      }
+	    else 
+	      {
+		tw_set_config_file(&quot;client.ini&quot;);
+		bpp2   = get_config_int(&quot;Video&quot;, &quot;BitsPerPixel&quot;, 16);
+		x2     = get_config_int(&quot;Video&quot;, &quot;ScreenWidth&quot;, 640);
+		y2     = get_config_int(&quot;Video&quot;, &quot;ScreenHeight&quot;, 480);
+		fs     = get_config_int(&quot;Video&quot;, &quot;FullScreen&quot;, false);
+		set_gamma(get_config_int(&quot;Video&quot;, &quot;Gamma&quot;, 128));
+		
+		i = videosystem-&gt;set_resolution(x2, y2, bpp2, fs);
+		done = false;
+	      }
             }
-            else {
-                //if the video mode was actually set, confirm the changes
-                if (confirmVideoChanges()) {
-                    tw_set_config_file(&quot;client.ini&quot;);
-                    set_config_int(&quot;Video&quot;, &quot;BitsPerPixel&quot;, bpp2);
-                    set_config_int(&quot;Video&quot;, &quot;ScreenWidth&quot;, x2);
-                    set_config_int(&quot;Video&quot;, &quot;ScreenHeight&quot;, y2);
-                    set_config_int(&quot;Video&quot;, &quot;FullScreen&quot;, fs);
-                    set_config_int(&quot;Video&quot;, &quot;Gamma&quot;, get_gamma());
-                    return;
-                }
-                else {
-                    tw_set_config_file(&quot;client.ini&quot;);
-                    bpp2   = get_config_int(&quot;Video&quot;, &quot;BitsPerPixel&quot;, 16);
-                    x2     = get_config_int(&quot;Video&quot;, &quot;ScreenWidth&quot;, 640);
-                    y2     = get_config_int(&quot;Video&quot;, &quot;ScreenHeight&quot;, 480);
-                    fs     = get_config_int(&quot;Video&quot;, &quot;FullScreen&quot;, false);
-                    set_gamma(get_config_int(&quot;Video&quot;, &quot;Gamma&quot;, 128));
-                    
-                    i = videosystem.set_resolution(x2, y2, bpp2, fs);
-                    done = false;
-                }
-            }
         }
-        
-	}
-	return;
+      
+    }
+  return;
 }
 
+/// \brief Show audio dialog
 void audio_menu (Game *game) 
 {
   int i;
 
   //set dialog values
-  audio_dialog[DIALOG_AUDIO_SOUND_VOL].d2 = iround(100 * tw_sound.load_sound_volume());
-  audio_dialog[DIALOG_AUDIO_MUSIC_VOL].d2 = iround(100 * tw_sound.load_music_volume());
+  audio_dialog[DIALOG_AUDIO_SOUND_VOL].d2 = iround(100 * tw_sound-&gt;load_sound_volume());
+  audio_dialog[DIALOG_AUDIO_MUSIC_VOL].d2 = iround(100 * tw_sound-&gt;load_music_volume());
 	
   //do the dialog
   i = tw_popup_dialog(NULL, audio_dialog, 0);
   if (i != DIALOG_AUDIO_OK) return;
   
   //set actual values
-  tw_sound.set_sound_volume( audio_dialog[DIALOG_AUDIO_SOUND_VOL].d2/100.0);
-  tw_sound.set_music_volume( audio_dialog[DIALOG_AUDIO_MUSIC_VOL].d2/100.0);
+  tw_sound-&gt;set_sound_volume( audio_dialog[DIALOG_AUDIO_SOUND_VOL].d2/100.0);
+  tw_sound-&gt;set_music_volume( audio_dialog[DIALOG_AUDIO_MUSIC_VOL].d2/100.0);
 };
 
 int handleSoundSliderChange(void *dp3, int d2) 
 {
-  tw_sound.set_sound_volume( audio_dialog[DIALOG_AUDIO_SOUND_VOL].d2/100.0);
+  tw_sound-&gt;set_sound_volume( audio_dialog[DIALOG_AUDIO_SOUND_VOL].d2/100.0);
   return 0;
 }
 
-int handleMusicSliderChange(void *dp3, int d2) {
-  tw_sound.set_music_volume( audio_dialog[DIALOG_AUDIO_MUSIC_VOL].d2/100.0);
+int handleMusicSliderChange(void *dp3, int d2) 
+{
+  tw_sound-&gt;set_music_volume( audio_dialog[DIALOG_AUDIO_MUSIC_VOL].d2/100.0);
   return 0;
 }
 
 
-
-
-
 #include &quot;mview.h&quot;
 #include &quot;mgame.h&quot;
 
 char *viewListboxGetter(int index, int *list_size) 
 {
-	static char tmp[40];
-	tmp[0] = 0;
-	if(index &lt; 0) {
-		*list_size = num_views;
-		return NULL;
-	} else {
-		return(view_name[index]);
-	}
+  static char tmp[40];
+  tmp[0] = 0;
+  if(index &lt; 0) 
+    {
+      *list_size = num_views;
+      return NULL;
+    } 
+  else 
+    {
+      return(view_name[index]);
+    }
 }
 
 
-void change_options() {STACKTRACE
-	int optionsRet, i;
+void change_options() 
+{
+  int optionsRet, i;
 
-	tw_set_config_file(&quot;client.ini&quot;);
-//	old_optionsDialog[OPTIONS_DIALOG_AA].d1 = get_aa_mode();
+  tw_set_config_file(&quot;client.ini&quot;);
 
-	old_optionsDialog[OPTIONS_DIALOG_INTERPOLATION_ON].flags = 
-		interpolate_frames ? D_SELECTED : 0;
-	int aa = get_config_int(&quot;Rendering&quot;, &quot;AA_Mode&quot;, AA_NO_AA);
-	old_optionsDialog[OPTIONS_DIALOG_AA_ON].flags = 
-		(aa&amp;AA_NO_AA) ? 0 : D_SELECTED;
-	old_optionsDialog[OPTIONS_DIALOG_NOALIGN_ON].flags = 
-		(aa&amp;AA_NO_ALIGN) ? D_SELECTED : 0;
-	old_optionsDialog[OPTIONS_DIALOG_BLEND_ON].flags = 
-		(aa&amp;AA_BLEND) ? D_SELECTED : 0;
-	old_optionsDialog[OPTIONS_DIALOG_ALPHA_ON].flags = 
-		(aa&amp;AA_ALPHA) ? D_SELECTED : 0;
+  old_optionsDialog[OPTIONS_DIALOG_INTERPOLATION_ON].flags = 
+    interpolate_frames ? D_SELECTED : 0;
+  int aa = get_config_int(&quot;Rendering&quot;, &quot;AA_Mode&quot;, AA_NO_AA);
+  old_optionsDialog[OPTIONS_DIALOG_AA_ON].flags = 
+    (aa&amp;AA_NO_AA) ? 0 : D_SELECTED;
+  old_optionsDialog[OPTIONS_DIALOG_NOALIGN_ON].flags = 
+    (aa&amp;AA_NO_ALIGN) ? D_SELECTED : 0;
+  old_optionsDialog[OPTIONS_DIALOG_BLEND_ON].flags = 
+    (aa&amp;AA_BLEND) ? D_SELECTED : 0;
+  old_optionsDialog[OPTIONS_DIALOG_ALPHA_ON].flags = 
+    (aa&amp;AA_ALPHA) ? D_SELECTED : 0;
+  
+  
+  tw_set_config_file(&quot;server.ini&quot;);
+  old_optionsDialog[OPTIONS_DIALOG_STARS_SLIDER].d2 = 
+    get_config_int(&quot;Stars&quot;, &quot;Depth&quot;, 192);
+  old_optionsDialog[OPTIONS_DIALOG_RELATIVITY_SLIDER].d2 = 
+    iround(get_config_float(&quot;Game&quot;, &quot;ShotRelativity&quot;, 0.5) * 1000);
+  if (get_config_int(&quot;Game&quot;, &quot;FriendlyFire&quot;, 1)) 
+    old_optionsDialog[OPTIONS_DIALOG_FRIENDLY_FIRE].flags = D_SELECTED;
+  else
+    old_optionsDialog[OPTIONS_DIALOG_FRIENDLY_FIRE].flags = 0;
+  
+  if (get_config_int(&quot;View&quot;, &quot;CameraHidesCloakers&quot;, 1)) 
+    old_optionsDialog[OPTIONS_DIALOG_HIDE_CLOAKERS].flags = D_SELECTED;
+  else
+    old_optionsDialog[OPTIONS_DIALOG_HIDE_CLOAKERS].flags = 0;
+  
+  tw_set_config_file(&quot;client.ini&quot;);
+  
+  if (get_config_int(&quot;Planet&quot;, &quot;PlanetDimension&quot;, 2) == 3) 
+    old_optionsDialog[OPTIONS_DIALOG_3DPLANET].flags = D_SELECTED;
+  else
+    old_optionsDialog[OPTIONS_DIALOG_3DPLANET].flags = 0;
+  
+  i = get_view_num ( get_config_string ( &quot;View&quot;, &quot;View&quot;, NULL ) );
+  if (i == -1) i = 0;
+  old_optionsDialog[OPTIONS_DIALOG_VIEW].d1 = i;
+  
+  
+  optionsRet = tw_popup_dialog(NULL, old_optionsDialog, OPTIONS_DIALOG_OK);
+  
+  if (optionsRet == OPTIONS_DIALOG_CANCEL) return;
+  
+  tw_set_config_file(&quot;client.ini&quot;);
+  interpolate_frames = 
+    (old_optionsDialog[OPTIONS_DIALOG_INTERPOLATION_ON].flags &amp; D_SELECTED) ? 1 : 0;
+  set_config_int(&quot;View&quot;, &quot;InterpolateFrames&quot;, interpolate_frames);
+  aa&amp;=~AA_NO_AA;aa|= (old_optionsDialog[OPTIONS_DIALOG_AA_ON].flags) ? 
+		  0 : AA_NO_AA;
+  aa&amp;=~AA_NO_ALIGN;aa|= (old_optionsDialog[OPTIONS_DIALOG_NOALIGN_ON].flags) ? 
+		     AA_NO_ALIGN : 0;
+  aa&amp;=~AA_BLEND;aa|= (old_optionsDialog[OPTIONS_DIALOG_BLEND_ON].flags) ? 
+		  AA_BLEND : 0;
+  aa&amp;=~AA_ALPHA;aa|= (old_optionsDialog[OPTIONS_DIALOG_ALPHA_ON].flags) ? 
+		  AA_ALPHA : 0;
+  set_config_int(&quot;Rendering&quot;, &quot;AA_Mode&quot;, aa);
+  set_tw_aa_mode(aa);
+    
+  View *v = get_view(
+		     view_name[old_optionsDialog[OPTIONS_DIALOG_VIEW].d1],
+		     NULL
+		     );
+  set_view(v);
+  twconfig_set_string(&quot;/cfg/client.ini/view/view&quot;, 
+		      view_name[old_optionsDialog[OPTIONS_DIALOG_VIEW].d1]);
+  if (game &amp;&amp; !game-&gt;view_locked) game-&gt;change_view(
+						    view_name[old_optionsDialog[OPTIONS_DIALOG_VIEW].d1]);
+  
+  
+  twconfig_set_int(&quot;/cfg/server.ini/stars/depth&quot;, 
+		   old_optionsDialog[OPTIONS_DIALOG_STARS_SLIDER].d2);
+  
+  twconfig_set_float(&quot;/cfg/server.ini/game/shotrelativity&quot;, 
+		     old_optionsDialog[OPTIONS_DIALOG_RELATIVITY_SLIDER].d2 / 1000.0);
+  
+  
+  if (old_optionsDialog[OPTIONS_DIALOG_FRIENDLY_FIRE].flags &amp; D_SELECTED) 
+    i = 1;
+  else i = 0;
+  twconfig_set_int(&quot;/cfg/server.ini/game/friendlyfire&quot;, i);
+  
+  if (old_optionsDialog[OPTIONS_DIALOG_HIDE_CLOAKERS].flags &amp; D_SELECTED) 
+    i = 1;
+  else i = 0;
+  twconfig_set_int(&quot;/cfg/server.ini/view/camerahidescloakers&quot;, i);
+  
+  return;
+}
 
+void config_menu (Game *game) 
+{
+  change_options();
+};
 
-	tw_set_config_file(&quot;server.ini&quot;);
-	old_optionsDialog[OPTIONS_DIALOG_STARS_SLIDER].d2 = 
-		get_config_int(&quot;Stars&quot;, &quot;Depth&quot;, 192);
-	old_optionsDialog[OPTIONS_DIALOG_RELATIVITY_SLIDER].d2 = 
-		iround(get_config_float(&quot;Game&quot;, &quot;ShotRelativity&quot;, 0.5) * 1000);
-	if (get_config_int(&quot;Game&quot;, &quot;FriendlyFire&quot;, 1)) 
-		old_optionsDialog[OPTIONS_DIALOG_FRIENDLY_FIRE].flags = D_SELECTED;
-	else
-		old_optionsDialog[OPTIONS_DIALOG_FRIENDLY_FIRE].flags = 0;
+void physics_menu (Game *game) 
+{
+};
 
-	if (get_config_int(&quot;View&quot;, &quot;CameraHidesCloakers&quot;, 1)) 
-		old_optionsDialog[OPTIONS_DIALOG_HIDE_CLOAKERS].flags = D_SELECTED;
-	else
-		old_optionsDialog[OPTIONS_DIALOG_HIDE_CLOAKERS].flags = 0;
 
-	tw_set_config_file(&quot;client.ini&quot;);
-
-	if (get_config_int(&quot;Planet&quot;, &quot;PlanetDimension&quot;, 2) == 3) 
-		old_optionsDialog[OPTIONS_DIALOG_3DPLANET].flags = D_SELECTED;
-	else
-		old_optionsDialog[OPTIONS_DIALOG_3DPLANET].flags = 0;
-
-	i = get_view_num ( get_config_string ( &quot;View&quot;, &quot;View&quot;, NULL ) );
-	if (i == -1) i = 0;
-	old_optionsDialog[OPTIONS_DIALOG_VIEW].d1 = i;
-
- 
-	optionsRet = tw_popup_dialog(NULL, old_optionsDialog, OPTIONS_DIALOG_OK);
-
-	if (optionsRet == OPTIONS_DIALOG_CANCEL) return;
-
-//	set_aa_mode(old_optionsDialog[OPTIONS_DIALOG_AA].d1);
-
-	tw_set_config_file(&quot;client.ini&quot;);
-//	set_config_int(&quot;View&quot;, &quot;Anti-Aliasing&quot;, get_aa_mode());
-	interpolate_frames = 
-		(old_optionsDialog[OPTIONS_DIALOG_INTERPOLATION_ON].flags &amp; D_SELECTED) ? 1 : 0;
-	set_config_int(&quot;View&quot;, &quot;InterpolateFrames&quot;, interpolate_frames);
-	aa&amp;=~AA_NO_AA;aa|= (old_optionsDialog[OPTIONS_DIALOG_AA_ON].flags) ? 
-		0 : AA_NO_AA;
-	aa&amp;=~AA_NO_ALIGN;aa|= (old_optionsDialog[OPTIONS_DIALOG_NOALIGN_ON].flags) ? 
-		AA_NO_ALIGN : 0;
-	aa&amp;=~AA_BLEND;aa|= (old_optionsDialog[OPTIONS_DIALOG_BLEND_ON].flags) ? 
-		AA_BLEND : 0;
-	aa&amp;=~AA_ALPHA;aa|= (old_optionsDialog[OPTIONS_DIALOG_ALPHA_ON].flags) ? 
-		AA_ALPHA : 0;
-	set_config_int(&quot;Rendering&quot;, &quot;AA_Mode&quot;, aa);
-	set_tw_aa_mode(aa);
-
-	if (old_optionsDialog[OPTIONS_DIALOG_3DPLANET].flags == D_SELECTED)
-		i = 3;
-	else
-		i = 2;
-	set_config_int(&quot;Planet&quot;, &quot;PlanetDimension&quot;, i);
-
-	View *v = get_view(
-		view_name[old_optionsDialog[OPTIONS_DIALOG_VIEW].d1],
-		NULL
-		);
-	set_view(v);
-	twconfig_set_string(&quot;/cfg/client.ini/view/view&quot;, 
-		view_name[old_optionsDialog[OPTIONS_DIALOG_VIEW].d1]);
-	if (game &amp;&amp; !game-&gt;view_locked) game-&gt;change_view(
-		view_name[old_optionsDialog[OPTIONS_DIALOG_VIEW].d1]);
-
-
-	twconfig_set_int(&quot;/cfg/server.ini/stars/depth&quot;, 
-		old_optionsDialog[OPTIONS_DIALOG_STARS_SLIDER].d2);
-
-	twconfig_set_float(&quot;/cfg/server.ini/game/shotrelativity&quot;, 
-		old_optionsDialog[OPTIONS_DIALOG_RELATIVITY_SLIDER].d2 / 1000.0);
-
-
-	if (old_optionsDialog[OPTIONS_DIALOG_FRIENDLY_FIRE].flags &amp; D_SELECTED) 
-		i = 1;
-	else i = 0;
-	twconfig_set_int(&quot;/cfg/server.ini/game/friendlyfire&quot;, i);
-
-	if (old_optionsDialog[OPTIONS_DIALOG_HIDE_CLOAKERS].flags &amp; D_SELECTED) 
-		i = 1;
-	else i = 0;
-	twconfig_set_int(&quot;/cfg/server.ini/view/camerahidescloakers&quot;, i);
-
-	return;
-	}
-
-void config_menu (Game *game) {STACKTRACE
-	change_options();
-	};
-void physics_menu (Game *game) {STACKTRACE
-	};
-
-

Modified: branches/multiplayer-branch/source/melee/mship.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mship.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/melee/mship.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,7 +1,7 @@
 /* $Id: mship.cpp,v 1.2 2004/08/08 17:36:06 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -15,13 +15,13 @@
 GNU General Public License for more details.
 */
 
+#include &quot;util/sound.h&quot;
 
 #include &lt;allegro.h&gt;
 #include &lt;string.h&gt;
 #include &lt;stdio.h&gt;
 
 #include &quot;melee.h&quot;
-REGISTER_FILE
 #include &quot;id.h&quot;
 #include &quot;frame.h&quot;
 
@@ -43,36 +43,41 @@
 ShipClass *shipclasses = NULL;
 
 void register_shipclass (
-	const char *name, 
-	const char *source_name, 
-	Ship *(*func)(Vector2 pos, double a, ShipData *data, unsigned int code)
-) 
+			 const char *name, 
+			 const char *source_name, 
+			 Ship *(*func)(Vector2 pos, double a, ShipData *data, unsigned int code)
+			 ) 
 {
-	num_shipclasses += 1;
-	shipclasses = (ShipClass*)realloc(shipclasses, num_shipclasses * sizeof(ShipClass));
-	int i = num_shipclasses-1;
-	shipclasses[i].link_order = i;
-	shipclasses[i].name = name;
-	shipclasses[i].source = source_name;
-	shipclasses[i]._get_ship = func;
-	return;
+  num_shipclasses += 1;
+  shipclasses = (ShipClass*)realloc(shipclasses, num_shipclasses * sizeof(ShipClass));
+  int i = num_shipclasses-1;
+  shipclasses[i].link_order = i;
+  shipclasses[i].name = name;
+  shipclasses[i].source = source_name;
+  shipclasses[i]._get_ship = func;
+  return;
 }
 
 Ship *ShipClass::get_ship(Vector2 pos, double angle, ShipData *dat, unsigned int team) {
-	dat-&gt;lock();
-	Ship *s = _get_ship(pos, angle, dat, team);
-	dat-&gt;unlock();
-	s-&gt;code = this;
-	return s;
+  STACKTRACE;
+  dat-&gt;lock();
+  Ship *s = _get_ship(pos, angle, dat, team);
+  dat-&gt;unlock();
+  s-&gt;code = this;
+  return s;
 }
 
-ShipClass *shipclass ( const char *name ) {
-	int i;
-	if (!name) return NULL;
-	for (i = 0; i &lt; num_shipclasses; i += 1) {
-		if (!strcmp(shipclasses[i].name, name)) return &amp;shipclasses[i];
-	}
-	return NULL;
+ShipClass *shipclass ( const char *name ) 
+{
+  int i;
+  if (!name) 
+    return NULL;
+  for (i = 0; i &lt; num_shipclasses; i += 1) 
+    {
+      if (!strcmp(shipclasses[i].name, name)) 
+	return &amp;shipclasses[i];
+    }
+  return NULL;
 }
 
 
@@ -85,33 +90,41 @@
 ShipType *shiptypes = NULL;
 
 
-Ship *ShipType::get_ship(Vector2 pos, double angle, unsigned int team) {
-	game-&gt;log_file(file);
-	Ship *s = code-&gt;get_ship(pos, angle, data, team);
-	s-&gt;type = this;
-	return s;
+Ship *ShipType::get_ship(Vector2 pos, double angle, unsigned int team) 
+{
+  STACKTRACE;
+  game-&gt;log_file(file);
+  Ship *s = code-&gt;get_ship(pos, angle, data, team);
+  s-&gt;type = this;
+  return s;
 }
 
-ShipType *shiptype(const char *shiptype_id) {
-	int i;
-	for (i = 0; i &lt; num_shiptypes; i += 1) {
-		if (!strcmp(shiptype_id, shiptypes[i].id)) {
-			return &amp;shiptypes[i];
-		}
+ShipType *shiptype(const char *shiptype_id) 
+{
+  int i;
+  for (i = 0; i &lt; num_shiptypes; i += 1) 
+    {
+      if (!strcmp(shiptype_id, shiptypes[i].id)) 
+	{
+	  return &amp;shiptypes[i];
 	}
-	return NULL;
+    }
+  return NULL;
 }
 
-const char *old_code_name( const char *file ) {
-	char buffy[2048];
-	if (strlen(file) != 18) return NULL;
-	strncpy(buffy, file+9, 5);
-	buffy[5] = 0;
-	int i;
-	for (i = 0; i &lt; num_shipclasses; i += 1) {
-		if (strstr(shipclasses[i].source, buffy)) return shipclasses[i].name;
-	}
-	return NULL;
+const char *old_code_name( const char *file ) 
+{
+  char buffy[2048];
+  if (strlen(file) != 18) 
+    return NULL;
+  strncpy(buffy, file+9, 5);
+  buffy[5] = 0;
+  int i;
+  for (i = 0; i &lt; num_shipclasses; i += 1) 
+    {
+      if (strstr(shipclasses[i].source, buffy)) return shipclasses[i].name;
+    }
+  return NULL;
 }
 
 static void register_shiptype ( const char *file ) 
@@ -127,7 +140,8 @@
   char buffy[1024];
   strncpy(buffy, file, 1000);
   char *tmp = strrchr(buffy, '.');
-  if (!tmp || (tmp - buffy &lt; 5)) tw_error(&quot;bad ship file name (%s)&quot;, file);
+  if (!tmp || (tmp - buffy &lt; 5)) 
+    tw_error(&quot;bad ship file name (%s)&quot;, file);
   *tmp = 0;
   shiptypes[i].id = strdup(tmp - 5);
   
@@ -145,37 +159,36 @@
   
 
   const char *name = get_config_string(&quot;Info&quot;, &quot;Name&quot;, NULL);
-  if (!name) {
-    const char *tmp;
-    int l = 0;
-    tmp = get_config_string(&quot;Info&quot;, &quot;Name0&quot;, NULL);
-    if (tmp) {
-      l += sprintf(buffy + l, &quot;%s &quot;, tmp);
+  if (!name) 
+    {
+      const char *tmp;
+      int l = 0;
+      tmp = get_config_string(&quot;Info&quot;, &quot;Name0&quot;, NULL);
+      if (tmp) 
+	{
+	  l += sprintf(buffy + l, &quot;%s &quot;, tmp);
+	}
+      tmp = get_config_string(&quot;Info&quot;, &quot;Name1&quot;, NULL);
+      if (!tmp)
+	tw_error(&quot;init_ships - error initializing name (%s)&quot;, file);
+      l += sprintf(buffy + l, &quot;%s&quot;, tmp);
+      int n = 1;
+      while (true) 
+	{
+	  char buf[25];
+	  n += 1;
+	  sprintf(buf, &quot;Name%d&quot;, n);
+	  tmp = get_config_string(&quot;Info&quot;, buf, NULL);
+	  if (!tmp) 
+	    break;
+	  l += sprintf(buffy + l, &quot; %s&quot;, tmp);
+	}
+      name = buffy;
     }
-    tmp = get_config_string(&quot;Info&quot;, &quot;Name1&quot;, NULL);
-    if (!tmp)
-      tw_error(&quot;init_ships - error initializing name (%s)&quot;, file);
-    l += sprintf(buffy + l, &quot;%s&quot;, tmp);
-    int n = 1;
-    while (true) {
-      char buf[25];
-      n += 1;
-      sprintf(buf, &quot;Name%d&quot;, n);
-      tmp = get_config_string(&quot;Info&quot;, buf, NULL);
-      if (!tmp) break;
-      l += sprintf(buffy + l, &quot; %s&quot;, tmp);
-    }
-    name = buffy;
-  }
   shiptypes[i].name = strdup(name);
   shiptypes[i].cost = get_config_int(&quot;Info&quot;, &quot;TWCost&quot;, 0);
-  const char *data = get_config_string(&quot;Info&quot;, &quot;Data&quot;, NULL);
-  if (!data) {
-    replace_extension(buffy, ini_path.c_str(), &quot;dat&quot;, 2040);
-    shiptypes[i].data = shipdata(data_full_path(buffy).c_str());
-  }
-  else 
-    shiptypes[i].data = shipdata(data);
+  shiptypes[i].data = shipdata( ini_path );
+  
   const char *text = get_config_string(&quot;Info&quot;, &quot;Description&quot;, NULL);
   if (!text) 
     {
@@ -189,19 +202,20 @@
   shiptypes[i].code = shipclass(code);
   if (!shiptypes[i].data || !shiptypes[i].code) 
     {
-      if (!data) data = &quot;none&quot;;
-      if (!code) code = &quot;none&quot;;
+      if (!code) 
+	code = &quot;none&quot;;
       char buffy[2048];
       char *tmp = buffy;
       tmp += sprintf(tmp, &quot;Ship registration failed\n%s (%s)\n&quot;,
 		     shiptypes[i].name, shiptypes[i].file);
-      if (!shiptypes[i].data) tmp += sprintf(tmp, &quot;Data not found (%s)\n&quot;, data);
-      if (!shiptypes[i].code) tmp += sprintf(tmp, &quot;Code not found (%s)\n&quot;, code);
-      error(&quot;%s&quot;, buffy);
+      if (!shiptypes[i].code) 
+	tmp += sprintf(tmp, &quot;Code not found (%s)\n&quot;, code);
+      tw_error(buffy);
       num_shiptypes -= 1;
       return;
     }
-  if (old) set_config_string(&quot;Info&quot;, &quot;Code&quot;, code);
+  if (old) 
+    set_config_string(&quot;Info&quot;, &quot;Code&quot;, code);
   
   return;
   
@@ -243,499 +257,556 @@
 	update_panel(false),
 	target_pressed(false),
 	control(NULL)
-{STACKTRACE
-	attributes |= ATTRIB_SHIP;
-	layer = LAYER_SHIPS;
-	set_depth(DEPTH_SHIPS);
-	collide_flag_sameteam = ALL_LAYERS;
-	collide_flag_sameship = ALL_LAYERS;
-	nextkeys = 0;
-	id = SPACE_SHIP;
+{
+  STACKTRACE;
+  attributes |= ATTRIB_SHIP;
+  layer = LAYER_SHIPS;
+  set_depth(DEPTH_SHIPS);
+  collide_flag_sameteam = ALL_LAYERS;
+  collide_flag_sameship = ALL_LAYERS;
+  nextkeys = 0;
+  id = SPACE_SHIP;
+	
+  type = NULL;
+  code = NULL;
 
-	type = NULL;
-	code = NULL;
-
-	// modified otherwise the kat poly crashes
-	if (creator-&gt;isShip())
-		type = ((Ship*) creator)-&gt;type;
-
-	captain_name[0] = '\0';
-	thrust           = FALSE;
-	turn_left        = FALSE;
-	turn_right       = FALSE;
-	thrust_backwards = FALSE;
-	fire_weapon      = FALSE;
-	fire_special     = FALSE;
-	fire_altweapon   = FALSE;
-
-	spritePanel = NULL;
-
-	turn_step = 0;
-	angle = floor(oangle / (PI2/64)) * (PI2/64);
-	sprite_index = get_index(angle);
-
-	hashotspots = true;
+  // modified otherwise the kat poly crashes
+  if (creator-&gt;isShip())
+    type = ((Ship*) creator)-&gt;type;
+  
+  captain_name[0] = '\0';
+  thrust           = FALSE;
+  turn_left        = FALSE;
+  turn_right       = FALSE;
+  thrust_backwards = FALSE;
+  fire_weapon      = FALSE;
+  fire_special     = FALSE;
+  fire_altweapon   = FALSE;
+  
+  spritePanel = NULL;
+  
+  turn_step = 0;
+  angle = floor(oangle / (PI2/64)) * (PI2/64);
+  sprite_index = get_index(angle);
+  
+  hashotspots = true;
 }
 
 Ship::Ship(Vector2 opos, double shipAngle, ShipData *shipData, unsigned int ally_flag) :
-	SpaceObject(NULL, opos, shipAngle, shipData-&gt;spriteShip),
-	death_counter(-1),
-	update_panel(false),
-	target_pressed(false),
-	control(NULL)
-{STACKTRACE
-	shipData-&gt;lock();
-	attributes |= ATTRIB_SHIP;
-	layer = LAYER_SHIPS;
-	set_depth(DEPTH_SHIPS);
+  SpaceObject(NULL, opos, shipAngle, shipData-&gt;spriteShip),
+  death_counter(-1),
+  update_panel(false),
+  target_pressed(false),
+  control(NULL)
+{
+  STACKTRACE;
+  shipData-&gt;lock();
+  attributes |= ATTRIB_SHIP;
+  layer = LAYER_SHIPS;
+  set_depth(DEPTH_SHIPS);
 
-	type = NULL;
-	code = NULL;
+  type = NULL;
+  code = NULL;
+	
+  captain_name[0] = '\0';
+  ship = this;
+  data = shipData;
+  this-&gt;ally_flag = ally_flag;
 
-	captain_name[0] = '\0';
-	ship = this;
-	data = shipData;
-	this-&gt;ally_flag = ally_flag;
+  collide_flag_sameteam = ALL_LAYERS;
+  collide_flag_sameship = ALL_LAYERS;
+  nextkeys = 0;
 
-	collide_flag_sameteam = ALL_LAYERS;
-	collide_flag_sameship = ALL_LAYERS;
-	nextkeys = 0;
+  id = SPACE_SHIP;
+  
+  int i;
+  i = get_config_int(&quot;Names&quot;, &quot;NumNames&quot;, 0);
+  int L = sizeof(captain_name);
+  if (i) {
+    char buffy[16];
+    sprintf(buffy, &quot;CaptName%d&quot;, 1+(rand() % i));
+    const char *tmp = get_config_string(&quot;Names&quot;, buffy, &quot;&quot;);
+    i = strlen(tmp);
+    strncpy(captain_name, tmp, L);
+    if (i &gt;= L) i = L-1;
+    captain_name[i] = '\0';
+  }
+  else captain_name[0] = '\0';
+  
+  crew     = get_config_int(&quot;Ship&quot;, &quot;Crew&quot;, 0);
+  crew_max = get_config_int(&quot;Ship&quot;, &quot;CrewMax&quot;, 0);
+  batt     = get_config_int(&quot;Ship&quot;, &quot;Batt&quot;, 0);
+  batt_max = get_config_int(&quot;Ship&quot;, &quot;BattMax&quot;, 0);
+  
+  recharge_amount  = get_config_int(&quot;Ship&quot;, &quot;RechargeAmount&quot;, 0);
+  recharge_rate    = scale_frames(get_config_float(&quot;Ship&quot;, &quot;RechargeRate&quot;, 0));
+  recharge_step    = recharge_rate;
+  weapon_drain     = get_config_int(&quot;Ship&quot;, &quot;WeaponDrain&quot;, 0);
+  weapon_rate      = scale_frames(get_config_float(&quot;Ship&quot;, &quot;WeaponRate&quot;, 0));
+  weapon_sample    = 0;
+  weapon_recharge  = 0;
+  weapon_low       = FALSE;
+  special_drain    = get_config_int(&quot;Ship&quot;, &quot;SpecialDrain&quot;, 0);
+  special_rate     = scale_frames(get_config_float(&quot;Ship&quot;, &quot;SpecialRate&quot;, 0));
+  special_sample   = 0;
+  special_recharge = 0;
+  special_low      = FALSE;
 
-	id = SPACE_SHIP;
-
-	int i;
-	i = get_config_int(&quot;Names&quot;, &quot;NumNames&quot;, 0);
-	int L = sizeof(captain_name);
-	if (i) {
-		char buffy[16];
-		sprintf(buffy, &quot;CaptName%d&quot;, 1+(rand() % i));
-		const char *tmp = get_config_string(&quot;Names&quot;, buffy, &quot;&quot;);
-		i = strlen(tmp);
-		strncpy(captain_name, tmp, L);
-		if (i &gt;= L) i = L-1;
-		captain_name[i] = '\0';
-	}
-	else captain_name[0] = '\0';
-
-	crew     = get_config_int(&quot;Ship&quot;, &quot;Crew&quot;, 0);
-	crew_max = get_config_int(&quot;Ship&quot;, &quot;CrewMax&quot;, 0);
-	batt     = get_config_int(&quot;Ship&quot;, &quot;Batt&quot;, 0);
-	batt_max = get_config_int(&quot;Ship&quot;, &quot;BattMax&quot;, 0);
-
-	recharge_amount  = get_config_int(&quot;Ship&quot;, &quot;RechargeAmount&quot;, 0);
-	recharge_rate    = scale_frames(get_config_float(&quot;Ship&quot;, &quot;RechargeRate&quot;, 0));
-	recharge_step    = recharge_rate;
-	weapon_drain     = get_config_int(&quot;Ship&quot;, &quot;WeaponDrain&quot;, 0);
-	weapon_rate      = scale_frames(get_config_float(&quot;Ship&quot;, &quot;WeaponRate&quot;, 0));
-	weapon_sample    = 0;
-	weapon_recharge  = 0;
-	weapon_low       = FALSE;
-	special_drain    = get_config_int(&quot;Ship&quot;, &quot;SpecialDrain&quot;, 0);
-	special_rate     = scale_frames(get_config_float(&quot;Ship&quot;, &quot;SpecialRate&quot;, 0));
-	special_sample   = 0;
-	special_recharge = 0;
-	special_low      = FALSE;
-
-	double raw_hotspot_rate = get_config_float(&quot;Ship&quot;, &quot;HotspotRate&quot;, 0);
-	hotspot_rate  = scale_frames(raw_hotspot_rate);
-	hotspot_frame = 0;
-	turn_rate     = scale_turning(get_config_float(&quot;Ship&quot;, &quot;TurnRate&quot;, 0));
-	turn_step     = 0.0;
-	speed_max     = scale_velocity(get_config_float(&quot;Ship&quot;, &quot;SpeedMax&quot;, 0));
-	accel_rate    = scale_acceleration(get_config_float(&quot;Ship&quot;, &quot;AccelRate&quot;, 0), raw_hotspot_rate);
-	mass          = (get_config_float(&quot;Ship&quot;, &quot;Mass&quot;, 0));
-
-	thrust           = FALSE;
-	turn_left        = FALSE;
-	turn_right       = FALSE;
-	thrust_backwards = FALSE;
-	fire_weapon      = FALSE;
-	fire_special     = FALSE;
-	fire_altweapon   = FALSE;
-
-	spritePanel  = new SpaceSprite(*(data-&gt;spritePanel));
-	if (captain_name[0]) {
-		spritePanel-&gt;lock();
-		text_mode(-1);
-		textprintf_centre(
+  double raw_hotspot_rate = get_config_float(&quot;Ship&quot;, &quot;HotspotRate&quot;, 0);
+  hotspot_rate  = scale_frames(raw_hotspot_rate);
+  hotspot_frame = 0;
+  turn_rate     = scale_turning(get_config_float(&quot;Ship&quot;, &quot;TurnRate&quot;, 0));
+  turn_step     = 0.0;
+  speed_max     = scale_velocity(get_config_float(&quot;Ship&quot;, &quot;SpeedMax&quot;, 0));
+  accel_rate    = scale_acceleration(get_config_float(&quot;Ship&quot;, &quot;AccelRate&quot;, 0), raw_hotspot_rate);
+  mass          = (get_config_float(&quot;Ship&quot;, &quot;Mass&quot;, 0));
+  
+  thrust           = FALSE;
+  turn_left        = FALSE;
+  turn_right       = FALSE;
+  thrust_backwards = FALSE;
+  fire_weapon      = FALSE;
+  fire_special     = FALSE;
+  fire_altweapon   = FALSE;
+  
+  spritePanel  = new SpaceSprite(*(data-&gt;spritePanel));
+  if (captain_name[0]) 
+    {
+      spritePanel-&gt;lock();
+      text_mode(-1);
+      textprintf_centre(
 			spritePanel-&gt;get_bitmap(0), 
-			videosystem.get_font(1), 
+			videosystem-&gt;get_font(1), 
 			30, 51, 
 			pallete_color[0], 
 			captain_name
 		);
-		spritePanel-&gt;unlock();
-	}
+      spritePanel-&gt;unlock();
+    }
+  
+  angle = floor(shipAngle / (PI2/64)) * (PI2/64);
+  sprite_index = get_index(angle);
 
-	angle = floor(shipAngle / (PI2/64)) * (PI2/64);
-	sprite_index = get_index(angle);
-
-	hashotspots = true;
+  hashotspots = true;
 }
 
-void Ship::death() {STACKTRACE
-	if (attributes &amp; ATTRIB_NOTIFY_ON_DEATH) {
-		game-&gt;ship_died(this, NULL);
-		attributes &amp;= ~ATTRIB_NOTIFY_ON_DEATH;
-	}
-	return;
+void Ship::death() 
+{
+  STACKTRACE;
+  if (attributes &amp; ATTRIB_NOTIFY_ON_DEATH) 
+    {
+      game-&gt;ship_died(this, NULL);
+      attributes &amp;= ~ATTRIB_NOTIFY_ON_DEATH;
+    }
+  return;
 }
 
-Ship::~Ship() {STACKTRACE
-	delete spritePanel;
+Ship::~Ship() 
+{
+  delete spritePanel;
 }
 
 double Ship::getCrew()
 {
+  STACKTRACE;
   return(crew);
 }
 
 double Ship::getBatt()
 {
+  STACKTRACE;
   return(batt);
 }
 
 RGB Ship::crewPanelColor(int k)
 {
+  STACKTRACE;
 	RGB c = {0,225,0};
 	return c;
 }
 
 RGB Ship::battPanelColor(int k)
 {
-	RGB c = {225,0,0};
-	return c;
+  STACKTRACE;
+  RGB c = {225,0,0};
+  return c;
 }
 
-void Ship::locate() {STACKTRACE
-	int tries = 0;
-	double mindist = 1000;
-	while (tries &lt; 15) {
-		pos = random(map_size);
-		SpaceLocation *spacePlanet = nearest_planet();
-		if (!spacePlanet || (distance(spacePlanet) &gt; mindist))
-			break;
-		if (tries &lt; 10)
-			mindist *= 0.9;
-		else
-			mindist *= 0.5;
-	}
-	return;
+void Ship::locate() 
+{
+  STACKTRACE;
+  int tries = 0;
+  double mindist = 1000;
+  while (tries &lt; 15) {
+    pos = random(map_size);
+    SpaceLocation *spacePlanet = nearest_planet();
+    if (!spacePlanet || (distance(spacePlanet) &gt; mindist))
+      break;
+    if (tries &lt; 10)
+      mindist *= 0.9;
+    else
+      mindist *= 0.5;
+  }
+  return;
 }
 
 void Ship::calculate()
-{STACKTRACE
+{
+  STACKTRACE;
+  
+  //added by Tau - start
+  if (exists() &amp;&amp; death_counter &gt;= 0) 
+    {
+      while(fabs(turn_step) &gt; (PI2/64) / 2) 
+	{
+	  if(turn_step &lt; 0.0) 
+	    {
+	      angle -= (PI2/64);
+	      turn_step += (PI2/64); 
+	    }
+	  else if(turn_step &gt; 0.0) 
+	    {
+	      angle += (PI2/64);
+	      turn_step -= (PI2/64); 
+	    }
+	  if(angle &lt; 0.0)
+	    angle += PI2;
+	  if(angle &gt;= PI2)
+	    angle -= PI2;
+	}
+      
+      if (sprite-&gt;frames() &gt; 64)
+	sprite_index = get_index(angle);
+      else
+	sprite_index = get_index(angle, PI/2, sprite-&gt;frames());
+      
+      
+      SpaceObject::calculate();
 
-//added by Tau - start
-	if (exists() &amp;&amp; death_counter &gt;= 0) {
-		while(fabs(turn_step) &gt; (PI2/64) / 2) {
-			if(turn_step &lt; 0.0) {
-				angle -= (PI2/64);
-				turn_step += (PI2/64); }
-			else
-				if(turn_step &gt; 0.0) {
-					angle += (PI2/64);
-					turn_step -= (PI2/64); }
-			if(angle &lt; 0.0)
-				angle += PI2;
-			if(angle &gt;= PI2)
-				angle -= PI2;
-		}
-
-		// changed GEO - just to be sure you don't exceed #frames if #frames&lt;64 (the assumed value here...).
-		// sprite_index = get_index(angle);
-		//sprite_index = get_index(angle, PI/2, sprite-&gt;frames());
-		// (geo) actually, this introduces a big bug if the ship has &gt;64 frames in
-		// the ship sprite -- eg the tau mercury.
-		if (sprite-&gt;frames() &gt; 64)
-			sprite_index = get_index(angle);
-		else
-			sprite_index = get_index(angle, PI/2, sprite-&gt;frames());
-
-
-		SpaceObject::calculate();
-
-		Animation *a;
-		int i, ff;
-		double vv = magnitude(vel);
-
-		death_explosion_counter -= frame_time;
-		while (death_explosion_counter &lt;= 0) {
-			death_explosion_counter += 25;
-			for (i=0; i&lt;2; i++) {
-				ff = random(25);
-				a = new Animation(this, pos, meleedata.xpl1Sprite,
-					ff, 40-ff, 25, DEPTH_EXPLOSIONS);
-				a-&gt;transparency = 1.0 / 4;
-				game-&gt;add(a);
-				a-&gt;accelerate(this, vel.angle(), vv, MAX_SPEED);
-				a-&gt;accelerate(this, random(PI2),
-					random(1.0)*scale_velocity(25)*sqrt((15+mass)/35),
-					MAX_SPEED);
-				a-&gt;collide_flag_anyone = a-&gt;collide_flag_sameship = a-&gt;collide_flag_sameteam = 0;
-			}
-		}
-
-		death_counter += frame_time;
-		if (death_counter &gt; 700 * (15+mass)/35 || death_counter &gt; 3000) //smaller ships will make smaller explosions ; GEO: but a real upper limit is also good to have
-			state = 0; //die already
-
-		return;
+      Animation *a;
+      int i, ff;
+      double vv = magnitude(vel);
+      
+      death_explosion_counter -= frame_time;
+      while (death_explosion_counter &lt;= 0) 
+	{
+	  death_explosion_counter += 25;
+	  for (i=0; i&lt;2; i++) 
+	    {
+	      ff = random(25);
+	      a = new Animation(this, pos, game-&gt;meleedata.xpl1Sprite,
+				ff, 40-ff, 25, DEPTH_EXPLOSIONS);
+	      a-&gt;transparency = 1.0 / 4;
+	      game-&gt;add(a);
+	      a-&gt;accelerate(this, vel.angle(), vv, MAX_SPEED);
+	      a-&gt;accelerate(this, random(PI2),
+			    random(1.0)*scale_velocity(25)*sqrt((15+mass)/35),
+			    MAX_SPEED);
+	      a-&gt;collide_flag_anyone = a-&gt;collide_flag_sameship = a-&gt;collide_flag_sameteam = 0;
+	    }
 	}
-//added by Tau - end
-
-	if (control) {
-		this-&gt;thrust           = 1&amp;&amp;(nextkeys &amp; keyflag::thrust);
-		this-&gt;thrust_backwards = 1&amp;&amp;(nextkeys &amp; keyflag::back);
-		this-&gt;turn_left        = 1&amp;&amp;(nextkeys &amp; keyflag::left);
-		this-&gt;turn_right       = 1&amp;&amp;(nextkeys &amp; keyflag::right);
-		this-&gt;fire_weapon      = 1&amp;&amp;(nextkeys &amp; keyflag::fire);
-		this-&gt;fire_special     = 1&amp;&amp;(nextkeys &amp; keyflag::special);
-		this-&gt;fire_altweapon   = 1&amp;&amp;(nextkeys &amp; keyflag::altfire);
-		this-&gt;target_next      = 1&amp;&amp;(nextkeys &amp; keyflag::next);
-		this-&gt;target_prev      = 1&amp;&amp;(nextkeys &amp; keyflag::prev);
-		this-&gt;target_closest   = 1&amp;&amp;(nextkeys &amp; keyflag::closest);
-        if (nextkeys &amp; keyflag::suicide) {
-            crew  = 0;
-            play_sound((SAMPLE *)(melee[MELEE_BOOMSHIP].dat));
-
-            if (meleedata.xpl1Sprite) {
-                death_counter = 0;
-                death_explosion_counter = 0;
-                collide_flag_anyone = collide_flag_sameship = collide_flag_sameteam = 0;
+      
+      death_counter += frame_time;
+      //smaller ships will make smaller explosions ; GEO: but a real upper limit is also good to have
+      if (death_counter &gt; 700 * (15+mass)/35 || death_counter &gt; 3000) 
+	state = 0; //die already
+      
+      return;
+    }
+  //added by Tau - end
+  
+  if (control) 
+    {
+      this-&gt;thrust           = 1&amp;&amp;(nextkeys &amp; keyflag::thrust);
+      this-&gt;thrust_backwards = 1&amp;&amp;(nextkeys &amp; keyflag::back);
+      this-&gt;turn_left        = 1&amp;&amp;(nextkeys &amp; keyflag::left);
+      this-&gt;turn_right       = 1&amp;&amp;(nextkeys &amp; keyflag::right);
+      this-&gt;fire_weapon      = 1&amp;&amp;(nextkeys &amp; keyflag::fire);
+      this-&gt;fire_special     = 1&amp;&amp;(nextkeys &amp; keyflag::special);
+      this-&gt;fire_altweapon   = 1&amp;&amp;(nextkeys &amp; keyflag::altfire);
+      this-&gt;target_next      = 1&amp;&amp;(nextkeys &amp; keyflag::next);
+      this-&gt;target_prev      = 1&amp;&amp;(nextkeys &amp; keyflag::prev);
+      this-&gt;target_closest   = 1&amp;&amp;(nextkeys &amp; keyflag::closest);
+      if (nextkeys &amp; keyflag::suicide) 
+	{
+	  crew  = 0;
+	  tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMSHIP_WAV.wav&quot;));
+	  
+	  if (game-&gt;meleedata.xpl1Sprite) 
+	    {
+	      death_counter = 0;
+	      death_explosion_counter = 0;
+	      collide_flag_anyone = collide_flag_sameship = collide_flag_sameteam = 0;
+	    }
+	  else 
+	    {
+	      state = 0;
+	      game-&gt;add(new Animation(this, pos, game-&gt;meleedata.kaboomSprite, 0, KABOOM_FRAMES, time_ratio, DEPTH_EXPLOSIONS));
+	    }
+	  if (attributes &amp; ATTRIB_NOTIFY_ON_DEATH) 
+	    {
+	      game-&gt;ship_died(this, NULL);
+	      attributes &amp;= ~ATTRIB_NOTIFY_ON_DEATH;
             }
-            else {
-                state = 0;
-                game-&gt;add(new Animation(this, pos, meleedata.kaboomSprite, 0, KABOOM_FRAMES, time_ratio, DEPTH_EXPLOSIONS));
-            }
-            if (attributes &amp; ATTRIB_NOTIFY_ON_DEATH) {
-                game-&gt;ship_died(this, NULL);
-                attributes &amp;= ~ATTRIB_NOTIFY_ON_DEATH;
-            }
         }
-		this-&gt;nextkeys = control-&gt;keys;
+      this-&gt;nextkeys = control-&gt;keys;
+      
+      if (!control-&gt;exists()) 
+	control = NULL;
+    }
 
-
-        
-
-		if (!control-&gt;exists()) control = NULL;
+  if(batt &lt; batt_max) 
+    {
+      recharge_step -= frame_time;
+      while(recharge_step &lt; 0 &amp;&amp; recharge_rate &gt; 0)	// this loop never ends if there's no recharge
+	{
+	  batt += recharge_amount;
+	  if (batt &gt; batt_max) batt = batt_max;
+	  recharge_step += recharge_rate;
 	}
-
-	if(batt &lt; batt_max) {
-		recharge_step -= frame_time;
-		while(recharge_step &lt; 0 &amp;&amp; recharge_rate &gt; 0)	// this loop never ends if there's no recharge
+    }
+  
+  if(weapon_recharge &gt; 0)
+    weapon_recharge -= frame_time;
+  if(special_recharge &gt; 0)
+    special_recharge -=  frame_time;
+  
+  int target_pressed_prev = target_pressed;
+  target_pressed = target_next || target_prev || target_closest;
+  
+  int i;
+  if (target_pressed &amp;&amp; (!target_pressed_prev) &amp;&amp; control) 
+    {
+      if (target_next) 
+	{
+	  if (control &amp;&amp; targets-&gt;N) 
+	    {
+	      i = control-&gt;index;
+	      if (i &lt; 0) i = 0;
+	      while (1) 
 		{
-			batt += recharge_amount;
-			if (batt &gt; batt_max) batt = batt_max;
-			recharge_step += recharge_rate;
+		  i = (i + 1) % targets-&gt;N;
+		  if (control-&gt;valid_target(targets-&gt;item[i])) 
+		    {
+		      control-&gt;set_target(i);
+		      break;
+		    }
+		  if (control-&gt;index != -1) 
+		    {
+		      if (i == control-&gt;index) 
+			break;
+		    }
+		  else 
+		    {
+		      if (i == 0) 
+			break;
+		    }
 		}
+	    }				
 	}
-
-	if(weapon_recharge &gt; 0)
-		weapon_recharge -= frame_time;
-	if(special_recharge &gt; 0)
-		special_recharge -=  frame_time;
-
-	int target_pressed_prev = target_pressed;
-	target_pressed = target_next || target_prev || target_closest;
-
-	int i;
-	if (target_pressed &amp;&amp; (!target_pressed_prev) &amp;&amp; control) {
-		if (target_next) {
-			if (control &amp;&amp; targets-&gt;N) {
-				i = control-&gt;index;
-				if (i &lt; 0) i = 0;
-				while (1) {
-					i = (i + 1) % targets-&gt;N;
-					if (control-&gt;valid_target(targets-&gt;item[i])) {
-						control-&gt;set_target(i);
-						break;
-					}
-					if (control-&gt;index != -1) {
-						if (i == control-&gt;index) break;
-					}
-					else {
-						if (i == 0) break;
-					}
-				}
-			}				
+      else if (target_prev) 
+	{
+	  if (control &amp;&amp; targets-&gt;N) 
+	    {
+	      i = control-&gt;index;
+	      if (i &lt; 0) i = 0;
+	      while (1) 
+		{
+		  i = (i + targets-&gt;N - 1) % targets-&gt;N;
+		  if (control-&gt;valid_target(targets-&gt;item[i])) 
+		    {
+		      control-&gt;set_target(i);
+		      break;
+		    }
+		  if (control-&gt;index != -1) 
+		    {
+		      if (i == control-&gt;index)
+			break;
+		    }
+		  else 
+		    {
+		      if (i == 0) break;
+		    }
 		}
-		else if (target_prev) {
-			if (control &amp;&amp; targets-&gt;N) {
-				i = control-&gt;index;
-				if (i &lt; 0) i = 0;
-				while (1) {
-					i = (i + targets-&gt;N - 1) % targets-&gt;N;
-					if (control-&gt;valid_target(targets-&gt;item[i])) {
-						control-&gt;set_target(i);
-						break;
-					}
-					if (control-&gt;index != -1) {
-						if (i == control-&gt;index)
-							break;
-					}
-					else {
-						if (i == 0) break;
-					}
-				}
-			}				
+	    }				
+	}
+      else if (target_closest) 
+	{
+	  if (control &amp;&amp; targets-&gt;N) 
+	    {
+	      int i, j = -1;
+	      double r = 99999;
+	      double d;
+	      for (i = 0; i &lt; targets-&gt;N; i += 1) 
+		{
+		  if (control-&gt;valid_target(targets-&gt;item[i])) {
+		    d = distance(targets-&gt;item[i]);
+		    if (d &lt; r) {
+		      r = d;
+		      j = i;
+		    }
+		  }
 		}
-		else if (target_closest) {
-			if (control &amp;&amp; targets-&gt;N) {
-				int i, j = -1;
-				double r = 99999;
-				double d;
-				for (i = 0; i &lt; targets-&gt;N; i += 1) {
-					if (control-&gt;valid_target(targets-&gt;item[i])) {
-						d = distance(targets-&gt;item[i]);
-						if (d &lt; r) {
-							r = d;
-							j = i;
-						}
-					}
-				}
-				control-&gt;set_target(j);
-			}
-		}
+	      control-&gt;set_target(j);
+	    }
 	}
-
-	target_pressed = target_next | target_prev | target_closest;
-	if (control)
-		target = control-&gt;target;
-
-	calculate_turn_left();
-	calculate_turn_right();
-	calculate_thrust();
-	calculate_fire_weapon();
-	calculate_fire_special();
-
-
-	while(fabs(turn_step) &gt; (PI2/64) / 2) {
-		if(turn_step &lt; 0.0) {
-			angle -= (PI2/64);
-			turn_step += (PI2/64);
-		} else
-			if(turn_step &gt; 0.0) {
-				angle += (PI2/64);
-				turn_step -= (PI2/64);
-			}
-
-		if(angle &lt; 0.0) angle += PI2;
-		if(angle &gt;= PI2) angle -= PI2;
+    }
+  
+  target_pressed = target_next | target_prev | target_closest;
+  if (control)
+    target = control-&gt;target;
+  
+  calculate_turn_left();
+  calculate_turn_right();
+  calculate_thrust();
+  calculate_fire_weapon();
+  calculate_fire_special();
+  
+  
+  while(fabs(turn_step) &gt; (PI2/64) / 2) 
+    {
+      if(turn_step &lt; 0.0) 
+	{
+	  angle -= (PI2/64);
+	  turn_step += (PI2/64);
+	} 
+      else if(turn_step &gt; 0.0) 
+	{
+	  angle += (PI2/64);
+	  turn_step -= (PI2/64);
 	}
 
-	sprite_index = get_index(angle);
+      if(angle &lt; 0.0) angle += PI2;
+      if(angle &gt;= PI2) angle -= PI2;
+    }
 
-	// hotspots are too much a luxury to include in massive games (lots of objects)
-	if (hashotspots)
-		calculate_hotspots();
-
-	SpaceObject::calculate();
+  sprite_index = get_index(angle);
+  
+  // hotspots are too much a luxury to include in massive games (lots of objects)
+  if (hashotspots)
+    calculate_hotspots();
+  
+  SpaceObject::calculate();
 }
 
-int Ship::handle_fuel_sap(SpaceLocation *source, double normal) {STACKTRACE
+int Ship::handle_fuel_sap(SpaceLocation *source, double normal) 
+{
+  STACKTRACE;
+  if (death_counter &gt;= 0) 
+    return 0; //added by Tau
 
-	if (death_counter &gt;= 0) return 0; //added by Tau
+  batt -= normal;
+  
+  if(batt &lt; 0) 
+    {
+      normal += batt;
+      batt = 0;
+    }
 
-	batt -= normal;
-
-	if(batt &lt; 0) {
-		normal += batt;
-		batt = 0;
-	}
-
-	if(batt &gt; batt_max) {
-		normal += batt_max - batt;
-		batt = batt_max;
-	}
-
-	return 1;
+  if(batt &gt; batt_max) 
+    {
+      normal += batt_max - batt;
+      batt = batt_max;
+    }
+  
+  return 1;
 }
 
-double Ship::handle_speed_loss(SpaceLocation *source, double normal) {STACKTRACE
-	double speed_loss = normal;
-	if(speed_loss &gt; 0.0) {
-
-
-		double sl = (30/(mass+30)) * speed_loss;
-		if (sl &gt; 1)
-			tw_error(&quot;Speed loss too large\n(%f)&quot;, sl);
-
-		accel_rate *= 1 - sl * accel_rate / (accel_rate + scale_acceleration(2,4));
-		hotspot_rate = (int)(hotspot_rate / (1 - sl * accel_rate / (accel_rate + scale_acceleration(2,4)) ) );
-		speed_max *= 1 - sl * speed_max / (speed_max + scale_velocity(10));
-		turn_rate *=  1 - sl * turn_rate / (turn_rate + scale_turning(4));
-		speed_loss = 0;
-	}
-	return 1;
+double Ship::handle_speed_loss(SpaceLocation *source, double normal) 
+{
+  STACKTRACE;
+  double speed_loss = normal;
+  if(speed_loss &gt; 0.0) 
+    {
+      double sl = (30/(mass+30)) * speed_loss;
+      if (sl &gt; 1)
+	tw_error(&quot;Speed loss too large\n(%f)&quot;, sl);
+      
+      accel_rate *= 1 - sl * accel_rate / (accel_rate + scale_acceleration(2,4));
+      hotspot_rate = (int)(hotspot_rate / (1 - sl * accel_rate / (accel_rate + scale_acceleration(2,4)) ) );
+      speed_max *= 1 - sl * speed_max / (speed_max + scale_velocity(10));
+      turn_rate *=  1 - sl * turn_rate / (turn_rate + scale_turning(4));
+      speed_loss = 0;
+    }
+  return 1;
 }
 
-int Ship::handle_damage(SpaceLocation *source, double normal, double direct) {STACKTRACE
+int Ship::handle_damage(SpaceLocation *source, double normal, double direct) 
+{
+  STACKTRACE;
+  if (death_counter &gt;= 0) 
+    return 0; //added by Tau
 
-	if (death_counter &gt;= 0) return 0; //added by Tau
+  double total = normal + direct;
+  
+  crew -= total;
+  if(crew &gt; crew_max) 
+    {
+      total += crew_max - crew;
+      crew = crew_max;
+    }
 
-	double total = normal + direct;
-
-	crew -= total;
-	if(crew &gt; crew_max) {
-		total += crew_max - crew;
-		crew = crew_max;
+  if(crew &lt;= 0) 
+    {
+      total += crew;
+      crew  = 0;
+      tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMSHIP_WAV.wav&quot;));
+      if (game-&gt;meleedata.xpl1Sprite) 
+	{
+	  death_counter = 0;
+	  death_explosion_counter = 0;
+	  collide_flag_anyone = collide_flag_sameship = collide_flag_sameteam = 0;
 	}
-
-	if(crew &lt;= 0) {
-		total += crew;
-		crew  = 0;
-		play_sound((SAMPLE *)(melee[MELEE_BOOMSHIP].dat));
-		//state = 0;
-//modified by Tau - start
-		if (meleedata.xpl1Sprite) {
-			death_counter = 0;
-			death_explosion_counter = 0;
-			collide_flag_anyone = collide_flag_sameship = collide_flag_sameteam = 0;
-		}
-		else {
-			state = 0;
-			game-&gt;add(new Animation(this, pos, meleedata.kaboomSprite, 0, KABOOM_FRAMES, time_ratio, DEPTH_EXPLOSIONS));
-		}
-		if (attributes &amp; ATTRIB_NOTIFY_ON_DEATH) {
-			game-&gt;ship_died(this, source);
-			attributes &amp;= ~ATTRIB_NOTIFY_ON_DEATH;
-		}
-
+      else 
+	{
+	  state = 0;
+	  game-&gt;add(new Animation(this, pos, game-&gt;meleedata.kaboomSprite, 0, KABOOM_FRAMES, time_ratio, DEPTH_EXPLOSIONS));
 	}
+      if (attributes &amp; ATTRIB_NOTIFY_ON_DEATH) {
+	game-&gt;ship_died(this, source);
+	attributes &amp;= ~ATTRIB_NOTIFY_ON_DEATH;
+      }
+      
+    }
 
-	return 1;
+  return 1;
 }
 
 void Ship::materialize() {
+  STACKTRACE;
 }
 
 
 void Ship::assigntarget(SpaceObject *otarget)
 {
+  STACKTRACE;
 	target = otarget;
 }
 
 
-void Ship::calculate_thrust() {STACKTRACE
+void Ship::calculate_thrust() {
+  STACKTRACE;
 	if (thrust)
 		accelerate_gravwhip(this, angle, accel_rate * frame_time, speed_max);
 	return;
 }
 
 void Ship::calculate_turn_left()
-{STACKTRACE
+{
+  STACKTRACE;
   if(turn_left)
 		turn_step -= turn_rate * frame_time;
 }
 
 void Ship::calculate_turn_right()
-{STACKTRACE
+{
+  STACKTRACE;
   if(turn_right)
 		turn_step += turn_rate * frame_time;
 }
 
-void Ship::calculate_fire_weapon() {STACKTRACE
+void Ship::calculate_fire_weapon() {
+  STACKTRACE;
 	weapon_low = FALSE;
 
 	if (fire_weapon) {
@@ -756,13 +827,17 @@
 		weapon_recharge += weapon_rate;
 
 		if (weapon_sample &gt;= 0)
-			play_sound2(data-&gt;sampleWeapon[weapon_sample]);
+		  {
+		    tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleWeapon[weapon_sample]));
+		    tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleWeapon[weapon_sample]));
+		  }
 	}
 	return;
 }
 
 void Ship::calculate_fire_special()
-{STACKTRACE
+{
+  STACKTRACE;
   special_low = FALSE;
 
   if(fire_special) {
@@ -781,33 +856,42 @@
     special_recharge += special_rate;
 
     if (special_sample &gt;= 0)
-			play_sound2(data-&gt;sampleSpecial[special_sample]);
+      {
+	tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleSpecial[special_sample]));
+	tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleSpecial[special_sample]));
+      }
   }
 }
 
-void Ship::calculate_hotspots() {STACKTRACE
-	if((thrust) &amp;&amp; (hotspot_frame &lt;= 0)) {
-		game-&gt;add(new Animation(this,
-			normal_pos() - unit_vector(angle) * size.x / 2.5,
-			meleedata.hotspotSprite, 0, HOTSPOT_FRAMES, time_ratio, DEPTH_HOTSPOTS));
-		hotspot_frame += hotspot_rate;
-	}
-	if (hotspot_frame &gt; 0)
-		hotspot_frame -= frame_time;
-	return;
+void Ship::calculate_hotspots() 
+{
+  STACKTRACE;
+  if((thrust) &amp;&amp; (hotspot_frame &lt;= 0)) 
+    {
+      game-&gt;add(new Animation(this,
+			      normal_pos() - unit_vector(angle) * size.x / 2.5,
+			      game-&gt;meleedata.hotspotSprite, 0, HOTSPOT_FRAMES, time_ratio, DEPTH_HOTSPOTS));
+      hotspot_frame += hotspot_rate;
+    }
+  if (hotspot_frame &gt; 0)
+    hotspot_frame -= frame_time;
+  return;
 }
 
 int Ship::activate_weapon()
 {
+  STACKTRACE;
   return(TRUE);
 }
 
 int Ship::activate_special()
 {
+  STACKTRACE;
   return(TRUE);
 }
 
 void Ship::animate(Frame *frame) {
+  STACKTRACE;
 	SpaceObject::animate(frame);
 }
 
@@ -818,6 +902,7 @@
 
 ShipType *Ship::get_shiptype()
 {
+  STACKTRACE;
 	return type;
 }
 
@@ -838,7 +923,8 @@
 	phaser_step_position(0),
 	phaser_steps(steps),
 	phaser_step_size(step_size)
-{STACKTRACE
+{
+  STACKTRACE;
 	layer = LAYER_HOTSPOTS;
 	set_depth(DEPTH_HOTSPOTS);
 	collide_flag_anyone = 0;
@@ -855,12 +941,14 @@
 }
 
 void Phaser::animate(Frame *space) {
+  STACKTRACE;
 	sprite-&gt;animate_character(pos, 
 		sprite_index, pallete_color[colors[color_index]], space);
 	return;
 }
 
-void Phaser::calculate() {STACKTRACE
+void Phaser::calculate() {
+  STACKTRACE;
 	if (!exists())
 		return;
 	frame_step -= frame_time;
@@ -891,7 +979,8 @@
 	SpaceObject::calculate();
 }
 
-SpaceLocation *Ship::get_ship_phaser() {STACKTRACE
+SpaceLocation *Ship::get_ship_phaser() {
+  STACKTRACE;
 	return new Phaser(this,
 		pos - unit_vector(angle ) * PHASE_MAX * size.x,
 		unit_vector(angle ) * PHASE_MAX * size.x,

Modified: branches/multiplayer-branch/source/melee/mship.h
===================================================================
--- branches/multiplayer-branch/source/melee/mship.h	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/melee/mship.h	2004-09-28 19:53:03 UTC (rev 71)
@@ -23,50 +23,52 @@
 
 typedef short KeyCode;
 
-struct keyflag {
-	enum { 
-		left       =	(1&lt;&lt;0),
-		right      =	(1&lt;&lt;1),
-		thrust     =	(1&lt;&lt;2),
-		back       =	(1&lt;&lt;3),
-		fire       =	(1&lt;&lt;4),
-		special    =	(1&lt;&lt;5),
-		altfire    =	(1&lt;&lt;6),
-		next       =	(1&lt;&lt;7),
-		prev       =	(1&lt;&lt;8),
-		closest    =	(1&lt;&lt;9),
-		extra1     =   (1&lt;&lt;10),
-		extra2     =   (1&lt;&lt;11),
-		extra3     =   (1&lt;&lt;12),
-		extra4     =   (1&lt;&lt;13),
-		extra5     =   (1&lt;&lt;14),
-		suicide    =   (1&lt;&lt;15),
-		};
-	};
+struct keyflag 
+{
+  enum { 
+    left       =	(1&lt;&lt;0),
+    right      =	(1&lt;&lt;1),
+    thrust     =	(1&lt;&lt;2),
+    back       =	(1&lt;&lt;3),
+    fire       =	(1&lt;&lt;4),
+    special    =	(1&lt;&lt;5),
+    altfire    =	(1&lt;&lt;6),
+    next       =	(1&lt;&lt;7),
+    prev       =	(1&lt;&lt;8),
+    closest    =	(1&lt;&lt;9),
+    extra1     =   (1&lt;&lt;10),
+    extra2     =   (1&lt;&lt;11),
+    extra3     =   (1&lt;&lt;12),
+    extra4     =   (1&lt;&lt;13),
+    extra5     =   (1&lt;&lt;14),
+    suicide    =   (1&lt;&lt;15),
+  };
+};
 
-class Phaser : public SpaceObject {
-	protected:
-	Vector2 rel_pos;
-	Ship *ship;
-	int sprite_index;
-	int *colors;
-	int num_colors;
-	int color_index;
-	int frame_size;
-	int frame_step;
-	int phaser_step_position;
-	int phaser_steps;
-	int phaser_step_size;
+class Phaser : public SpaceObject 
+{
+ protected:
+  Vector2 rel_pos;
+  Ship *ship;
+  int sprite_index;
+  int *colors;
+  int num_colors;
+  int color_index;
+  int frame_size;
+  int frame_step;
+  int phaser_step_position;
+  int phaser_steps;
+  int phaser_step_size;
+  
+ public:
+  Phaser::Phaser(SpaceLocation *creator, Vector2 pos, Vector2 rel_pos, 
+		 Ship *ship, SpaceSprite *sprite, int osprite_index, int *ocolors, 
+		 int onum_colors, int ofsize, int steps, int step_time) ;
+  
+  virtual void animate(Frame *space);
+  virtual void calculate();
+};
 
-	public:
-	Phaser::Phaser(SpaceLocation *creator, Vector2 pos, Vector2 rel_pos, 
-		Ship *ship, SpaceSprite *sprite, int osprite_index, int *ocolors, 
-		int onum_colors, int ofsize, int steps, int step_time) ;
-
-	virtual void animate(Frame *space);
-	virtual void calculate();
-	};
-
 /** the classification of where a given ship comes from */
 enum ShipOrigin { 
     SHIP_ORIGIN_NONE = 0, /**&lt; None, no classification given*/
@@ -76,107 +78,108 @@
 };
 
 /// \brief Exactly what is sounds like
-class Ship : public SpaceObject {
-	protected:
+class Ship : public SpaceObject 
+{
+ protected:
+  
+  int hotspot_frame;
+  int recharge_step;
+  int weapon_recharge;
+  int weapon_low;
+  int special_recharge;
+  int special_low;
+  
+  virtual void calculate_thrust();
+  virtual void calculate_turn_left();
+  virtual void calculate_turn_right();
+  virtual void calculate_fire_weapon();
+  virtual void calculate_fire_special();
+  virtual void calculate_hotspots();
 
-	int hotspot_frame;
-	int recharge_step;
-	int weapon_recharge;
-	int weapon_low;
-	int special_recharge;
-	int special_low;
-
-	virtual void calculate_thrust();
-	virtual void calculate_turn_left();
-	virtual void calculate_turn_right();
-	virtual void calculate_fire_weapon();
-	virtual void calculate_fire_special();
-	virtual void calculate_hotspots();
-
-	virtual int activate_weapon();
-	virtual int activate_special();
-
-	virtual double get_angle_ex() const; // stupid helper for camera
-
-	public:
-	ShipType *type;
-	virtual ShipType *get_shiptype();
-
-	ShipClass *code;
-
-	int death_counter;
-	int death_explosion_counter;
-
-	bool hashotspots;
-	virtual void assigntarget(SpaceObject *otarget);
-
-	virtual void materialize();
-	double crew;
-	double crew_max;
-	double batt;
-	double batt_max;
-	double turn_rate;
-	double turn_step;
-	double speed_max;
-	double accel_rate;
-	int    recharge_amount;
-	int    recharge_rate;
-	int    weapon_drain;
-	int    weapon_rate;
-	int    weapon_sample;
-	int    special_drain;
-	int    special_rate;
-	int    special_sample;
-	int    hotspot_rate;
-	char   captain_name[16];
-
-	SpaceSprite *spritePanel;
-
-	int update_panel;
-
-	KeyCode nextkeys;
-
-	char thrust;
-	char thrust_backwards;
-	char turn_left;
-	char turn_right;
-	char fire_weapon;
-	char fire_special;
-	char fire_altweapon;
-	char target_next;
-	char target_prev;
-	char target_closest;
-
-	char target_pressed;
-	Control *control;
-
-	friend class ShipPanel;
-
-	Ship(SpaceLocation *creator, Vector2 opos, double shipAngle, 
-			SpaceSprite *osprite) ;
-	Ship(Vector2 opos, double shipAngle, ShipData *shipData, 
-			unsigned int code);
-	virtual SpaceLocation *get_ship_phaser() ;
-	virtual ~Ship();
-	virtual void death();
-
-
-	virtual double getCrew();
-	virtual double getBatt();
-
-	virtual RGB crewPanelColor(int k = 0);
-	virtual RGB battPanelColor(int k = 0);
-	virtual bool custom_panel_update(BITMAP *panel, int display_type) {return false;};
-
-
-	void locate();
-
-	void calculate();
-	virtual int handle_damage(SpaceLocation *source, double normal, double direct = 0);
-	virtual int handle_fuel_sap(SpaceLocation *source, double normal);
-	virtual double handle_speed_loss(SpaceLocation *source, double normal);
-
-	virtual void animate(Frame *frame);
+  virtual int activate_weapon();
+  virtual int activate_special();
+  
+  virtual double get_angle_ex() const; ///&lt; stupid helper for camera
+  
+ public:
+  ShipType *type;
+  virtual ShipType *get_shiptype();
+  
+  ShipClass *code;
+  
+  int death_counter;
+  int death_explosion_counter;
+  
+  bool hashotspots;
+  virtual void assigntarget(SpaceObject *otarget);
+  
+  virtual void materialize();
+  double crew;
+  double crew_max;
+  double batt;
+  double batt_max;
+  double turn_rate;
+  double turn_step;
+  double speed_max;
+  double accel_rate;
+  int    recharge_amount;
+  int    recharge_rate;
+  int    weapon_drain;
+  int    weapon_rate;
+  int    weapon_sample;
+  int    special_drain;
+  int    special_rate;
+  int    special_sample;
+  int    hotspot_rate;
+  char   captain_name[16];
+  
+  SpaceSprite *spritePanel;
+  
+  int update_panel;
+  
+  KeyCode nextkeys;
+  
+  char thrust;
+  char thrust_backwards;
+  char turn_left;
+  char turn_right;
+  char fire_weapon;
+  char fire_special;
+  char fire_altweapon;
+  char target_next;
+  char target_prev;
+  char target_closest;
+  
+  char target_pressed;
+  Control *control;
+  
+  friend class ShipPanel;
+  
+  Ship(SpaceLocation *creator, Vector2 opos, double shipAngle, 
+       SpaceSprite *osprite) ;
+  Ship(Vector2 opos, double shipAngle, ShipData *shipData, 
+       unsigned int code);
+  virtual SpaceLocation *get_ship_phaser() ;
+  virtual ~Ship();
+  virtual void death();
+  
+  
+  virtual double getCrew();
+  virtual double getBatt();
+  
+  virtual RGB crewPanelColor(int k = 0);
+  virtual RGB battPanelColor(int k = 0);
+  virtual bool custom_panel_update(BITMAP *panel, int display_type) {return false;};
+  
+  
+  void locate();
+  
+  void calculate();
+  virtual int handle_damage(SpaceLocation *source, double normal, double direct = 0);
+  virtual int handle_fuel_sap(SpaceLocation *source, double normal);
+  virtual double handle_speed_loss(SpaceLocation *source, double normal);
+  
+  virtual void animate(Frame *frame);
 };
 
 

Modified: branches/multiplayer-branch/source/melee/mshot.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mshot.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/melee/mshot.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -15,15 +15,16 @@
 GNU General Public License for more details.
 */
 
+#include &quot;util/sound.h&quot;
 #include &lt;allegro.h&gt;
 
 #include &quot;melee.h&quot;
-REGISTER_FILE
 #include &quot;id.h&quot;
 #include &quot;mgame.h&quot;
 #include &quot;mshot.h&quot;
 #include &quot;mship.h&quot;
 #include &quot;manim.h&quot;
+#include &quot;scp.h&quot;
 
 // Define shot spark
 
@@ -32,16 +33,16 @@
 	SpaceSprite *osprite, double relativity) 
 	:
   SpaceObject(creator, opos-&gt;normal_pos(), 
-	  oangle, osprite),
+	      oangle, osprite),
   v(ov),
-  d(0.0),
+	d(0.0),
   range(orange),
   armour(oarmour),
-  explosionSprite(meleedata.sparkSprite),
-  explosionSample(NULL),
+  explosionSprite(game-&gt;meleedata.sparkSprite),
   explosionFrameCount(SPARK_FRAMES),
   explosionFrameSize(scale_frames(0))
 {
+  STACKTRACE;
 	layer = LAYER_SHOTS;
 	set_depth(DEPTH_SHOTS);
 	attributes |= ATTRIB_SHOT;
@@ -62,6 +63,7 @@
 }
 
 void Shot::calculate() {
+  STACKTRACE;
 	SpaceObject::calculate();
 
 	if (!(ship &amp;&amp; ship-&gt;exists()))
@@ -76,11 +78,13 @@
 }
 
 void Shot::animate(Frame *space) {
+  STACKTRACE;
   SpaceObject::animate(space);
   return;
 }
 
 int Shot::handle_damage(SpaceLocation *source, double normal, double direct) {
+  STACKTRACE;
 	if (!exists()) return 0;
 	if ((normal &gt; 0) || (direct &gt; 0)) {
 		armour -= normal;
@@ -97,6 +101,7 @@
 }
 
 void Shot::inflict_damage(SpaceObject *other) {
+  STACKTRACE;
 	if (!other-&gt;exists()) return;
 	damage(other, damage_factor);
 	//if (!other-&gt;isShot()) state = 0;
@@ -109,35 +114,62 @@
 }
 
 void Shot::death() {
-/*	animateExplosion();
-	soundExplosion(); */
+  STACKTRACE;
 }
 
 void Shot::animateExplosion() {
+  STACKTRACE;
 	game-&gt;add(new Animation(this, normal_pos(),
 			explosionSprite, 0, explosionFrameCount,
 			explosionFrameSize, DEPTH_EXPLOSIONS));
 	return;
 }
 
-void Shot::soundExplosion() {
-	if(explosionSample) {
-		play_sound2(explosionSample);
+void Shot::soundExplosion() 
+{
+  STACKTRACE;
+  if(!explosionSample.empty()) 
+    {
+      tw_sound-&gt;play_sound(data_full_path(explosionSample));
+    }
+  else if(damage_factor &gt; 0) 
+    {
+      int i = iround_down(damage_factor / 2);
+      if(i &gt;= BOOM_SAMPLES) 
+	i = BOOM_SAMPLES - 1;
+      
+      // temporary code
+      switch(i)
+	{
+	case 0:
+	  tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL01_WAV.wav&quot;));
+	  break;
+	case 1:
+	  tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL02_WAV.wav&quot;));
+	  break;
+	case 2:
+	  tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL03_WAV.wav&quot;));
+	  break;
+	case 3:
+	  tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL04_WAV.wav&quot;));
+	  break;
+	default:
+	  {
+	    tw_error(&quot;Unknown BOOM sound&quot;);
+	  }
 	}
-	else if(damage_factor &gt; 0) {
-		int i = iround_down(damage_factor / 2);
-		if(i &gt;= BOOM_SAMPLES) i = BOOM_SAMPLES - 1;
-		play_sound((SAMPLE *)(melee[MELEE_BOOM + i].dat));
-	}
-	return;
+    }
+  return;
 }
 
 void Shot::stop() {
+  STACKTRACE;
 	vel = Vector2(0,0);
 	return;
 }
 
 void Shot::destroy() {
+  STACKTRACE;
 	state = 0;
 	return;
 }
@@ -152,6 +184,7 @@
 }
 
 int Shot::isHomingMissile() {
+  STACKTRACE;
 	return ((id &amp; BASE_MASK3) == SPACE_HOMING_MISSILE);
 }
 
@@ -164,9 +197,11 @@
 	frame_size(ofsize),
 	frame_step(ofsize)
 {
+  STACKTRACE;
 }
 
 void AnimatedShot::calculate() {
+  STACKTRACE;
 	Shot::calculate();
 	frame_step -= frame_time;
 	while (frame_step &lt; 0) {
@@ -183,6 +218,7 @@
 :
 	Shot(creator, rpos, oangle, ov, odamage, orange, oarmour, opos, osprite, relativity)
 {
+  STACKTRACE;
 	sprite_index = get_index(angle);
 }
 
@@ -200,11 +236,13 @@
 	turn_rate(otrate),
 	turn_step(0.0)
 {
+  STACKTRACE;
 	target = otarget;
 	id = SPACE_HOMING_MISSILE;
 }
 
 void HomingMissile::calculate() {
+  STACKTRACE;
 	Missile::calculate();
 	if (target &amp;&amp; !target-&gt;isInvisible()) {
 		double d_a = normalize(trajectory_angle(target) - (angle + turn_step), PI2);
@@ -234,6 +272,7 @@
 }
 
 void HomingMissile::animate(Frame *space) {
+  STACKTRACE;
 	int old_sprite_index = sprite_index;
 	Vector2 old_vel = vel;
 
@@ -270,6 +309,7 @@
   rel_pos(rpos),
   sinc_angle(osinc_angle)
 {
+  STACKTRACE;
 
 // angle conventions fucked up??
 	rel_pos.x *= -1;
@@ -297,6 +337,7 @@
 
 
 void Laser::calculate() {
+  STACKTRACE;
 	if((frame &lt; frame_count) &amp;&amp; (lpos-&gt;exists())) {
 		pos = lpos-&gt;normal_pos() + rotate(rel_pos, lpos-&gt;get_angle() - PI/2);
 		vel = lpos-&gt;get_vel();
@@ -313,6 +354,7 @@
   Laser(creator, lsource-&gt;trajectory_angle(ltarget), lcolor, lsource-&gt;distance(ltarget), ldamage, lfcount, lsource, rel_pos),
   target(ltarget)
 {
+  STACKTRACE;
 	collide_flag_anyone = bit(target-&gt;layer);
 	collide_flag_sameteam = bit(target-&gt;layer);
 	collide_flag_sameship = bit(target-&gt;layer);
@@ -324,11 +366,13 @@
 }
 
 int PointLaser::canCollide(SpaceObject *other) {
+  STACKTRACE;
 	if (other != target) return false;
 	return Laser::canCollide(other);
 }
 
 void PointLaser::calculate() {
+  STACKTRACE;
 	double alpha;
 	alpha = (lpos-&gt;get_angle());
 	Laser::calculate();

Modified: branches/multiplayer-branch/source/melee/mshot.h
===================================================================
--- branches/multiplayer-branch/source/melee/mshot.h	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/melee/mshot.h	2004-09-28 19:53:03 UTC (rev 71)
@@ -22,53 +22,55 @@
 #include &quot;mgame.h&quot;
 
 /// \brief A bullet with a range
-class Shot : public SpaceObject {
-	public:
-	double v;
-	double d;
-	double range;
-	double armour;
+class Shot : public SpaceObject 
+{
+ public:
+  double v;
+  double d;
+  double range;
+  double armour;
   
-	SpaceSprite *explosionSprite;
-	SAMPLE      *explosionSample;
-	int          explosionFrameCount;
-	int          explosionFrameSize;
+  SpaceSprite *explosionSprite;
+  std::string  explosionSample;
+  int          explosionFrameCount;
+  int          explosionFrameSize;
+  
+  Shot(SpaceLocation *creator, Vector2 rpos, double oangle, double ov, double odamage,
+       double orange, double oarmour, SpaceLocation *opos, SpaceSprite *osprite, double relativity = game-&gt;shot_relativity);
+  
+  virtual void animate(Frame *space);
+  
+  virtual void calculate();
+  virtual int handle_damage(SpaceLocation *source, double normal, double direct);
+  virtual void inflict_damage(SpaceObject *other);
+  virtual void death();
+  
+  virtual void animateExplosion();
+  virtual void soundExplosion();
+  
+  void stop();
+  void destroy();
+  
+  virtual void changeDirection(double oangle);
+  int isHomingMissile();
+};
 
-	Shot(SpaceLocation *creator, Vector2 rpos, double oangle, double ov, double odamage,
-			double orange, double oarmour, SpaceLocation *opos, SpaceSprite *osprite, double relativity = game-&gt;shot_relativity);
-
-	virtual void animate(Frame *space);
-
-	virtual void calculate();
-	virtual int handle_damage(SpaceLocation *source, double normal, double direct);
-	virtual void inflict_damage(SpaceObject *other);
-	virtual void death();
-
-	virtual void animateExplosion();
-	virtual void soundExplosion();
-
-	void stop();
-	void destroy();
-
-	virtual void changeDirection(double oangle);
-	int isHomingMissile();
-	};
-
 /// \brief A shot that uses a sequence of images over time
-class AnimatedShot : public Shot {
-	protected:
-	int frame_count;
-	int frame_size;
-	int frame_step;
+class AnimatedShot : public Shot 
+{
+ protected:
+  int frame_count;
+  int frame_size;
+  int frame_step;
+  
+ public:
+  AnimatedShot(SpaceLocation *creator, Vector2 rpos, double oangle, 
+	       double ov, double odamage, double orange, double oarmour, SpaceLocation *opos,
+	       SpaceSprite *osprite, int ofcount, int ofsize, double relativity = game-&gt;shot_relativity);
+  
+  virtual void calculate();
+};
 
-	public:
-	AnimatedShot(SpaceLocation *creator, Vector2 rpos, double oangle, 
-			double ov, double odamage, double orange, double oarmour, SpaceLocation *opos,
-			SpaceSprite *osprite, int ofcount, int ofsize, double relativity = game-&gt;shot_relativity);
-
-	virtual void calculate();
-	};
-
 /// \brief A shot that uses an image depending upon which angle it's pointing
 class Missile : public Shot {
 	public:

Modified: branches/multiplayer-branch/source/melee/mshpdata.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mshpdata.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/melee/mshpdata.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,8 +16,6 @@
 */
 
 
-#include &lt;stdio.h&gt;
-#include &lt;string.h&gt;
 #include &lt;allegro.h&gt;
 #ifdef WIN32
 #include &lt;winalleg.h&gt;
@@ -27,7 +25,6 @@
 #include &lt;string&gt;
 
 #include &quot;melee.h&quot;
-REGISTER_FILE
 #include &quot;util/aastr.h&quot;
 #include &quot;other/twconfig.h&quot;
 
@@ -45,307 +42,332 @@
 typedef std::map&lt;std::string, ShipData*&gt; ShipDataMap;
 ShipDataMap shipdatas;
 
-ShipData *shipdata ( const char *file ) {
-	if (!file) return NULL;
+/// Allocate ship data resources, or return already loaded ones
+ShipData *shipdata ( std::string inifile ) 
+{
+  if ( inifile.empty()) 
+    return NULL;
 	
-	ShipDataMap::iterator shp = shipdatas.find(file);
-	if(shp!=shipdatas.end())
-		return (*shp).second;
-
-	if (!exists(file)) return NULL;
-	ShipData *data = new ShipData(file);
-	shipdatas[file] = data;
-	return data;
+  ShipDataMap::iterator shp = shipdatas.find(inifile);
+  if(shp!=shipdatas.end())
+    return (*shp).second;
+  
+  ShipData *data = new ShipData( inifile);
+  shipdatas[inifile] = data;
+  return data;
 }
-void save_spacesprite2(SpaceSprite *ss, const char *spritename, const char *destination, const char *extension) {
-	int i;
-	char buf[512];
 
-	if (ss-&gt;frames() != 64)
-		tw_error(&quot;save_spacesprite2 - error&quot;);
-
-	BITMAP *tmp = create_bitmap(int(ss-&gt;width() * 8), int(ss-&gt;height() * 8));
-	for (i = 0; i &lt; ss-&gt;frames(); i += 1) {
-		blit(ss-&gt;get_bitmap(i), tmp, 0, 0, (i&amp;7) * (int)ss-&gt;width(), int((i/8) * ss-&gt;height()), (int)ss-&gt;width(), (int)ss-&gt;height());
-		sprintf(buf, &quot;%s%i.%s&quot;, spritename, i, extension);
-		save_bitmap(buf, tmp, NULL);
-	}
-	return;
+void save_spacesprite2(SpaceSprite *ss, const char *spritename, 
+		       const char *destination, const char *extension) 
+{
+  int i;
+  char buf[512];
+  
+  if (ss-&gt;frames() != 64)
+    tw_error(&quot;save_spacesprite2 - error&quot;);
+  
+  BITMAP *tmp = create_bitmap(int(ss-&gt;width() * 8), int(ss-&gt;height() * 8));
+  for (i = 0; i &lt; ss-&gt;frames(); i += 1) 
+    {
+      blit(ss-&gt;get_bitmap(i), tmp, 0, 0, (i&amp;7) * (int)ss-&gt;width(), 
+	   int((i/8) * ss-&gt;height()), (int)ss-&gt;width(), (int)ss-&gt;height());
+      sprintf(buf, &quot;%s%i.%s&quot;, spritename, i, extension);
+      save_bitmap(buf, tmp, NULL);
+    }
+  return;
 }
 
-void save_spacesprite(SpaceSprite *ss, const char *spritename, const char *destination, const char *extension) {
-	int i;
-	char buf[512];
-
-	if (!ss)
-		return;
-
-	if (ss-&gt;frames()) {
-		for (i = 0; i &lt; ss-&gt;frames(); i += 1) {
-			if (strchr(extension, '.')) {
-				sprintf(buf, &quot;tmp/%s%03d%s&quot;, spritename, i, extension);
-			}
-			else {
-				sprintf(buf, &quot;tmp/%s%03d.bmp&quot;, spritename, i);
-			}
-
-			save_bitmap(buf, ss-&gt;get_bitmap(i), NULL);
-		}
-
+void save_spacesprite(SpaceSprite *ss, const char *spritename, 
+		      const char *destination, const char *extension) 
+{
+  int i;
+  char buf[512];
+  
+  if (!ss)
+    return;
+  
+  if (ss-&gt;frames()) 
+    {
+      for (i = 0; i &lt; ss-&gt;frames(); i += 1) 
+	{
+	  if (strchr(extension, '.')) 
+	    {
+	      sprintf(buf, &quot;tmp/%s%03d%s&quot;, spritename, i, extension);
+	    }
+	  else 
+	    {
+	      sprintf(buf, &quot;tmp/%s%03d.bmp&quot;, spritename, i);
+	    }
+	  
+	  save_bitmap(buf, ss-&gt;get_bitmap(i), NULL);
 	}
-
-	sprintf(buf, &quot;tmp/%s.ini&quot;, spritename);
-	tw_set_config_file(buf);
-	set_config_string(&quot;Main&quot;, &quot;Type&quot;, &quot;SpaceSprite&quot;);
-	set_config_int(&quot;SpaceSprite&quot;, &quot;Number&quot;, (int)ss-&gt;frames());
-	set_config_int(&quot;SpaceSprite&quot;, &quot;Width&quot;, (int)ss-&gt;width());
-	set_config_int(&quot;SpaceSprite&quot;, &quot;Height&quot;, (int)ss-&gt;height());
-	set_config_string(&quot;SpaceSprite&quot;, &quot;SubType&quot;, &quot;Normal&quot;);
-	set_config_string(&quot;SpaceSprite&quot;, &quot;Extension&quot;, extension);
-	chdir(&quot;tmp&quot;);
-	sprintf(buf, &quot;dat ../ships/%s.dat -k -a *&quot;, destination);
-//	system(buf);
-	sprintf(buf, &quot;move * ..\\ships\\%s&quot;, destination);
-	system(buf);
-	chdir(&quot;..&quot;);
-	return;
+      
+    }
+  
+  sprintf(buf, &quot;tmp/%s.ini&quot;, spritename);
+  tw_set_config_file(buf);
+  set_config_string(&quot;Main&quot;, &quot;Type&quot;, &quot;SpaceSprite&quot;);
+  set_config_int(&quot;SpaceSprite&quot;, &quot;Number&quot;, (int)ss-&gt;frames());
+  set_config_int(&quot;SpaceSprite&quot;, &quot;Width&quot;, (int)ss-&gt;width());
+  set_config_int(&quot;SpaceSprite&quot;, &quot;Height&quot;, (int)ss-&gt;height());
+  set_config_string(&quot;SpaceSprite&quot;, &quot;SubType&quot;, &quot;Normal&quot;);
+  set_config_string(&quot;SpaceSprite&quot;, &quot;Extension&quot;, extension);
+  chdir(&quot;tmp&quot;);
+  sprintf(buf, &quot;dat ../ships/%s.dat -k -a *&quot;, destination);
+  sprintf(buf, &quot;move * ..\\ships\\%s&quot;, destination);
+  system(buf);
+  chdir(&quot;..&quot;);
+  return;
 }
 
-void save_samples(SpaceSprite *ss, const char *spritename, const char *destination, const char *extension) 
+void ShipData::lock() 
 {
+  STACKTRACE;
+  if (references == 0) 
+    {
+      push_config_state();//can screw up badly if an error occurs while loading...
+      load();
+      pop_config_state();
+    }
+  references += 1;
 }
 
-void ShipData::lock() {
-	if (references == 0) {
-		push_config_state();//can screw up badly if an error occurs while loading...
-		load();
-		pop_config_state();
-	}
-	references += 1;
+void ShipData::unlock() 
+{
+  STACKTRACE;
+  references -= 1;
+  if ((references == 0) &amp;&amp; auto_unload) 
+    {
+      unload();
+    }
 }
 
-void ShipData::unlock() {
-	references -= 1;
-	if ((references == 0) &amp;&amp; auto_unload) {
-		unload();
-	}
-}
+void ShipData::unload() 
+{
+  STACKTRACE;
+  if (status != LOADED_FULL) 
+    return;
 
-void unload_all_ship_data() {
+  if (spriteShip) 
+    {
+      delete spriteShip;
+      spriteShip = NULL;
+    }
+  if (spriteWeapon) 
+    {
+      delete spriteWeapon;
+      spriteWeapon = NULL;
+    }
+  if (spriteWeaponExplosion) 
+    {
+      delete spriteWeaponExplosion;
+      spriteWeaponExplosion = NULL;
+    }
+  if (spriteSpecial) 
+    {
+      delete spriteSpecial;
+      spriteSpecial = NULL;
+    }
+  if (spriteSpecialExplosion) 
+    {
+      delete spriteSpecialExplosion;
+      spriteSpecialExplosion = NULL;
+    }
+  if (spriteExtra) 
+    {
+      delete spriteExtra;
+      spriteExtra = NULL;
+    }
+  
+  if (spritePanel) 
+    {
+      delete spritePanel;
+      spritePanel = NULL;
+    }
+  
+  if (num_more_sprites) 
+    {
+      int i;
+      for (i = 0; i &lt; num_more_sprites; i += 1) 
+	delete more_sprites[i];
+      delete[] more_sprites;
+      more_sprites = NULL;
+      num_more_sprites = 0;
+    }
+  
+  status = LOADED_NONE;
 }
-void unload_unused_ship_data() {
-}
 
-void ShipData::unload() {
-
-	if (status != LOADED_FULL) return;
-
-	if (spriteShip) {
-		delete spriteShip;
-		spriteShip = NULL;
-	}
-	if (spriteWeapon) {
-		delete spriteWeapon;
-		spriteWeapon = NULL;
-	}
-	if (spriteWeaponExplosion) {
-		delete spriteWeaponExplosion;
-		spriteWeaponExplosion = NULL;
-	}
-	if (spriteSpecial) {
-		delete spriteSpecial;
-		spriteSpecial = NULL;
-	}
-	if (spriteSpecialExplosion) {
-		delete spriteSpecialExplosion;
-		spriteSpecialExplosion = NULL;
-	}
-	if (spriteExtra) {
-		delete spriteExtra;
-		spriteExtra = NULL;
-	}
-
-	if (spritePanel) {
-		delete spritePanel;
-		spritePanel = NULL;
-	}
-
-	if (num_more_sprites) {
-		int i;
-		for (i = 0; i &lt; num_more_sprites; i += 1) delete more_sprites[i];
-		delete[] more_sprites;
-		more_sprites = NULL;
-		num_more_sprites = 0;
-	}
-
-	unload_datafile(data);
-
-	status = LOADED_NONE;
-}
-
-ShipData::ShipData(const char *filename) :
-	data(NULL),
-	spriteShip(NULL),
-	spriteWeapon(NULL),
-	spriteWeaponExplosion(NULL),
-	spriteSpecial(NULL),
-	spriteSpecialExplosion(NULL),
-	spriteExtra(NULL),
-	spriteExtraExplosion(NULL),
-	num_weapon_samples(0),
-	sampleWeapon(NULL),
-	num_special_samples(0),
-	sampleSpecial(NULL),
-	num_extra_samples(0),
-	sampleExtra(NULL),
-	moduleVictory(NULL)
+ShipData::ShipData( std::string inifile) :
+  spriteShip(NULL),
+  spriteWeapon(NULL),
+  spriteWeaponExplosion(NULL),
+  spriteSpecial(NULL),
+  spriteSpecialExplosion(NULL),
+  spriteExtra(NULL),
+  spriteExtraExplosion(NULL)
 {
-	file = strdup(filename);
-	references = 0;
-	status = LOADED_NONE;
+  STACKTRACE;
+  ini  = inifile;
+  references = 0;
+  status = LOADED_NONE;
 }
 
 
-SpaceSprite *load_sprite(const char *string, DATAFILE *data, int *index) 
+SpaceSprite *load_sprite(const char *string ) 
 {
-	char buffy[512]; buffy[0] = 0;
-	char *cp = buffy;
-	char *tp;
-	int argc, i;
-	int rotations = 1;
-	char **argv = get_config_argv(&quot;Objects&quot;, string, &amp;argc);
-	int count = 0;
-	if (!argc) return NULL;
-	count = atoi(argv[0]);
-	if (!count) return NULL;
-	tp = strchr(argv[0], 'r');
-	for (i = 1; i &lt; argc; i += 1) {
-		if ((argv[i][0] == '-') || (argv[i][0] == '+')) {
-			cp += sprintf(cp, &quot;%s &quot;, argv[i]);
-		}
-		else if (argv[i][0] == 'r') tp = argv[i];
-		else {tw_error(&quot;load_sprite - unrecognized modifiers '%s'&quot;, argv[i]);}
-	}
-	if (tp) {
-		rotations = atoi(tp+1);
-		if (rotations == 0) rotations = 64;
-	}
-	SpaceSprite *sprite = NULL;
-	int attrib = string_to_sprite_attributes(buffy);
-	sprite = new SpaceSprite(&amp;data[*index], count, attrib, rotations);
-	for (i = 0; i &lt; count; i += 1) {
-		destroy_rle_sprite((RLE_SPRITE*)data[(*index)+i].dat);
-		data[(*index)+i].dat = NULL;
-		// brutal hack to free up the memory
-	}
-	*index += count;
-	return sprite;
+  char buffy[512]; buffy[0] = 0;
+  char *cp = buffy;
+  char *tp;
+  int argc, i;
+  int rotations = 1;
+  char **argv = get_config_argv(&quot;Objects&quot;, string, &amp;argc);
+  int count = 0;
+  if (!argc) 
+    return NULL;
+  count = atoi(argv[0]);
+  if (!count) 
+    return NULL;
+  tp = strchr(argv[0], 'r');
+  for (i = 1; i &lt; argc; i += 1) {
+    if ((argv[i][0] == '-') || (argv[i][0] == '+')) {
+      cp += sprintf(cp, &quot;%s &quot;, argv[i]);
+    }
+    else if (argv[i][0] == 'r') tp = argv[i];
+    else {tw_error(&quot;load_sprite - unrecognized modifiers '%s'&quot;, argv[i]);}
+  }
+  if (tp) 
+    {
+      rotations = atoi(tp+1);
+      if (rotations == 0) 
+	rotations = 64;
+    }
+  SpaceSprite *sprite = NULL;
+  int attrib = string_to_sprite_attributes(buffy);
+  
+  std::vector&lt;std::string&gt; tmpVec;
+
+  for(i = 0; i &lt; count; i++) 
+    {
+      char tmp[200] = {0};
+      sprintf(tmp, &quot;%d&quot;, i);
+      tmpVec.push_back( get_config_string(&quot;Graphic&quot;, 
+					  (std::string(string) + tmp).c_str(),
+					  &quot;&quot;));
+    }
+  
+  sprite = new SpaceSprite(tmpVec, count, attrib, rotations);
+  return sprite;
 }
 
-void ShipData::load() {
-	int i, index = 0, count;
+void ShipData::load() 
+{
+  STACKTRACE;
+  int i, index = 0, count;
+  
+  if (status != LOADED_NONE) 
+    return;
+  
+  tw_set_config_file(ini);
 
-	if (status != LOADED_NONE) return;
+  int num_panel_bitmaps = get_config_int(&quot;Objects&quot;, &quot;PanelBitmaps&quot;, 0);
+  // load ship panel
+  if (num_panel_bitmaps &lt; 2)
+    tw_error(&quot;Too few ship panel bitmaps&quot;);
 
-	data = load_datafile(file);
+  std::vector&lt;std::string&gt; tmpVec;
+  for(i = 0; i &lt; num_panel_bitmaps; i++) 
+    {
+      char tmp[200] = {0};
+      sprintf(tmp, &quot;%d&quot;, i);
+      tmpVec.push_back( get_config_string(&quot;Graphic&quot;, 
+					  (std::string(&quot;PanelBitmaps&quot;) + tmp).c_str(),
+					  &quot;&quot;));
+    }
+  spritePanel = new SpaceSprite(tmpVec, num_panel_bitmaps, SpaceSprite::IRREGULAR);
+  tmpVec.clear();
+  //  tw_error(&quot;!!&quot;);
+  // load ship sprites
+  spriteShip = load_sprite(&quot;ShipSprites&quot;); 
 
-	if(!data)
-		tw_error(&quot;Error loading '%s'&quot;, file);
+  // load weapon sprites
+  spriteWeapon = load_sprite(&quot;WeaponSprites&quot;);
 
-	set_config_data((char *)(data[index].dat), data[index].size);
+  // load weapon explosion sprites
+  spriteWeaponExplosion = load_sprite(&quot;WeaponExplosion&quot;);
 
-	int num_panel_bitmaps = get_config_int(&quot;Objects&quot;, &quot;PanelBitmaps&quot;, 0);
+  // load special ability sprites
+  spriteSpecial = load_sprite(&quot;SpecialSprites&quot;);
+  
+  // load special ability explosion sprites
+  spriteSpecialExplosion = load_sprite(&quot;SpecialExplosion&quot;);
+  
+  // load extra sprites
+  spriteExtra = load_sprite(&quot;ExtraSprites&quot;);
+  
+  // load extra explosion sprites
+  spriteExtraExplosion = load_sprite(&quot;ExtraExplosion&quot;);
+  
+  //load optional super-extra sprites
+  i = 0;
+  more_sprites = NULL;
+  while (true) 
+    {
+      char buffy[512];
+      sprintf(buffy, &quot;ExtraExtraSprites%d_&quot;, i);
+      if (get_config_int(&quot;Objects&quot;, buffy, -1) == -1) 
+	break;
+      
+      //tw_error(&quot;SSS&quot;);
+      more_sprites = (SpaceSprite**) realloc(more_sprites, (i+1) * sizeof(SpaceSprite*));
+      more_sprites[i] = load_sprite(buffy);
+      i += 1;
+    }
+  num_more_sprites = i;
+  
+  // initialize ship victory ditty
+  moduleVictory = get_config_string(&quot;Music&quot;, &quot;Victory&quot;, &quot;&quot;);
+  index++;
+  
+  // load weapon samples
+  count = get_config_int(&quot;Objects&quot;, &quot;WeaponSamples&quot;, 0);
+  for(i = 0; i &lt; count; i++) 
+    {
+      char tmp[200] = {0};
+      sprintf(tmp, &quot;%d&quot;, i);
+      sampleWeapon.push_back( get_config_string(&quot;Sound&quot;, 
+						(std::string(&quot;WeaponSample&quot;) + tmp).c_str(),
+						&quot;&quot;));
+    }
+  
+  // load special ability samples
+  count = get_config_int(&quot;Objects&quot;, &quot;SpecialSamples&quot;, 0);
+  for(i = 0; i &lt; count; i++) 
+    {
+      char tmp[200] = {0};
+      sprintf(tmp, &quot;%d&quot;, i);
+      sampleSpecial.push_back( get_config_string(&quot;Sound&quot;, 
+						 (std::string(&quot;SpecialSample&quot;) + tmp).c_str(),
+						 &quot;&quot;));
+    }
+  
+  // load extra samples
+  count = get_config_int(&quot;Objects&quot;, &quot;ExtraSamples&quot;, 0);
+  for(i = 0; i &lt; count; i++) 
+    {
+      char tmp[200] = {0};
+      sprintf(tmp, &quot;%d&quot;, i);
+      sampleExtra.push_back( get_config_string(&quot;Sound&quot;, 
+					       (std::string(&quot;ExtraSample&quot;) + tmp).c_str(),
+					       &quot;&quot;));
+    }
+  
+  status = LOADED_FULL;
 
-	index++;
-
-	// load ship panel
-	if (num_panel_bitmaps &lt; 2)
-		tw_error(&quot;Too few ship panel bitmaps&quot;);
-	spritePanel = new SpaceSprite(&amp;data[index], num_panel_bitmaps, SpaceSprite::IRREGULAR);
-	index += num_panel_bitmaps;
-
-	// load ship sprites
-	spriteShip = load_sprite(&quot;ShipSprites&quot;, data, &amp;index);
-
-	// load weapon sprites
-	spriteWeapon = load_sprite(&quot;WeaponSprites&quot;, data, &amp;index);
-
-	// load weapon explosion sprites
-	spriteWeaponExplosion = load_sprite(&quot;WeaponExplosion&quot;, data, &amp;index);
-
-	// load special ability sprites
-	spriteSpecial = load_sprite(&quot;SpecialSprites&quot;, data, &amp;index);
-
-	// load special ability explosion sprites
-	spriteSpecialExplosion = load_sprite(&quot;SpecialExplosion&quot;, data, &amp;index);
-
-	// load extra sprites
-	spriteExtra = load_sprite(&quot;ExtraSprites&quot;, data, &amp;index);
-
-	// load extra explosion sprites
-	spriteExtraExplosion = load_sprite(&quot;ExtraExplosion&quot;, data, &amp;index);
-
-	//load optional super-extra sprites
-	i = 0;
-	more_sprites = NULL;
-	while (true) {
-		char buffy[512];
-		sprintf(buffy, &quot;ExtraExtraSprites%d&quot;, i);
-		if (get_config_int(&quot;Objects&quot;, buffy, -1) == -1) break;
-		more_sprites = (SpaceSprite**) realloc(more_sprites, (i+1) * sizeof(SpaceSprite*));
-		more_sprites[i] = load_sprite(buffy, data, &amp;index);
-		i += 1;
-	}
-	num_more_sprites = i;
-
-	// initialize ship victory ditty
-	moduleVictory = (Music *)(data[index].dat);
-	index++;
-
-	// load weapon samples
-	count = get_config_int(&quot;Objects&quot;, &quot;WeaponSamples&quot;, 0);
-	num_weapon_samples = count;
-	if(count &gt; 0) {
-		sampleWeapon = new SAMPLE*[count];
-		for(i = 0; i &lt; count; i++) {
-			sampleWeapon[i] = (SAMPLE *)(data[index].dat);
-			index++;
-		}
-	}
-	else sampleWeapon = NULL;
-
-	// load special ability samples
-	count = get_config_int(&quot;Objects&quot;, &quot;SpecialSamples&quot;, 0);
-	num_special_samples = count;
-	if(count &gt; 0) {
-		sampleSpecial = new SAMPLE*[count];
-		for(i = 0; i &lt; count; i++) {
-			sampleSpecial[i] = (SAMPLE *)(data[index].dat);
-			index++;
-		}
-	}
-	else sampleSpecial = NULL;
-
-	// load extra samples
-	count = get_config_int(&quot;Objects&quot;, &quot;ExtraSamples&quot;, 0);
-	num_extra_samples = count;
-	if(count &gt; 0) {
-		sampleExtra = new SAMPLE*[count];
-		for(i = 0; i &lt; count; i++) {
-			sampleExtra[i] = (SAMPLE *)(data[index].dat);
-			index++;
-		}
-	}
-	else sampleExtra = NULL;
-
-	status = LOADED_FULL;
-
-	return;
-
+  return;  
 }
 
 ShipData::~ShipData()
 {
-	unload();
-	free(file);
+  unload();
 }

Modified: branches/multiplayer-branch/source/melee/mshppan.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mshppan.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/melee/mshppan.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -18,7 +18,6 @@
 #include &lt;allegro.h&gt;
 
 #include &quot;melee.h&quot;
-REGISTER_FILE
 #include &quot;mgame.h&quot;
 #include &quot;mshppan.h&quot;
 #include &quot;mship.h&quot;
@@ -38,7 +37,8 @@
 int batt_y = 53;
 
 
-ShipPanel::ShipPanel(Ship *_ship) {STACKTRACE
+ShipPanel::ShipPanel(Ship *_ship) {
+  STACKTRACE;
 	id |= ID_SHIP_PANEL;
 
 	panel   = create_bitmap(64, 100);
@@ -81,13 +81,15 @@
   delete window;
 }
 
-void ShipPanel::refresh() {STACKTRACE
+void ShipPanel::refresh() {
+  STACKTRACE;
 	panel_needs_update = 1;
 	captain_needs_update = 1;
 	return;
 	}
 
-void ShipPanel::calculate() {STACKTRACE
+void ShipPanel::calculate() {
+  STACKTRACE;
 	if (!ship) {
 		deathframe -= frame_time;
 		if (deathframe &lt;= 0) this-&gt;die();
@@ -116,7 +118,7 @@
 	}
 
 void ShipPanel::animate(Frame *space) {
-	STACKTRACE;
+  STACKTRACE;
 
 	BITMAP *screen = window-&gt;surface;
 	if (!screen) return;
@@ -204,12 +206,12 @@
 		}
 
 	if((!batt_light) &amp;&amp; (ship-&gt;weapon_low || ship-&gt;special_low)) {
-		meleedata.panelSprite-&gt;draw(40, 58, 2, panel);
+		game-&gt;meleedata.panelSprite-&gt;draw(40, 58, 2, panel);
 		batt_light = TRUE;
 		panel_needs_update = true;
 		}
 	else if(batt_light &amp;&amp; (!ship-&gt;weapon_low) &amp;&amp; (!ship-&gt;special_low)) {
-		meleedata.panelSprite-&gt;draw(40, 58, 1, panel);
+		game-&gt;meleedata.panelSprite-&gt;draw(40, 58, 1, panel);
 		batt_light = FALSE;
 		panel_needs_update = true;
 		}

Modified: branches/multiplayer-branch/source/melee/msprite.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/msprite.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/melee/msprite.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -23,7 +23,6 @@
 
 
 #include &quot;melee.h&quot;
-REGISTER_FILE
 #include &quot;util/pmask.h&quot;
 #include &quot;util/aastr.h&quot;
 #include &quot;frame.h&quot;
@@ -32,125 +31,167 @@
 #include &quot;mview.h&quot;
 
 int tw_aa_mode = 0;
-void set_tw_aa_mode ( int a) {
-	tw_aa_mode = a;
+void set_tw_aa_mode ( int a) 
+{
+  STACKTRACE;
+  tw_aa_mode = a;
 }
-int get_tw_aa_mode () {
-	return tw_aa_mode;
+
+int get_tw_aa_mode () 
+{
+  STACKTRACE;
+  return tw_aa_mode;
 }
 
-int string_to_sprite_attributes ( const char *s, int recommended ) {STACKTRACE
-	int a = recommended;
-	if (!s) return a;
+/// \brief convert attribute string to bit mask
+/// \param s attribute string
+/// \param recommended default mask
+/// \return bit mask
+int string_to_sprite_attributes ( const char *s, int recommended ) 
+{
+  STACKTRACE;
+  int a = recommended;
+  if (!s) return a;
+  
+  if (strstr(s, &quot;+screen&quot;)) 
+    {
+      a |= SpaceSprite::MATCH_SCREEN_FORMAT;
+    }
+  if (strstr(s, &quot;-screen&quot;)) 
+    {
+      a &amp;=~SpaceSprite::MATCH_SCREEN_FORMAT;
+    }
 
-	if (strstr(s, &quot;+screen&quot;)) {
-		a |= SpaceSprite::MATCH_SCREEN_FORMAT;
-	}
-	if (strstr(s, &quot;-screen&quot;)) {
-		a &amp;=~SpaceSprite::MATCH_SCREEN_FORMAT;
-	}
+  if (strstr(s, &quot;+mipmap&quot;)) 
+    {
+      a |= SpaceSprite::MIPMAPED;
+    }
+  if (strstr(s, &quot;-mipmap&quot;)) 
+    {
+      a &amp;=~SpaceSprite::MIPMAPED;
+    }
+  
+  if (strstr(s, &quot;+irregular&quot;)) 
+    {
+      a |= SpaceSprite::IRREGULAR;
+    }
+  if (strstr(s, &quot;-irregular&quot;)) 
+    {
+      a &amp;=~SpaceSprite::IRREGULAR;
+    }
+  
+  if (strstr(s, &quot;+masked&quot;)) 
+    {
+      a |= SpaceSprite::MASKED;
+    }
+  if (strstr(s, &quot;-masked&quot;)) 
+    {
+      a &amp;=~SpaceSprite::MASKED;
+    }
+  
+  if (strstr(s, &quot;+alpha&quot;)) 
+    {
+      a |= SpaceSprite::ALPHA;
+      a &amp;=~SpaceSprite::MATCH_SCREEN_FORMAT;//remove me
+    }
+  if (strstr(s, &quot;-alpha&quot;)) 
+    {
+      a &amp;=~SpaceSprite::ALPHA;
+    }
+  
+  if (strstr(s, &quot;+dither&quot;)) 
+    {
+      a |= SpaceSprite::DITHER;
+    }
+  if (strstr(s, &quot;-dither&quot;)) 
+    {
+      a &amp;=~SpaceSprite::DITHER;
+    }
+  
+  if (strstr(s, &quot;+noaa&quot;)) 
+    {
+      a |= SpaceSprite::NO_AA;
+    }
+  if (strstr(s, &quot;-noaa&quot;)) 
+    {
+      a &amp;=~SpaceSprite::NO_AA;
+    }
+  return a;
+}
 
-	if (strstr(s, &quot;+mipmap&quot;)) {
-		a |= SpaceSprite::MIPMAPED;
-	}
-	if (strstr(s, &quot;-mipmap&quot;)) {
-		a &amp;=~SpaceSprite::MIPMAPED;
-	}
-
-	if (strstr(s, &quot;+irregular&quot;)) {
-		a |= SpaceSprite::IRREGULAR;
-	}
-	if (strstr(s, &quot;-irregular&quot;)) {
-		a &amp;=~SpaceSprite::IRREGULAR;
-	}
-
-	if (strstr(s, &quot;+masked&quot;)) {
-		a |= SpaceSprite::MASKED;
-	}
-	if (strstr(s, &quot;-masked&quot;)) {
-		a &amp;=~SpaceSprite::MASKED;
-	}
-
-	if (strstr(s, &quot;+alpha&quot;)) {
-		a |= SpaceSprite::ALPHA;
-		a &amp;=~SpaceSprite::MATCH_SCREEN_FORMAT;//remove me
-	}
-	if (strstr(s, &quot;-alpha&quot;)) {
-		a &amp;=~SpaceSprite::ALPHA;
-	}
-
-	if (strstr(s, &quot;+dither&quot;)) {
-		a |= SpaceSprite::DITHER;
-	}
-	if (strstr(s, &quot;-dither&quot;)) {
-		a &amp;=~SpaceSprite::DITHER;
-	}
-
-	if (strstr(s, &quot;+noaa&quot;)) {
-		a |= SpaceSprite::NO_AA;
-	}
-	if (strstr(s, &quot;-noaa&quot;)) {
-		a &amp;=~SpaceSprite::NO_AA;
-	}
-	return a;
+void handle_alpha_load ( BITMAP *bmp ) 
+{
+  STACKTRACE;
+  switch (bitmap_color_depth(bmp)) 
+    {
+    case 16: 
+      {
+	rgba4444_as_rgb16 (bmp);
+      } break;
+    case 32: 
+      {
+	convert_alpha(bmp, 1);
+      } 
+      break;
+    default: 
+      {
+      } 
+      break;
+    }
+  return;
 }
 
-void handle_alpha_load ( BITMAP *bmp ) {
-	switch (bitmap_color_depth(bmp)) {
-		case 16: {
-			rgba4444_as_rgb16 (bmp);
-			//invert_alpha(bmp);
-		} break;
-		case 32: {
-			convert_alpha(bmp, 1);
-		} break;
-		default: {
-		} break;
-	}
-	return;
+/// \brief draw line
+void line ( BITMAP *dest, Vector2 p1, Vector2 p2, int color ) 
+{
+  STACKTRACE;
+  line (dest, iround(p1.x), iround(p1.y), iround(p2.x), iround(p2.y), color);
 }
 
-void line ( BITMAP *dest, Vector2 p1, Vector2 p2, int color ) {
-	line (dest, iround(p1.x), iround(p1.y), iround(p2.x), iround(p2.y), color);
+/// \brief draw line
+void line ( Frame *dest, Vector2 p1, Vector2 p2, int color ) 
+{
+  STACKTRACE;
+  int x1, y1, x2, y2;
+  x1 = iround(p1.x);	y1 = iround(p1.y);
+  x2 = iround(p2.x);	y2 = iround(p2.y);
+  line(dest-&gt;surface, x1, y1, x2, y2, color);
+  dest-&gt;add_line(x1, y1, x2, y2);
 }
-void line ( Frame *dest, Vector2 p1, Vector2 p2, int color ) {
-	int x1, y1, x2, y2;
-	x1 = iround(p1.x);	y1 = iround(p1.y);
-	x2 = iround(p2.x);	y2 = iround(p2.y);
-	line(dest-&gt;surface, x1, y1, x2, y2, color);
-	dest-&gt;add_line(x1, y1, x2, y2);
-}
 
 
 int SpaceSprite::mip_min = 0;
 int SpaceSprite::mip_max = 8;
 int SpaceSprite::mip_bias = 0;
-inline int find_mip_level(double r, int highest) {
-	int a;
-	frexp(r, &amp;a);
-	a = SpaceSprite::mip_bias - a;
-	if (a &lt; SpaceSprite::mip_min) a = SpaceSprite::mip_min;
-	if (a &gt; SpaceSprite::mip_max) a = SpaceSprite::mip_max;
-	if (a &gt; highest) a = highest;
-	return a;
+inline int find_mip_level(double r, int highest) 
+{
+  STACKTRACE;
+  int a;
+  frexp(r, &amp;a);
+  a = SpaceSprite::mip_bias - a;
+  if (a &lt; SpaceSprite::mip_min) a = SpaceSprite::mip_min;
+  if (a &gt; SpaceSprite::mip_max) a = SpaceSprite::mip_max;
+  if (a &gt; highest) a = highest;
+  return a;
 }
-//COMPILE_TIME_ASSERT(SpaceSprite::DITHER == AA_DITHER &lt;&lt; 16);
-//COMPILE_TIME_ASSERT(SpaceSprite::MASKED == AA_MASKED &lt;&lt; 16);
-//COMPILE_TIME_ASSERT(SpaceSprite::ALPHA  == AA_ALPHA &lt;&lt; 16);
-inline int find_aa_mode(int general_options) {
-	int aa = tw_aa_mode;
-	if (general_options &amp; SpaceSprite::MASKED) aa |= AA_MASKED;
-	if (~general_options &amp; SpaceSprite::ALPHA) aa &amp;=~AA_ALPHA;
-	if (general_options &amp; SpaceSprite::NO_AA)  {
-		aa |= AA_NO_AA;
-	}
-	return aa;
+
+inline int find_aa_mode(int general_options) 
+{
+  STACKTRACE;
+  int aa = tw_aa_mode;
+  if (general_options &amp; SpaceSprite::MASKED) aa |= AA_MASKED;
+  if (~general_options &amp; SpaceSprite::ALPHA) aa &amp;=~AA_ALPHA;
+  if (general_options &amp; SpaceSprite::NO_AA)  {
+    aa |= AA_NO_AA;
+  }
+  return aa;
 }
 
 
-
+/// \brief do nothing
 void convert_bitmap(BITMAP *src, BITMAP *dest, int aa_mode) 
 {
+  STACKTRACE;
   if ((src-&gt;w != dest-&gt;w) || (src-&gt;h != dest-&gt;h)) 
     {
       tw_error(&quot;convert_bitmap - wrong size&quot;);
@@ -161,6 +202,7 @@
 
 void color_correct_bitmap(BITMAP *bmp, int masked) 
 {
+  STACKTRACE;
   //return;//remove me!!!
   int x, y, w, h;
   w = bmp-&gt;w;
@@ -214,7 +256,7 @@
 	      }
 	      break;
 	    }
-	  videosystem.color_effects(&amp;a);
+	  videosystem-&gt;color_effects(&amp;a);
 	  c = makeacol_depth(bitmap_color_depth(bmp), a.r, a.g, a.b, a.filler);
 	  if ((c == bmc) &amp;&amp; masked) 
 	    {
@@ -231,6 +273,7 @@
 
 void SpaceSprite::generate_mipmaps() 
 {
+  STACKTRACE;
   int bpp, level, i;
   if (general_attributes &amp; MIPMAPED) 
     {
@@ -264,6 +307,7 @@
 
 void SpaceSprite::change_color_depth(int newbpp) 
 {
+  STACKTRACE;
   int i, l;
   for (l = 0; l &lt;= highest_mip; l += 1) 
     {
@@ -281,6 +325,7 @@
 
 void SpaceSprite::permanent_phase_shift ( int phase ) 
 {
+  STACKTRACE;
   int i, mip;
   Surface **tmp = new Surface*[count];
   while (phase &lt; 0) phase += count;
@@ -325,6 +370,7 @@
 
 SpaceSprite::SpaceSprite(const DATAFILE *images, int sprite_count, int _attributes, int rotations) 
 {
+  STACKTRACE;
   int i, j, obpp=0;
   BITMAP *bmp = NULL, *tmp = NULL;
   
@@ -348,15 +394,14 @@
   general_attributes = _attributes;
   if (general_attributes &amp;  MATCH_SCREEN_FORMAT) 
     {
-      bpp = videosystem.bpp;
+      bpp = videosystem-&gt;bpp;
       if (general_attributes &amp; ALPHA) 
 	{
-	  if (bpp &lt;= 16) bpp = 16;
-	  else bpp = 32;
 	  bpp = 32; //quick hack, because converting to 16bpp isn't quite working properly
 	}
     }
-  else bpp = 0;
+  else 
+    bpp = 0;
   
   originaltype = images[0].type;
   switch (originaltype) 
@@ -562,6 +607,7 @@
 
 SpaceSprite::SpaceSprite(SpaceSprite &amp;old) 
 {
+  STACKTRACE;
   int i, l;
   BITMAP *bmp;
   count = old.count;
@@ -594,14 +640,181 @@
   else b[l] = NULL;
 }
 
+
+
+SpaceSprite::SpaceSprite(std::vector&lt;std::string&gt; bmplist, int sprite_count, int _attributes, int rotations)
+{
+  STACKTRACE;
+  int i, j, obpp=0;
+  BITMAP *bmp = NULL, *tmp = NULL, *tmp2 = NULL;
+  
+
+  if (_attributes == -1) 
+    _attributes = string_to_sprite_attributes(NULL);
+
+  count = sprite_count * rotations;
+  if ((rotations &lt; 1) || (count &lt; 1)) 
+    {
+      tw_error(&quot;SpaceSprite::SpaceSprite - bad parameters&quot;);
+    }
+  
+  references = 0;
+  highest_mip = 0;
+  for (i = 1; i &lt; MAX_MIP_LEVELS; i += 1) 
+    {
+      b[i] = NULL;
+    }
+  
+  general_attributes = _attributes;
+  if (general_attributes &amp;  MATCH_SCREEN_FORMAT) 
+    {
+      bpp = videosystem-&gt;bpp;
+      if (general_attributes &amp; ALPHA) 
+	{
+	  bpp = 32; 
+	}
+    }
+  else 
+    bpp = 0;
+  
+  
+  tmp2 = load_bitmap(data_full_path(bmplist[0]).c_str(), NULL);
+  if(!tmp2)
+    tw_error(&quot;Unable to load bitmap: %s&quot;, data_full_path(bmplist[0]).c_str());
+
+  w = tmp2-&gt;w;
+  h = tmp2-&gt;h;
+  obpp = bitmap_color_depth(tmp2);
+  
+  if (bpp == 0) 
+    bpp = obpp;
+  
+  if (obpp != bpp) 
+    tmp = create_bitmap_ex(obpp, w, h);
+  
+  if (general_attributes &amp; ALPHA) 
+    {
+      bpp = 32;
+    }
+  destroy_bitmap(tmp2);
+  
+  if (general_attributes &amp; IRREGULAR) 
+    {
+      if (rotations != 1) 
+	{
+	  tw_error (&quot; irregular SpaceSprites are not permitted to be autorotated&quot;);
+	}
+  
+      m = new PMASK*[count];
+      b[0] = new BITMAP*    [count];
+      attributes  = new char [count];
+  
+      for(i = 0; i &lt; sprite_count; i += 1) 
+	{
+	  tmp2 = load_bitmap(data_full_path(bmplist[i]).c_str(), NULL);
+	  if(!tmp2)
+	    {
+	      tw_error(&quot;unable to load bitmap: %s&quot;, bmplist[i].c_str());
+	    }
+	  if (general_attributes &amp; ALPHA) 
+	    handle_alpha_load(tmp2);
+	  w = tmp2-&gt;w;
+	  h = tmp2-&gt;h;
+	  bmp = create_bitmap_ex ( bpp, w, h);
+	  convert_bitmap(tmp2, bmp, general_attributes &amp; MASKED);
+	  color_correct_bitmap(bmp, general_attributes &amp; MASKED);
+	  m[(i * rotations)] = create_allegro_pmask(bmp);
+	  b[0][(i * rotations)] = bmp;
+	  attributes[(i * rotations)] = DEALLOCATE_IMAGE | DEALLOCATE_MASK;
+	  destroy_bitmap(tmp2);
+	}
+      return;//end of irregular/masked 
+    }
+  
+  /*
+  for(i = 1; i &lt; sprite_count; i++) 
+    {
+      if ((w != ((BITMAP *)images[i].dat)-&gt;w) || 
+	  (h != ((BITMAP *)images[i].dat)-&gt;h) ) 
+	{
+	  tw_error(&quot;SpaceSprite - size changed&quot;);
+	}
+      if (bitmap_color_depth((BITMAP *)images[i].dat) != obpp) 
+	{
+	  tw_error(&quot;SpaceSprite - changing source color depth not yet allowed&quot;);
+	}
+    }
+  */
+
+  m = new PMASK*[count];
+  b[0] = new BITMAP*    [count];
+  attributes  = new char [count];
+  
+  for(i = 0; i &lt; sprite_count; i += 1) 
+    {
+      tmp2 = load_bitmap(data_full_path(bmplist[i]).c_str(), NULL);
+      if(!tmp2)
+	{
+	  tw_error(&quot;unable to load bitmap: %s&quot;, bmplist[i].c_str());
+	}
+      bmp = create_bitmap_ex(bpp, w, h);
+      if (!tmp) 
+	tmp = bmp;
+      if (general_attributes &amp; MASKED) 
+	clear_to_color(bmp, bitmap_mask_color(bmp));
+      if (tmp != bmp) 
+	clear_to_color(tmp, bitmap_mask_color(tmp));
+
+      if (general_attributes &amp; ALPHA) 
+	handle_alpha_load(tmp2);
+      if (obpp != bpp) 
+	{
+	  convert_bitmap(tmp2, bmp, (general_attributes &amp; MASKED) ? AA_MASKED : 0);
+	}
+      else 
+	{
+	  if (general_attributes &amp; MASKED) 
+	    draw_sprite(bmp, tmp2, 0, 0);
+	  else 
+	    blit(tmp2, bmp, 0, 0, 0, 0, w, h);
+	}
+      color_correct_bitmap(bmp, general_attributes &amp; MASKED);
+
+      if (tmp == bmp) 
+	tmp = NULL;
+      for (j = 1; j &lt; rotations; j += 1) 
+	{
+	  BITMAP *tmp = create_bitmap_ex(bpp, w, h);
+	  clear_to_color(tmp, bitmap_mask_color(tmp));
+	  rotate_sprite(tmp, bmp, 0, 0, j * ((1&lt;&lt;24)/rotations));
+	  m[j + (i * rotations)] = create_allegro_pmask(tmp);
+	  b[0][j + (i * rotations)] = tmp;
+	  attributes[j + (i * rotations)] = DEALLOCATE_IMAGE | DEALLOCATE_MASK;
+	}
+      m[(i * rotations)] = create_allegro_pmask(bmp);
+      b[0][(i * rotations)] = bmp;
+      attributes[(i * rotations)] = DEALLOCATE_IMAGE | DEALLOCATE_MASK;
+      destroy_bitmap(tmp2);
+    }
+
+  if (general_attributes &amp; MIPMAPED) 
+    {
+      generate_mipmaps();
+    }
+
+  return;//end of normal/masked/autorotated
+}
+
 void SpaceSprite::lock() 
 {
+  STACKTRACE;
   highest_mip = 0;
   return;
 }
 
 void SpaceSprite::unlock() 
 {
+  STACKTRACE;
   int i, j;
   for (i = 0; i &lt; MAX_MIP_LEVELS; i += 1) 
     {
@@ -641,6 +854,7 @@
 
 BITMAP *SpaceSprite::get_bitmap(int index, int miplevel)
 {
+  STACKTRACE;
   if (general_attributes &amp; MIPMAPED) 
     if (miplevel &gt; highest_mip) 
       {tw_error (&quot;get_bitmap on undefined mipmap level&quot;);}
@@ -651,6 +865,7 @@
 
 BITMAP *SpaceSprite::get_bitmap_readonly(int index)
 {
+  STACKTRACE;
   if (index &gt;= count) 
     {
       tw_error(&quot;SpaceSprite::get_bitmap_readonly - index %d &gt;= count %d&quot;, index, count); index = 0;
@@ -664,6 +879,7 @@
 
 void SpaceSprite::animate_character(Vector2 pos, int index, int color, Frame *space, double scale) 
 {
+  STACKTRACE;
   if (index &gt;= count) 
     {
       tw_error(&quot;SpaceSprite::animate_character - index %d &gt;= count %d&quot;, index, count);
@@ -751,6 +967,7 @@
 
 void SpaceSprite::draw(Vector2 pos, Vector2 size, int index, BITMAP *surface) 
 {
+  STACKTRACE;
   if (index &gt;= count) 
     {
       tw_error(&quot;SpaceSprite::draw - index %d &gt; count %d&quot;, index, count); index = 0;
@@ -781,6 +998,7 @@
 
 void SpaceSprite::draw(Vector2 pos, Vector2 size, int index, Frame *frame) 
 {
+  STACKTRACE;
   if (index &gt;= count) 
     {
       tw_error(&quot;SpaceSprite::draw - index %d &gt; count %d&quot;, index, count); index = 0;
@@ -826,12 +1044,14 @@
 
 void SpaceSprite::draw(int x, int y, int index, BITMAP *surface) 
 {
+  STACKTRACE;
   draw(Vector2(x,y), Vector2(b[0][index]-&gt;w, b[0][index]-&gt;h), index, surface);
   return;
 }
 
 void SpaceSprite::animate(Vector2 pos, int index, Frame *space, double scale) 
 {
+  STACKTRACE;
   if (index &gt;= count) 
     {
       tw_error(&quot;SpaceSprite::animate - index %d &gt;= count %d&quot;, index, count);
@@ -849,6 +1069,7 @@
 
 void SpaceSprite::draw_character(int x, int y, int index, int color, BITMAP *bmp) 
 {
+  STACKTRACE;
   if (index &gt;= count) 
     {
       tw_error(&quot;SpaceSprite::draw_character - index %d &gt;= count %d&quot;, index, count); index = 0;
@@ -863,18 +1084,21 @@
 
 void SpaceSprite::draw_character(int x, int y, int index, int color, Frame *space) 
 {
+  STACKTRACE;
   draw_character(x, y, index, color, space-&gt;surface);
   space-&gt;add_box(x, y, w, h);
 }
 
 void SpaceSprite::draw_character(int x, int y, int w, int h, int index, int color, Frame *space) 
 {
+  STACKTRACE;
   draw_character(x, y, w, h, index, color, space-&gt;surface);
   space-&gt;add_box(x, y, w, h);
 }
 
 void SpaceSprite::draw_character(int x, int y, int w, int h, int index, int color, BITMAP *bmp) 
 {
+  STACKTRACE;
   if (index &gt;= count) 
     {
       tw_error(&quot;SpaceSprite::draw_character_stretch - index %d &gt;= count %d&quot;, index, count); index = 0;
@@ -890,6 +1114,7 @@
 int SpaceSprite::collide(int x, int y, int i, int ox, int oy, int oi,
 			 SpaceSprite *other)
 {
+  STACKTRACE;
   if (i &gt;= count) 
     { 
       tw_error(&quot;SpaceSprite::collide - index1 %d &gt;= count1 %d&quot;, i, count); 
@@ -944,6 +1169,7 @@
 int SpaceSprite::collide_ray(int lx1, int ly1, int *lx2, int *ly2,
   int sx, int sy, int sindex)
 {
+  STACKTRACE;
   line_collide = FALSE;
   rect_x = sx - (w / 2);
   rect_y = sy - (h / 2);

Modified: branches/multiplayer-branch/source/melee/mtarget.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mtarget.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/melee/mtarget.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -24,6 +24,7 @@
 
 Targets::Targets()
 {
+  STACKTRACE;
 	N = 0;
 	item = 0;
 }
@@ -36,6 +37,7 @@
 
 void Targets::reset()
 {
+  STACKTRACE;
 	if (item)
 		free(item);
 	item = 0;
@@ -43,7 +45,8 @@
 }
 
 
-void Targets::add(SpaceObject *a) {STACKTRACE
+void Targets::add(SpaceObject *a) {
+  STACKTRACE;
 	N += 1;
 	item = (SpaceObject **) realloc(item, sizeof(SpaceObject *) * N);
 	item[N - 1] = a;
@@ -53,6 +56,7 @@
 
 void Targets::rem(int i)
 {
+  STACKTRACE;
 	-- N;
 	item[i]-&gt;attributes &amp;= ~ATTRIB_TARGET;
 	item[i] = item[N];
@@ -61,6 +65,7 @@
 
 void Targets::rem(SpaceObject *r)
 {
+  STACKTRACE;
 	int i;
 	for ( i = 0; i &lt; N; ++i )
 		if (item[i] == r)
@@ -76,6 +81,7 @@
 
 void Targets::calculate()
 {
+  STACKTRACE;
 	int i;
 	
 	for (i = 0; i &lt; N; i += 1)
@@ -93,6 +99,7 @@
 
 int Targets::findindex(SpaceObject *o)
 {
+  STACKTRACE;
 	int i;
 
 	for (i = 0; i &lt; N; i += 1)
@@ -109,5 +116,6 @@
 
 bool Targets::isintargetlist(SpaceObject *o)
 {
+  STACKTRACE;
 	return findindex(o) &gt;= 0;
 }

Modified: branches/multiplayer-branch/source/melee/mview.cpp
===================================================================
--- branches/multiplayer-branch/source/melee/mview.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/melee/mview.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -23,7 +23,6 @@
 
 
 #include &quot;melee.h&quot;
-REGISTER_FILE
 #include &quot;scp.h&quot;
 #include &quot;frame.h&quot;
 
@@ -59,7 +58,8 @@
 
 
 
-View * ViewType::create( View * old ) {STACKTRACE
+View * ViewType::create( View * old ) {
+  STACKTRACE;
 	View * r = _create();
 	r-&gt;preinit();
 	r-&gt;type = this;
@@ -112,7 +112,8 @@
 
 
 
-void View::preinit() {STACKTRACE
+void View::preinit() {
+  STACKTRACE;
 	frame = NULL;
 	window = NULL;
 	type = NULL;
@@ -153,7 +154,8 @@
 }
 
 
-void View::animate(Game *game) {STACKTRACE
+void View::animate(Game *game) {
+  STACKTRACE;
 	if (FULL_REDRAW) frame-&gt;full_redraw = true;
 	frame-&gt;erase();
 	prepare(frame, 0);
@@ -169,11 +171,12 @@
 	return;
 	}
 
-void View::config() {STACKTRACE
+void View::config() {
+  STACKTRACE;
 	return;
 	}
 bool View::screen2game(Vector2 *_pos) {
-	STACKTRACE
+  STACKTRACE;
 	Vector2 pos = *_pos;
 	Vector2 opos = pos;
 
@@ -193,7 +196,7 @@
 	return true;
 	}
 double View::in_view(Vector2 pos, Vector2 size) {
-	STACKTRACE
+  STACKTRACE;
 	pos = corner(pos, size);
 	size = size * space_zoom;
 
@@ -212,7 +215,7 @@
 	return a * b / (size.x * size.y);
 }
 int View::focus(CameraPosition *pos, SpaceLocation *la, SpaceLocation *lb) {
-	STACKTRACE
+  STACKTRACE;
 	if (!la &amp;&amp; !lb) return 0;
 	if (!la) la = lb;
 	if (!lb) lb = la;
@@ -242,6 +245,7 @@
 }
 
 /*void View::see_also(SpaceLocation *o) {
+  STACKTRACE;
 	if (!o) return;
 	double x2, y2;
 	x2 = b-&gt;normal_x();
@@ -317,7 +321,8 @@
 	return;
 }
 
-void View::init(View *old) {STACKTRACE
+void View::init(View *old) {
+  STACKTRACE;
 	if (window || frame) {
 		tw_error(&quot;View::init - hmm...&quot;);
 	}
@@ -373,9 +378,11 @@
 		delete frame;
 	}
 }
-void View::calculate(Game *game) {}
+void View::calculate(Game *game) {
+  STACKTRACE;}
 
-void message_type::out(char *string, int dur, int c) {STACKTRACE
+void message_type::out(char *string, int dur, int c) {
+  STACKTRACE;
 	ASSERT (c &lt; 256);
 	if (num_messages == max_messages - 1) {
 		messages[0].end_time = -1;
@@ -391,7 +398,8 @@
 	clean();
 	return;
 	}
-void message_type::print(int dur, int c, const char *format, ...) {STACKTRACE
+void message_type::print(int dur, int c, const char *format, ...) {
+  STACKTRACE;
 	char buf[1024];
 	va_list those_dots;
 	va_start (those_dots, format);
@@ -408,7 +416,8 @@
 	out(buf, dur, c);
 	return;
 	}
-void message_type::clean() {STACKTRACE
+void message_type::clean() {
+  STACKTRACE;
 	int kill_time;
 	if (game) kill_time = game-&gt;game_time;
 	else kill_time = 0;
@@ -422,7 +431,8 @@
 		}
 	return;
 	}
-void message_type::flush() {STACKTRACE
+void message_type::flush() {
+  STACKTRACE;
 	for (int i = 0; i &lt; num_messages; i += 1) {
 		if (messages[i].string)
 			free (messages[i].string);
@@ -431,7 +441,8 @@
 	return;
 	}
 
-void message_type::animate(Frame *frame) {STACKTRACE
+void message_type::animate(Frame *frame) {
+  STACKTRACE;
 
 	if (num_messages &lt;= 0)
 		return;
@@ -444,8 +455,8 @@
 		}
 	else {
 		text_mode(0);
-		videosystem.window.lock();
-		bmp = videosystem.window.surface;
+		videosystem-&gt;window.lock();
+		bmp = videosystem-&gt;window.surface;
 		}
 	clean();
 	if (!frame) rectfill(bmp, 0, 0, ox, oy, 0);
@@ -456,14 +467,16 @@
 		y += text_height(font);
 		}
 	if (frame &amp;&amp; !frame-&gt;full_redraw) frame-&gt;add_box(0, 0, x, y);	
-	if (!frame) videosystem.window.unlock();
+	if (!frame) 
+	  videosystem-&gt;window.unlock();
 	ox = x;
 	oy = y;
 	return;
 	}
 message_type message;
 
-void View::_event( Event *e ) {STACKTRACE
+void View::_event( Event *e ) {
+  STACKTRACE;
 	if ( e-&gt;type == Event::VIDEO ) {
 		const VideoEvent *ve = (const VideoEvent*) e;
 		const VideoWindow *w = ve-&gt;window;
@@ -503,7 +516,8 @@
 	virtual void init(View *old);
 	//virtual void set_window (BITMAP *dest, int x, int y, int w, int h);
 	};
-void View_Hero::init(View *old) {STACKTRACE
+void View_Hero::init(View *old) {
+  STACKTRACE;
 	View::init(old);
 	f = 0;
 	min = 30;//480;
@@ -610,7 +624,8 @@
 	virtual void animate(Game *game);
 	virtual ~View_Split2a();
 	};
-void View_Split2a::init(View *old) {STACKTRACE
+void View_Split2a::init(View *old) {
+  STACKTRACE;
 	View::init(old);
 
 	min = 480;
@@ -708,7 +723,8 @@
 	virtual void animate(Game *game);
 	virtual ~View_Split2b();
 	};
-void View_Split2b::init(View *old) {STACKTRACE
+void View_Split2b::init(View *old) {
+  STACKTRACE;
 	View::init(old);
 
 	min = 480;
@@ -808,7 +824,8 @@
 	virtual void animate(Game *game);
 	virtual ~View_Split3();
 	};
-void View_Split3::init(View *old) {STACKTRACE
+void View_Split3::init(View *old) {
+  STACKTRACE;
 	View::init(old);
 
 	min = 480;
@@ -829,7 +846,8 @@
 		delete frames[i];
 	}
 }
-void View_Split3::animate(Game *game) {STACKTRACE
+void View_Split3::animate(Game *game) {
+  STACKTRACE;
 	VideoWindow *tmpw;
 	Frame *tmpf;
 	CameraPosition tmpc;
@@ -907,7 +925,8 @@
 	virtual void animate(Game *game);
 	virtual ~View_Split4();
 	};
-void View_Split4::init(View *old) {STACKTRACE
+void View_Split4::init(View *old) {
+  STACKTRACE;
 	View::init(old);
 
 	min = 480;
@@ -929,7 +948,8 @@
 		delete frames[i];
 	}
 }
-void View_Split4::animate(Game *game) {STACKTRACE
+void View_Split4::animate(Game *game) {
+  STACKTRACE;
 	VideoWindow *tmpw;
 	Frame *tmpf;
 	CameraPosition tmpc;

Modified: branches/multiplayer-branch/source/melee.h
===================================================================
--- branches/multiplayer-branch/source/melee.h	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/melee.h	2004-09-28 19:53:03 UTC (rev 71)
@@ -14,7 +14,8 @@
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.
 */
-//this is a test
+
+
 #ifndef __MELEE_H__
 #define __MELEE_H__
 
@@ -27,10 +28,11 @@
 #endif
 
 #include &lt;list&gt;
+#include &lt;string&gt;
+#include &lt;vector&gt;
 
 #ifndef PI
 #	define PI 3.14159265358979323846
-//#define PI AL_PI
 #endif
 #ifdef PI2
 #	undef PI2
@@ -50,16 +52,17 @@
 	struct BITMAP;
 	struct DATAFILE;
 #if !defined ALLEGRO_H
-		struct RGB {
-			unsigned char r, g, b, zero;
-		};
+struct RGB 
+{
+  unsigned char r, g, b, zero;
+};
 #endif
 
-	typedef RGB     Color;
-	typedef BITMAP  Surface;
+typedef RGB     Color;
+typedef BITMAP  Surface;
 
 #else
-	#error unknown platform (allegro?)
+#error unknown platform (allegro?)
 #endif
 
 #ifdef _MSC_VER
@@ -73,18 +76,14 @@
 #define random  tw_random
 #include &quot;util/round.h&quot;
 #include &quot;util/vector2.h&quot;
-#include &quot;util/sounds.h&quot;
-//#include &quot;util/aastr.h&quot;
 
 
-
-
 /*
-	error displays an error message, and prompts the user to
-	&quot;Abort&quot;, &quot;Retry&quot;, or &quot;Debug&quot;
-	on &quot;Abort&quot;, it throws 0, which will be silently caught at the closest catch (int)
-	on &quot;Retry&quot; it returns
-	on &quot;Debug&quot; it throws -1, which will be rethrown all the way out. or something roughly equivalent
+  error displays an error message, and prompts the user to
+  &quot;Abort&quot;, &quot;Retry&quot;, or &quot;Debug&quot;  
+  on &quot;Abort&quot;, it throws 0, which will be silently caught at the closest catch (int)
+  on &quot;Retry&quot; it returns on &quot;Debug&quot; it throws -1, which will be rethrown all the way out. 
+  or something roughly equivalent
 */
 #include &quot;util/errors.h&quot;
 
@@ -98,16 +97,12 @@
 //does nothing if LOTS_OF_CHECKSUMS isn't defined in libs.h)
 #ifdef _DEBUG
 #	define checksync() __checksync(__FILE__,__LINE__)
-	void __checksync( const char *fname, int line);//defined in mgame.cpp
+void __checksync( const char *fname, int line);//defined in mgame.cpp
 #else
 #	define checksync()
 #endif
 //*/
 
-class Logger;
-
-//extern DATAFILE *scppal;
-
 #define MELEE_ASTEROID          0
 #define MELEE_ASTEROIDEXPLOSION 64
 #define MELEE_BOOM              84
@@ -182,6 +177,12 @@
 extern int hot_color[HOT_COLORS];
 
 
+#define MELEE_BOOMSHIP_SOUND &quot;sound/boom/BOOMSHIP_WAV.wav&quot;
+#define MELEE_BOOM_SOUND1 &quot;sound/boom/BOOMPL01_WAV.wav&quot;
+#define MELEE_BOOM_SOUND2 &quot;sound/boom/BOOMPL01_WAV.wav&quot;
+#define MELEE_BOOM_SOUND3 &quot;sound/boom/BOOMPL01_WAV.wav&quot;
+#define MELEE_BOOM_SOUND4 &quot;sound/boom/BOOMPL01_WAV.wav&quot;
+
 //melee/mframe.h
 class Physics;
 class SpaceSprite;
@@ -251,50 +252,53 @@
 extern class GobGame *&gobgame;
 extern Vector2 map_size;
 
-extern class MeleeData meleedata;
-
 //melee/mhelpers.cpp
 
 /// \brief Config event
-class ConfigEvent : public Event {
-public:
-	const char *name;
-	union {
-		/// \brief value is read as a const char * on a SET event
-		/// value is modified by a GET event to a malloced string
-		/// BaseClass *source;
-		char *value;
-	};
-	enum {
-		GET, 
-		SET,
-		FIND
-	};
+class ConfigEvent : public Event 
+{
+ public:
+  const char *name;
+  union 
+  {
+    /// \brief value is read as a const char * on a SET event
+    /// value is modified by a GET event to a malloced string
+    /// BaseClass *source;
+    char *value;
+  };
+  enum 
+    {
+      GET, 
+      SET,
+      FIND
+    };
 };
 
-class VideoEvent : public Event {
-public:
-	class VideoWindow *window;
-	enum { 
-		/// \brief happens before surface is invalidated
-		/// before a resolution change, whatever
-		INVALID,    
-	        /// \brief the opposite of an invalid event
-		/// after an alt-tab back, after a resolution change, whatever
-		VALID,
-		/// \brief happens when size is changed
-		/// after a resolution change, or a window resize
-		/// ?? after alt-tabbing back in ??
-		RESIZE,     
-		/// \brief happens when the color format changes
-		CHANGE_BPP, 
-		/// \brief happens when contents are changed
-		/// ?? after alt-tabbing back in ??
-		/// ?? after window translated ??
-		/// ? after any resize event ?
-		REDRAW      
-	};
-	virtual int _get_size() const {return sizeof(*this);}
+/*! \brief video event */
+class VideoEvent : public Event 
+{
+ public:
+  class VideoWindow *window;
+  enum { 
+    /// \brief happens before surface is invalidated
+    /// before a resolution change, whatever
+    INVALID,    
+    /// \brief the opposite of an invalid event
+    /// after an alt-tab back, after a resolution change, whatever
+    VALID,
+    /// \brief happens when size is changed
+    /// after a resolution change, or a window resize
+    /// ?? after alt-tabbing back in ??
+    RESIZE,     
+    /// \brief happens when the color format changes
+    CHANGE_BPP, 
+    /// \brief happens when contents are changed
+    /// ?? after alt-tabbing back in ??
+    /// ?? after window translated ??
+    /// ? after any resize event ?
+    REDRAW      
+  };
+  virtual int _get_size() const {return sizeof(*this);}
 };
 extern volatile int debug_value;
 
@@ -310,86 +314,77 @@
 double scale_velocity (double velocity) ;
 double scale_acceleration (double acceleration, double hotspot_rate = 0) ;
 
-void show_file(const char *file) ;
-void show_text(const char *text) ;
-//void show_help();
+void show_file(std::string file) ;
+void show_text(std::string text) ;
 
+
+/// \brief init vidio hardware
+///
+/// sets screen resolutions, color formats, color transforms, fonts
+/// gets screen surface, records redraw event times
 class VideoWindow : public BaseClass {
-	float const_x, const_y, const_w, const_h;
-	float propr_x, propr_y, propr_w, propr_h;
+  float const_x, const_y, const_w, const_h;
+  float propr_x, propr_y, propr_w, propr_h;
+  
+  char lock_level;
+  //struct VW_lock_data *lock_data;
+  
+ public:void update_pos();
+  
+  VideoWindow *parent;
+  std::list&lt;BaseClass*&gt; callback_list;
+ public:
+  void add_callback ( BaseClass * );
+  void remove_callback ( BaseClass * );
+  virtual void _event ( Event *e );
+  
+  int x, y, w, h;
+  Surface *surface;
+  void event(int subtype);
+  void redraw() {event(VideoEvent::REDRAW);}
+  void preinit ();
+  void init ( VideoWindow *parent_window);
+  void locate ( double c_x, double p_x, double c_y, double p_y, double c_w, double p_w, double c_h, double p_h );
+  void lock();
+  void unlock();
+  void hide();
+  void match ( VideoWindow *old );
+  void deinit();
+  virtual ~VideoWindow();
+  virtual int _get_size() const {return sizeof(*this);}
+};
 
-	char lock_level;
-	//struct VW_lock_data *lock_data;
-
-public:void update_pos();
-
-	VideoWindow *parent;
-	std::list&lt;BaseClass*&gt; callback_list;
-public:
-	void add_callback ( BaseClass * );
-	void remove_callback ( BaseClass * );
-	virtual void _event ( Event *e );
-
-	int x, y, w, h;
-	Surface *surface;
-	void event(int subtype);
-	void redraw() {event(VideoEvent::REDRAW);}
-	void preinit ();
-	void init ( VideoWindow *parent_window);
-	void locate ( double c_x, double p_x, double c_y, double p_y, double c_w, double p_w, double c_h, double p_h );
-	void lock();
-	void unlock();
-	void hide();
-	void match ( VideoWindow *old );
-	void deinit();
-	virtual ~VideoWindow();
-	virtual int _get_size() const {return sizeof(*this);}
+/// Video System
+class VideoSystem : public BaseClass 
+{
+ public:
+  int width, height, bpp, gamma;
+  int fullscreen;
+  DATAFILE *font_data; //fonts
+  FONT *basic_font; //font to use if no other is available
+  Color *palette;
+  volatile bool screen_corrupted;
+  int last_poll;
+  Surface *surface;
+  VideoWindow window;
+  
+  FONT *get_font(int size);
+  
+  void preinit() ;
+  int poll_redraw();
+  int set_resolution (int width, int height, int bpp, int fullscreen) ; //returns 0 on failure
+  void set_palette(Color *pal);
+  void (*color_effects)(Color *color);
+  void update_colors();
+  void redraw();
 };
+extern VideoSystem* videosystem;
 
-class VideoSystem : public BaseClass {
-	public:
-	int width, height, bpp, gamma;
-	int fullscreen;
-	DATAFILE *font_data; //fonts
-	FONT *basic_font; //font to use if no other is available
-	Color *palette;
-	volatile bool screen_corrupted;
-	int last_poll;
-	Surface *surface;
-	VideoWindow window;
-
-	FONT *get_font(int size);
-
-	void preinit() ;
-	int poll_redraw();
-	int set_resolution (int width, int height, int bpp, int fullscreen) ; //returns 0 on failure
-	void set_palette(Color *pal);
-	void (*color_effects)(Color *color);
-	void update_colors();
-	void redraw();
-} extern videosystem;
-
 int get_gamma();
 void set_gamma(int gamma);
 void gamma_color_effects (Color *color) ;
 
 
-struct registered_file_type {
-	char *fname;
-	char *fdate;
-	char *ftime;
-	};
-extern registered_file_type *registered_files;
-extern int num_registered_files;
-void _register_file (char *fname, char *fdate, char *ftime);
-
-#ifdef _DEBUG
-#	define REGISTER_FILE static const char *__registered_filename = __FILE__; static void __ignore_me_rf() {_register_file(__FILE__, __DATE__, __TIME__);} CALL_BEFORE_MAIN(__ignore_me_rf);
-#else
-#	define REGISTER_FILE static void __ignore_me_rf() {_register_file(__FILE__, __DATE__, __TIME__);} CALL_BEFORE_MAIN(__ignore_me_rf);
-#endif
-
-
 void init_ships();
 
 //mmath.h
@@ -435,107 +430,98 @@
 void animate_bmp(BITMAP *bmp, Vector2 pos, Frame *space);
 
 
-class SpaceSprite {
-	public:
-	static int mip_min, mip_max, mip_bias;
-	protected:
-	enum { MAX_MIP_LEVELS = 8 };
-	int         count;
-	char bpp;
-	char highest_mip;
-	int originaltype;
-	int         w;
-	int         h;
-	struct PMASK **m;
-	Surface **b[MAX_MIP_LEVELS];
+class SpaceSprite 
+{
+ public:
+  static int mip_min, mip_max, mip_bias;
+ protected:
+  enum { MAX_MIP_LEVELS = 8 };
+  int  count;
+  char bpp;
+  char highest_mip;
+  int originaltype;
+  int w;
+  int h;
+  struct PMASK **m;
+  Surface **b[MAX_MIP_LEVELS];
 
-	//char *type;
-	int references;
-	char *attributes;
-	enum { DEALLOCATE_IMAGE = 0x01, DEALLOCATE_MASK = 0x02 };
-	unsigned int general_attributes;
-	public:
-	enum {
-		MATCH_SCREEN_FORMAT = 0x001, 
-		IRREGULAR           = 0x002, 
-		MIPMAPED            = 0x004, 
+  int references;
+  char *attributes;
+  enum 
+    { 
+      DEALLOCATE_IMAGE  = (1&lt;&lt;0), 
+      DEALLOCATE_MASK   = (1&lt;&lt;2) 
+    };
+  unsigned int general_attributes;
+ public:
+  enum {
+    MATCH_SCREEN_FORMAT = (1&lt;&lt;0), 
+    IRREGULAR           = (1&lt;&lt;1), 
+    MIPMAPED            = (1&lt;&lt;2), 
+    
+    MASKED              = (1&lt;&lt;3), 
+    ALPHA               = (1&lt;&lt;4), 
+    DITHER              = (1&lt;&lt;5),
+    NO_AA               = (1&lt;&lt;6),
+    
+    NONE = 0
+  };
+  //sprite_count * rotation new images based upon sprite_count RLE_SPRITES, with gamma correction
+  SpaceSprite(const DATAFILE *sprites, int sprite_count, int attributes = -1, int rotations = 1);
+  SpaceSprite(BITMAP *image, int _attributes = -1);
+  SpaceSprite(SpaceSprite &amp;old);
+ 
+  SpaceSprite( std::vector&lt;std::string&gt; bmplist, int sprite_count,  
+	       int _attributes = -1, 
+	       int rotations =1);
+  virtual ~SpaceSprite();
+  
+  
+  /// method for direct access:
+  Surface     *get_bitmap(int index, int miplevel = 0);
+  /// method for direct access:
+  Surface     *get_bitmap_readonly(int index);
+  const struct PMASK *get_pmask(int index) {return m[index];}
+  void lock();	///&lt; make surface writable
+  void unlock();
+  
+  void overlay ( int index1, int index2, Surface *dest);
 
-		MASKED              = 0x100, 
-		ALPHA               = 0x200, 
-		DITHER              = 0x400,
-		NO_AA               = 0x800,
+  void draw(Vector2 pos, Vector2 size, int index, Frame *frame) ;
+  void draw(Vector2 pos, Vector2 size, int index, Surface *bmp) ;
+  void draw(int x, int y, int index, Surface *bmp) ;
 
-		NONE = 0
-	};
-	//sprite_count * rotation new images based upon sprite_count RLE_SPRITES, with gamma correction
-	SpaceSprite(const DATAFILE *sprites, int sprite_count, int attributes = -1, int rotations = 1);
-	SpaceSprite(BITMAP *image, int _attributes = -1);
-	SpaceSprite(SpaceSprite &amp;old);
-//	SpaceSprite(const char *sourcename, const char *spritename);
-	// added GEO    (should be deleted)
-//	SpaceSprite::SpaceSprite(char *bmpfilename, int _attributes);
-	// added GEO
-	SpaceSprite::SpaceSprite(BITMAP **bmplist, int sprite_count, int rotations, int _attributes);
+  // added GEO
+  virtual void animate(Vector2 pos, int index, Frame *space, double scale = 1);
+  void animate_character(Vector2 pos, int index, int color, Frame *space, double scale = 1);
 
-	virtual ~SpaceSprite();
 
+  void draw_character(int x, int y, int index, int color, Surface *bmp);
+  void draw_character(int x, int y, int index, int color, Frame *space);
+  void draw_character(int x, int y, int w, int h, int index, int color, Surface *bmp);
+  void draw_character(int x, int y, int w, int h, int index, int color, Frame *space);
+  
+  void generate_mipmaps();
+  void regenerate_mipmaps();
+  
+  void permanent_phase_shift ( int index );
+  
+  virtual void change_color_depth(int dest);
+  
+  int collide(int x, int y, int i, int ox, int oy, int oi,
+	      SpaceSprite *other);
+  int collide_ray(int lx1, int ly1, int *lx2, int *ly2, int sx, int sy,
+		  int sindex);
 
-//methods for direct access:
-	Surface     *get_bitmap(int index, int miplevel = 0);
-	Surface     *get_bitmap_readonly(int index);
-	const struct PMASK *get_pmask(int index) {return m[index];}
-	void lock();	//make surface writable
-	void unlock();
-
-	void overlay ( int index1, int index2, Surface *dest);
-
-	void draw(Vector2 pos, Vector2 size, int index, Frame *frame) ;
-	void draw(Vector2 pos, Vector2 size, int index, Surface *bmp) ;
-	//void draw(double x, double y, int index, Frame *frame) ;
-	//void draw(double x, double y, int index, Surface *bmp) ;
-	//void draw(int x, int y, int w, int h, int index, Frame *frame) ;
-	//void draw(int x, int y, int w, int h, int index, Surface *bmp) ;
-	//void draw(int x, int y, int index, Frame *frame) ;
-	void draw(int x, int y, int index, Surface *bmp) ;
-
-	// added GEO
-	virtual void animate(Vector2 pos, int index, Frame *space, double scale = 1);
-	void animate_character(Vector2 pos, int index, int color, Frame *space, double scale = 1);
-
-
-	void draw_character(int x, int y, int index, int color, Surface *bmp);
-	void draw_character(int x, int y, int index, int color, Frame *space);
-	void draw_character(int x, int y, int w, int h, int index, int color, Surface *bmp);
-	void draw_character(int x, int y, int w, int h, int index, int color, Frame *space);
-
-	void generate_mipmaps();
-	void regenerate_mipmaps();
-
-	void permanent_phase_shift ( int index );
-
-	virtual void change_color_depth(int dest);
-
-	int collide(int x, int y, int i, int ox, int oy, int oi,
-			SpaceSprite *other);
-	int collide_ray(int lx1, int ly1, int *lx2, int *ly2, int sx, int sy,
-			int sindex);
-
-	INLINE int frames() const {return count;}
-	// changed Rob.
-	Vector2  size(int i = 0) const;//   const {return Vector2(b[0][i]-&gt;w, b[0][i]-&gt;h);}
-	int      width()  const {return w;}
-	int      height() const {return h;}
+  INLINE int frames() const {return count;}
+  // changed Rob.
+  Vector2  size(int i = 0) const; 
+  int      width()  const {return w;}
+  int      height() const {return h;}
 };
 
-int string_to_sprite_attributes ( const char *s, int recommended = SpaceSprite::MASKED | SpaceSprite::MATCH_SCREEN_FORMAT | SpaceSprite::MIPMAPED) ;
+int string_to_sprite_attributes ( const char *s, int recommended = SpaceSprite::MASKED | SpaceSprite::MATCH_SCREEN_FORMAT | SpaceSprite::MIPMAPED);
 
-
-
-
-
-
-
-
 //melee/mship
 
 struct ShipClass {
@@ -554,21 +540,16 @@
 #define REGISTER_SHIP(ship) static Ship *get_shipclass_ ## ship (Vector2 pos, double a, ShipData *d, unsigned int c){return(new ship(pos,a,d,c));} static void __register_shipclass_ ## ship () {register_shipclass(#ship, __FILE__, &amp;get_shipclass_ ## ship);} CALL_BEFORE_MAIN(__register_shipclass_ ## ship);
 
 
-//extern ShipData **shipdatas;
-//extern int num_shipdatas;
-//ShipData *shipdata( const char *file );
-
-
 struct ShipType {
-	const char *id;
-	const char *file;
-	const char *name;
-	const char *text;
-	int cost;
-	ShipData  *data;
-	ShipClass *code;
-	Ship *get_ship(Vector2 pos, double angle, unsigned int team);
-	int origin;
+  const char *id;
+  const char *file;
+  const char *name;
+  const char *text;
+  int cost;
+  ShipData  *data;
+  ShipClass *code;
+  Ship *get_ship(Vector2 pos, double angle, unsigned int team);
+  int origin;
 };
 extern ShipType *shiptypes;
 extern int num_shiptypes;
@@ -578,68 +559,69 @@
 //melee/mshpdata
 extern int auto_unload;
 
-ShipData *shipdata ( const char *file ) ;
+ShipData *shipdata ( std::string inifile ) ;
 void unload_all_ship_data() ;
-void unload_unused_ship_data() ;
 
-class ShipData {
-	enum { 
-		LOADED_NONE,
-		LOADED_FULL,
-		LOADED_PARTIAL,
-		LOADED_MINIMAL
-	};
-	int references;
-	public:
-	int status;
-	char *file;
-	void lock();
-	void unlock();
-	void load();
-	void unload();
-	DATAFILE    *data;
-//	int num_panel_bitmaps;
-//	Surface     **bitmapPanel;
-	SpaceSprite *spritePanel;
-	SpaceSprite *spriteShip;
-	SpaceSprite *spriteWeapon;
-	SpaceSprite *spriteWeaponExplosion;
-	SpaceSprite *spriteSpecial;
-	SpaceSprite *spriteSpecialExplosion;
-	SpaceSprite *spriteExtra;
-	SpaceSprite *spriteExtraExplosion;
+/*! \brief Sprites, samples - can be in loaded or unloaded state 
+  
+    Note: in future this class will contain only string to data files, all datas will
+    actully be in SoundSystem and VideoSystem classes
+*/ 
+class ShipData 
+{
+  enum { 
+    LOADED_NONE,
+    LOADED_FULL,
+    LOADED_PARTIAL,
+    LOADED_MINIMAL
+  };
+  int references;
+ public:
+  int status;
+  std::string ini;
 
-	int num_more_sprites;
-	SpaceSprite **more_sprites;
+  void lock();
+  void unlock();
+  void load();
+  void unload();
 
-	int num_weapon_samples;
-	Sound     **sampleWeapon;
-	int num_special_samples;
-	Sound     **sampleSpecial;
-	int num_extra_samples;
-	Sound     **sampleExtra;
+  SpaceSprite *spritePanel;
+  SpaceSprite *spriteShip;
+  SpaceSprite *spriteWeapon;
+  SpaceSprite *spriteWeaponExplosion;
+  SpaceSprite *spriteSpecial;
+  SpaceSprite *spriteSpecialExplosion;
+  SpaceSprite *spriteExtra;
+  SpaceSprite *spriteExtraExplosion;
+  
+  int num_more_sprites;
+  SpaceSprite **more_sprites;
+  
+  std::vector&lt;std::string&gt; sampleWeapon;
+  std::vector&lt;std::string&gt; sampleSpecial;
+  std::vector&lt;std::string&gt; sampleExtra;
+  
+  std::string moduleVictory;
+  
+  ShipData(std::string inifile);
+  ~ShipData();
+};
 
-	Music       *moduleVictory;
-
-	ShipData(const char *filename);
-	~ShipData();
-	};
-
 //gui.h
 class TW_Dialog_Player : public BaseClass {
 public:
-	struct DIALOG_PLAYER *player;
-	struct DIALOG *dialog;
-	struct BITMAP *subscreen;
-	int *old_sizes;
-	TW_Dialog_Player *prev_level;
-	int length, level, ifocus;
-	VideoWindow *window;
-	void init ( VideoWindow *window, DIALOG *dialog, int index = 0);
-	int update ();
-	void redraw ();
-	void deinit ();
-	virtual void _event( Event * e);
+  struct DIALOG_PLAYER *player;
+  struct DIALOG *dialog;
+  struct BITMAP *subscreen;
+  int *old_sizes;
+  TW_Dialog_Player *prev_level;
+  int length, level, ifocus;
+  VideoWindow *window;
+  void init ( VideoWindow *window, DIALOG *dialog, int index = 0);
+  int update ();
+  void redraw ();
+  void deinit ();
+  virtual void _event( Event * e);
 };
 struct DIALOG;
 int tw_do_dialog ( VideoWindow *window, DIALOG *d, int index );

Modified: branches/multiplayer-branch/source/other/dialogs.cpp
===================================================================
--- branches/multiplayer-branch/source/other/dialogs.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/other/dialogs.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -108,7 +108,20 @@
   { d_tw_yield_proc,   0,    0,    0,    0,    255,  0,    0,    0,       0,    0,    NULL, NULL, NULL },
   { NULL,              0,    0,    0,    0,    255,  0,    0,    0,       0,    0,    NULL, NULL, NULL }
 };
+DIALOG tw_alert_dialog5[] = {
+  // (dialog proc)     (x)   (y)   (w)   (h)   (fg)  (bg)  (key) (flags)  (d1)  (d2)  (dp)
+  { d_agup_box_proc,        180,  170,  380,  140,  255,  0,    0,    0,       0,    0,    NULL, NULL, NULL },
+  { d_agup_textbox_proc,    185,  175,  370,  95,   255,  0,    0,    0,       80,   0,    NULL, NULL, NULL },
+  { d_agup_button_proc,     190,  280,  55,   20,   255,  0,    0,    D_EXIT,  0,    0,    NULL, NULL, NULL },
+  { d_agup_button_proc,     255,  280,  55,   20,   255,  0,    0,    D_EXIT,  0,    0,    NULL, NULL, NULL },
+  { d_agup_button_proc,     320,  280,  55,   20,   255,  0,    0,    D_EXIT,  0,    0,    NULL, NULL, NULL },
+  { d_agup_button_proc,     385,  280,  55,   20,   255,  0,    0,    D_EXIT,  0,    0,    NULL, NULL, NULL },  
+  { d_agup_button_proc,     450,  280,  100,  20,   255,  0,    0,    D_EXIT,  0,    0,    NULL, NULL, NULL },
+  { d_tw_yield_proc,   0,    0,    0,    0,    255,  0,    0,    0,       0,    0,    NULL, NULL, NULL },
+  { NULL,              0,    0,    0,    0,    255,  0,    0,    0,       0,    0,    NULL, NULL, NULL }
+};
 
+
 DIALOG selectDialog[] = {
 	// (dialog proc)     (x)   (y)   (w)   (h)   (fg)  (bg)  (key) (flags)  (d1)  (d2)  (dp)
 	{ my_list_proc,      5,     5,   280,  400,  255,  0,    0,    D_EXIT,  0,    0,    (void *)fleetListboxGetter, NULL, NULL },
@@ -264,13 +277,13 @@
 // MELEE_EX - dialog structure
 DIALOG melee_ex_dialog[] = {
   // (dialog proc)     (x)  (y)   (w)   (h)   (fg)  (bg)  (key) (flags)  (d1)  (d2)  (dp)
-  { d_shadow_box_proc, 40,  40,   240,  160,  255,  0,    0,    0,       0,    0,    NULL, NULL, NULL },
+  { d_shadow_box_proc, 40,  40,   240,  185,  255,  0,    0,    0,       0,    0,    NULL, NULL, NULL },
   { my_d_button_proc,  50,   50,  190,  20,   255,  0,    0,    D_EXIT,  0,    0,    (void *)&quot;Play Game&quot; , NULL, NULL },
   { my_d_button_proc,  50,   75,  190,  20,   255,  0,    0,    D_EXIT,  0,    0,    (void *)&quot;Key Tester&quot;, NULL, NULL },
-//  { my_d_button_proc,  50,  100,  190,  20,   255,  0,    0,    D_EXIT,  0,    0,    (void *)&quot;Ship Info&quot;, NULL, NULL },
-  { my_d_button_proc,  50,  100,  190,  20,   255,  0,    0,    D_EXIT,  0,    0,    (void *)&quot;Show License&quot;, NULL, NULL },
-  { my_d_button_proc,  50,  125,  190,  20,   255,  0,    0,    D_EXIT,  0,    0,    (void *)&quot;Diagnostics&quot;, NULL, NULL },
-  { my_d_button_proc,  80,  150,  190,  30,   255,  0,    0,    D_EXIT,  0,    0,    (void *)&quot;Main Menu&quot;, NULL, NULL },
+  { my_d_button_proc,  50,  100,  190,  20,   255,  0,    0,    D_EXIT,  0,    0,    (void *)&quot;Ship Info&quot;, NULL, NULL },
+  { my_d_button_proc,  50,  125,  190,  20,   255,  0,    0,    D_EXIT,  0,    0,    (void *)&quot;Show License&quot;, NULL, NULL },
+  { my_d_button_proc,  50,  150,  190,  20,   255,  0,    0,    D_EXIT,  0,    0,    (void *)&quot;Diagnostics&quot;, NULL, NULL },
+  { my_d_button_proc,  80,  175,  190,  30,   255,  0,    0,    D_EXIT,  0,    0,    (void *)&quot;Main Menu&quot;, NULL, NULL },
   { d_tw_yield_proc,   0,   0,    0,    0,    255,  0,    0,    0,       0,    0,    NULL, NULL, NULL },
   { NULL,              0,   0,    0,    0,    255,  0,    0,    0,       0,    0,    NULL, NULL, NULL }
 };

Modified: branches/multiplayer-branch/source/other/dialogs.h
===================================================================
--- branches/multiplayer-branch/source/other/dialogs.h	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/other/dialogs.h	2004-09-28 19:53:03 UTC (rev 71)
@@ -72,6 +72,7 @@
 extern DIALOG tw_alert_dialog2[];
 extern DIALOG tw_alert_dialog3[];
 extern DIALOG tw_alert_dialog4[];
+extern DIALOG tw_alert_dialog5[];
 
 enum {
 	SELECT_DIALOG_LIST = 0,

Copied: branches/multiplayer-branch/source/other/gup.cpp (from rev 69, trunk/source/other/gup.cpp)

Copied: branches/multiplayer-branch/source/other/gup.h (from rev 69, trunk/source/other/gup.h)

Modified: branches/multiplayer-branch/source/other/nullphas.cpp
===================================================================
--- branches/multiplayer-branch/source/other/nullphas.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/other/nullphas.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;melee.h&quot;
-REGISTER_FILE
 #include &quot;melee/mgame.h&quot;
 #include &quot;nullphas.h&quot;
 
@@ -25,11 +24,13 @@
   oship-&gt;size, unit_vector( oship-&gt;get_angle()) * PHASE_MAX * oship-&gt;size,
   oship, oship-&gt;get_sprite(), oship-&gt;get_sprite_index(), hot_color, HOT_COLORS,
   PHASE_DELAY, PHASE_MAX, PHASE_DELAY ){
+  STACKTRACE;
 }
 
-void NullPhaser::animate( Frame* space ){}
+void NullPhaser::animate( Frame* space ){
+  STACKTRACE;}
 void NullPhaser::calculate(){
-	STACKTRACE
+  STACKTRACE;
 
   if( state &gt; 0 ){
     game-&gt;add( ship );

Modified: branches/multiplayer-branch/source/other/objanim.cpp
===================================================================
--- branches/multiplayer-branch/source/other/objanim.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/other/objanim.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;melee.h&quot;
-REGISTER_FILE
 
 #include &quot;objanim.h&quot;
 
@@ -26,6 +25,7 @@
 Animation( creator, opos, osprite, first_frame, num_frames, frame_size, depth ),
   angle(oangle)
 {
+  STACKTRACE;
   vel = ovel;
 
   sprite_index = get_index(angle);
@@ -33,7 +33,7 @@
 }
 
 void ObjectAnimation::calculate(){
-	STACKTRACE
+  STACKTRACE;
 
   sprite_index &gt;&gt;= 6;
   Animation::calculate();

Modified: branches/multiplayer-branch/source/other/orbit.cpp
===================================================================
--- branches/multiplayer-branch/source/other/orbit.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/other/orbit.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -18,7 +18,6 @@
 #include &lt;stdio.h&gt;
 #include &lt;allegro.h&gt;
 #include &quot;melee.h&quot;
-REGISTER_FILE
 #include &quot;id.h&quot;
 #include &quot;scp.h&quot;
 #include &quot;frame.h&quot;
@@ -46,7 +45,7 @@
 
 int SpaceStation::handle_damage(SpaceLocation *source, double normal, double direct)
 {
-	STACKTRACE
+  STACKTRACE;
 
 	Crew-=(int)(normal+direct);
 	if(Crew&lt;=0) state=0;
@@ -55,7 +54,7 @@
 
 void SpaceStation::calculate()
 {
-	STACKTRACE
+  STACKTRACE;
 
 	//Healing beam code
 
@@ -75,6 +74,7 @@
 SpaceStation::SpaceStation(SpaceLocation *creator, Vector2 opos,
 	SpaceSprite *oSprite):SpaceObject(creator,opos,0.,oSprite)
 {
+  STACKTRACE;
 //	layer=LAYER_SPECIAL;
 	mass=10.;
 	Crew=2000;
@@ -87,6 +87,7 @@
 	double lrad, double lspeed, int iLock):SpaceLocation(creator,
 	lpos, 0.)
 {
+  STACKTRACE;
 	id=ORBIT_ID;
 	ipos=lpos;
 	Lock=iLock;
@@ -104,7 +105,7 @@
 
 void OrbitHandler::calculate()
 {
-	STACKTRACE
+  STACKTRACE;
 
 	if((sun==NULL)||(plan==NULL))
 		return;
@@ -143,6 +144,7 @@
 
 int OrbitHandler::canCollide(SpaceLocation *other)
 {
+  STACKTRACE;
 	return FALSE;
 }
 
@@ -150,6 +152,7 @@
 	:
 	SpaceObject(NULL, opos, 0.0, sprite)
 	{
+  STACKTRACE;
 
 	layer = LAYER_SHOTS;
 	set_depth(LAYER_EXPLOSIONS);
@@ -176,7 +179,7 @@
 
 int Sun::canCollide(SpaceLocation *other)
 {
-	STACKTRACE
+  STACKTRACE;
 
 	if(other-&gt;id==COMET_ID) return FALSE;
 	return(!other-&gt;isPlanet());
@@ -184,7 +187,7 @@
 
 void Sun::inflict_damage(SpaceObject *other)
 {
-	STACKTRACE
+  STACKTRACE;
 
 	double d = distance(other);
 	if (d &gt;= Range) return;
@@ -196,7 +199,7 @@
 }
 
 void Sun::calculate() {
-	STACKTRACE
+  STACKTRACE;
 
 	SpaceObject::calculate();
 	SpaceObject *o;

Modified: branches/multiplayer-branch/source/other/planet3d.cpp
===================================================================
--- branches/multiplayer-branch/source/other/planet3d.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/other/planet3d.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -17,7 +17,6 @@
 
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 #include &quot;melee/mview.h&quot;
 
 #include &quot;util/pmask.h&quot;
@@ -31,6 +30,7 @@
 
 SpaceSprite::SpaceSprite(BITMAP *image, int _attributes)
 {
+  STACKTRACE;
   if (_attributes == -1) 
     _attributes = string_to_sprite_attributes(NULL);
   general_attributes = _attributes;
@@ -71,8 +71,8 @@
     
   // create a 2D planet
   Planet *planet = new Planet (position, 
-			       meleedata.planetSprite, 
-			       random(meleedata.planetSprite-&gt;frames()));
+			       game-&gt;meleedata.planetSprite, 
+			       random(game-&gt;meleedata.planetSprite-&gt;frames()));
   game-&gt;add (planet);
   return planet;
 }

Modified: branches/multiplayer-branch/source/other/radar.cpp
===================================================================
--- branches/multiplayer-branch/source/other/radar.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/other/radar.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -17,7 +17,6 @@
 
 #include &lt;allegro.h&gt;
 #include &quot;melee.h&quot;
-REGISTER_FILE
 #include &quot;id.h&quot;
 #include &quot;scp.h&quot;
 #include &quot;frame.h&quot;
@@ -33,16 +32,19 @@
 
 void ZRadar::toggleActive()
 {
+  STACKTRACE;
 	active^=1;
 }
 
 void ZRadar::setSize(double Size)
 {
+  STACKTRACE;
 	size=Size;
 }
 
 void ZRadar::setTarget(SpaceLocation *target)
 {
+  STACKTRACE;
 	t=target;
 }
 
@@ -53,6 +55,7 @@
 
 ZRadar::ZRadar(BITMAP *BlankSlate, Presence *target, double Size)
 {
+  STACKTRACE;
 	Blank=BlankSlate;
 	Painted = create_bitmap_ex(bitmap_color_depth(screen),Blank-&gt;w,Blank-&gt;h);
 	t=target;
@@ -63,13 +66,14 @@
 
 double ZRadar::shiftscale(double r_center, double v_center, double scale, double n)
 {
+  STACKTRACE;
 	//Used to scale game coordinates onto RADAR screen coordinates
 	return(((n - r_center)*scale)+v_center);
 }
 
 void ZRadar::animate(Frame *space)
 {
-	STACKTRACE
+  STACKTRACE;
 
 	//If the radar is disabled, don't do anything.
 	if(active==FALSE) return;

Modified: branches/multiplayer-branch/source/other/shippart.cpp
===================================================================
--- branches/multiplayer-branch/source/other/shippart.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/other/shippart.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -18,7 +18,6 @@
 
 #include &quot;ship.h&quot;
 #include &quot;melee/mview.h&quot;
-REGISTER_FILE
 
 #include &lt;stdio.h&gt;
 
@@ -34,6 +33,7 @@
 :
 Ship(opos, shipAngle, shipData, code)
 {
+  STACKTRACE;
 	// remove this from the physics interaction
 	//mass = 0;
 	collide_flag_anyone = 0;
@@ -46,7 +46,7 @@
 
 void BigShip::calculate()
 {
-	STACKTRACE
+  STACKTRACE;
 
 	// make sure the &quot;ship&quot; is not a real target
 	if (targets-&gt;isintargetlist(this))
@@ -71,7 +71,7 @@
 // change velocities of the ship and all its parts
 void BigShip::change_vel(Vector2 dvel)
 {
-	STACKTRACE
+  STACKTRACE;
 
 	int i;
 
@@ -89,7 +89,7 @@
 // change positions of the ship and all its parts
 void BigShip::change_pos(Vector2 dpos)
 {
-	STACKTRACE
+  STACKTRACE;
 
 	int i;
 
@@ -107,6 +107,7 @@
 
 void BigShip::animate(Frame *space)
 {
+  STACKTRACE;
 	return;
 }
 
@@ -121,6 +122,7 @@
 :
 Ship(aowner, 0, 0, spr)
 {
+  STACKTRACE;
 	owner = aowner;
 	relpos = orelpos;
 	relangle = orelangle;
@@ -165,7 +167,7 @@
 
 void BigShipPart::syncpos()
 {
-	STACKTRACE
+  STACKTRACE;
 
 	// maintain (relative) position wrt the ship
 	angle = owner-&gt;angle + relangle;	// this is the discrete angle (64 values).
@@ -187,7 +189,7 @@
 
 void BigShipPart::calculate()
 {
-	STACKTRACE
+  STACKTRACE;
 
 	if ( !(owner &amp;&amp; owner-&gt;exists()) )
 	{
@@ -233,7 +235,7 @@
 
 int BigShipPart::handle_damage(SpaceLocation *source, double normal, double direct)
 {
-	STACKTRACE
+  STACKTRACE;
 
 	// by default, transmit damage to the ship owner ...
 	return owner-&gt;handle_damage(source, normal, direct);
@@ -243,7 +245,7 @@
 
 void BigShipPart::inflict_damage(SpaceObject *other)
 {
-	STACKTRACE
+  STACKTRACE;
 
 	Ship::inflict_damage(other);
 
@@ -255,6 +257,7 @@
 
 bool BigShipPart::isdisabled()
 {
+  STACKTRACE;
 	return false;
 }
 
@@ -263,7 +266,7 @@
 // change velocities of the ship and all its parts
 void BigShipPart::change_vel(Vector2 dvel)
 {
-	STACKTRACE
+  STACKTRACE;
 
 	owner-&gt;change_vel(dvel);
 }
@@ -271,7 +274,7 @@
 // change positions of the ship and all its parts
 void BigShipPart::change_pos(Vector2 dpos)
 {
-	STACKTRACE
+  STACKTRACE;
 
 	owner-&gt;change_pos(dpos);
 }
@@ -283,6 +286,7 @@
 :
 SpaceObject(aownerpart, aownerpart-&gt;pos, aownerpart-&gt;angle, ospr)
 {
+  STACKTRACE;
 	ownerpart = aownerpart;
 
 	layer = LAYER_SHIPS;
@@ -301,7 +305,7 @@
 
 void BigShipPartDevice::calculate()
 {
-	STACKTRACE
+  STACKTRACE;
 
 	if ( !(ownerpart &amp;&amp; ownerpart-&gt;exists()) )
 	{
@@ -323,7 +327,7 @@
 
 void BigShipPartDevice::animate(Frame *space)
 {
-	STACKTRACE
+  STACKTRACE;
 
 	if (ownerpart-&gt;isdisabled())
 		return;
@@ -335,7 +339,7 @@
 
 int BigShipPart::handle_fuel_sap(SpaceLocation *source, double normal)
 {
-	STACKTRACE
+  STACKTRACE;
 
 	return owner-&gt;handle_fuel_sap(source, normal);
 }
@@ -344,6 +348,7 @@
 
 ShipType *BigShipPart::get_shiptype()
 {
+  STACKTRACE;
 	// this is necessary, otherwise the Kat Poly ship crashes.
 	// also, &quot;type&quot; cannot be redirected inside the constructor, cause the
 	// parents' type is declared outside of its constructor (bad?).

Modified: branches/multiplayer-branch/source/other/twconfig.cpp
===================================================================
--- branches/multiplayer-branch/source/other/twconfig.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/other/twconfig.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -28,16 +28,13 @@
 #include &quot;melee/mfleet.h&quot;
 #include &quot;util/aastr.h&quot;
 
-void tw_set_config_file(const char *filename)
+void tw_set_config_file(std::string filename)
 {
   std::string file = home_ini_full_path(filename); 
-  //if(exists(file.c_str()))
-    set_config_file(file.c_str());
-  //  else
-  //  tw_error(&quot;File %s does not exist&quot;, file.c_str());
+  set_config_file(file.c_str());
 }
 
-int tw_delete_file(const char * filename)
+int tw_delete_file(std::string filename)
 {
   return delete_file(home_ini_full_path(filename).c_str());
 }
@@ -56,7 +53,8 @@
   char *item;
   char *section;
   char file[1024];
-  if (strlen(name) &gt; 1000) error(&quot;_get_ini_string - name too long&quot;);
+  if (strlen(name) &gt; 1000) 
+    tw_error(&quot;_get_ini_string - name too long&quot;);
   strncpy (file, name, 1000);
   char *_slash[2];
   _slash[0] = strchr(file, '/');
@@ -95,7 +93,8 @@
   char *item;
   char *section;
   char file[1024];
-  if (strlen(name) &gt; 1000) error(&quot;_set_ini_string - name too long&quot;);
+  if (strlen(name) &gt; 1000) 
+    tw_error(&quot;_set_ini_string - name too long&quot;);
   strncpy (file, name, 1000);
   char *_slash[2];
   _slash[0] = strchr(file, '/');
@@ -141,7 +140,8 @@
       //else if (!strncmp(item, &quot;/dev/&quot;, 5)) type = DEV;
       else if (!strncmp(item, &quot;/ini/&quot;, 5)) type = INI;
       else if (!strncmp(item, &quot;/cfg/&quot;, 5)) type = CFG;
-      else error(&quot;twconfig_get_string - unknown prefix&quot;);
+      else 
+	tw_error(&quot;twconfig_get_string - unknown prefix&quot;);
     }
   else type = NORMAL;
   ConfigEvent ce;
@@ -186,10 +186,12 @@
   if (*item == '/') 
     {
       if (0) ;
-      //else if (!strncmp(item, &quot;/dev/&quot;, 5)) type = DEV;
-      else if (!strncmp(item, &quot;/ini/&quot;, 5)) type = INI;
-      else if (!strncmp(item, &quot;/cfg/&quot;, 5)) type = CFG;
-      else error(&quot;twconfig_get_string - unknown prefix&quot;);
+      else if (!strncmp(item, &quot;/ini/&quot;, 5)) 
+	type = INI;
+      else if (!strncmp(item, &quot;/cfg/&quot;, 5)) 
+	type = CFG;
+      else 
+	tw_error(&quot;twconfig_get_string - unknown prefix&quot;);
     }
   else type = NORMAL;
   ConfigEvent ce;

Modified: branches/multiplayer-branch/source/other/twconfig.h
===================================================================
--- branches/multiplayer-branch/source/other/twconfig.h	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/other/twconfig.h	2004-09-28 19:53:03 UTC (rev 71)
@@ -17,9 +17,11 @@
 
 #ifndef TWCONFIG_H
 
-void tw_set_config_file(const char * filename);
-int tw_delete_file(const char * filename);
+#include &lt;string&gt;
 
+void tw_set_config_file(std::string filename);
+int tw_delete_file(std::string filename);
+
 const char *twconfig_get_string (const char *item);
 //string destroyed by next call to twconfig_get_*
 void   twconfig_set_string (const char *item, const char *value);
@@ -28,4 +30,6 @@
 void   twconfig_set_float ( const char *item, double value );
 double twconfig_get_float ( const char *item );
 
+std::string make_name_by_index (int index, std::string name, std::string ext );
+
 #endif // TWCONFIG_H

Modified: branches/multiplayer-branch/source/other/vbodies.cpp
===================================================================
--- branches/multiplayer-branch/source/other/vbodies.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/other/vbodies.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -15,13 +15,13 @@
 GNU General Public License for more details.
 */
 
+#include &quot;util/sound.h&quot;
 #include &lt;allegro.h&gt;
 #include &lt;string.h&gt;
 #include &lt;stdio.h&gt;
 
 
 #include &quot;melee.h&quot;
-REGISTER_FILE
 #include &quot;id.h&quot;
 #include &quot;scp.h&quot;
 #include &quot;frame.h&quot;
@@ -206,17 +206,21 @@
 
 //end sprite handling routines
 
-VSpaceInstallation::VSpaceInstallation():SpaceObject(NULL, random(map_size), random(PI2), meleedata.asteroidSprite)
+VSpaceInstallation::VSpaceInstallation():SpaceObject(NULL, random(map_size), 
+						     random(PI2), game-&gt;meleedata.asteroidSprite)
 {
+  STACKTRACE;
 	collide_flag_sameteam = ALL_LAYERS;
 	collide_flag_sameship = ALL_LAYERS;
 	layer = LAYER_CBODIES;
 	set_depth(DEPTH_ASTEROIDS);
 }
 
-void VSpaceInstallation::Initialize(void) {;}
+void VSpaceInstallation::Initialize(void) {
+  STACKTRACE;;}
 
 void VSpaceInstallation::Initialize(const char* nameInIni) {
+  STACKTRACE;
 	game-&gt;log_file (&quot;vobject.ini&quot;);
   this-&gt;armour = get_config_float(nameInIni, &quot;Armour&quot;, 0);
   this-&gt;mass = get_config_float(nameInIni, &quot;Mass&quot;, 0);
@@ -224,6 +228,7 @@
 }
 
 bool VSpaceInstallation::AddInstallation(VGroundInstallation* oGI) {
+  STACKTRACE;
   int i;
   for(i=0;i&lt;12;i++) {
     if(this-&gt;Installation[i]==NULL) {
@@ -237,10 +242,12 @@
 }
 
 void VSpaceInstallation::calculate(void) {
+  STACKTRACE;
 	this-&gt;vel *= (1 - this-&gt;friction * game-&gt;frame_time);
 }
 
 void VSpaceInstallation::death() {
+  STACKTRACE;
   int i;
   for(i=0;i&lt;12;i++)
     if(this-&gt;Installation[i]!=NULL)
@@ -248,6 +255,7 @@
 }
 
 int VSpaceInstallation::handle_damage(SpaceLocation* source, double normal, double direct) {
+  STACKTRACE;
   message.print(500,5,&quot;Installation armour=%d&quot;, (long int)armour);
   if(source-&gt;isAsteroid()) return(0);
   armour -= (normal + direct);
@@ -257,45 +265,54 @@
 
 
 VDefSat::VDefSat() {
+  STACKTRACE;
   this-&gt;set_sprite(VDefSat::mySprite);
   this-&gt;Initialize();
 }
 
 void VDefSat::Initialize(void) {
+  STACKTRACE;
   VSpaceInstallation::Initialize(&quot;DefSat&quot;);
 }
 
 VDeepSpaceOutpost::VDeepSpaceOutpost() {
+  STACKTRACE;
   this-&gt;set_sprite(VDeepSpaceOutpost::mySprite);
   this-&gt;Initialize();
 }
 
 void VDeepSpaceOutpost::Initialize() {
+  STACKTRACE;
   VSpaceInstallation::Initialize(&quot;DeepSpaceOutpost&quot;);
 
 }
 
 VDeepSpaceColony::VDeepSpaceColony() {
+  STACKTRACE;
   this-&gt;set_sprite(VDeepSpaceColony::mySprite);
   this-&gt;Initialize();
 }
 
 void VDeepSpaceColony::Initialize() {
+  STACKTRACE;
   VSpaceInstallation::Initialize(&quot;DeepSpaceColony&quot;);
 }
 
 VDeepSpaceStation::VDeepSpaceStation() {
+  STACKTRACE;
   this-&gt;set_sprite(VDeepSpaceStation::mySprite);
   this-&gt;Initialize();
 }
 
 void VDeepSpaceStation::Initialize() {
+  STACKTRACE;
   VSpaceInstallation::Initialize(&quot;DeepSpaceStation&quot;);
 }
 
 
 VGroundInstallation::VGroundInstallation(SpaceLocation* olocation):Presence()
 {
+  STACKTRACE;
   this-&gt;totalDamageTaken = 0;
   this-&gt;location = olocation;
   actionCounter = 0;
@@ -308,11 +325,13 @@
 
 void VGroundInstallation::Initialize(void)
 {
+  STACKTRACE;
   ;
 }
 
 void VGroundInstallation::Initialize(const char* nameInIni)
 {
+  STACKTRACE;
 	game-&gt;log_file (&quot;vobject.ini&quot;);
   this-&gt;damageToDisable = get_config_float(nameInIni, &quot;DamageToDisable&quot;, 0);
   this-&gt;damageToDestroy = get_config_float(nameInIni, &quot;DamageToDestroy&quot;, 0);
@@ -322,6 +341,7 @@
 
 int VGroundInstallation::handle_damage(SpaceLocation *source, double normal, double direct)
 {
+  STACKTRACE;
   if(source-&gt;isPlanet()||source-&gt;isAsteroid()) return(0);
   this-&gt;totalDamageTaken += (normal + direct);
   message.print(350,5,&quot;DamageTaken=%d&quot;, (long int)this-&gt;totalDamageTaken);
@@ -342,6 +362,7 @@
 
 void VGroundInstallation::calculate(void)
 {
+  STACKTRACE;
   if(!this-&gt;isFunctioning)return;
   Presence::calculate();
   actionCounter += ((double)frame_time / 1000.0) * this-&gt;actionsPerSecond;
@@ -355,47 +376,57 @@
 
 bool VGroundInstallation::BattleAction(void)
 {
+  STACKTRACE;
   return(false);
 }
 
 VWilderness::VWilderness(SpaceLocation* olocation):VGroundInstallation(olocation) {
+  STACKTRACE;
   this-&gt;Initialize();
 }
 
 void VWilderness::Initialize(void)
 {
+  STACKTRACE;
   VGroundInstallation::Initialize(&quot;Wilderness&quot;);
 }
 
 
 VColony::VColony(SpaceLocation* olocation):VGroundInstallation(olocation) {
+  STACKTRACE;
   this-&gt;Initialize();
 }
 
 void VColony::Initialize(void)
 {
+  STACKTRACE;
   VGroundInstallation::Initialize(&quot;Colony&quot;);
 }
 
 VMine::VMine(SpaceLocation* olocation):VGroundInstallation(olocation) {
+  STACKTRACE;
   this-&gt;Initialize();
 }
 
 void VMine::Initialize(void)
 {
+  STACKTRACE;
   VGroundInstallation::Initialize(&quot;Mine&quot;);
 }
 
 VFortification::VFortification(SpaceLocation* olocation):VGroundInstallation(olocation) {
+  STACKTRACE;
   this-&gt;Initialize();
 }
 
 void VFortification::Initialize(void)
 {
+  STACKTRACE;
   VGroundInstallation::Initialize(&quot;Fortification&quot;);
 }
 
 VPlanetaryShield::VPlanetaryShield(SpaceLocation* olocation):VGroundInstallation(olocation) {
+  STACKTRACE;
   this-&gt;Initialize();
   this-&gt;isFunctioning = true;
   this-&gt;isDestroyed = false;
@@ -405,6 +436,7 @@
 
 void VPlanetaryShield::Initialize(void)
 {
+  STACKTRACE;
   VGroundInstallation::Initialize(&quot;PlanetaryShield&quot;);
   this-&gt;maxShield = get_config_float(&quot;PlanetaryShield&quot;, &quot;Shield&quot;, 0);
   this-&gt;currentShield = maxShield;
@@ -412,6 +444,7 @@
 }
 
 int VPlanetaryShield::handle_damage(SpaceLocation* source, double normal, double direct) {
+  STACKTRACE;
   if(this-&gt;currentShield&gt;0) {
     this-&gt;currentShield -= (normal + direct);
     message.print(500,5,&quot;Shield level=%d&quot;, (long int)this-&gt;currentShield);
@@ -422,6 +455,7 @@
 }
 
 void VPlanetaryShield::calculate(void) {
+  STACKTRACE;
   this-&gt;currentShield += ((double)frame_time / 1000) * this-&gt;shieldRegenerationPerSecond;
   if(this-&gt;currentShield&gt;this-&gt;maxShield) this-&gt;currentShield=this-&gt;maxShield;
   if(this-&gt;currentShield&lt;0) this-&gt;isShield = false;
@@ -430,6 +464,7 @@
 
 VGroundDefenseLaser::VGroundDefenseLaser(SpaceLocation* olocation):VGroundInstallation(olocation)
 {
+  STACKTRACE;
   this-&gt;Initialize();
   this-&gt;isFunctioning = true;
   this-&gt;isDestroyed = false;
@@ -438,6 +473,7 @@
 }
 
 void VGroundDefenseLaser::Initialize() {
+  STACKTRACE;
   VGroundInstallation::Initialize(&quot;PlanetaryDefenseLaser&quot;);
   weaponRange = scale_range(get_config_float(&quot;PlanetaryDefenseLaser&quot;, &quot;LaserRange&quot;, 0));
   weaponColor = get_config_int(&quot;PlanetaryDefenseLaser&quot;, &quot;LaserColor&quot;, 0);
@@ -446,6 +482,7 @@
 }
 
 bool VGroundDefenseLaser::BattleAction() {
+  STACKTRACE;
   Vector2 RelLoc;
   double ta;
 	SpaceObject *o = NULL;
@@ -483,6 +520,7 @@
 
 VGroundIonCannon::VGroundIonCannon(SpaceLocation* olocation):VGroundInstallation(olocation)
 {
+  STACKTRACE;
   this-&gt;Initialize();
   this-&gt;isFunctioning = true;
   this-&gt;isDestroyed = false;
@@ -492,6 +530,7 @@
 }
 
 void VGroundIonCannon::Initialize() {
+  STACKTRACE;
   VGroundInstallation::Initialize(&quot;PlanetaryIonCannon&quot;);
   weaponRange = scale_range(get_config_float(&quot;PlanetaryIonCannon&quot;, &quot;CannonRange&quot;, 0));
   weaponVelocity = scale_velocity(get_config_float(&quot;PlanetaryIonCannon&quot;, &quot;CannonSpeed&quot;, 0));
@@ -500,6 +539,7 @@
 }
 
 bool VGroundIonCannon::BattleAction(void) {
+  STACKTRACE;
   //double rAnticipated;
   Vector2 RelLoc;
 
@@ -529,6 +569,7 @@
 
 VGroundMissileLauncher::VGroundMissileLauncher(SpaceLocation* olocation):VGroundInstallation(olocation)
 {
+  STACKTRACE;
   this-&gt;Initialize();
   this-&gt;isFunctioning = true;
   this-&gt;isDestroyed = false;
@@ -538,6 +579,7 @@
 }
 
 void VGroundMissileLauncher::Initialize() {
+  STACKTRACE;
   VGroundInstallation::Initialize(&quot;PlanetaryMissileLauncher&quot;);
   weaponRange = scale_range(get_config_float(&quot;PlanetaryMissileLauncher&quot;, &quot;MissileRange&quot;, 0));
   weaponVelocity = scale_velocity(get_config_float(&quot;PlanetaryMissileLauncher&quot;, &quot;MissileSpeed&quot;, 0));
@@ -547,6 +589,7 @@
 }
 
 bool VGroundMissileLauncher::BattleAction(void) {
+  STACKTRACE;
   Vector2 RelLoc;
 
 	SpaceObject *o = NULL;
@@ -570,8 +613,9 @@
 }
 
 
-VSpaceMine::VSpaceMine():SpaceObject(NULL, random(map_size), random(PI2), meleedata.asteroidSprite)
+VSpaceMine::VSpaceMine():SpaceObject(NULL, random(map_size), random(PI2), game-&gt;meleedata.asteroidSprite)
 {
+  STACKTRACE;
   this-&gt;set_sprite(VSpaceMine::mySprite);
   this-&gt;explosionSprite = VSpaceMine::explosionSprite;
   Initialize();
@@ -585,12 +629,14 @@
 }
 
 void VSpaceMine::death(void) {
+  STACKTRACE;
   this-&gt;animateExplosion();
   SpaceObject::death();
   if(this-&gt;willRespawn) game-&gt;add(new VSpaceMine());
 }
 
 void VSpaceMine::inflict_damage(SpaceObject* other) {
+  STACKTRACE;
   Vector2 V;
   if(!other-&gt;isShip()) return; //only damages ships!!!
   this-&gt;damage_factor = this-&gt;damage;
@@ -602,6 +648,7 @@
 
 int VSpaceMine::handle_damage(SpaceLocation *source, double normal, double direct)
 {
+  STACKTRACE;
   if(source-&gt;isLine()||source-&gt;isShot()) {
     armour -= normal + direct;
     if(armour&lt;0) state = 0;
@@ -612,6 +659,7 @@
 }
 
 void VSpaceMine::Initialize() {
+  STACKTRACE;
 	game-&gt;log_file (&quot;vobject.ini&quot;);
   this-&gt;sprite_index = 0;
   this-&gt;armour = get_config_float(&quot;SpaceMine&quot;, &quot;Armour&quot;, 0);
@@ -620,6 +668,7 @@
 }
 
 void VSpaceMine::animateExplosion(void) {
+  STACKTRACE;
 //	Animation(SpaceLocation *creator, Vector2 opos, SpaceSprite *osprite, 
 //			int first_frame, int num_frames, int frame_size, double depth, double scale = 1.0) ;
 	game-&gt;add(new Animation(this, normal_pos(),
@@ -628,45 +677,70 @@
 	return;
 }
 
-void VSpaceMine::soundExplosion(void) {
-  if(damage_factor &gt; 0) {
-		int i = iround_down(damage_factor / 2);
-		if(i &gt;= BOOM_SAMPLES) i = BOOM_SAMPLES - 1;
-		play_sound((SAMPLE *)(melee[MELEE_BOOM + i].dat));
+void VSpaceMine::soundExplosion(void) 
+{
+  STACKTRACE;
+  if(damage_factor &gt; 0) 
+    {
+      int i = iround_down(damage_factor / 2);
+      if(i &gt;= BOOM_SAMPLES) i = BOOM_SAMPLES - 1;
+      switch(i)
+	{
+	case 0:
+	  tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL01_WAV.wav&quot;));
+	  break;
+	case 1:
+	  tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL02_WAV.wav&quot;));
+	  break;
+	case 2:
+	  tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL03_WAV.wav&quot;));
+	  break;
+	case 3:
+	  tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL04_WAV.wav&quot;));
+	  break;
+	default:
+	  {
+	    tw_error(&quot;Unknown BOOM sound&quot;);
+	  }
 	}
-	return;
+    }
+  return;
 }
 
 
 
 VNebula::VNebula():Presence()
 {
+  STACKTRACE;
 //  game-&gt;all_damage_direct = true;
 //  game-&gt;is_nebula = true;
   friction = 0.0004;
-	videosystem.color_effects = VNebulaColorEffects;
-	videosystem.update_colors();
+	videosystem-&gt;color_effects = VNebulaColorEffects;
+	videosystem-&gt;update_colors();
 }
 
 VNebula::VNebula(double ofriction):Presence()
 {
+  STACKTRACE;
 //  game-&gt;all_damage_direct = true;
   friction = ofriction;
-	videosystem.color_effects = VNebulaColorEffects;
-	videosystem.update_colors();
+	videosystem-&gt;color_effects = VNebulaColorEffects;
+	videosystem-&gt;update_colors();
 
 }
 
 VNebula::VNebula(double ofriction, int oionStorms):Presence()
 {
+  STACKTRACE;
 //  game-&gt;all_damage_direct = true;
   friction = ofriction; 
   ionStorms = oionStorms;
-	videosystem.color_effects = VNebulaColorEffects;
-	videosystem.update_colors();
+  videosystem-&gt;color_effects = VNebulaColorEffects;
+  videosystem-&gt;update_colors();
 }
 
 void VNebula::calculate(void) {
+  STACKTRACE;
   Presence::calculate();
   
   for(std::list&lt;SpaceLocation*&gt;::iterator i=game-&gt;item.begin();i!=game-&gt;item.end();i++)
@@ -683,24 +757,21 @@
 }
 
 VNebula::~VNebula() {
-//  game-&gt;all_damage_direct = false;
-//  game-&gt;is_nebula = false;
-  videosystem.color_effects = gamma_color_effects;
-	videosystem.update_colors();
+  videosystem-&gt;color_effects = gamma_color_effects;
+  videosystem-&gt;update_colors();
 }
 
-VIonStorm::VIonStorm(void):SpaceObject(NULL, Vector2(0,0), 0, NULL) {
-//	SpaceObject(SpaceLocation *creator, Vector2 opos, double oangle, 
-//			SpaceSprite *osprite);
-
-  ;
+VIonStorm::VIonStorm(void):SpaceObject(NULL, Vector2(0,0), 0, NULL) 
+{
+  STACKTRACE;
 }
 
 
 VDustCloud::VDustCloud(void)
 :
-SpaceObject(NULL, random(map_size), random(PI2), meleedata.asteroidSprite)
+SpaceObject(NULL, random(map_size), random(PI2), game-&gt;meleedata.asteroidSprite)
 {
+  STACKTRACE;
   double speed, angle;
   this-&gt;velocityRestoreFactor = 0.00;
   this-&gt;mass = 0;
@@ -719,6 +790,7 @@
 }
 
 void VDustCloud::Initialize(const char* nameInIni) {
+  STACKTRACE;
 	game-&gt;log_file (&quot;vobject.ini&quot;);
   this-&gt;sprite_index = 0;
 	mass = get_config_int(nameInIni, &quot;Mass&quot;, 0);
@@ -732,10 +804,12 @@
 }
 
 void VDustCloud::Initialize(void) {
+  STACKTRACE;
   Initialize(&quot;DustCloud&quot;);
 }
 
 int VDustCloud::handle_damage(SpaceLocation* source, double normal, double direct) {
+  STACKTRACE;
   if(source-&gt;isAsteroid()) return(0);
   if(source-&gt;isLine()||source-&gt;isShot()) {
     armour -= (normal + direct);
@@ -746,6 +820,7 @@
 }
 
 void VDustCloud::inflict_damage(SpaceObject* other) {
+  STACKTRACE;
   Vector2 relV;
   double excessSpeed;
   double d;
@@ -769,11 +844,13 @@
 }
 
 void VDustCloud::death(void) {
+  STACKTRACE;
   SpaceObject::death();
   if(this-&gt;willRespawn) game-&gt;add(new VDustCloud());
 }
 
 void VDustCloud::calculate(void) {
+  STACKTRACE;
   double x;
   x = (double)frame_time * this-&gt;velocityRestoreFactor;
   if(x&gt;1)x=1;
@@ -784,8 +861,9 @@
 
 VGasCloud::VGasCloud(void)
 :
-SpaceObject(NULL, random(map_size), random(PI2), meleedata.asteroidSprite)
+SpaceObject(NULL, random(map_size), random(PI2), game-&gt;meleedata.asteroidSprite)
 {
+  STACKTRACE;
   double speed, angle;
   this-&gt;velocityRestoreFactor = 0.00;
   this-&gt;mass = 0;
@@ -805,6 +883,7 @@
 }
 
 void VGasCloud::Initialize(const char* nameInIni) {
+  STACKTRACE;
 	game-&gt;log_file (&quot;vobject.ini&quot;);
   this-&gt;sprite_index = 0;
 	mass = get_config_int(nameInIni, &quot;Mass&quot;, 0);
@@ -823,10 +902,12 @@
 }
 
 void VGasCloud::Initialize(void) {
+  STACKTRACE;
   Initialize(&quot;GasCloud&quot;);
 }
 
 int VGasCloud::handle_damage(SpaceLocation* source, double normal, double direct) {
+  STACKTRACE;
   if(isEnergized = false) {
     this-&gt;damageFactor=0;
     this-&gt;damage_factor=0;
@@ -848,6 +929,7 @@
 }
 
 void VGasCloud::inflict_damage(SpaceObject* other) {
+  STACKTRACE;
   if(this-&gt;damageFactor&gt;0.001) {
     //message.print(500,5,&quot;energizing damage&quot;);
     damage(other, this-&gt;energizingDamageFactor * this-&gt;damageFactor / 2, this-&gt;energizingDamageFactor * this-&gt;damageFactor / 2);
@@ -864,6 +946,7 @@
 }
 
 void VGasCloud::calculate(void) {
+  STACKTRACE;
   double x;
   if(this-&gt;isEnergized) {
     this-&gt;isEnergized = false;
@@ -881,6 +964,7 @@
 }
 
 void VGasCloud::death(void) {
+  STACKTRACE;
   SpaceObject::death();
   if(this-&gt;willRespawn) game-&gt;add(new VGasCloud());
 }
@@ -890,6 +974,7 @@
 :
 Planet(Vector2(0,0), VMoon::mySprite, 0) // a sprite is needed to avoid a crash...WTF?
 {
+  STACKTRACE;
   int i;
   for(i=0; i&lt;12; i++) this-&gt;Installation[i]=NULL;
   this-&gt;id = ID_PLANET;
@@ -897,16 +982,19 @@
 }
 
 double VPlanet::getRadius(void) {
+  STACKTRACE;
   return(((this-&gt;size.x + this-&gt;size.y) / 4) / 1000);
 }
 
 
 void VPlanet::inflict_damage(SpaceObject* other) {
+  STACKTRACE;
   Planet::inflict_damage(other);
 }
 
 int VPlanet::handle_damage(SpaceLocation *source, double normal, double direct)
 {
+  STACKTRACE;
   int i,j;
   for(i=0;i&lt;12;i++) {
     if(this-&gt;Installation[i]!=NULL)
@@ -946,6 +1034,7 @@
 
 void VPlanet::Initialize(const char* nameInIni)
 {
+  STACKTRACE;
 	game-&gt;log_file (&quot;vobject.ini&quot;);
   this-&gt;sprite_index = 0;
 	gravity_mindist = scale_range(get_config_float(nameInIni, &quot;GravityMinDist&quot;, 0));
@@ -958,6 +1047,7 @@
 }
 
 bool VPlanet::AddInstallation(VGroundInstallation* oGI) {
+  STACKTRACE;
   int i;
   for(i=0;i&lt;12;i++) {
     if(this-&gt;Installation[i]==NULL) {
@@ -970,6 +1060,7 @@
 }
 
 void VPlanet::death() {
+  STACKTRACE;
   int i;
   for(i=0;i&lt;12;i++)
     if(this-&gt;Installation[i]!=NULL)
@@ -977,6 +1068,7 @@
 }
 
 void VStar::AttractShots(int warping_power, double intensity) {
+  STACKTRACE;
   //sort of like gravity, but no minimum distance
   //and only changes direction, not speed.
   //only affects massless objects.
@@ -1037,6 +1129,7 @@
 :
 Planet(Vector2(0,0), VBrownDwarf::mySprite, 0) //sprite problem?
 {
+  STACKTRACE;
   this-&gt;id = ID_PLANET; // done for grav-whip purposes!!!!
   this-&gt;starEnergy = 0.0;
   this-&gt;angle = 0;
@@ -1054,11 +1147,13 @@
 }
 
 double VStar::getRadius(void) {
+  STACKTRACE;
   return((this-&gt;size.x + this-&gt;size.y) / 4);
 }
 
 
 void VStar::calculate() {
+  STACKTRACE;
   double r;
   double maxFlares;
   double flareFactor;
@@ -1094,6 +1189,7 @@
 }
 
 void VStar::LaunchFlare(double oangle, double oinitialVelocity, double orange, double odamage, double ofinalVelocity) {
+  STACKTRACE;
   ;// this SHOULD be overridden as needed by individual stars...?
   VRedFlare* VRF;
   VRF = new VRedFlare(this, oangle, oinitialVelocity, orange, odamage, ofinalVelocity);
@@ -1104,12 +1200,14 @@
 
 int VStar::canCollide(SpaceLocation *other)
 {
+  STACKTRACE;
   return(TRUE);
 	if(other-&gt;id==COMET_ID) return FALSE;
 	return(!other-&gt;isPlanet());
 }
 
 void VStar::inflict_damage(SpaceObject* other) {
+  STACKTRACE;
   double percentCoreDamage;
 
   double totalDamage;
@@ -1125,6 +1223,7 @@
 }
 
 int VStar::handle_damage(SpaceLocation* source, double normal, double direct) {
+  STACKTRACE;
   return(0);
   /*int x;
   x = VStar::handle_damage(source, normal, direct);
@@ -1137,6 +1236,7 @@
 
 void VStar::Initialize(const char* nameInIni)
 {
+  STACKTRACE;
   starEnergy = 0.0;
 	game-&gt;log_file (&quot;vobject.ini&quot;);
   this-&gt;sprite_index = 0;
@@ -1167,6 +1267,7 @@
 }
 
 bool VStar::isPlanet(void) {
+  STACKTRACE;
   return(true); // a kludge, should help grav-whip???
 }
 
@@ -1175,11 +1276,12 @@
 :
 Asteroid()
 {
+  STACKTRACE;
   this-&gt;set_sprite(mySprite);
   armour = VMetalShard::myArmour;
   damage_factor = VMetalShard::myDamage;
   mass = VMetalShard::myMass;
-  explosionSprite = meleedata.sparkSprite;
+  explosionSprite = game-&gt;meleedata.sparkSprite;
   mass = 1;
   this-&gt;willRespawn = FALSE;
 }
@@ -1188,13 +1290,14 @@
 :
 Asteroid()
 {
+  STACKTRACE;
   if(VMetalShard::mySprite==NULL) {
     ;
   }
   this-&gt;set_sprite(mySprite);
   armour = VMetalShard::myArmour;
   damage_factor = VMetalShard::myArmour;
-  explosionSprite = meleedata.sparkSprite;
+  explosionSprite = game-&gt;meleedata.sparkSprite;
   mass = VMetalShard::myMass;
   //
   this-&gt;pos = pos;
@@ -1203,6 +1306,7 @@
 
 
 int VMetalShard::handle_damage(SpaceLocation *source, double normal, double direct) {
+  STACKTRACE;
 	if (!exists()) return 0;
 	if ((normal &gt; 0) || (direct &gt; 0)) {
 		armour -= normal;
@@ -1219,6 +1323,7 @@
 }
 
 void VMetalShard::inflict_damage(SpaceObject *other) {
+  STACKTRACE;
 	if (!other-&gt;exists()) return;
 	damage(other, 0, damage_factor);
   if(other-&gt;isShip()) ((Ship*)other)-&gt;update_panel=1;
@@ -1229,6 +1334,7 @@
 }
 
 void VMetalShard::animateExplosion(void) {
+  STACKTRACE;
 	game-&gt;add(new Animation(this, normal_pos(),
     explosionSprite, 0, 10,
     scale_frames(0), DEPTH_EXPLOSIONS));
@@ -1236,20 +1342,43 @@
 }
 
 void VMetalShard::soundExplosion(void) {
-  if(damage_factor &gt; 0) {
-		int i = iround_down(damage_factor / 2);
-		if(i &gt;= BOOM_SAMPLES) i = BOOM_SAMPLES - 1;
-		play_sound((SAMPLE *)(melee[MELEE_BOOM + i].dat));
+  STACKTRACE;
+  if(damage_factor &gt; 0) 
+    {
+      int i = iround_down(damage_factor / 2);
+      if(i &gt;= BOOM_SAMPLES) i = BOOM_SAMPLES - 1;
+      
+      switch(i)
+	{
+	case 0:
+	  tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL01_WAV.wav&quot;));
+	  break;
+	case 1:
+	  tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL02_WAV.wav&quot;));
+	  break;
+	case 2:
+	  tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL03_WAV.wav&quot;));
+	  break;
+	case 3:
+	  tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL04_WAV.wav&quot;));
+	  break;
+	default:
+	  {
+	    tw_error(&quot;Unknown BOOM sound&quot;);
+	  }
 	}
-	return;
+    }
+  return;
 }
 
 void VMetalShard::death(void) {
+  STACKTRACE;
   SpaceObject::death();
   if(this-&gt;willRespawn) game-&gt;add(new VMetalShard());
 }
 
 void VMetalShard::compareSprites(void) {
+  STACKTRACE;
   if(this-&gt;sprite==this-&gt;mySprite) {
     tw_error(&quot;Identical sprites&quot;);
   }
@@ -1262,15 +1391,17 @@
 :
 Asteroid()
 {
+  STACKTRACE;
   this-&gt;set_sprite(mySprite);
   armour = VMetalAsteroid::myArmour;
   damage_factor = VMetalAsteroid::myDamage;
-  explosionSprite = meleedata.sparkSprite;
+  explosionSprite = game-&gt;meleedata.sparkSprite;
   mass = VMetalAsteroid::myMass;
   this-&gt;willRespawn = TRUE;
 }
 
-int VMetalAsteroid::handle_damage(SpaceLocation *source, double normal, double direct) {STACKTRACE
+int VMetalAsteroid::handle_damage(SpaceLocation *source, double normal, double direct) {
+  STACKTRACE;
   Vector2 V;
   //tw_error(&quot;about to handle damage&quot;);
 	if (!exists()) return 0;
@@ -1295,7 +1426,8 @@
 	return 1;
 }
 
-void VMetalAsteroid::inflict_damage(SpaceObject *other) {STACKTRACE
+void VMetalAsteroid::inflict_damage(SpaceObject *other) {
+  STACKTRACE;
   //tw_error(&quot;about to inflict damage&quot;);
 	if (!other-&gt;exists()) return;
 	damage(other, 0, damage_factor);
@@ -1307,6 +1439,7 @@
 }
 
 void VMetalAsteroid::animateExplosion(void) {
+  STACKTRACE;
 	game-&gt;add(new Animation(this, normal_pos(),
     explosionSprite, 0, 10,
     scale_frames(0), DEPTH_EXPLOSIONS));
@@ -1314,16 +1447,38 @@
 
 }
 
-void VMetalAsteroid::soundExplosion(void) {
-  if(damage_factor &gt; 0) {
-		int i = iround_down(damage_factor / 2);
-		if(i &gt;= BOOM_SAMPLES) i = BOOM_SAMPLES - 1;
-		play_sound((SAMPLE *)(melee[MELEE_BOOM + i].dat));
-	}
-	return;
+void VMetalAsteroid::soundExplosion(void) 
+{
+  STACKTRACE;
+  if(damage_factor &gt; 0) 
+    {
+      int i = iround_down(damage_factor / 2);
+      if(i &gt;= BOOM_SAMPLES) i = BOOM_SAMPLES - 1;
+      switch(i)
+	{
+	case 0:
+	  tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL01_WAV.wav&quot;));
+	  break;
+	case 1:
+	  tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL02_WAV.wav&quot;));
+	  break;
+	case 2:
+	  tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL03_WAV.wav&quot;));
+	  break;
+	case 3:
+	  tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL04_WAV.wav&quot;));
+	  break;
+	default:
+	  {
+	    tw_error(&quot;Unknown BOOM sound&quot;);
+	  }
+	}    
+    }
+  return;
 }
 
 void VMetalAsteroid::death(void) {
+  STACKTRACE;
   VMetalShard* VS;
   Vector2 Loc, UV;
   int i;
@@ -1353,10 +1508,11 @@
 :
 Asteroid()
 {
+  STACKTRACE;
   this-&gt;set_sprite(mySprite);
   armour = VSmallAsteroid::myArmour;
   damage_factor = VSmallAsteroid::damage_factor;
-  explosionSprite = meleedata.sparkSprite;
+  explosionSprite = game-&gt;meleedata.sparkSprite;
   mass = VSmallAsteroid::mass;
   willRespawn = TRUE;
 }
@@ -1365,10 +1521,11 @@
 :
 Asteroid()
 {
+  STACKTRACE;
   this-&gt;set_sprite(mySprite);
   armour = 10;
   damage_factor = 0;
-  explosionSprite = meleedata.sparkSprite;
+  explosionSprite = game-&gt;meleedata.sparkSprite;
   mass = 10;
   //
   this-&gt;pos = pos;
@@ -1377,6 +1534,7 @@
 
 
 int VSmallAsteroid::handle_damage(SpaceLocation *source, double normal, double direct) {
+  STACKTRACE;
 	Vector2 V;
   if (!exists()) return 0;
 	if ((normal &gt; 0) || (direct &gt; 0)) {
@@ -1401,6 +1559,7 @@
 }
 
 void VSmallAsteroid::inflict_damage(SpaceObject *other) {
+  STACKTRACE;
 	if (!other-&gt;exists()) return;
 	damage(other, 0, damage_factor);
   if(other-&gt;isShip()) ((Ship*)other)-&gt;update_panel=1;
@@ -1411,6 +1570,7 @@
 }
 
 void VSmallAsteroid::animateExplosion(void) {
+  STACKTRACE;
 	game-&gt;add(new Animation(this, normal_pos(),
     explosionSprite, 0, 10,
     scale_frames(0), DEPTH_EXPLOSIONS));
@@ -1419,15 +1579,36 @@
 }
 
 void VSmallAsteroid::soundExplosion(void) {
-  if(damage_factor &gt; 0) {
-		int i = iround_down(damage_factor / 2);
-		if(i &gt;= BOOM_SAMPLES) i = BOOM_SAMPLES - 1;
-		play_sound((SAMPLE *)(melee[MELEE_BOOM + i].dat));
+  STACKTRACE;
+  if(damage_factor &gt; 0) 
+    {
+      int i = iround_down(damage_factor / 2);
+      if(i &gt;= BOOM_SAMPLES) i = BOOM_SAMPLES - 1;
+      switch(i)
+	{
+	case 0:
+	  tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL01_WAV.wav&quot;));
+	  break;
+	case 1:
+	  tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL02_WAV.wav&quot;));
+	  break;
+	case 2:
+	  tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL03_WAV.wav&quot;));
+	  break;
+	case 3:
+	  tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL04_WAV.wav&quot;));
+	  break;
+	default:
+	  {
+	    tw_error(&quot;Unknown BOOM sound&quot;);
+	  }
 	}
-	return;
+    }
+  return;
 }
 
 void VSmallAsteroid::death(void) {
+  STACKTRACE;
   SpaceObject::death();
   if(this-&gt;willRespawn) game-&gt;add(new VSmallAsteroid());
 
@@ -1437,15 +1618,17 @@
 :
 Asteroid()
 {
+  STACKTRACE;
   this-&gt;set_sprite(mySprite);
   armour = VLargeAsteroid::myArmour;
   damage_factor = VLargeAsteroid::myDamage;
-  explosionSprite = meleedata.sparkSprite;
+  explosionSprite = game-&gt;meleedata.sparkSprite;
   mass = VLargeAsteroid::myMass;
   willRespawn = TRUE;
 }
 
 int VLargeAsteroid::handle_damage(SpaceLocation *source, double normal, double direct) {
+  STACKTRACE;
   Vector2 V;
 	if (!exists()) return 0;
 	if ((normal &gt; 0) || (direct &gt; 0)) {
@@ -1472,6 +1655,7 @@
 }
 
 void VLargeAsteroid::inflict_damage(SpaceObject *other) {
+  STACKTRACE;
 	if (!other-&gt;exists()) return;
 	damage(other, 0, damage_factor);
   if(other-&gt;isShip()) ((Ship*)other)-&gt;update_panel=1;
@@ -1482,6 +1666,7 @@
 }
 
 void VLargeAsteroid::animateExplosion(void) {
+  STACKTRACE;
 	game-&gt;add(new Animation(this, normal_pos(),
     explosionSprite, 0, 10,
     scale_frames(0), DEPTH_EXPLOSIONS));
@@ -1489,16 +1674,37 @@
 
 }
 
-void VLargeAsteroid::soundExplosion(void) {
+void VLargeAsteroid::soundExplosion(void) 
+{
+  STACKTRACE;
   if(damage_factor &gt; 0) {
-		int i = iround_down(damage_factor / 2);
-		if(i &gt;= BOOM_SAMPLES) i = BOOM_SAMPLES - 1;
-		play_sound((SAMPLE *)(melee[MELEE_BOOM + i].dat));
+    int i = iround_down(damage_factor / 2);
+    if(i &gt;= BOOM_SAMPLES) i = BOOM_SAMPLES - 1;
+    switch(i)
+      {
+      case 0:
+	tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL01_WAV.wav&quot;));
+	break;
+      case 1:
+	tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL02_WAV.wav&quot;));
+	break;
+      case 2:
+	tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL03_WAV.wav&quot;));
+	break;
+      case 3:
+	tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL04_WAV.wav&quot;));
+	break;
+      default:
+	{
+	  tw_error(&quot;Unknown BOOM sound&quot;);
 	}
-	return;
+      }
+  }
+  return;
 }
 
 void VLargeAsteroid::death(void) {
+  STACKTRACE;
   VSmallAsteroid* VS;
   Vector2 Loc, UV;
   int i;
@@ -1518,11 +1724,13 @@
 :
 VPlanet()
 {
+  STACKTRACE;
   this-&gt;set_sprite(VMoon::mySprite);
   this-&gt;Initialize(&quot;Moon&quot;);
 }
 
 void VMoon::calculate() {
+  STACKTRACE;
   VPlanet::calculate();
 }
 
@@ -1531,6 +1739,7 @@
 :
 VPlanet()
 {
+  STACKTRACE;
   this-&gt;set_sprite(VRockballPlanet::mySprite);
   this-&gt;Initialize(&quot;RockballPlanet&quot;);
 }
@@ -1541,6 +1750,7 @@
 :
 VPlanet()
 {
+  STACKTRACE;
   this-&gt;set_sprite(VInhospitablePlanet::mySprite);
   this-&gt;Initialize(&quot;InhospitablePlanet&quot;);
 }
@@ -1549,6 +1759,7 @@
 :
 VPlanet()
 {
+  STACKTRACE;
   this-&gt;set_sprite(VHabitablePlanet::mySprite);
   this-&gt;Initialize(&quot;HabitablePlanet&quot;);
 }
@@ -1557,6 +1768,7 @@
 :
 VPlanet()
 {
+  STACKTRACE;
   this-&gt;set_sprite(VGasGiant::mySprite);
   this-&gt;Initialize(&quot;GasGiant&quot;);
 
@@ -1566,15 +1778,18 @@
 :
 VStar()
 {
+  STACKTRACE;
   this-&gt;set_sprite(VBrownDwarf::mySprite);
   this-&gt;Initialize(&quot;BrownDwarf&quot;);
 }
 
 void VBrownDwarf::inflict_damage(SpaceObject* other) {
+  STACKTRACE;
   VStar::inflict_damage(other);
 }
 
 int VBrownDwarf::handle_damage(SpaceLocation* source, double normal, double direct) {
+  STACKTRACE;
   return VStar::handle_damage(source, normal, direct);
 }
 
@@ -1583,15 +1798,18 @@
 :
 VStar()
 {
+  STACKTRACE;
   this-&gt;set_sprite(VRedDwarf::mySprite);
   this-&gt;Initialize(&quot;RedDwarf&quot;);
 }
 
 void VRedDwarf::inflict_damage(SpaceObject* other) {
+  STACKTRACE;
   VStar::inflict_damage(other);
 }
 
 int VRedDwarf::handle_damage(SpaceLocation* source, double normal, double direct) {
+  STACKTRACE;
   return VStar::handle_damage(source, normal, direct);
 }
 
@@ -1599,15 +1817,18 @@
 :
 VStar()
 {
+  STACKTRACE;
   this-&gt;set_sprite(VWhiteDwarf::mySprite);
   this-&gt;Initialize(&quot;WhiteDwarf&quot;);
 }
 
 void VWhiteDwarf::inflict_damage(SpaceObject* other) {
+  STACKTRACE;
   VStar::inflict_damage(other);
 }
 
 void VWhiteDwarf::LaunchFlare(VStar* osource, double oangle, double oinitialVelocity, double orange, double odamage, double ofinalVelocity) {
+  STACKTRACE;
   VWhiteFlare* VRF;
   VRF = new VWhiteFlare(this, oangle, oinitialVelocity, orange, odamage, ofinalVelocity);
   game-&gt;add(VRF);
@@ -1616,6 +1837,7 @@
 
 
 int VWhiteDwarf::handle_damage(SpaceLocation* source, double normal, double direct) {
+  STACKTRACE;
   return VStar::handle_damage(source, normal, direct);
 }
 
@@ -1624,15 +1846,18 @@
 :
 VStar()
 {
+  STACKTRACE;
   this-&gt;set_sprite(VRedStar::mySprite);
   this-&gt;Initialize(&quot;RedStar&quot;);
 }
 
 void VRedStar::inflict_damage(SpaceObject* other) {
+  STACKTRACE;
   VStar::inflict_damage(other);
 }
 
 int VRedStar::handle_damage(SpaceLocation* source, double normal, double direct) {
+  STACKTRACE;
   return VStar::handle_damage(source, normal, direct);
 }
 
@@ -1640,20 +1865,24 @@
 :
 VStar()
 {
+  STACKTRACE;
   this-&gt;set_sprite(VOrangeStar::mySprite);
   this-&gt;Initialize(&quot;OrangeStar&quot;);
 
 }
 
 void VOrangeStar::inflict_damage(SpaceObject* other) {
+  STACKTRACE;
   VStar::inflict_damage(other);
 }
 
 int VOrangeStar::handle_damage(SpaceLocation* source, double normal, double direct) {
+  STACKTRACE;
   return VStar::handle_damage(source, normal, direct);
 }
 
 void VOrangeStar::LaunchFlare(VStar* osource, double oangle, double oinitialVelocity, double orange, double odamage, double ofinalVelocity) {
+  STACKTRACE;
   VOrangeFlare* VRF;
   VRF = new VOrangeFlare(this, oangle, oinitialVelocity, orange, odamage, ofinalVelocity);
   game-&gt;add(VRF);
@@ -1665,20 +1894,24 @@
 :
 VStar()
 {
+  STACKTRACE;
   this-&gt;set_sprite(VYellowStar::mySprite);
   this-&gt;Initialize(&quot;YellowStar&quot;);
 }
 
 
 void VYellowStar::inflict_damage(SpaceObject* other) {
+  STACKTRACE;
   VStar::inflict_damage(other);
 }
 
 int VYellowStar::handle_damage(SpaceLocation* source, double normal, double direct) {
+  STACKTRACE;
   return VStar::handle_damage(source, normal, direct);
 }
 
 void VYellowStar::LaunchFlare(double oangle, double oinitialVelocity, double orange, double odamage, double ofinalVelocity) {
+  STACKTRACE;
   VYellowFlare* VRF;
   VRF = new VYellowFlare(this, oangle, oinitialVelocity, orange, odamage, ofinalVelocity);
   game-&gt;add(VRF);
@@ -1690,19 +1923,23 @@
 :
 VStar()
 {
+  STACKTRACE;
   this-&gt;set_sprite(VWhiteStar::mySprite);
   this-&gt;Initialize(&quot;WhiteStar&quot;);
 }
 
 void VWhiteStar::inflict_damage(SpaceObject* other) {
+  STACKTRACE;
   VStar::inflict_damage(other);
 }
 
 int VWhiteStar::handle_damage(SpaceLocation* source, double normal, double direct) {
+  STACKTRACE;
   return VStar::handle_damage(source, normal, direct);
 }
 
 void VWhiteStar::LaunchFlare(VStar* osource, double oangle, double oinitialVelocity, double orange, double odamage, double ofinalVelocity) {
+  STACKTRACE;
   VWhiteFlare* VRF;
   VRF = new VWhiteFlare(this, oangle, oinitialVelocity, orange, odamage, ofinalVelocity);
   game-&gt;add(VRF);
@@ -1713,15 +1950,18 @@
 :
 VStar()
 {
+  STACKTRACE;
   this-&gt;set_sprite(VRedGiant::mySprite);
   this-&gt;Initialize(&quot;RedGiant&quot;);
 }
 
 void VRedGiant::inflict_damage(SpaceObject* other) {
+  STACKTRACE;
   VStar::inflict_damage(other);
 }
 
 int VRedGiant::handle_damage(SpaceLocation* source, double normal, double direct) {
+  STACKTRACE;
   return VStar::handle_damage(source, normal, direct);
 }
 
@@ -1730,19 +1970,23 @@
 :
 VStar()
 {
+  STACKTRACE;
   this-&gt;set_sprite(VBlueGiant::mySprite);
   this-&gt;Initialize(&quot;BlueGiant&quot;);
 }
 
 void VBlueGiant::inflict_damage(SpaceObject* other) {
+  STACKTRACE;
   VStar::inflict_damage(other);
 }
 
 int VBlueGiant::handle_damage(SpaceLocation* source, double normal, double direct) {
+  STACKTRACE;
   return VStar::handle_damage(source, normal, direct);
 }
 
 void VBlueGiant::LaunchFlare(double oangle, double oinitialVelocity, double orange, double odamage, double ofinalVelocity) {
+  STACKTRACE;
   VWhiteFlare* VRF;
   VRF = new VWhiteFlare(this, oangle, oinitialVelocity, orange, odamage, ofinalVelocity);
   game-&gt;add(VRF);
@@ -1754,6 +1998,7 @@
 :
 VStar()
 {
+  STACKTRACE;
   this-&gt;set_sprite(VNeutronStar::mySprite);
   this-&gt;Initialize(&quot;NeutronStar&quot;);
 	/*game-&gt;log_file (&quot;vobject.ini&quot;);
@@ -1766,13 +2011,16 @@
 }
 
 void VNeutronStar::inflict_damage(SpaceObject* other) {
+  STACKTRACE;
   VStar::inflict_damage(other);
 }
 
 int VNeutronStar::handle_damage(SpaceLocation* source, double normal, double direct) {
+  STACKTRACE;
   return(0);
 }
 void VNeutronStar::calculate(void) {
+  STACKTRACE;
   this-&gt;sprite_index += 1;
   while(this-&gt;sprite_index&gt;63) this-&gt;sprite_index -=64;
   while(this-&gt;sprite_index&lt;0) this-&gt;sprite_index +=64;
@@ -1785,19 +2033,23 @@
 :
 VStar()
 {
+  STACKTRACE;
   this-&gt;set_sprite(VHypermass::mySprite);
   this-&gt;Initialize(&quot;Hypermass&quot;);
 }
 
 void VHypermass::inflict_damage(SpaceObject* other) {
+  STACKTRACE;
   VStar::inflict_damage(other);
 }
 
 int VHypermass::handle_damage(SpaceLocation* source, double normal, double direct) {
+  STACKTRACE;
   return(0);
 }
 
 void VHypermass::calculate(void) {
+  STACKTRACE;
   this-&gt;sprite_index += 1;
   while(this-&gt;sprite_index&gt;63) this-&gt;sprite_index -=64;
   while(this-&gt;sprite_index&lt;0) this-&gt;sprite_index +=64;
@@ -1810,6 +2062,7 @@
 Missile(source, source-&gt;pos, angle, initialVelocity, 
         odamage, range, odamage, source, VRedFlare::mySprite, 0)
 {
+  STACKTRACE;
   creator = (SpaceLocation*)source;
   pos = source-&gt;pos;
   originalVelocity = initialVelocity;
@@ -1821,6 +2074,7 @@
 }
 
 void VFlare::calculate() {
+  STACKTRACE;
   double amountFlown, amountToFly, currentAngle, calcVelocity;
   amountToFly = ((double)this-&gt;range - (double)this-&gt;d) / (double)this-&gt;range;
   amountToFly = amountToFly * amountToFly * amountToFly;
@@ -1833,11 +2087,13 @@
 }
 
 void VFlare::inflict_damage(SpaceObject* other) {
+  STACKTRACE;
   if((SpaceLocation*)other == (SpaceLocation*)creator) return;
   Missile::inflict_damage(other);
 }
 
 int VFlare::handle_damage(SpaceLocation *source, double normal, double direct) {
+  STACKTRACE;
   if((SpaceLocation*)source == (SpaceLocation*)creator) return(0);
   return(Missile::handle_damage(source, normal, direct));
 }
@@ -1846,6 +2102,7 @@
 :
 VFlare(source, angle, initialVelocity, range, odamage, ofinalVelocity)
 {
+  STACKTRACE;
   this-&gt;set_sprite(VRedFlare::mySprite);
 }
 
@@ -1853,6 +2110,7 @@
 :
 VFlare(source, angle, initialVelocity, range, odamage, ofinalVelocity)
 {
+  STACKTRACE;
   this-&gt;set_sprite(VOrangeFlare::mySprite);
 }
 
@@ -1860,6 +2118,7 @@
 :
 VFlare(source, angle, initialVelocity, range, odamage, ofinalVelocity)
 {
+  STACKTRACE;
   this-&gt;set_sprite(VYellowFlare::mySprite);
 }
 
@@ -1867,6 +2126,7 @@
 :
 VFlare(source, angle, initialVelocity, range, odamage, ofinalVelocity)
 {
+  STACKTRACE;
   this-&gt;set_sprite(VWhiteFlare::mySprite);
 }
 

Modified: branches/multiplayer-branch/source/other/vtarget.cpp
===================================================================
--- branches/multiplayer-branch/source/other/vtarget.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/other/vtarget.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -17,7 +17,6 @@
 
 #include &lt;assert.h&gt;
 #include &quot;melee.h&quot;
-REGISTER_FILE
 #include &quot;id.h&quot;
 
 #include &quot;melee/mframe.h&quot;
@@ -41,6 +40,7 @@
 			   double WeaponOffsetY, double WeaponAngle,
 			   double MaxRange,
 			   double DegTolerance, int LagSetting) {
+  STACKTRACE;
 	AimSys::SetupDefaults();
 	source = sourceP; target = targetP;
 	relativity = Relativity;
@@ -61,6 +61,7 @@
 
 
 AimSys::AimSys(SpaceLocation* sourceP, SpaceLocation* targetP, double WeaponSpeed, double Relativity) {
+  STACKTRACE;
 	//not anti-aliased here
 	AimSys::SetupDefaults();
 	source = sourceP; target = targetP;
@@ -76,6 +77,7 @@
 }
 
 AimSys::AimSys(SpaceLocation* sourceP, SpaceLocation* targetP, double WeaponSpeed) {
+  STACKTRACE;
 	//not anti-aliased here
 	AimSys::SetupDefaults();
     source = sourceP; target = targetP;
@@ -89,6 +91,7 @@
 }
 
 AimSys::AimSys(SpaceLocation* sourceP, SpaceLocation* targetP) {
+  STACKTRACE;
 	//not anti-aliased here
 	//use with caution -- weapon speed is taken to be the
 	//current ship speed.  Would work for the Tau Bomber.
@@ -103,7 +106,8 @@
   AimSys::CalcWeaponOffset();
 }
 
-void AimSys::SetupDefaults(void) { //sets up defaults
+void AimSys::SetupDefaults(void) {
+  STACKTRACE; //sets up defaults
 	relativity = 0.5;
 	source = NULL; target = NULL;
   nx1center = 0; ny1center = 0;
@@ -117,6 +121,7 @@
 }
 
 void AimSys::CalcWeaponOffset(void) {
+  STACKTRACE;
   
   double dx, dy;
 	gamma = CalcVectorAngle(0,0,-weaponOffsetY, weaponOffsetX);
@@ -131,12 +136,14 @@
 }
 
 void AimSys::CalcWeaponOffset(double xOff, double yOff) {
+  STACKTRACE;
   weaponOffsetX = xOff;
   weaponOffsetY = yOff;
   AimSys::CalcWeaponOffset();
 }
 
 void AimSys::SetSpaceLine(SpaceLine* SL) {
+  STACKTRACE;
   SL-&gt;pos.x = nx1;
   SL-&gt;pos.y = ny1;
   SL-&gt;angle = gamma+source-&gt;angle;
@@ -147,16 +154,19 @@
 
 
 double AimSys::RawDistance(double x1, double y1, double x2, double y2) {
+  STACKTRACE;
 	return sqrt((x2-x1)*(x2-x1) + (y2-y1)*(y2 - y1));
 	//not anti-aliased here
 }
 
 double AimSys:: CalcVectorAngle(void) {
+  STACKTRACE;
 	return AimSys::CalcVectorAngle(nx1, ny1, nx2, ny2);
 }
 
 
 double AimSys:: CalcVectorAngle(double x1, double y1, double x2, double y2) {
+  STACKTRACE;
 	//angle of the line from source to target, in normal cartesian coordinates
 	//zero degrees is going straight up.
 	//the computer uses X+ across, Y+ down.
@@ -183,6 +193,7 @@
 }
 
 int AimSys::CalcTrialValues(void) {
+  STACKTRACE;
 	//HERE is where the anti-ailasing happens!
 	//all 8 wrap-around positions are tested, along with the non
 	//wrapped one.
@@ -230,26 +241,32 @@
 }
 
 double AimSys::getPursuitAngle() {
+  STACKTRACE;
 	return pursuitAngle;
 }
 
 double AimSys::getBestTrialAlpha() {
+  STACKTRACE;
 	return bestTrialAlpha;
 }
 
 double AimSys::getBestTrialTheta() {
+  STACKTRACE;
 	return bestTrialTheta;
 }
 
 double AimSys::getAngleOfShortestDistance() {
+  STACKTRACE;
   return bestTrialEpsilon;
 }
 
 void AimSys::setNewTarget(SpaceObject* newTarget) {
+  STACKTRACE;
 	target = newTarget;
 }
 
 void AimSys::Update(void) {
+  STACKTRACE;
 	if(source==NULL||target==NULL) return;
 	nx1center = source-&gt;pos.x; ny1center = source-&gt;pos.y; 
 	nx2 = target-&gt;pos.x; ny2 = target-&gt;pos.y;
@@ -266,6 +283,7 @@
 }
 
 double AimSys::absAngleDifference(double A1, double A2) {
+  STACKTRACE;
 	double x;
 	x = fabs(A2 - A1);
 	if(x&gt;180)
@@ -276,6 +294,7 @@
 
 
 int AimSys::shouldFireNow(void) {
+  STACKTRACE;
 	// at the moment, just checks for current angle
 	//within tolerance
 	//the quick and dirty answer
@@ -293,6 +312,7 @@
 }
 
 int AimSys::shouldTurnLeft(void) {
+  STACKTRACE;
 	int x1, x2;
 	x1 = iround(source-&gt;angle-weaponAngle);
 	x2 = iround(pursuitAngle);
@@ -305,6 +325,7 @@
 }
 
 int AimSys::shouldTurnRight(void) {
+  STACKTRACE;
 	int x1, x2;
 	x1 = iround(source-&gt;angle-weaponAngle);
 	x2 = iround(pursuitAngle);

Modified: branches/multiplayer-branch/source/sc1ships/shpandgu.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shpandgu.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/sc1ships/shpandgu.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -15,10 +15,11 @@
 GNU General Public License for more details.
 */
 
+#include &quot;util/sound.h&quot;
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 #include &quot;sc1ships.h&quot;
+#include &quot;scp.h&quot;
 
 class AndrosynthBubble : public AnimatedShot {
   int courseFrames;
@@ -34,6 +35,7 @@
 AndrosynthGuardian::AndrosynthGuardian(Vector2 opos, double angle, ShipData *data, unsigned int code) :
   Ship(opos, angle, data, code)
 {
+  STACKTRACE;
 	weaponDamage       = get_config_int(&quot;Weapon&quot;, &quot;Damage&quot;, 1);
 	weaponArmour       = get_config_int(&quot;Weapon&quot;, &quot;Armour&quot;, 1);
 	weaponRange        = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 10));
@@ -58,6 +60,7 @@
 
 void AndrosynthGuardian::calculate()
 {
+  STACKTRACE;
 	Ship::calculate();
 	if(specialActive &amp;&amp; (batt == -1)) {
 		set_sprite(shipSprite);
@@ -73,6 +76,7 @@
 	}
 
 void AndrosynthGuardian::calculate_thrust() {
+  STACKTRACE;
 	if(specialActive) {
 		double dv;
 		if (bounce_status &gt; 0) {
@@ -93,30 +97,54 @@
 
 void AndrosynthGuardian::calculate_hotspots()
 {
+  STACKTRACE;
   if(specialActive)
     return;
   Ship::calculate_hotspots();
 }
 
-void AndrosynthGuardian::inflict_damage(SpaceObject *other) {
-	if (damage_factor &gt; 0) {
-		if (other-&gt;mass) {
-			game-&gt;add(new Animation(this, 
-					pos + unit_vector(trajectory_angle(other)) * 20.0,
-					meleedata.sparkSprite, 0, SPARK_FRAMES, 50, DEPTH_EXPLOSIONS));
-			translate(-specialBounceDistance*unit_vector(angle));
-			bounce_status = specialBounceTime;
-			int i = iround_down(damage_factor / 2);
-			if (i &gt;= BOOM_SAMPLES) i = BOOM_SAMPLES - 1;
-			play_sound((SAMPLE *)(melee[MELEE_BOOM + i].dat));
-			}
-		if (!other-&gt;isProtected()) damage(other, damage_factor);
-		}
-	else damage(other, 0);
-	return;
+void AndrosynthGuardian::inflict_damage(SpaceObject *other) 
+{
+  STACKTRACE;
+  if (damage_factor &gt; 0) 
+    {
+      if (other-&gt;mass) 
+	{
+	  game-&gt;add(new Animation(this, 
+				  pos + unit_vector(trajectory_angle(other)) * 20.0,
+				  game-&gt;meleedata.sparkSprite, 0, SPARK_FRAMES, 50, DEPTH_EXPLOSIONS));
+	  translate(-specialBounceDistance*unit_vector(angle));
+	  bounce_status = specialBounceTime;
+	  int i = iround_down(damage_factor / 2);
+	  if (i &gt;= BOOM_SAMPLES) i = BOOM_SAMPLES - 1;
+	  switch(i)
+	    {
+	    case 0:
+	      tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL01_WAV.wav&quot;));
+	      break;
+	    case 1:
+	      tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL02_WAV.wav&quot;));
+	      break;
+	    case 2:
+	      tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL03_WAV.wav&quot;));
+	      break;
+	    case 3:
+	      tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL04_WAV.wav&quot;));
+	      break;
+	    default:
+	      {
+		tw_error(&quot;Unknown BOOM sound&quot;);
+	      }
+	    }
 	}
+      if (!other-&gt;isProtected()) damage(other, damage_factor);
+    }
+  else damage(other, 0);
+  return;
+}
 
 int AndrosynthGuardian::activate_weapon() {
+  STACKTRACE;
   
   if(specialActive)
 	  return FALSE;
@@ -127,27 +155,30 @@
   return(TRUE);
 }
 
-int AndrosynthGuardian::activate_special() {
-	if(specialActive)
-		return(FALSE);
-
-	if (batt &lt; 1) return(FALSE);
-
-	set_sprite(specialSprite);
-
-	normalMass = mass;
-	shipTurnRate    = turn_rate;
-	shipRechargeAmount = recharge_amount;
-
-	damage_factor = specialDamage;
-	specialActive = TRUE;
-	turn_rate     = specialTurnRate;
+int AndrosynthGuardian::activate_special() 
+{
+  STACKTRACE;
+  if(specialActive)
+    return(FALSE);
   
-	recharge_step = recharge_rate;
-	recharge_amount = -1;
-	mass = specialMass;
+  if (batt &lt; 1) 
+    return(FALSE);
+  
+  set_sprite(specialSprite);
+  
+  normalMass = mass;
+  shipTurnRate    = turn_rate;
+  shipRechargeAmount = recharge_amount;
+  
+  damage_factor = specialDamage;
+  specialActive = TRUE;
+  turn_rate     = specialTurnRate;
+  
+  recharge_step = recharge_rate;
+  recharge_amount = -1;
+  mass = specialMass;
 
-	return(TRUE);
+  return(TRUE);
 }
 
 AndrosynthBubble::AndrosynthBubble(Vector2 opos, double oangle,
@@ -157,6 +188,7 @@
     osprite, ofcount, ofsize),
   courseFrames(0)
 {
+  STACKTRACE;
   explosionSprite     = data-&gt;spriteWeaponExplosion;
   explosionFrameCount = 6;
   explosionFrameSize  = 50;
@@ -164,6 +196,7 @@
 
 void AndrosynthBubble::calculate()
 {
+  STACKTRACE;
 	if (!(ship &amp;&amp; ship-&gt;exists()))
 	{
 		state = 0;

Modified: branches/multiplayer-branch/source/sc1ships/shparisk.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shparisk.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/sc1ships/shparisk.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -17,14 +17,13 @@
 
 #include &quot;ship.h&quot;
 
-REGISTER_FILE
-
 #include &quot;sc1ships.h&quot;
 
 ArilouSkiff::ArilouSkiff(Vector2 opos, double angle, ShipData *data, unsigned int code) 
 	:
 	Ship(opos, angle, data, code)
 	{
+  STACKTRACE;
 	specialSprite = data-&gt;spriteSpecial;
 
 	weaponColor  = get_config_int(&quot;Weapon&quot;, &quot;Color&quot;, 0);
@@ -38,6 +37,7 @@
 	}
 
 void ArilouSkiff::inflict_damage(SpaceObject *other) {
+  STACKTRACE;
 	if (just_teleported &amp;&amp; other-&gt;mass) {
 		damage(this, 0, 999);
 		}
@@ -46,6 +46,7 @@
 	}
 
 int ArilouSkiff::activate_weapon() {
+  STACKTRACE;
 	SpaceObject *o = NULL;
 
 	double r = 99999;  
@@ -65,6 +66,7 @@
 	}
 
 int ArilouSkiff::activate_special() {
+  STACKTRACE;
 
 	game-&gt;add(new Animation(this, pos,
 			specialSprite, 0, 40, iround(specialFrames/40), DEPTH_HOTSPOTS-0.1));
@@ -82,6 +84,7 @@
 	}
 
 void ArilouSkiff::calculate() {
+  STACKTRACE;
 	just_teleported = 0;
 	Ship::calculate();
 
@@ -90,10 +93,12 @@
 		}
 	}
 
-void ArilouSkiff::calculate_gravity() {}
+void ArilouSkiff::calculate_gravity() {
+  STACKTRACE;}
 
 int ArilouSkiff::accelerate(SpaceLocation *source, double angle, double velocity, 
 		double max_speed) {
+  STACKTRACE;
 	if (source == this) 
 		return Ship::accelerate(source, angle, velocity, max_speed);
 	return false;
@@ -101,6 +106,7 @@
 
 int ArilouSkiff::accelerate_gravwhip(SpaceLocation *source, double angle, double velocity, 
 		double max_speed) {
+  STACKTRACE;
 	if (source == this) 
 		return Ship::accelerate(source, angle, velocity, max_speed);
 	return false;

Modified: branches/multiplayer-branch/source/sc1ships/shpchebr.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shpchebr.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/sc1ships/shpchebr.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 #include &quot;sc1ships.h&quot;
 
@@ -54,6 +53,7 @@
 ChenjesuBroodhome::ChenjesuBroodhome(Vector2 opos, double angle, ShipData *data, unsigned int code) :
 	Ship(opos, angle, data, code)
 {
+  STACKTRACE;
 	weaponDamage		= get_config_int(&quot;Weapon&quot;, &quot;Damage&quot;, 0);
 	shardRange			= scale_range(get_config_int(&quot;Weapon&quot;, &quot;ShardRange&quot;, 0));
 	shardDamage			= get_config_int(&quot;Weapon&quot;, &quot;ShardDamage&quot;, 0);
@@ -77,6 +77,7 @@
 
 int ChenjesuBroodhome::activate_weapon()
 {
+  STACKTRACE;
 	if(weaponFired)
 		return(FALSE);
 	weaponObject = new ChenjesuShot(Vector2(0.0, (size.y / 2.0)), angle,
@@ -88,6 +89,7 @@
 
 int ChenjesuBroodhome::activate_special()
 {
+  STACKTRACE;
 	if(specialNumDOGIs &gt;= MAX_DOGIS)
 		return(FALSE);
 	ChenjesuDOGI* DOGI; //added by Varith
@@ -103,6 +105,7 @@
 
 void ChenjesuBroodhome::calculate()
 {
+  STACKTRACE;
 	int i;
 
 	Ship::calculate();
@@ -120,8 +123,7 @@
 			shot-&gt;collide_flag_sameship = bit(LAYER_SPECIAL);
 			game-&gt;add(shot);
 		}
-//		weaponObject-&gt;play_sound2(data-&gt;sampleExtra[0]);
-		weaponObject-&gt;play_sound(data-&gt;sampleExtra[0]);
+		tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleExtra[0]));
 		weaponObject-&gt;destroy();
 		weaponObject = NULL;
 	}
@@ -132,6 +134,7 @@
 	int odamage, int oarmour, SpaceLocation *creator, SpaceSprite *osprite) :
 	Missile(creator, opos, oangle, ov, odamage, -1.0, oarmour, creator, osprite)
 {
+  STACKTRACE;
 	collide_flag_sameship = bit(LAYER_SPECIAL);
 	explosionSprite     = data-&gt;spriteWeaponExplosion;
 	explosionFrameCount = 20;
@@ -140,6 +143,7 @@
 
 void ChenjesuShot::inflict_damage(SpaceObject *other)
 {
+  STACKTRACE;
 	Shot::inflict_damage(other);
 	if ((other-&gt;mass &gt; 0) &amp;&amp; !exists())
 		if (other-exists())
@@ -154,6 +158,7 @@
 
 void ChenjesuShot::animateExplosion()
 {
+  STACKTRACE;
 	return;
 }
 
@@ -163,6 +168,7 @@
 	AnimatedShot(oship, opos, ov, oangle, 0, -1.0, oarmour, oship, osprite, 64, 50),
 	sap_factor(fuel_sap), accel_rate(accel), num_dogis(onum_dogis)
 {
+  STACKTRACE;
 	layer = LAYER_SPECIAL;
 	set_depth(DEPTH_SPECIAL);
 	mass = omass;
@@ -172,6 +178,7 @@
 
 void ChenjesuDOGI::calculate()
 {
+  STACKTRACE;
 	AnimatedShot::calculate();
 
 	if (ship &amp;&amp; ship-&gt;exists()) {
@@ -197,25 +204,29 @@
 
 void ChenjesuDOGI::inflict_damage(SpaceObject *other)
 {
-	play_sound(data-&gt;sampleExtra[1]);
+  STACKTRACE;
+  tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleExtra[1]));
 
-	if(sameTeam(other)) return;
+  if(sameTeam(other)) 
+    return;
 
-	other-&gt;handle_fuel_sap(this, sap_factor);
-	double a = trajectory_angle(other);
-	accelerate(this, a, -v, MAX_SPEED);
-	if (other-&gt;mass &gt; mass/100.0)
-		other-&gt;accelerate(this, a, v*3*mass/other-&gt;mass, v);
-	return;
+  other-&gt;handle_fuel_sap(this, sap_factor);
+  double a = trajectory_angle(other);
+  accelerate(this, a, -v, MAX_SPEED);
+  if (other-&gt;mass &gt; mass/100.0)
+    other-&gt;accelerate(this, a, v*3*mass/other-&gt;mass, v);
+  return;
 }
 
 void ChenjesuDOGI::death()
 {
+  STACKTRACE;
 	if (num_dogis) (*num_dogis)--;
 }
 
 void ChenjesuDOGI::ship_died()
 {
+  STACKTRACE;
 	num_dogis = NULL;
 	SpaceObject::ship_died();
 	state = 0;
@@ -224,14 +235,17 @@
 
 void ChenjesuDOGI::animateExplosion()
 {
+  STACKTRACE;
 	game-&gt;add(new Animation(this, pos,
 		data-&gt;spriteSpecialExplosion, 0, 20, 25, DEPTH_EXPLOSIONS));
 }
 
 void ChenjesuDOGI::soundExplosion()
 {
-	play_sound2(data-&gt;sampleExtra[2]);
-	return;
+  STACKTRACE;
+  tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleExtra[2]));
+  tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleExtra[2]));
+  return;
 }
 
 

Modified: branches/multiplayer-branch/source/sc1ships/shpearcr.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shpearcr.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/sc1ships/shpearcr.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -14,11 +14,12 @@
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.
 */
- 
+
+#include &quot;util/sound.h&quot; 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 #include &quot;sc1ships.h&quot;
+#include &quot;scp.h&quot;
 
 class EarthlingMissile : public HomingMissile {
   public:
@@ -31,6 +32,7 @@
 	:
 	Ship(opos, angle, data, code)
 	{
+  STACKTRACE;
 
   weaponRange    = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
   weaponVelocity = scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
@@ -47,33 +49,43 @@
 }
 
 int EarthlingCruiser::activate_weapon() {
+  STACKTRACE;
 	game-&gt;add(new EarthlingMissile(
 		Vector2(0.0, (size.y * 1.0)), angle, weaponVelocity, weaponDamage, weaponRange,
 		weaponArmour, weaponTurnRate, this, data-&gt;spriteWeapon));
 	return(TRUE);
 }
 
-int EarthlingCruiser::activate_special() {
-	int fire = FALSE;
-	SpaceObject *o;
-
-	Query a;
-	for (a.begin(this, bit(LAYER_SHIPS) + bit(LAYER_SHOTS) + bit(LAYER_SPECIAL) + 
-			bit(LAYER_CBODIES), specialRange); a.current; a.next()) {
-		o = a.currento;
-		if( (!o-&gt;isInvisible()) &amp;&amp; !o-&gt;sameTeam(this) &amp;&amp; (o-&gt;collide_flag_anyone &amp; bit(LAYER_LINES))) {
-			SpaceLocation *l = new PointLaser(this, pallete_color[specialColor], 1, 
-					specialFrames, this, o, Vector2(0.0, 10.0));
-			game-&gt;add(l);
-			if (l-&gt;exists()) {
-                                fire = TRUE;
-                                l-&gt;set_depth(LAYER_EXPLOSIONS); }
-			}
-		}
-	if (fire) play_sound((SAMPLE *)(melee[MELEE_BOOM + 0].dat));
-
-	return(fire);
+int EarthlingCruiser::activate_special() 
+{
+  STACKTRACE;
+  int fire = FALSE;
+  SpaceObject *o;
+  
+  Query a;
+  for (a.begin(this, bit(LAYER_SHIPS) + bit(LAYER_SHOTS) + bit(LAYER_SPECIAL) + 
+	       bit(LAYER_CBODIES), specialRange); a.current; a.next()) 
+    {
+      o = a.currento;
+      if( (!o-&gt;isInvisible()) &amp;&amp; !o-&gt;sameTeam(this) &amp;&amp; (o-&gt;collide_flag_anyone &amp; bit(LAYER_LINES))) 
+	{
+	  SpaceLocation *l = new PointLaser(this, pallete_color[specialColor], 1, 
+					    specialFrames, this, o, Vector2(0.0, 10.0));
+	  game-&gt;add(l);
+	  if (l-&gt;exists()) 
+	    {
+	      fire = TRUE;
+	      l-&gt;set_depth(LAYER_EXPLOSIONS); 
+	    }
 	}
+    }
+  if (fire) 
+    {
+      tw_sound-&gt;play_sound(data_full_path(&quot;sound/boom/BOOMPL01_WAV.wav&quot;));
+    }
+  
+  return(fire);
+}
 
 EarthlingMissile::EarthlingMissile(Vector2 opos, double oangle,
   double ov, int odamage, double orange, int oarmour, double otrate,
@@ -81,6 +93,7 @@
   HomingMissile(oship, opos, oangle, ov, odamage, orange, oarmour, otrate, 
 		oship, osprite, oship-&gt;target)
 {
+  STACKTRACE;
 	collide_flag_sameship = bit(LAYER_SHIPS) | bit(LAYER_SHOTS);
   explosionSprite     = data-&gt;spriteWeaponExplosion;
   explosionFrameCount = 10;

Modified: branches/multiplayer-branch/source/sc1ships/shpilwav.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shpilwav.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/sc1ships/shpilwav.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 #include &quot;sc1ships.h&quot;
 
@@ -26,6 +25,7 @@
 	:
 	Ship(opos, angle, data, code)
 {
+  STACKTRACE;
   weaponRange    = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
   weaponVelocity = scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
   weaponDamage   = get_config_int(&quot;Weapon&quot;, &quot;Damage&quot;, 0);
@@ -42,6 +42,7 @@
 	}
 
 int IlwrathAvenger::activate_weapon() {
+  STACKTRACE;
 	// note that target=0 is only set after this routine is called in ship::calculate
 	// so we need to check if it exists ...
 	if (cloak &amp;&amp; target &amp;&amp; target-&gt;exists()) {
@@ -61,6 +62,7 @@
 
 void IlwrathAvenger::calculate_fire_special()
 {
+  STACKTRACE;
   special_low = FALSE;
 
   if(fire_special) {
@@ -72,28 +74,32 @@
     if(special_recharge &gt; 0)
       return;
 
-    if(cloak) {
-      cloak = FALSE;
+    if(cloak) 
+      {
+	cloak = FALSE;
+      } 
+    else 
+      {
+	cloak = TRUE;
+	tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleSpecial[0]));
+	tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleSpecial[0]));
+	batt -= special_drain;
+      }
 
-      play_sound2(data-&gt;sampleSpecial[1]);
-    } else {
-      cloak = TRUE;
-      play_sound2(data-&gt;sampleSpecial[0]);
-      batt -= special_drain;
-    }
-
     special_recharge = special_rate;
   }
 }
 
 void IlwrathAvenger::calculate_hotspots()
 {
+  STACKTRACE;
   if(!cloak)
     Ship::calculate_hotspots();
 }
 
 void IlwrathAvenger::calculate()
 {
+  STACKTRACE;
   if((cloak) &amp;&amp; (cloak_frame &lt; 300))
     cloak_frame += frame_time;
   if((!cloak) &amp;&amp; (cloak_frame &gt; 0))
@@ -103,6 +109,7 @@
 }
 
 void IlwrathAvenger::animate(Frame *space) {
+  STACKTRACE;
 	if((cloak_frame &gt; 0) &amp;&amp; (cloak_frame &lt; 300))
 		sprite-&gt;animate_character( pos, sprite_index, 
 				pallete_color[cloak_color[cloak_frame / 100]], space);

Modified: branches/multiplayer-branch/source/sc1ships/shpkzedr.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shpkzedr.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/sc1ships/shpkzedr.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
  
 #include &quot;ship.h&quot;
-REGISTER_FILE
 #include &quot;melee/mview.h&quot;
 
 #include &quot;sc1ships.h&quot;
@@ -52,6 +51,7 @@
 	:
 	Ship(opos, angle, data, code) 
 	{
+  STACKTRACE;
 	weaponRange         = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
 	weaponVelocity      = scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
 	weaponDamage        = get_config_int(&quot;Weapon&quot;, &quot;Damage&quot;, 0);
@@ -69,6 +69,7 @@
 	}
 
 int KzerZaDreadnought::activate_weapon() {
+  STACKTRACE;
 	game-&gt;add( new KzerZaMissile(
 			Vector2(0.0, (size.y / 2.0)), angle, weaponVelocity, weaponDamage, weaponRange,
 			weaponArmour, this, data-&gt;spriteWeapon) );
@@ -76,6 +77,7 @@
 	}
 
 int KzerZaDreadnought::activate_special() {
+  STACKTRACE;
 	if(crew &gt; 1) {
 		game-&gt;add( new KzerZaFighter(Vector2(-25.0, -50.0),
 				angle - PI*7.0/8 , specialVelocity, specialRange, specialArmour,
@@ -102,6 +104,7 @@
 	:
 	Missile(oship, opos, oangle, ov, odamage, orange, oarmour, oship,osprite) 
 	{
+  STACKTRACE;
 	explosionSprite     = data-&gt;spriteWeaponExplosion;
 	explosionFrameCount = 20;
 	explosionFrameSize  = 50;
@@ -126,85 +129,107 @@
 	set_depth(DEPTH_SPECIAL);
 	}
 
-void KzerZaFighter::calculate() {
-	Missile::calculate();
+void KzerZaFighter::calculate() 
+{
+  STACKTRACE;
+  Missile::calculate();
 
-	if (!(ship &amp;&amp; ship-&gt;exists()))
+  if (!(ship &amp;&amp; ship-&gt;exists()))
+    {
+      ship = 0;	// not really needed but well.
+      state = 0;
+      return;
+    }
+  air_frames -= frame_time;
+  if (air_frames &lt;= 0) 
+    {
+      state = 0;
+      return;
+    }
+  if (air_frames &gt; max_air_frames - 350) 
+    return;
+  
+  target = ship-&gt;target;
+  if((target == NULL) || (air_frames &lt; (max_air_frames / 2)) || target-&gt;isInvisible()) 
+    {
+      collide_flag_sameship |= bit(LAYER_SHIPS);
+      changeDirection(trajectory_angle(ship));
+      return;
+    }
+  collide_flag_sameship &amp;= ~bit(LAYER_SHIPS);
+  
+  if ((distance(target) &lt; laser_range) &amp;&amp; (batt &lt;= 0)) 
+    {
+      collide_flag_sameship = 0;
+      vel = 0;
+      tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleExtra[0]));
+      tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleExtra[0]));
+      
+      add(new Laser(this, trajectory_angle(target),
+		    pallete_color[laser_color], laser_range, laser_damage,
+		    laser_frames, this, Vector2(0.0, -size.y / 2.0)));
+      batt = recharge_frames;
+    }
+  else 
+    {
+      Vector2 t = target-&gt;normal_pos();
+      double ta = target-&gt;get_angle();
+      double a = target-&gt;trajectory_angle(this) - target-&gt;get_angle();
+      a = normalize(a,PI2);
+      Vector2 l = t + unit_vector(ta+PI/2) * laser_range * 0.8;
+      Vector2 r = t + unit_vector(ta+PI*3/2) * laser_range * 0.8;
+      double d_l = distance_from(pos, l);
+      double d_r = distance_from(pos, r);
+      double d2t;
+      if (d_l &lt; d_r) 
 	{
-		ship = 0;	// not really needed but well.
-		state = 0;
-		return;
-		}
-	air_frames -= frame_time;
-	if (air_frames &lt;= 0) {
-		state = 0;
-		return;
-		}
-	if (air_frames &gt; max_air_frames - 350) return;
-
-	target = ship-&gt;target;
-	if((target == NULL) || (air_frames &lt; (max_air_frames / 2)) || target-&gt;isInvisible()) {
-		collide_flag_sameship |= bit(LAYER_SHIPS);
-		changeDirection(trajectory_angle(ship));
-		return;
-		}
-	collide_flag_sameship &amp;= ~bit(LAYER_SHIPS);
-
-	if ((distance(target) &lt; laser_range) &amp;&amp; (batt &lt;= 0)) {
-		collide_flag_sameship = 0;
-		vel = 0;
-		play_sound2(data-&gt;sampleExtra[0]);
-		add(new Laser(this, trajectory_angle(target),
-				pallete_color[laser_color], laser_range, laser_damage,
-				laser_frames, this, Vector2(0.0, -size.y / 2.0)));
-		batt = recharge_frames;
-		}
-	else {
-		Vector2 t = target-&gt;normal_pos();
-		double ta = target-&gt;get_angle();
-		double a = target-&gt;trajectory_angle(this) - target-&gt;get_angle();
-		a = normalize(a,PI2);
-		Vector2 l = t + unit_vector(ta+PI/2) * laser_range * 0.8;
-		Vector2 r = t + unit_vector(ta+PI*3/2) * laser_range * 0.8;
-		double d_l = distance_from(pos, l);
-		double d_r = distance_from(pos, r);
-		double d2t;
-		if (d_l &lt; d_r) {
-			angle = atan(min_delta(l, pos));
-			d2t = d_l;
-			}
-		else {
-			angle = atan(min_delta(r, pos));
-			d2t = d_r;
-			}
-		if (d2t &gt; 20) d2t = 20;
-		vel = v * unit_vector(angle) * d2t / 20;
-		sprite_index = get_index(angle);
-		}
-
-	if (batt) batt -= frame_time;
+	  angle = atan(min_delta(l, pos));
+	  d2t = d_l;
 	}
+      else 
+	{
+	  angle = atan(min_delta(r, pos));
+	  d2t = d_r;
+	}
+      if (d2t &gt; 20) 
+	d2t = 20;
+      vel = v * unit_vector(angle) * d2t / 20;
+      sprite_index = get_index(angle);
+    }
+  
+  if (batt) 
+    batt -= frame_time;
+}
 
 
-int KzerZaFighter::handle_damage(SpaceLocation *source, double normal, double direct){
-	if (source-&gt;isPlanet()) {
-		state = 1;
-	}
-	else state = 0;
-	return 0;
+int KzerZaFighter::handle_damage(SpaceLocation *source, double normal, double direct)
+{
+  STACKTRACE;
+  if (source-&gt;isPlanet()) 
+    {
+      state = 1;
+    }
+  else 
+    state = 0;
+  return 0;
 }
 
-void KzerZaFighter::inflict_damage(SpaceObject *other) {
-	if (other == ship) {
-		play_sound2(data-&gt;sampleExtra[1]);
-		damage(ship, 0, -1);
-	} 
-	if (!other-&gt;isPlanet()) state = 0;
-	else {
-		double a = trajectory_angle(other);
-		translate(unit_vector(a) * -10);
-	}
-	return;
+void KzerZaFighter::inflict_damage(SpaceObject *other) 
+{
+  STACKTRACE;
+  if (other == ship) 
+    {
+      tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleExtra[1]));
+      tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleExtra[1]));
+      damage(ship, 0, -1);
+    } 
+  if (!other-&gt;isPlanet()) state = 0;
+  else 
+    {
+      double a = trajectory_angle(other);
+      translate(unit_vector(a) * -10);
+    }
+  return;
 }
 
 

Modified: branches/multiplayer-branch/source/sc1ships/shpmmrxf.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shpmmrxf.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/sc1ships/shpmmrxf.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
  
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 #define T_FORM 0
 #define Y_FORM 1
@@ -31,6 +30,7 @@
 	laser2(NULL),
 	laserSpark(0)
 	{
+  STACKTRACE;
 	form_data[T_FORM].speed_max       = speed_max;
 	form_data[T_FORM].accel_rate      = accel_rate;
 	form_data[T_FORM].turn_rate       = turn_rate;
@@ -79,13 +79,14 @@
 
 void MmrnmhrmXForm::calculate()
 {
+  STACKTRACE;
   if(laserSpark &gt; 0) {
     laserSpark-= frame_time;
     if((laserSpark &lt;= 0) &amp;&amp; (laserSpark &gt; -frame_time)) {
       if ((laser1-&gt;damage_factor &gt; 0) &amp;&amp; (laser2-&gt;damage_factor &gt; 0))
         add(new Animation(this, 
           laser1-&gt;normal_pos() + laser1-&gt;edge(),
-          meleedata.sparkSprite, 0, SPARK_FRAMES, 50, DEPTH_EXPLOSIONS));
+          game-&gt;meleedata.sparkSprite, 0, SPARK_FRAMES, 50, DEPTH_EXPLOSIONS));
       laser1 = NULL;
       laser2 = NULL;
     }
@@ -96,6 +97,7 @@
 
 int MmrnmhrmXForm::activate_weapon()
 {
+  STACKTRACE;
   if(form == T_FORM) {
     add(laser1 = new Laser(this, angle + laserAngle,
       pallete_color[laserColor], laserRange, laserDamage, weapon_rate, this,
@@ -118,6 +120,7 @@
 
 int MmrnmhrmXForm::activate_special()
 {
+  STACKTRACE;
 	form_data[form].speed_max       = speed_max;
 	form_data[form].accel_rate      = accel_rate;
 	form_data[form].turn_rate       = turn_rate;
@@ -142,6 +145,7 @@
 }
 
 double MmrnmhrmXForm::handle_speed_loss(SpaceLocation *source, double normal) {
+  STACKTRACE;
 	Ship::handle_speed_loss(source, normal);
 	if (normal) {
 		activate_special();

Modified: branches/multiplayer-branch/source/sc1ships/shpmycpo.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shpmycpo.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/sc1ships/shpmycpo.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
  
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 #include &quot;sc1ships.h&quot;
 
@@ -42,6 +41,7 @@
 	:
 	Ship(opos, angle, data, code)
 {
+  STACKTRACE;
   weaponRange    = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
   weaponVelocity = scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
   weaponDamage   = get_config_int(&quot;Weapon&quot;, &quot;Damage&quot;, 0);
@@ -51,6 +51,7 @@
 
 int MyconPodship::activate_weapon()
 {
+  STACKTRACE;
   add(new MyconPlasma(Vector2(0.0, size.y),
     angle, weaponVelocity, weaponDamage, weaponRange, weaponHome, this,
     data-&gt;spriteWeapon, 64));
@@ -59,6 +60,7 @@
 
 int MyconPodship::activate_special()
 {
+  STACKTRACE;
   if(crew &gt;= crew_max)
     return(FALSE);
   damage(this, 0, -4);
@@ -75,6 +77,7 @@
   frame_count(ofcount),
   max_damage(odamage)
 {
+  STACKTRACE;
 	spriteWeaponExplosion = data-&gt;spriteWeaponExplosion;
 	collide_flag_sameship |= bit(LAYER_SHIPS);
 	collide_flag_sameteam |= bit(LAYER_SHIPS);
@@ -82,6 +85,7 @@
 
 void MyconPlasma::calculate()
 {
+  STACKTRACE;
   HomingMissile::calculate();
 
   sprite_index = (int)((d / range) * (double)(frame_count - 1));
@@ -90,6 +94,7 @@
 
 void MyconPlasma::inflict_damage(SpaceObject *other)
 {
+  STACKTRACE;
   SpaceObject::inflict_damage(other);
   //if (!other-&gt;isShot()) {
   if (other-&gt;isblockingweapons)
@@ -107,6 +112,7 @@
 }
 
 int MyconPlasma::handle_damage(SpaceLocation *source, double normal, double direct) {
+  STACKTRACE;
 	double total = normal + direct;
 
 	if (total) {

Modified: branches/multiplayer-branch/source/sc1ships/shpshosc.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shpshosc.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/sc1ships/shpshosc.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
  
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 #include &quot;sc1ships.h&quot;
 
@@ -24,6 +23,7 @@
 	:
 	Ship(opos, angle, data, code)
 {
+  STACKTRACE;
   weaponRange    = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
   weaponVelocity = scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
   weaponDamage   = get_config_int(&quot;Weapon&quot;, &quot;Damage&quot;, 0);
@@ -40,55 +40,57 @@
 
 int ShofixtiScout::activate_weapon()
 {
+  STACKTRACE;
   add(new Missile(this, Vector2(0.0, size.y / 2.0),
     angle, weaponVelocity, weaponDamage, weaponRange, weaponArmour,
     this, data-&gt;spriteWeapon));
   return(TRUE);
 }
 
-void ShofixtiScout::calculate_fire_special() {
-	int gloryDamage;
-
-	if(fire_special) {
-		if(!flipSwitch) {
-			flipSwitch = TRUE;
-			glory++;
-			if(glory == 3) {
-				Query q;
-				for (q.begin(this, OBJECT_LAYERS, specialRange); q.currento; q.next()) {
-					if (q.currento-&gt;canCollide(this)) {
-						gloryDamage = (int)ceil((specialRange - distance(q.currento)) / specialRange * specialDamage);
-						damage(q.current, 0, gloryDamage);
-						}
-					}
-				q.end();
-				add(new Animation(this, pos, data-&gt;spriteSpecial, 
-						0, specialFrames, 50, DEPTH_EXPLOSIONS, specialScale));
-				play_sound2(data-&gt;sampleSpecial[0]);
-				damage(this, 0, 999);
-				}
-			else {
-				spritePanel-&gt;overlay(1, 5+glory, spritePanel-&gt;get_bitmap(2));
-				spritePanel-&gt;overlay(1, 5+glory, spritePanel-&gt;get_bitmap(3));
-				spritePanel-&gt;overlay(1, 5+glory, spritePanel-&gt;get_bitmap(4));
-				spritePanel-&gt;overlay(1, 5+glory, spritePanel-&gt;get_bitmap(5));
-				spritePanel-&gt;overlay(1, 5+glory, spritePanel-&gt;get_bitmap(1));
-/*				blit(data-&gt;bitmapPanel[5 + glory], panelBitmap[1], 0, 23, 0, 23,
-						CAPTAIN_WIDTH, 7);
-				blit(data-&gt;bitmapPanel[5 + glory], panelBitmap[2], 0, 23, 0, 23,
-						CAPTAIN_WIDTH, 7);
-				blit(data-&gt;bitmapPanel[5 + glory], panelBitmap[3], 0, 23, 0, 23,
-						CAPTAIN_WIDTH, 7);
-				blit(data-&gt;bitmapPanel[5 + glory], panelBitmap[4], 0, 23, 0, 23,
-						CAPTAIN_WIDTH, 7);
-				blit(data-&gt;bitmapPanel[5 + glory], panelBitmap[5], 0, 23, 0, 23,
-						CAPTAIN_WIDTH, 7);*/
-				}
-			}
+void ShofixtiScout::calculate_fire_special() 
+{
+  STACKTRACE;
+  int gloryDamage;
+  
+  if(fire_special) 
+    {
+      if(!flipSwitch) 
+	{
+	  flipSwitch = TRUE;
+	  glory++;
+	  if(glory == 3) 
+	    {
+	      Query q;
+	      for (q.begin(this, OBJECT_LAYERS, specialRange); q.currento; q.next()) 
+		{
+		  if (q.currento-&gt;canCollide(this)) 
+		    {
+		      gloryDamage = (int)ceil((specialRange - distance(q.currento)) / 
+					      specialRange * specialDamage);
+		      damage(q.current, 0, gloryDamage);
+		    }
 		}
-	else flipSwitch = FALSE;
-	return;
+	      q.end();
+	      add(new Animation(this, pos, data-&gt;spriteSpecial, 
+				0, specialFrames, 50, DEPTH_EXPLOSIONS, specialScale));
+	      tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleSpecial[0]));
+	      tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleSpecial[0]));
+	      damage(this, 0, 999);
+	    }
+	  else 
+	    {
+	      spritePanel-&gt;overlay(1, 5+glory, spritePanel-&gt;get_bitmap(2));
+	      spritePanel-&gt;overlay(1, 5+glory, spritePanel-&gt;get_bitmap(3));
+	      spritePanel-&gt;overlay(1, 5+glory, spritePanel-&gt;get_bitmap(4));
+	      spritePanel-&gt;overlay(1, 5+glory, spritePanel-&gt;get_bitmap(5));
+	      spritePanel-&gt;overlay(1, 5+glory, spritePanel-&gt;get_bitmap(1));
+	    }
 	}
+    }
+  else 
+    flipSwitch = FALSE;
+  return;
+}
 
 
 

Modified: branches/multiplayer-branch/source/sc1ships/shpspael.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shpspael.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/sc1ships/shpspael.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 #include &quot;sc1ships.h&quot;
 
@@ -24,6 +23,7 @@
 	:
 	Ship(opos, angle, data, code)
 {
+  STACKTRACE;
 
 	weaponRange    = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
 	weaponVelocity = scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
@@ -39,6 +39,7 @@
 
 int SpathiEluder::activate_weapon()
 {
+  STACKTRACE;
 	add(new Missile( this, Vector2(0.0, size.y / 2.0),
 		angle, weaponVelocity, weaponDamage, weaponRange, weaponArmour,
 		this, data-&gt;spriteWeapon));
@@ -47,6 +48,7 @@
 
 int SpathiEluder::activate_special()
 {
+  STACKTRACE;
 	SpaceLocation *tmp = new HomingMissile( this, 
 		Vector2(0.0, -size.y / 1.5), angle + PI, specialVelocity, specialDamage, specialRange, 
 		specialArmour, specialTurnRate, this, data-&gt;spriteSpecial, target);

Modified: branches/multiplayer-branch/source/sc1ships/shpsyrpe.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shpsyrpe.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/sc1ships/shpsyrpe.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 #include &quot;sc1ships.h&quot;
 
@@ -44,6 +43,7 @@
 	:
 	Ship(opos, angle, data, code)
 {
+  STACKTRACE;
 
 	weaponRange    = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
 	weaponVelocity = scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
@@ -58,6 +58,7 @@
 
 int SyreenPenetrator::activate_weapon()
 {
+  STACKTRACE;
 	Missile *m;
 	m = new Missile(this, Vector2(0.0, size.y / 2.0 + 10),
 			angle, weaponVelocity, weaponDamage, weaponRange, weaponArmour,
@@ -69,6 +70,7 @@
 }
 
 int SyreenPenetrator::activate_special() {
+  STACKTRACE;
 	double minDist;
 	minDist = specialRange + (size.x / 2.0);
 	int j;
@@ -113,6 +115,7 @@
   life(0),
   lifetime(oLifeTime)
 {
+  STACKTRACE;
 	collide_flag_sameship = ALL_LAYERS;
 	collide_flag_sameteam = ALL_LAYERS;
 	layer = LAYER_SPECIAL;
@@ -122,10 +125,12 @@
 }
 
 int CrewPod::sameTeam(SpaceLocation *other) {
+  STACKTRACE;
 	return true;
 	}
 
 void CrewPod::calculate() {
+  STACKTRACE;
 	frame_step += frame_time;
 	while (frame_step &gt;= frame_size) {
 		frame_step -= frame_size;
@@ -149,16 +154,19 @@
 
 void CrewPod::inflict_damage(SpaceObject *other)
 {
-  if (other-&gt;isShip() &amp;&amp; other-&gt;damage_factor == 0) {
-    sound.stop(data-&gt;sampleExtra[0]);
-    sound.play(data-&gt;sampleExtra[0]);
-	damage(other, 0, -1);
-		state = 0;
+  STACKTRACE;
+  if (other-&gt;isShip() &amp;&amp; other-&gt;damage_factor == 0) 
+    {
+      tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleExtra[0]));
+      tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleExtra[0]));
+      damage(other, 0, -1);
+      state = 0;
   }
 }
 
 int CrewPod::handle_damage(SpaceLocation *source, double normal, double direct)
 {
+  STACKTRACE;
 	state = 0;
 	return 0;
 }

Modified: branches/multiplayer-branch/source/sc1ships/shpumgdr.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shpumgdr.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/sc1ships/shpumgdr.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 #include &quot;sc1ships.h&quot;
 
@@ -44,6 +43,7 @@
 	:
 	Ship(opos, angle, data, code)
 {
+  STACKTRACE;
 
   weaponDamage   = get_config_int(&quot;Weapon&quot;, &quot;Damage&quot;, 0);
   specialRate    = special_rate;
@@ -54,12 +54,14 @@
 }
 
 int UmgahDrone::activate_weapon() {
+  STACKTRACE;
   firing = true;
   return(TRUE);
 }
 
 int UmgahDrone::activate_special()
 {
+  STACKTRACE;
   special_rate = specialRate;
   vel = 0;
   pos -= (unit_vector(angle) * size.x * 2.0);
@@ -69,12 +71,14 @@
 
 void UmgahDrone::calculate_thrust()
 {
+  STACKTRACE;
   if(special_recharge &lt;= 0)
     Ship::calculate_thrust();
 }
 
 void UmgahDrone::calculate()
 {
+  STACKTRACE;
   if (fire_weapon)
     recharge_step = recharge_rate;
   else
@@ -88,6 +92,7 @@
   SpaceObject(oship, oship-&gt;normal_pos(), 0.0, osprite),
   dist(odist)
 {
+  STACKTRACE;
 	layer = LAYER_SHOTS;
 	set_depth(DEPTH_SHIPS - 0.1);
 
@@ -110,11 +115,13 @@
 }
 
 bool UmgahCone::change_owner(SpaceLocation *new_owner) {
+  STACKTRACE;
 	return false;
 	}
 
 void UmgahCone::calculate()
 {
+  STACKTRACE;
 	SpaceObject::calculate();
 
 	if(!(ship &amp;&amp; ship-&gt;exists()))
@@ -141,6 +148,7 @@
 
 void UmgahCone::inflict_damage(SpaceObject *other)
 {
+  STACKTRACE;
   switch (damage_type) {
     case 0: {
             residual_damage = damage * frame_time / 2.0;
@@ -169,6 +177,7 @@
 }
 
 int UmgahCone::canCollide(SpaceLocation* other) {
+  STACKTRACE;
 //  calc_base();
   if (umgahship &amp;&amp; umgahship-&gt;exists())
 	return (umgahship-&gt;firing &amp; !other-&gt;isPlanet());
@@ -177,6 +186,7 @@
 }
 
 void UmgahCone::animate(Frame* space) {
+  STACKTRACE;
 //  calc_base();
   if (!umgahship || !umgahship-&gt;exists() || !umgahship-&gt;firing) return;
   int si = sprite_index;

Modified: branches/multiplayer-branch/source/sc1ships/shpvuxin.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shpvuxin.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/sc1ships/shpvuxin.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 #include &quot;sc1ships.h&quot;
 
@@ -36,6 +35,7 @@
 	Ship(opos, angle, data, code)
 
 {
+  STACKTRACE;
   weaponColor  = get_config_int(&quot;Weapon&quot;, &quot;Color&quot;, 0);
   weaponRange  = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
   weaponDamage = get_config_int(&quot;Weapon&quot;, &quot;Damage&quot;, 0);
@@ -48,6 +48,7 @@
 
 int VuxIntruder::activate_weapon()
 {
+  STACKTRACE;
   add(new Laser(this, angle,
     pallete_color[weaponColor], weaponRange, weaponDamage, weapon_rate,
     this, Vector2(size.x/11, (size.y / 2.07)), true));
@@ -56,6 +57,7 @@
 
 int VuxIntruder::activate_special()
 {
+  STACKTRACE;
   add(new VuxLimpet(Vector2(0, -size.y / 2.8),
     specialVelocity, specialSlowdown, specialRange, specialArmour, this,
     data-&gt;spriteSpecial, 100, 5));
@@ -69,6 +71,7 @@
     ofcount, ofsize),
   slowdown_factor(slowdown)
 {
+  STACKTRACE;
   if((ship-&gt;target) &amp;&amp; (!ship-&gt;target-&gt;isInvisible()))
     angle = trajectory_angle(ship-&gt;target);
   else
@@ -85,6 +88,7 @@
 
 void VuxLimpet::calculate()
 {
+  STACKTRACE;
 	if(!(ship &amp;&amp; ship-&gt;exists())) {
 		state = 0;
 		return;
@@ -97,105 +101,111 @@
 	AnimatedShot::calculate();
 	}
 
-void VuxLimpet::inflict_damage(SpaceObject *other) {
-	if(!other-&gt;isShip()) {
-		if (other-&gt;damage_factor || other-&gt;mass) state = 0;
-		return;
-		}
+void VuxLimpet::inflict_damage(SpaceObject *other) 
+{
+  STACKTRACE;
+  if(!other-&gt;isShip()) 
+    {
+      if (other-&gt;damage_factor || other-&gt;mass) state = 0;
+      return;
+    }
 
-	Ship *target = (Ship *) other;
+  Ship *target = (Ship *) other;
 
-	play_sound(data-&gt;sampleSpecial[1]);
+  tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleSpecial[1]));
 
-	//MYCODE begin
-	int hx,hy,tries, col;
-
-	if ( target-&gt;spritePanel )
+  //MYCODE begin
+  int hx,hy,tries, col;
+  
+  if ( target-&gt;spritePanel )
+    {
+      BITMAP *bmp = target-&gt;spritePanel-&gt;get_bitmap(0);
+      //find a random spot on the target ship where it &quot;exist&quot; 
+      tries = 0;
+      while (tries &lt; 10) 
 	{
-		BITMAP *bmp = target-&gt;spritePanel-&gt;get_bitmap(0);
-		//find a random spot on the target ship where it &quot;exist&quot; 
-		tries = 0;
-		while (tries &lt; 10) {
-			hx = 18 + (rand() % 27);	//graphics
-			hy = 15 + (rand() % 36);	//graphics
-			tries++;
-			col = getpixel(bmp,hx,hy);
-			if (col == bitmap_mask_color(bmp)) continue;
-			if (col == 0) continue;
-			if (col == -1) continue;
-			if (col == palette_color[8]) continue;
-			break;
-		} 
-		
-		// draw the Limplet on the ship panel
-		//BITMAP *s = sprite-&gt;get_bitmap(sprite_index);
-		//stretch_sprite(bmp, s, hx - s-&gt;w/4, hy - s-&gt;h/4,	s-&gt;w/2, s-&gt;h/2 );
-		sprite-&gt;draw(Vector2(hx,hy)-sprite-&gt;size()/4,
-			sprite-&gt;size()/2, 
-			sprite_index, bmp);
-		target-&gt;update_panel = TRUE;
-	}
+	  hx = 18 + (rand() % 27);	//graphics
+	  hy = 15 + (rand() % 36);	//graphics
+	  tries++;
+	  col = getpixel(bmp,hx,hy);
+	  if (col == bitmap_mask_color(bmp)) continue;
+	  if (col == 0) continue;
+	  if (col == -1) continue;
+	  if (col == palette_color[8]) continue;
+	  break;
+	} 
+      
+      // draw the Limplet on the ship panel
+      sprite-&gt;draw(Vector2(hx,hy)-sprite-&gt;size()/4,
+		   sprite-&gt;size()/2, 
+		   sprite_index, bmp);
+      target-&gt;update_panel = TRUE;
+    }
+  
+  target-&gt;handle_speed_loss(this, slowdown_factor);
+  state = 0;
+}
 
-	target-&gt;handle_speed_loss(this, slowdown_factor);
-	state = 0;
-	}
+void VuxIntruder::relocate() 
+{
+  STACKTRACE;
+  if ( control ) target = control-&gt;target; 
+  if (target &amp;&amp; (distance(target) &gt; 500)) {
+    pos = target-&gt;normal_pos() + (unit_vector(angle) * 125.0);
+    angle = trajectory_angle(target);
+    if (angle &gt; PI2) angle -= PI2;
+    if (angle &lt; 0) angle += PI2;
+  }
+  sprite_index = get_index(angle);
+  angle = (iround(angle / (PI2/64))) * (PI2/64);
+  return;
+}
 
-void VuxIntruder::relocate() {
-	if ( control ) target = control-&gt;target; 
-	if (target &amp;&amp; (distance(target) &gt; 500)) {
-		pos = target-&gt;normal_pos() + (unit_vector(angle) * 125.0);
-		angle = trajectory_angle(target);
-		if (angle &gt; PI2) angle -= PI2;
-		if (angle &lt; 0) angle += PI2;
-		}
-	sprite_index = get_index(angle);
-	angle = (iround(angle / (PI2/64))) * (PI2/64);
-	return;
-	}
 
-
-void VuxIntruder::animate(Frame *space){
-
-        double back_x=size.x/3.60, back_y=-size.y/2.33,
-               frnt_x=size.x/5.55, frnt_y=+size.y/17.01,
-               back_y_1=-size.y/2.06;
+void VuxIntruder::animate(Frame *space)
+{
+  STACKTRACE;
   
-        int s_index = get_index(angle);
-
-        if (turn_right)
-				data-&gt;spriteWeapon-&gt;animate(pos + 
-					rotate(Vector2(-frnt_x, frnt_y), angle-PI/2),
-					s_index + ((rand()%3) &lt;&lt; 6), space);	//graphics
-        if (turn_left)
-				data-&gt;spriteWeapon-&gt;animate(pos + 
-					rotate(Vector2(frnt_x,frnt_y), angle-PI/2),
-					s_index + ((rand()%3) &lt;&lt; 6), space);	//graphics
-
-        s_index += 32; s_index &amp;= 63;
-
-        if (thrust) {
+  double back_x=size.x/3.60, back_y=-size.y/2.33,
+    frnt_x=size.x/5.55, frnt_y=+size.y/17.01,
+    back_y_1=-size.y/2.06;
+  
+  int s_index = get_index(angle);
+  
+  if (turn_right)
+    data-&gt;spriteWeapon-&gt;animate(pos + 
+				rotate(Vector2(-frnt_x, frnt_y), angle-PI/2),
+				s_index + ((rand()%3) &lt;&lt; 6), space);	//graphics
+  if (turn_left)
+    data-&gt;spriteWeapon-&gt;animate(pos + 
+				rotate(Vector2(frnt_x,frnt_y), angle-PI/2),
+				s_index + ((rand()%3) &lt;&lt; 6), space);	//graphics
+  
+  s_index += 32; s_index &amp;= 63;
+  
+  if (thrust) {
 				data-&gt;spriteExtra-&gt;animate(pos + 
-					rotate(Vector2(back_x, back_y_1), angle-PI/2),
-					s_index + ((rand()%3) &lt;&lt; 6), space);	//graphics
-                data-&gt;spriteExtra-&gt;animate(pos + 
-					rotate(Vector2(-back_x, back_y_1), angle-PI/2),
-					s_index + ((rand()%3) &lt;&lt; 6), space); }	//graphics
-        else {
-                if (turn_left)
-						data-&gt;spriteWeapon-&gt;animate(pos + 
-							rotate(Vector2(-back_x, back_y), angle-PI/2),
-							s_index + ((rand()%3) &lt;&lt; 6), space);	//graphics
-                if (turn_right)
-						data-&gt;spriteWeapon-&gt;animate(pos + 
-							rotate(Vector2(back_x, back_y), angle-PI/2),
-							s_index + ((rand()%3) &lt;&lt; 6), space); }	//graphics
-
-        Ship::animate(space);
+							   rotate(Vector2(back_x, back_y_1), angle-PI/2),
+							   s_index + ((rand()%3) &lt;&lt; 6), space);	//graphics
+				data-&gt;spriteExtra-&gt;animate(pos + 
+							   rotate(Vector2(-back_x, back_y_1), angle-PI/2),
+							   s_index + ((rand()%3) &lt;&lt; 6), space); }	//graphics
+  else {
+    if (turn_left)
+      data-&gt;spriteWeapon-&gt;animate(pos + 
+				  rotate(Vector2(-back_x, back_y), angle-PI/2),
+				  s_index + ((rand()%3) &lt;&lt; 6), space);	//graphics
+    if (turn_right)
+      data-&gt;spriteWeapon-&gt;animate(pos + 
+				  rotate(Vector2(back_x, back_y), angle-PI/2),
+				  s_index + ((rand()%3) &lt;&lt; 6), space); }	//graphics
+  
+  Ship::animate(space);
 };
 
 
 class VuxPhaser : public Phaser {
-	public:
+public:
 	VuxPhaser(Vector2 opos, Vector2 n, VuxIntruder *ship, 
 			SpaceSprite *sprite, int osprite_index, int *ocolors, 
 			int onum_colors, int ofsize, int steps, int step_time) ;
@@ -213,10 +223,12 @@
 :
 Phaser(ship, opos, _n, ship, sprite, osprite_index, ocolors, onum_colors, ofsize, steps, step_size)
 {
+  STACKTRACE;
 	vuxship = ship;
 }
 
 void VuxPhaser::calculate() {
+  STACKTRACE;
 	Phaser::calculate();
 	if (!ship) return;
 	if( !(ship-&gt;attributes &amp; ATTRIB_INGAME )) vuxship-&gt;relocate();//((VuxIntruder*)ship)-&gt;relocate();
@@ -228,6 +240,7 @@
 	}
 
 SpaceLocation *VuxIntruder::get_ship_phaser() {
+  STACKTRACE;
 	return new VuxPhaser(
 			pos - unit_vector(angle) * PHASE_MAX * size.x,
 			unit_vector(angle) * PHASE_MAX * size.x,

Modified: branches/multiplayer-branch/source/sc1ships/shpyehte.cpp
===================================================================
--- branches/multiplayer-branch/source/sc1ships/shpyehte.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/sc1ships/shpyehte.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 #include &quot;frame.h&quot;
 
@@ -26,6 +25,7 @@
 	:
 	Ship(opos, angle, data, code)
 {
+  STACKTRACE;
 
   weaponRange    = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
   weaponVelocity = scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
@@ -38,6 +38,7 @@
 
 int YehatTerminator::activate_weapon()
 {
+  STACKTRACE;
   add(new Missile(this, Vector2(-24.0, 14),
     angle, weaponVelocity, weaponDamage, weaponRange, weaponArmour,
     this, data-&gt;spriteWeapon));
@@ -49,12 +50,14 @@
 
 int YehatTerminator::activate_special()
 {
+  STACKTRACE;
   shieldFrames = (shieldFrames % frame_time) + specialFrames;
   return(TRUE);
 }
 
 void YehatTerminator::calculate()
 {
+  STACKTRACE;
    if(shieldFrames &gt; 0)
      shieldFrames-= frame_time;
    Ship::calculate();
@@ -62,6 +65,7 @@
 
 void YehatTerminator::animate(Frame *space)
 {
+  STACKTRACE;
   if(shieldFrames &gt; 0)
     data-&gt;spriteSpecial-&gt;animate( pos, sprite_index, space);
   else
@@ -69,6 +73,7 @@
 }
 
 int YehatTerminator::handle_damage(SpaceLocation *source, double normal, double direct) {
+  STACKTRACE;
 	if (shieldFrames &gt; 0) normal = 0;
 	return Ship::handle_damage(source, normal, direct);
 	}

Modified: branches/multiplayer-branch/source/sc2ships/shpchmav.cpp
===================================================================
--- branches/multiplayer-branch/source/sc2ships/shpchmav.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/sc2ships/shpchmav.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 #include &quot;util/aastr.h&quot;
 #include &quot;sc2ships.h&quot;
@@ -67,6 +66,7 @@
 	:
 	Ship(opos, shipAngle, shipData, code) 
 	{
+  STACKTRACE;
 
 	weaponRange  = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
 	weaponDamage = get_config_int(&quot;Weapon&quot;, &quot;Damage&quot;, 0);
@@ -87,6 +87,7 @@
 
 void ChmmrAvatar::calculate()
 {
+  STACKTRACE;
 	Ship::calculate();
 	
 	if ((uninterrupted_fire) &amp;&amp; ((!fire_weapon) || weapon_low))
@@ -102,6 +103,7 @@
 
 int ChmmrAvatar::activate_weapon()
 {
+  STACKTRACE;
 	add(new ChmmrLaser(angle, weaponRange, weaponDamage, weapon_rate, this, Vector2(0.0, 25.0) ));
 	if (tw_random(150) &lt; frame_time) {
 		add(new Animation(this, 
@@ -123,6 +125,7 @@
 
 int ChmmrAvatar::activate_special()
 {
+  STACKTRACE;
 	if (target &amp;&amp; target-&gt;exists() &amp;&amp; (!target-&gt;isInvisible()) &amp;&amp; (target-&gt;mass &gt; 0) &amp;&amp; (distance(target) &lt; specialRange)) {
 		add(new ChmmrBeam(this, special_rate));
 		target-&gt;accelerate(this, target-&gt;trajectory_angle(this), specialForce / target-&gt;mass, MAX_SPEED);
@@ -133,6 +136,7 @@
 
 void ChmmrAvatar::materialize()
 {
+  STACKTRACE;
 	Ship::materialize();
 	add(new ChmmrZapSat(0.0, extraRange,
 		extraDamage, extraFrames, extraRechargeRate, extraColor, extraArmour, this,
@@ -151,16 +155,18 @@
 	Laser(opos, langle, pallete_color[hot_color[random() % HOT_COLORS]], lrange,
 	ldamage, lfcount, opos, rel_pos, true)
 {
+  STACKTRACE;
 }
 
 ChmmrBeam::ChmmrBeam(Ship *oship, int oframes) :
 	SpaceObject(oship, oship-&gt;normal_pos(), oship-&gt;get_angle(), 
-    meleedata.sparkSprite),
+    game-&gt;meleedata.sparkSprite),
 	frame(0),
 	frame_count(oframes),
 	ship(oship),
 	target(oship-&gt;target)
 {
+  STACKTRACE;
 	set_depth(DEPTH_HOTSPOTS);
 	collide_flag_anyone = 0;
 	if(!(ship &amp;&amp; ship-&gt;exists())) {
@@ -177,6 +183,7 @@
 
 void ChmmrBeam::calculate()
 {
+  STACKTRACE;
 
 	SpaceLocation::calculate();
 
@@ -202,6 +209,7 @@
 
 void ChmmrBeam::animate(Frame *space)
 {
+  STACKTRACE;
 	const int beam_color[5] = { 80, 81, 82, 83, 84 };
 	int i;//, old_trans;
 	double length = target-&gt;get_vel().length() + (target-&gt;get_size().x / 4.0);
@@ -236,6 +244,7 @@
   lColor(ocolor),
   armour(oarmour)
 {
+  STACKTRACE;
 	layer = LAYER_SPECIAL;
 	set_depth(DEPTH_SPECIAL);
 	collide_flag_anyone = ALL_LAYERS &amp;~ bit(LAYER_CBODIES);
@@ -255,6 +264,7 @@
 }
 
 void ChmmrZapSat::calculate() {
+  STACKTRACE;
 
 	SpaceObject::calculate();
 
@@ -291,7 +301,7 @@
 		if (!q.currento-&gt;isInvisible() &amp;&amp; !q.currento-&gt;sameTeam(this) &amp;&amp; (q.currento-&gt;collide_flag_anyone&amp;bit(LAYER_LINES))) {
 			add(new PointLaser(this, pallete_color[lColor], 1, lFrames,
                         		this, q.currento, Vector2(0.0, 0.0) ));
-			sound.play((SAMPLE *)(melee[MELEE_BOOM + 0].dat));
+			tw_sound-&gt;play_sound(data_full_path(MELEE_BOOM_SOUND1));
 			lRecharge += lRechargeRate;
 			break;
 			}
@@ -299,11 +309,13 @@
 	return;
 	}
 int ChmmrZapSat::canCollide(SpaceLocation *other) {
+  STACKTRACE;
 	if (!other-&gt;damage_factor) return false;
 	return SpaceObject::canCollide(other);
 	}
 
 int ChmmrZapSat::handle_damage(SpaceLocation *source, double normal, double direct) {
+  STACKTRACE;
 	int total = iround(normal + direct);
 	if (total) {
 		armour -= total;
@@ -311,9 +323,10 @@
 			armour = 0;
 			state = 0;
 			add(new Animation(this, pos,
-					meleedata.kaboomSprite, 0, KABOOM_FRAMES, 50, DEPTH_EXPLOSIONS));
-			sound.stop(data-&gt;sampleExtra[0]);
-			sound.play(data-&gt;sampleExtra[0]);
+					  game-&gt;meleedata.kaboomSprite, 0, KABOOM_FRAMES, 
+					  50, DEPTH_EXPLOSIONS));
+			tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleExtra[0]));
+			tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleExtra[0]));
 			}
 		}
 	return total;

Modified: branches/multiplayer-branch/source/sc2ships/shpdruma.cpp
===================================================================
--- branches/multiplayer-branch/source/sc2ships/shpdruma.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/sc2ships/shpdruma.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 
 #include &quot;sc2ships.h&quot;
@@ -37,6 +36,7 @@
 	ShipData *shipData, unsigned int code)
 	:
 	Ship(opos, shipAngle, shipData, code) {
+  STACKTRACE;
 
   weaponRange         = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
   weaponVelocity      = scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
@@ -47,6 +47,7 @@
 
 
 int DruugeMauler::activate_weapon() {
+  STACKTRACE;
 	accelerate (this, angle + PI, weaponDriftVelocity / mass, MAX_SPEED);
 	add(new DruugeMissile(
 			Vector2(0.0, (get_size().y /*height()*/ / 2.0)), angle, weaponVelocity, weaponDamage,
@@ -57,6 +58,7 @@
 
 
 void DruugeMauler::calculate_fire_special() {
+  STACKTRACE;
   if((fire_special) &amp;&amp; (crew &gt; 1) &amp;&amp; (batt &lt; batt_max) &amp;&amp;
     (special_recharge &lt;= 0)) {
 
@@ -67,28 +69,30 @@
 
     special_recharge = special_rate;
 
-    play_sound2(data-&gt;sampleSpecial[0]);
+    tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleSpecial[0]));
+    tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleSpecial[0]));
   }
 }
 
-
 DruugeMissile::DruugeMissile(Vector2 opos, double oangle, double ov,
-    int odamage, double weaponDriftVelocity, double orange, int oarmour,
-    Ship *oship, SpaceSprite *osprite) :
-    Missile(oship, opos, oangle, ov, odamage, orange, oarmour, oship, osprite),
-    kick(weaponDriftVelocity)
+			     int odamage, double weaponDriftVelocity, double orange, int oarmour,
+			     Ship *oship, SpaceSprite *osprite) :
+  Missile(oship, opos, oangle, ov, odamage, orange, oarmour, oship, osprite),
+  kick(weaponDriftVelocity)
 {
+  STACKTRACE;
   explosionSprite     = data-&gt;spriteWeaponExplosion;
   explosionFrameCount = 5;
   explosionFrameSize  = 50;
 }
 
-void DruugeMissile::inflict_damage (SpaceObject *other) {
-//	if (other-&gt;getID() == SPACE_PLANET) other-&gt;accelerate (this, angle, kick/25., GLOBAL_MAXSPEED);
-	if (other-&gt;mass) 
-		other-&gt;accelerate (this, angle, kick / other-&gt;mass, MAX_SPEED);
-	Missile::inflict_damage(other);
-	}
+void DruugeMissile::inflict_damage (SpaceObject *other) 
+{
+  //	if (other-&gt;getID() == SPACE_PLANET) other-&gt;accelerate (this, angle, kick/25., GLOBAL_MAXSPEED);
+  if (other-&gt;mass) 
+    other-&gt;accelerate (this, angle, kick / other-&gt;mass, MAX_SPEED);
+  Missile::inflict_damage(other);
+}
 
 
 

Modified: branches/multiplayer-branch/source/sc2ships/shpkohma.cpp
===================================================================
--- branches/multiplayer-branch/source/sc2ships/shpkohma.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/sc2ships/shpkohma.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 
 #include &quot;sc2ships.h&quot;
@@ -56,6 +55,7 @@
 };
 
 void KohrAhFRIED::inflict_damage(SpaceObject *other) {
+  STACKTRACE;
 	if ((other-&gt;getID() &amp;~ SPACE_MASK) == CHMMR_SPEC) other-&gt;state = 0;
 	Shot::inflict_damage(other);
 	return;
@@ -65,6 +65,7 @@
 	ShipData *shipData, unsigned int code)
 	:
 	Ship(opos, shipAngle, shipData, code) {
+  STACKTRACE;
 	weaponRange    = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
 	weaponVelocity = scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
 	weaponDamage   = get_config_int(&quot;Weapon&quot;, &quot;Damage&quot;, 0);
@@ -86,6 +87,7 @@
 	}
 
 int KohrAhMarauder::activate_weapon() {
+  STACKTRACE;
 	if (weaponFired) return(FALSE);
 	if (numblades == maxblades) {
 		weaponObject[0]-&gt;state = 0;
@@ -105,6 +107,7 @@
 	}
 
 int KohrAhMarauder::activate_special() {
+  STACKTRACE;
 	int i;
 	for(i = 0; i &lt; 16; i++) {
 		add(new KohrAhFRIED(
@@ -115,6 +118,7 @@
 	}
 
 void KohrAhMarauder::calculate() {
+  STACKTRACE;
 	Ship::calculate();
 	
 	if (!fire_weapon) {
@@ -146,12 +150,14 @@
   passive(FALSE),
   passiveRange(orange)
 {
+  STACKTRACE;
   explosionSprite     = data-&gt;spriteWeaponExplosion;
   explosionFrameCount = 20;
   explosionFrameSize  = 40;
 }
 
 void KohrAhBlade::calculate() {
+  STACKTRACE;
 	SpaceObject *o, *t = NULL;
 	double oldrange = 999999;
 
@@ -186,12 +192,14 @@
 
 void KohrAhBlade::animateExplosion()
 {
+  STACKTRACE;
   add(new KohrAhBladeDecay(this, pos,
     vel, explosionSprite, explosionFrameCount, explosionFrameSize));
 }
 
 void KohrAhBlade::disengage()
 {
+  STACKTRACE;
   passive = TRUE;
 }
 
@@ -199,6 +207,7 @@
   SpaceSprite *osprite, int ofcount, int ofsize) :
   Animation(creator, opos, osprite, 0, ofcount, ofsize, DEPTH_EXPLOSIONS)
 {
+  STACKTRACE;
 //  vx = ovx / 2;
 //  vy = ovy / 2;
   vel = 0.5 * ovel;
@@ -210,12 +219,14 @@
   Shot(oship, Vector2(0.0, 0.0), oangle, ov, odamage, orange, oarmour, oship, osprite, 1.0),
   frame_count(ofcount)
 {
+  STACKTRACE;
 //  x += cos(angle) * 50.0;
 //  y += sin(angle) * 50.0;
   pos += 50.0 * unit_vector(angle);
 }
 
 void KohrAhFRIED::calculate() {
+  STACKTRACE;
   sprite_index = (int)((d / range) * (double)(frame_count - 1));
   Shot::calculate();
 }

Modified: branches/multiplayer-branch/source/sc2ships/shpmeltr.cpp
===================================================================
--- branches/multiplayer-branch/source/sc2ships/shpmeltr.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/sc2ships/shpmeltr.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 
 #include &quot;sc2ships.h&quot;
@@ -76,6 +75,7 @@
 	:
 	Ship(opos, shipAngle, shipData, code)
 {
+  STACKTRACE;
 
   weaponRange    = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
   weaponRangeUp  = scale_range(get_config_float(&quot;Weapon&quot;, &quot;RangeUp&quot;, 0));
@@ -92,6 +92,7 @@
 
 void MelnormeTrader::calculate()
 {
+  STACKTRACE;
   Ship::calculate();
   if (weaponObject) {
     if (!weaponObject-&gt;exists()) weaponObject = NULL;
@@ -101,6 +102,7 @@
 
 int MelnormeTrader::activate_weapon()
 {
+  STACKTRACE;
   if(weaponObject)
     return(FALSE);
   add(weaponObject = new MelnormeShot(
@@ -110,6 +112,7 @@
 }
 
 int MelnormeTrader::activate_special() {
+  STACKTRACE;
   add( new MelnormeSpecial(
     Vector2(0.0, get_size().y /*(height()*/ / 2.0), angle, specialVelocity, specialFrames,
     specialRange, specialArmour, this, data-&gt;spriteSpecial, 20, 50));
@@ -129,65 +132,72 @@
   charge_phase(0),
   released(FALSE),
 	RangeUp(rangeup)
-{  
+{
+  STACKTRACE;  
 //  vx = ship-&gt;get_vx();
 //  vy = ship-&gt;get_vy();
   vel = ship-&gt;get_vel();
   set_depth(DEPTH_SHIPS+0.5);
 }
 
-void MelnormeShot::calculate() {
-	if(released) {
-		Shot::calculate();
+void MelnormeShot::calculate() 
+{
+  STACKTRACE;
+  if(released) 
+    {
+      Shot::calculate();
+    }
+  else 
+    {
+      SpaceObject::calculate();
+    }
+  if (!exists()) 
+    return;
+  frame_step += frame_time;
+  if(frame_step &gt;= frame_size) 
+    {
+      frame_step -= frame_size;
+      frame++;
+      if(frame == frame_count) 
+	{
+	  frame = 0;
+	  if((!released) &amp;&amp; (charge_phase &lt; 3)) 
+	    {
+	      charge_frame++;
+	      if(charge_frame == 5) 
+		{
+		  charge_frame = 0;
+		  charge_phase++;
+		  damage_factor *= 2;
+		  armour *= 2;
+		  range += RangeUp;
+		  tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleWeapon[0]));
 		}
-	else {
-		SpaceObject::calculate();
-		}
-	if (!exists()) return;
-	frame_step += frame_time;
-	if(frame_step &gt;= frame_size) {
-		frame_step -= frame_size;
-		frame++;
-		if(frame == frame_count) {
-			frame = 0;
-			if((!released) &amp;&amp; (charge_phase &lt; 3)) {
-				charge_frame++;
-				if(charge_frame == 5) {
-					charge_frame = 0;
-					charge_phase++;
-					damage_factor *= 2;
-					armour *= 2;
-					range += RangeUp;
-					play_sound(data-&gt;sampleWeapon[0]);
-					}
-				}
-			}
-		}
-	sprite_index = (charge_phase * 10) + frame;
-	if(!released) {
-		if (!ship || !ship-&gt;fire_weapon) {
-//			vx = cos(angle) * v;
-//			vy = sin(angle) * v;
-			vel = v * unit_vector(angle);
-			released = TRUE;
-			play_sound(data-&gt;sampleSpecial[0]);
-			}
-		else {
-			angle = ship-&gt;get_angle();
-//			x = ship-&gt;normal_x() + (cos(angle) * (ship-&gt;width() / 2.0));
-//			y = ship-&gt;normal_y() + (sin(angle) * (ship-&gt;height() / 2.0));
-			pos = ship-&gt;normal_pos() + 0.5 * product(unit_vector(angle), ship-&gt;get_size());
-//			vx = ship-&gt;get_vx();
-//			vy = ship-&gt;get_vy();
-			vel = ship-&gt;get_vel();
-
-			}
-		}
-	return;
+	    }
 	}
+    }
+  sprite_index = (charge_phase * 10) + frame;
+  if(!released) 
+    {
+      if (!ship || !ship-&gt;fire_weapon) 
+	{
+	  vel = v * unit_vector(angle);
+	  released = TRUE;
+	  tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleSpecial[0]));
+	}
+      else 
+	{
+	  angle = ship-&gt;get_angle();
+	  pos = ship-&gt;normal_pos() + 0.5 * product(unit_vector(angle), ship-&gt;get_size());
+	  vel = ship-&gt;get_vel();
+	}
+    }
+  return;
+}
 
 void MelnormeShot::animateExplosion()
 {
+  STACKTRACE;
   add( new Animation(this, pos,
     data-&gt;spriteWeaponExplosion, (charge_phase * 20), 20, 25, 
     DEPTH_EXPLOSIONS));
@@ -195,6 +205,7 @@
 
 int MelnormeShot::handle_damage(SpaceLocation *source, double normal, double direct)
 {
+  STACKTRACE;
   int old = iround(armour);
   Shot::handle_damage(source, normal, direct);
   if (!released &amp;&amp; (armour &gt; 0)) armour = old;
@@ -203,6 +214,7 @@
 
 void MelnormeShot::inflict_damage(SpaceObject *other)
 {
+  STACKTRACE;
 	if (!other-&gt;exists()) return;
 	damage(other, damage_factor);
 
@@ -227,11 +239,13 @@
   frame_size(ofsize),
   frame_count(ofcount)
 {
+  STACKTRACE;
 	collide_flag_anyone = 0;
 	set_depth(DEPTH_EXPLOSIONS);
 }
 
 void MelnormeDisable::calculate() {
+  STACKTRACE;
 	frame_step+= frame_time;
 	while (frame_step &gt;= frame_size) {
 		frame_step -= frame_size;
@@ -263,12 +277,15 @@
   disableFrames(oframes),
   disableSprite(data-&gt;spriteExtra)
 {
+  STACKTRACE;
 	collide_flag_anyone = bit(LAYER_SHIPS);
 }
 
-void MelnormeSpecial::animateExplosion() {}
+void MelnormeSpecial::animateExplosion() {
+  STACKTRACE;}
 
 void MelnormeSpecial::inflict_damage(SpaceObject *other) {
+  STACKTRACE;
 	if (other-&gt;isShip()) add(new MelnormeDisable( ship, 
 			(Ship *)(other), disableSprite, 20, 50, disableFrames));
 	state = 0;

Modified: branches/multiplayer-branch/source/sc2ships/shporzne.cpp
===================================================================
--- branches/multiplayer-branch/source/sc2ships/shporzne.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/sc2ships/shporzne.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 #include &quot;melee/mview.h&quot;
 #include &quot;melee/mcbodies.h&quot;
@@ -59,6 +58,7 @@
 	:
 	Ship(opos, shipAngle, shipData, code)
 {
+  STACKTRACE;
   int i;
 
 	absorption = 0;
@@ -92,18 +92,21 @@
 
 void OrzNemesis::calculate_turn_left()
 {
+  STACKTRACE;
   if(!fire_special)
     Ship::calculate_turn_left();
 }
 
 void OrzNemesis::calculate_turn_right()
 {
+  STACKTRACE;
   if(!fire_special)
     Ship::calculate_turn_right();
 }
 
 int OrzNemesis::activate_weapon()
 {
+  STACKTRACE;
   if(fire_special)
     return(FALSE);
   add(new OrzMissile(
@@ -117,6 +120,7 @@
 
 int OrzNemesis::activate_special()
 {
+  STACKTRACE;
   if(turn_left &amp;&amp; (recoil&lt;=0))
     turret_turn_step -= frame_time * turret_turn_rate;
   if(turn_right &amp;&amp; (recoil&lt;=0))
@@ -152,6 +156,7 @@
 
 void OrzNemesis::calculate()
 {
+  STACKTRACE;
   int i;
 
   for(i = 0; i &lt; MAX_MARINES; i++)
@@ -165,6 +170,7 @@
 
 void OrzNemesis::animate(Frame *space)
 {
+  STACKTRACE;
 	double rec;
 	int turret_index;
 	/*
@@ -194,6 +200,7 @@
   Missile(oship, Vector2(0.0, 0.0), oangle, ov, odamage, orange, oarmour, oship,
     osprite)
 {
+  STACKTRACE;
 //  x += cos(angle) * 30.0;
 //  y += sin(angle) * 30.0;
   pos += 30.0 * unit_vector(angle);
@@ -220,6 +227,7 @@
   slot(oSlot),
   damage_frame(-1)
 {
+  STACKTRACE;
 		layer = LAYER_SPECIAL;
 		set_depth(DEPTH_SPECIAL);
         mass = 0.001;
@@ -229,167 +237,183 @@
 		orzship = oship;
 }
 
-void OrzMarine::calculate() {
-	int    chance;
+void OrzMarine::calculate() 
+{
+  STACKTRACE;
+  int    chance;
 
-    if (!(orzship &amp;&amp; orzship-&gt;exists()))
+  if (!(orzship &amp;&amp; orzship-&gt;exists()))
+    {
+      orzship = 0;
+      // just this ... in case owner is changed, &quot;ship&quot; can still be used to do something
+    }
+
+  if (invading) 
+    {
+      
+      if (invading-&gt;exists()) 
 	{
-		orzship = 0;
-		// just this ... in case owner is changed, &quot;ship&quot; can still be used to do something
-	}
+	  pos = invading-&gt;normal_pos();
+	  
+	  if(damage_frame &gt; 0) 
+	    {
+	      damage_frame -= frame_time;
+	      if(damage_frame &lt;= 0 &amp;&amp; invading-&gt;spritePanel) 
+		{
+		  sprite-&gt;draw(
+			       14 + ((slot % 4) * 6), 	16 + ((slot / 4) * 6), 
+			       0, invading-&gt;spritePanel-&gt;get_bitmap(0)
+			       );
+		  invading-&gt;update_panel = TRUE; 
+		}
+	      return; 
+	    }
 
-	if (invading) {
-        
-		if (invading-&gt;exists()) {
-//			x = invading-&gt;normal_x();
-//			y = invading-&gt;normal_y();
-			pos = invading-&gt;normal_pos();
-
-			if(damage_frame &gt; 0) {
-				damage_frame -= frame_time;
-				if(damage_frame &lt;= 0 &amp;&amp; invading-&gt;spritePanel) {
-					sprite-&gt;draw(
-						14 + ((slot % 4) * 6), 	16 + ((slot / 4) * 6), 
-						0, invading-&gt;spritePanel-&gt;get_bitmap(0)
-						);
-					/*draw_sprite(invading-&gt;spritePanel-&gt;get_bitmap(0),	sprite-&gt;get_bitmap(0), 
-							14 + ((slot % 4) * 6), 16 + ((slot / 4) * 6));*/
-					invading-&gt;update_panel = TRUE; }
-				return; }
-
-			chance = random() % 10000;
-			if (chance &lt; 9 * frame_time)
-			{
-				// the following is dangerous if eg a ploxis changes the owner (=ship pointer)
-				//if (ship &amp;&amp; ((random() &amp; 255) &lt; (((OrzNemesis*)ship)-&gt;absorption))) {
-				if (orzship &amp;&amp; orzship-&gt;exists() &amp;&amp; (random() &amp; 255) &lt; orzship-&gt;absorption)
-				{
-					damage(orzship, 0, -1);
-				}
-
-				play_sound(data-&gt;sampleExtra[0]);
-				damage(invading, 0, 1);
-				damage_frame = 50;
-				if ( invading-&gt;spritePanel )
-				{
-				sprite-&gt;draw( 
-					14 + ((slot % 4) * 6), 
-					16 + ((slot / 4) * 6), 
-					1, invading-&gt;spritePanel-&gt;get_bitmap(0) );
-				/*draw_sprite(invading-&gt;spritePanel-&gt;get_bitmap(0), sprite-&gt;get_bitmap(1),
-						14 + ((slot % 4) * 6), 16 + ((slot / 4) * 6));*/
-				invading-&gt;update_panel = TRUE;
-			}}
-			else    if (chance &lt; 10 * frame_time) {
-                        state = 0;
-				        play_sound(data-&gt;sampleExtra[2]);
-						if ( invading-&gt;spritePanel )
-						{
-				        blit(invading-&gt;data-&gt;spritePanel-&gt;get_bitmap(0), invading-&gt;spritePanel-&gt;get_bitmap(0),
-						14 + ((slot % 4) * 6), 16 + ((slot / 4) * 6),
-						14 + ((slot % 4) * 6), 16 + ((slot / 4) * 6), 12, 12);
-                                        invading-&gt;update_panel = TRUE;
-						}
-				        return; }
+	  chance = random() % 10000;
+	  if (chance &lt; 9 * frame_time)
+	    {
+	      // the following is dangerous if eg a ploxis changes the owner (=ship pointer)
+	      //if (ship &amp;&amp; ((random() &amp; 255) &lt; (((OrzNemesis*)ship)-&gt;absorption))) {
+	      if (orzship &amp;&amp; orzship-&gt;exists() &amp;&amp; (random() &amp; 255) &lt; orzship-&gt;absorption)
+		{
+		  damage(orzship, 0, -1);
 		}
-		else {	invading = NULL;
-			returning = TRUE;
-		        collide_flag_sameship = bit(LAYER_SHIPS);
-		        collide_flag_anyone = ALL_LAYERS;
-			sprite_index = 1; }
-        }
-	else {
-                if (!(ship &amp;&amp; ship-&gt;exists()))
-				{
-					ship = 0;
-                        state = 0;
-						return;
-				}
-
-                if (returning)
-                        angle = trajectory_angle(ship);
-                else {
-		        if(ship-&gt;target &amp;&amp; ship-&gt;target-&gt;exists() &amp;&amp; (!ship-&gt;target-&gt;isInvisible()))
+	      
+	      tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleExtra[0]));
+	      damage(invading, 0, 1);
+	      damage_frame = 50;
+	      if ( invading-&gt;spritePanel )
+		{
+		  sprite-&gt;draw( 
+			       14 + ((slot % 4) * 6), 
+			       16 + ((slot / 4) * 6), 
+			       1, invading-&gt;spritePanel-&gt;get_bitmap(0) );
+		  
+		  invading-&gt;update_panel = TRUE;
+		}
+	    }
+	  else if (chance &lt; 10 * frame_time) 
+	    {
+	      state = 0;
+	      tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleExtra[2]));
+	      if ( invading-&gt;spritePanel )
+		{
+		  blit(invading-&gt;data-&gt;spritePanel-&gt;get_bitmap(0), invading-&gt;spritePanel-&gt;get_bitmap(0),
+		       14 + ((slot % 4) * 6), 16 + ((slot / 4) * 6),
+		       14 + ((slot % 4) * 6), 16 + ((slot / 4) * 6), 12, 12);
+		  invading-&gt;update_panel = TRUE;
+		}
+	      return; 
+	    }
+	}
+      else 
+	{	
+	  invading = NULL;
+	  returning = TRUE;
+	  collide_flag_sameship = bit(LAYER_SHIPS);
+	  collide_flag_anyone = ALL_LAYERS;
+	  sprite_index = 1; 
+	}
+    }
+  else 
+    {
+      if (!(ship &amp;&amp; ship-&gt;exists()))
+	{
+	  ship = 0;
+	  state = 0;
+	  return;
+	}
+      
+      if (returning)
+	angle = trajectory_angle(ship);
+      else 
+	{
+	  if(ship-&gt;target &amp;&amp; ship-&gt;target-&gt;exists() &amp;&amp; (!ship-&gt;target-&gt;isInvisible()))
                                 angle = trajectory_angle(ship-&gt;target);
-                        else {  returning = true;
-		                collide_flag_sameship = bit(LAYER_SHIPS);
-		                collide_flag_anyone = ALL_LAYERS;
-			        sprite_index = 1; }
+	  else 
+	    {  
+	      returning = true;
+	      collide_flag_sameship = bit(LAYER_SHIPS);
+	      collide_flag_anyone = ALL_LAYERS;
+	      sprite_index = 1; 
+	    }
+	}
+      
+      Planet *spacePlanet = nearest_planet();
+      if (spacePlanet!=NULL) 
+	{
+	  double r = distance(spacePlanet);
+	  if (r &lt; 0.33*spacePlanet-&gt;gravity_range) 
+	    {
+	      double t_a = trajectory_angle(spacePlanet);
+	      double d_a = normalize(t_a - angle, PI2);
+	      if (d_a &gt; PI) d_a -= PI2;
+	      if (fabs(d_a)&lt;PI/2) 
+		{
+		  if (d_a &gt; 0)
+		    angle = normalize(t_a - PI/2, PI2);
+		  else
+		    angle = normalize(t_a + PI/2, PI2);
 		}
+	    }
+	}
+      
+      accelerate_gravwhip(this, angle, accel_rate * frame_time, speed_max);
+      if(hotspot_frame &lt;= 0) 
+	{
+	  add(new Animation(this, 
+			    normal_pos() - product(unit_vector(angle), get_size()) / 2.0,
+			    game-&gt;meleedata.hotspotSprite,
+			    0, HOTSPOT_FRAMES, 50, DEPTH_HOTSPOTS));
+	  hotspot_frame += hotspot_rate;
+	}
+      if(hotspot_frame &gt; 0) hotspot_frame-= frame_time;
+    }
 
-	        Planet *spacePlanet = nearest_planet();
-	        if (spacePlanet!=NULL) {
-                        double r = distance(spacePlanet);
-                        if (r &lt; 0.33*spacePlanet-&gt;gravity_range) {
-                                double t_a = trajectory_angle(spacePlanet);
-                                double d_a = normalize(t_a - angle, PI2);
-                                if (d_a &gt; PI) d_a -= PI2;
-//                                double p_a = normalize(atan3(1.9*spacePlanet-&gt;getSprite()-&gt;width()/2.0, r), PI2);
-//                                p_a = p_a - fabs(d_a);
-//                                if (p_a &gt; 0) {
-                                if (fabs(d_a)&lt;PI/2) {
-                                        if (d_a &gt; 0)
-                                                angle = normalize(t_a - PI/2, PI2);
-                                        else
-                                                angle = normalize(t_a + PI/2, PI2);
-                                }
-                        }
-                }
-
-	accelerate_gravwhip(this, angle, accel_rate * frame_time, speed_max);
-                if(hotspot_frame &lt;= 0) {
-                        add(new Animation(this, 
-					normal_pos() - product(unit_vector(angle), get_size()) / 2.0,
-//                  normal_x() - (cos(angle) * w / 2.5),
-//			        normal_y() - (sin(angle) * h / 2.5),
-					meleedata.hotspotSprite,
-			        0, HOTSPOT_FRAMES, 50, DEPTH_HOTSPOTS));
-		        hotspot_frame += hotspot_rate;
-	        }
-        	if(hotspot_frame &gt; 0) hotspot_frame-= frame_time;
-        }
-
-	SpaceObject::calculate();
+  SpaceObject::calculate();
 }
 
 void OrzMarine::animate(Frame *space)
 {
-	if (!invading) SpaceObject::animate(space);
+  STACKTRACE;
+  if (!invading) SpaceObject::animate(space);
 }
 
-void OrzMarine::inflict_damage(SpaceObject *other) {
-	if (other-&gt;isShip() &amp;&amp; (!returning) &amp;&amp; (!other-&gt;sameTeam(this)) &amp;&amp; (!other-&gt;isProtected()))
+void OrzMarine::inflict_damage(SpaceObject *other) 
+{
+  STACKTRACE;
+  if (other-&gt;isShip() &amp;&amp; (!returning) &amp;&amp; (!other-&gt;sameTeam(this)) &amp;&amp; (!other-&gt;isProtected()))
+    {
+      invading = (Ship *) other;
+      
+      if (invading-&gt;damage_factor &lt; armour)
 	{
-		invading = (Ship *) other;
-
-		if (invading-&gt;damage_factor &lt; armour)
-		{
-			collide_flag_anyone = 0;
-			play_sound(data-&gt;sampleExtra[1]);
-			damage(invading, 0, 1);
-			if (invading-&gt;spritePanel)
-			{
-				sprite-&gt;draw(14 + ((slot % 4) * 6), 16 + ((slot / 4) * 6), 0, invading-&gt;spritePanel-&gt;get_bitmap(0) );
-				/*draw_sprite(invading-&gt;spritePanel-&gt;get_bitmap(0), sprite-&gt;get_bitmap(0),
-				14 + ((slot % 4) * 6), 16 + ((slot / 4) * 6));*/
-				invading-&gt;update_panel = TRUE;
-			}
-	}}
-	if((ship) &amp;&amp; (other == ship) &amp;&amp; (returning)) {
-		state = 0;
-		damage(ship, 0, -1);
+	  collide_flag_anyone = 0;
+	  tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleExtra[1]));
+	  damage(invading, 0, 1);
+	  if (invading-&gt;spritePanel)
+	    {
+	      sprite-&gt;draw(14 + ((slot % 4) * 6), 16 + ((slot / 4) * 6), 0, 
+			   invading-&gt;spritePanel-&gt;get_bitmap(0) );
+	      invading-&gt;update_panel = TRUE;
+	    }
 	}
+    }
+  if((ship) &amp;&amp; (other == ship) &amp;&amp; (returning)) 
+    {
+      state = 0;
+      damage(ship, 0, -1);
+    }
 }
 
 int OrzMarine::handle_damage(SpaceLocation *source, double normal, double direct)
 {
-	int total = iround(normal + direct);
-	armour -= total;
-	if(armour &lt;= 0)
-		state = 0;
-	return total;
+  STACKTRACE;
+  int total = iround(normal + direct);
+  armour -= total;
+  if(armour &lt;= 0)
+    state = 0;
+  return total;
 }
 
-
-
 REGISTER_SHIP(OrzNemesis)

Modified: branches/multiplayer-branch/source/sc2ships/shppkufu.cpp
===================================================================
--- branches/multiplayer-branch/source/sc2ships/shppkufu.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/sc2ships/shppkufu.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 #include &quot;melee/mcbodies.h&quot;
 
 #include &quot;sc2ships.h&quot;
@@ -31,6 +30,7 @@
 	:
 	Ship(opos, shipAngle, shipData, code)
 {
+  STACKTRACE;
 
   weaponRange    = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
   weaponVelocity = scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
@@ -41,93 +41,65 @@
 	update_panel = true;
 }
 
-int PkunkFury::handle_damage(SpaceLocation *source, double normal, double direct) {
-	int r = iround(normal + direct);
-	crew -= r;
-	if (crew &gt; 0) return r;
-
-	play_sound((SAMPLE *)(melee[MELEE_BOOMSHIP].dat));
-	game-&gt;add(new Animation(this, pos,	meleedata.kaboomSprite, 0, KABOOM_FRAMES, time_ratio, DEPTH_EXPLOSIONS));
-
-	
-	if (random() % 2) {
-		if (attributes &amp; ATTRIB_NOTIFY_ON_DEATH){
-			game-&gt;ship_died(this, source);
-			attributes &amp;= ~ATTRIB_NOTIFY_ON_DEATH;
-		}
-		die();
-		return r;
+int PkunkFury::handle_damage(SpaceLocation *source, double normal, double direct) 
+{
+  STACKTRACE;
+  int r = iround(normal + direct);
+  crew -= r;
+  if (crew &gt; 0) 
+    return r;
+  
+  tw_sound-&gt;play_sound(data_full_path(MELEE_BOOMSHIP_SOUND));
+  game-&gt;add(new Animation(this, pos, game-&gt;meleedata.kaboomSprite, 0, KABOOM_FRAMES, 
+			  time_ratio, DEPTH_EXPLOSIONS));
+  
+  if (random() % 2) 
+    {
+      if (attributes &amp; ATTRIB_NOTIFY_ON_DEATH)
+	{
+	  game-&gt;ship_died(this, source);
+	  attributes &amp;= ~ATTRIB_NOTIFY_ON_DEATH;
 	}
+      die();
+      return r;
+    }
+  
+  pos = random(Vector2(3000,3000)) - Vector2(1500,1500);
+  SpaceLocation *spacePlanet = nearest_planet();
+  if (spacePlanet &amp;&amp; (distance(spacePlanet) &lt; 1000.0)) 
+    {
+      pos += 1000.0 * unit_vector(trajectory_angle(spacePlanet));
+    }
 	
+  state = 0;//-DEATH_FRAMES;
 	
 
-	pos = random(Vector2(3000,3000)) - Vector2(1500,1500);
-	SpaceLocation *spacePlanet = nearest_planet();
-	if (spacePlanet &amp;&amp; (distance(spacePlanet) &lt; 1000.0)) {
-//		x += cos(trajectory_angle(spacePlanet)) * 1000.0;
-//		y += sin(trajectory_angle(spacePlanet)) * 1000.0;
-		pos += 1000.0 * unit_vector(trajectory_angle(spacePlanet));
-		}
 	
-//	angle = random(PI2);
-//	sprite_index = get_index(angle);
-//	vx = vy = 0.0;
-//	vel = 0;
-//	crew = crew_max;
-//	batt = batt_max;
-//	reborn = TRUE;
-//	update_panel = TRUE;
-//	play_sound(data-&gt;sampleExtra[0]);
-	
-	// dangerous: a memory leak ...
-//	game-&gt;remove(this);
-	// that doesn't physically destroy it ... what does ?
-	state = 0;//-DEATH_FRAMES;
-	
+  add(new Phaser (this, 
+		  pos - PHASE_MAX * product(unit_vector(angle+0), get_size()),
+		  PHASE_MAX * product(unit_vector(angle+0), get_size()),
+		  this, sprite, sprite_index, hot_color, HOT_COLORS, 
+		  PHASE_DELAY, PHASE_MAX, PHASE_DELAY) );
+  add(new Phaser (this, 
+		  pos - PHASE_MAX * product(unit_vector(angle+PI/2), get_size()),
+		  PHASE_MAX * product(unit_vector(angle+PI/2), get_size()),
+		  NULL, sprite, (sprite_index+0)&amp;63, hot_color, HOT_COLORS, 
+		  PHASE_DELAY, PHASE_MAX, PHASE_DELAY) );
+  add(new Phaser (this, 
+		  pos - PHASE_MAX * product(unit_vector(angle-PI/2), get_size()),
+		  PHASE_MAX * product(unit_vector(angle-PI/2), get_size()),
+		  NULL, sprite, (sprite_index-0)&amp;63, hot_color, HOT_COLORS, 
+		  PHASE_DELAY, PHASE_MAX, PHASE_DELAY) );
 
-	
-	add(new Phaser (this, 
-//			x - cos(angle+0) * PHASE_MAX * w, 
-//			y - sin(angle+0) * PHASE_MAX * h, 
-			pos - PHASE_MAX * product(unit_vector(angle+0), get_size()),
-//			cos(angle+0) * PHASE_MAX * w, 
-//			sin(angle+0) * PHASE_MAX * h, 
-			PHASE_MAX * product(unit_vector(angle+0), get_size()),
-			this, sprite, sprite_index, hot_color, HOT_COLORS, 
-			PHASE_DELAY, PHASE_MAX, PHASE_DELAY) );
-	add(new Phaser (this, 
-//			x - cos(angle+PI/2) * PHASE_MAX * w, 
-//			y - sin(angle+PI/2) * PHASE_MAX * h, 
-			pos - PHASE_MAX * product(unit_vector(angle+PI/2), get_size()),
-//			cos(angle+PI/2) * PHASE_MAX * w, 
-//			sin(angle+PI/2) * PHASE_MAX * h, 
-			PHASE_MAX * product(unit_vector(angle+PI/2), get_size()),
-			NULL, sprite, (sprite_index+0)&amp;63, hot_color, HOT_COLORS, 
-			PHASE_DELAY, PHASE_MAX, PHASE_DELAY) );
-	add(new Phaser (this, 
-//			x - cos(angle-PI/2) * PHASE_MAX * w, 
-//			y - sin(angle-PI/2) * PHASE_MAX * h, 
-			pos - PHASE_MAX * product(unit_vector(angle-PI/2), get_size()),
-//			cos(angle-PI/2) * PHASE_MAX * w, 
-//			sin(angle-PI/2) * PHASE_MAX * h, 
-			PHASE_MAX * product(unit_vector(angle-PI/2), get_size()),
-			NULL, sprite, (sprite_index-0)&amp;63, hot_color, HOT_COLORS, 
-			PHASE_DELAY, PHASE_MAX, PHASE_DELAY) );
-
 	// copied from katpoly code
 	Ship *s;
 	s = game-&gt;create_ship( get_shiptype()-&gt;id, control, pos, angle, get_team() );
-
 	
+	
 	// the following prevents that a new ship will be &quot;selected&quot; based on this &quot;empty&quot; ship
 	attributes &amp;= ~ATTRIB_NOTIFY_ON_DEATH;
 	control = 0;
 
-	//game-&gt;add( s );              // add the ship
-	//s-&gt;materialize();                // materialize it
-	//s-&gt;crew = crew;                  // set it's attributes
-	//s-&gt;batt = batt - special_drain;  // [battery has to be decreased now]
-	//s-&gt;vel = vel;
 	update_panel = true;                 // maybe the colors changed
 	// end of copy
 
@@ -139,22 +111,20 @@
 	ShipPanel *panel = new ShipPanel(s);
 	panel-&gt;window-&gt;init(game-&gt;window);
 	panel-&gt;window-&gt;locate(
-		0, 0.9,
-		0, i * (100.0/480), 
-		0, 0.1,
-		0, (100.0/480)
-		);
+			      0, 0.9,
+			      0, i * (100.0/480), 
+			      0, 0.1,
+			      0, (100.0/480)
+			      );
 	add(panel);
-	//add(s-&gt;get_ship_phaser());
 	add(s);
 	s-&gt;materialize();                // materialize it
 	s-&gt;update_panel = true;
 	
-
 	crew = 0;
 	state = 0;
 
-
+	
 	// find and delete the panel that points to the current ship
 	for ( std::list&lt;Presence*&gt;::iterator i = physics-&gt;presence.begin(); 
 	      i!=physics-&gt;presence.end(); 
@@ -172,12 +142,13 @@
 		  }
 	      }
 	  }
-
+	
 	return r;
-  }
+}
 
 int PkunkFury::activate_weapon()
 {
+  STACKTRACE;
   add(new AnimatedShot(this, 
     Vector2(0.0, (get_size().y / 2.0)), angle, weaponVelocity, weaponDamage, weaponRange,
     weaponArmour, this, data-&gt;spriteWeapon, 10, 1, 1.0));
@@ -193,22 +164,25 @@
 
 void PkunkFury::calculate_fire_special()
 {
+  STACKTRACE;
+  if(fire_special) 
+    {
+      if((special_recharge &gt; 0) || (batt &gt;= batt_max))
+	return;
+      
+      batt += special_drain;
+      if(batt &gt; batt_max)
+	batt = batt_max;
+      
+      special_recharge = special_rate;
 
-  if(fire_special) {
-    if((special_recharge &gt; 0) || (batt &gt;= batt_max))
-      return;
+      tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleSpecial[special_sample]));
+      
+      special_sample = (special_sample + 1 + random(13)) % 14;
 
-    batt += special_drain;
-    if(batt &gt; batt_max)
-      batt = batt_max;
-
-    special_recharge = special_rate;
-
-    //sound.stop(data-&gt;sampleSpecial[special_sample]);
-
-    special_sample = (special_sample + 1 + random(13)) % 14;
-	play_sound2(data-&gt;sampleSpecial[special_sample]);
-  }
+      tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleSpecial[special_sample]));
+      tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleSpecial[special_sample]));
+    }
 }
 
 

Modified: branches/multiplayer-branch/source/sc2ships/shpslypr.cpp
===================================================================
--- branches/multiplayer-branch/source/sc2ships/shpslypr.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/sc2ships/shpslypr.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -20,12 +20,12 @@
 
 #include &quot;sc2ships.h&quot;
 #include &quot;frame.h&quot;
-REGISTER_FILE
 
 static const int Ndirections = 16;
 
 int SlylandroProbe::accelerate_gravwhip(SpaceLocation *source, double angle, double velocity, 
 										 double max_speed) {
+  STACKTRACE;
 	if (source == this) 
 		return Ship::accelerate(source, angle, velocity, max_speed);
 	return false;
@@ -68,6 +68,7 @@
 thrustActive(FALSE),
 thrustForward(TRUE)
 {
+  STACKTRACE;
 	sprite_index2 = random() &amp; 63;
 	segment_length = get_config_int(&quot;Weapon&quot;, &quot;SegmentLength&quot;,0);
 	segment_dispersion = get_config_int(&quot;Weapon&quot;, &quot;SegmentLengthDispersion&quot;,0);
@@ -87,12 +88,14 @@
 
 RGB SlylandroProbe::crewPanelColor(int k)
 {
+  STACKTRACE;
 	RGB c = {64,64,64};
 	return c;
 }
 
 void SlylandroProbe::calculate_turn_left()
 {
+  STACKTRACE;
 	if ( turn_left )
 	{
 		if (!last_turn_left)
@@ -101,20 +104,6 @@
 			realturnstep -= turn_rate * frame_time;
 	}
 
-	/*
-	if (!last_turn_left)
-	{
-		// turn at once ! This should make it look &quot;jerky&quot; since it responds
-		// immediately to a keypress; no delays !
-
-		realturnstep = -PI2 / Ndirections;
-	} else
-
-	// turnstep is the angle, really.
-  if(turn_left)
-		realturnstep -= turn_rate * frame_time;
-		*/
-
 	while (realturnstep &lt; 0)
 	{
 		realturnstep += PI2 / 16;//Ndirections;
@@ -125,6 +114,7 @@
 
 void SlylandroProbe::calculate_turn_right()
 {
+  STACKTRACE;
 	if ( turn_right )
 	{
 	if (!last_turn_right)
@@ -133,19 +123,6 @@
 		realturnstep += turn_rate * frame_time;
 	}
 
-	/*
-	if (!last_turn_right)
-	{
-		// turn at once ! This should make it look &quot;jerky&quot; since it responds
-		// immediately to a keypress; no delays !
-
-		realturnstep = PI2 / Ndirections;
-	} else
-
-  if(turn_right)
-		realturnstep += turn_rate * frame_time;
-		*/
-
 	while (realturnstep &gt; 0)
 	{
 		realturnstep -= PI2 / 16; // Ndirections;
@@ -157,65 +134,63 @@
 
 void SlylandroProbe::calculate()
 {
-	if (!(SlyLaser &amp;&amp; SlyLaser-&gt;exists()) )
+  STACKTRACE;
+  if (!(SlyLaser &amp;&amp; SlyLaser-&gt;exists()) )
+    SlyLaser = 0;
 
-		SlyLaser = 0;
+  last_turn_left = turn_left;
+  last_turn_right = turn_right;
 
+  Ship::calculate();
 	
-	last_turn_left = turn_left;
-	last_turn_right = turn_right;
-
-	Ship::calculate();
-
-	/*
-	// cause jerky movement ... 16 directions available, like in star control 2.
-	angle = (PI2/Ndirections) * int(0.5 + (Ndirections * realangle) / PI2 );
-	double v;
-	//	v = sqrt(vx*vx + vy*vy);
-	v = magnitude(vel);
-	//	vx = v * cos(angle*PI/180);
-	//	vy = v * sin(angle*PI/180);
 	
-	vel = v * unit_vector(angle);
-	// now you've jerky movement , 12 directions only.
-	*/
-	
-	if (fire_special) {
-		Query q;
-		for (q.begin(this, bit(LAYER_CBODIES), 100);q.current;q.next()) {
-			if (q.current-&gt;isAsteroid() &amp;&amp; q.current-&gt;canCollide(this)) {
-				if (damage(q.current, 1)) {
-					batt = batt_max;
-					play_sound2(data-&gt;sampleSpecial[0]);
-				}
-			}
+  if (fire_special) 
+    {
+      Query q;
+      for (q.begin(this, bit(LAYER_CBODIES), 100);q.current;q.next()) 
+	{
+	  if (q.current-&gt;isAsteroid() &amp;&amp; q.current-&gt;canCollide(this)) 
+	    {
+	      if (damage(q.current, 1)) 
+		{
+		  batt = batt_max;
+		  tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleSpecial[0]));
+		  tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleSpecial[0]));
 		}
-		q.end();
+	    }
 	}
-	
-	frame+= frame_time;
-	if(frame &gt;= 50) {
-		frame -= 50;
-		if(thrustForward) {
-			sprite_index2++;
-			if(sprite_index2 == 64)
-				sprite_index2 = 0;
-		} else {
-			sprite_index2--;
-			if(sprite_index2 == -1)
-				sprite_index2 = 63;
-		}
+      q.end();
+    }
+  
+  frame+= frame_time;
+  if(frame &gt;= 50) 
+    {
+      frame -= 50;
+      if(thrustForward) 
+	{
+	  sprite_index2++;
+	  if(sprite_index2 == 64)
+	    sprite_index2 = 0;
+	} 
+      else 
+	{
+	  sprite_index2--;
+	  if(sprite_index2 == -1)
+	    sprite_index2 = 63;
 	}
-	sprite_index = sprite_index2;
-	
+    }
+  sprite_index = sprite_index2; 
 }
 
 void SlylandroProbe::calculate_hotspots() {
+  STACKTRACE;
 }
 void SlylandroProbe::calculate_fire_special() {
+  STACKTRACE;
 	return;
 }
 void SlylandroProbe::calculate_thrust() {
+  STACKTRACE;
 	if (thrust &amp;&amp; !thrustActive) {
 		angle = angle + PI;
 		if (angle &gt; PI2) angle -= PI2;
@@ -229,8 +204,7 @@
 
 int SlylandroProbe::activate_weapon()
 {
-	
-	
+  STACKTRACE;	
 	SpaceLocation *t = NULL;
 	double r = 99999;
 	int i;
@@ -240,11 +214,8 @@
 			t = s;
 			r = distance(t);
 		}
-	}
-	//add(new SlylandroLaser( this, this, t, segments, segment_length,
-    //                                     segment_dispersion, rnd_angle, aiming, dispersion));
+	}	
 	
-	
 	if (!(SlyLaser &amp;&amp; SlyLaser-&gt;exists()) )
 	{
 		SlyLaser = new SlylandroLaserNew( this, t );
@@ -257,13 +228,9 @@
 }
 
 
-
-// ALTERNATIVE FOR THE SLYLANDRO LASER
-
-
-
 SlylandroLaserNew::SlylandroLaserNew(SpaceLocation *lroot, SpaceLocation *ltarget)
 {
+  STACKTRACE;
 	
 	max_length = 400.0;
 	existtime = 1200.0;		// in milliseconds ?
@@ -289,6 +256,7 @@
 
 void SlylandroLaserNew::calculate()
 {
+  STACKTRACE;
 	lifetime += frame_time;
 
 	if ( lifetime &gt; existtime || !(mother &amp;&amp; mother-&gt;exists()) )
@@ -496,6 +464,7 @@
 
 void SlylandroLaserNew::animate(Frame *frame)
 {
+  STACKTRACE;
 	int i, iline;
 	
 	if ( !(mother &amp;&amp; mother-&gt;exists()) )

Modified: branches/multiplayer-branch/source/sc2ships/shpsupbl.cpp
===================================================================
--- branches/multiplayer-branch/source/sc2ships/shpsupbl.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/sc2ships/shpsupbl.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 #include &quot;sc2ships.h&quot;
 
@@ -25,6 +24,7 @@
 	:
 	Ship(opos, shipAngle, shipData, code)
 {
+  STACKTRACE;
 
   weaponRange    = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
   weaponVelocity = scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
@@ -34,6 +34,7 @@
 
 void SupoxBlade::calculate_thrust()
 {
+  STACKTRACE;
 
   if(thrust || ((fire_special) &amp;&amp; (turn_left || turn_right || thrust))) {
     if((fire_special) &amp;&amp; (turn_left)) {
@@ -54,31 +55,36 @@
 
 void SupoxBlade::calculate_turn_left()
 {
+  STACKTRACE;
   if(!fire_special)
     Ship::calculate_turn_left();
 }
 
 void SupoxBlade::calculate_turn_right()
 {
+  STACKTRACE;
   if(!fire_special)
     Ship::calculate_turn_right();
 }
 
 void SupoxBlade::calculate_hotspots()
 {
+  STACKTRACE;
   if(!fire_special)
     Ship::calculate_hotspots();
 }
 
 int SupoxBlade::activate_weapon()
 {
+  STACKTRACE;
   add(new Missile(this, Vector2(0.0, 0.5*get_size().y / 2.0),
     angle, weaponVelocity, weaponDamage, weaponRange, weaponArmour,
     this, data-&gt;spriteWeapon));
   return(TRUE);
 }
 
-void SupoxBlade::calculate_fire_special() {}
+void SupoxBlade::calculate_fire_special() {
+  STACKTRACE;}
 
 
 

Modified: branches/multiplayer-branch/source/sc2ships/shpthrto.cpp
===================================================================
--- branches/multiplayer-branch/source/sc2ships/shpthrto.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/sc2ships/shpthrto.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 #include &quot;sc2ships.h&quot;
 
@@ -36,6 +35,7 @@
 	:
 	Ship(opos, shipAngle, shipData, code)
 {
+  STACKTRACE;
 
   weaponRange    = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
   weaponVelocity = scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
@@ -48,6 +48,7 @@
 }
 
 int ThraddashTorch::activate_weapon() {
+  STACKTRACE;
   add(new Missile(this, Vector2(0.0, 0.5*get_size().y),
     angle, weaponVelocity, weaponDamage, weaponRange, weaponArmour,
     this, data-&gt;spriteWeapon));
@@ -55,6 +56,7 @@
 }
 
 int ThraddashTorch::activate_special() {
+  STACKTRACE;
 	accelerate(this, angle, specialThrust, MAX_SPEED);
   add(new ThraddashFlame(
 //    x ,//- cos(angle) * (width() / 2.0),
@@ -66,6 +68,7 @@
 
 void ThraddashTorch::calculate_thrust()
 {
+  STACKTRACE;
 	if(special_recharge &lt;= 0) Ship::calculate_thrust();
 }
 
@@ -74,6 +77,7 @@
   Animation(oship, opos, osprite, 0, ofcount, ofsize, DEPTH_SHOTS),
   armour(oarmour)
 {
+  STACKTRACE;
 	  layer = LAYER_SHOTS;
 	collide_flag_anyone = ALL_LAYERS;
 	collide_flag_sameteam = ALL_LAYERS;
@@ -90,17 +94,19 @@
 
 void ThraddashFlame::calculate()
 {
+  STACKTRACE;
 	Animation::calculate();
 }
 
 int ThraddashFlame::handle_damage(SpaceLocation *source, double normal, double direct) {
+  STACKTRACE;
 	int total = iround(normal + direct);
 	armour -= total;
 
 	if ((armour &lt;= 0) || (source-&gt;isObject() &amp;&amp; ((SpaceObject*)source)-&gt;mass)) {
 		state = 0;
 		add(new Animation(this, normal_pos(), //normal_x(), normal_y(), 
-				meleedata.sparkSprite, 0, SPARK_FRAMES, 50, DEPTH_EXPLOSIONS));
+				game-&gt;meleedata.sparkSprite, 0, SPARK_FRAMES, 50, DEPTH_EXPLOSIONS));
 		}
 	return total;
 	}

Modified: branches/multiplayer-branch/source/sc2ships/shputwju.cpp
===================================================================
--- branches/multiplayer-branch/source/sc2ships/shputwju.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/sc2ships/shputwju.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 #include &quot;frame.h&quot;
 
@@ -27,6 +26,7 @@
 	:
 	Ship(opos, shipAngle, shipData, code)
 {
+  STACKTRACE;
 
   weaponRange    = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
   weaponVelocity = scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
@@ -37,6 +37,7 @@
 
 void UtwigJugger::calculate()
 {
+  STACKTRACE;
         Ship::calculate();
         if (!fire_special)
                 special_recharge = 0;
@@ -44,6 +45,7 @@
 
 void UtwigJugger::calculate_fire_weapon()
 {
+  STACKTRACE;
   weapon_low = FALSE;
 
   if(fire_weapon) {
@@ -72,36 +74,46 @@
 
     weapon_recharge = weapon_rate;
 
-    play_sound2(data-&gt;sampleWeapon[0]);
+    tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleWeapon[0]));
+    tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleWeapon[0]));
   }
 }
 
-void UtwigJugger::animate(Frame *space) {
-	if (special_recharge &gt; 0) {
-		sprite-&gt;animate_character(pos, sprite_index, pallete_color[hot_color[((int)(special_recharge/10)) % HOT_COLORS]], space);
-		}
-	else sprite-&gt;animate( pos, sprite_index, space);
-	return;
+void UtwigJugger::animate(Frame *space) 
+{
+  STACKTRACE;
+  if (special_recharge &gt; 0) 
+    {
+      sprite-&gt;animate_character(pos, sprite_index, 
+				pallete_color[hot_color[((int)(special_recharge/10)) % HOT_COLORS]], 
+				space);
+    }
+  else 
+    sprite-&gt;animate( pos, sprite_index, space);
 }
 
-int UtwigJugger::handle_damage(SpaceLocation *source, double normal, double direct) {
-	if (special_recharge &gt; 0) {
-		batt += normal;
-		if (batt &gt; batt_max) batt = batt_max;
-		normal = 0;
-	}
-	if (fortitude &amp;&amp; (normal &gt; 0)) {
-		if (normal &gt; random(3)) normal -= fortitude;
-		if (normal &lt; 0) normal = 0;
-	}
-	return Ship::handle_damage(source, normal, direct);
+int UtwigJugger::handle_damage(SpaceLocation *source, double normal, double direct) 
+{
+  STACKTRACE;
+  if (special_recharge &gt; 0) 
+    {
+      batt += normal;
+      if (batt &gt; batt_max) 
+	batt = batt_max;
+      normal = 0;
+    }
+  if (fortitude &amp;&amp; (normal &gt; 0)) 
+    {
+      if (normal &gt; random(3)) 
+	normal -= fortitude;
+      if (normal &lt; 0) normal = 0;
+    }
+  return Ship::handle_damage(source, normal, direct);
 }
 
 double UtwigJugger::isProtected() const
 {
-	return (special_recharge &gt; 0) ? 1 : 0;
+  return (special_recharge &gt; 0) ? 1 : 0;
 }
 
-
-
 REGISTER_SHIP(UtwigJugger)

Modified: branches/multiplayer-branch/source/sc2ships/shpzfpst.cpp
===================================================================
--- branches/multiplayer-branch/source/sc2ships/shpzfpst.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/sc2ships/shpzfpst.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 #include &lt;math.h&gt;
 
@@ -56,6 +55,7 @@
 	:
 	Ship(opos, shipAngle, shipData, code)
 {
+  STACKTRACE;
 
   weaponRange    = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
   weaponVelocity = scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
@@ -66,6 +66,7 @@
 }
 
 int ZoqFotPikStinger::activate_weapon() {
+  STACKTRACE;
   add(new ZoqFotPikShot(
     Vector2(0.0, 0.5*get_size().y), angle + ANGLE_RATIO * random(-10.0, 10.0),
     weaponVelocity, weaponDamage, weaponRange, weaponArmour, this,
@@ -75,6 +76,7 @@
 
 int ZoqFotPikStinger::activate_special()
 {
+  STACKTRACE;
   add(new ZoqFotPikTongue(
     39, specialDamage, this, data-&gt;spriteSpecial, 6, 50));
   return(TRUE);
@@ -86,10 +88,12 @@
   Shot(oship, opos, oangle, ov, odamage, orange, oarmour, oship, osprite),
   frame_count(num_frames)
 {
+  STACKTRACE;
 }
 
 void ZoqFotPikShot::calculate()
 {
+  STACKTRACE;
   Shot::calculate();
   sprite_index = (int)((d / range) * (double)(frame_count - 1));
 }
@@ -106,6 +110,7 @@
   frame_count(ofcount),
   frame_step(0)
 {
+  STACKTRACE;
   layer = LAYER_SHOTS;
   set_depth(DEPTH_SHOTS);
   damage_factor = abs(lick_factor);
@@ -122,6 +127,7 @@
 
 void ZoqFotPikTongue::calculate()
 {
+  STACKTRACE;
   int current_frame = frame;
 
   if (!(ship &amp;&amp; ship-&gt;exists()))
@@ -154,6 +160,7 @@
 
 void ZoqFotPikTongue::inflict_damage(SpaceObject *other)
 {
+  STACKTRACE;
   SpaceObject::inflict_damage(other); 
   damage_factor = 0;
 

Modified: branches/multiplayer-branch/source/scp.cpp
===================================================================
--- branches/multiplayer-branch/source/scp.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/scp.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,7 +1,6 @@
-/* $Id: scp.cpp,v 1.6 2004/08/08 17:36:03 Yura Exp $ */ 
 /*
 This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
 Copyright (C) 2001-2004  TimeWarp development team
 
 This program is free software; you can redistribute it and/or modify
@@ -41,7 +40,6 @@
 #define APPLICATION_NAME &quot;TW-Light&quot;
 
 #include &quot;melee.h&quot;
-REGISTER_FILE
 #include &quot;scp.h&quot;
 #include &quot;gui.h&quot;
 #include &quot;frame.h&quot;
@@ -60,15 +58,48 @@
 #include &quot;melee/mship.h&quot; //remove
 #include &quot;melee/mfleet.h&quot;
 
-#include &quot;util/sounds.h&quot;
 
+/// Get SVN revision number from version file (this function work if user does not have subversion)
+std::string GetSVNVersion()
+{
+  std::string tw_svn_version = TW_SVNVERSION;
+  if(!(tw_svn_version==&quot;exported&quot;||tw_svn_version == &quot;&quot;))
+    return tw_svn_version;
+  
+  int i;
+  char buffy [16000] = {0};
+  PACKFILE *f;
+  
+  f = pack_fopen (data_full_path(&quot;version.txt&quot;).c_str(), F_READ);
+  if (!f)
+    {
+      tw_error(&quot;Unable to retrive version information&quot;);
+    }
+  else 
+    {
+      i = pack_fread (buffy, 15999, f);
+      pack_fclose(f);
+      buffy[i] = 0;
+    }
+  char *s = strchr(buffy, 'r');
+  if(!s)
+    {
+      return &quot;&quot;;
+    }
+
+  char ver[30] = {0};
+  sscanf(s+1, &quot;%s&quot;, ver);
+  return ver;
+}
+
 std::string tw_version() 
 {
+  STACKTRACE;
   std::string tw_version_string;
-	
+
   tw_version_string += std::string(APPLICATION_NAME) + &quot; &quot;  + std::string(TW_MAJOR_VERSION) 
     + &quot;r&quot; 
-    + std::string(TW_SVNVERSION)
+    + GetSVNVersion()
     + &quot; Built: &quot;
     + __DATE__
     + &quot; &quot;
@@ -81,11 +112,10 @@
 //this technique was ever created.
 #define SCPGUI_TITLE   0
 
-DATAFILE *scp = NULL;
 FILE *debug_file;
 
 /*! \brief Blits GUI background bitmap on to a video window */
-void showTitle(VideoWindow *window = &amp;videosystem.window);
+void showTitle(VideoWindow *window = &amp;videosystem-&gt;window);
 
 /*! \brief MELEE_EX dialog - selects alternate games as opposed to standard melee. 
   From here you can access diagnostics (DIAGNOSTICS dialog) and ship info. 
@@ -126,6 +156,7 @@
 
 Log *new_log (int logtype) 
 {
+  STACKTRACE;
   union 
   { 
     Log *log; 
@@ -158,6 +189,7 @@
 
 char *detect_gametype( Log *_log ) 
 {
+  STACKTRACE;
   int ltype;
   _log-&gt;unbuffer(Game::channel_init, &amp;ltype, sizeof(int));
   ltype = intel_ordering(ltype);
@@ -191,8 +223,9 @@
 */
 void prepareTitleScreenAssets() 
 {
+  STACKTRACE;
   titleMusic = data_full_path(&quot;music/Robeter-Space-Gods-Loop.ogg&quot;);
-  tw_sound.play_music(titleMusic);
+  tw_sound-&gt;play_music(titleMusic);
 
   menuAccept   = data_full_path(&quot;sound/menu/MENUACCEPT.wav&quot;);
   menuFocus    = data_full_path(&quot;sound/menu/MENUFOCUS.wav&quot;);
@@ -202,57 +235,36 @@
   titlePic = load_bitmap(data_full_path(&quot;images/scptitle.jpg&quot;).c_str(), NULL);
 }
 
-/** clears the screen, and displays a loading message to the user.
-*/
-void showLoadingScreen() {
-    static BITMAP * logo = NULL;
-    static int depth = bitmap_color_depth(screen);
+/// clears the screen, and displays a loading message to the user.
+void showLoadingScreen() 
+{
+  STACKTRACE;
+  
+  std::vector&lt;std::string&gt; waitpics;
+  waitpics.push_back(data_full_path(&quot;images/bspab.jpg&quot;));
+  waitpics.push_back(data_full_path(&quot;images/stangrop.jpg&quot;));
+  
+  acquire_screen(); 
+  clear_to_color(screen, 0);
+ 
+  int pic = rand()%waitpics.size();
 
-    acquire_screen(); 
-    clear_to_color(screen, 0);
-
-    if (NULL == logo || bitmap_color_depth(screen) != depth) 
-    {
-        depth = bitmap_color_depth(screen);
-        
-	BITMAP * temp = load_bitmap(data_full_path(&quot;images/logo.bmp&quot;).c_str(),NULL);
-	logo = create_bitmap(temp-&gt;w, temp-&gt;h);
-	blit(temp, logo, 0,0, 0,0, temp-&gt;w, temp-&gt;h);
-	destroy_bitmap(temp);
-    }
-
-    if (logo != NULL ) {
-        if (screen-&gt;w/2 &gt;= logo-&gt;w) {
-            draw_sprite(screen, logo, screen-&gt;w/2 - logo-&gt;w/2, screen-&gt;h/2 - logo-&gt;h/2);
-        }
-        else {
-            float ratio = logo-&gt;w / logo-&gt;h;
-            
-            int h = screen-&gt;h/4;
-            int w = iround(ratio * h);                
-
-            stretch_blit(logo, screen, 
-                0,0, 
-                logo-&gt;w, logo-&gt;h,
-                screen-&gt;w/2 - w/2, screen-&gt;h/2 - h/2,
-                w, h);
-        }
-    }
-
-    const char * loadString = &quot;Loading...&quot;;
-    textout_right(screen, font, loadString, 
-        screen-&gt;w - 1*text_length(font, loadString), screen-&gt;h - 4*text_height(font), 
-        palette_color[15]);
-    release_screen();
+  BITMAP * temp = load_bitmap(waitpics[pic].c_str(), NULL);
+  stretch_blit(temp, screen, 0, 0, temp-&gt;w, temp-&gt;h, 0, 0, screen-&gt;w, screen-&gt;h);
+  destroy_bitmap(temp);
+  release_screen();
 }
 
-int is_escape_pressed() {
-	poll_keyboard();
-	return key[KEY_ESC];
+int is_escape_pressed() 
+{
+  STACKTRACE;
+  poll_keyboard();
+  return key[KEY_ESC];
 }
 
-void play_game(const char *_gametype_name, Log *_log) {
-  bool gui_stuff = false;
+void play_game(const char *_gametype_name, Log *_log) 
+{
+  STACKTRACE;
   char gametype_name[1024];
   char *c;
   Game *new_game = NULL;
@@ -262,72 +274,74 @@
   strncpy(gametype_name, _gametype_name, 1000);
   for (c = strchr(gametype_name, '_'); c; c = strchr(c, '_'))
     *c = ' ';
-  
-  
-  
-  if (scp) {
-    gui_stuff = true;
-    sound.stop_music();
-    if (scp) unload_datafile(scp);
-    scp = NULL;
-  }
-  
-  try {
-    if (game) {
-      delete game;
+
+  try 
+    {
+      if (game) 
+	{
+	  delete game;
+	  game = NULL;
+	}
+    
+      if (!_log) 
+	{
+	  _log = new Log();
+	  _log-&gt;init();
+	}
+      
+      GameType *type = gametype(gametype_name);
+      if (type)
+	new_game = type-&gt;new_game();
+      else
+	tw_error(&quot;wait a sec... I can't find that game type&quot;);
+    
+      new_game-&gt;preinit();
+      new_game-&gt;window = new VideoWindow;
+      new_game-&gt;window-&gt;preinit();
+      new_game-&gt;window-&gt;init(&amp;videosystem-&gt;window);
+      new_game-&gt;window-&gt;locate(0,0,0,0,0,1,0,1);
+      new_game-&gt;init(_log);
+      new_game-&gt;play();
+      new_game-&gt;log-&gt;deinit();
+      new_game-&gt;setGameDone(true);
+      
+      //damn global variables!
+      // inside melee/mgame.cpp, in Game::prepare, ::game is set to the value of the current game
+      // inside ais/c_wussiebot.cpp (and some other places), ::game is used
+      delete new_game;
       game = NULL;
     }
-    
-    if (!_log) {
-      _log = new Log();
-      _log-&gt;init();
+  
+  catch (int i) 
+    {
+      if (i == -1) 
+	throw;
+      if (__error_flag &amp; 1) 
+	throw;
+      if (i != 0) 
+	caught_error (&quot;%s %s caught int %d&quot;, __FILE__, __LINE__, i);
+      if (__error_flag &amp; 1) 
+	throw;
     }
-    
-    GameType *type = gametype(gametype_name);
-    if (type)
-      new_game = type-&gt;new_game();
-    else
-      tw_error(&quot;wait a sec... I can't find that game type&quot;);
-    
-    new_game-&gt;preinit();
-    new_game-&gt;window = new VideoWindow;
-    new_game-&gt;window-&gt;preinit();
-    new_game-&gt;window-&gt;init(&amp;videosystem.window);
-    new_game-&gt;window-&gt;locate(0,0,0,0,0,1,0,1);
-    new_game-&gt;init(_log);
-    new_game-&gt;play();
-    new_game-&gt;log-&gt;deinit();
-    //game = NULL;
-    new_game-&gt;setGameDone(true);
-    
-    //damn global variables!
-    // inside melee/mgame.cpp, in Game::prepare, ::game is set to the value of the current game
-    // inside ais/c_wussiebot.cpp (and some other places), ::game is used
-    delete new_game;
-    game = NULL;
-  }
+  catch (const char *str) 
+    {
+      if (__error_flag &amp; 1) 
+	throw;
+      caught_error(&quot;message: \&quot;%s\&quot;&quot;, str);
+      if (__error_flag &amp; 1) 
+	throw;
+    }
+  catch (...) 
+    {
+      if (__error_flag &amp; 1) 
+	throw;
+      caught_error(&quot;Ack(2)!!!\nAn error occured!\nBut I don't know what error!&quot;);
+      if (__error_flag &amp; 1) 
+	throw;
+    }
   
-  catch (int i) {
-    if (i == -1) throw;
-    if (__error_flag &amp; 1) throw;
-    if (i != 0) caught_error (&quot;%s %s caught int %d&quot;, __FILE__, __LINE__, i);
-    if (__error_flag &amp; 1) throw;
-  }
-  catch (const char *str) {
-    if (__error_flag &amp; 1) throw;
-    caught_error(&quot;message: \&quot;%s\&quot;&quot;, str);
-    if (__error_flag &amp; 1) throw;
-  }
-  catch (...) {
-    if (__error_flag &amp; 1) throw;
-    caught_error(&quot;Ack(2)!!!\nAn error occured!\nBut I don't know what error!&quot;);
-    if (__error_flag &amp; 1) throw;
-  }
-  
-  if (gui_stuff) {
-    prepareTitleScreenAssets();
-    showTitle();
-  }
+  prepareTitleScreenAssets();
+  showTitle();
   return;
 }
 
@@ -357,7 +371,9 @@
 int *player_config = NULL;
 int *player_team = NULL;
 
-Control *load_player(int i) {STACKTRACE
+Control *load_player(int i) 
+{
+  STACKTRACE;
 	char tmp[32];
 	Control *r = NULL;
 
@@ -371,7 +387,8 @@
 }
 
 
-class MainMenu : public BaseClass {
+class MainMenu : public BaseClass 
+{
 	public:
 	virtual void _event(Event * e);
 	virtual void preinit();
@@ -382,103 +399,119 @@
 	virtual void disable();
 	int state;
 	VideoWindow *window;
-	
-	/*! This is the title music object if the ogg title music is not available*/
-	Music * titleMusic;
 } mainmenu;
 
-void MainMenu::_event(Event *e) {
+void MainMenu::_event(Event *e) 
+{
+  STACKTRACE;
+		   
 	if (e-&gt;type == Event::VIDEO) {
 		if (e-&gt;subtype == VideoEvent::REDRAW) if (state &amp; 1) showTitle();
 	}
 }
 
-void MainMenu::enable() {STACKTRACE
+void MainMenu::enable() 
+{
+  STACKTRACE;
+		   
 	if (!(state &amp; 2)) window-&gt;add_callback(this);
 	state |= 3;
 }
 
-void MainMenu::disable() {STACKTRACE
-	state &amp;=~ 1;
+void MainMenu::disable() 
+{
+  STACKTRACE;
+		   
+  state &amp;=~ 1;
 }
 
-void MainMenu::preinit() {
-	window = NULL;
-	state = 0;
+void MainMenu::preinit() 
+{
+  STACKTRACE; 
+  window = NULL;
+  state = 0;
 }
 
-void MainMenu::init(VideoWindow *parent) {
-	if (window) window-&gt;init(parent);
-	else {
+void MainMenu::init(VideoWindow *parent) 
+{
+  STACKTRACE; 
+  if (window) window-&gt;init(parent);
+  else {
 		window = new VideoWindow();
 		window-&gt;preinit();
 		window-&gt;init(parent);
 	}
 }
 
-void MainMenu::deinit() {
-	STACKTRACE
-	if (state &amp; 2) {
-		window-&gt;remove_callback(this);
-		window-&gt;deinit();
-		delete window;
-		window = NULL;
-	}
+void MainMenu::deinit() 
+{
+  STACKTRACE;   
+		   
+  if (state &amp; 2) 
+    {
+      window-&gt;remove_callback(this);
+      window-&gt;deinit();
+      delete window;
+      window = NULL;
+    }
 }
 
-void MainMenu::doit() {STACKTRACE
-	int i;
-	char tmp[32];
-
-	tw_set_config_file(&quot;scp.ini&quot;);
-	if (!player_type) {		
-		MAX_PLAYERS        = get_config_int(&quot;Limits&quot;, &quot;MaxPlayers&quot;, 12);
-		MAX_CONFIGURATIONS = get_config_int(&quot;Limits&quot;, &quot;MaxConfigurations&quot;, 4);
-		MAX_TEAMS          = get_config_int(&quot;Limits&quot;, &quot;MaxTeams&quot;, 6);
-		player_type = new char*[MAX_PLAYERS];
-		player_config = new int[MAX_PLAYERS];
-		player_team   = new int[MAX_PLAYERS];
-	}
-	for (i = 0; i &lt; MAX_PLAYERS; i += 1) {
-		sprintf(tmp, &quot;Player%d&quot;, i+1);
-		player_type[i] = strdup(get_config_string(tmp, &quot;Type&quot;, &quot;Human&quot;));
-		player_config[i] = get_config_int (tmp, &quot;Config&quot;, i % MAX_CONFIGURATIONS);
-		player_team[i] = get_config_int (tmp, &quot;Team&quot;, 0);
-	}
-
-    prepareTitleScreenAssets();
-	showTitle();
-	enable();
-
-	int mainRet;
-	do {
-		//mainRet = popup_dialog(mainDialog, MAIN_DIALOG_MELEE);
-		mainRet = tw_do_dialog(window, mainDialog, MAIN_DIALOG_MELEE);
-		switch (mainRet) {
-			case MAIN_DIALOG_MELEE:
-				disable();
-				play_game(&quot;Melee&quot;);
-				enable();
-				break;
-			case MAIN_DIALOG_MELEE_EXTENDED:
-				disable();
-				extended_menu();
-				enable();
-				break;
-			case MAIN_DIALOG_OPTIONS:
-				showTitle();
-				options_menu(NULL);
-				break;
-			case MAIN_DIALOG_HELP:
-				show_file(data_full_path(&quot;ingame.txt&quot;).c_str());
-				break;
-			case MAIN_DIALOG_TEAMS:
-				change_teams();
-				showTitle();
-				break;
-		}
-	} while((mainRet != MAIN_DIALOG_EXIT) &amp;&amp; (mainRet != -1));
-
+void MainMenu::doit() 
+{
+  STACKTRACE;
+		   
+  int i;
+  char tmp[32];
+  
+  tw_set_config_file(&quot;scp.ini&quot;);
+  if (!player_type) {		
+    MAX_PLAYERS        = get_config_int(&quot;Limits&quot;, &quot;MaxPlayers&quot;, 12);
+    MAX_CONFIGURATIONS = get_config_int(&quot;Limits&quot;, &quot;MaxConfigurations&quot;, 4);
+    MAX_TEAMS          = get_config_int(&quot;Limits&quot;, &quot;MaxTeams&quot;, 6);
+    player_type = new char*[MAX_PLAYERS];
+    player_config = new int[MAX_PLAYERS];
+    player_team   = new int[MAX_PLAYERS];
+  }
+  for (i = 0; i &lt; MAX_PLAYERS; i += 1) {
+    sprintf(tmp, &quot;Player%d&quot;, i+1);
+    player_type[i] = strdup(get_config_string(tmp, &quot;Type&quot;, &quot;Human&quot;));
+    player_config[i] = get_config_int (tmp, &quot;Config&quot;, i % MAX_CONFIGURATIONS);
+    player_team[i] = get_config_int (tmp, &quot;Team&quot;, 0);
+  }
+  
+  prepareTitleScreenAssets();
+  showTitle();
+  enable();
+  
+  int mainRet;
+  do {
+    //mainRet = popup_dialog(mainDialog, MAIN_DIALOG_MELEE);
+    mainRet = tw_do_dialog(window, mainDialog, MAIN_DIALOG_MELEE);
+    switch (mainRet) {
+    case MAIN_DIALOG_MELEE:
+      disable();
+      play_game(&quot;Melee&quot;);
+      enable();
+      break;
+    case MAIN_DIALOG_MELEE_EXTENDED:
+      disable();
+      extended_menu();
+      enable();
+      break;
+    case MAIN_DIALOG_OPTIONS:
+      showTitle();
+      options_menu(NULL);
+      break;
+    case MAIN_DIALOG_HELP:
+      show_file(data_full_path(&quot;ingame.txt&quot;).c_str());
+      break;
+    case MAIN_DIALOG_TEAMS:
+      change_teams();
+      showTitle();
+      break;
+    }
+  } while((mainRet != MAIN_DIALOG_EXIT) &amp;&amp; (mainRet != -1));
+  
 }
 
 int tw_main(int argc, char *argv[]);
@@ -513,19 +546,18 @@
   strncpy(datapath, argv[0], i);
   chdir(datapath);
 #endif
-  
-#if (defined _MSC_VER) &amp;&amp; (defined _DEBUG)
-  _CrtSetDbgFlag(_CRTDBG_REPORT_FLAG|_CRTDBG_LEAK_CHECK_DF);
-#endif
-  
+
   log_debug(NULL);
   time_t start_time = time(NULL);
   log_debug(&quot;Log started at %s\n&quot;, asctime(localtime(&amp;start_time)));
   if (allegro_init() &lt; 0)
     tw_error_exit(&quot;Allegro initialization failed&quot;);
   create_user_ini();
-  videosystem.preinit();
   
+  VideoSystem video;
+  videosystem = &video;
+  videosystem-&gt;preinit();
+  
   try {
     init_time();
     init_error();
@@ -579,10 +611,6 @@
 	log_debug(&quot;command-line argument -window\n&quot;);
 	fullscreen = false;
       }
-      else if (!strcmp(argv[i], &quot;-nosound&quot;) &amp;&amp; (argc &gt; i + 0)) {
-	log_debug(&quot;command-line argument -nosound\n&quot;);
-	sound.disable();
-      }
       else if (!strcmp(argv[i], &quot;-nokeyboard&quot;) &amp;&amp; (argc &gt; i + 0)) {
 	log_debug(&quot;command-line argument -nokeyboard\n&quot;);
 	inputs &amp;= ~1;
@@ -621,7 +649,7 @@
     srand(time(NULL));
     set_color_conversion(COLORCONV_KEEP_TRANS);
     
-    videosystem.set_resolution(screen_width, screen_height, screen_bpp, fullscreen);
+    videosystem-&gt;set_resolution(screen_width, screen_height, screen_bpp, fullscreen);
     register_bitmap_file_type(&quot;jpg&quot;, load_jpg, NULL);
     if(!theme)
 	theme = agup_theme_by_name(&quot;Photon&quot;);
@@ -634,56 +662,64 @@
     gui_text_list_proc = d_agup_text_list_proc;
 
     enable_input(inputs);
-    sound.init();
-    sound.load();
     
+    SoundSystem sound;
+    tw_sound = &sound;
+    tw_sound-&gt;set_sound_volume(tw_sound-&gt;load_sound_volume());
+    tw_sound-&gt;set_music_volume(tw_sound-&gt;load_music_volume());
+    
     showLoadingScreen();
     
     View *v = NULL;
     v = get_view ( get_config_string(&quot;View&quot;, &quot;View&quot;, NULL) , NULL );
     if (!v) v = get_view ( &quot;Hero&quot;, NULL );
     set_view(v);
-    
-
-    
     init_ships();
     init_fleet();
-    meleedata.init();//mainmain
     
     if (auto_play) {// FIX ME
       if (!strcmp(auto_play, &quot;game&quot;)) play_game(auto_param, NULL);
     }
     else {
       mainmenu.preinit();
-      mainmenu.init(&amp;videosystem.window);
+      mainmenu.init(&amp;videosystem-&gt;window);
       mainmenu.doit();
       mainmenu.deinit();
     }
-    
+
     if(game)
       {
 	delete game;
 	game = NULL;
       }
-    meleedata.deinit();
-    sound.disable();
     disable_input(); 
   }
-  
   catch (int i) {
-    if (i == -1) throw;
-		if (__error_flag &amp; 1) throw;
-		if (i != 0) caught_error(&quot;%s %s caught int %d&quot;, __FILE__, __LINE__, i);
-		if (__error_flag &amp; 1) throw;
+    if (i == -1) 
+      throw;
+    if (__error_flag &amp; 1) 
+      throw;
+    if (i != 0) 
+      {
+	char t[256];
+	sprintf(t, &quot;caught int %d&quot;, i);
+	tw_error(t);
+      }
+    if (__error_flag &amp; 1) 
+      throw;
   }
   catch (const char *str) {
-    if (__error_flag &amp; 1) throw;
-    caught_error(&quot;message: \&quot;%s\&quot;&quot;, str);
-    if (__error_flag &amp; 1) throw;
-	}
+    if (__error_flag &amp; 1) 
+      throw;
+    std::string tmp = &quot;message: \&quot;&quot;;
+    tmp += std::string(str) + &quot;\&quot;&quot;;
+    tw_error(tmp.c_str());
+    if (__error_flag &amp; 1) 
+      throw;
+  }
   catch (...) {
     if (__error_flag &amp; 1) throw;
-    caught_error(&quot;Ack!!!\nAn error occured on startup!\nBut I don't know what error!&quot;);
+    tw_error(&quot;Ack!!!\nAn error occured on startup!\nBut I don't know what error!&quot;);
     if (__error_flag &amp; 1) throw;
 	}
   
@@ -693,39 +729,44 @@
 
 
 
-void showTitle(VideoWindow *window) {
-	BITMAP *src = titlePic;
-	if(!src)
-	{
-		return;
-		tw_error(&quot;Unable to open title pic&quot;);
-	}
+void showTitle(VideoWindow *window) 
+{
+  STACKTRACE;
+  BITMAP *src = titlePic;
+  if(!src)
+    {
+      return;
+      tw_error(&quot;Unable to open title pic&quot;);
+    }
 
-	if (!window-&gt;surface)
-		return;
-	window-&gt;lock();
-	stretch_blit(src, window-&gt;surface, 
-		0,0,src-&gt;w,src-&gt;h,
-		window-&gt;x, window-&gt;y, window-&gt;w, window-&gt;h);
-	const char * version = tw_version().c_str();
-    textout_right(screen, font, version, 
-        screen-&gt;w - 0*text_length(font, version), screen-&gt;h - 1*text_height(font), 
-        palette_color[15]);
-	window-&gt;unlock();
-	return;
+  if (!window-&gt;surface)
+    return;
+  window-&gt;lock();
+  stretch_blit(src, window-&gt;surface, 
+	       0,0,src-&gt;w,src-&gt;h,
+	       window-&gt;x, window-&gt;y, window-&gt;w, window-&gt;h);
+
+  textout_right(screen, font, tw_version().c_str(), 
+		screen-&gt;w - 0*text_length(font, tw_version().c_str()), screen-&gt;h - 1*text_height(font), 
+		palette_color[15]);
+  window-&gt;unlock();
+  return;
 }
 
 
-const char *select_game_menu () {STACKTRACE
-	select_game_dialog[2].dp3 = game_names;
-	tw_set_config_file(&quot;client.ini&quot;);
-	select_game_dialog[2].d1 = get_config_int(&quot;Menu&quot;, &quot;SelectGame&quot;, 0);
-	int i = tw_popup_dialog(NULL, select_game_dialog, 2);
-	if (i == -1) return NULL;
-	else {
-		set_config_int(&quot;Menu&quot;, &quot;SelectGame&quot;, select_game_dialog[2].d1);
-		return game_names[select_game_dialog[2].d1];
-	}
+const char *select_game_menu () {
+  STACKTRACE;
+  select_game_dialog[2].dp3 = game_names;
+  tw_set_config_file(&quot;client.ini&quot;);
+  select_game_dialog[2].d1 = get_config_int(&quot;Menu&quot;, &quot;SelectGame&quot;, 0);
+  int i = tw_popup_dialog(NULL, select_game_dialog, 2);
+  if (i == -1) 
+    return NULL;
+  else 
+    {
+      set_config_int(&quot;Menu&quot;, &quot;SelectGame&quot;, select_game_dialog[2].d1);
+      return game_names[select_game_dialog[2].d1];
+    }
 }
 
 // MELEE_EX - dialog function
@@ -754,10 +795,9 @@
   case MELEE_EX_DIALOG_LICENSE:
   	  show_file(COPYING_FILE);
   	  break;
-  case MELEE_EX_DIALOG_SHIPINFO: {
-    ship_view_dialog(0, NULL);
-  }
-  break;
+  case MELEE_EX_DIALOG_SHIPINFO:
+    ship_view_dialog(0, reference_fleet);
+    break;
   case MELEE_EX_DIALOG_KEYTESTER: {
     keyjamming_tester();
   }
@@ -1101,8 +1141,6 @@
 
 	} while((fleetRet != FLEET_DIALOG_BACK_BUTTON) &amp;&amp; (fleetRet != -1));
 
-//	reference_fleet = old_reference_fleet;
-
 	fleet-&gt;save(&quot;fleets.ini&quot;, tmp);
 	delete fleet;
 	showTitle();
@@ -1258,133 +1296,102 @@
 /*
  *** SHIPVIEW dialog section - begin
  */
-void ship_view_dialog(int si, Fleet *fleet) {
-	int i;
-	int r = 0;               // result of tw_do_dialog
-	const char *sname;
-	char textFile[MAX_SHIP_TEXT_FILE_SIZE] = &quot;&quot;; // ship description contents
-	BITMAP *sprite = NULL;
+void ship_view_dialog(int si, Fleet *fleet) 
+{
+  int i;
+  int r = 0;               // result of tw_do_dialog
+  const char *sname;
+  char textFile[MAX_SHIP_TEXT_FILE_SIZE] = &quot;&quot;; // ship description contents
+  BITMAP *sprite = NULL;
 
-	showLoadingScreen();
+  showLoadingScreen();
 
-	ASSERT(fleet);
+  ASSERT(fleet);
 
-	shipviewDialog[SHIPVIEW_DIALOG_LIST].d1 = si;
-	shipviewDialog[SHIPVIEW_DIALOG_LIST].dp3 = fleet;
-	shipviewDialog[SHIPVIEW_DIALOG_TXTFILE].dp = (char*)&quot;&quot;;
-	shipviewDialog[SHIPVIEW_DIALOG_DESCRIPTION].dp = (char*)&quot;&quot;;//this is set later 
+  shipviewDialog[SHIPVIEW_DIALOG_LIST].d1 = si;
+  shipviewDialog[SHIPVIEW_DIALOG_LIST].dp3 = fleet;
+  shipviewDialog[SHIPVIEW_DIALOG_TXTFILE].dp = (char*)&quot;&quot;;
+  shipviewDialog[SHIPVIEW_DIALOG_DESCRIPTION].dp = (char*)&quot;&quot;;//this is set later 
+  
+  // main dialog loop - begin
+  while ((r &gt;= 0) &amp;&amp; (r != SHIPVIEW_DIALOG_DONE)) 
+    {
+    
+      // update ship selection - begin
+      if ((r == 0) || (r == SHIPVIEW_DIALOG_LIST)) 
+	{
+	  si = shipviewDialog[SHIPVIEW_DIALOG_LIST].d1;
+	  sname = shipListboxGetter(si, NULL);
+	  if (!sname) 
+	    {
+	      sprintf(dialog_string[0], &quot;(Null)&quot;);
+	      sprintf(dialog_string[1], &quot;(Null)&quot;);
+	    }
+	  else 
+	    {
+	      ShipType *type = fleet-&gt;getShipType(si);
 
-	// main dialog loop - begin
-	while ((r &gt;= 0) &amp;&amp; (r != SHIPVIEW_DIALOG_DONE)) {
-
-		// update ship selection - begin
-		if ((r == 0) || (r == SHIPVIEW_DIALOG_LIST)) {
-			si = shipviewDialog[SHIPVIEW_DIALOG_LIST].d1;
-			sname = shipListboxGetter(si, NULL);
-			if (!sname) {
-				sprintf(dialog_string[0], &quot;(Null)&quot;);
-				sprintf(dialog_string[1], &quot;(Null)&quot;);
-			}
-			else {
-                
-				ShipType *type = fleet-&gt;getShipType(si);
-				
-				//DATAFILE *d;
-
-                if (sprite)
-					destroy_bitmap(sprite);
-				sprite = NULL;
-				type-&gt;data-&gt;lock();
-				if (type-&gt;data-&gt;spriteShip) {
-					sprite = create_bitmap(180, 180);
-					clear_to_color(sprite, 0);
-					type-&gt;data-&gt;spriteShip-&gt;draw( 
-						Vector2(90,90) - type-&gt;data-&gt;spriteShip-&gt;size()/2, 
-						type-&gt;data-&gt;spriteShip-&gt;size(), 
-						0, sprite 
-					);
-				}
-				type-&gt;data-&gt;unlock();
-                
-
-//				d = load_datafile_object(type-&gt;data-&gt;file, &quot;SHIP_P00_PCX&quot;);
-
-				/*
-				if (!d) d = load_datafile_object(blah, &quot;SHIP_S00_BMP&quot;);
-				if (!d) d = load_datafile_object(blah, &quot;SHIP_S01_PCX&quot;);
-				if (!d) d = load_datafile_object(blah, &quot;SHIP_S01_BMP&quot;);
-				*/
-				//if (!d) error (&quot; viewships failed to load ship picture&quot;);
-/*
-				switch (d-&gt;type) {
-					case DAT_RLE_SPRITE: {
-						RLE_SPRITE *rle = (RLE_SPRITE*)(d-&gt;dat);
-						sprite = create_bitmap_ex(rle-&gt;color_depth, 180, 180);
-						clear_to_color(sprite, 0);
-						draw_rle_sprite(sprite, rle, 90-rle-&gt;w/2, 90-rle-&gt;h/2);
-						if (rle-&gt;color_depth != bitmap_color_depth(screen)) {
-							BITMAP *tmp = create_bitmap(180, 180);
-							convert_bitmap(sprite, tmp, 0);
-							destroy_bitmap(sprite);
-							sprite = tmp;
-						}
-					}
-					break;
-					case DAT_BITMAP: {
-						sprite = create_bitmap_ex(bitmap_color_depth(screen), 64, 100);
-						blit((BITMAP*)(d-&gt;dat), sprite, 0, 0, 0, 0, 64, 100);
-					}
-					break;
-				}
-				if (d)
-					unload_datafile_object(d);
-*/
-				// read ship text file contents
-				shipviewDialog[SHIPVIEW_DIALOG_TXTFILE].dp = (char*)textFile;
-				
-				{
-					PACKFILE * f = pack_fopen(type-&gt;text, F_READ);
-					if (!f) {
-						sprintf(textFile, &quot;Failed to load file \&quot;%s\&quot;&quot;, type-&gt;text);
-					}
-					else {
-						unsigned long textFileSize = file_size(type-&gt;text);
-						if (textFileSize &gt; MAX_SHIP_TEXT_FILE_SIZE)
-							textFileSize = MAX_SHIP_TEXT_FILE_SIZE;
-						i = pack_fread(textFile, textFileSize, f);
-						pack_fclose(f);
-						textFile[i] = '\0';
-					}
-                }
-
-				// read ship ini file contents
-				char * inifile = &quot;&quot;;     // ship ini file contents
-				{
-					PACKFILE * f = pack_fopen(type-&gt;file, F_READ);
-					if (!f) {
-						inifile = (char*) malloc(strlen(&quot;Failed to load file \&quot;\&quot;&quot;) + strlen(type-&gt;file) + 1);
-						sprintf(inifile, &quot;Failed to load file \&quot;%s\&quot;&quot;, type-&gt;file);
-					}
-					else {
-						unsigned long iniFileSize = file_size(type-&gt;file);
-						inifile = (char*) malloc(iniFileSize +1 );
-						i = pack_fread(inifile, iniFileSize, f);
-						pack_fclose(f);
-						inifile[i] = '\0';
-					}
-				}
-
-				// display ship description contents
-				char *c = (char*)malloc( strlen(&quot;Name: \n&quot;) + strlen(type-&gt;name) +
-					strlen(&quot;ID: \n&quot;)+strlen(type-&gt;id) +
-					strlen(&quot;Cost: \n&quot;)+3+
-					strlen(&quot;\n\n\n\nINI file: ()\n&quot;)+strlen(type-&gt;file) +
-					strlen(&quot;-------------------------\n&quot;)+strlen(inifile) );
-				char * description = c;
-				
-				c += sprintf(c, &quot;Name: %s\n&quot;, type-&gt;name);
-				c += sprintf(c, &quot;ID: %s\n&quot;, type-&gt;id);
-				c += sprintf(c, &quot;Cost: %d\n&quot;, type-&gt;cost);
+	      if (sprite)
+		destroy_bitmap(sprite);
+	      sprite = NULL;
+	      type-&gt;data-&gt;lock();
+	      if (type-&gt;data-&gt;spriteShip) 
+		{
+		  sprite = create_bitmap(180, 180);
+		  clear_to_color(sprite, 0);
+		  type-&gt;data-&gt;spriteShip-&gt;draw( 
+					       Vector2(90,90) - type-&gt;data-&gt;spriteShip-&gt;size()/2, 
+					       type-&gt;data-&gt;spriteShip-&gt;size(), 
+					       0, sprite 
+					       );
+		}
+	      type-&gt;data-&gt;unlock();
+	      
+	      // read ship text file contents
+	      shipviewDialog[SHIPVIEW_DIALOG_TXTFILE].dp = (char*)textFile;
+	      {
+		PACKFILE * f = pack_fopen(type-&gt;text, F_READ);
+		if (!f) {
+		  sprintf(textFile, &quot;Failed to load file \&quot;%s\&quot;&quot;, type-&gt;text);
+		}
+		else {
+		  unsigned long textFileSize = file_size(type-&gt;text);
+		  if (textFileSize &gt; MAX_SHIP_TEXT_FILE_SIZE)
+		    textFileSize = MAX_SHIP_TEXT_FILE_SIZE;
+		  i = pack_fread(textFile, textFileSize, f);
+		  pack_fclose(f);
+		  textFile[i] = '\0';
+		}
+	      }
+	      
+	      // read ship ini file contents
+	      char * inifile = &quot;&quot;;     // ship ini file contents
+	      {
+		PACKFILE * f = pack_fopen(type-&gt;file, F_READ);
+		if (!f) {
+		  inifile = (char*) malloc(strlen(&quot;Failed to load file \&quot;\&quot;&quot;) + strlen(type-&gt;file) + 1);
+		  sprintf(inifile, &quot;Failed to load file \&quot;%s\&quot;&quot;, type-&gt;file);
+		}
+		else {
+		  unsigned long iniFileSize = file_size(type-&gt;file);
+		  inifile = (char*) malloc(iniFileSize +1 );
+		  i = pack_fread(inifile, iniFileSize, f);
+		  pack_fclose(f);
+		  inifile[i] = '\0';
+		}
+	      }
+	      
+	      // display ship description contents
+	      char *c = (char*)malloc( strlen(&quot;Name: \n&quot;) + strlen(type-&gt;name) +
+				       strlen(&quot;ID: \n&quot;)+strlen(type-&gt;id) +
+				       strlen(&quot;Cost: \n&quot;)+3+
+				       strlen(&quot;\n\n\n\nINI file: ()\n&quot;)+strlen(type-&gt;file) +
+				       strlen(&quot;-------------------------\n&quot;)+strlen(inifile) );
+	      char * description = c;
+	      
+	      c += sprintf(c, &quot;Name: %s\n&quot;, type-&gt;name);
+	      c += sprintf(c, &quot;ID: %s\n&quot;, type-&gt;id);
+	      c += sprintf(c, &quot;Cost: %d\n&quot;, type-&gt;cost);
 				c += sprintf(c, &quot;\n\n\n\nINI file: (%s)\n&quot;, type-&gt;file);
 				c += sprintf(c, &quot;-------------------------\n%s&quot;, inifile);
 				
@@ -1422,7 +1429,8 @@
 		shipviewDialog[SHIPVIEW_DIALOG_DESCRIPTION].dp = NULL;
 		free(shipviewDialog[SHIPVIEW_DIALOG_DESCRIPTION].dp);
 	}
-
+	
+	videosystem-&gt;redraw();
 	return;
 }
 
@@ -1459,45 +1467,34 @@
 }
 
 // DIAGNOSTICS - dialog function
-void show_diagnostics() {STACKTRACE
-	int i;
-	char buffy [16000];//fix sometime
-	char buffy2[100000];//fix sometime
-	char buffy3[16000];//yeah right
-	char *tmp;
-	PACKFILE *f;
-
-	f = pack_fopen (data_full_path(&quot;version.txt&quot;).c_str(), F_READ);
-	if (!f)
-		strcpy(buffy, &quot;Failed to load version.txt&quot;);
-	else {
-		i = pack_fread (buffy, 99999, f);
-		pack_fclose(f);
-		buffy[i] = 0;
-	}
-
-	diagnostics_dialog[DIAGNOSTICS_DIALOG_VERSION_TXT].dp = (void *) buffy;
-	diagnostics_dialog[DIAGNOSTICS_DIALOG_FILES].dp = (void *) buffy2;
-	tmp = buffy2;
-
-
-	for (i = 0; i &lt; num_registered_files; i += 1) {
-		tmp += sprintf(tmp, &quot;%s %s %s\n&quot;, registered_files[i].ftime, registered_files[i].fdate, registered_files[i].fname);
-	}
-	diagnostics_dialog[DIAGNOSTICS_DIALOG_MAIN].dp = (void *) buffy3;
-	tmp = buffy3;
-	tmp += get_diagnostics_string( tmp );
-
-/*	diagnostics_dialog[DIAGNOSTICS_DIALOG_SHIPS].dp = (void *) buffy4;
-	tmp = buffy4;
-	sprintf(tmp, &quot;Ships datafiles missing: &quot;);
-	int j = 0;
-	for (i = 0; i &lt; num_shiptypes; i += 1) {
-		if (
-	}*/
-
-	tw_popup_dialog(NULL, diagnostics_dialog, 1);
-	return;
+void show_diagnostics() 
+{
+  int i;
+  char buffy [16000];//fix sometime
+  char buffy2[100000];//fix sometime
+  char buffy3[16000];//yeah right
+  char *tmp;
+  PACKFILE *f;
+  
+  f = pack_fopen (data_full_path(&quot;version.txt&quot;).c_str(), F_READ);
+  if (!f)
+    strcpy(buffy, &quot;Failed to load version.txt&quot;);
+  else {
+    i = pack_fread (buffy, 99999, f);
+    pack_fclose(f);
+    buffy[i] = 0;
+  }
+  
+  diagnostics_dialog[DIAGNOSTICS_DIALOG_VERSION_TXT].dp = (void *) buffy;
+  diagnostics_dialog[DIAGNOSTICS_DIALOG_FILES].dp = (void *) buffy2;
+  tmp = buffy2;
+  
+  diagnostics_dialog[DIAGNOSTICS_DIALOG_MAIN].dp = (void *) buffy3;
+  tmp = buffy3;
+  tmp += get_diagnostics_string( tmp );
+    
+  tw_popup_dialog(NULL, diagnostics_dialog, 1);
+  return;
 }
 
 
@@ -1506,49 +1503,53 @@
  */
 
 
-void keyjamming_tester() {STACKTRACE
-	int i, j = 0;
-	char blah[256];
-
-	scare_mouse();
-	videosystem.window.lock();
-	clear_to_color(videosystem.window.surface, 0);
-	textprintf(screen, font, 40, 20, palette_color[15], &quot;Press the keys combinations you wish to test&quot;);
-	textprintf(screen, font, 40, 40, palette_color[15], &quot;When you're finished, press ESCAPE or F10&quot;);
-	videosystem.window.unlock();
-	unscare_mouse();
-
-	while (!key[KEY_F10] &amp;&amp; !key[KEY_ESC]) {
-		if (videosystem.poll_redraw()) {
-			scare_mouse();
-			videosystem.window.lock();
-			clear_to_color(videosystem.window.surface, 0);
-			textprintf(screen, font, 40, 20, palette_color[15], &quot;Press the keys combinations you wish to test&quot;);
-			textprintf(screen, font, 40, 40, palette_color[15], &quot;When you're finished, press ESCAPE or F10&quot;);
-			videosystem.window.unlock();
-			unscare_mouse();
-		}
-		rectfill(screen, 50, 60, 500, 60 + 20 * j, palette_color[0]);
-		j = 0;
-		poll_input();
-		for (i = 0; (i &lt; 32767) &amp;&amp; (j &lt; 16); i += 1) {
-			if (key_pressed(i)) {
-				key_to_description(i, blah);
-				scare_mouse();
-				acquire_screen();
-				textprintf(screen, font, 50, 60+j*20, palette_color[15], &quot;%s&quot;, blah);
-				release_screen();
-				unscare_mouse();
-				j += 1;
-			}
-		}
-		idle(20);
+void keyjamming_tester() 
+{
+  int i, j = 0;
+  char blah[256];
+  
+  scare_mouse();
+  videosystem-&gt;window.lock();
+  clear_to_color(videosystem-&gt;window.surface, 0);
+  textprintf(screen, font, 40, 20, palette_color[15], &quot;Press the keys combinations you wish to test&quot;);
+  textprintf(screen, font, 40, 40, palette_color[15], &quot;When you're finished, press ESCAPE or F10&quot;);
+  videosystem-&gt;window.unlock();
+  unscare_mouse();
+  
+  while (!key[KEY_F10] &amp;&amp; !key[KEY_ESC]) 
+    {
+      if (videosystem-&gt;poll_redraw()) 
+	{
+	  scare_mouse();
+	  videosystem-&gt;window.lock();
+	  clear_to_color(videosystem-&gt;window.surface, 0);
+	  textprintf(screen, font, 40, 20, palette_color[15], &quot;Press the keys combinations you wish to test&quot;);
+	  textprintf(screen, font, 40, 40, palette_color[15], &quot;When you're finished, press ESCAPE or F10&quot;);
+	  videosystem-&gt;window.unlock();
+	  unscare_mouse();
 	}
-	showTitle();
-	while (key[KEY_F10])
-		poll_keyboard();
-	clear_keybuf();
-	return;
+      rectfill(screen, 50, 60, 500, 60 + 20 * j, palette_color[0]);
+      j = 0;
+      poll_input();
+      for (i = 0; (i &lt; 32767) &amp;&amp; (j &lt; 16); i += 1) {
+	if (key_pressed(i)) 
+	  {
+	    key_to_description(i, blah);
+	    scare_mouse();
+	    acquire_screen();
+	    textprintf(screen, font, 50, 60+j*20, palette_color[15], &quot;%s&quot;, blah);
+	    release_screen();
+	    unscare_mouse();
+	    j += 1;
+	  }
+      }
+      idle(20);
+    }
+  showTitle();
+  while (key[KEY_F10])
+    poll_keyboard();
+  clear_keybuf();
+  return;
 }
 
 
@@ -1649,6 +1650,16 @@
   std::string home_file = home_ini_full_path(std::string(&quot;ships/&quot;) + ship_name);
   if(!exists(home_file.c_str()))
      CopyFile(filename, home_file.c_str());
+  
+  tw_set_config_file(home_file);
+  int version = get_config_int(&quot;Info&quot;, &quot;Version&quot;, -1);
+  if(version&lt;64)
+    {
+      CopyFile(filename, home_file.c_str());
+      tw_set_config_file(home_file);
+      std::string ver = GetSVNVersion();
+      set_config_string(&quot;Info&quot;, &quot;Version&quot;, ver.c_str());
+    }
 }
 
 #ifdef WIN32

Modified: branches/multiplayer-branch/source/scp.h
===================================================================
--- branches/multiplayer-branch/source/scp.h	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/scp.h	2004-09-28 19:53:03 UTC (rev 71)
@@ -18,14 +18,13 @@
 #ifndef __SCP_H__
 #define __SCP_H__
 
-class VideoWindow;
+
 #include &quot;allegro.h&quot;
 
-#include &quot;util/sounds.h&quot;
-
 //class SAMPLE;
 
 #include &lt;string&gt;
+class VideoWindow;
 
 /// \brief run tests
 bool RunTests();
@@ -34,7 +33,7 @@
 
 void change_teams();
 void edit_fleet(int player) ;
-//void change_options() ;
+
 int connect_menu(VideoWindow *window, char **address, int *port) ;
 int is_escape_pressed() ;
 void ship_view_dialog(int si = 0, class Fleet *fleet = NULL);
@@ -43,6 +42,7 @@
 int scp_fleet_dialog_bitmap_proc(int msg, DIALOG* d, int c);
 
 int d_check_proc_fleeteditor(int msg, DIALOG *d, int c);
+
 // list box getter functions
 char *playerListboxGetter(int index, int *list_size) ;
 char *controlListboxGetter(int index, int *list_size) ;

Modified: branches/multiplayer-branch/source/ship.h
===================================================================
--- branches/multiplayer-branch/source/ship.h	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ship.h	2004-09-28 19:53:03 UTC (rev 71)
@@ -18,6 +18,7 @@
 #ifndef __SHIP_H__
 #define __SHIP_H__
 
+#include &quot;util/sound.h&quot;
 #include &lt;allegro.h&gt;
 
 #include &quot;melee.h&quot;
@@ -27,5 +28,6 @@
 #include &quot;melee/mshot.h&quot;
 #include &quot;melee/manim.h&quot;
 #include &quot;id.h&quot;
+#include &quot;scp.h&quot;
 
 #endif // __SHIP_H__

Modified: branches/multiplayer-branch/source/ships/shpaktgu.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpaktgu.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ships/shpaktgu.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -15,10 +15,11 @@
 GNU General Public License for more details.
 */
 
+#include &quot;util/sound.h&quot;
 #include &quot;ship.h&quot;
 #include &quot;melee/mshot.h&quot;
-REGISTER_FILE
 #include &lt;string.h&gt;
+#include &quot;scp.h&quot;
 
 class AktunComSat : public SpaceObject {
 	int frame;
@@ -88,6 +89,7 @@
 Ship(opos, shipAngle, shipData, shipCollideFlag)
 
 {
+  STACKTRACE;
 	weaponColor  = get_config_int(&quot;Weapon&quot;, &quot;Color&quot;, 0);
 	weaponRange1  = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range1&quot;, 0));
 	weaponDamage = get_config_int(&quot;Weapon&quot;, &quot;Damage&quot;, 0);
@@ -118,6 +120,7 @@
 
 int AktunGunner::activate_weapon()
 {
+  STACKTRACE;
 	if(fire_special)
 		return(FALSE);
 
@@ -140,6 +143,7 @@
 
 int AktunGunner::activate_special()
 {
+  STACKTRACE;
 //	if ((fire_weapon) &amp;&amp; (batt &gt;= extraDrain))
 //	{
 		if (num_ComSats == max_ComSats) {
@@ -173,113 +177,131 @@
 	  ldamage, lfcount, opos, relpos, true),
 	  owner(lowner)
 {
+  STACKTRACE;
 }
 
 void AktunLaser::inflict_damage(SpaceObject *other)
 {
-	sound.stop(owner-&gt;data-&gt;sampleWeapon[0]);
-	Laser::inflict_damage(other);
-	sound.stop((SAMPLE *)(melee[1].dat));
-	sound.play(owner-&gt;data-&gt;sampleWeapon[1]);
+  STACKTRACE;
+  tw_sound-&gt;stop_sound(data_full_path(owner-&gt;data-&gt;sampleWeapon[0]));
+  Laser::inflict_damage(other);
+  tw_sound-&gt;play_sound(data_full_path(owner-&gt;data-&gt;sampleWeapon[1]));
 }
 
 AktunComSat::AktunComSat(double oangle, double orange, int odamage,
-						 int oframes, int orechargerate, int ocolor, int oarmour, Ship *oship,
-						 SpaceSprite *osprite) :
-SpaceObject(oship, 0, 0, osprite),
-ship(oship),
-lRange(orange),
-lDamage(odamage),
-lFrames(oframes),
-lRechargeRate(orechargerate),
-lRecharge(0),
-lColor(ocolor),
-armour(oarmour)
+			 int oframes, int orechargerate, int ocolor, 
+			 int oarmour, Ship *oship,
+			 SpaceSprite *osprite) :
+  SpaceObject(oship, 0, 0, osprite),
+  ship(oship),
+  lRange(orange),
+  lDamage(odamage),
+  lFrames(oframes),
+  lRechargeRate(orechargerate),
+  lRecharge(0),
+  lColor(ocolor),
+  armour(oarmour)
 {
-	layer = LAYER_SPECIAL;
-	collide_flag_anyone = ALL_LAYERS - bit(LAYER_CBODIES);
-	angle = oangle;
-	pos = ship-&gt;normal_pos();
-	if(!(ship &amp;&amp; ship-&gt;exists())) state = 0;
+  STACKTRACE;
+  layer = LAYER_SPECIAL;
+  collide_flag_anyone = ALL_LAYERS - bit(LAYER_CBODIES);
+  angle = oangle;
+  pos = ship-&gt;normal_pos();
+  if(!(ship &amp;&amp; ship-&gt;exists())) state = 0;
 }
 
 void AktunComSat::calculate() {
-	
-	if(!(ship &amp;&amp; ship-&gt;exists())) {
-		state = 0;
-		return;
+  STACKTRACE;
+  
+  if(!(ship &amp;&amp; ship-&gt;exists())) 
+    {
+      state = 0;
+      return;
+  }
+  
+  SpaceObject::calculate();
+  
+  sprite_index++;
+  if(sprite_index == 40)
+    sprite_index = 0;
+  
+  if(lRecharge &gt; 0) 
+    {
+      lRecharge -= frame_time;
+      return;
+    }
+  
+  vel *= 1 - .0005 * frame_time;
+  
+  if (magnitude_sqr(vel) &lt; 0.05 * 0.05) 
+    {
+      vel = 0;
+    }
+  
+  Query q;
+  for (q.begin(this, OBJECT_LAYERS &amp;~ bit(LAYER_CBODIES), lRange); q.currento; q.next()) 
+    {
+      if (!q.currento-&gt;isInvisible() &amp;&amp; !q.currento-&gt;sameTeam(this)) 
+	{
+	  SpaceLocation *l;
+	  l = new PointLaser(this, pallete_color[lColor], 1, lFrames, 
+			     this, q.currento, 0);
+	  game-&gt;add(l);
+	  if (l-&gt;exists()) 
+	    {
+	      tw_sound-&gt;play_sound(data_full_path(ship-&gt;data-&gt;sampleExtra[0]));
+	      lRecharge += lRechargeRate;
+	      break;
+	    }
+	  else l-&gt;state = 0;
 	}
-	
-	SpaceObject::calculate();
-
-	sprite_index++;
-	if(sprite_index == 40)
-		sprite_index = 0;
-	
-	if(lRecharge &gt; 0) {
-		lRecharge -= frame_time;
-		return;
-	}
-	
-	vel *= 1 - .0005 * frame_time;
-	
-	if (magnitude_sqr(vel) &lt; 0.05 * 0.05) {
-		vel = 0;
-	}
-	
-	Query q;
-	for (q.begin(this, OBJECT_LAYERS &amp;~ bit(LAYER_CBODIES), lRange); q.currento; q.next()) {
-		if (!q.currento-&gt;isInvisible() &amp;&amp; !q.currento-&gt;sameTeam(this)) {
-			SpaceLocation *l;
-			l = new PointLaser(this, pallete_color[lColor], 1, lFrames, 
-				this, q.currento, 0);
-			game-&gt;add(l);
-			if (l-&gt;exists()) {
-				sound.play(ship-&gt;data-&gt;sampleExtra[0]);
-				lRecharge += lRechargeRate;
-				break;
-			}
-			else l-&gt;state = 0;
-		}
-	}
-	return;
+    }
+  return;
 }
 
-int AktunComSat::canCollide(SpaceLocation *other) {
-	return SpaceObject::canCollide(other);
+int AktunComSat::canCollide(SpaceLocation *other) 
+{
+  STACKTRACE;
+  return SpaceObject::canCollide(other);
 }
 
 int AktunComSat::handle_damage(SpaceLocation* source, double normal, double direct)
 {
-	double tot;
-	tot = normal+direct;
-	if ( tot &gt; 0 ) {
-		armour -= iround(tot);
-		
-		if(armour &lt;= 0) {
-			armour = 0;
-			state = 0;
-			game-&gt;add(new Animation(this, pos,
-				meleedata.kaboomSprite, 0, KABOOM_FRAMES, 50, LAYER_EXPLOSIONS));
-			sound.stop(data-&gt;sampleExtra[0]);
-			sound.play(data-&gt;sampleExtra[0]);
-		}
+  STACKTRACE;
+  double tot;
+  tot = normal+direct;
+  if ( tot &gt; 0 ) 
+    {
+      armour -= iround(tot);
+      
+      if(armour &lt;= 0) 
+	{
+	armour = 0;
+	state = 0;
+	game-&gt;add(new Animation(this, pos,
+				game-&gt;meleedata.kaboomSprite, 0, KABOOM_FRAMES, 50, LAYER_EXPLOSIONS));
+	tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleExtra[0]));
+	tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleExtra[0]));
 	}
-	return 1;
+    }
+  return 1;
 }
 
-void AktunComSat::death() {
-	for (int i = 0; i &lt; ((AktunGunner*)ship)-&gt;num_ComSats; i++ ) {
-		if (((AktunGunner*)ship)-&gt;ComSat[i] == this) {
-			((AktunGunner*)ship)-&gt;ComSat[i] = NULL;
-			((AktunGunner*)ship)-&gt;num_ComSats -= 1;
-			memmove(&amp;((AktunGunner*)ship)-&gt;ComSat[i], &amp;((AktunGunner*)ship)-&gt;ComSat[i+1], 
-				(((AktunGunner*)ship)-&gt;num_ComSats-i) * sizeof(AktunComSat*));
-			return;
-		}
+void AktunComSat::death() 
+{
+  STACKTRACE;
+  for (int i = 0; i &lt; ((AktunGunner*)ship)-&gt;num_ComSats; i++ ) 
+    {
+      if (((AktunGunner*)ship)-&gt;ComSat[i] == this) 
+	{
+	  ((AktunGunner*)ship)-&gt;ComSat[i] = NULL;
+	  ((AktunGunner*)ship)-&gt;num_ComSats -= 1;
+	  memmove(&amp;((AktunGunner*)ship)-&gt;ComSat[i], &amp;((AktunGunner*)ship)-&gt;ComSat[i+1], 
+		  (((AktunGunner*)ship)-&gt;num_ComSats-i) * sizeof(AktunComSat*));
+	  return;
 	}
+    }
 }
 
-
-
 REGISTER_SHIP(AktunGunner)
+  

Modified: branches/multiplayer-branch/source/ships/shpalabc.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpalabc.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ships/shpalabc.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 #include &quot;util/aastr.h&quot;
 
@@ -27,964 +26,1044 @@
 class AlaryBC : public Ship
 {
 public:
-	int			death_frame, exp_frame;
-	bool		dying;
-	int			engine_phase;
-	double		weaponProximity, weaponVelocity, weaponAccel, weaponTR;
-	double		weaponArmour;
-	int			weaponLifetime;
+  int    death_frame, exp_frame;
+  bool   dying;
+  int    engine_phase;
+  double weaponProximity, weaponVelocity, weaponAccel, weaponTR;
+  double weaponArmour;
+  int    weaponLifetime;
+  
+  double warheadRange, warheadVelocity, warheadTR;
+  double warheadDamage, warheadArmour;
+  double specialDamage, specialArmour, turretArmour, specialDamThr;
+  double specialRange, specialVelocity, specialTurnRate;
+  double specialMaxShots;
+  bool   turrets_on, turrets_old;
+  int	 can_switch;
 
-	double		warheadRange, warheadVelocity, warheadTR;
-	double		warheadDamage, warheadArmour;
-	double		specialDamage, specialArmour, turretArmour, specialDamThr;
-	double		specialRange, specialVelocity, specialTurnRate;
-	double		specialMaxShots;
-	bool		turrets_on, turrets_old;
-	int			can_switch;
+  double specialRelativity;
+  int    side;
+  
+  double engines_armour;
+  int    engines_death_frame, engines_death_count;
+  int    old_shield_state;
 
-	double		specialRelativity;
-	int			side;
-	
-	double		engines_armour;
-	int			engines_death_frame, engines_death_count;
-	int			old_shield_state;
+  double extraThreshold, extraCapacity, extraRelaxation;
+  double extraDamageReduction, extraFuelSapReduction, extraSpeedLossReduction;
+  double extraDirectDamageReduction;
 
-	double		extraThreshold, extraCapacity, extraRelaxation;
-	double		extraDamageReduction, extraFuelSapReduction, extraSpeedLossReduction;
-	double		extraDirectDamageReduction;
-
-	double		absorbed_damage;//, residual_damage;
-
-	double		turn_step_128;
-
-	double		max_shield_flash_time, shield_flash_time, shield_flash_scale;
-
-	AlaryBCTurret *turret[3];
-
+  double absorbed_damage;//, residual_damage;
+  
+  double turn_step_128;
+  
+  double max_shield_flash_time, shield_flash_time, shield_flash_scale;
+  
+  AlaryBCTurret *turret[3];
+  
 public:
-	AlaryBC (Vector2 opos, double shipAngle, ShipData *shipData, unsigned int code);
+  AlaryBC (Vector2 opos, double shipAngle, ShipData *shipData, unsigned int code);
   
-	virtual void calculate();
-	virtual int  activate_weapon();
-	virtual void calculate_fire_special();
-	virtual void calculate_thrust();
-	virtual void calculate_turn_left();
-	virtual void calculate_turn_right();
-	virtual void calculate_hotspots();
-	virtual void animate(Frame *space);
-	virtual int  handle_damage(SpaceLocation* source, double normal, double direct);
-	virtual int  handle_fuel_sap(SpaceLocation *source, double normal);
-	virtual double handle_speed_loss(SpaceLocation *source, double normal);
+  virtual void calculate();
+  virtual int  activate_weapon();
+  virtual void calculate_fire_special();
+  virtual void calculate_thrust();
+  virtual void calculate_turn_left();
+  virtual void calculate_turn_right();
+  virtual void calculate_hotspots();
+  virtual void animate(Frame *space);
+  virtual int  handle_damage(SpaceLocation* source, double normal, double direct);
+  virtual int  handle_fuel_sap(SpaceLocation *source, double normal);
+  virtual double handle_speed_loss(SpaceLocation *source, double normal);
   
 };
 
 class AlaryBCTorpedo : public SpaceObject
 {
-	int			armour, lifetime, smoke_frame, inactive;
-	double		proximity, accel, maxspeed, turn_rate;
+  int    armour, lifetime, smoke_frame, inactive;
+  double proximity, accel, maxspeed, turn_rate;
 
-	int			wh_damage, wh_armour;
-	double		wh_v, wh_turn_rate, wh_range;
+  int    wh_damage, wh_armour;
+  double wh_v, wh_turn_rate, wh_range;
 
 public:
 
-	AlaryBCTorpedo(SpaceLocation *creator, double ox, double oy, double oangle, int oinactive, double oaccel, double  omaxspeed,
-		int olifetime, double oproximity, double oarmour, double otr, SpaceObject *otarget,
-		SpaceSprite *osprite,
-		double wdamage, double wrange, double warmour, double wv, double wtr);
+  AlaryBCTorpedo(SpaceLocation *creator, 
+		 double ox, double oy, double oangle, int oinactive, double oaccel, 
+		 double  omaxspeed, int olifetime, double oproximity, double oarmour, 
+		 double otr, SpaceObject *otarget,
+		 SpaceSprite *osprite,
+		 double wdamage, double wrange, double warmour, double wv, double wtr);
 
-	virtual void inflict_damage(SpaceObject *other);
-	virtual void calculate();
-	virtual int  handle_damage(SpaceLocation* source, double normal, double direct);
+  virtual void inflict_damage(SpaceObject *other);
+  virtual void calculate();
+  virtual int  handle_damage(SpaceLocation* source, double normal, double direct);
 };
 
 
 class AlaryBCWarhead : public HomingMissile
 {
-	int			smoke_frame;
+  int smoke_frame;
 public:
-	AlaryBCWarhead(SpaceLocation *creator, double ox, double oy, double oangle, double ov, double odamage,
-		double orange, double oarmour, double otrate, SpaceSprite *osprite, SpaceObject *otarget);
-	virtual void calculate();
+  AlaryBCWarhead(SpaceLocation *creator, double ox, double oy, 
+		 double oangle, double ov, double odamage,
+		 double orange, double oarmour, double otrate, 
+		 SpaceSprite *osprite, SpaceObject *otarget);
+  virtual void calculate();
 };
 
-
 class AlaryBCTurret : public SpaceLocation
 {
 public:
-	AlaryBC		*ship;
-	double		min_angle, max_angle, std_angle;
-	int			recharge;
-	bool		alive;
-	int			fire_frame[2], fire_time[2];
-	double		rel_x, rel_y;
-	double		armour;
+  AlaryBC *ship;
+  double min_angle, max_angle, std_angle;
+  int	 recharge;
+  bool	 alive;
+  int	 fire_frame[2], fire_time[2];
+  double rel_x, rel_y;
+  double armour;
 
-	int			barrel;
-	int			shots_fired;
+  int barrel;
+  int shots_fired;
 
 public:
-
-	AlaryBCTurret (AlaryBC *oship, double blah_or, double oa, double oangle,
-		double omin_angle, double omax_angle, int team);
-	double get_aim(SpaceObject *tgt);
-	SpaceObject *get_target(SpaceObject *tgt);
-	virtual void calculate();
-	void sinc_it();
+  
+  AlaryBCTurret (AlaryBC *oship, double blah_or, double oa, double oangle,
+		 double omin_angle, double omax_angle, int team);
+  double get_aim(SpaceObject *tgt);
+  SpaceObject *get_target(SpaceObject *tgt);
+  virtual void calculate();
+  void sinc_it();
 };
 
 class AlaryBCTShot : public Missile
 {
 public:
-	AlaryBCTShot(double ox, double oy, double oangle, double ov, double odamage, double orange, double oarmour,
-		SpaceLocation *creator, SpaceLocation *opos, SpaceSprite *osprite, double relativity);
+  AlaryBCTShot(double ox, double oy, double oangle, double ov, double odamage, 
+	       double orange, double oarmour,
+	       SpaceLocation *creator, SpaceLocation *opos, SpaceSprite *osprite, double relativity);
 };
 
 
 AlaryBC::AlaryBC (Vector2 opos, double shipAngle, ShipData *shipData, unsigned int code) :
-        Ship(opos, shipAngle, shipData, code)
+  Ship(opos, shipAngle, shipData, code)
 {
 
-	engines_armour  = get_config_int(&quot;Ship&quot;, &quot;EnginesArmour&quot;, 99);
+  engines_armour  = get_config_int(&quot;Ship&quot;, &quot;EnginesArmour&quot;, 99);
+  
+  weaponVelocity	= scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
+  weaponAccel		= scale_acceleration(get_config_float(&quot;Weapon&quot;, &quot;Accel&quot;, 0), 0);
+  weaponTR		= scale_turning(get_config_float(&quot;Weapon&quot;, &quot;TurnRate&quot;, 0));
+  weaponLifetime	= get_config_int(&quot;Weapon&quot;, &quot;Lifetime&quot;, 0);
+  weaponArmour	        = get_config_float(&quot;Weapon&quot;, &quot;Armour&quot;, 0);
+  weaponProximity	= scale_range(get_config_float(&quot;Weapon&quot;, &quot;Proximity&quot;, 0));
+  
+  warheadRange	        = scale_range(get_config_float(&quot;Weapon&quot;, &quot;WarheadRange&quot;, 0));
+  warheadVelocity	= scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;WarheadVelocity&quot;, 0));
+  warheadDamage	        = get_config_float(&quot;Weapon&quot;, &quot;WarheadDamage&quot;, 0);
+  warheadArmour	        = get_config_float(&quot;Weapon&quot;, &quot;WarheadArmour&quot;, 0);
+  warheadTR		= scale_turning(get_config_float(&quot;Weapon&quot;, &quot;WarheadTurnRate&quot;, 0));
+  
+  specialRange          = scale_range(get_config_float(&quot;Special&quot;, &quot;Range&quot;, 0));
+  specialVelocity       = scale_velocity(get_config_float(&quot;Special&quot;, &quot;Velocity&quot;, 0));
+  specialDamage         = get_config_float(&quot;Special&quot;, &quot;Damage&quot;, 0);
+  specialArmour         = get_config_float(&quot;Special&quot;, &quot;Armour&quot;, 0);
+  specialTurnRate       = scale_turning(get_config_float(&quot;Special&quot;, &quot;TurnRate&quot;, 0));
+  
+  turrets_on = false;
+  turrets_old = !turrets_on;
+  can_switch = 0;
+  
+  turretArmour    = get_config_float(&quot;Special&quot;, &quot;TurretArmour&quot;, 0);
+  specialDamThr   = get_config_float(&quot;Special&quot;, &quot;DamageFactorReactionThreshold&quot;, 0);
+  specialMaxShots = get_config_float(&quot;Special&quot;, &quot;MaxShots&quot;, 1);
+  specialRelativity= get_config_float(&quot;Special&quot;, &quot;Relativity&quot;, 0);
+  
+  side = -1;
+  
+  extraThreshold  = get_config_float(&quot;Extra&quot;, &quot;Threshold&quot;, 0);
+  extraCapacity   = get_config_float(&quot;Extra&quot;, &quot;Capacity&quot;, 0);
+  extraRelaxation = get_config_float(&quot;Extra&quot;, &quot;Relaxation&quot;, 0) / 1000.0;
+  extraDamageReduction     = get_config_float(&quot;Extra&quot;, &quot;DamageReduction&quot;, 1);
+  extraDirectDamageReduction = get_config_float(&quot;Extra&quot;, &quot;DirectDamageReduction&quot;, 1);
+  extraFuelSapReduction    = get_config_float(&quot;Extra&quot;, &quot;FuelSapReduction&quot;, 1);
+  extraSpeedLossReduction  = get_config_float(&quot;Extra&quot;, &quot;SpeedLossReduction&quot;, 1);
+  
+  max_shield_flash_time = get_config_float(&quot;Extra&quot;, &quot;ShieldFlashTime&quot;, 1);
+  shield_flash_time = max_shield_flash_time;
+  shield_flash_scale = 0;
+  
+  absorbed_damage = 0;
+  //	residual_damage = 0;
+  old_shield_state= -1;
+  engines_death_frame = -1;
+  engines_death_count = -1;
+  
+  engine_phase = 0;
+  
+  death_frame = 3500 + tw_random()%2000;
+  exp_frame = 0;
+  dying = false;
+  
+  int i;
+  for (i=0; i&lt;3; i++) {
+    turret[i] =  new AlaryBCTurret(this, 70.7, PI2/3*i, PI2/3*i, PI2/3*i-PI/2, PI2/3*i+PI/2, ally_flag);
+    game-&gt;add(turret[i]);
+  }
 
-	weaponVelocity	= scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
-	weaponAccel		= scale_acceleration(get_config_float(&quot;Weapon&quot;, &quot;Accel&quot;, 0), 0);
-	weaponTR		= scale_turning(get_config_float(&quot;Weapon&quot;, &quot;TurnRate&quot;, 0));
-	weaponLifetime	= get_config_int(&quot;Weapon&quot;, &quot;Lifetime&quot;, 0);
-	weaponArmour	= get_config_float(&quot;Weapon&quot;, &quot;Armour&quot;, 0);
-	weaponProximity	= scale_range(get_config_float(&quot;Weapon&quot;, &quot;Proximity&quot;, 0));
-
-	warheadRange	= scale_range(get_config_float(&quot;Weapon&quot;, &quot;WarheadRange&quot;, 0));
-	warheadVelocity	= scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;WarheadVelocity&quot;, 0));
-	warheadDamage	= get_config_float(&quot;Weapon&quot;, &quot;WarheadDamage&quot;, 0);
-	warheadArmour	= get_config_float(&quot;Weapon&quot;, &quot;WarheadArmour&quot;, 0);
-	warheadTR		= scale_turning(get_config_float(&quot;Weapon&quot;, &quot;WarheadTurnRate&quot;, 0));
-	
-	specialRange    = scale_range(get_config_float(&quot;Special&quot;, &quot;Range&quot;, 0));
-    specialVelocity = scale_velocity(get_config_float(&quot;Special&quot;, &quot;Velocity&quot;, 0));
-	specialDamage   = get_config_float(&quot;Special&quot;, &quot;Damage&quot;, 0);
-	specialArmour   = get_config_float(&quot;Special&quot;, &quot;Armour&quot;, 0);
-	specialTurnRate = scale_turning(get_config_float(&quot;Special&quot;, &quot;TurnRate&quot;, 0));
-
-	turrets_on = false;
-	turrets_old = !turrets_on;
-	can_switch = 0;
-
-    turretArmour    = get_config_float(&quot;Special&quot;, &quot;TurretArmour&quot;, 0);
-	specialDamThr   = get_config_float(&quot;Special&quot;, &quot;DamageFactorReactionThreshold&quot;, 0);
-	specialMaxShots = get_config_float(&quot;Special&quot;, &quot;MaxShots&quot;, 1);
-	specialRelativity= get_config_float(&quot;Special&quot;, &quot;Relativity&quot;, 0);
-
-	side = -1;
-
-	extraThreshold  = get_config_float(&quot;Extra&quot;, &quot;Threshold&quot;, 0);
-	extraCapacity   = get_config_float(&quot;Extra&quot;, &quot;Capacity&quot;, 0);
-	extraRelaxation = get_config_float(&quot;Extra&quot;, &quot;Relaxation&quot;, 0) / 1000.0;
-	extraDamageReduction     = get_config_float(&quot;Extra&quot;, &quot;DamageReduction&quot;, 1);extraDirectDamageReduction = get_config_float(&quot;Extra&quot;, &quot;DirectDamageReduction&quot;, 1);
-	extraFuelSapReduction    = get_config_float(&quot;Extra&quot;, &quot;FuelSapReduction&quot;, 1);
-    extraSpeedLossReduction  = get_config_float(&quot;Extra&quot;, &quot;SpeedLossReduction&quot;, 1);
-
-	max_shield_flash_time = get_config_float(&quot;Extra&quot;, &quot;ShieldFlashTime&quot;, 1);
-	shield_flash_scale = 0;
-
-	absorbed_damage = 0;
-//	residual_damage = 0;
-	old_shield_state= -1;
-	engines_death_frame = -1;
-	engines_death_count = -1;
-
-	engine_phase = 0;
-
-	death_frame = 3500 + tw_random()%2000;
-	exp_frame = 0;
-	dying = false;
-
-	int i;
-	for (i=0; i&lt;3; i++) {
-		turret[i] =  new AlaryBCTurret(this, 70.7, PI2/3*i, PI2/3*i, PI2/3*i-PI/2, PI2/3*i+PI/2, ally_flag);
-		game-&gt;add(turret[i]);
-	}
-
-	turn_step_128 = 0;
-
-	sprite_index = iround(angle / (PI2/128)) + 32;
-	sprite_index &amp;= 127;
-
+  turn_step_128 = 0;
+  
+  sprite_index = iround(angle / (PI2/128)) + 32;
+  sprite_index &amp;= 127;
+  
 }
 
 void AlaryBC::calculate()
 {
-	STACKTRACE
-	update_panel = true;
+  STACKTRACE;
+  update_panel = true;
 
-	if (crew &lt;= 0) {
-		death_frame -= frame_time;
-		if (death_frame &lt;= 0) handle_damage(this,777,888);
-		turn_step_128 += turn_rate * frame_time;
-		
-		double aaa, rrr;
-		exp_frame -= frame_time;
-		while (exp_frame &lt;= 0) {
-			exp_frame += 90+tw_random()%300;
-			aaa = PI2 * ((tw_random()%1001)/1000.0);
-			rrr = 66*sqrt((tw_random()%1001)/1000.0);
-			if (tw_random()%2 == 0) {
-				SpaceLocation *ani = new Animation(this, pos+rrr*unit_vector(aaa), data-&gt;spriteSpecialExplosion, 0, 10, 50, DEPTH_EXPLOSIONS);
-				game-&gt;add(ani); }
-//				ani-&gt;play_sound((SAMPLE *)(melee[MELEE_BOOM + 1].dat));}
-			else {
-				SpaceLocation *ani = new Animation(this, pos+rrr*unit_vector(aaa), data-&gt;spriteExtraExplosion, 0, 10, 50, DEPTH_EXPLOSIONS);
-				game-&gt;add(ani);
-				ani-&gt;play_sound(data-&gt;sampleWeapon[2]); }
-//				ani-&gt;play_sound((SAMPLE *)(melee[MELEE_BOOM + 3].dat)); }
-		}
+  if (crew &lt;= 0) 
+    {
+      death_frame -= frame_time;
+      if (death_frame &lt;= 0) handle_damage(this,777,888);
+      turn_step_128 += turn_rate * frame_time;
+      
+      double aaa, rrr;
+      exp_frame -= frame_time;
+      while (exp_frame &lt;= 0) 
+	{
+	  exp_frame += 90+tw_random()%300;
+	  aaa = PI2 * ((tw_random()%1001)/1000.0);
+	  rrr = 66*sqrt((tw_random()%1001)/1000.0);
+	  if (tw_random()%2 == 0) 
+	    {
+	      SpaceLocation *ani = new Animation(this, pos+rrr*unit_vector(aaa), 
+						 data-&gt;spriteSpecialExplosion, 0, 10, 50, 
+						 DEPTH_EXPLOSIONS);
+	      game-&gt;add(ani); 
+	    }
+	else 
+	  {
+	    SpaceLocation *ani = new Animation(this, pos+rrr*unit_vector(aaa), 
+					       data-&gt;spriteExtraExplosion, 0, 10, 50, DEPTH_EXPLOSIONS);
+	    game-&gt;add(ani);
+	    tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleWeapon[2])); 
+	  }
+	  tw_sound-&gt;play_sound(data_full_path(MELEE_BOOM_SOUND4)); 
 	}
-
-
-	if (!fire_special)
-		can_switch = true;
-
-	turn_step_128 += turn_step;
-	turn_step = 0;
-
-    Ship::calculate();
-
-	while(fabs(turn_step_128) &gt; (PI2/64) / 4) {
-		if(turn_step_128 &lt; 0.0) {
-			angle -= (PI2/128);
-			turn_step_128 += (PI2/128); }
-		else
-			if(turn_step_128 &gt; 0.0) {
-				angle += (PI2/128);
-				turn_step_128 -= (PI2/128); }
-		if(angle &lt; 0.0)
-			angle += PI2;
-		if(angle &gt;= PI2)
-			angle -= PI2;
+    }
+  
+  
+  if (!fire_special)
+    can_switch = true;
+  
+  turn_step_128 += turn_step;
+  turn_step = 0;
+  
+  Ship::calculate();
+  
+  while(fabs(turn_step_128) &gt; (PI2/64) / 4) 
+    {
+      if(turn_step_128 &lt; 0.0) 
+	{
+	  angle -= (PI2/128);
+	  turn_step_128 += (PI2/128); 
 	}
+      else
+	if(turn_step_128 &gt; 0.0) 
+	  {
+	    angle += (PI2/128);
+	    turn_step_128 -= (PI2/128); 
+	  }
+      if(angle &lt; 0.0)
+	angle += PI2;
+      if(angle &gt;= PI2)
+	angle -= PI2;
+    }
+  
+  sprite_index = iround(angle / (PI2/128)) + 32;
+  sprite_index &amp;= 127;
+  
+  int i;
+  for (i=0; i&lt;3; i++)
+    turret[i]-&gt;sinc_it();
 
-	sprite_index = iround(angle / (PI2/128)) + 32;
-	sprite_index &amp;= 127;
-
-	int i;
-	for (i=0; i&lt;3; i++)
-		turret[i]-&gt;sinc_it();
-
-
-	if (engines_death_frame &gt; 0) {
-		if (engines_death_count &gt; 0) engines_death_count -= frame_time;
-		else {
-			engines_death_count += 100 +random()%200;
-			engines_death_frame--;
-			double tx = cos(angle), ty = sin(angle);
-			double rrr= 42 - (random() % 85);
-			double xx = ( -54*tx - rrr*ty);
-			double yy = ( -54*ty + rrr*tx);
-			game-&gt;add(new Animation(this, pos + Vector2(xx,yy), data-&gt;spriteSpecialExplosion, 0, 10, 50, DEPTH_SHIPS-0.25));
-		}
+  
+  if (engines_death_frame &gt; 0) 
+    {
+      if (engines_death_count &gt; 0) engines_death_count -= frame_time;
+      else 
+	{
+	  engines_death_count += 100 +random()%200;
+	  engines_death_frame--;
+	  double tx = cos(angle), ty = sin(angle);
+	  double rrr= 42 - (random() % 85);
+	  double xx = ( -54*tx - rrr*ty);
+	  double yy = ( -54*ty + rrr*tx);
+	  game-&gt;add(new Animation(this, pos + Vector2(xx,yy), data-&gt;spriteSpecialExplosion, 0, 10, 50, DEPTH_SHIPS-0.25));
 	}
+    }
 
-	int aaa = (int)floor(3.999 * absorbed_damage / extraCapacity);
-
-	if ((aaa != old_shield_state) || (turrets_on != turrets_old)) {
-		int i;
-		for (i=6; i&gt;0; i--)
-			spritePanel-&gt;overlay(1, 7+aaa+(turrets_on?4:0), spritePanel-&gt;get_bitmap(i));
-		update_panel = true;
-		old_shield_state = aaa; 
-		turrets_old = turrets_on;
-	}
-
-	absorbed_damage -= extraRelaxation * frame_time;
-	if (absorbed_damage &lt; 0) absorbed_damage = 0;
-
-	shield_flash_time -= frame_time * 1E-3;
-	if (shield_flash_time &lt; 0)
-		shield_flash_time = 0;
+  int aaa = (int)floor(3.999 * absorbed_damage / extraCapacity);
+  
+  if ((aaa != old_shield_state) || (turrets_on != turrets_old)) {
+    int i;
+    for (i=6; i&gt;0; i--)
+      spritePanel-&gt;overlay(1, 7+aaa+(turrets_on?4:0), spritePanel-&gt;get_bitmap(i));
+    update_panel = true;
+    old_shield_state = aaa; 
+    turrets_old = turrets_on;
+  }
+  
+  absorbed_damage -= extraRelaxation * frame_time;
+  if (absorbed_damage &lt; 0) absorbed_damage = 0;
+  
+  shield_flash_time -= frame_time * 1E-3;
+  if (shield_flash_time &lt; 0)
+    shield_flash_time = 0;
 };
 
 int AlaryBC::activate_weapon()
 {
-	STACKTRACE
-	if (crew &lt;= 0) return false;
-
-	game-&gt;add(new AlaryBCTorpedo(this, 30*side, 0, angle, 350/*oinactive*/, weaponAccel, weaponVelocity,
-		weaponLifetime, weaponProximity, weaponArmour, weaponTR, target,
-		data-&gt;spriteWeapon, warheadDamage,  warheadRange, warheadArmour, warheadVelocity, warheadTR));
-
-	side *= -1;
-	return true;
+  STACKTRACE;
+  if (crew &lt;= 0) return false;
+  
+  game-&gt;add(new AlaryBCTorpedo(this, 30*side, 0, angle, 
+			       350/*oinactive*/, weaponAccel, weaponVelocity,
+			       weaponLifetime, weaponProximity, weaponArmour, 
+			       weaponTR, target,
+			       data-&gt;spriteWeapon, warheadDamage,  warheadRange, 
+			       warheadArmour, warheadVelocity, warheadTR));
+  
+  side *= -1;
+  return true;
 }
 
 void AlaryBC::calculate_fire_special()
 {
-	STACKTRACE
-	if (crew &lt;= 0) return;
-
-	if (fire_special &amp;&amp; can_switch) {
-		can_switch = false;
-		turrets_on = !turrets_on; }
-
+  STACKTRACE;
+  if (crew &lt;= 0) return;
+  
+  if (fire_special &amp;&amp; can_switch) 
+    {
+      can_switch = false;
+      turrets_on = !turrets_on; 
+    }
+  
 }
 
 void AlaryBC::calculate_thrust()
 {
-	STACKTRACE
-	if (crew &lt;= 0) return;
-    Ship::calculate_thrust();
+  STACKTRACE;
+  if (crew &lt;= 0) 
+    return;
+  Ship::calculate_thrust();
 }
 
 void AlaryBC::calculate_turn_left()
 {
-	STACKTRACE
-	if (crew &lt;= 0) return;
-	if ((turn_left)&amp;&amp;(!turn_right))
-		turn_step_128 -= turn_rate * frame_time;
+  STACKTRACE;
+  if (crew &lt;= 0) 
+    return;
+  if ((turn_left)&amp;&amp;(!turn_right))
+    turn_step_128 -= turn_rate * frame_time;
 }
 
 void AlaryBC::calculate_turn_right()
 {
-	STACKTRACE
-	if (crew &lt;= 0) return;
-	if ((turn_right)&amp;&amp;(!turn_left))
-		turn_step_128 += turn_rate * frame_time;
+  STACKTRACE;
+  if (crew &lt;= 0) 
+    return;
+  if ((turn_right)&amp;&amp;(!turn_left))
+    turn_step_128 += turn_rate * frame_time;
 }
 
 void AlaryBC::calculate_hotspots()
 {
-	STACKTRACE
-	if (crew &lt;= 0) return;
-	if (engines_armour &gt; 0) return;
-	if((thrust) &amp;&amp; (hotspot_frame &lt;= 0)) {
-		game-&gt;add(new Animation(this,
-			pos - unit_vector(angle)*size.x/3.8,
-//			normal_x() - (cos(angle) * w / 3.8),
-//			normal_y() - (sin(angle) * h / 3.8),
-			meleedata.hotspotSprite, 0, HOTSPOT_FRAMES, time_ratio, LAYER_HOTSPOTS));
-		hotspot_frame += hotspot_rate; }
-	if (hotspot_frame &gt; 0) hotspot_frame -= frame_time;
+  STACKTRACE;
+  if (crew &lt;= 0) 
+    return;
+  if (engines_armour &gt; 0) 
+    return;
+  if((thrust) &amp;&amp; (hotspot_frame &lt;= 0)) 
+    {
+      game-&gt;add(new Animation(this,
+			      pos - unit_vector(angle)*size.x/3.8,
+			      game-&gt;meleedata.hotspotSprite, 0, HOTSPOT_FRAMES, time_ratio, LAYER_HOTSPOTS));
+      hotspot_frame += hotspot_rate; 
+    }
+  if (hotspot_frame &gt; 0) hotspot_frame -= frame_time;
 	return;
 }
 
 
 void AlaryBC::animate(Frame *space)
 {
-	STACKTRACE
-	if (state == 0) return;
-
-	double tx = cos(angle), ty = sin(angle);
-
-	if ((thrust)&amp;&amp;(engines_armour &gt; 0)&amp;&amp;(crew&gt;0)) {
-		engine_phase = (engine_phase + 1) % 2;
-		data-&gt;more_sprites[3]-&gt;animate(Vector2(pos.x+0.5-50*tx, pos.y+0.5-50*ty), engine_phase, space);
-		data-&gt;more_sprites[4]-&gt;animate(Vector2(pos.x+0.5-49*tx-16*ty, pos.y+0.5-49*ty+16*tx), engine_phase, space);
-		data-&gt;more_sprites[4]-&gt;animate(Vector2(pos.x+0.5-49*tx+16*ty, pos.y+0.5-49*ty-16*tx), engine_phase, space);
-		data-&gt;more_sprites[5]-&gt;animate(Vector2(pos.x+0.5-49.5*tx-28.5*ty, pos.y+0.5-49.5*ty+28.5*tx), engine_phase, space);
-		data-&gt;more_sprites[5]-&gt;animate(Vector2(pos.x+0.5-49.5*tx+28.5*ty, pos.y+0.5-49.5*ty-28.5*tx), engine_phase, space);
-		data-&gt;more_sprites[6]-&gt;animate(Vector2(pos.x+0.5-48*tx-39*ty, pos.y+0.5-48*ty+39*tx), engine_phase, space);
-		data-&gt;more_sprites[6]-&gt;animate(Vector2(pos.x+0.5-48*tx+39*ty, pos.y+0.5-48*ty-39*tx), engine_phase, space);
+  STACKTRACE;
+  if (state == 0) 
+    return;
+  
+  double tx = cos(angle), ty = sin(angle);
+  
+  if ((thrust)&amp;&amp;(engines_armour &gt; 0)&amp;&amp;(crew&gt;0)) 
+    {
+      engine_phase = (engine_phase + 1) % 2;
+      data-&gt;more_sprites[3]-&gt;animate(Vector2(pos.x+0.5-50*tx, pos.y+0.5-50*ty), engine_phase, space);
+      data-&gt;more_sprites[4]-&gt;animate(Vector2(pos.x+0.5-49*tx-16*ty, 
+					     pos.y+0.5-49*ty+16*tx), engine_phase, space);
+      data-&gt;more_sprites[4]-&gt;animate(Vector2(pos.x+0.5-49*tx+16*ty, 
+					     pos.y+0.5-49*ty-16*tx), engine_phase, space);
+      data-&gt;more_sprites[5]-&gt;animate(Vector2(pos.x+0.5-49.5*tx-28.5*ty, 
+					     pos.y+0.5-49.5*ty+28.5*tx), engine_phase, space);
+      data-&gt;more_sprites[5]-&gt;animate(Vector2(pos.x+0.5-49.5*tx+28.5*ty, 
+					     pos.y+0.5-49.5*ty-28.5*tx), engine_phase, space);
+      data-&gt;more_sprites[6]-&gt;animate(Vector2(pos.x+0.5-48*tx-39*ty, 
+					     pos.y+0.5-48*ty+39*tx), engine_phase, space);
+      data-&gt;more_sprites[6]-&gt;animate(Vector2(pos.x+0.5-48*tx+39*ty, 
+					     pos.y+0.5-48*ty-39*tx), engine_phase, space);
+    }
+  
+  if ( shield_flash_time == 0 )
+    sprite-&gt;animate(pos,sprite_index, space);
+  else
+    {
+      int col = makecol(150,0,150);
+      sprite-&gt;animate_character(pos, sprite_index, col, space);
+      
+      int _old_trans = aa_get_trans();
+      aa_set_trans ( iround(128 * shield_flash_scale * shield_flash_time / max_shield_flash_time) );
+      sprite-&gt;animate(pos,sprite_index, space);
+      aa_set_trans(_old_trans);
+    }
+  
+  int i;
+  for (i=0; i&lt;3; i++) 
+    {
+      double si, ta, ttx, tty, rx, ry;
+      rx = turret[i]-&gt;rel_x; ry = turret[i]-&gt;rel_y;
+      if (turret[i]-&gt;alive) 
+	{
+	  si = iround(normalize(angle+turret[i]-&gt;angle,PI2) / (PI2/128));
+	  ta = si * (PI2/128);
+	  ttx = cos(ta); tty = sin(ta);
+	  if (turret[i]-&gt;fire_frame[0] &lt; 4)
+	    data-&gt;more_sprites[2]-&gt;animate(Vector2(pos.x+0.5+ry*tx-rx*ty + 
+						   13*ttx+3*tty, pos.y+0.5+ry*ty+rx*tx + 13*tty-3*ttx), 
+					   turret[i]-&gt;fire_frame[0], space);
+	  if (turret[i]-&gt;fire_frame[1] &lt; 4)
+	    data-&gt;more_sprites[2]-&gt;animate(Vector2(pos.x+0.5+ry*tx-rx*ty + 13*ttx-3*tty, 
+						   pos.y+0.5+ry*ty+rx*tx + 13*tty+3*ttx), 
+					   turret[i]-&gt;fire_frame[1], space);
+	  data-&gt;more_sprites[0]-&gt;animate(Vector2(pos.x+0.5+ry*tx-rx*ty, 
+						 pos.y+0.5+ry*ty+rx*tx), 
+					 (iround(si) + 32) &amp; 127, space);
 	}
-
-	if ( shield_flash_time == 0 )
-		sprite-&gt;animate(pos,sprite_index, space);
-	else
+      else	
 	{
-		int col = makecol(150,0,150);
-		sprite-&gt;animate_character(pos, sprite_index, col, space);
-
-		int	_old_trans = aa_get_trans();
-		aa_set_trans ( iround(128 * shield_flash_scale * shield_flash_time / max_shield_flash_time) );
-		sprite-&gt;animate(pos,sprite_index, space);
-		aa_set_trans(_old_trans);
+	  data-&gt;more_sprites[1]-&gt;animate(Vector2(pos.x+0.5+ry*tx-rx*ty, 
+						 pos.y+0.5+ry*ty+rx*tx), 
+					 ((iround(normalize(angle+turret[i]-&gt;angle,PI2)/(PI2/128)) 
+					   + 32) &amp; 127), space); 
 	}
-
-	int i;
-	for (i=0; i&lt;3; i++) {
-		double si, ta, ttx, tty, rx, ry;
-		rx = turret[i]-&gt;rel_x; ry = turret[i]-&gt;rel_y;
-		if (turret[i]-&gt;alive) {
-			si = iround(normalize(angle+turret[i]-&gt;angle,PI2) / (PI2/128));
-			ta = si * (PI2/128);
-            ttx = cos(ta); tty = sin(ta);
-			if (turret[i]-&gt;fire_frame[0] &lt; 4)
-				data-&gt;more_sprites[2]-&gt;animate(Vector2(pos.x+0.5+ry*tx-rx*ty + 13*ttx+3*tty, pos.y+0.5+ry*ty+rx*tx + 13*tty-3*ttx), turret[i]-&gt;fire_frame[0], space);
-			if (turret[i]-&gt;fire_frame[1] &lt; 4)
-				data-&gt;more_sprites[2]-&gt;animate(Vector2(pos.x+0.5+ry*tx-rx*ty + 13*ttx-3*tty, pos.y+0.5+ry*ty+rx*tx + 13*tty+3*ttx), turret[i]-&gt;fire_frame[1], space);
-			data-&gt;more_sprites[0]-&gt;animate(Vector2(pos.x+0.5+ry*tx-rx*ty, pos.y+0.5+ry*ty+rx*tx), (iround(si) + 32) &amp; 127, space);
-		}
-		else	{
-			data-&gt;more_sprites[1]-&gt;animate(Vector2(pos.x+0.5+ry*tx-rx*ty, pos.y+0.5+ry*ty+rx*tx), ((iround(normalize(angle+turret[i]-&gt;angle,PI2)/(PI2/128)) + 32) &amp; 127), space); }
-	}
-
+    }
 };
 
 
 int AlaryBC::handle_damage(SpaceLocation* source, double normal, double direct)
 {
-	STACKTRACE
-	double total = 0;
+  STACKTRACE;
+  double total = 0;
+  
+  //	check for &quot;repair&quot;
 
-//	check for &quot;repair&quot;
+  if (normal &lt; 0) 
+    {
+      crew -= normal;
+      normal = 0; 
+    }
+  if (direct &lt; 0) 
+    {
+      crew -= direct;
+      direct = 0; 
+    }
+  
+  if (crew &gt; crew_max) 
+    crew = crew_max;
+  
+  if (normal+direct &lt;= 0) 
+    return 0;
+  
+  //      damage reduction
 
-	if (normal &lt; 0) {
-		crew -= normal;
-		normal = 0; }
-	if (direct &lt; 0) {
-		crew -= direct;
-		direct = 0; }
-
-	if (crew &gt; crew_max) crew = crew_max;
-
-	if (normal+direct &lt;= 0) return 0;
-	
-	/*
-	Ini settings:
-	Threshold = 4
-	Capacity = 20
-	DamageReduction = 8.0
-	DirectDamageReduction = 2.0	
-
-	Relaxation = 3.5		reduction of absorbed_damage per second.
-	*/
-//      damage reduction
-
-	if (normal &gt; extraThreshold) {
-		absorbed_damage += extraThreshold;
-		total += normal / extraDamageReduction;
-		total += (normal - extraThreshold) / extraDirectDamageReduction; }
-	else {
-		absorbed_damage += normal;
-		total += normal / extraDamageReduction; }
-
-	if (absorbed_damage &gt; extraCapacity)
+  if (normal &gt; extraThreshold) 
+    {
+      absorbed_damage += extraThreshold;
+      total += normal / extraDamageReduction;
+      total += (normal - extraThreshold) / extraDirectDamageReduction; 
+    }
+  else 
+    {
+      absorbed_damage += normal;
+      total += normal / extraDamageReduction; 
+    }
+  
+  if (absorbed_damage &gt; extraCapacity)
+    {
+      // shield &quot;fails&quot;, and the ships absorbs damage relatively normally (except the default reduction)
+      total += (absorbed_damage - extraCapacity) / extraDirectDamageReduction;
+      absorbed_damage = extraCapacity;
+    } 
+  else 
+    {
+      // give some sound for the shield if the shield absorbs its damage.
+      if (data-&gt;sampleExtra.size() &gt;= 2)
 	{
-		// shield &quot;fails&quot;, and the ships absorbs damage relatively normally (except the default reduction)
-		total += (absorbed_damage - extraCapacity) / extraDirectDamageReduction;
-		absorbed_damage = extraCapacity;
-	} else {
-		// give some sound for the shield if the shield absorbs its damage.
-		if (data-&gt;num_extra_samples &gt;= 2)
-			play_sound(data-&gt;sampleExtra[1]);
-		shield_flash_time = max_shield_flash_time;	// 1 second ?
-		// 0=shield is almost drained, 1=shield is maxed.
-		shield_flash_scale = (extraCapacity - absorbed_damage) / extraCapacity;
+	  tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleExtra[1]));
 	}
-
-//      direct_damage
-	total += direct / extraDirectDamageReduction;
-
-//      damage to deal right now
-//	int total = floor(residual_damage);
-//	residual_damage -= total;
-
-
+      shield_flash_time = max_shield_flash_time;	// 1 second ?
+      // 0=shield is almost drained, 1=shield is maxed.
+      shield_flash_scale = (extraCapacity - absorbed_damage) / extraCapacity;
+    }
+  
+  //      direct_damage
+  total += direct / extraDirectDamageReduction;
+  
+  
 //      hit zone calculation
 
-	Vector2 dp = source-&gt;normal_pos();
-	double dx = dp.x;//source-&gt;normal_x();
-	double dy = dp.y;//source-&gt;normal_y();
-	if (source-&gt;isLine()) {
-		dx += ((SpaceLine*)source)-&gt;edge_x();
-		dy += ((SpaceLine*)source)-&gt;edge_y(); }
-	dx = min_delta(dx, pos.x, map_size.x);
-	dy = min_delta(dy, pos.y, map_size.y);
+  Vector2 dp = source-&gt;normal_pos();
+  double dx = dp.x;//source-&gt;normal_x();
+  double dy = dp.y;//source-&gt;normal_y();
+  if (source-&gt;isLine()) {
+    dx += ((SpaceLine*)source)-&gt;edge_x();
+    dy += ((SpaceLine*)source)-&gt;edge_y(); }
+  dx = min_delta(dx, pos.x, map_size.x);
+  dy = min_delta(dy, pos.y, map_size.y);
 
-	double alpha = normalize(atan3(dy, dx) - angle, PI2);
+  double alpha = normalize(atan3(dy, dx) - angle, PI2);
 
-	if ((turret[0]-&gt;alive) &amp;&amp; ((alpha &gt; PI2-PI/12) || (alpha &lt; PI/12)))
-		turret[0]-&gt;armour -= total;
-	if ((turret[2]-&gt;alive) &amp;&amp; (alpha &gt; 2*PI2/3-PI/12) &amp;&amp; (alpha &lt; 2*PI2/3 + PI/12))
-		turret[2]-&gt;armour -= total;
-	if ((turret[1]-&gt;alive) &amp;&amp; (alpha &gt; PI2/3-PI/12) &amp;&amp; (alpha &lt; PI2/3+PI/12))
-		turret[1]-&gt;armour -= total;
-	if ((engines_armour &gt; 0) &amp;&amp; (alpha &gt;= PI-PI2/9) &amp;&amp; (alpha &lt;= PI+PI2/9)) {
-		engines_armour -= total;
-        if (engines_armour &lt;=0) {
-			play_sound(data-&gt;sampleExtra[0]);
-			engines_death_frame = 8;
-			engines_death_count = 500 +random()%100;
-			speed_max /= 2.0;
-			accel_rate /= 4.0;
-			turn_rate /= 3.0; } }
-
-
-	if ((source == this) &amp;&amp; (dying)) {
-//      remove turrets when dead;
-		int i;
-		for (i=0; i&lt;3; i++)
-			turret[i]-&gt;state = 0;
-		play_sound((SAMPLE *)(melee[MELEE_BOOMSHIP].dat));
-		game-&gt;add(new Animation(this, pos,
-				meleedata.kaboomSprite, 0, KABOOM_FRAMES, time_ratio, DEPTH_EXPLOSIONS, 2.0));
-		if (attributes &amp; ATTRIB_NOTIFY_ON_DEATH) game-&gt;ship_died(this, source);
-		state = 0; return 0;
+  if ((turret[0]-&gt;alive) &amp;&amp; ((alpha &gt; PI2-PI/12) || (alpha &lt; PI/12)))
+    turret[0]-&gt;armour -= total;
+  if ((turret[2]-&gt;alive) &amp;&amp; (alpha &gt; 2*PI2/3-PI/12) &amp;&amp; (alpha &lt; 2*PI2/3 + PI/12))
+    turret[2]-&gt;armour -= total;
+  if ((turret[1]-&gt;alive) &amp;&amp; (alpha &gt; PI2/3-PI/12) &amp;&amp; (alpha &lt; PI2/3+PI/12))
+    turret[1]-&gt;armour -= total;
+  if ((engines_armour &gt; 0) &amp;&amp; (alpha &gt;= PI-PI2/9) &amp;&amp; (alpha &lt;= PI+PI2/9)) 
+    {
+      engines_armour -= total;
+      if (engines_armour &lt;=0) 
+	{
+	  tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleExtra[0]));
+	  engines_death_frame = 8;
+	  engines_death_count = 500 +random()%100;
+	  speed_max /= 2.0;
+	  accel_rate /= 4.0;
+	  turn_rate /= 3.0; 
+	} 
+    }
+  
+  
+  if ((source == this) &amp;&amp; (dying)) {
+    //      remove turrets when dead;
+    int i;
+    for (i=0; i&lt;3; i++)
+      turret[i]-&gt;state = 0;
+    tw_sound-&gt;play_sound(data_full_path(MELEE_BOOMSHIP_SOUND));
+    game-&gt;add(new Animation(this, pos,
+			    game-&gt;meleedata.kaboomSprite, 0, KABOOM_FRAMES, time_ratio, DEPTH_EXPLOSIONS, 2.0));
+    if (attributes &amp; ATTRIB_NOTIFY_ON_DEATH) game-&gt;ship_died(this, source);
+    state = 0; return 0;
+  }
+  
+  crew -= total;
+  
+  if(crew &gt; crew_max) 
+    {
+      total += crew_max - crew;
+      crew = crew_max;
+    }
+  if((crew &lt;= 0)&amp;&amp;(!dying)) 
+    {
+      total += crew;
+      crew  = 0;
+      dying = true;
+      turn_rate = scale_turning(12+tw_random()%80) * (1-2*(tw_random()%2)); 
+      if (engines_armour &gt; 0) 
+	{
+	  engines_armour = 0;
+	  tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleExtra[0]));
+	  engines_death_frame = 8;
+	  engines_death_count = 500 +random()%100;
 	}
-
-	crew -= total;
-
-	if(crew &gt; crew_max) {
-		total += crew_max - crew;
-		crew = crew_max;
-	}
-    if((crew &lt;= 0)&amp;&amp;(!dying)) {
-		total += crew;
-		crew  = 0;
-		dying = true;
-//		state = 0;
-//		play_sound((SAMPLE *)(melee[MELEE_BOOMSHIP].dat));
-//		game-&gt;add(new Animation(this, x, y,
-//			game-&gt;kaboomSprite, 0, KABOOM_FRAMES, time_ratio, DEPTH_EXPLOSIONS));
-//		if (attributes &amp; ATTRIB_NOTIFY_ON_DEATH) game-&gt;ship_died(this, source);
-		turn_rate = scale_turning(12+tw_random()%80) * (1-2*(tw_random()%2)); 
-		if (engines_armour &gt; 0) {
-			engines_armour = 0;
-			play_sound(data-&gt;sampleExtra[0]);
-			engines_death_frame = 8;
-			engines_death_count = 500 +random()%100;
-		}
-	}
-
-	if (crew &lt; 0) {
-		recharge_amount = 0;
-		crew = 0; }
-
-	return iround(total);
+    }
+  
+  if (crew &lt; 0) 
+    {
+      recharge_amount = 0;
+      crew = 0; 
+    }
+  
+  return iround(total);
 }
 
 int AlaryBC::handle_fuel_sap(SpaceLocation *source, double normal)
 {
-	STACKTRACE
-	normal = (normal / extraFuelSapReduction);
-	return Ship::handle_fuel_sap(source, normal);
+  STACKTRACE;
+  normal = (normal / extraFuelSapReduction);
+  return Ship::handle_fuel_sap(source, normal);
 }
 
 double AlaryBC::handle_speed_loss(SpaceLocation *source, double normal)
 {
-	STACKTRACE
-	normal = normal / extraSpeedLossReduction;
-	return Ship::handle_speed_loss(source, normal);
+  STACKTRACE;
+  normal = normal / extraSpeedLossReduction;
+  return Ship::handle_speed_loss(source, normal);
 }
 
 
-AlaryBCTorpedo::AlaryBCTorpedo(SpaceLocation *creator, double ox, double oy, double oangle, int oinactive, double oaccel, double  omaxspeed,
-		int olifetime, double oproximity, double oarmour, double otr, SpaceObject *otarget,
-		SpaceSprite *osprite, double wdamage, double wrange, double warmour, double wv,
-		double wtr) :
-	SpaceObject(creator, 0, oangle, osprite),
-	armour(iround(oarmour)), lifetime(olifetime), inactive(oinactive),
-	proximity(oproximity), accel(oaccel),
-	maxspeed(omaxspeed), turn_rate(otr),
-	wh_damage(iround(wdamage)), wh_armour(iround(warmour)), wh_v(wv),
-	wh_turn_rate(wtr), wh_range(wrange)
+AlaryBCTorpedo::AlaryBCTorpedo(SpaceLocation *creator, double ox, double oy, double oangle, 
+			       int oinactive, double oaccel, double  omaxspeed,
+			       int olifetime, double oproximity, double oarmour, 
+			       double otr, SpaceObject *otarget,
+			       SpaceSprite *osprite, double wdamage, double wrange, 
+			       double warmour, double wv,
+			       double wtr) :
+  SpaceObject(creator, 0, oangle, osprite),
+  armour(iround(oarmour)), lifetime(olifetime), inactive(oinactive),
+  proximity(oproximity), accel(oaccel),
+  maxspeed(omaxspeed), turn_rate(otr),
+  wh_damage(iround(wdamage)), wh_armour(iround(warmour)), wh_v(wv),
+  wh_turn_rate(wtr), wh_range(wrange)
 {
-	target = otarget;
-	layer = LAYER_SHOTS;
-	set_depth(DEPTH_SHOTS);
-//	attributes |= ATTRIB_SHOT;
+  STACKTRACE;
+  target = otarget;
+  layer = LAYER_SHOTS;
+  set_depth(DEPTH_SHOTS);
 
-	pos = normalize(creator-&gt;normal_pos() + rotate(Vector2(-ox, oy), -PI/2+creator-&gt;get_angle()));
-	vel = creator-&gt;get_vel();
-
-	smoke_frame = 0;
-//        explosionSprite     = data-&gt;spriteWeaponExplosion;
-//        explosionFrameCount = 10;
-//        explosionFrameSize  = 50;
-//        explosionSample = data-&gt;sampleWeapon[1];
-
-	isblockingweapons = false;
+  pos = normalize(creator-&gt;normal_pos() + rotate(Vector2(-ox, oy), -PI/2+creator-&gt;get_angle()));
+  vel = creator-&gt;get_vel();
+  
+  smoke_frame = 0;
+  //        explosionSprite     = data-&gt;spriteWeaponExplosion;
+  //        explosionFrameCount = 10;
+  //        explosionFrameSize  = 50;
+  //        explosionSample = data-&gt;sampleWeapon[1];
+  
+  isblockingweapons = false;
 }
 
 void AlaryBCTorpedo::calculate()
 {
-	STACKTRACE
-	SpaceObject::calculate();
-	lifetime -= frame_time;
-	if (lifetime &lt; 0) {
-
-		//launch warheads or die
-		state = 0;
-		return;
-
-	}
-
-
-	if (inactive &gt; 0) inactive -= frame_time;
-
-	if (target) if ((!target-&gt;isInvisible()) &amp;&amp; (inactive &lt;=0)) {
-		double d_a = normalize(trajectory_angle(target) - angle, PI2);
-		if (d_a &gt; PI) d_a -= PI2;
-		double ta = turn_rate * frame_time;
-		if (fabs(d_a) &lt; ta) ta = fabs(d_a);
-		if (d_a &gt; 0) angle += ta;
-		else angle -= ta;
-		angle = normalize(angle, PI2);
-
-		if (distance(target) &lt; proximity) {
-			game-&gt;add(new Animation(this, pos, data-&gt;spriteWeaponExplosion, 0, 10, 50, DEPTH_EXPLOSIONS));
+  STACKTRACE;
+  SpaceObject::calculate();
+  lifetime -= frame_time;
+  if (lifetime &lt; 0) 
+    {
+      //launch warheads or die
+      state = 0;
+      return;
+  }
+  
+  if (inactive &gt; 0) inactive -= frame_time;
+  
+  if (target) if ((!target-&gt;isInvisible()) &amp;&amp; (inactive &lt;=0)) 
+    {
+      double d_a = normalize(trajectory_angle(target) - angle, PI2);
+      if (d_a &gt; PI) d_a -= PI2;
+      double ta = turn_rate * frame_time;
+      if (fabs(d_a) &lt; ta) ta = fabs(d_a);
+      if (d_a &gt; 0) angle += ta;
+      else angle -= ta;
+      angle = normalize(angle, PI2);
+      
+      if (distance(target) &lt; proximity) 
+	{
+	  game-&gt;add(new Animation(this, pos, data-&gt;spriteWeaponExplosion, 0, 10, 50, DEPTH_EXPLOSIONS));
+	  
+	  game-&gt;add(new AlaryBCWarhead(this, 0, 10, angle,
+				       wh_v, wh_damage, wh_range*(1+0.0025*(tw_random()%101)), 
+				       wh_armour, wh_turn_rate, data-&gt;spriteExtra, target));
+	  game-&gt;add(new AlaryBCWarhead(this, 0, 10, angle - 50*PI/180,
+				       wh_v, wh_damage, wh_range*(1+0.0025*(tw_random()%101)), 
+				       wh_armour, wh_turn_rate, data-&gt;spriteExtra, target));
+	  game-&gt;add(new AlaryBCWarhead(this, 0, 10, angle + 50*PI/180,
+				       wh_v, wh_damage, wh_range*(1+0.0025*(tw_random()%101)), 
+				       wh_armour, wh_turn_rate, data-&gt;spriteExtra, target));
+	  game-&gt;add(new AlaryBCWarhead(this, 0, 10, angle - 75*PI/180,
+				       wh_v, wh_damage, wh_range*(1+0.0025*(tw_random()%101)), 
+				       wh_armour, wh_turn_rate, data-&gt;spriteExtra, target));
+	  game-&gt;add(new AlaryBCWarhead(this, 0, 10, angle + 75*PI/180,
+				       wh_v, wh_damage, wh_range*(1+0.0025*(tw_random()%101)), 
+				       wh_armour, wh_turn_rate, data-&gt;spriteExtra, target));
 			
-			game-&gt;add(new AlaryBCWarhead(this, 0, 10, angle,
-				wh_v, wh_damage, wh_range*(1+0.0025*(tw_random()%101)), wh_armour, wh_turn_rate, data-&gt;spriteExtra, target));
-			game-&gt;add(new AlaryBCWarhead(this, 0, 10, angle - 50*PI/180,
-				wh_v, wh_damage, wh_range*(1+0.0025*(tw_random()%101)), wh_armour, wh_turn_rate, data-&gt;spriteExtra, target));
-			game-&gt;add(new AlaryBCWarhead(this, 0, 10, angle + 50*PI/180,
-				wh_v, wh_damage, wh_range*(1+0.0025*(tw_random()%101)), wh_armour, wh_turn_rate, data-&gt;spriteExtra, target));
-			game-&gt;add(new AlaryBCWarhead(this, 0, 10, angle - 75*PI/180,
-				wh_v, wh_damage, wh_range*(1+0.0025*(tw_random()%101)), wh_armour, wh_turn_rate, data-&gt;spriteExtra, target));
-			game-&gt;add(new AlaryBCWarhead(this, 0, 10, angle + 75*PI/180,
-				wh_v, wh_damage, wh_range*(1+0.0025*(tw_random()%101)), wh_armour, wh_turn_rate, data-&gt;spriteExtra, target));
-			
-			state = 0;
-		}
+	  state = 0;
 	}
-	else {
-		if (inactive &lt;= 0) target = NULL;
+    }
+  else 
+    {
+      if (inactive &lt;= 0) target = NULL;
+      
+      //find another target???????
+      
+    }
+  
+  sprite_index = iround(angle / (PI2/64)) + 16;
+  sprite_index &amp;= 63;
 
-		//find another target???????
-
-	}
-	
-	sprite_index = iround(angle / (PI2/64)) + 16;
-	sprite_index &amp;= 63;
-
-	accelerate(this, angle, accel*frame_time, maxspeed);
-
-	while (smoke_frame &lt;= 0) {
-		smoke_frame += 50;
-		game-&gt;add(new Animation(this, pos - 14*unit_vector(angle), data-&gt;more_sprites[7],
-			0, 12, 50, LAYER_HOTSPOTS));
-	}
-	smoke_frame -= frame_time;
-
-
-	return;
-
+  accelerate(this, angle, accel*frame_time, maxspeed);
+  
+  while (smoke_frame &lt;= 0) 
+    {
+      smoke_frame += 50;
+      game-&gt;add(new Animation(this, pos - 14*unit_vector(angle), data-&gt;more_sprites[7],
+			      0, 12, 50, LAYER_HOTSPOTS));
+    }
+  smoke_frame -= frame_time;
+  
+  return;
 }
 
 void AlaryBCTorpedo::inflict_damage(SpaceObject *other)
 {
-	STACKTRACE
-	//if (!other-&gt;isShot()) {
-	if (other-&gt;isblockingweapons)
-	{
-		game-&gt;add(new Animation(this, pos, data-&gt;spriteWeaponExplosion, 0, 10, 50, DEPTH_EXPLOSIONS));
-		state = 0; 
-		play_sound((SAMPLE *)(melee[MELEE_BOOM].dat));
-	}
+  STACKTRACE;
+  if (other-&gt;isblockingweapons)
+    {
+      game-&gt;add(new Animation(this, pos, data-&gt;spriteWeaponExplosion, 0, 10, 50, DEPTH_EXPLOSIONS));
+      state = 0; 
+      tw_sound-&gt;play_sound(data_full_path(MELEE_BOOM_SOUND1));
+    }
 };
 
 int AlaryBCTorpedo::handle_damage(SpaceLocation *source, double normal, double direct)
 {
-	STACKTRACE
-	if (direct+normal &gt; 0) armour -= iround(direct+normal);
-	if (armour &lt;= 0) {
-		game-&gt;add(new Animation(this, pos, data-&gt;spriteWeaponExplosion, 0, 10, 50, DEPTH_EXPLOSIONS));
-		state = 0; }
-	return iround(direct+normal);
+  STACKTRACE;
+  if (direct+normal &gt; 0) 
+    armour -= iround(direct+normal);
+  if (armour &lt;= 0) 
+    {
+      game-&gt;add(new Animation(this, pos, data-&gt;spriteWeaponExplosion, 0, 10, 50, DEPTH_EXPLOSIONS));
+      state = 0; 
+    }
+  return iround(direct+normal);
 }
 
 
-AlaryBCWarhead::AlaryBCWarhead(SpaceLocation *creator, double ox, double oy, double oangle, double ov, double odamage,
-		double orange, double oarmour, double otrate, SpaceSprite *osprite, SpaceObject *otarget) :
-	HomingMissile(creator, Vector2(ox,oy), oangle, ov, odamage, orange, oarmour, 
-	otrate, creator, osprite, otarget)
+AlaryBCWarhead::AlaryBCWarhead(SpaceLocation *creator, double ox, double oy, double oangle, 
+			       double ov, double odamage,
+			       double orange, double oarmour, double otrate, 
+			       SpaceSprite *osprite, SpaceObject *otarget) :
+  HomingMissile(creator, Vector2(ox,oy), oangle, ov, odamage, orange, oarmour, 
+		otrate, creator, osprite, otarget)
 {
-	explosionSprite     = data-&gt;spriteExtraExplosion;
-	explosionFrameCount = 10;
-	explosionFrameSize  = 50;
-	explosionSample = data-&gt;sampleWeapon[2];
-	smoke_frame = 0;
-	play_sound(data-&gt;sampleWeapon[1], 64);
+  STACKTRACE;
+  explosionSprite     = data-&gt;spriteExtraExplosion;
+  explosionFrameCount = 10;
+  explosionFrameSize  = 50;
+  explosionSample = data-&gt;sampleWeapon[2];
+  smoke_frame = 0;
+  tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleWeapon[1])); // was vol 64
 }
 
 
 void AlaryBCWarhead::calculate()
 {
-	STACKTRACE
-	HomingMissile::calculate();
-	
-	while (smoke_frame &lt;= 0) {
-		smoke_frame += 25;
-		game-&gt;add(new Animation(this, pos -2*unit_vector(angle), data-&gt;more_sprites[8],
-			0, 12, 50, LAYER_HOTSPOTS));
-	}
-	smoke_frame -= frame_time;
+  STACKTRACE;
+  HomingMissile::calculate();
+  
+  while (smoke_frame &lt;= 0) 
+    {
+      smoke_frame += 25;
+      game-&gt;add(new Animation(this, pos -2*unit_vector(angle), data-&gt;more_sprites[8],
+			      0, 12, 50, LAYER_HOTSPOTS));
+    }
+  smoke_frame -= frame_time;
 }
 
 
 
 void AlaryBCTurret::sinc_it()
 {
-	STACKTRACE
-//	double tx = cos(ship-&gt;angle);
-//	double ty = sin(ship-&gt;angle);
-
-//	x = ship-&gt;x + rel_y*tx - rel_x*ty;
-//	y = ship-&gt;y + rel_y*ty + rel_x*tx;
-	pos = normalize(ship-&gt;normal_pos() + rotate(Vector2(-rel_x, rel_y), -PI/2+ship-&gt;get_angle()));
-
-//	vx = ship-&gt;vx;
-//	vy = ship-&gt;vy;
-	vel = ship-&gt;get_vel();
+  STACKTRACE;
+  pos = normalize(ship-&gt;normal_pos() + rotate(Vector2(-rel_x, rel_y), -PI/2+ship-&gt;get_angle()));
+  vel = ship-&gt;get_vel();
 }
 
 AlaryBCTurret::AlaryBCTurret (AlaryBC *oship, double blah_or, double oa, double oangle,
 				double omin_angle, double omax_angle, int team) :
-	SpaceLocation(oship,0,oangle)
-//	barrel(0), ship(oship), recharce(0)
-						
+  SpaceLocation(oship,0,oangle)
 {
-	target = NULL;
-	shots_fired = 0;
-	barrel = 0;
-	ship = oship;
-	rel_x = blah_or*sin(oa);
-	rel_y = blah_or*cos(oa);
-	recharge = 0;
-	min_angle = omin_angle; max_angle = omax_angle;
-	std_angle = oangle;
-	
-	collide_flag_anyone = 0;
-	collide_flag_sameteam = 0;
-	collide_flag_sameship = 0;
+  target = NULL;
+  shots_fired = 0;
+  barrel = 0;
+  ship = oship;
+  rel_x = blah_or*sin(oa);
+  rel_y = blah_or*cos(oa);
+  recharge = 0;
+  min_angle = omin_angle; max_angle = omax_angle;
+  std_angle = oangle;
+  
+  collide_flag_anyone = 0;
+  collide_flag_sameteam = 0;
+  collide_flag_sameship = 0;
+  
+  armour = ship-&gt;turretArmour;
+  
+  collide_flag_anyone = 0;
+  collide_flag_sameship = 0;
+  collide_flag_sameteam = 0;
+  sinc_it();
 
-	armour = ship-&gt;turretArmour;
-
-	collide_flag_anyone = 0;
-	collide_flag_sameship = 0;
-	collide_flag_sameteam = 0;
-	sinc_it();
-
-	fire_frame[0] = fire_frame[1] = 10;
-
-	alive = true;
+  fire_frame[0] = fire_frame[1] = 10;
+  fire_time[0] = fire_time[1] = 0;
+  alive = true;
 }
 
 double AlaryBCTurret::get_aim(SpaceObject *tgt)
 {
-	STACKTRACE
+  STACKTRACE;
+  if (tgt == NULL)
+    return (-1);
+  
+  Vector2 tv = tgt-&gt;get_vel() - ship-&gt;specialRelativity * ship-&gt;get_vel();
+  
+  double tvx = tv.x;
+  double tvy = tv.y;
 
-	if (tgt == NULL)
-		return (-1);
-		
-	Vector2 tv = tgt-&gt;get_vel() - ship-&gt;specialRelativity * ship-&gt;get_vel();
-
-	double tvx = tv.x;//tgt-&gt;get_vx() - ship-&gt;specialRelativity * ship-&gt;vx;
-	double tvy = tv.y;//tgt-&gt;get_vy() - ship-&gt;specialRelativity * ship-&gt;vy;
-//        double tv2 = tvx*tvx + tvy*tvy;
-	tv = min_delta(tgt-&gt;normal_pos(), pos);
-	double rx  = tv.x;//min_delta(tgt-&gt;normal_x(), normal_x(), X_MAX);
-	double ry  = tv.y;//min_delta(tgt-&gt;normal_y(), normal_y(), Y_MAX);
-	double r2  = rx*rx + ry*ry;
-	double u2  = ship-&gt;specialVelocity;
-	u2 *= u2;
-	double d2v = u2 - (tvx*tvx + tvy*tvy);
-	double t = (rx*tvx + ry*tvy);
-	double q, p;
-	if (fabs(d2v/u2) &gt; 0.01 ) {
-		q = t*t + r2*d2v;
-		if (q &gt; 0) q = sqrt(q);
-		else    return (-1);
-		p = (t+q)/d2v;
-		q = (t-q)/d2v;
-		if (p &gt; 0) t = p;
-		else       t = q;
-		if (t &lt; 0) return (-1);
-	}
-	else {
-		if (fabs(t)&lt;1e-6) return (-1);
-		else    t = - 0.5 * r2 / t;
-		if (t &lt; 0) return (-1); }
-	if (t * ship-&gt;specialVelocity &gt; ship-&gt;specialRange) return(-1);
-	t = normalize((atan3(tvy*t + ry, tvx*t + rx)) - ship-&gt;angle, PI2);
-	double d_a = normalize(t - min_angle, PI2);
-	if (d_a &gt; PI) d_a -= PI2;
-	if (d_a &gt; 0) {
-		d_a = normalize(t - max_angle, PI2);
-		if (d_a &gt; PI) d_a -= PI2;
-		if (d_a &lt; 0)
-			return (t); }
-	return (-1);
+  tv = min_delta(tgt-&gt;normal_pos(), pos);
+  double rx  = tv.x;
+  double ry  = tv.y;
+  double r2  = rx*rx + ry*ry;
+  double u2  = ship-&gt;specialVelocity;
+  u2 *= u2;
+  double d2v = u2 - (tvx*tvx + tvy*tvy);
+  double t = (rx*tvx + ry*tvy);
+  double q, p;
+  if (fabs(d2v/u2) &gt; 0.01 ) 
+    {
+      q = t*t + r2*d2v;
+      if (q &gt; 0) q = sqrt(q);
+      else    return (-1);
+      p = (t+q)/d2v;
+      q = (t-q)/d2v;
+      if (p &gt; 0) t = p;
+      else       t = q;
+      if (t &lt; 0) return (-1);
+    }
+  else 
+    {
+      if (fabs(t)&lt;1e-6) return (-1);
+      else    t = - 0.5 * r2 / t;
+      if (t &lt; 0) 
+	return (-1); 
+    }
+  if (t * ship-&gt;specialVelocity &gt; ship-&gt;specialRange) 
+    return(-1);
+  t = normalize((atan3(tvy*t + ry, tvx*t + rx)) - ship-&gt;angle, PI2);
+  double d_a = normalize(t - min_angle, PI2);
+  if (d_a &gt; PI) d_a -= PI2;
+  if (d_a &gt; 0) 
+    {
+      d_a = normalize(t - max_angle, PI2);
+      if (d_a &gt; PI) d_a -= PI2;
+      if (d_a &lt; 0)
+	return (t); 
+    }
+  return (-1);
 }
 
 SpaceObject *AlaryBCTurret::get_target(SpaceObject *tgt)
 {
-	STACKTRACE
-	double d_a, prix=-1, prix_c, aim; //!!!
-	Query q;
-	SpaceObject *tgt0=tgt;
-
-	for (q.begin(this, OBJECT_LAYERS, ship-&gt;specialRange); q.currento; q.next())
-		if ((!q.currento-&gt;isInvisible()) &amp;&amp; (!q.currento-&gt;sameTeam(this))
-				&amp;&amp; (!q.currento-&gt;isPlanet())
-				&amp;&amp; (q.currento-&gt;collide_flag_anyone&amp;bit(LAYER_SHOTS))
-				&amp;&amp; (q.currento != tgt) ) {
-			aim = get_aim(q.currento);
-			if (aim &gt;= 0) {
-				d_a = normalize(aim - angle, PI2);
-				if (d_a &gt; PI) d_a -= PI2;
-				d_a = fabs(d_a);
-			
-				if (q.currento-&gt;isShip()) {
-					if (q.currento == ship-&gt;target) prix_c = 4;
-					else
-						prix_c = 3; }
-				else
-					if (q.currento-&gt;damage_factor &lt;= 0)
-						prix_c = 2;
-					else
-						if (q.currento-&gt;damage_factor &gt;= ship-&gt;specialDamThr)
-							prix_c = 1;
-						else
-							prix_c = 0;
-				prix_c -= d_a/PI;
-				if (prix_c &gt; prix) {
-					prix = prix_c;
-					tgt = q.currento; }
-			}
-		}
-	q.end();
-
-
-	if (tgt != tgt0)
-		return tgt;
-	else
-		return NULL;
-
+  STACKTRACE;
+  double d_a, prix=-1, prix_c, aim; //!!!
+  Query q;
+  SpaceObject *tgt0=tgt;
+  
+  for (q.begin(this, OBJECT_LAYERS, ship-&gt;specialRange); q.currento; q.next())
+    if ((!q.currento-&gt;isInvisible()) &amp;&amp; (!q.currento-&gt;sameTeam(this))
+	&amp;&amp; (!q.currento-&gt;isPlanet())
+	&amp;&amp; (q.currento-&gt;collide_flag_anyone&amp;bit(LAYER_SHOTS))
+	&amp;&amp; (q.currento != tgt) ) 
+      {
+	aim = get_aim(q.currento);
+	if (aim &gt;= 0) 
+	  {
+	    d_a = normalize(aim - angle, PI2);
+	    if (d_a &gt; PI) d_a -= PI2;
+	    d_a = fabs(d_a);
+	    
+	    if (q.currento-&gt;isShip()) 
+	      {
+		if (q.currento == ship-&gt;target) prix_c = 4;
+	      else
+		prix_c = 3; 
+	      }
+	    else
+	      if (q.currento-&gt;damage_factor &lt;= 0)
+		prix_c = 2;
+	      else
+		if (q.currento-&gt;damage_factor &gt;= ship-&gt;specialDamThr)
+		  prix_c = 1;
+		else
+		  prix_c = 0;
+	    prix_c -= d_a/PI;
+	    if (prix_c &gt; prix) 
+	      {
+		prix = prix_c;
+		tgt = q.currento; 
+	      }
+	  }
+      }
+  q.end();
+  
+  if (tgt != tgt0)
+    return tgt;
+  else
+    return NULL;  
 }
 
 
 
 void AlaryBCTurret::calculate()
 {
-	STACKTRACE
-	if (!(ship &amp;&amp; ship-&gt;exists()))
+  STACKTRACE;
+  if (!(ship &amp;&amp; ship-&gt;exists()))
+    {
+      ship = 0;
+      state = 0;
+      return;
+    }
+  
+  SpaceLocation::calculate();
+  
+  if (!alive) return;
+  
+  if (armour &lt;= 0) 
+    {
+      alive = false;
+      tw_sound-&gt;play_sound(data_full_path(MELEE_BOOM_SOUND2));
+      game-&gt;add(new FixedAnimation(this, this, ship-&gt;data-&gt;spriteSpecialExplosion,
+				   0, 10, 50, DEPTH_EXPLOSIONS));
+      return; 
+    }
+  
+  int i;
+  for (i=0; i&lt;2; i++) 
+    {
+      if ((fire_time[i] &gt; 0) &amp;&amp; (fire_frame[i] &lt; 4)) 
+	fire_time[i] -= frame_time;
+      else 
 	{
-		ship = 0;
-		state = 0;
-		return;
+	  fire_time[i] += turret_fire_frame_size;
+	  fire_frame[i]++; 
+	} 
+    }
+  
+  
+  double d_a, aim; //!!!
+
+  if (ship-&gt;turrets_on) 
+    {
+      if (target) 
+	{
+	  if (!target-&gt;exists()) 
+	    {
+	      shots_fired = 0;
+	      target = get_target(NULL); 
+	    }
 	}
+      else 
+	{
+	  shots_fired = 0;
+	  target = get_target(NULL); }
+      
+      aim = get_aim(target);
 
-	SpaceLocation::calculate();
-
-	if (!alive) return;
-
-	if (armour &lt;= 0) {
-		alive = false;
-		play_sound((SAMPLE *)(melee[MELEE_BOOM + 1].dat));
-//		play_sound(ship-&gt;data-&gt;sampleSpecial[1]);
-//                        game-&gt;add(new Animation(this, turret[i]-&gt;normal_x(), turret[i]-&gt;normal_y(),
-//                                          ship-&gt;data-&gt;spriteWeaponExplosion, 0, 10, 50, DEPTH_EXPLOSIONS));
-		game-&gt;add(new FixedAnimation(this, this, ship-&gt;data-&gt;spriteSpecialExplosion,
-			0, 10, 50, DEPTH_EXPLOSIONS));
-		return; }
-
-	int i;
-	for (i=0; i&lt;2; i++) {
-		if ((fire_time[i] &gt; 0) &amp;&amp; (fire_frame[i] &lt; 4)) fire_time[i] -= frame_time;
-		else {
-			fire_time[i] += turret_fire_frame_size;
-			fire_frame[i]++; } }
-
-                
-	double d_a, aim; //!!!
-
-	if (ship-&gt;turrets_on) {
-		if (target) {
-			if (!target-&gt;exists()) {
-				shots_fired = 0;
-				target = get_target(NULL); }
-/*			else {
-				if (target-&gt;isShot()) {
-					if (shots_fired &gt;= ((Shot*)target)-&gt;armour * ship-&gt;specialMaxShots / ship-&gt;specialDamage) {
-						shots_fired = 0;
-						target = get_target(NULL); } }
-				else {
-					if (target-&gt;isAsteroid()) 
-						if (shots_fired &gt;= ship-&gt;specialMaxShots) {
-							shots_fired = 0;
-							target = get_target(NULL); }
-				}
-			}
-*/		
-		}
-		else {
-			shots_fired = 0;
-			target = get_target(NULL); }
-
-		aim = get_aim(target);
-
-		if (aim &lt; 0) {
-			shots_fired = 0;
-			target = get_target(NULL); }
+      if (aim &lt; 0) 
+	{
+	  shots_fired = 0;
+	  target = get_target(NULL); 
 	}
-
-	else {
-		target = NULL;
-		shots_fired = 0;
-		aim = -1; }
-        
-
-	if (aim &gt;= 0)
-		d_a = normalize(aim - angle, PI2);
-	else
-		d_a = normalize(std_angle - angle, PI2);
-	if (d_a &gt; PI)
-		d_a -= PI2;
-	
-	double delta = ship-&gt;specialTurnRate * frame_time;
-
-	if (fabs(d_a) &lt;= delta)
-		delta = fabs(d_a);
-	if (d_a &gt; 0)
-		angle += delta;
-	else
-		angle -= delta;
-
-	if (recharge &gt; 0) recharge -= frame_time;
-	if (target &amp;&amp; (recharge &lt;= 0)) {
-		if (fabs(d_a) &lt;= (0.25 * (target-&gt;size.x+target-&gt;size.y)/2.0) / distance(target)) {
-			if (ship-&gt;batt &gt;= ship-&gt;special_drain) {
-				recharge += ship-&gt;special_rate;
-				ship-&gt;batt -= ship-&gt;special_drain;
-				play_sound(ship-&gt;data-&gt;sampleSpecial[0]);
-				shots_fired++;
-				if (barrel == 0) {
-					game-&gt;add(new AlaryBCTShot(-3, 14, normalize(angle+ship-&gt;angle, PI2), ship-&gt;specialVelocity,
-						ship-&gt;specialDamage, ship-&gt;specialRange,
-						ship-&gt;specialArmour, ship, this, ship-&gt;data-&gt;spriteSpecial, ship-&gt;specialRelativity));
-					fire_frame[0] = 0; fire_time[0] =  turret_fire_frame_size;
-					barrel = 1; }
-				else {
-					game-&gt;add(new AlaryBCTShot(3, 14, normalize(angle+ship-&gt;angle, PI2), ship-&gt;specialVelocity,
-						ship-&gt;specialDamage, ship-&gt;specialRange,
-						ship-&gt;specialArmour, ship, this, ship-&gt;data-&gt;spriteSpecial, ship-&gt;specialRelativity));
-					fire_frame[1] = 0; fire_time[1] =  turret_fire_frame_size;
-					barrel = 0; }
-			}
+    }
+  else 
+    {
+    target = NULL;
+    shots_fired = 0;
+    aim = -1; 
+  }
+  
+  
+  if (aim &gt;= 0)
+    d_a = normalize(aim - angle, PI2);
+  else
+    d_a = normalize(std_angle - angle, PI2);
+  if (d_a &gt; PI)
+    d_a -= PI2;
+  
+  double delta = ship-&gt;specialTurnRate * frame_time;
+  
+  if (fabs(d_a) &lt;= delta)
+    delta = fabs(d_a);
+  if (d_a &gt; 0)
+    angle += delta;
+  else
+    angle -= delta;
+  
+  if (recharge &gt; 0) recharge -= frame_time;
+  if (target &amp;&amp; (recharge &lt;= 0)) 
+    {
+      if (fabs(d_a) &lt;= (0.25 * (target-&gt;size.x+target-&gt;size.y)/2.0) / distance(target)) 
+	{
+	  if (ship-&gt;batt &gt;= ship-&gt;special_drain) 
+	    {
+	      recharge += ship-&gt;special_rate;
+	      ship-&gt;batt -= ship-&gt;special_drain;
+	      tw_sound-&gt;play_sound(data_full_path(ship-&gt;data-&gt;sampleSpecial[0]));
+	      shots_fired++;
+	      if (barrel == 0) 
+		{
+		  game-&gt;add(new AlaryBCTShot(-3, 14, normalize(angle+ship-&gt;angle, PI2), 
+					     ship-&gt;specialVelocity,
+					     ship-&gt;specialDamage, ship-&gt;specialRange,
+					     ship-&gt;specialArmour, ship, this, 
+					     ship-&gt;data-&gt;spriteSpecial, ship-&gt;specialRelativity));
+		  fire_frame[0] = 0; 
+		  fire_time[0] =  turret_fire_frame_size;
+		  barrel = 1; 
 		}
+	      else 
+		{
+		  game-&gt;add(new AlaryBCTShot(3, 14, normalize(angle+ship-&gt;angle, PI2), 
+					     ship-&gt;specialVelocity,
+					     ship-&gt;specialDamage, ship-&gt;specialRange,
+					     ship-&gt;specialArmour, ship, this, 
+					     ship-&gt;data-&gt;spriteSpecial, ship-&gt;specialRelativity));
+		  fire_frame[1] = 0; 
+		  fire_time[1] =  turret_fire_frame_size;
+		  barrel = 0; 
+		}
+	    }
 	}
-
+    }
+  
 }
 
-AlaryBCTShot::AlaryBCTShot(double ox, double oy, double oangle, double ov, double odamage, double orange, double oarmour,
-               SpaceLocation *creator, SpaceLocation *opos, SpaceSprite *osprite, double relativity) :
-	Missile(creator, Vector2(ox,oy), oangle, ov, odamage, orange, oarmour, 
-	creator, osprite, relativity)
-
+AlaryBCTShot::AlaryBCTShot(double ox, double oy, double oangle, 
+			   double ov, double odamage, double orange, double oarmour,
+			   SpaceLocation *creator, SpaceLocation *opos, 
+			   SpaceSprite *osprite, double relativity) :
+  Missile(creator, Vector2(ox,oy), oangle, ov, odamage, orange, oarmour, 
+	  creator, osprite, relativity)
 {
-	set_depth(DEPTH_SHIPS+0.25);
-	collide_flag_sameship = 0;
-	collide_flag_sameteam = 0;
-
-	explosionSprite     = data-&gt;spriteSpecialExplosion;
-	explosionFrameCount = 10;
-	explosionFrameSize  = 50;
-	explosionSample = data-&gt;sampleSpecial[1];
-//	double tx = cos(angle);
-//	double ty = sin(angle);
-//	x = opos-&gt;normal_x() + oy*tx - ox*ty;
-//	y = opos-&gt;normal_y() + oy*ty + ox*tx;
-	pos = normalize(opos-&gt;normal_pos() + rotate(Vector2(-ox, oy), -PI/2+angle));
+  STACKTRACE;
+  set_depth(DEPTH_SHIPS+0.25);
+  collide_flag_sameship = 0;
+  collide_flag_sameteam = 0;
+  
+  explosionSprite     = data-&gt;spriteSpecialExplosion;
+  explosionFrameCount = 10;
+  explosionFrameSize  = 50;
+  explosionSample = data-&gt;sampleSpecial[1];
+  pos = normalize(opos-&gt;normal_pos() + rotate(Vector2(-ox, oy), -PI/2+angle));
 }
 
 

Modified: branches/multiplayer-branch/source/ships/shpbahbu.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpbahbu.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ships/shpbahbu.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -19,7 +19,6 @@
 
 #include &quot;frame.h&quot;
 
-REGISTER_FILE
 
 class BahaoidBabyBuzzsaw;
 
@@ -79,6 +78,7 @@
 BahaoidBuzzsaw::BahaoidBuzzsaw(Vector2 opos, double shipAngle, ShipData *shipData, int shipCollideFlag) :
 	Ship(opos, shipAngle, shipData, shipCollideFlag)
 {
+  STACKTRACE;
 
 	weaponRange		= scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
 	weaponSpeed		= get_config_float(&quot;Weapon&quot;, &quot;Speed&quot;, 1) * ANGLE_RATIO;
@@ -95,6 +95,7 @@
 
 void BahaoidBuzzsaw::calculate_turn_left()
 {
+  STACKTRACE;
 	if(can_turn)
 	{
 		Ship::calculate_turn_left();
@@ -103,6 +104,7 @@
 
 void BahaoidBuzzsaw::calculate_turn_right()
 {
+  STACKTRACE;
 	if(can_turn)
 	{
 		Ship::calculate_turn_right();
@@ -111,6 +113,7 @@
 
 int BahaoidBuzzsaw::activate_weapon()
 {
+  STACKTRACE;
 	double xone = 0.8660254038;
 	double yone = 0.5;
 
@@ -145,6 +148,7 @@
 
 int BahaoidBuzzsaw::activate_special()
 {
+  STACKTRACE;
 	if(nummines&gt;=specialNumber) return(FALSE);
 
 	game-&gt;add(new BahaoidBabyBuzzsaw(0, 0, angle, 0, specialArmour, this,
@@ -156,6 +160,7 @@
 
 void BahaoidBuzzsaw::calculate()
 {
+  STACKTRACE;
 
 	if(fire_weapon)
 	{
@@ -177,6 +182,7 @@
     AnimatedShot(oship, opos, oangle, ov, odamage, -1.0, oarmour, oship,
       osprite, ofcount, ofsize)
 {
+  STACKTRACE;
 	weaponRange		= rangey;
 	weaponSpeed		= speedy;
 	weaponDamage	= damagey;
@@ -192,6 +198,7 @@
 
 int BahaoidBabyBuzzsaw::handle_damage(SpaceLocation* source, double normal, double direct)
 {
+  STACKTRACE;
 	armour -= normal + direct;
 	
 	if(armour &lt;= 0)
@@ -204,6 +211,7 @@
 
 void BahaoidBabyBuzzsaw::inflict_damage(SpaceObject *other)
 {
+  STACKTRACE;
 	if((ship) &amp;&amp; (other == ship))
 	{
 		state = 0;
@@ -217,6 +225,7 @@
 
 void BahaoidBabyBuzzsaw::calculate()
 {
+  STACKTRACE;
 	SpaceObject *o, *t = NULL;
 	double oldrange = 999999;
 

Modified: branches/multiplayer-branch/source/ships/shpbipka.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpbipka.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ships/shpbipka.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 #include &quot;melee/mview.h&quot;
 #include &quot;other/nullphas.h&quot;
 
@@ -107,6 +106,7 @@
 };
 
 SpaceLocation* BipoleKatamaran::get_ship_phaser() {
+  STACKTRACE;
   return new NullPhaser( this );
 }
 
@@ -114,6 +114,7 @@
   ShipData *shipData, unsigned int code) :
   Ship(opos, shipAngle, shipData, code)
 {
+  STACKTRACE;
   collide_flag_anyone = 0;
   collide_flag_sameteam = 0;
   collide_flag_sameship = 0;
@@ -158,7 +159,7 @@
 }
 
 int BipoleKatamaran::activate_weapon(){
-	STACKTRACE
+  STACKTRACE;
   if( !left || !right ) return FALSE;
   weapon_sample = random(11);
   int left_w = left-&gt;activate_weapon();
@@ -167,7 +168,7 @@
 }
 
 int BipoleKatamaran::activate_special(){
-	STACKTRACE
+  STACKTRACE;
   if( !left || !right ) return FALSE;
   if( range &gt;= specialMaxRange ){
     range = specialMaxRange;
@@ -178,12 +179,13 @@
 }
 
 void BipoleKatamaran::animate(Frame* space){
+  STACKTRACE;
   /* we do not show */
   return;
 }
 
 void BipoleKatamaran::calculate(){
-	STACKTRACE
+  STACKTRACE;
   if( left ) if( !left-&gt;exists() ){
     left = NULL;
     if( right ){
@@ -321,7 +323,7 @@
 }
 
 void BipoleKatamaran::calculate_thrust(){
-	STACKTRACE
+  STACKTRACE;
   if( !left || !right ) return;
   if( left-&gt;thrust &amp;&amp; !left-&gt;turn_left &amp;&amp; !left-&gt;turn_right ){
     left-&gt;accelerate(this, angle, accel_rate * frame_time, speed_max);
@@ -331,7 +333,7 @@
   }
 }
 void BipoleKatamaran::calculate_turn_left(){
-	STACKTRACE
+  STACKTRACE;
   if( !left || !right ) return;
   if( left-&gt;turn_left ){
     left-&gt;nextkeys &amp;= ~keyflag::thrust;
@@ -343,7 +345,7 @@
   }
 }
 void BipoleKatamaran::calculate_turn_right(){
-	STACKTRACE
+  STACKTRACE;
   if( !left || !right ) return;
   if( left-&gt;turn_right ){
     left-&gt;nextkeys |= keyflag::thrust;
@@ -356,11 +358,12 @@
 }
 
 void BipoleKatamaran::calculate_hotspots(){
+  STACKTRACE;
   return;
 }
 
 void BipoleKatamaran::materialize(){
-	STACKTRACE;
+  STACKTRACE;
 	
 //  int i;
 //  for( i = 0; game-&gt;target[i] != this; i++ );
@@ -374,7 +377,7 @@
 }
 
 void BipoleKatamaran::death(){
-	STACKTRACE
+  STACKTRACE;
 	// bug fix Geo.
 	// added exists(), because I *think* that the &quot;invisible&quot; ships can be destroyed
 	// by some field weapon ? At the same time, this field weapon can destroy the
@@ -388,6 +391,7 @@
   ShipData *shipData, unsigned int code, Ship* oparent, SpaceSprite* osprite) :
   Ship(opos, shipAngle, shipData, code)
 {
+  STACKTRACE;
   parent = oparent;
   sprite = osprite;
 
@@ -403,7 +407,7 @@
 }
 
 int BipoleShip::activate_weapon(){
-	STACKTRACE
+  STACKTRACE;
   shooting = !shooting;
   if( !shooting ) return FALSE;  // if we would return TRUE single ship would fire slower
 
@@ -415,7 +419,7 @@
 }
 
 int BipoleShip::activate_special(){
-	STACKTRACE
+  STACKTRACE;
 
 	if ( vel != 0 )
 	{
@@ -430,27 +434,28 @@
 }
 
 void BipoleShip::calculate_fire_weapon(){
-	STACKTRACE
+  STACKTRACE;
   if( !sibling ) Ship::calculate_fire_weapon();
 }
 void BipoleShip::calculate_fire_special(){
-	STACKTRACE
+  STACKTRACE;
   if( !sibling ) Ship::calculate_fire_special();
 }
 void BipoleShip::calculate_thrust(){
-	STACKTRACE
+  STACKTRACE;
   if( !sibling ) Ship::calculate_thrust();
 }
 void BipoleShip::calculate_turn_left(){
-	STACKTRACE
+  STACKTRACE;
   if( !sibling ) Ship::calculate_turn_left();
 }
 void BipoleShip::calculate_turn_right(){
-	STACKTRACE
+  STACKTRACE;
   if( !sibling ) Ship::calculate_turn_right();
 }
 
 /*void BipoleShip::calculate_hotspots() {
+  STACKTRACE;
   if( thrust &amp;&amp;( hotspot_frame &lt;= 0 )){
     game-&gt;addItem(new Animation( this, 
       normal_x() - (cos(angle ) * w / 2.5),
@@ -462,31 +467,29 @@
 }*/
 
 int BipoleShip::handle_damage(SpaceLocation *source, double normal, double direct) {
-	STACKTRACE
+  STACKTRACE;
 	int s = exists();
 	int i = Ship::handle_damage(source, normal, direct);
 	if (s &amp;&amp; !exists()) destroyed( source );
 	return i;
 	}
 
-void BipoleShip::destroyed( SpaceLocation* source ){
-	STACKTRACE
-	play_sound((SAMPLE *)(melee[MELEE_BOOMSHIP].dat));
-	game-&gt;add(new Animation(this, pos,
-    meleedata.kaboomSprite, 0, KABOOM_FRAMES, time_ratio, LAYER_EXPLOSIONS));
-
-// we do not report ship_died events -- the parent does
-//  game-&gt;ship_died(this, source);
+void BipoleShip::destroyed( SpaceLocation* source )
+{
+  STACKTRACE;
+  tw_sound-&gt;play_sound(data_full_path(MELEE_BOOMSHIP_SOUND));
+  game-&gt;add(new Animation(this, pos,
+			  game-&gt;meleedata.kaboomSprite, 0, KABOOM_FRAMES, time_ratio, LAYER_EXPLOSIONS));
 }
 
 
 ShipType *BipoleShip::get_shiptype()
 {
-	STACKTRACE
-	// this is necessary, otherwise the Kat Poly ship crashes.
-	// also, &quot;type&quot; cannot be redirected inside the constructor, cause the
-	// parents' type is declared outside of its constructor (bad?).
-	return parent-&gt;type;
+  STACKTRACE;
+  // this is necessary, otherwise the Kat Poly ship crashes.
+  // also, &quot;type&quot; cannot be redirected inside the constructor, cause the
+  // parents' type is declared outside of its constructor (bad?).
+  return parent-&gt;type;
 };
 
 

Modified: branches/multiplayer-branch/source/ships/shpbogce.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpbogce.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ships/shpbogce.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -15,8 +15,8 @@
 GNU General Public License for more details.
 */
 
+#include &quot;util/sound.h&quot;
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 #define BOGEI_CENTURION_ID SPACE_SHIP+0x00FE
 #define max_links 20
@@ -25,7 +25,7 @@
 {
   double        weaponRange, weaponSpread;
   int           weaponDamage;
-
+  
   int           specialDamage, specialArmour;
   int           specialLifetime, specialFuel;
   double        specialAccel, specialMaxspeed, specialBlastMaxspeed;
@@ -33,23 +33,23 @@
   double        specialHotspotThrust, specialHotspotSlowdown;
   int           special_slot;
   double        specialBlastAccel;
-
+  
   int           gun_phase, old_gun_phase;
   double        gun_position, gun_speed;
   int           startup_time, startup_delay, slowdown_time, delay_count;
   bool          slowing_down, gun_full_speed;
   int           flame_frame, flame_count, flame_duration;
-
+  
   int           exhaust_frame, exhaust_rate, exhaust_framesize, exhaust_count;
   int           exhaust_fry_chance;
   double        exhaust_slowdown, exhaust_thrust;
   bool          draw_hotspots, exhaust_on;
-
+  
   double        share_range;
   int           links_num;
-
+  
   double        residual_damage;
-
+  
   BoggCenturion        *link[max_links+1];
 
   public:
@@ -62,7 +62,6 @@
   virtual void  animate(Frame *space);
   virtual void  calculate_hotspots();
   virtual int handle_damage(SpaceLocation *source, double normal, double direct);
-  //virtual void  handle_damage(SpaceLocation *source);
 };
 
 
@@ -76,10 +75,13 @@
 
   public:
 
-  BoggCenturionMissile (SpaceLocation *creator, Vector2 opos, double oangle, int odamage, int oarmour,
-                int olifetime, int ofuel, double oaccel, double omaxspeed, double oblast_accel, double oblast_maxspeed,
-                int ohotspot_rate, int ohotspot_frame_size, double ohotspot_thrust, double ohotspot_slowdown,
-                SpaceSprite *osprite, SpaceSprite *hsprite, SAMPLE *s, SpaceSprite *esprite);
+  BoggCenturionMissile (SpaceLocation *creator, Vector2 opos, 
+			double oangle, int odamage, int oarmour,
+			int olifetime, int ofuel, double oaccel, 
+			double omaxspeed, double oblast_accel, double oblast_maxspeed,
+			int ohotspot_rate, int ohotspot_frame_size, 
+			double ohotspot_thrust, double ohotspot_slowdown,
+			SpaceSprite *osprite, SpaceSprite *hsprite, std::string s, SpaceSprite *esprite);
   virtual void  calculate();
   virtual void  inflict_damage(SpaceObject *other);
 };
@@ -89,9 +91,10 @@
 {
   double slowdown;
   public:
-  BoggCenturionExhaust (SpaceLocation *creator, double oangle, double dx, double dy, SpaceSprite *osprite,
-                int first_frame, int num_frames, int frame_size, double depth,
-                double v, double oslowdown, int ochance, SAMPLE *os);
+  BoggCenturionExhaust (SpaceLocation *creator, 
+			double oangle, double dx, double dy, SpaceSprite *osprite,
+			int first_frame, int num_frames, int frame_size, double depth,
+			double v, double oslowdown, int ochance, std::string os);
   virtual void  calculate();
 };
 
@@ -99,9 +102,9 @@
 class BoggCenturionExhaustShot : public Shot
 {
   SpaceLocation *amt;
-  SAMPLE *s;
-  public:
-  BoggCenturionExhaustShot (SpaceLocation *creator, SpaceSprite *osprite, SAMPLE *os);
+  std::string s;
+public:
+  BoggCenturionExhaustShot (SpaceLocation *creator, SpaceSprite *osprite, std::string os);
   virtual void  calculate();
   virtual void  inflict_damage(SpaceObject *other);
   virtual void  animate(Frame *space);
@@ -111,11 +114,11 @@
 class BoggCenturionShot : public Laser
 {
   SpaceSprite *ex_sprite;
-  SAMPLE *ex_sample;
+  std::string ex_sample;
   
-  public:
+public:
   BoggCenturionShot (SpaceLocation *creator, Vector2 opos, double oangle, int odamage,
-             double orange, SpaceSprite *esprite, SAMPLE *esample);
+		     double orange, SpaceSprite *esprite, std::string esample);
   virtual void animate(Frame *space);
   virtual void inflict_damage(SpaceObject *other);
   virtual void calculate();
@@ -125,420 +128,435 @@
 BoggCenturion::BoggCenturion (Vector2 opos, double shipAngle, ShipData *shipData, unsigned int code) :
         Ship(opos, shipAngle, shipData, code)
 {
-        id                      = BOGEI_CENTURION_ID;
-
-        exhaust_on              = (get_config_int(&quot;Engines&quot;, &quot;ExhaustOn&quot;, 0) != 0);
-        exhaust_rate            = get_config_int(&quot;Engines&quot;, &quot;ExhaustRate&quot;, 0);
-        exhaust_frame           = 0;
-        exhaust_slowdown        = get_config_float(&quot;Engines&quot;, &quot;ExhaustSlowdown&quot;, 0) / 1000.0;
-        exhaust_framesize       = get_config_int(&quot;Engines&quot;, &quot;ExhaustFrameSize&quot;, 0);
-        exhaust_thrust          = scale_velocity(get_config_float(&quot;Engines&quot;, &quot;ExhaustThrust&quot;, 0));
-        draw_hotspots           = (get_config_int(&quot;Engines&quot;, &quot;DrawHotspots&quot;, 0) != 0);
-        exhaust_fry_chance      = get_config_int(&quot;Engines&quot;, &quot;ExhaustFryChance&quot;, 0);
-        
-        share_range             = scale_range(get_config_float(&quot;Herd&quot;, &quot;Range&quot;, 0));
-        links_num               = 0;
-        
-        weaponRange             = scale_range(get_config_float(&quot;Primary&quot;, &quot;Range&quot;, 0));
-        weaponDamage            = get_config_int(&quot;Primary&quot;, &quot;Damage&quot;, 0);
-        weaponSpread            = get_config_float(&quot;Primary&quot;, &quot;Spread&quot;, 0) * ANGLE_RATIO;
-        flame_duration          = get_config_int(&quot;Primary&quot;, &quot;FlameDuration&quot;, 0);
-
-        startup_time            = int(get_config_float(&quot;Primary&quot;, &quot;StartupTime&quot;, 0) * 1000);
-        slowdown_time           = int(get_config_float(&quot;Primary&quot;, &quot;SlowdownTime&quot;, 0) * 1000);
-        startup_delay           = int(get_config_float(&quot;Primary&quot;, &quot;StartupDelay&quot;, 0) * 1000);
-
-        specialDamage           = get_config_int(&quot;Secondary&quot;, &quot;Damage&quot;, 0);
-        specialArmour           = get_config_int(&quot;Secondary&quot;, &quot;Armour&quot;, 0);
-        specialLifetime         = int(get_config_float(&quot;Secondary&quot;, &quot;Lifetime&quot;, 0) * 1000);
-        specialFuel             = int(get_config_float(&quot;Secondary&quot;, &quot;Fuel&quot;, 0) * 1000);
-        specialAccel            = scale_acceleration(get_config_float(&quot;Secondary&quot;, &quot;Accel&quot;, 0),0);
-        specialBlastAccel       = scale_velocity(get_config_float(&quot;Secondary&quot;, &quot;BlastAccel&quot;, 0));
-        specialBlastMaxspeed    = scale_velocity(get_config_float(&quot;Secondary&quot;, &quot;BlastMaxspeed&quot;, 0));
-        specialMaxspeed         = scale_velocity(get_config_float(&quot;Secondary&quot;, &quot;Maxspeed&quot;, 0));
-        specialHotspotRate      = get_config_int(&quot;Secondary&quot;, &quot;HotspotRate&quot;, 0);
-        specialHotspotFrameSize = get_config_int(&quot;Secondary&quot;, &quot;HotspotFrameSize&quot;, 0);
-        specialHotspotThrust    = scale_velocity(get_config_float(&quot;Secondary&quot;, &quot;HotspotThrust&quot;, 0));
-        specialHotspotSlowdown  = get_config_float(&quot;Secondary&quot;, &quot;HotspotSlowdown&quot;, 0) / 1000.0;
-        
-        special_slot            = 2;
-
-        gun_phase = 0; old_gun_phase = 0;
-        gun_position = 0;
-        gun_speed = 0;
-        slowing_down = false;
-        gun_full_speed = false;
-        flame_count = -1;
-        delay_count = 0;
-
-        residual_damage = 0;
+  id                      = BOGEI_CENTURION_ID;
+  
+  exhaust_on              = (get_config_int(&quot;Engines&quot;, &quot;ExhaustOn&quot;, 0) != 0);
+  exhaust_rate            = get_config_int(&quot;Engines&quot;, &quot;ExhaustRate&quot;, 0);
+  exhaust_frame           = 0;
+  exhaust_slowdown        = get_config_float(&quot;Engines&quot;, &quot;ExhaustSlowdown&quot;, 0) / 1000.0;
+  exhaust_framesize       = get_config_int(&quot;Engines&quot;, &quot;ExhaustFrameSize&quot;, 0);
+  exhaust_thrust          = scale_velocity(get_config_float(&quot;Engines&quot;, &quot;ExhaustThrust&quot;, 0));
+  draw_hotspots           = (get_config_int(&quot;Engines&quot;, &quot;DrawHotspots&quot;, 0) != 0);
+  exhaust_fry_chance      = get_config_int(&quot;Engines&quot;, &quot;ExhaustFryChance&quot;, 0);
+  
+  share_range             = scale_range(get_config_float(&quot;Herd&quot;, &quot;Range&quot;, 0));
+  links_num               = 0;
+  
+  weaponRange             = scale_range(get_config_float(&quot;Primary&quot;, &quot;Range&quot;, 0));
+  weaponDamage            = get_config_int(&quot;Primary&quot;, &quot;Damage&quot;, 0);
+  weaponSpread            = get_config_float(&quot;Primary&quot;, &quot;Spread&quot;, 0) * ANGLE_RATIO;
+  flame_duration          = get_config_int(&quot;Primary&quot;, &quot;FlameDuration&quot;, 0);
+  
+  startup_time            = int(get_config_float(&quot;Primary&quot;, &quot;StartupTime&quot;, 0) * 1000);
+  slowdown_time           = int(get_config_float(&quot;Primary&quot;, &quot;SlowdownTime&quot;, 0) * 1000);
+  startup_delay           = int(get_config_float(&quot;Primary&quot;, &quot;StartupDelay&quot;, 0) * 1000);
+  
+  specialDamage           = get_config_int(&quot;Secondary&quot;, &quot;Damage&quot;, 0);
+  specialArmour           = get_config_int(&quot;Secondary&quot;, &quot;Armour&quot;, 0);
+  specialLifetime         = int(get_config_float(&quot;Secondary&quot;, &quot;Lifetime&quot;, 0) * 1000);
+  specialFuel             = int(get_config_float(&quot;Secondary&quot;, &quot;Fuel&quot;, 0) * 1000);
+  specialAccel            = scale_acceleration(get_config_float(&quot;Secondary&quot;, &quot;Accel&quot;, 0),0);
+  specialBlastAccel       = scale_velocity(get_config_float(&quot;Secondary&quot;, &quot;BlastAccel&quot;, 0));
+  specialBlastMaxspeed    = scale_velocity(get_config_float(&quot;Secondary&quot;, &quot;BlastMaxspeed&quot;, 0));
+  specialMaxspeed         = scale_velocity(get_config_float(&quot;Secondary&quot;, &quot;Maxspeed&quot;, 0));
+  specialHotspotRate      = get_config_int(&quot;Secondary&quot;, &quot;HotspotRate&quot;, 0);
+  specialHotspotFrameSize = get_config_int(&quot;Secondary&quot;, &quot;HotspotFrameSize&quot;, 0);
+  specialHotspotThrust    = scale_velocity(get_config_float(&quot;Secondary&quot;, &quot;HotspotThrust&quot;, 0));
+  specialHotspotSlowdown  = get_config_float(&quot;Secondary&quot;, &quot;HotspotSlowdown&quot;, 0) / 1000.0;
+  
+  special_slot            = 2;
+  
+  gun_phase = 0; old_gun_phase = 0;
+  gun_position = 0;
+  gun_speed = 0;
+  slowing_down = false;
+  gun_full_speed = false;
+  flame_count = -1;
+  delay_count = 0;
+  
+  residual_damage = 0;
 }
 
 int BoggCenturion::activate_weapon()
 {
-        if ((gun_phase &gt;= old_gun_phase) || (!gun_full_speed) || (delay_count &lt; startup_delay))
-                return false;
+  STACKTRACE;
+  if ((gun_phase &gt;= old_gun_phase) || (!gun_full_speed) || (delay_count &lt; startup_delay))
+    return false;
+  
+  double r = 1 - random(2.0);
+  
+  double l = sqrt(random(1.0));
+  game-&gt;add(new BoggCenturionShot(this, 
+				  Vector2(+8 + 8*r, 21), 
+				  angle + r*weaponSpread, weaponDamage, weaponRange * l,
+				  data-&gt;spriteWeapon, data-&gt;sampleWeapon[1]));
 
-        double r = 1 - random(2.0);
-//        r *= r;
-//        double l = sqrt(1 - r*r) * (1 - (random()%101)/50.0);
-//        l *= l * sin(weaponSpread*ANGLE_RATIO) * weaponRange;
-
-        double l = sqrt(random(1.0));
-        game-&gt;add(new BoggCenturionShot(this, Vector2(+8 + 8*r, 21), angle + r*weaponSpread, weaponDamage, weaponRange * l,
-                          data-&gt;spriteWeapon, data-&gt;sampleWeapon[1]));
-
-        flame_frame = random(4);
-        flame_count = flame_duration;
-
-        return true;
+  flame_frame = random(4);
+  flame_count = flame_duration;
+  
+  return true;
 }
 
-
 void BoggCenturion::calculate_fire_special()
 {
-
-        special_low = FALSE;
-
-        if(fire_special) {
-                if(batt &lt; special_drain) {
-                        special_low = TRUE;
-                        return; } }
-        else return;
-
-        if(special_recharge &gt; 0) return;
-
-        double dx, dy;
-        dx = (19 + 6.3 * special_slot);
-        dy = 2 * special_slot;
-
-        game-&gt;add(new BoggCenturionMissile(this, Vector2(dx, dy), angle,
-                          specialDamage, specialArmour, specialLifetime, specialFuel,
-                          specialAccel, specialMaxspeed, specialBlastAccel, specialBlastMaxspeed,
-                          specialHotspotRate, specialHotspotFrameSize, specialHotspotThrust, specialHotspotSlowdown,
-                          data-&gt;spriteSpecial, data-&gt;spriteExtra, data-&gt;sampleSpecial[0],
-                          data-&gt;spriteSpecialExplosion));
-        game-&gt;add(new BoggCenturionMissile(this, Vector2(-dx, dy), angle,
-                          specialDamage, specialArmour, specialLifetime, specialFuel,
-                          specialAccel, specialMaxspeed, specialBlastAccel, specialBlastMaxspeed,
-                          specialHotspotRate, specialHotspotFrameSize, specialHotspotThrust, specialHotspotSlowdown,
-                          data-&gt;spriteSpecial, data-&gt;spriteExtra, data-&gt;sampleSpecial[0],
-                          data-&gt;spriteSpecialExplosion));
-
-        special_slot--;
-        if (special_slot &lt; 0)
-                special_slot = 2;
-
-
-        batt -= special_drain;
-        special_recharge += special_rate;
+  STACKTRACE;
+  special_low = FALSE;
+  
+  if(fire_special) 
+    {
+      if(batt &lt; special_drain) {
+	special_low = TRUE;
+	return; } 
+    }
+  else return;
+  
+  if(special_recharge &gt; 0) return;
+  
+  double dx, dy;
+  dx = (19 + 6.3 * special_slot);
+  dy = 2 * special_slot;
+  
+  game-&gt;add(new BoggCenturionMissile(this, Vector2(dx, dy), angle,
+				     specialDamage, specialArmour, specialLifetime, specialFuel,
+				     specialAccel, specialMaxspeed, specialBlastAccel, 
+				     specialBlastMaxspeed, specialHotspotRate, specialHotspotFrameSize, 
+				     specialHotspotThrust, specialHotspotSlowdown,
+				     data-&gt;spriteSpecial, data-&gt;spriteExtra, data-&gt;sampleSpecial[0],
+				     data-&gt;spriteSpecialExplosion));
+  game-&gt;add(new BoggCenturionMissile(this, Vector2(-dx, dy), angle,
+				     specialDamage, specialArmour, specialLifetime, specialFuel,
+				     specialAccel, specialMaxspeed, specialBlastAccel, 
+				     specialBlastMaxspeed, specialHotspotRate, specialHotspotFrameSize, 
+				     specialHotspotThrust, specialHotspotSlowdown,
+				     data-&gt;spriteSpecial, data-&gt;spriteExtra, data-&gt;sampleSpecial[0],
+				     data-&gt;spriteSpecialExplosion));
+  
+  special_slot--;
+  if (special_slot &lt; 0)
+    special_slot = 2;
+  
+  batt -= special_drain;
+  special_recharge += special_rate;
 }
 
 void BoggCenturion::calculate()
 {
-        Ship::calculate();
-
-        if ((fire_weapon) &amp;&amp; !( (batt &lt; weapon_drain) || slowing_down)  ) {
-                if (startup_time &gt; 0)
-                        gun_speed += frame_time / (double)startup_time;
-                else    gun_speed = 1.0; }
+  STACKTRACE;
+  Ship::calculate();
+  
+  if ((fire_weapon) &amp;&amp; !( (batt &lt; weapon_drain) || slowing_down)  ) {
+    if (startup_time &gt; 0)
+      gun_speed += frame_time / (double)startup_time;
+    else    gun_speed = 1.0; }
         else {  slowing_down = true;
-                gun_full_speed = false;
-                delay_count = 0;
-                if (slowdown_time &gt; 0)
-                        gun_speed -= frame_time / (double)slowdown_time;
+	gun_full_speed = false;
+	delay_count = 0;
+	if (slowdown_time &gt; 0)
+	  gun_speed -= frame_time / (double)slowdown_time;
                 else    gun_speed = 0; }
-        if (gun_speed &gt;= 1.0)  {
-                gun_full_speed = true;
-                gun_speed = 1.0;
-                if (delay_count &lt; startup_delay) delay_count += frame_time; }
-        else
-                if ((gun_speed &lt;= 0) &amp;&amp; (slowing_down)) {
-                        gun_speed = 0;
-                        slowing_down = false; }
-        gun_position += frame_time*gun_speed/weapon_rate;
-        while (gun_position &gt;= 1) gun_position -= 1;
-
-        old_gun_phase = gun_phase;
-        gun_phase = (int)floor(gun_position * 8);
-
-        flame_count -= frame_time;
-
-        Query q;
-        links_num = 0;
-        BoggCenturion* bro;
-        for (q.begin(this, bit(LAYER_SHIPS), share_range); q.currento; q.next())
-                if (q.currento-&gt;getID() == BOGEI_CENTURION_ID) {
-                        bro = (BoggCenturion*)q.currento;
-                        if (bro-&gt;exists())
-                                links_num += 1;
-                        if (links_num == 2) break; }
-
+  if (gun_speed &gt;= 1.0)  {
+    gun_full_speed = true;
+    gun_speed = 1.0;
+    if (delay_count &lt; startup_delay) delay_count += frame_time; }
+  else
+    if ((gun_speed &lt;= 0) &amp;&amp; (slowing_down)) {
+      gun_speed = 0;
+      slowing_down = false; }
+  gun_position += frame_time*gun_speed/weapon_rate;
+  while (gun_position &gt;= 1) gun_position -= 1;
+  
+  old_gun_phase = gun_phase;
+  gun_phase = (int)floor(gun_position * 8);
+  
+  flame_count -= frame_time;
+  
+  Query q;
+  links_num = 0;
+  BoggCenturion* bro;
+  for (q.begin(this, bit(LAYER_SHIPS), share_range); q.currento; q.next())
+    if (q.currento-&gt;getID() == BOGEI_CENTURION_ID) {
+      bro = (BoggCenturion*)q.currento;
+      if (bro-&gt;exists())
+	links_num += 1;
+      if (links_num == 2) break; }  
 }
 
 void BoggCenturion::animate(Frame* space)
 {
-        BITMAP *bmp;
-        bmp = sprite-&gt;get_bitmap(64, 0);
-        clear_to_color( bmp, makecol(255,0,255));
+  STACKTRACE;
+  BITMAP *bmp;
+  bmp = sprite-&gt;get_bitmap(64, 0);
+  clear_to_color( bmp, makecol(255,0,255));
+  
+  double tx, ty;
+  int ix, iy;
+  
+  //      prepare for the gun
+  tx = sin((sprite_index+5) * 2 * PI / 64.0);
+  ty = cos((sprite_index+5) * 2 * PI / 64.0);
+  int ix1 = 42 + int(19*tx) - 12;
+  int iy1 = 42 - int(19*ty) - 12;
+  
+  blit(data-&gt;spriteSpecial-&gt;get_bitmap(64), bmp, 0, 0, ix1, iy1, 20, 20);
+  
+  //      flame
+  
+  if (flame_count &gt;= 0) {
+    
+    tx = sin((sprite_index+3) * 2 * PI / 64.0);
+    ty = cos((sprite_index+3) * 2 * PI / 64.0);
+    ix = 42 + int(35*tx) - 10;
+    iy = 42 - int(35*ty) - 10;
+    data-&gt;spriteExtraExplosion-&gt;draw(ix, iy, 40 + sprite_index + 64*flame_frame, bmp);
+  }
+  
+  //      ship itself
+  sprite-&gt;draw(0, 0, sprite_index, bmp);
+  
+  //      gun
+  
+  data-&gt;spriteWeaponExplosion-&gt;draw(ix1, iy1, sprite_index+64*gun_phase, bmp);
 
-        double tx, ty;
-        int ix, iy;
-
-//      prepare for the gun
-        tx = sin((sprite_index+5) * 2 * PI / 64.0);
-        ty = cos((sprite_index+5) * 2 * PI / 64.0);
-        int ix1 = 42 + int(19*tx) - 12;
-        int iy1 = 42 - int(19*ty) - 12;
-
-        blit(data-&gt;spriteSpecial-&gt;get_bitmap(64), bmp, 0, 0, ix1, iy1, 20, 20);
-
-//      flame
-
-        if (flame_count &gt;= 0) {
-
-                tx = sin((sprite_index+3) * 2 * PI / 64.0);
-                ty = cos((sprite_index+3) * 2 * PI / 64.0);
-                ix = 42 + int(35*tx) - 10;
-                iy = 42 - int(35*ty) - 10;
-                data-&gt;spriteExtraExplosion-&gt;draw(ix, iy, 40 + sprite_index + 64*flame_frame, bmp);
-        }
-
-//      ship itself
-        sprite-&gt;draw(0, 0, sprite_index, bmp);
-
-//      gun
-
-        data-&gt;spriteWeaponExplosion-&gt;draw(ix1, iy1, sprite_index+64*gun_phase, bmp);
-
-
-///     shield link indicator
-        tx = sin(sprite_index * 2 * PI / 64.0);
-        ty = cos(sprite_index * 2 * PI / 64.0);
-        ix = 42 + int(-9*tx) - 10;
-        iy = 42 - int(-9*ty) - 10;
-
-        if (links_num)
-                data-&gt;spriteExtraExplosion-&gt;draw(ix, iy, 296+sprite_index+64*(links_num-1), bmp);
-
-//      final
-        //sprite-&gt;animate(pos, 64, space);
-		animate_bmp(bmp, pos, space);
+  
+  ///     shield link indicator
+  tx = sin(sprite_index * 2 * PI / 64.0);
+  ty = cos(sprite_index * 2 * PI / 64.0);
+  ix = 42 + int(-9*tx) - 10;
+  iy = 42 - int(-9*ty) - 10;
+  
+  if (links_num)
+    data-&gt;spriteExtraExplosion-&gt;draw(ix, iy, 296+sprite_index+64*(links_num-1), bmp);
+  
+  //      final
+  //sprite-&gt;animate(pos, 64, space);
+  animate_bmp(bmp, pos, space);
 }
 
 void BoggCenturion::calculate_hotspots()
 {
-        if (draw_hotspots)
-                Ship::calculate_hotspots();
-
-        if (exhaust_frame &gt; 0) exhaust_frame -= frame_time;
-        else    if (thrust) {
-                exhaust_frame += exhaust_rate;
-                if (exhaust_count &lt; 7) exhaust_count += 1;
-                game-&gt;add(new BoggCenturionExhaust(this, angle,
-                                  -8.5, -36, data-&gt;spriteExtraExplosion, 10*(random(4)) + 10 - exhaust_count,
-                                  exhaust_count, exhaust_framesize, LAYER_HOTSPOTS,
-                                  exhaust_thrust, exhaust_slowdown,
+  STACKTRACE;
+  if (draw_hotspots)
+    Ship::calculate_hotspots();
+  
+  if (exhaust_frame &gt; 0) exhaust_frame -= frame_time;
+  else    if (thrust) {
+    exhaust_frame += exhaust_rate;
+    if (exhaust_count &lt; 7) exhaust_count += 1;
+    game-&gt;add(new BoggCenturionExhaust(this, angle,
+				       -8.5, -36, data-&gt;spriteExtraExplosion, 10*(random(4)) + 10 - exhaust_count,
+				       exhaust_count, exhaust_framesize, LAYER_HOTSPOTS,
+				       exhaust_thrust, exhaust_slowdown,
                                   exhaust_fry_chance, data-&gt;sampleExtra[0]));
-                game-&gt;add(new BoggCenturionExhaust(this, angle,
-                                  +9.5, -36, data-&gt;spriteExtraExplosion, 10*(random(4)) + 10 - exhaust_count,
-                                  exhaust_count, exhaust_framesize, LAYER_HOTSPOTS,
-                                  exhaust_thrust, exhaust_slowdown,
-                                  exhaust_fry_chance, data-&gt;sampleExtra[0])); }
-
-        if (!thrust)
-                exhaust_count = 0;
+    game-&gt;add(new BoggCenturionExhaust(this, angle,
+				       +9.5, -36, data-&gt;spriteExtraExplosion, 10*(random(4)) + 10 - exhaust_count,
+				       exhaust_count, exhaust_framesize, LAYER_HOTSPOTS,
+				       exhaust_thrust, exhaust_slowdown,
+				       exhaust_fry_chance, data-&gt;sampleExtra[0])); }
+  
+  if (!thrust)
+    exhaust_count = 0;
 }
 
 
 int BoggCenturion::handle_damage(SpaceLocation *source, double normal, double direct)
 //void BoggCenturion::handle_damage(SpaceLocation *source)
 {
-        if (source == this) {
-                return Ship::handle_damage(source, normal, direct);
-                 }
-        
-		double tot = normal + direct;
-
-        Query q;
-        int ln = 0;
-        BoggCenturion* bro;
-        for (q.begin(this, bit(LAYER_SHIPS), share_range); q.currento; q.next())
-                if (q.currento-&gt;getID() == BOGEI_CENTURION_ID) {
-                        bro = (BoggCenturion*)q.currento;
-                        if (bro-&gt;exists()) {
-                                ln += 1;
-                                link[ln] = bro; }
-                        if (links_num == max_links) break; }
-
-        if (ln) {
-                double d = tot;
-
-                if (ln &lt; 2)
-					d *= 0.75;
-                else
-					d *= 0.5;
-
-				tot = (int)floor(d);
-
-                d -= tot;
-                residual_damage += d;
-
-                int dx = (int)floor(residual_damage);
-                tot += dx;
-
-                residual_damage -= dx;
-		
-		}
-
-		Ship::handle_damage(source, tot);
-
-        return 0;
+  STACKTRACE;
+  if (source == this) {
+    return Ship::handle_damage(source, normal, direct);
+  }
+  
+  double tot = normal + direct;
+  
+  Query q;
+  int ln = 0;
+  BoggCenturion* bro;
+  for (q.begin(this, bit(LAYER_SHIPS), share_range); q.currento; q.next())
+    if (q.currento-&gt;getID() == BOGEI_CENTURION_ID) {
+      bro = (BoggCenturion*)q.currento;
+      if (bro-&gt;exists()) {
+	ln += 1;
+	link[ln] = bro; }
+      if (links_num == max_links) break; }
+  
+  if (ln) {
+    double d = tot;
+    
+    if (ln &lt; 2)
+      d *= 0.75;
+    else
+      d *= 0.5;
+    
+    tot = (int)floor(d);
+    
+    d -= tot;
+    residual_damage += d;
+    
+    int dx = (int)floor(residual_damage);
+    tot += dx;
+    
+    residual_damage -= dx;
+    
+  }
+  
+  Ship::handle_damage(source, tot);
+  
+  return 0;
 }
 
 
-BoggCenturionMissile::BoggCenturionMissile (SpaceLocation *creator, Vector2 opos, double oangle, int odamage, int oarmour,
-                            int olifetime, int ofuel, double oaccel, double omaxspeed, double oblast_accel, double oblast_maxspeed,
-                            int ohotspot_rate, int ohotspot_frame_size, double ohotspot_thrust, double ohotspot_slowdown,
-                            SpaceSprite *osprite, SpaceSprite *hsprite, SAMPLE *s, SpaceSprite *esprite) :
-        Missile (creator, opos, oangle, 0, odamage, -1, oarmour, creator, osprite, 1.0),
-        lifetime(olifetime), fuel(ofuel), accel(oaccel), maxspeed(omaxspeed),
-        hotspot_rate(ohotspot_rate), hotspot_frame_size(ohotspot_frame_size),
-        hotspot_thrust(ohotspot_thrust), hotspot_slowdown(ohotspot_slowdown),
-        hotspot_sprite(hsprite)
+BoggCenturionMissile::BoggCenturionMissile (SpaceLocation *creator, Vector2 opos, 
+					    double oangle, int odamage, int oarmour,
+					    int olifetime, int ofuel, double oaccel, 
+					    double omaxspeed, double oblast_accel, 
+					    double oblast_maxspeed, int ohotspot_rate, 
+					    int ohotspot_frame_size, double ohotspot_thrust, 
+					    double ohotspot_slowdown, SpaceSprite *osprite, 
+					    SpaceSprite *hsprite, std::string s, SpaceSprite *esprite) :
+  Missile (creator, opos, oangle, 0, odamage, -1, oarmour, creator, osprite, 1.0),
+  lifetime(olifetime), fuel(ofuel), accel(oaccel), maxspeed(omaxspeed),
+  hotspot_rate(ohotspot_rate), hotspot_frame_size(ohotspot_frame_size),
+  hotspot_thrust(ohotspot_thrust), hotspot_slowdown(ohotspot_slowdown),
+  hotspot_sprite(hsprite)
 {
-        blast_accel = oblast_accel;
-        blast_maxspeed = oblast_maxspeed;
-        hotspot_frame = 0;
-        play_sound(s, 128);
-        explosionSprite = esprite;
-        explosionFrameCount = 10;
-        explosionFrameSize = 50;
-        explosionSample = data-&gt;sampleSpecial[1];
+  blast_accel = oblast_accel;
+  blast_maxspeed = oblast_maxspeed;
+  hotspot_frame = 0;
+  tw_sound-&gt;play_sound(data_full_path(s));//       play_sound(s, 128);
+  explosionSprite = esprite;
+  explosionFrameCount = 10;
+  explosionFrameSize = 50;
+  explosionSample = data-&gt;sampleSpecial[1];
 }
 
 void BoggCenturionMissile::calculate()
 {
-        SpaceObject::calculate();
-        if (lifetime &gt; 0) lifetime -= frame_time;
-        else    state = 0;
-        
-        if (fuel &gt; 0) {
-                fuel -= frame_time;
-                accelerate(this, angle, accel*frame_time, maxspeed);
-                if (hotspot_frame &gt; 0) hotspot_frame -= frame_time;
-                else {  hotspot_frame += hotspot_rate;
-                        game-&gt;add(new BoggCenturionExhaust(this, angle, 0, -8.5, hotspot_sprite, 0, 20,
-                                          hotspot_frame_size, LAYER_HOTSPOTS,
-                                          hotspot_thrust, hotspot_slowdown, 0, NULL)); } }
-
-        //sprite_index = (int(angle / 5.625 + 16)) &amp; 63;
-		sprite_index = get_index(angle);
+  STACKTRACE;
+  SpaceObject::calculate();
+  if (lifetime &gt; 0) 
+    lifetime -= frame_time;
+  else    state = 0;
+  
+  if (fuel &gt; 0) 
+    {
+      fuel -= frame_time;
+      accelerate(this, angle, accel*frame_time, maxspeed);
+      if (hotspot_frame &gt; 0) 
+	hotspot_frame -= frame_time;
+      else 
+	{  
+	  hotspot_frame += hotspot_rate;
+	  game-&gt;add(new BoggCenturionExhaust(this, angle, 0, -8.5, hotspot_sprite, 0, 20,
+					     hotspot_frame_size, LAYER_HOTSPOTS,
+					     hotspot_thrust, hotspot_slowdown, 0, NULL)); 
+	} 
+    }
+  sprite_index = get_index(angle);
 };
 
 void  BoggCenturionMissile::inflict_damage(SpaceObject *other)
 {
-        if ((!other-&gt;isPlanet()) &amp;&amp; (other-&gt;mass))
-                other-&gt;accelerate(this, normalize(trajectory_angle(other), 360), blast_accel/other-&gt;mass, blast_maxspeed);
-        Missile::inflict_damage(other);
+  STACKTRACE;
+  if ((!other-&gt;isPlanet()) &amp;&amp; (other-&gt;mass))
+    other-&gt;accelerate(this, normalize(trajectory_angle(other), 360), blast_accel/other-&gt;mass, blast_maxspeed);
+  Missile::inflict_damage(other);
 }
 
 
-BoggCenturionExhaust::BoggCenturionExhaust (SpaceLocation *creator, double oangle, double dx, double dy, SpaceSprite *osprite,
-                                          int first_frame, int num_frames, int frame_size, double depth,
-                                          double v, double oslowdown, int ochance, SAMPLE *os) :
-        Animation (creator, creator-&gt;normal_pos(), osprite,
-        first_frame, num_frames, frame_size, depth)
+BoggCenturionExhaust::BoggCenturionExhaust (SpaceLocation *creator, double oangle, double dx, 
+					    double dy, SpaceSprite *osprite,
+					    int first_frame, int num_frames, int frame_size, 
+					    double depth, double v, double oslowdown, 
+					    int ochance, std::string os) :
+  Animation (creator, creator-&gt;normal_pos(), osprite,
+	     first_frame, num_frames, frame_size, depth)
 {
-        if (random(100) &lt; ochance)
-                game-&gt;add(new BoggCenturionExhaustShot(this, osprite, os));
-
-        //double alpha = oangle * ANGLE_RATIO;
-        //double tx = cos(alpha);
-        //double ty = sin(alpha);
-        //x += dy * tx - dx*ty;
-        //y += dy * ty + dx*tx;
-		pos += rotate(Vector2(dy,dx), oangle);
-        //vx = creator-&gt;get_vx() - vel * tx;
-        //vy = creator-&gt;get_vy() - vel * ty;
-		vel = creator-&gt;get_vel() - v * unit_vector(oangle);
-        slowdown = oslowdown;
+  if (random(100) &lt; ochance)
+    game-&gt;add(new BoggCenturionExhaustShot(this, osprite, os));  
+  pos += rotate(Vector2(dy,dx), oangle);
+  vel = creator-&gt;get_vel() - v * unit_vector(oangle);
+  slowdown = oslowdown;
 }
 
 void BoggCenturionExhaust::calculate()
 {
-        Animation::calculate();
-        double gamma = exp( - slowdown * frame_time);
-        vel *= gamma;
-        //vy *= gamma;
+  STACKTRACE;
+  Animation::calculate();
+  double gamma = exp( - slowdown * frame_time);
+  vel *= gamma;
 }
 
 
-BoggCenturionExhaustShot::BoggCenturionExhaustShot (SpaceLocation *creator, SpaceSprite *osprite, SAMPLE *os) :
-        Shot(creator, 0, 0, 0, 1, 1e40, 1, creator, osprite, 1.0)
+BoggCenturionExhaustShot::BoggCenturionExhaustShot (SpaceLocation *creator, SpaceSprite *osprite, 
+						    std::string os) :
+  Shot(creator, 0, 0, 0, 1, 1e40, 1, creator, osprite, 1.0)
 {
-        amt = creator;
-        s = os;
-        sprite_index = 5;
+  amt = creator;
+  s = os;
+  sprite_index = 5;
 }
 
 void BoggCenturionExhaustShot::calculate()
 {
-        Shot::calculate();
-        if (!amt-&gt;exists()) state = 0;
-        //x = amt-&gt;normal_x();
-        //y = amt-&gt;normal_y();
-		pos = amt-&gt;normal_pos();
-        //vx = amt-&gt;get_vx();
-        //vy = amt-&gt;get_vy();
-		vel = amt-&gt;get_vel();
+  STACKTRACE;
+  Shot::calculate();
+  if (!amt-&gt;exists()) 
+    state = 0;
+  
+  pos = amt-&gt;normal_pos();
+  vel = amt-&gt;get_vel();
 }
 
 void BoggCenturionExhaustShot::animate(Frame *space)
 {
+  STACKTRACE;
 }
 
 void BoggCenturionExhaustShot::inflict_damage(SpaceObject *other)
 {
-        //other-&gt;damage += 1;
-        other-&gt;handle_damage(this, 1);
-        if (s)  play_sound(s, 160);
-        state = 0;
+  STACKTRACE;
+  other-&gt;handle_damage(this, 1);
+  if (!s.empty())  
+    {
+      tw_sound-&gt;play_sound(data_full_path(s)); // was vol 160
+    }
+  state = 0;
 }
 
-
-BoggCenturionShot::BoggCenturionShot (SpaceLocation *creator, Vector2 opos, double oangle, int odamage,
-                      double orange, SpaceSprite *esprite, SAMPLE *esample) :
-        Laser(creator, oangle, 0, orange, odamage, 300, creator, opos, true)
+BoggCenturionShot::BoggCenturionShot (SpaceLocation *creator, Vector2 opos, 
+				      double oangle, int odamage,
+				      double orange, SpaceSprite *esprite, 
+				      std::string esample) :
+  Laser(creator, oangle, 0, orange, odamage, 300, creator, opos, true)
 {
-        ex_sprite = esprite; ex_sample = esample;
+  ex_sprite = esprite; ex_sample = esample;
 }
 
 void BoggCenturionShot::animate(Frame *space)
 {
-	// for testing show the lasers
-//color = makecol(255,255,255); Laser::animate(space);
+  STACKTRACE;
 }
 
 void BoggCenturionShot::inflict_damage(SpaceObject *other)
 {
-        //x += edge_x(); y += edge_y();
-		pos += edge();
-//        play_sound(ex_sample, 240);
-        game-&gt;add(new Animation(this, pos, ex_sprite, 0, 10, 50, LAYER_EXPLOSIONS));
-        //other-&gt;damage += damage_factor;
-        other-&gt;handle_damage(this, damage_factor);
-        state = 0;
+  STACKTRACE;
+  pos += edge();
+  tw_sound-&gt;play_sound(data_full_path(ex_sample)); // was vol 240
+  game-&gt;add(new Animation(this, pos, ex_sprite, 0, 10, 50, LAYER_EXPLOSIONS));
+  other-&gt;handle_damage(this, damage_factor);
+  state = 0;
 }
 
 void BoggCenturionShot::calculate()
 {
-        if (frame &gt; 0) {
-                state = 0;
-                return; }
-        Laser::calculate();
+  STACKTRACE;
+  if (frame &gt; 0) 
+    {
+      state = 0;
+      return; 
+    }
+  Laser::calculate();
 }
 
 
-
 REGISTER_SHIP(BoggCenturion)

Modified: branches/multiplayer-branch/source/ships/shpchoex.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpchoex.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ships/shpchoex.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -18,7 +18,6 @@
 #include &quot;ship.h&quot;
 #include &quot;melee/mcbodies.h&quot;
 
-REGISTER_FILE
 /*
 Since this is my first ship, I obviously nabbed a lot of this code from other ship files.
 The sources of my inspiration:
@@ -51,6 +50,7 @@
 AsteroidDebris::AsteroidDebris(Ship *creator1, Vector2 new_pos, int tforce)
 : Asteroid()
 {
+  STACKTRACE;
   creator=creator1;
   translate(new_pos - pos);
   frame_born=(int)(game-&gt;frame_number);
@@ -61,7 +61,7 @@
 }
 void AsteroidDebris::calculate()
 {
-	STACKTRACE
+  STACKTRACE;
   step-= frame_time;
   while(step &lt;= 0) {
     step += speed * time_ratio;
@@ -83,7 +83,7 @@
 }
 int AsteroidDebris::canCollide(SpaceLocation *other) 
 {
-	STACKTRACE
+  STACKTRACE;
   if (collide_flag)
     { return SpaceObject::canCollide(other);
     }
@@ -107,13 +107,14 @@
 AsteroidCenter::AsteroidCenter(Ship *creator1, Vector2 new_pos) 
 : AsteroidDebris(creator1, new_pos, 0)
 {
+  STACKTRACE;
   layer = LAYER_SHOTS;
   collide_flag_anyone = ALL_LAYERS &amp;~ bit(LAYER_CBODIES);
   creator=creator1;
 }
 void AsteroidCenter::calculate()
 {
-	STACKTRACE
+  STACKTRACE;
   if (creator == NULL)
     {
       this-&gt;~AsteroidCenter();
@@ -127,16 +128,18 @@
 }
 int AsteroidCenter::canCollide(SpaceLocation *other) 
 {
-	STACKTRACE
+  STACKTRACE;
   if (!other-&gt;damage_factor) return false;
   return SpaceObject::canCollide(other);
 }
 int AsteroidCenter::handle_damage(SpaceLocation *source, double normal, double direct) 
 {
+  STACKTRACE;
 	return iround(normal + direct);
 }
 int AsteroidCenter::isAsteroid()
 {
+  STACKTRACE;
   return 0;
 }
 
@@ -162,6 +165,7 @@
 Laser(creator1, langle, lcolor, lrange, 
        ldamage, lfcount, opos, Vector2(rel_x,rel_y), osinc_angle)
 {
+  STACKTRACE;
   tractorForce = tForce;
   tractorPushForce = tPushForce;
   creator=creator1;
@@ -169,7 +173,7 @@
 
 void ChoraliTractorBeam::inflict_damage(SpaceObject *other)
 {
-	STACKTRACE
+  STACKTRACE;
   // SpaceObject::inflict_damage(other);
  if(other != NULL)
   {
@@ -257,8 +261,9 @@
     int R, int Rm, int G, int Gm, int B, int Bm) :
   HomingMissile(oship, Vector2(ox,oy), oangle, ov, odamage, orange, oarmour, otrate, 
 		oship, osprite, oship-&gt;target), 
-  explosion(meleedata.asteroidExplosionSprite), frame_count(oframe_count) 
+  explosion(game-&gt;meleedata.asteroidExplosionSprite), frame_count(oframe_count) 
 {
+  STACKTRACE;
 	collide_flag_sameship = bit(LAYER_SHIPS) | bit(LAYER_SHOTS);
 	//	explosionSprite     = game-&gt;asteroidExplosionSprite;
 	
@@ -283,7 +288,7 @@
 
 void AsteroidMissile::calculate()
 {
-	STACKTRACE
+  STACKTRACE;
 
   HomingMissile::calculate();
   if(sprite_index_count&lt;63)
@@ -306,7 +311,7 @@
 
 void AsteroidMissile::inflict_damage(SpaceObject *other)
 {
-	STACKTRACE
+  STACKTRACE;
   SpaceObject::inflict_damage(other);
   add(new Animation(this, pos, explosion, 0, explosion-&gt;frames(), time_ratio, LAYER_CBODIES));
   state=0;
@@ -314,7 +319,7 @@
 
 int AsteroidMissile::handle_damage(SpaceLocation *source, double normal, double direct) 
 {
-	STACKTRACE
+  STACKTRACE;
   if (!exists()) return 0;
   if (!normal &amp;&amp; !direct) return 0;
   
@@ -326,7 +331,7 @@
 }
 void AsteroidMissile::death()
 {
-	STACKTRACE
+  STACKTRACE;
   HomingMissile::death();
   add(new Animation(this, pos, explosion, 0, explosion-&gt;frames(), time_ratio, LAYER_CBODIES));
 }
@@ -416,6 +421,7 @@
 	Ship(opos, shipAngle, shipData, code)
 
 {
+  STACKTRACE;
   weaponFrames = get_config_int(&quot;Weapon&quot;, &quot;Frames&quot;, 0);
   drillFrames  = 0;
   weaponDamage   = get_config_int(&quot;Weapon&quot;, &quot;Damage&quot;, 0);
@@ -456,7 +462,7 @@
 
 void ChoraliExtractor::death()
 {
-	STACKTRACE
+  STACKTRACE;
   Ship::death();
 
   // dangerous, this is a memory leak:
@@ -465,26 +471,26 @@
 }
 void ChoraliExtractor::materialize()
 {
-	STACKTRACE
+  STACKTRACE;
 	Ship::materialize();
 	add(asteroid_center = new AsteroidCenter(this, this-&gt;normal_pos()));
 }
 
 void ChoraliExtractor::calculate_turn_left()
 {
-	STACKTRACE
+  STACKTRACE;
   Ship::calculate_turn_left();
 }
 
 void ChoraliExtractor::calculate_turn_right()
 {
-	STACKTRACE
+  STACKTRACE;
   Ship::calculate_turn_right();
 }
 
 int ChoraliExtractor::activate_weapon()
 {
-	STACKTRACE
+  STACKTRACE;
   if (drillFrames &gt; 0)
     {
       count=0;      
@@ -501,7 +507,7 @@
       else
 	{
 	  grabbed-&gt;die();
-       	  add(new AsteroidMissile(0.0, (size.y * 1.0), angle, AsteroidMissileVelocity, AsteroidMissileDamage, AsteroidMissileRange, AsteroidMissileArmour, AsteroidMissileTurnRate, this, meleedata.asteroidSprite, 1,
+       	  add(new AsteroidMissile(0.0, (size.y * 1.0), angle, AsteroidMissileVelocity, AsteroidMissileDamage, AsteroidMissileRange, AsteroidMissileArmour, AsteroidMissileTurnRate, this, game-&gt;meleedata.asteroidSprite, 1,
                  tractorR, tractorRmin, tractorG, tractorGmin, tractorB, tractorBmin ));
 	  return(TRUE);
      	}
@@ -516,7 +522,7 @@
 
 int ChoraliExtractor::activate_special()
 {
-	STACKTRACE
+  STACKTRACE;
 
   if(this-&gt;nearest_planet() != NULL)
     {
@@ -541,37 +547,43 @@
 
 void ChoraliExtractor::calculate()
 {
-	STACKTRACE
-   if(drillFrames &gt; 0) 
-     {
-       if(grabbed == NULL)
-	 {
-	   amt_beams=(random()%tractorMaxBeams)+1;
+  STACKTRACE;
+  if(drillFrames &gt; 0) 
+    {
+      if(grabbed == NULL)
+	{
+	  amt_beams=(random()%tractorMaxBeams)+1;
+	  
+	  for(int i=0;i&lt;amt_beams;i++)
+	    {
+	      add(new ChoraliTractorBeam(this, (double)(angle+(((random() % tractorSpread) - 
+								(tractorSpread/2))*ANGLE_RATIO) ),
+					 makecol((random()%(tractorR-tractorRmin+1))+tractorRmin, 
+						 (random()%(tractorG-tractorGmin+1))+tractorGmin, 
+						 (random()%(tractorB-tractorBmin+1))+tractorBmin), 
+					 tractorRange, tractorDamage, tractorRate, this, 0.0, 0.0, 
+					 true, tractorForce, tractorPushForce));
 
-	   for(int i=0;i&lt;amt_beams;i++)
-	     {
-	      
-	       add(new ChoraliTractorBeam(this, (double)(angle+(((random() % tractorSpread) - (tractorSpread/2))*ANGLE_RATIO) ),
-		      makecol((random()%(tractorR-tractorRmin+1))+tractorRmin, (random()%(tractorG-tractorGmin+1))+tractorGmin, (random()%(tractorB-tractorBmin+1))+tractorBmin), 
-		      tractorRange, tractorDamage, tractorRate, this, 0.0, 0.0, true, tractorForce, tractorPushForce));
-
+	    }
+	  if(count&gt;=PI)
+	    { 
+	      count=0;
+	    }
+	  if(count==0)
+	    {
+	      tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleExtra[0]));
+	      tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleExtra[0]));
 	     }
-	   if(count&gt;=PI)
-	     { count=0;
-	     }
-	   if(count==0)
-	     {
-	       play_sound2(data-&gt;sampleExtra[0]);
-	     }
-	   count++;
-
+	  count++;
+	  
 	 }
-
-       drillFrames-= frame_time;
-       if ((drillFrames &lt;= 0) &amp;&amp; (!latched)) 
-	 {
-	   play_sound2(data-&gt;sampleWeapon[0]);
-	 }
+      
+      drillFrames-= frame_time;
+      if ((drillFrames &lt;= 0) &amp;&amp; (!latched)) 
+	{
+	  tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleWeapon[0]));
+	  tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleWeapon[0]));
+	}
      }
    else 
      {
@@ -647,7 +659,7 @@
 
 int ChoraliExtractor::canCollide(SpaceObject *other)
 {
-	STACKTRACE
+  STACKTRACE;
   if ((latched) &amp;&amp; (grabbed!=NULL) &amp;&amp; (grabbed-&gt;exists()))
     {
       if (grabbed == other)
@@ -658,14 +670,14 @@
  
 void ChoraliExtractor::animate(Frame *space)
 {
-	STACKTRACE
-    sprite-&gt;animate( pos, sprite_index, space);
+  STACKTRACE;
+  sprite-&gt;animate( pos, sprite_index, space);
 }
 
 
 void ChoraliExtractor::inflict_damage(SpaceObject *other)
 {
-	STACKTRACE
+  STACKTRACE;
   if (drillFrames &gt; 0)
     {
       if (!latched)
@@ -681,7 +693,8 @@
 		  grabdistance = (distance(other) * 1.1);
 		  grabshipangle = (other-&gt;get_angle());
 		  drillDamageLeft = weaponDamage;
-		  play_sound2(data-&gt;sampleExtra[1]);
+		  tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleExtra[1]));
+		  tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleExtra[1]));
 		  if ((drillFrames / frame_time)&lt; weaponDamage) 
 		    {
 		      drillDamagePerDamageFrame = (weaponDamage/drillFrames)

Modified: branches/multiplayer-branch/source/ships/shpconca.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpconca.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ships/shpconca.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -18,8 +18,6 @@
 #include &lt;stdio.h&gt;
 #include &quot;ship.h&quot;
 #include &quot;melee/mview.h&quot;
-//#include &quot;link.h&quot;
-REGISTER_FILE
 
 inline double sqr(double x)
 {
@@ -73,6 +71,7 @@
 	SpaceObject *Next_Object):SpaceObject(creator,
 	opos,oangle,osprite)
 {
+  STACKTRACE;
 	Prev_Link=(Link *)Prev_Object;
 	Next_Link=(Link *)Next_Object;
 }
@@ -121,7 +120,7 @@
 
 void CargoLink::do_area_damage()
 {
-	STACKTRACE
+  STACKTRACE;
 	Query q;
 	for (q.begin(this, OBJECT_LAYERS, explosionRange); q.currento; q.next())
 	{
@@ -137,48 +136,50 @@
 
 int CargoLink::handle_damage(SpaceLocation *source, double normal, double direct)
 {
-	STACKTRACE
-	int  totalDamage = int( normal+direct + 0.5);
+  STACKTRACE;
+  int  totalDamage = int( normal+direct + 0.5);
 
-	if (totalDamage == 0) return 0;
+  if (totalDamage == 0) 
+    return 0;
 
-	//If there are no links, the link is destroyed.
-	if (!Prev_Link &amp;&amp; !Next_Link)
+  //If there are no links, the link is destroyed.
+  if (!Prev_Link &amp;&amp; !Next_Link)
+    {
+      state=0;
+      
+      // small chance of causing an explosion here, 1:5
+      // (later changed into a big chance)
+      
+      if ( random(1) == 0 )
 	{
-		state=0;
-
-		// small chance of causing an explosion here, 1:5
-		// (later changed into a big chance)
-
-		if ( random(1) == 0 )
-		{
-			
-			do_area_damage( );
-
-			play_sound((SAMPLE *)(melee[MELEE_BOOMSHIP].dat));
-			game-&gt;add(new Animation(this, pos,	meleedata.kaboomSprite, 0, KABOOM_FRAMES, time_ratio, DEPTH_EXPLOSIONS));
-
-		}
-		
-
-
-		return totalDamage;
+	  
+	  do_area_damage( );
+	  
+	  tw_sound-&gt;play_sound(data_full_path(MELEE_BOOMSHIP_SOUND));
+	  game-&gt;add(new Animation(this, pos,	game-&gt;meleedata.kaboomSprite, 0, 
+				  KABOOM_FRAMES, time_ratio, DEPTH_EXPLOSIONS));
+	  
 	}
-
-	//If a previous link exists, the damage is passed to it.
-	//directDamage is used so that we don't play the damage sound
-	//again.
-
-	if (Prev_Link) return damage(Prev_Link, 0, totalDamage);
-	else {
-		die();
-		return totalDamage;
-	}
+      
+      return totalDamage;
+    }
+  
+  //If a previous link exists, the damage is passed to it.
+  //directDamage is used so that we don't play the damage sound
+  //again.
+  
+  if (Prev_Link) 
+    return damage(Prev_Link, 0, totalDamage);
+  else 
+    {
+      die();
+      return totalDamage;
+    }
 }
 
 void CargoLink::calculate()
 {
-	STACKTRACE
+  STACKTRACE;
 	Link::calculate();
 	sprite_index = get_index(angle);
 	if (Prev_Link &amp;&amp; !Prev_Link-&gt;exists()) Prev_Link = NULL;
@@ -191,6 +192,7 @@
 :
 Link(creator,opos,oangle,osprite,Prev_Object,Next_Object)
 {
+  STACKTRACE;
 	mass=omass;
 	layer = LAYER_SPECIAL;
 
@@ -207,7 +209,7 @@
 
 void Chain::Pull_Last_Link()
 {
-	STACKTRACE
+  STACKTRACE;
 	Link *l=this;
 
 	//Seek to the end of the list
@@ -219,13 +221,13 @@
 
 int Chain::handle_damage(SpaceLocation *source, double normal, double direct)
 {
-	STACKTRACE
+  STACKTRACE;
 	return damage(Prev_Link, 0, normal+direct);
 }
 
 void Chain::Uncouple()
 {
-	STACKTRACE
+  STACKTRACE;
 
 	for(Link *l=this-&gt;Next_Link ; l!=NULL; l=l-&gt;Next_Link)
 	{
@@ -270,6 +272,7 @@
 :
 Link(creator,opos, oangle,osprite,NULL,NULL)
 {
+  STACKTRACE;
 		
 	Prev_Link=(Link *)creator;	//Attach the first link to the ship
 	
@@ -308,7 +311,7 @@
 
 void Chain::addlink(SpaceLocation *creator, double oangle, SpaceSprite *osprite, double ospacing, double omass)
 {
-	STACKTRACE
+  STACKTRACE;
 	// first, find the last link in the list:
 	
 	Link *Cur_Link = this;					// Chain is also of type Link.
@@ -353,7 +356,7 @@
 //backwards.
 void Chain::ChainRecur(Link *other,int num)
 {
-	STACKTRACE
+  STACKTRACE;
 	//Call ChainRecur for the next link UNLESS you're at the last link
 	if(other-&gt;Next_Link!=NULL) ChainRecur(other-&gt;Next_Link,num+1);
 
@@ -364,7 +367,7 @@
 
 void Chain::calculate()
 {
-	STACKTRACE
+  STACKTRACE;
 	if( !(ship &amp;&amp; ship-&gt;exists()) )
 	{	//If the mothership is killed, the chain dies.
 		Uncouple();		//Shatters chain, links become independent
@@ -383,7 +386,7 @@
 
 void Chain::ChainPhysics(SpaceObject *first, SpaceObject *second)
 {
-	STACKTRACE
+  STACKTRACE;
 
 
 	// first = towards the head, second = towards the tail
@@ -503,6 +506,7 @@
 	Ship(opos, angle, data, code)
 
 {
+  STACKTRACE;
 	weaponColor   =  get_config_int(&quot;Weapon&quot;, &quot;Color&quot;, 0);
 	weaponRange   =  scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
 	weaponDamage  =  get_config_int(&quot;Weapon&quot;, &quot;Damage&quot;, 0);
@@ -516,7 +520,7 @@
 
 int ConfedCargotran::activate_weapon()
 {
-	STACKTRACE
+  STACKTRACE;
 	if(fire_special) return(FALSE);
 
 	//Add weapon code here
@@ -529,7 +533,7 @@
 
 int ConfedCargotran::activate_special()
 {
-	STACKTRACE
+  STACKTRACE;
 	//Cuts loose all links and remembers that it did so.
 	if(Head==NULL)
 		return(FALSE);
@@ -551,7 +555,7 @@
 
 void ConfedCargotran::animate(Frame *space)
 {
-	STACKTRACE
+  STACKTRACE;
 	double back_x=size.x/3.60, back_y=-size.y/2.33,
 	       frnt_x=size.x/5.55, frnt_y=+size.y/17.01,
 	       back_y_1=-size.y/2.06;
@@ -588,7 +592,7 @@
 
 void ConfedCargotran::calculate()
 {
-	STACKTRACE
+  STACKTRACE;
 	Ship::calculate();
 
 }
@@ -596,7 +600,7 @@
 
 void ConfedCargotran::inflict_damage(SpaceObject *other)
 {
-	STACKTRACE;
+  STACKTRACE;
 	if (!(other &amp;&amp; other-&gt;exists()))
 		return;
 

Modified: branches/multiplayer-branch/source/ships/shpconho.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpconho.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ships/shpconho.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 #include &quot;melee/mmain.h&quot;
 #include &quot;melee/mcbodies.h&quot;
@@ -78,6 +77,7 @@
 		ShipData *shipData, unsigned int code) :
   Ship(opos, shipAngle, shipData, code)
 {
+  STACKTRACE;
   regenrateFrames = get_config_int(&quot;Extra&quot;, &quot;Frames&quot;, 0);
   regenrating     = FALSE;
   regenrateAmount = get_config_int(&quot;Extra&quot;, &quot;RechargeAmount&quot;, 0);
@@ -114,7 +114,7 @@
 }
 
 int ConfederationHornet::activate_weapon() {
-	STACKTRACE
+  STACKTRACE;
   add(new Missile(this, Vector2(7,35),
     angle, weaponVelocity, weaponDamage, weaponRange, weaponArmour,
     this, data-&gt;spriteWeapon));
@@ -126,7 +126,7 @@
 
 int ConfederationHornet::activate_special()
 {
-	STACKTRACE
+  STACKTRACE;
   add(new TorpedoMissile(0.0, (size.y / 2.0),
     angle, specialVelocity, specialDamage, specialDDamage, specialRange, specialArmour, specialTurnRate, this, this, data-&gt;spriteSpecial, target));
   return(TRUE);
@@ -134,7 +134,7 @@
 
 void ConfederationHornet::calculate()
 {
-	STACKTRACE;
+  STACKTRACE;
 
 //   int shield_color = 9; // Blue
 //   int i, bar_x, bar_y, shield_panel;
@@ -183,7 +183,7 @@
 }
 
 int ConfederationHornet::handle_damage(SpaceLocation *source, double normal, double direct) {
-	STACKTRACE
+  STACKTRACE;
    if ((normal - shield) &lt;= 0) {
      shield -= iround(normal);
 	 normal = 0;
@@ -197,6 +197,7 @@
 
 RGB ConfederationHornet::crewPanelColor(int k)
 {
+  STACKTRACE;
 	RGB c1 = {0,255,0};
 	RGB c2 = {0,0,255};		// blue
 
@@ -209,6 +210,7 @@
 // returns the &quot;real&quot; live crew (this can fool the Syreen).
 double ConfederationHornet::getCrew()
 {
+  STACKTRACE;
 	if (crew)
 		return 1;
 	else
@@ -225,10 +227,11 @@
   HomingMissile(creator, Vector2(ox,oy), oangle, ov, odamage, orange, oarmour, otrate, opos, osprite, otarget),
   Direct_Damage(oddamage)
 {
+  STACKTRACE;
 }
 
 void TorpedoMissile::inflict_damage(SpaceObject *other) {
-	STACKTRACE
+  STACKTRACE;
 	damage(other, 0, Direct_Damage);
   HomingMissile::inflict_damage(other);
 }

Modified: branches/multiplayer-branch/source/ships/shpdragr.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpdragr.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ships/shpdragr.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -17,7 +17,6 @@
 
 #include &lt;assert.h&gt;
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 #include &quot;frame.h&quot;
 
@@ -76,6 +75,7 @@
 						 ShipData *shipData, unsigned int code) :
   Ship(opos, shipAngle, shipData, code)
 {
+  STACKTRACE;
 
   weaponRange    = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
   weaponVelocity = scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
@@ -102,7 +102,7 @@
 
 int DraxGryphon::activate_weapon()
 {
-	STACKTRACE;
+  STACKTRACE;
   weaponoffset++;
 
   if (weaponoffset &gt; 3)
@@ -119,9 +119,8 @@
 
 int DraxGryphon::activate_special()
 {
+  STACKTRACE;
 
-	STACKTRACE;
-
 	if (numMines == maxMines) {
 	  weaponObject[0]-&gt;state = 0;
 	  numMines -= 1;
@@ -140,7 +139,7 @@
 
 void DraxGryphon::calculate()
 {
-STACKTRACE;
+  STACKTRACE;
 
    int j = 0;
    for (int i = 0; i &lt; numMines; i += 1) {
@@ -161,6 +160,7 @@
     AnimatedShot(oship, Vector2(ox,oy), oangle, ov, odamage, -1.0, oarmour, oship,
       osprite, ofcount, ofsize)
 {
+  STACKTRACE;
   MineMoving = TRUE;
   MineRange = miner;
   MineTimer = minet;
@@ -172,9 +172,8 @@
 }
 
 void DraxMine::calculate() {
+  STACKTRACE;
 
-	STACKTRACE;
-
 	AnimatedShot::calculate();
 
 	if (!exists()) return;
@@ -241,8 +240,7 @@
 }
 
 void DraxMine::inflict_damage(SpaceObject *other) {
-
-	STACKTRACE;
+  STACKTRACE;
   if (other-&gt;isShip())
      damage_factor = 0;
 

Modified: branches/multiplayer-branch/source/ships/shpearc3.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpearc3.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ships/shpearc3.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -17,7 +17,6 @@
 
 #include &quot;ship.h&quot;
 #include &quot;util/aastr.h&quot;
-REGISTER_FILE
 
 class EarthlingCruiserMk3Beam;
 
@@ -80,6 +79,7 @@
 		ShipData *shipData, unsigned int code) :
 	Ship(opos, shipAngle, shipData, code)
 {
+  STACKTRACE;
 	weaponRange			= scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
 	weaponVelocity		= scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
 	weaponDamage		= get_config_int(&quot;Weapon&quot;, &quot;Damage&quot;, 0);
@@ -102,7 +102,7 @@
 
 void EarthlingCruiserMk3::calculate()
 {
-	STACKTRACE;
+  STACKTRACE;
 	Ship::calculate();
 
 	double track_angle = 0;
@@ -149,7 +149,7 @@
 
 int EarthlingCruiserMk3::activate_weapon()
 {
-	STACKTRACE;
+  STACKTRACE;
 	add(new EarthlingCruiserMk3Shot(this, Vector2(0.0, 28.0),
 		normalize(angle + launch_angle + turn_step + tw_random(-weaponSpread, +weaponSpread), PI2),
 		weaponVelocity,	weaponDamage, weaponRange, weaponArmour, data-&gt;spriteWeapon));
@@ -158,41 +158,44 @@
 
 int EarthlingCruiserMk3::activate_special()
 {
-	STACKTRACE;
-	bool fire = false;;
-	SpaceObject *o;
-	double rng = 1e40;
-	SpaceObject *tgt = NULL;
-
-	pos -= unit_vector(angle) * 6;	//!!!
-	Query q;
-	for (q.begin(this, bit(LAYER_SHIPS) + bit(LAYER_SHOTS) + bit(LAYER_SPECIAL) + 
-			bit(LAYER_CBODIES), specialRange); q.current; q.next()) {
-		o = q.currento;
-		if (!o-&gt;isInvisible() &amp;&amp; !o-&gt;sameTeam(this)	&amp;&amp; (o-&gt;collide_flag_anyone&amp;bit(LAYER_LINES))
-				&amp;&amp; (distance(o) &lt; rng)) {
-			tgt = o;
-			rng = distance(o);
-		}
-	}
-	q.end();
-	pos += unit_vector(angle) * 6;	//!!!
-
-	if (tgt) {
-		game-&gt;add(new EarthlingCruiserMk3Beam(this, Vector2(0,-6), specialRange,
-				specialDamage, specialDamageShots, specialFrames, tgt));
-		play_sound(data-&gt;sampleSpecial[0]);
-		fire = true; }
-
-	return(fire);
+  STACKTRACE;
+  bool fire = false;;
+  SpaceObject *o;
+  double rng = 1e40;
+  SpaceObject *tgt = NULL;
+  
+  pos -= unit_vector(angle) * 6;	//!!!
+  Query q;
+  for (q.begin(this, bit(LAYER_SHIPS) + bit(LAYER_SHOTS) + bit(LAYER_SPECIAL) + 
+	       bit(LAYER_CBODIES), specialRange); q.current; q.next()) {
+    o = q.currento;
+    if (!o-&gt;isInvisible() &amp;&amp; !o-&gt;sameTeam(this)	&amp;&amp; (o-&gt;collide_flag_anyone&amp;bit(LAYER_LINES))
+	&amp;&amp; (distance(o) &lt; rng)) 
+      {
+	tgt = o;
+	rng = distance(o);
+      }
+  }
+  q.end();
+  pos += unit_vector(angle) * 6;	//!!!
+  
+  if (tgt) 
+    {
+      game-&gt;add(new EarthlingCruiserMk3Beam(this, Vector2(0,-6), specialRange,
+					    specialDamage, specialDamageShots, 
+					    specialFrames, tgt));
+	    tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleSpecial[0]));
+	    fire = true; 
+    }
+  
+  return(fire);
 }
 
-
-
 EarthlingCruiserMk3Shot::EarthlingCruiserMk3Shot(SpaceLocation *creator, Vector2 opos, double oangle,
 		double ov, double odamage, double orange, double oarmour, SpaceSprite *osprite) :
 	Shot(creator, opos, oangle, ov, odamage, orange, oarmour, creator, osprite)
 {
+  STACKTRACE;
 	explosionSprite     = data-&gt;spriteWeaponExplosion;
 	explosionFrameCount = 20;
 	explosionFrameSize  = 25;
@@ -200,22 +203,22 @@
 	sprite_index = 32;
 
 	attributes &amp;= ~ATTRIB_STANDARD_INDEX;
-	play_sound(data-&gt;sampleWeapon[0]);
+	tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleWeapon[0]));
 }
 
 
 void EarthlingCruiserMk3Shot::animate(Frame *space)
 {
-	STACKTRACE;
-	if (exists())
-		sprite-&gt;animate(pos, sprite_index = (int)(31.99 * d / range), space);
+  STACKTRACE;
+  if (exists())
+    sprite-&gt;animate(pos, sprite_index = (int)(31.99 * d / range), space);
 }
 
 void EarthlingCruiserMk3Shot::soundExplosion()
 {
-	STACKTRACE;
-	play_sound(explosionSample);
-	return;
+  STACKTRACE;
+  tw_sound-&gt;play_sound(data_full_path(explosionSample));
+  return;
 }
 
 
@@ -226,6 +229,7 @@
 	frame(0), frame_count(lfcount), lpos(creator), rel_pos(rpos), damage_shots(sdamage)
 
 {
+  STACKTRACE;
 	set_depth(DEPTH_EXPLOSIONS);
 	target = tgt;
 	base_length = length;
@@ -250,7 +254,7 @@
 
 void EarthlingCruiserMk3Beam::calculate()
 {
-	STACKTRACE;
+  STACKTRACE;
 	if(!(lpos &amp;&amp; lpos-&gt;exists()))
 	{
 		lpos = 0;
@@ -305,7 +309,7 @@
 
 void EarthlingCruiserMk3Beam::inflict_damage(SpaceObject *other)
 {
-	STACKTRACE;
+  STACKTRACE;
 	if (other-&gt;isShot())
 		damage(other, damage_shots*frame_time/frame_count);
 	else
@@ -314,7 +318,7 @@
 	int aa = get_tw_aa_mode();
 	if (!((aa &amp; AA_BLEND) &amp;&amp; (aa &amp; AA_ALPHA) &amp;&amp; (!got_spark) &amp;&amp; !(aa &amp; AA_NO_AA))) {
 		physics-&gt;add(new Animation( this, 
-				pos + edge(), meleedata.sparkSprite, 0, 
+				pos + edge(), game-&gt;meleedata.sparkSprite, 0, 
 				SPARK_FRAMES, 50, DEPTH_EXPLOSIONS));
 		got_spark = true; }
 
@@ -323,7 +327,7 @@
 
 void EarthlingCruiserMk3Beam::animate(Frame *space)
 {
-	STACKTRACE;
+  STACKTRACE;
 	int aa = get_tw_aa_mode();
 	SpaceLine::animate(space);
 	if ((aa &amp; AA_BLEND) &amp;&amp; (aa &amp; AA_ALPHA) &amp;&amp; !(aa &amp; AA_NO_AA) &amp;&amp; (length &lt; base_length*0.9999) &amp;&amp; (target)) {

Modified: branches/multiplayer-branch/source/ships/shpforsh.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpforsh.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ships/shpforsh.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -18,7 +18,6 @@
 //ForevianShocker lousy code by <A HREF="https://lists.berlios.de/mailman/listinfo/tw-light-svn">Richardyzo at ig.com.br</A>
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 class ForevianShocker : public Ship
 {	double		weaponRange, weaponVelocity;
@@ -59,6 +58,7 @@
 ForevianShocker::ForevianShocker(Vector2 opos, double shipAngle, ShipData *shipData, unsigned int code) :
 	Ship(opos, shipAngle, shipData, code)
 {
+  STACKTRACE;
 	weaponRange		= scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0)); 
 	weaponVelocity	= scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
 	weaponDamage	= get_config_int(&quot;Weapon&quot;, &quot;Damage&quot;, 0); 
@@ -91,116 +91,159 @@
 
 int ForevianShocker::activate_weapon()
 {
-	STACKTRACE
-
-	SpaceSprite *tmp_s = data-&gt;spriteWeapon;
-	if (weapon_type==2)	tmp_s = data-&gt;spriteExtra;
-	play_sound2(data-&gt;sampleWeapon[0]);
-	if (weapon_type == 0) {
-		if(random()%2)
-			tmp_s = data-&gt;spriteExtra;
-		add(new AnimatedShot(this, Vector2(27.0,20.0), angle , weaponVelocity,	weaponDamage, weaponRange, weaponArmour, this, tmp_s, 32, weapon_frame_size, 1.0));
-		if (weapon_type == 0) {
-			if(random()%2)	tmp_s = data-&gt;spriteExtra;
-			else	tmp_s = data-&gt;spriteWeapon; } }
-	add(new AnimatedShot(this, Vector2(-27.0,20.0), angle , weaponVelocity,	weaponDamage, weaponRange, weaponArmour, this, tmp_s, 32, weapon_frame_size, 1.0));	return(TRUE);
+  STACKTRACE;
+  SpaceSprite *tmp_s = data-&gt;spriteWeapon;
+  if (weapon_type==2)	
+    tmp_s = data-&gt;spriteExtra;
+  tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleWeapon[0]));
+  tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleWeapon[0]));
+	
+  if (weapon_type == 0) 
+    {
+      if(random()%2)
+	tmp_s = data-&gt;spriteExtra;
+      add(new AnimatedShot(this, Vector2(27.0,20.0), angle , weaponVelocity,	
+			   weaponDamage, weaponRange, weaponArmour, this, tmp_s, 
+			   32, weapon_frame_size, 1.0));
+      if (weapon_type == 0) 
+	{
+	  if(random()%2)	
+	    tmp_s = data-&gt;spriteExtra;
+	  else	
+	    tmp_s = data-&gt;spriteWeapon; 
+	} 
+    }
+  add(new AnimatedShot(this, Vector2(-27.0,20.0), angle , weaponVelocity,	
+		       weaponDamage, weaponRange, weaponArmour, this, tmp_s, 32, 
+		       weapon_frame_size, 1.0));	
+  return(TRUE);
 }
 
 int ForevianShocker::activate_special()
 {
-	STACKTRACE
-	if(shockingFrames == 0) {
-		play_sound2(data-&gt;sampleSpecial[0]);
-		shockingFrames = specialFrames;
-		shockVar = 1;
-		recharge_amount = 0; }
-	return true;
+  STACKTRACE;
+  if(shockingFrames == 0) 
+    {
+      tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleSpecial[0]));
+      tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleSpecial[0]));
+      shockingFrames = specialFrames;
+      shockVar = 1;
+      recharge_amount = 0; 
+    }
+  return true;
 }
 
 void ForevianShocker::calculate()
 {
-	STACKTRACE
-	if(shockVar == 1)
+  STACKTRACE;
+  if(shockVar == 1)
+    {
+      if(shockingFrames &gt; 0)
+	shockingFrames -= frame_time;
+      
+      if(shockVar &amp;&amp; shockingFrames == 2500 )
 	{
-		if(shockingFrames &gt; 0)
-			shockingFrames -= frame_time;
-		
-		//if(shockVar &amp;&amp; shockingFrames &lt;= 2500 )
-		if(shockVar &amp;&amp; shockingFrames == 2500 )
-		{
-			add( new FixedAnimation(this, this, data-&gt;spriteSpecial, 0, 6, 30, LAYER_EXPLOSIONS));
-		}
-		if(shockingFrames == 2000 )
-		{
-			play_sound2(data-&gt;sampleSpecial[0]);
-			add( new FixedAnimation(this, this, data-&gt;spriteSpecial, 0, 6, 30, LAYER_EXPLOSIONS));
-		}
-		if(shockingFrames == 1500 )
-		{
-			play_sound2(data-&gt;sampleSpecial[0]);
-			add( new FixedAnimation(this, this, data-&gt;spriteSpecial, 0, 6, 30, LAYER_EXPLOSIONS));
-		}
-		if(shockingFrames == 1000 )
-		{
-			play_sound2(data-&gt;sampleSpecial[0]);
-			add( new FixedAnimation(this, this, data-&gt;spriteSpecial, 0, 6, 30, LAYER_EXPLOSIONS));
-		}
-		if(shockingFrames == 500 )
-		{
-			play_sound2(data-&gt;sampleSpecial[0]);
-			add( new FixedAnimation(this, this, data-&gt;spriteSpecial, 0, 6, 30, LAYER_EXPLOSIONS));
-		}
-		if(shockingFrames == 50 )
-		{
-			play_sound2(data-&gt;sampleSpecial[1]);
-			
-			add( new ForevianShockwave(0, 70, angle , specialVelocity, specialDamage, specialRange, specialArmour, this, this, special_sprite, special_frame_num, special_frame_size, specialLoss));
-			
-			shockingFrames = 0;
-			shockVar = 0;
-			recharge_amount = 1;
-		}
+	  add( new FixedAnimation(this, this, data-&gt;spriteSpecial, 0, 6, 30, LAYER_EXPLOSIONS));
 	}
-	
-	Ship::calculate();
+      if(shockingFrames == 2000 )
+	{
+	  tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleSpecial[0]));
+	  tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleSpecial[0]));
+
+	  add( new FixedAnimation(this, this, data-&gt;spriteSpecial, 0, 6, 30, LAYER_EXPLOSIONS));
+	}
+      if(shockingFrames == 1500 )
+	{
+	  tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleSpecial[0]));
+	  tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleSpecial[0]));
+	  
+	  add( new FixedAnimation(this, this, data-&gt;spriteSpecial, 0, 6, 30, LAYER_EXPLOSIONS));
+	}
+      if(shockingFrames == 1000 )
+	{
+	  tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleSpecial[0]));
+	  tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleSpecial[0]));
+	  
+	  add( new FixedAnimation(this, this, data-&gt;spriteSpecial, 0, 6, 30, LAYER_EXPLOSIONS));
+	}
+      if(shockingFrames == 500 )
+	{
+	  tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleSpecial[0]));
+	  tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleSpecial[0]));
+	  
+	  add( new FixedAnimation(this, this, data-&gt;spriteSpecial, 0, 6, 30, LAYER_EXPLOSIONS));
+	}
+      if(shockingFrames == 50 )
+	{
+	  tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleSpecial[1]));
+	  tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleSpecial[1]));
+	  
+	  add( new ForevianShockwave(0, 70, angle , specialVelocity, specialDamage, 
+				     specialRange, specialArmour, this, this, special_sprite, 
+				     special_frame_num, special_frame_size, specialLoss));
+	  
+	  shockingFrames = 0;
+	  shockVar = 0;
+	  recharge_amount = 1;
+	}
+    }
+  
+  Ship::calculate();
 }
 
-ForevianShockwave::ForevianShockwave(double ox, double oy, double oangle, double ov, int odamage, double orange, int oarmour, Ship *oship, SpaceLocation *opos, SpaceSprite *osprite, int ofcount, int ofsize, int ol) :
-	AnimatedShot(oship, Vector2(ox,oy), oangle, ov, odamage, orange, oarmour, oship, osprite, ofcount, ofsize)
-{ 
-	collide_flag_anyone = OBJECT_LAYERS&amp;~bit(LAYER_SHOTS);
-	collide_flag_sameship = collide_flag_anyone;
-	last_hit = oship;
-	loss = ol;
+ForevianShockwave::ForevianShockwave(double ox, double oy, double oangle, double ov, 
+				     int odamage, double orange, int oarmour, Ship *oship, 
+				     SpaceLocation *opos, SpaceSprite *osprite, int ofcount, 
+				     int ofsize, int ol) :
+  AnimatedShot(oship, Vector2(ox,oy), oangle, ov, odamage, orange, 
+	       oarmour, oship, osprite, ofcount, ofsize)
+{
+  STACKTRACE; 
+  collide_flag_anyone = OBJECT_LAYERS&amp;~bit(LAYER_SHOTS);
+  collide_flag_sameship = collide_flag_anyone;
+  last_hit = oship;
+  loss = ol;
 }
 
 void ForevianShockwave::inflict_damage(SpaceObject *other)
-{	
-	STACKTRACE
-	if (other==last_hit)
-		return;
-	play_sound2(data-&gt;sampleSpecial[2]);
-	if (!other-&gt;sameShip(this))
-		damage(other, 0, damage_factor);
-	add( new Animation(this, pos, data-&gt;spriteSpecial, 0, 6, 30, LAYER_EXPLOSIONS));
-	if ((damage_factor-=loss) &lt;= 0) {
-		die(); return; }
+{
+  STACKTRACE;	
+  if (other==last_hit)
+    return;
+  
+  tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleSpecial[2]));
+  tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleSpecial[2]));
+	  
+  if (!other-&gt;sameShip(this))
+    damage(other, 0, damage_factor);
+  add( new Animation(this, pos, data-&gt;spriteSpecial, 0, 6, 30, LAYER_EXPLOSIONS));
+  if ((damage_factor-=loss) &lt;= 0) 
+    {
+      die(); return; 
+    }
 	
-	last_hit=other;
+  last_hit=other;
 
-	Query q;
-	double r0=1e40;
-	SpaceObject *tgt = NULL;
-	for (q.begin(this, OBJECT_LAYERS&amp;~bit(LAYER_SHOTS), range-d); q.currento; q.next()) {
-		if ((q.currento==last_hit) || q.currento-&gt;isPlanet() || !(q.currento-&gt;canCollide(this)&amp;&amp;canCollide(q.currento)) ) continue;	if (distance(q.currento)&lt;r0) {
-			tgt = q.currento;
-			r0 = distance(tgt); } }
-	q.end();
+  Query q;
+  double r0=1e40;
+  SpaceObject *tgt = NULL;
+  for (q.begin(this, OBJECT_LAYERS&amp;~bit(LAYER_SHOTS), range-d); q.currento; q.next()) 
+    {
+      if ((q.currento==last_hit) || q.currento-&gt;isPlanet() || 
+	  !(q.currento-&gt;canCollide(this)&amp;&amp;canCollide(q.currento)) ) 
+	continue;	
+      if (distance(q.currento)&lt;r0) 
+	{
+	  tgt = q.currento;
+	  r0 = distance(tgt); 
+	} 
+    }
+  q.end();
 
-	if (tgt)
-		changeDirection(trajectory_angle(tgt));
+  if (tgt)
+    changeDirection(trajectory_angle(tgt));
 
-	return;
+  return;
 }
 
 

Modified: branches/multiplayer-branch/source/ships/shpgarty.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpgarty.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ships/shpgarty.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -17,8 +17,6 @@
 
 #include &quot;ship.h&quot;
 
-REGISTER_FILE
-
 class GarashTyrant : public Ship {
   double       weaponVelocity;
   int          weaponDamage;
@@ -118,6 +116,7 @@
 	:
 	Ship(opos, shipAngle, shipData, code)
 {
+  STACKTRACE;
 
 	weaponDamage					 = get_config_int(&quot;Weapon&quot;, &quot;Damage&quot;, 8);
 	weaponArmour					 = get_config_int(&quot;Weapon&quot;, &quot;Armour&quot;, 8);
@@ -147,7 +146,7 @@
 
 void GarashTyrant::calculate()
 {
-	STACKTRACE
+  STACKTRACE;
 
 if (!fire_weapon  &amp;&amp;
 		!fire_special &amp;&amp;
@@ -227,7 +226,7 @@
 }
 
 void GarashTyrant::stun_ship(SpaceObject *other){
-	STACKTRACE
+  STACKTRACE;
   GarashRepulsarStun* GRS;
   if (other-&gt;state==0) return;
 	if (other-&gt;isShip()) {
@@ -244,7 +243,7 @@
 
 void GarashTyrant::calculate_fire_weapon()
 	{
-	STACKTRACE
+  STACKTRACE;
 	weapon_low = FALSE;
 
 	if (fire_weapon) {
@@ -270,7 +269,7 @@
 
 int GarashTyrant::activate_weapon()
 {
-	STACKTRACE
+  STACKTRACE;
   if(weaponObject)
     return(FALSE);
 
@@ -283,6 +282,7 @@
 }
 
 int GarashTyrant::activate_special() {
+  STACKTRACE;
 
 	repulse = true;
 
@@ -296,6 +296,7 @@
   ship(oship), stunframe(0), stunframe_count(stunFrames),
   frame_step(0), frame_size(ofsize), frame_count(ofcount)
 {
+  STACKTRACE;
   targetIsDead = FALSE;
 	collide_flag_anyone = 0;
 	layer = LAYER_EXPLOSIONS;
@@ -303,7 +304,7 @@
 }
 
 void GarashRepulsarStun::calculate() {
-	STACKTRACE
+  STACKTRACE;
   if(!ship) targetIsDead = TRUE;
   else {
     if(!ship-&gt;exists()) targetIsDead = TRUE;
@@ -362,6 +363,7 @@
 	CD(oChargingDistance),
 	CDD(oChargingDistanceDamage)
 {
+  STACKTRACE;
 	  vel = ship-&gt;get_vel();
 
 	Timer  = 0;
@@ -378,144 +380,159 @@
 
 }
 
-void GarashShot::calculate() {
-	STACKTRACE
+void GarashShot::calculate() 
+{
+  STACKTRACE;
+  if(released) 
+    Shot::calculate();
+  else SpaceObject::calculate();
+  
+  if (!exists()) 
+    return;
 
-	if(released) Shot::calculate();
-	else SpaceObject::calculate();
+  if (!done_once)
+    {
+      tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleExtra[0])); //charge
+      done_once=TRUE;
+    }
 
-	if (!exists()) return;
-
-	if (!done_once)
-		{
-			play_sound(data-&gt;sampleExtra[0]); //charge
-			done_once=TRUE;
-		}
-
-
-	frame_step += frame_time;
-	if(frame_step &gt;= frame_size) { //1
-		frame_step -= frame_size;
-		frame++;
-		if(frame == frame_count) { //2
-			frame = 0;
-
-			if(!released)  { //3
-				charge_frame++;
-				if(charge_frame == 5) { //4
-			    play_sound(data-&gt;sampleExtra[0]); //charge
-					charge_frame = 0;
-					charge_phase++;
-					damage_factor += Charge;
-					armour += Charge;
-					range  += scale_range(Charge);
-					} //4
-				} //3
-			} //2
-		} //1
-
-	if(!released) {
-
-		if (!ship || !ship-&gt;fire_weapon || Timer &gt; MaxTL) {
-			vel = unit_vector(angle) * v;
-			released = TRUE;
-			if (Timer &gt; MinTL)
-				play_sound(data-&gt;sampleWeapon[0]); //shoot
-			}
-		else {
-			angle = ship-&gt;get_angle();
-			pos = ship-&gt;normal_pos() + unit_vector(angle) * ship-&gt;size.y/2.6;
-			vel = ship-&gt;get_vel();
-		}
-
-		StartC = pos;
-
-		if (ship)
-			{ int sprite_phase = charge_phase;
-		  if (sprite_phase &gt; 2)	sprite_phase = 2;
-			sprite_index = (get_index(ship-&gt;get_angle()) +
-										 (sprite_phase * 64));
-			}
-		 else released = TRUE;
-
-
-
-			Timer += frame_time;
-		} else if (Timer &lt; MinTL) {
-		    released=TRUE;
-				sound.stop(data-&gt;sampleExtra[0]);
-				play_sound2(data-&gt;sampleExtra[1]); //cancel if less than min time limit
-				state=0;
-				}
-
-
-	return;
+  frame_step += frame_time;
+  if(frame_step &gt;= frame_size) 
+    { 
+      frame_step -= frame_size;
+      frame++;
+      if(frame == frame_count) 
+	{ 
+	  frame = 0;
+	  
+	  if(!released)  
+	    { 
+	      charge_frame++;
+	      if(charge_frame == 5) 
+		{ 
+		  tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleExtra[0])); //charge
+		  charge_frame = 0;
+		  charge_phase++;
+		  damage_factor += Charge;
+		  armour += Charge;
+		  range  += scale_range(Charge);
+		} 
+	    } 
+	} 
+    }
+  
+  if(!released) 
+    {
+      
+      if (!ship || !ship-&gt;fire_weapon || Timer &gt; MaxTL) 
+	{
+	  vel = unit_vector(angle) * v;
+	  released = TRUE;
+	  if (Timer &gt; MinTL)
+	    {
+	      tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleWeapon[0])); //shoot
+	    }
 	}
+      else 
+	{
+	  angle = ship-&gt;get_angle();
+	  pos = ship-&gt;normal_pos() + unit_vector(angle) * ship-&gt;size.y/2.6;
+	  vel = ship-&gt;get_vel();
+	}
+      
+      StartC = pos;
+      
+      if (ship)
+	{ 
+	  int sprite_phase = charge_phase;
+	  if (sprite_phase &gt; 2)	
+	    sprite_phase = 2;
+	  sprite_index = (get_index(ship-&gt;get_angle()) +
+			  (sprite_phase * 64));
+	}
+      else released = TRUE;
+      
+      Timer += frame_time;
+    } 
+  else if (Timer &lt; MinTL) 
+    {
+      released=TRUE;
+      tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleExtra[0]));
+      tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleExtra[1])); //cancel if less than min time limit
+      tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleExtra[1])); //cancel if less than min time limit
+      
+      state=0;
+    }
+    
+  return;
+}
 
 void GarashShot::animateExplosion()
 {
-	return;
+  STACKTRACE;
+  return;
 }
 
 void GarashShot::inflict_damage(SpaceObject *other)
-	{
-	STACKTRACE
+{
+  STACKTRACE;
+  int Distance_Travelled = iround(distance_from(StartC, other-&gt;normal_pos()));
+  int AddDamage = iround((Distance_Travelled / CD) * CDD);
+  
+  
+  if (!ship_hit || !released)
+    damage (other ,damage_factor + AddDamage);
+  
+  if (!other-&gt;isShip() &amp;&amp;
+      !other-&gt;isPlanet() &amp;&amp; other-&gt;exists())
+    other-&gt;die();
+  
+  if (other-&gt;isShip()) 
+    {
+      ship_hit=TRUE;
+      if (other-&gt;mass &gt; 20 || !released)
+	state=0;
+    }
+  else 
+    ship_hit=FALSE;
+  
+  if (other-&gt;isShip() &amp;&amp; other-&gt;mass &gt; 0) 
+    {
+      animateExplosion();
+      soundExplosion();
+    }
 
-	int Distance_Travelled = iround(distance_from(StartC, other-&gt;normal_pos()));
-	int AddDamage = iround((Distance_Travelled / CD) * CDD);
+  if (other-&gt;mass &lt;= 0) 
+    return;
+  
+  if(other-&gt;isShip())
+    add(new FixedAnimation(this, other,
+			   explosionSprite, 0, explosionFrameCount,
+			   explosionFrameSize, LAYER_EXPLOSIONS));
+  
+  else
+    add(new Animation(this, pos,
+		      explosionSprite, 0, explosionFrameCount,
+		      explosionFrameSize, LAYER_EXPLOSIONS));
+  return;
+}
 
 
-	if (!ship_hit || !released)
-	  damage (other ,damage_factor + AddDamage);
-
-	if (!other-&gt;isShip() &amp;&amp;
-		  !other-&gt;isPlanet() &amp;&amp; other-&gt;exists())
-			other-&gt;die();
-
-
-	if (other-&gt;isShip()) {
-		ship_hit=TRUE;
-		if (other-&gt;mass &gt; 20 || !released)
-			 state=0;
-		}
-	 else ship_hit=FALSE;
-
-
-	if (other-&gt;isShip() &amp;&amp; other-&gt;mass &gt; 0) {
-		animateExplosion();
-		soundExplosion();
-	}
-
-		if (other-&gt;mass &lt;= 0) return;
-
-		if(other-&gt;isShip())
-			add(new FixedAnimation(this, other,
-				explosionSprite, 0, explosionFrameCount,
-				explosionFrameSize, LAYER_EXPLOSIONS));
-
-		else
-			add(new Animation(this, pos,
-				explosionSprite, 0, explosionFrameCount,
-				explosionFrameSize, LAYER_EXPLOSIONS));
-		return;
-	}
-
-
-
 int GarashShot::handle_damage(SpaceLocation *source, double normal, double direct)
 {
-	STACKTRACE
-	armour += damage_factor + direct ; // nullify damage
-	if (((!ship_hit &amp;&amp; !source-&gt;isShip()) ||
-			(ship_hit &amp;&amp; source-&gt;isShip())) &amp;&amp; !released)
-			play_sound(data-&gt;sampleExtra[2]);
-	Shot::handle_damage(source, normal, direct);
-	return 0;
+  STACKTRACE;
+  armour += damage_factor + direct ; // nullify damage
+  if (((!ship_hit &amp;&amp; !source-&gt;isShip()) ||
+       (ship_hit &amp;&amp; source-&gt;isShip())) &amp;&amp; !released)
+    tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleExtra[2]));
+  Shot::handle_damage(source, normal, direct);
+  return 0;
 }
 
 int GarashShot::canCollide(SpaceLocation *other)
-	{
-		return(TRUE);
-	}
+{
+  STACKTRACE;
+  return(TRUE);
+}
 REGISTER_SHIP(GarashTyrant)
-
+  

Modified: branches/multiplayer-branch/source/ships/shpilwsp.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpilwsp.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ships/shpilwsp.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 #include &quot;shpilwsp.h&quot;
 
@@ -83,6 +82,7 @@
 		ShipData *shipData, unsigned int code) :
   Ship(opos, shipAngle, shipData, code)
 {
+  STACKTRACE;
 
   weaponRange       = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
   weaponVelocity    = scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
@@ -99,7 +99,7 @@
 
 int IlwrathSpider::activate_weapon()
 {
-	STACKTRACE
+  STACKTRACE;
   game-&gt;add( new AnimatedShot( this, Vector2(size.x*0.12, size.y*0.35),
     angle + weaponAngle, weaponVelocity, weaponDamage, weaponRange, weaponArmour, this,
     data-&gt;spriteWeapon, data-&gt;spriteWeapon-&gt;frames(), ILWRATH_FIRE_ANIM_RATE, 1 ));
@@ -112,7 +112,7 @@
 
 int IlwrathSpider::activate_special()
 {
-	STACKTRACE;
+  STACKTRACE;
     double alpha = specialSpread / specialNumber;
     double beta = normalize( angle + PI - 0.5 * specialSpread + random(alpha), PI2 );
     double tx = cos( angle );
@@ -131,13 +131,13 @@
 
 void IlwrathSpider::calculate()
 {
-	STACKTRACE
+  STACKTRACE;
     Ship::calculate();
 }
 
 void IlwrathSpiderMine::calculate()
 {
-	STACKTRACE
+  STACKTRACE;
   double alpha = (-10 + random(21)) * ANGLE_RATIO;
   alpha *= randomness;
   angle += alpha * frame_time;
@@ -170,75 +170,96 @@
 
 void IlwrathSpiderMine::inflict_damage(SpaceObject *other)
 {
-	STACKTRACE
-    state = 0;
-
-    int freq;
-    if( other-&gt;isShot() ){
-        freq = (int)(magnitude_sqr(other-&gt;get_vel())*2000.0);
-    }else{
-        freq = 2000 - 80*(int)other-&gt;mass;
+  STACKTRACE;
+  state = 0;
+  
+  int freq;
+  if( other-&gt;isShot() )
+    {
+      freq = (int)(magnitude_sqr(other-&gt;get_vel())*2000.0);
     }
-    play_sound2( data-&gt;sampleExtra[0], 512, freq&lt;500?500:freq );
-    game-&gt;add( new FixedAnimation( this, other, data-&gt;spriteExtra, 0, data-&gt;spriteExtra-&gt;frames(), time_ratio, LAYER_EXPLOSIONS ));
+  else
+    {
+      freq = 2000 - 80*(int)other-&gt;mass;
+    }
 
-    if( other-&gt;vel != 0 ){
-		other-&gt;vel = 0;
-        if( other-&gt;isShip() ) ((Ship*)other)-&gt;nextkeys &amp;= ~(keyflag::thrust | keyflag::left | keyflag::right);
-
-        game-&gt;add( new IlwrathStop( this, other, stoptime ));
+  tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleExtra[0]));
+  tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleExtra[0])); 
+  game-&gt;add( new FixedAnimation( this, other, data-&gt;spriteExtra, 0, 
+				 data-&gt;spriteExtra-&gt;frames(), time_ratio, LAYER_EXPLOSIONS ));
+  
+  if( other-&gt;vel != 0 )
+    {
+      other-&gt;vel = 0;
+      if( other-&gt;isShip() ) ((Ship*)other)-&gt;nextkeys &amp;= ~(keyflag::thrust | 
+							  keyflag::left | keyflag::right);
+      game-&gt;add( new IlwrathStop( this, other, stoptime ));
     }
 }
 
-IlwrathSpiderMine::IlwrathSpiderMine( SpaceLocation *creator, double ox, double oy, double oangle, double v, int olife, double orandomness, int ostoptime, SpaceSprite* osprite ):
+IlwrathSpiderMine::IlwrathSpiderMine( SpaceLocation *creator, double ox, double oy, double oangle, 
+				      double v, int olife, double orandomness, int ostoptime, 
+				      SpaceSprite* osprite ):
   SpaceObject( creator, Vector2(ox,oy), oangle, osprite ),
   step( 0 ), life( olife ), inc( 1 ),
   randomness( orandomness ), stoptime( ostoptime )
 {
-	  layer = LAYER_SPECIAL;
-	vel = unit_vector(angle) * v;
+  STACKTRACE;
+  layer = LAYER_SPECIAL;
+  vel = unit_vector(angle) * v;
 }
 
 IlwrathStop::IlwrathStop( SpaceLocation* creator, SpaceObject* ovictim, int olife ):
   SpaceLocation( creator, 0, 0 ),
   victim( ovictim ), life( olife )
 {
-  if( victim ){
-    if( !victim-&gt;exists() ){
-      victim = 0;
-      state = 0;
-    }else{
-      if( victim-&gt;isShot() ){
-        old_v = ((Shot*)victim)-&gt;v;
-        ((Shot*)victim)-&gt;v = 0;
-      }else{
-        old_v = 0;
-      }
+  STACKTRACE;
+  if( victim )
+    {
+      if( !victim-&gt;exists() )
+	{
+	  victim = 0;
+	  state = 0;
+	}
+      else
+	{
+	  if( victim-&gt;isShot() )
+	    {
+	      old_v = ((Shot*)victim)-&gt;v;
+	      ((Shot*)victim)-&gt;v = 0;
+	    }
+	  else
+	    {
+	      old_v = 0;
+	    }
+	}
     }
-  }
 }
 
 void IlwrathStop::calculate()
 {
-	STACKTRACE
+  STACKTRACE;
   SpaceLocation::calculate();
   if( !(victim &amp;&amp; victim-&gt;exists()) )
-  {
-    victim = 0;
-    state = 0;
-    return;
-  }
-  if( victim-&gt;isShip() ) ((Ship*)victim)-&gt;nextkeys &amp;= ~(keyflag::thrust | keyflag::left | keyflag::right);
+    {
+      victim = 0;
+      state = 0;
+      return;
+    }
+  if( victim-&gt;isShip() ) 
+    ((Ship*)victim)-&gt;nextkeys &amp;= ~(keyflag::thrust | keyflag::left | keyflag::right);
   victim-&gt;vel = 0;
-
+  
   life -= frame_time;
-  if( life &lt;= 0 ){
-    state = 0;
-    if( victim-&gt;isShot() ){
-      ((Shot*)victim)-&gt;v = old_v;
+  if( life &lt;= 0 )
+    {
+      state = 0;
+      if( victim-&gt;isShot() )
+	{
+	  ((Shot*)victim)-&gt;v = old_v;
 	  victim-&gt;vel = old_v * unit_vector(victim-&gt;get_angle());
+	}
     }
-  }
 }
 
 REGISTER_SHIP(IlwrathSpider)

Modified: branches/multiplayer-branch/source/ships/shpkahbo.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpkahbo.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ships/shpkahbo.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 #include &quot;melee/mmain.h&quot;
 
@@ -142,6 +141,7 @@
 	:
   Ship(opos, shipAngle, shipData, code)
 {
+  STACKTRACE;
   weapon1Range    = scale_range(get_config_float(&quot;WeaponS&quot;, &quot;Range&quot;, 0));
   weapon1Turn     = scale_turning(get_config_float(&quot;WeaponS&quot;,&quot;Turn&quot;, 0));
   weapon1Velocity = scale_velocity(get_config_float(&quot;WeaponS&quot;, &quot;Velocity&quot;, 0));
@@ -175,7 +175,7 @@
 
 int KahrBoomerang::activate_weapon()
 {
-	STACKTRACE
+  STACKTRACE;
   int chance;
   int answer = FALSE;
   if (weaponChoice == SMALL_BOOMERANG) {
@@ -210,7 +210,7 @@
 
 int KahrBoomerang::activate_special()
 {
-	STACKTRACE
+  STACKTRACE;
   int answer;
   if (weaponChoice == SMALL_BOOMERANG) {
     weapon_drain = weapon2Drain;
@@ -233,7 +233,7 @@
 
 void KahrBoomerang::calculate()
 {
-	STACKTRACE
+  STACKTRACE;
   if ((boomerangL != NULL) &amp;&amp; (!boomerangL-&gt;exists()))
     boomerangL=NULL;
   Ship::calculate();
@@ -249,7 +249,7 @@
 
 void KahrBoomerang::calculate_fire_special()
 {
-	STACKTRACE
+  STACKTRACE;
   if (weaponChoice == SMALL_BOOMERANG) {
     blit(this-&gt;spritePanel-&gt;get_bitmap(7), this-&gt;spritePanel-&gt;get_bitmap(1), 36, 0, 36, 0, 19, 30);
     blit(this-&gt;spritePanel-&gt;get_bitmap(7), this-&gt;spritePanel-&gt;get_bitmap(2), 36, 0, 36, 0, 19, 30);
@@ -280,6 +280,7 @@
 	Shot(oship, Vector2(ox,oy), oangle, ov, odamage, -1.0 , oarmour, oship, osprite)
 
 {
+  STACKTRACE;
   mass = 0.25;
   frame = 0;
   frame_step = 0;
@@ -294,7 +295,7 @@
 
 void KahrSmall::calculate()
 {
-	STACKTRACE
+  STACKTRACE;
 	if (!(ship &amp;&amp; ship-&gt;exists()))
 	{
 		state = 0;
@@ -335,7 +336,7 @@
 
 void KahrSmall::inflict_damage(SpaceObject *other)
 {
-	STACKTRACE
+  STACKTRACE;
 	if (other == ship) {
 		state = 0;
 		mass = 0;
@@ -354,6 +355,7 @@
 	Shot(oship, Vector2(ox,oy), oangle, ov, odamage, -1.0 , oarmour, oship, osprite)
 
 {
+  STACKTRACE;
   mass = 3.0;
   frame = 0;
   frame_step = 0;
@@ -369,13 +371,13 @@
 }
 
 void KahrMedium::death() {
-	STACKTRACE;
+  STACKTRACE;
 	if (kahrship) (kahrship)-&gt;num_medium_boomerangs -= 1;
 	Shot::death();
 	}
 
 void KahrMedium::calculate() {
-	STACKTRACE
+  STACKTRACE;
 	if (!(ship &amp;&amp; ship-&gt;exists()))
 	{
 		state = 0;
@@ -419,7 +421,7 @@
 
 void KahrMedium::inflict_damage(SpaceObject *other)
 {
-	STACKTRACE
+  STACKTRACE;
 	if (other == ship) {
 		state = 0;
 		mass = 0;
@@ -438,6 +440,7 @@
 	Shot(oship, Vector2(ox,oy), oangle, ov, odamage, -1.0 , oarmour, oship, osprite)
 
 {
+  STACKTRACE;
   mass =5.0;
   frame = 0;
   frame_step = 0;
@@ -452,7 +455,7 @@
 
 void KahrLarge::calculate()
 {
-	STACKTRACE
+  STACKTRACE;
 	if (!(ship &amp;&amp; ship-&gt;exists()))
 	{
 		state = 0;
@@ -491,7 +494,7 @@
 
 void KahrLarge::inflict_damage(SpaceObject *other)
 {
-	STACKTRACE
+  STACKTRACE;
 	if (other == ship) {
 		state = 0;
 		mass = 0;
@@ -506,7 +509,7 @@
 
 int KahrLarge::handle_damage(SpaceLocation *source, double normal, double direct)
 {
-	STACKTRACE
+  STACKTRACE;
   return Shot::handle_damage(source, 0, 0);
 }
 

Modified: branches/multiplayer-branch/source/ships/shprogsq.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shprogsq.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ships/shprogsq.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -15,8 +15,8 @@
 GNU General Public License for more details.
 */
 
+#include &quot;util/sound.h&quot;
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 #include &quot;util/aastr.h&quot;
 
@@ -24,8 +24,8 @@
 #include &lt;stdio.h&gt;
 
 #include &quot;melee/mview.h&quot;
+#include &quot;scp.h&quot;
 
-
 /*
 rogsc
 
@@ -144,6 +144,7 @@
 :
 Ship(opos, angle, data, code)
 {
+  STACKTRACE;
 	
 	weaponRange    = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
 	weaponDamage   = get_config_int(&quot;Weapon&quot;, &quot;Damage&quot;, 0);
@@ -215,7 +216,7 @@
 // This is called just before the first calculate(), after the ship phases into battle
 void RogueSquadron::materialize()
 {
-	STACKTRACE
+  STACKTRACE;
 	int i;
 
 	formation = 0;
@@ -266,6 +267,7 @@
 
 int RogueSquadron::activate_weapon()
 {
+  STACKTRACE;
 	// all ships fire a pulse laser:
 	fire_main = 1;
 	return TRUE;
@@ -274,8 +276,7 @@
 
 int RogueSquadron::activate_special()
 {
-
-	STACKTRACE
+  STACKTRACE;
 	int	i;
 
 	// first of all, clean up the old formation.
@@ -324,8 +325,8 @@
 
 
 void RogueSquadron::calculate()
-{	
-	STACKTRACE
+{
+  STACKTRACE;
 	fire_main = 0;	// reset this first.
 
 	int i;
@@ -440,7 +441,7 @@
 
 void RogueSquadron::animate(Frame *space)
 {
-	STACKTRACE
+  STACKTRACE;
 	int a;
 	a = aa_get_trans();
 	aa_set_trans(100);
@@ -452,6 +453,7 @@
 
 int RogueSquadron::handle_damage(SpaceLocation* source, double normal, double direct)
 {
+  STACKTRACE;
 	// the Syreen, and maybe other area-effect weapons, can do damage to
 	// the virtual ship, which I don't want. So, I'll disable all damage
 	// taking by this ship
@@ -463,6 +465,7 @@
 
 void RogueSquadron::calculate_hotspots()
 {
+  STACKTRACE;
 	// do nothing: no hotspots for this virtual thing
 }
 
@@ -472,6 +475,7 @@
 :
 Ship(creator, creator-&gt;pos, creator-&gt;angle, osprite)
 {
+  STACKTRACE;
 	mother = creator;
 	pos = mother-&gt;pos;
 
@@ -502,7 +506,7 @@
 
 SpaceObject* RogueFighter::nearest_location()
 {
-	STACKTRACE
+  STACKTRACE;
 	SpaceObject *p = NULL;
 	double r = 99999999;
 	Query q;
@@ -526,7 +530,7 @@
 // should be added to SpaceLocation I think !
 void RogueFighter::avoid_location(SpaceObject *o)
 {
-	STACKTRACE
+  STACKTRACE;
 	double t_a = trajectory_angle(o);
 	double d_a = normalize(t_a - angle, PI2);
 	
@@ -548,7 +552,7 @@
 
 void RogueFighter::calculate()
 {
-	STACKTRACE
+  STACKTRACE;
 	if ( !(mother &amp;&amp; mother-&gt;exists()) )
 	{
 		state = 0;
@@ -639,7 +643,7 @@
 
 int RogueFighter::handle_damage(SpaceLocation* source, double normal, double direct)
 {
-	STACKTRACE
+  STACKTRACE;
 	if (!state)
 		return 0;	// to avoid an infinite feedback with enemy rogue.
 
@@ -668,11 +672,11 @@
 
 	if ( !state )
 	{
-		// this ship dies :(
-		play_sound((SAMPLE *)(melee[MELEE_BOOMSHIP].dat));
-		game-&gt;add(new Animation(this, pos, meleedata.kaboomSprite, 0, KABOOM_FRAMES, time_ratio, DEPTH_EXPLOSIONS));
+	  tw_sound-&gt;play_sound(data_full_path(MELEE_BOOMSHIP_SOUND));
+	  game-&gt;add(new Animation(this, pos, game-&gt;meleedata.kaboomSprite, 0, 
+				  KABOOM_FRAMES, time_ratio, DEPTH_EXPLOSIONS));
 	}
-
+	
 	return total;
 }
 
@@ -689,6 +693,7 @@
   lpos(opos),
   rel_pos(rpos)
 {
+  STACKTRACE;
 
 // angle conventions fucked up??
 	rel_pos.x *= -1;
@@ -708,7 +713,7 @@
 
 
 void PulseLaser::calculate() {
-	STACKTRACE
+  STACKTRACE;
 	if((frame &lt; frame_count) &amp;&amp; (lpos-&gt;exists())) {
 //		pos = lpos-&gt;normal_pos() + rotate(rel_pos, lpos-&gt;get_angle() - PI/2);
 //		vel = lpos-&gt;get_vel();
@@ -722,18 +727,37 @@
 
 void PulseLaser::inflict_damage(SpaceObject *other)
 {
-	STACKTRACE
-	// copied from space_line:
-	int i;
-	i = iround_down(damage_factor / 2);
-	if(i &gt;= BOOM_SAMPLES)
-		i = BOOM_SAMPLES - 1;
-	play_sound((SAMPLE *)(melee[MELEE_BOOM + i].dat));
-	damage(other, damage_factor);
+  STACKTRACE;
+  // copied from space_line:
+  int i;
+  i = iround_down(damage_factor / 2);
+  if(i &gt;= BOOM_SAMPLES)
+    i = BOOM_SAMPLES - 1;
 
-	state = 0;	// this is different from space_line :)
-	return;
-	}
+  switch(i)
+    {
+    case 0:
+      tw_sound-&gt;play_sound(data_full_path(MELEE_BOOM_SOUND1));
+      break;
+    case 1:
+      tw_sound-&gt;play_sound(data_full_path(MELEE_BOOM_SOUND2));
+      break;
+    case 2:
+      tw_sound-&gt;play_sound(data_full_path(MELEE_BOOM_SOUND3));
+      break;
+    case 3:
+      tw_sound-&gt;play_sound(data_full_path(MELEE_BOOM_SOUND4));
+      break;
+    default:
+      {
+	tw_error(&quot;Unknown BOOM sound&quot;);
+      }
+    }
+  damage(other, damage_factor);
+  
+  state = 0;	// this is different from space_line :)
+  return;
+}
 
 
 REGISTER_SHIP ( RogueSquadron )

Modified: branches/multiplayer-branch/source/ships/shpstaba.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpstaba.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ships/shpstaba.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 class StarBase : public Ship {
   double       weaponRange;
@@ -49,6 +48,7 @@
 	:
 	Ship(opos, angle, data, code)
 	{
+  STACKTRACE;
 
   weaponRange    = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
   weaponVelocity = scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
@@ -68,7 +68,7 @@
 }
 
 int StarBase::activate_weapon() {
-	STACKTRACE
+  STACKTRACE;
    
 	double a;
 	if (target) {
@@ -97,7 +97,7 @@
 }
 
 int StarBase::activate_special() {
-	STACKTRACE
+  STACKTRACE;
   int fire = FALSE;
   SpaceObject *o;
 
@@ -114,51 +114,60 @@
                                 l-&gt;set_depth(LAYER_EXPLOSIONS); }
 			}
 		}
-	if (fire) play_sound((SAMPLE *)(melee[MELEE_BOOM + 0].dat));
+	if (fire) 
+	  {
+	    tw_sound-&gt;play_sound(data_full_path(MELEE_BOOM_SOUND1));
+	  }
 
 	return(fire);
 	}
 
-void StarBase::calculate() {
-	STACKTRACE
-
+void StarBase::calculate() 
+{
+  STACKTRACE;
   int fire = FALSE;
   Ship *o;
 
-	Query a;
-	for (a.begin(this, bit(LAYER_SHIPS), HealRange); a.current; a.next()) {
-		o = (Ship *)a.currento;
-		if((!o-&gt;isInvisible()) &amp;&amp; o-&gt;sameTeam(this))
-		{
-			if((random()%HealRate)!=0) continue;
-			if(batt&lt;HealCost) continue;
-			if(o-&gt;crew==o-&gt;crew_max) continue;
-			batt-=HealCost;
-			SpaceLocation *l = new PointLaser(this, pallete_color[HealColor], -1,
-					specialFrames, this, o, Vector2(0.0, 10.0));
-			game-&gt;add(l);
-			if (l-&gt;exists())
-			{
-                                fire = TRUE;
-                                l-&gt;set_depth(LAYER_EXPLOSIONS); }
-			}
-		}
-	if (fire) play_sound((SAMPLE *)(melee[MELEE_BOOM + 0].dat));
-
-	Ship::calculate();
+  Query a;
+  for (a.begin(this, bit(LAYER_SHIPS), HealRange); a.current; a.next()) {
+    o = (Ship *)a.currento;
+    if((!o-&gt;isInvisible()) &amp;&amp; o-&gt;sameTeam(this))
+      {
+	if((random()%HealRate)!=0) continue;
+	if(batt&lt;HealCost) continue;
+	if(o-&gt;crew==o-&gt;crew_max) continue;
+	batt-=HealCost;
+	SpaceLocation *l = new PointLaser(this, pallete_color[HealColor], -1,
+					  specialFrames, this, o, Vector2(0.0, 10.0));
+	game-&gt;add(l);
+	if (l-&gt;exists())
+	  {
+	    fire = TRUE;
+	    l-&gt;set_depth(LAYER_EXPLOSIONS); }
+      }
+  }
+  if (fire) 
+    {
+      tw_sound-&gt;play_sound(data_full_path(MELEE_BOOM_SOUND1));
+    }
+  
+  Ship::calculate();
 }   
 
 int StarBase::handle_damage(SpaceLocation *source, double normal, double direct)
 {
-	STACKTRACE
-		  batt -= normal;
-        if (batt &lt; 0) {
-                normal = -batt;
-                batt = 0; }
-        else    normal = 0;
-        return Ship::handle_damage(source, normal, direct);
+  STACKTRACE;
+  batt -= normal;
+  if (batt &lt; 0) 
+    {
+      normal = -batt;
+      batt = 0; 
+    }
+  else    normal = 0;
+  return Ship::handle_damage(source, normal, direct);
 }
 
-void StarBase::calculate_gravity() {}
+void StarBase::calculate_gravity() {
+  STACKTRACE;}
 
 REGISTER_SHIP ( StarBase )

Modified: branches/multiplayer-branch/source/ships/shptauar.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shptauar.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ships/shptauar.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -24,8 +24,6 @@
 #include &quot;melee/mcbodies.h&quot;
 
 
-REGISTER_FILE
-
 void TauArchonFreezeColorEffects (RGB *c)
 {
 STACKTRACE
@@ -122,6 +120,7 @@
 TauArchon::TauArchon(Vector2 opos, double shipAngle, ShipData *shipData, unsigned int code) :
 	Ship(opos, shipAngle, shipData, code)
 {
+  STACKTRACE;
 	weaponChargeTime	= (int)(get_config_float(&quot;Weapon&quot;, &quot;ChargeTime&quot;, 0) * 1000);
 	weapon_charge_counter	= 0;
 	weaponVelocity		= scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
@@ -169,6 +168,7 @@
 
 bool TauArchon::ShotTakeBatt()
 {
+  STACKTRACE;
 	if(numDamage_steps &gt; 0)
 	{
 		bool bWhat2Do;
@@ -186,96 +186,92 @@
 
 void TauArchon::calculate()
 {
-STACKTRACE
-/* Removed by Jad at *Jumping Peppers*'s behest
-	recharge_rate = base_recharge_rate * (1 - batt / (double)batt_max);
-	if (recharge_rate &lt;= frame_time)
-		recharge_rate = frame_time + 1;
-	if (recharge_rate &lt;= 2*weapon_rate)
-		recharge_rate = 2*weapon_rate + 1;
-	recharge_amount = batt_max;
-*/
-	Ship::calculate();
+  STACKTRACE;
+  Ship::calculate();
 	
-	if ((fire_weapon || fire_special) &amp;&amp; (batt &gt;= weapon_drain/(double)special_drain)/* &amp;&amp; (weapon_recharge &lt;= 0)*/)
+  if ((fire_weapon || fire_special) &amp;&amp; 
+      (batt &gt;= weapon_drain/(double)special_drain))
+    {
+      weapon_charge_counter += frame_time;
+      if (weapon_charge_counter &gt; weaponChargeTime)
+	weapon_charge_counter = weaponChargeTime;
+    }
+  else 
+    {
+      if(bCoolDownThenCharge)
+	recharge_amount = 0;
+      weapon_charge_counter -= frame_time;
+      if (weapon_charge_counter &lt; 0)
 	{
-		weapon_charge_counter += frame_time;
-		if (weapon_charge_counter &gt; weaponChargeTime)
-			weapon_charge_counter = weaponChargeTime;
-//		recharge_step = recharge_rate;
+	  weapon_charge_counter = 0;
+	  if(bCoolDownThenCharge)
+	    recharge_amount = orig_amount;
 	}
-	else 
-	{
-		if(bCoolDownThenCharge)
-			recharge_amount = 0;
-		weapon_charge_counter -= frame_time;
-		if (weapon_charge_counter &lt; 0)
-		{
-			weapon_charge_counter = 0;
-			if(bCoolDownThenCharge)
-				recharge_amount = orig_amount;
-		}
-	}
-
-	if (weapon_sound_timer &gt; 0)
-		weapon_sound_timer -= frame_time;
-
-	return;
+    }
+  
+  if (weapon_sound_timer &gt; 0)
+    weapon_sound_timer -= frame_time;
+  
+  return;
 }
 
 
 void TauArchon::calculate_fire_weapon()
 {
-STACKTRACE
-	weapon_low = FALSE;
+  STACKTRACE;
+  weapon_low = FALSE;
 
-	if ((fire_weapon || fire_special) &amp;&amp; (weapon_charge_counter &gt;= weaponChargeTime))
+ if ((fire_weapon || fire_special) &amp;&amp; (weapon_charge_counter &gt;= weaponChargeTime))
 
-		while (weapon_recharge &lt;= 0)
-		{
-			
-			if (batt &lt; weapon_drain/(double)special_drain)
-			{
-				weapon_low = true;
-				return; 
-			}
-
-			double rx = tw_random(-12.0, 12.0);
-			double ax = (rx/3.0) * ANGLE_RATIO;
-
-			game-&gt;add(new TauArchonShot(this, Vector2(rx/2,11), angle+ax,
-					weaponVelocity * tw_random(0.96, 1.08), weaponDamage,
-					weaponDamageMin, (fire_special?specialRange:weaponRange) * tw_random(0.77, 1.17),
-					weaponArmour, weaponFuelSap,
-					data-&gt;spriteWeapon, weaponDoFreeze,
-					fire_special?specialMaxDivergence:(-1),
-					weaponReactiveDamage, specialRangeLimiter));
-
-			batt -= (weapon_drain/(double)special_drain);//*0.9999;
-
-			if (batt &lt; 0) 
-				batt = 0;
-
-			recharge_step = recharge_rate;
-
-			weapon_recharge += weapon_rate;
-
-			if (weapon_sound_timer &lt;= 0) 
-			{
-				if (fire_special)
-					play_sound(data-&gt;sampleSpecial[0]);
-				else
-					play_sound(data-&gt;sampleWeapon[0]);
-				weapon_sound_timer = iround(weaponSoundTimer * tw_random(0.49, 1.63));
-			}
-		}
-	return;
+   while (weapon_recharge &lt;= 0)
+     {
+       
+       if (batt &lt; weapon_drain/(double)special_drain)
+	 {
+	   weapon_low = true;
+	   return; 
+	 }
+       
+       double rx = tw_random(-12.0, 12.0);
+       double ax = (rx/3.0) * ANGLE_RATIO;
+       
+       game-&gt;add(new TauArchonShot(this, Vector2(rx/2,11), angle+ax,
+				   weaponVelocity * tw_random(0.96, 1.08), weaponDamage,
+				   weaponDamageMin, (fire_special?specialRange:weaponRange) * tw_random(0.77, 1.17),
+				   weaponArmour, weaponFuelSap,
+				   data-&gt;spriteWeapon, weaponDoFreeze,
+				   fire_special?specialMaxDivergence:(-1),
+				   weaponReactiveDamage, specialRangeLimiter));
+       
+       batt -= (weapon_drain/(double)special_drain);//*0.9999;
+       
+       if (batt &lt; 0) 
+	 batt = 0;
+       
+       recharge_step = recharge_rate;
+       
+       weapon_recharge += weapon_rate;
+       
+       if (weapon_sound_timer &lt;= 0) 
+	 {
+	   if (fire_special)
+	     {
+	       tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleSpecial[0]));
+	     }
+	   else
+	     {
+	       tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleWeapon[0]));
+	     }
+	   weapon_sound_timer = iround(weaponSoundTimer * tw_random(0.49, 1.63));
+	 }
+     }
+ return;
 }
 
 
 void TauArchon::calculate_fire_special()
 {
-STACKTRACE
+  STACKTRACE;
 	special_low = false;
 	return;
 }
@@ -283,7 +279,7 @@
 
 void TauArchon::animate(Frame *space)
 {
-STACKTRACE
+  STACKTRACE;
 	int aa = get_tw_aa_mode();
 	if ((weapon_charge_counter &gt; 0) &amp;&amp; (aa &amp; AA_BLEND) &amp;&amp; !(aa &amp; AA_NO_AA)) 
 	{
@@ -308,6 +304,7 @@
 /*	Removed by Jad
 RGB TauArchon::crewPanelColor(int k)
 {
+  STACKTRACE;
 	RGB c = {255, 255, 255};
 	return c;
 }
@@ -315,6 +312,7 @@
 
 RGB TauArchon::battPanelColor(int k)
 {
+  STACKTRACE;
 	RGB c = {85, 85, 255};
 	return c;
 }
@@ -322,7 +320,7 @@
 
 void TauArchon::calculate_hotspots()
 {
-STACKTRACE
+  STACKTRACE;
 	if((thrust) &amp;&amp; (hotspot_frame &lt;= 0)) {
 		game-&gt;add(new Animation( this, 
 				normal_pos() - unit_vector(angle) * 15,
@@ -341,11 +339,12 @@
 	Shot(creator, opos, oangle, ov, odamage, orange, oarmour, creator, osprite),
 	min_damage(omindamage), fuel_sap(ofsap)
 {
+  STACKTRACE;
 	do_reactive_damage = oreactive;
 	explosionSprite     = data-&gt;spriteWeaponExplosion;
 	explosionFrameCount = 10;
 	explosionFrameSize  = 50;
-	explosionSample = data-&gt;sampleWeapon[1+tw_random()%3];
+	//	explosionSample = data-&gt;sampleWeapon[1+tw_random()%3];
 	sprite_index = 80;
 
 	do_freeze = ofreeze;
@@ -385,7 +384,7 @@
 
 void TauArchonShot::calculate()
 {
-STACKTRACE
+  STACKTRACE;
 	Shot::calculate();
 
 	if (rotation_base) {
@@ -408,14 +407,14 @@
 
 void TauArchonShot::animate(Frame *space)
 {
-STACKTRACE
+  STACKTRACE;
 	if (exists())
 		sprite-&gt;animate(pos, index_base + (int)(19.89 * d / range), space);
 }
 
 void TauArchonShot::inflict_damage(SpaceObject *other)
 {
-STACKTRACE
+  STACKTRACE;
 	double d_f = damage_factor;
 
 	if (other-&gt;isShip()) 
@@ -475,15 +474,15 @@
 		image-&gt;type = DAT_RLE_SPRITE;
 		tmp = create_bitmap_ex( bitmap_color_depth( bmp ), bmp-&gt;w, bmp-&gt;h );
 		//void* old_color_effects = videosystem.color_effects;
-		void* old_color_effects = (void *)videosystem.color_effects; //added (void *) 7/1/2003 Culture20
-		videosystem.color_effects = TauArchonFreezeColorEffects;
+		void* old_color_effects = (void *)videosystem-&gt;color_effects; //added (void *) 7/1/2003 Culture20
+		videosystem-&gt;color_effects = TauArchonFreezeColorEffects;
 	//	videosystem.update_colors();
 		blit( bmp, tmp, 0, 0, 0, 0, bmp-&gt;w, bmp-&gt;h );
 		image-&gt;dat = get_rle_sprite( tmp );
 		SpaceSprite* frozen_sprite = new SpaceSprite( image, 1 );
 		destroy_bitmap( tmp );
 		//videosystem.color_effects = (void (__cdecl *)(struct RGB *))old_color_effects;
-		videosystem.color_effects = (void (*)(struct RGB *))old_color_effects; //removed __cdecl 7/1/2003 Culture20
+		videosystem-&gt;color_effects = (void (*)(struct RGB *))old_color_effects; //removed __cdecl 7/1/2003 Culture20
 	//	videosystem.update_colors();
 		delete image;
 		game-&gt;add(new TauArchonFrozen(this, other, frozen_sprite));
@@ -502,6 +501,7 @@
 TauArchonFrozen::TauArchonFrozen(SpaceLocation *creator, SpaceObject *source, SpaceSprite *osprite) :
 	Shot(creator, 0, source-&gt;get_angle(), 0, 0, 999, source-&gt;mass, source, osprite, 1.0)
 {
+  STACKTRACE;
 	collide_flag_anyone = collide_flag_sameteam = collide_flag_sameship = ALL_LAYERS;
 	ally_flag = 0;
 	mass = source-&gt;mass;
@@ -510,15 +510,21 @@
 	set_depth(source-&gt;get_depth());
 	attributes &amp;= ~ATTRIB_SHOT;
 	old_vel = vel;
-	explosionSample = data-&gt;sampleExtra[tw_random()%4];
+
+	// explosionSample = data-&gt;sampleExtra[tw_random()%4]; replace to valid sound
+
 	exploded_already = false;
 
 	lifetime = 3000 + tw_random()%(15*60000);
 
 	if (tw_random()%2)
-		play_sound(data-&gt;sampleWeapon[4]);
+	  {
+	    tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleWeapon[4]));
+	  }
 	else
-		play_sound(data-&gt;sampleWeapon[5]);
+	  {
+	    tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleWeapon[5]));
+	  }
 }
 
 TauArchonFrozen::~TauArchonFrozen()
@@ -528,11 +534,12 @@
 
 void TauArchonFrozen::inflict_damage(SpaceObject *other)
 {
+  STACKTRACE;
 }
 
 void TauArchonFrozen::calculate()
 {
-STACKTRACE
+  STACKTRACE;
 
 	Shot::calculate();
 	if (length(vel-old_vel) &gt; scale_velocity(15+tw_random()%20))
@@ -545,7 +552,7 @@
 
 void TauArchonFrozen::animateExplosion()
 {
-	STACKTRACE
+  STACKTRACE;
 	if (!exploded_already) {
 		exploded_already = true;	
 		game-&gt;add(new Animation(this, normal_pos(),

Modified: branches/multiplayer-branch/source/ships/shptauda.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shptauda.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ships/shptauda.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -20,8 +20,6 @@
 #include &quot;melee/mview.h&quot;
 #include &quot;frame.h&quot;
 
-REGISTER_FILE
-
 class TauDagger : public Ship
 {
 	double		weaponRange, weaponDamage, weaponFrameCount;
@@ -73,6 +71,7 @@
 TauDagger::TauDagger(Vector2 opos, double shipAngle, ShipData *shipData, unsigned int code) :
 	Ship(opos, shipAngle, shipData, code)
 {
+  STACKTRACE;
 
 	weaponRange			= scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
 	weaponDamage		= get_config_float(&quot;Weapon&quot;, &quot;Damage&quot;, 0);
@@ -88,14 +87,14 @@
 
 int TauDagger::activate_weapon()
 {
-	STACKTRACE
+  STACKTRACE;
 	game-&gt;add(new TauDaggerBeam(this, Vector2(0,30), weaponRange, weaponDamage, iround(weaponFrameCount), angle));
 	return true;
 }
 
 int TauDagger::activate_special()
 {
-	STACKTRACE
+  STACKTRACE;
 
 	game-&gt;add(new TauDaggerShot(this, Vector2(0,55), angle, specialVelocity,
 			specialDamage, specialRange, specialArmour, data-&gt;spriteSpecial));
@@ -112,6 +111,7 @@
 	frame(0), frame_count(lfcount), lpos(creator), rel_pos(rpos)
 
 {
+  STACKTRACE;
 	if (ldamage &lt;= 0) collide_flag_anyone = 0;
 	set_depth(DEPTH_SHOTS);
 	base_length = length;
@@ -131,7 +131,7 @@
 
 void TauDaggerBeam::calculate()
 {
-	STACKTRACE
+  STACKTRACE;
 	if((frame &lt; frame_count) &amp;&amp; (lpos-&gt;exists())) {
 		length = base_length;
 		pos = lpos-&gt;normal_pos() + rotate(rel_pos, lpos-&gt;get_angle() - PI/2);
@@ -150,13 +150,13 @@
 
 void TauDaggerBeam::inflict_damage(SpaceObject *other)
 {
-	STACKTRACE
+  STACKTRACE;
 	damage(other, damage_factor*frame_time/frame_count);
 
 	int aa = get_tw_aa_mode();
 	if (!((aa &amp; AA_BLEND) &amp;&amp; (aa &amp; AA_ALPHA) &amp;&amp; (!got_spark) &amp;&amp; !(aa &amp; AA_NO_AA))) {
 		physics-&gt;add(new Animation( this, 
-				pos + edge(), meleedata.sparkSprite, 0, 
+				pos + edge(), game-&gt;meleedata.sparkSprite, 0, 
 				SPARK_FRAMES, 50, DEPTH_EXPLOSIONS));
 		got_spark = true; }
 
@@ -165,7 +165,7 @@
 
 void TauDaggerBeam::animate(Frame *space)
 {
-	STACKTRACE
+  STACKTRACE;
 	int aa = get_tw_aa_mode();
 	SpaceLine::animate(space);
 	if ((aa &amp; AA_BLEND) &amp;&amp; (aa &amp; AA_ALPHA) &amp;&amp; !(aa &amp; AA_NO_AA) &amp;&amp; (length &lt; base_length*0.9999) &amp;&amp; (target)) {
@@ -182,10 +182,11 @@
 		double ov, double odamage, double orange, double oarmour, SpaceSprite *osprite) :
 	Missile(creator, opos, oangle, ov, odamage, orange, oarmour, creator, osprite)
 {
+  STACKTRACE;
 	explosionSprite     = data-&gt;spriteSpecialExplosion;
 	explosionFrameCount = 20;
 	explosionFrameSize  = 25;
-	explosionSample = data-&gt;sampleSpecial[1];
+	//	explosionSample = data-&gt;sampleSpecial[1];
 	s_ind = 0;
 
 	add(new Animation(this, pos, data-&gt;spriteExtra, 0, 10, 25, DEPTH_HOTSPOTS+0.25));
@@ -194,7 +195,7 @@
 
 void TauDaggerShot::animate(Frame *space)
 {
-	STACKTRACE
+  STACKTRACE;
 	sprite-&gt;animate(pos, sprite_index + 64 * s_ind, space);
 	s_ind = (s_ind + 1) % 2;
 }

Modified: branches/multiplayer-branch/source/ships/shptaume.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shptaume.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ships/shptaume.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -19,8 +19,6 @@
 #include &quot;melee/mview.h&quot;
 #include &quot;frame.h&quot;
 
-REGISTER_FILE
-
 class TauMercury : public Ship {
 	double	weaponRange, weaponVelocity, weaponRelativity;
 	double	weaponDamage, weaponArmour;
@@ -77,6 +75,7 @@
 TauMercury::TauMercury(Vector2 opos, double shipAngle, ShipData *shipData, unsigned int code) :
 	Ship(opos, shipAngle, shipData, code)
 {
+  STACKTRACE;
 	weaponRange		= scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
 	weaponVelocity	= scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
     weaponDamage	= get_config_float(&quot;Weapon&quot;, &quot;Damage&quot;, 0);
@@ -108,7 +107,7 @@
 
 int TauMercury::activate_weapon()
 {
-	STACKTRACE
+  STACKTRACE;
 	double da = (1-0.002*(random()%1001));
 	if (da &gt;= 0)
 		da *= da;
@@ -123,7 +122,7 @@
 
 void TauMercury::calculate_turn_right()
 {
-	STACKTRACE
+  STACKTRACE;
 	if (turn_right) {
 		bank_position += bank_max * frame_time / bank_time;
 		if (!turn_lag)
@@ -132,7 +131,7 @@
 
 void TauMercury::calculate_turn_left()
 {
-	STACKTRACE
+  STACKTRACE;
 	if (turn_left) {
 		bank_position -= bank_max * frame_time / bank_time;
 		if (!turn_lag)
@@ -141,7 +140,7 @@
 
 void TauMercury::calculate()
 {
-	STACKTRACE
+  STACKTRACE;
 	double vl;
 	bool locked_rail = false;
 
@@ -216,7 +215,7 @@
 
 int TauMercury::accelerate(SpaceLocation *source, double angle, double velocity, double max_speed)
 {
-	STACKTRACE
+  STACKTRACE;
 	double ov;
 	double nvs, nvl;
 
@@ -242,11 +241,12 @@
 
 void TauMercury::calculate_hotspots()
 {
-	STACKTRACE
+  STACKTRACE;
 	if((thrust) &amp;&amp; (hotspot_frame &lt;= 0)) {
 		game-&gt;add(new Animation( this, 
 				normal_pos() - unit_vector(angle) * 14,
-				meleedata.hotspotSprite, 0, HOTSPOT_FRAMES, time_ratio, DEPTH_HOTSPOTS));
+				game-&gt;meleedata.hotspotSprite, 0, HOTSPOT_FRAMES, 
+					 time_ratio, DEPTH_HOTSPOTS));
 		hotspot_frame += hotspot_rate; }
 	if (hotspot_frame &gt; 0) hotspot_frame -= frame_time;
 	return;
@@ -254,11 +254,12 @@
 
 void TauMercury::calculate_thrust()
 {
+  STACKTRACE;
 }
 
 void TauMercury::calculate_fire_special()
 {
-	STACKTRACE
+  STACKTRACE;
 	special_low = FALSE;
 	if (!fire_special)
 		return;
@@ -303,14 +304,17 @@
 	AnimatedShot(creator, Vector2(ox,oy), oangle, ov, odamage, orange, oarmour, creator, osprite, 10, 50, relativity),
 	sparks(osparks), frags(ofrags)
 {
+  STACKTRACE;
 		if (frags)
-			explosionSample = data-&gt;sampleWeapon[1];
+		  {
+		    //			explosionSample = data-&gt;sampleWeapon[1];
+		  }
 }
 
 
 void TauMercuryShot::calculate()
 {
-	STACKTRACE
+  STACKTRACE;
 	int si = sprite_index;
 	AnimatedShot::calculate();
 	
@@ -343,7 +347,7 @@
 
 void TauMercuryShot::animateExplosion()
 {
-	STACKTRACE
+  STACKTRACE;
 	if (!frags) {
 		Shot::animateExplosion();
 		return; }
@@ -389,7 +393,7 @@
 
 void TauMercurySpark::calculate()
 {
-	STACKTRACE
+  STACKTRACE;
 	lifetime -= frame_time;
 	if (lifetime &lt;= 0)
 		state = 0;
@@ -399,14 +403,14 @@
 
 void TauMercurySpark::inflict_damage(SpaceObject *other)
 {
-	STACKTRACE
+  STACKTRACE;
 	SpaceLine::inflict_damage(other);
 	state =0;
 }
 
 void TauMercurySpark::animate(Frame *space)
 {
-	STACKTRACE
+  STACKTRACE;
 	drawing_mode(DRAW_MODE_TRANS, NULL, 0, 0);
 
 	double c = lifetime/(double)lifetime_max;

Modified: branches/multiplayer-branch/source/ships/shptausl.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shptausl.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ships/shptausl.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 #define trace_lifetime 200.0
 #define trace_rate 50
@@ -126,6 +125,7 @@
 
 int TauSlider::activate_weapon()
 {
+  STACKTRACE;
         if (in_jump) return false;
         add(new TauSliderLaser(+21, 15, angle - 15*ANGLE_RATIO,
                           weaponVelocity, weaponRange, weaponLength, this));
@@ -141,74 +141,101 @@
 
 void TauSlider::calculate_fire_special()
 {
-        special_low = false;
+  STACKTRACE;
+  special_low = false;
 
-        if (fire_special) {
-                if (in_jump) return;
-                holding_special = true;
-                if (special_recharge &lt;= 0) {
-                        if (batt &lt; special_drain) {
-                                special_low = true;
-                                activate_special();
-                                return; }
-                        else {  special_charge++;
-                                batt -= special_drain;
-                                special_recharge += special_rate;
-                                play_sound2(data-&gt;sampleSpecial[0]);
-                                if (special_charge &gt;= max_charge)
-                                        activate_special(); } } }
-        else {
-                if (holding_special)
-                        if (!in_jump)
-                                activate_special();
-                holding_special = false; }
+  if (fire_special) 
+    {
+      if (in_jump) 
+	return;
+      holding_special = true;
+      if (special_recharge &lt;= 0) 
+	{
+	  if (batt &lt; special_drain) 
+	    {
+	      special_low = true;
+	      activate_special();
+	      return; 
+	    }
+	  else 
+	    {  
+	      special_charge++;
+	      batt -= special_drain;
+	      special_recharge += special_rate;
+	      
+	      tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleSpecial[0]));
+	      tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleSpecial[0]));
+	      
+	      if (special_charge &gt;= max_charge)
+		activate_special(); 
+	    } 
+	} 
+    }
+  else 
+    {
+      if (holding_special)
+	if (!in_jump)
+	  activate_special();
+      holding_special = false; 
+    }
 }
 
 
 int TauSlider::activate_special()
 {
-        if (special_charge &gt;= critical_charge) {
-                in_jump = true;
-                collide_flag_anyone = 0;
-                layer = LAYER_HOTSPOTS;
-                double a = special_charge - sub_velocity;
-                jv = velocity0 + a * (velocity1 + a * velocity2);
-                //jvx = jv * cos(angle*ANGLE_RATIO);
-                //jvy = jv * sin(angle*ANGLE_RATIO);
-				jvp = jv * unit_vector(angle);
-                a = special_charge - sub_range;
-                jd = range0 + a * (range1 + a * range2);
-                trace_recharge = 0;
-                play_sound2(data-&gt;sampleSpecial[2]); }
-        else    play_sound2(data-&gt;sampleSpecial[1]);
+  STACKTRACE;
+  if (special_charge &gt;= critical_charge) 
+    {
+      in_jump = true;
+      collide_flag_anyone = 0;
+      layer = LAYER_HOTSPOTS;
+      double a = special_charge - sub_velocity;
+      jv = velocity0 + a * (velocity1 + a * velocity2);
+      jvp = jv * unit_vector(angle);
+      a = special_charge - sub_range;
+      jd = range0 + a * (range1 + a * range2);
+      trace_recharge = 0;
+      tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleSpecial[2]));
+      tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleSpecial[2]));
+    }
+  else    
+    {
+      tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleSpecial[1]));
+      tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleSpecial[1]));
+    }
 
-        special_charge = 0;
-        return true;
+  special_charge = 0;
+  return true;
 }
 
 void TauSlider::calculate()
 {
-        just_exited = false;
-        Ship::calculate();
-        if (in_jump) {
-                trace_recharge -= frame_time;
-                if (trace_recharge &lt; 0) {
-                        trace_recharge += trace_rate;
-                        ct = (ct + 1) % max_trace_number;
-                        tr[ct] = new TauSliderTrace(this); 
-						add(tr[ct]);}
-                //x = normalize(x + jvx * frame_time, X_MAX);
-                //y = normalize(y + jvy * frame_time, Y_MAX);
-				pos = normalize(pos + jvp * frame_time, map_size);
-                jd -= jv * frame_time;
-                if (jd &lt;= 0) {
-                        in_jump = false;
-                        layer = LAYER_SHIPS;
-                        collide_flag_anyone = collide_flag_reserve; }                        
-        }        
+  STACKTRACE;
+  just_exited = false;
+  Ship::calculate();
+  if (in_jump) 
+    {
+      trace_recharge -= frame_time;
+      if (trace_recharge &lt; 0) 
+	{
+	  trace_recharge += trace_rate;
+	  ct = (ct + 1) % max_trace_number;
+	  tr[ct] = new TauSliderTrace(this); 
+	  add(tr[ct]);
+	}
+      pos = normalize(pos + jvp * frame_time, map_size);
+      jd -= jv * frame_time;
+      if (jd &lt;= 0) 
+	{
+	  in_jump = false;
+	  layer = LAYER_SHIPS;
+	  collide_flag_anyone = collide_flag_reserve; 
+	}
+    }        
 }
 
 int TauSlider::handle_damage(SpaceLocation *source, int normal, int direct) {
+  STACKTRACE;
         if (in_jump) {
                 return 0; }
         if (just_exited &amp;&amp; source-&gt;isPlanet())
@@ -218,23 +245,27 @@
 
 int TauSlider::canCollide(SpaceLocation *other)
 {
+  STACKTRACE;
         return ((!in_jump)&amp;&amp;Ship::canCollide(other));
 }
 
 int TauSlider::translate(double dx, double dy)
 {
+  STACKTRACE;
         if (!in_jump) return Ship::translate(dx, dy);
 				return false;
 }
 
 int TauSlider::accelerate(SpaceLocation *source, double oangle, double vel, double omax_speed)
 {
+  STACKTRACE;
         if (!in_jump) return Ship::accelerate(source, oangle, vel, omax_speed);
 				return false;
 }
 
 void TauSlider::animate(Frame* space)
 {
+  STACKTRACE;
         int i,j,r,g,b;
         double a;
         for (i=max_trace_number; i&gt;=0; i--) {
@@ -261,11 +292,13 @@
 
 int TauSlider::isProtected()
 {
+  STACKTRACE;
         return (in_jump);
 }
 
 void TauSlider::calculate_hotspots()
 {
+  STACKTRACE;
         if (!in_jump) Ship::calculate_hotspots();
 }
 
@@ -289,6 +322,7 @@
 
 void TauSliderLaser::calculate()
 {
+  STACKTRACE;
         double a = (d) / range;
         int r = (int)floor(255 - a*400);
         if (r &lt; 0) r = 0;
@@ -304,6 +338,7 @@
 
 void TauSliderLaser::inflict_damage(SpaceObject *other)
 {
+  STACKTRACE;
         SpaceLine::inflict_damage(other);
         state = 0;
 }
@@ -312,6 +347,7 @@
 TauSliderTrace::TauSliderTrace(Ship* oship) :
         SpaceLocation(oship, oship-&gt;normal_pos(), oship-&gt;get_angle())
 {
+  STACKTRACE;
         collide_flag_anyone = 0;
         lifetime = 0;
         //vx = oship-&gt;get_vx();
@@ -322,6 +358,7 @@
 
 void TauSliderTrace::calculate()
 {
+  STACKTRACE;
         if ((lifetime += frame_time) &gt;= trace_lifetime)
                 state = 0;
 }

Modified: branches/multiplayer-branch/source/ships/shptaust.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shptaust.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ships/shptaust.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -15,245 +15,246 @@
 GNU General Public License for more details.
 */
 
+#include &quot;util/sound.h&quot;
 #include &quot;ship.h&quot;
+#include &quot;scp.h&quot;
 
-REGISTER_FILE
-
 class TauStorm : public Ship
 {
-	double		weaponVelocity, weaponAccel, weaponTurnRate, weaponThrust, weaponFuel, weaponStart;
-	double		specialVelocity, specialAccel, specialTurnRate, specialThrust, specialFuel, specialStart;
-	double		weaponBoosterSpeed, weaponRotation, weaponKick, weaponKickMaxspeed;
-	double		specialBoosterSpeed, specialRotation, specialKick, specialKickMaxspeed;
-	double		weaponMass;
-	double		weaponRandom, specialRandom;
+  double weaponVelocity, weaponAccel, weaponTurnRate;
+  double weaponThrust, weaponFuel, weaponStart;
+  double specialVelocity, specialAccel, specialTurnRate;
+  double specialThrust, specialFuel, specialStart;
+  double weaponBoosterSpeed, weaponRotation, weaponKick, weaponKickMaxspeed;
+  double specialBoosterSpeed, specialRotation, specialKick, specialKickMaxspeed;
+  double weaponMass;
+  double weaponRandom, specialRandom;
 
-	int			slot;
+  int slot;
 
 public:
-	TauStorm(Vector2 opos, double shipAngle,
-		ShipData *shipData, unsigned int code);
-
-	virtual int  activate_weapon();
-	virtual int  activate_special();
-	virtual void animate(Frame *space);
+  TauStorm(Vector2 opos, double shipAngle,
+	   ShipData *shipData, unsigned int code);
+  
+  virtual int  activate_weapon();
+  virtual int  activate_special();
+  virtual void animate(Frame *space);
 };
 
 
 class TauStormMissile : public HomingMissile
 {
-	int	fuel;
-
-	double ra, pa, rr, rt;
-
-	SpaceObject *latched;
-	
-	double booster_speed, thrust, accel, rotation;
-	int smoke_frame, first_frame;
-
+  int	fuel;
+  
+  double ra, pa, rr, rt;
+  
+  SpaceObject *latched;
+  
+  double booster_speed, thrust, accel, rotation;
+  int smoke_frame, first_frame;
+  
 public:
 
-	TauStormMissile (SpaceLocation *creator, double ox, double oy, double oangle, double oaccel,
-				double ov, double otr, SpaceObject *otarget,
-				int ofuel, double othrust, double omass, double oboosterspeed,
-				SpaceSprite *osprite, double omr, double osv, SAMPLE *s);				
-	virtual void calculate();
-	virtual void inflict_damage (SpaceObject *other);
-	virtual void handle_damage (SpaceObject *other, double normal, double direct = 0);
-	virtual int  canCollide(SpaceLocation *other);
+  TauStormMissile (SpaceLocation *creator, double ox, double oy, double oangle, double oaccel,
+		   double ov, double otr, SpaceObject *otarget,
+		   int ofuel, double othrust, double omass, double oboosterspeed,
+		   SpaceSprite *osprite, double omr, double osv, std::string s);
+  virtual void calculate();
+  virtual void inflict_damage (SpaceObject *other);
+  virtual void handle_damage (SpaceObject *other, double normal, double direct = 0);
+  virtual int  canCollide(SpaceLocation *other);
 };
 
 
 
 TauStorm::TauStorm(Vector2 opos, double shipAngle, ShipData *shipData, unsigned int code) :
-	Ship(opos, shipAngle, shipData, code)
+  Ship(opos, shipAngle, shipData, code)
 {
-
-	weaponMass = get_config_float(&quot;Weapon&quot;, &quot;Mass&quot;, 0.01);
-
-	weaponVelocity		= scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
-	weaponAccel			= scale_acceleration(get_config_float(&quot;Weapon&quot;, &quot;Accel&quot;, 0), 0);
-	weaponTurnRate		= scale_turning(get_config_float(&quot;Weapon&quot;, &quot;TurnRate&quot;, 0));
-	weaponFuel			= get_config_int(&quot;Weapon&quot;, &quot;Fuel&quot;, 0);
-	weaponThrust		= scale_acceleration(get_config_int(&quot;Weapon&quot;, &quot;Thrust&quot;, 0), 0);
-	weaponBoosterSpeed	= scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;BoosterSpeed&quot;, 0));
-	weaponRotation		= get_config_float(&quot;Weapon&quot;, &quot;Rotation&quot;, 0)*PI/180;
-	weaponKick			= scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Kick&quot;, 0));
-	weaponKickMaxspeed	= scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;KickMaxspeed&quot;, 0));
-	weaponStart			= get_config_float(&quot;Weapon&quot;, &quot;StartSpeed&quot;, 0);
-	weaponRandom		= get_config_float(&quot;Weapon&quot;, &quot;Random&quot;, 0);
-
-	specialVelocity		= scale_velocity(get_config_float(&quot;Special&quot;, &quot;Velocity&quot;, 0));
-	specialAccel		= scale_acceleration(get_config_float(&quot;Special&quot;, &quot;Accel&quot;, 0), 0);
-	specialTurnRate		= scale_turning(get_config_float(&quot;Special&quot;, &quot;TurnRate&quot;, 0));
-	specialFuel			= get_config_int(&quot;Special&quot;, &quot;Fuel&quot;, 0);
-	specialThrust		= scale_acceleration(get_config_int(&quot;Special&quot;, &quot;Thrust&quot;, 0), 0);
-	specialBoosterSpeed	= scale_velocity(get_config_float(&quot;Special&quot;, &quot;BoosterSpeed&quot;, 0));
-	specialRotation		= get_config_float(&quot;Special&quot;, &quot;Rotation&quot;, 0)*PI/180;
-	specialKick			= scale_velocity(get_config_float(&quot;Special&quot;, &quot;Kick&quot;, 0));
-	specialKickMaxspeed	= scale_velocity(get_config_float(&quot;Special&quot;, &quot;KickMaxspeed&quot;, 0));
-	specialStart		= get_config_float(&quot;Special&quot;, &quot;StartSpeed&quot;, 0);
-	specialRandom		= get_config_float(&quot;Special&quot;, &quot;Random&quot;, 0);
-
-	slot = 0;
-
-	weapon_sample		= -1;
-	special_sample		= -1;
+  STACKTRACE;
+  
+  weaponMass = get_config_float(&quot;Weapon&quot;, &quot;Mass&quot;, 0.01);
+  
+  weaponVelocity	= scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
+  weaponAccel		= scale_acceleration(get_config_float(&quot;Weapon&quot;, &quot;Accel&quot;, 0), 0);
+  weaponTurnRate	= scale_turning(get_config_float(&quot;Weapon&quot;, &quot;TurnRate&quot;, 0));
+  weaponFuel		= get_config_int(&quot;Weapon&quot;, &quot;Fuel&quot;, 0);
+  weaponThrust		= scale_acceleration(get_config_int(&quot;Weapon&quot;, &quot;Thrust&quot;, 0), 0);
+  weaponBoosterSpeed	= scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;BoosterSpeed&quot;, 0));
+  weaponRotation	= get_config_float(&quot;Weapon&quot;, &quot;Rotation&quot;, 0)*PI/180;
+  weaponKick		= scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Kick&quot;, 0));
+  weaponKickMaxspeed	= scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;KickMaxspeed&quot;, 0));
+  weaponStart		= get_config_float(&quot;Weapon&quot;, &quot;StartSpeed&quot;, 0);
+  weaponRandom		= get_config_float(&quot;Weapon&quot;, &quot;Random&quot;, 0);
+  
+  specialVelocity	= scale_velocity(get_config_float(&quot;Special&quot;, &quot;Velocity&quot;, 0));
+  specialAccel		= scale_acceleration(get_config_float(&quot;Special&quot;, &quot;Accel&quot;, 0), 0);
+  specialTurnRate	= scale_turning(get_config_float(&quot;Special&quot;, &quot;TurnRate&quot;, 0));
+  specialFuel		= get_config_int(&quot;Special&quot;, &quot;Fuel&quot;, 0);
+  specialThrust		= scale_acceleration(get_config_int(&quot;Special&quot;, &quot;Thrust&quot;, 0), 0);
+  specialBoosterSpeed	= scale_velocity(get_config_float(&quot;Special&quot;, &quot;BoosterSpeed&quot;, 0));
+  specialRotation	= get_config_float(&quot;Special&quot;, &quot;Rotation&quot;, 0)*PI/180;
+  specialKick		= scale_velocity(get_config_float(&quot;Special&quot;, &quot;Kick&quot;, 0));
+  specialKickMaxspeed	= scale_velocity(get_config_float(&quot;Special&quot;, &quot;KickMaxspeed&quot;, 0));
+  specialStart		= get_config_float(&quot;Special&quot;, &quot;StartSpeed&quot;, 0);
+  specialRandom		= get_config_float(&quot;Special&quot;, &quot;Random&quot;, 0);
+  
+  slot = 0;
+  
+  weapon_sample		= -1;
+  special_sample	= -1;
 }
 
 int TauStorm::activate_weapon()
 {
-	STACKTRACE
-	int rx;
-	if (slot&lt;2)	rx = 9;
-	else rx = 13;
-	if (slot%2)	rx = -rx;
-	game-&gt;add(new TauStormMissile (this, rx, 10, angle, weaponAccel,
-				weaponVelocity, weaponTurnRate, target,
-				iround(weaponFuel*(1+weaponRandom*(100-random()%201)/100.0)), weaponThrust, weaponMass,
-				weaponBoosterSpeed, data-&gt;spriteWeapon,
-				weaponRotation, weaponStart, data-&gt;sampleWeapon[0]));
-	slot = (slot +1) % 6;
-	accelerate(this, angle+PI, weaponKick, weaponKickMaxspeed);
-    return true;
+  STACKTRACE;
+  int rx;
+  if (slot&lt;2)	
+    rx = 9;
+  else rx = 13;
+  if (slot%2)	rx = -rx;
+  game-&gt;add(new TauStormMissile (this, rx, 10, angle, weaponAccel,
+				 weaponVelocity, weaponTurnRate, target,
+				 iround(weaponFuel*(1+weaponRandom*(100-random()%201)/100.0)), 
+				 weaponThrust, weaponMass,
+				 weaponBoosterSpeed, data-&gt;spriteWeapon,
+				 weaponRotation, weaponStart, data-&gt;sampleWeapon[0]));
+  slot = (slot +1) % 6;
+  accelerate(this, angle+PI, weaponKick, weaponKickMaxspeed);
+  return true;
 }
 
 int TauStorm::activate_special()
 {
-	STACKTRACE
-	int rx;
-	if (slot&lt;2)	rx = 9;
-	else rx = 13;
-	if (slot%2)	rx = -rx;
-	game-&gt;add(new TauStormMissile (this, rx, 10, angle, specialAccel,
-			specialVelocity, specialTurnRate, target,
-			iround(specialFuel*(1+specialRandom*(100-random()%201)/100.0)), specialThrust, weaponMass,
-			specialBoosterSpeed, data-&gt;spriteSpecial,
-			specialRotation, specialStart, data-&gt;sampleSpecial[0]));
-	slot = (slot + 1) % 6;
-	accelerate(this, angle+PI, specialKick, specialKickMaxspeed);
-    return true;
+  STACKTRACE;
+  int rx;
+  if (slot&lt;2)	rx = 9;
+  else rx = 13;
+  if (slot%2)	rx = -rx;
+  game-&gt;add(new TauStormMissile (this, rx, 10, angle, specialAccel,
+				 specialVelocity, specialTurnRate, target,
+				 iround(specialFuel*(1+specialRandom*(100-random()%201)/100.0)), 
+				 specialThrust, weaponMass,
+				 specialBoosterSpeed, data-&gt;spriteSpecial,
+				 specialRotation, specialStart, data-&gt;sampleSpecial[0]));
+  slot = (slot + 1) % 6;
+  accelerate(this, angle+PI, specialKick, specialKickMaxspeed);
+  return true;
 }
 
 
 void TauStorm::animate(Frame *space)
 {
-	STACKTRACE
-	if (thrust)
-		sprite-&gt;animate(pos, sprite_index + 64, space);
-	else
-		sprite-&gt;animate(pos, sprite_index, space);
+  STACKTRACE;
+  if (thrust)
+    sprite-&gt;animate(pos, sprite_index + 64, space);
+  else
+    sprite-&gt;animate(pos, sprite_index, space);
 }
 
 
-TauStormMissile::TauStormMissile (SpaceLocation *creator, double ox, double oy, double oangle, double oaccel,
-				double ov, double otr, SpaceObject *otarget,
-				int ofuel, double othrust, double omass, double oboosterspeed,
-				SpaceSprite *osprite, double omr, double osv, SAMPLE *s) :
-	HomingMissile(creator, Vector2(ox,oy), oangle, ov, 1, 1e40, 1, otr, creator,  osprite, otarget),
-	fuel(ofuel), booster_speed(oboosterspeed),
-	thrust(othrust), accel(oaccel), rotation(omr)
-
+TauStormMissile::TauStormMissile (SpaceLocation *creator, double ox, double oy, 
+				  double oangle, double oaccel,
+				  double ov, double otr, SpaceObject *otarget,
+				  int ofuel, double othrust, double omass, double oboosterspeed,
+				  SpaceSprite *osprite, double omr, double osv, std::string s) :
+  HomingMissile(creator, Vector2(ox,oy), oangle, ov, 1, 1e40, 1, otr, creator,  osprite, otarget),
+  fuel(ofuel), booster_speed(oboosterspeed),
+  thrust(othrust), accel(oaccel), rotation(omr)
 {
-
-	latched = NULL;
-	mass = omass;
-
-	vel = vel*osv + creator-&gt;get_vel();
-
-	explosionSprite = data-&gt;spriteWeaponExplosion;
-	explosionFrameCount = 10;
-	explosionFrameSize = 50;
-	explosionSample = data-&gt;sampleExtra[0];
-
-	smoke_frame = 0;
-	first_frame = 12;
-
-	play_sound(s);
+  
+  latched = NULL;
+  mass = omass;
+  
+  vel = vel*osv + creator-&gt;get_vel();
+  
+  explosionSprite = data-&gt;spriteWeaponExplosion;
+  explosionFrameCount = 10;
+  explosionFrameSize = 50;
+  explosionSample = data-&gt;sampleExtra[0];
+  
+  smoke_frame = 0;
+  first_frame = 12;
+  
+  tw_sound-&gt;play_sound(data_full_path(s));
 }
 
 
 void TauStormMissile::calculate()
 {
-	STACKTRACE
-	if (latched) {
-
-		if (!latched-&gt;exists())
-			handle_damage(this, 999);
-
-		double alpha;
-		alpha = ((latched-&gt;get_angle() + pa));
-		pos = latched-&gt;normal_pos() + rr * unit_vector(latched-&gt;get_angle() + pa);
-
-		vel = latched-&gt;get_vel();
-
-		angle = normalize(ra + latched-&gt;get_angle(), PI2);
-		sprite_index = iround(angle / (PI2/64)) + 16;
-		sprite_index &amp;= 63;
-
-		double jr = (latched-&gt;size.x/2.0);
-		if (latched-&gt;mass &gt; 1) {
-			latched-&gt;accelerate(this, angle, thrust * frame_time / latched-&gt;mass, booster_speed);
-			jr *= jr * 0.5 * latched-&gt;mass; }
-		else {
-			latched-&gt;accelerate(this, angle, thrust * frame_time, booster_speed);
-			jr *= jr * 0.5; }
-
-		if (latched-&gt;isShip())
-			((Ship*)latched)-&gt;turn_step += rotation * 1000 * rt * frame_time / jr;
-		else
-			latched-&gt;angle += rotation * 1000 * rt * frame_time / jr;
-	};
-
-              
-	if (smoke_frame &gt; 0) smoke_frame -= frame_time;
-	else {
-		while (smoke_frame &lt;= 0)
-			smoke_frame += 25;
-		game-&gt;add(new Animation(this, pos, data-&gt;spriteExtra,
-			first_frame, 20-first_frame, 50, LAYER_HOTSPOTS));
-		if (first_frame &gt; 0) first_frame -= 3; }
-
-
-	if (fuel &gt; 0) {
-		fuel -= frame_time;	
-		Vector2 ov = vel;
-		HomingMissile::calculate();
-		vel = ov;
-		accelerate(this, angle, accel*frame_time, v); }
-	else {
-		if (latched)
-			damage(latched, 0, 1);
-		handle_damage(this, 999); }
+  STACKTRACE;
+  if (latched) 
+    {
+      if (!latched-&gt;exists())
+	handle_damage(this, 999);
+      
+      double alpha;
+      alpha = ((latched-&gt;get_angle() + pa));
+      pos = latched-&gt;normal_pos() + rr * unit_vector(latched-&gt;get_angle() + pa);
+      
+      vel = latched-&gt;get_vel();
+      
+      angle = normalize(ra + latched-&gt;get_angle(), PI2);
+      sprite_index = iround(angle / (PI2/64)) + 16;
+      sprite_index &amp;= 63;
+      
+      double jr = (latched-&gt;size.x/2.0);
+      if (latched-&gt;mass &gt; 1) {
+	latched-&gt;accelerate(this, angle, thrust * frame_time / latched-&gt;mass, booster_speed);
+	jr *= jr * 0.5 * latched-&gt;mass; }
+      else {
+	latched-&gt;accelerate(this, angle, thrust * frame_time, booster_speed);
+	jr *= jr * 0.5; }
+      
+      if (latched-&gt;isShip())
+	((Ship*)latched)-&gt;turn_step += rotation * 1000 * rt * frame_time / jr;
+      else
+	latched-&gt;angle += rotation * 1000 * rt * frame_time / jr;
+    };
+  
+  
+  if (smoke_frame &gt; 0) smoke_frame -= frame_time;
+  else {
+    while (smoke_frame &lt;= 0)
+      smoke_frame += 25;
+    game-&gt;add(new Animation(this, pos, data-&gt;spriteExtra,
+			    first_frame, 20-first_frame, 50, LAYER_HOTSPOTS));
+    if (first_frame &gt; 0) first_frame -= 3; }
+  
+  
+  if (fuel &gt; 0) {
+    fuel -= frame_time;	
+    Vector2 ov = vel;
+    HomingMissile::calculate();
+    vel = ov;
+    accelerate(this, angle, accel*frame_time, v); }
+  else {
+    if (latched)
+      damage(latched, 0, 1);
+    handle_damage(this, 999); }
 }
 
 void TauStormMissile::inflict_damage (SpaceObject *other)
 {
-	STACKTRACE
-
-	if (latched || other-&gt;isShot()) return;
-	latched = other;
-	rr = distance(other);
-	ra = angle - other-&gt;get_angle();
-	pa = other-&gt;trajectory_angle(this) - other-&gt;get_angle();
-	rt = thrust * rr * sin((angle-other-&gt;trajectory_angle(this)));
-
-//	play_sound
+  if (latched || other-&gt;isShot()) return;
+  latched = other;
+  rr = distance(other);
+  ra = angle - other-&gt;get_angle();
+  pa = other-&gt;trajectory_angle(this) - other-&gt;get_angle();
+  rt = thrust * rr * sin((angle-other-&gt;trajectory_angle(this)));
 }
 
 void TauStormMissile::handle_damage (SpaceObject *other, double normal, double direct)
 {
-	STACKTRACE
-	Shot::handle_damage(other, normal, direct);
-	if ((state == 0) &amp;&amp; (other-&gt;isShot()))
-		damage(other, 1);
+  Shot::handle_damage(other, normal, direct);
+  if ((state == 0) &amp;&amp; (other-&gt;isShot()))
+    damage(other, 1);
 }
 
 int TauStormMissile::canCollide(SpaceLocation *other)
 {
-	STACKTRACE
-	if (other == latched) return false;
-	return Shot::canCollide(other);
+  STACKTRACE;
+  if (other == latched) return false;
+  return Shot::canCollide(other);
 }
 
 

Modified: branches/multiplayer-branch/source/ships/shptauto.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shptauto.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ships/shptauto.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -18,8 +18,6 @@
 #include &quot;ship.h&quot;
 #include &quot;melee/mview.h&quot;
 
-REGISTER_FILE
-
 class TauTor : public Ship
 {
   double        weaponRange;
@@ -53,7 +51,6 @@
 
 class TauTorTwister : public AnimatedShot
 {
-  // SAMPLE* sample_midd;
   
   public:
   
@@ -80,6 +77,7 @@
         Ship(opos, shipAngle, shipData, code)
 
 {
+  STACKTRACE;
         weaponRange     = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
         weaponVelocity  = scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
         weaponDamage    = get_config_int(&quot;Weapon&quot;, &quot;Damage&quot;, 0);
@@ -109,6 +107,7 @@
 
 int TauTor::activate_weapon()
 {
+  STACKTRACE;
         if (transition_count &gt; 0) return false;
 
         if (TauTor_state) {
@@ -128,111 +127,130 @@
 
 void TauTor::calculate_fire_special()
 {
-        special_low = false;
-        if (fire_special &amp;&amp; can_switch &amp;&amp; (transition_count &lt;=0)) {
-                can_switch = false;
-                if (TauTor_state) {
-                        play_sound(data-&gt;sampleExtra[1]);
-                        residual_drain = 0.0;
-                        recharge_amount = extra_recharge;
-                        weapon_rate  = extra_rate;
-                        weapon_drain = extra_drain;
-                        sprite = data-&gt;spriteShip;
-                        TauTor_state = false; }
-                else    if (batt &gt; switch_drain) {
-                                transition_count = transition_time;
-                                residual_drain = 0.0;
-                                recharge_amount = 0;
-                                play_sound(data-&gt;sampleExtra[0]);
-                                weapon_rate  = special_rate;
-                                weapon_drain = special_drain; }
-                        else    special_low = true; }
+  STACKTRACE;
+  special_low = false;
+  if (fire_special &amp;&amp; can_switch &amp;&amp; (transition_count &lt;=0)) 
+    {
+      can_switch = false;
+      if (TauTor_state) 
+	{
+	  tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleExtra[1]));
+	  residual_drain = 0.0;
+	  recharge_amount = extra_recharge;
+	  weapon_rate  = extra_rate;
+	  weapon_drain = extra_drain;
+	  sprite = data-&gt;spriteShip;
+	  TauTor_state = false; 
+	}
+      else if (batt &gt; switch_drain) 
+	{
+	  transition_count = transition_time;
+	  residual_drain = 0.0;
+	  recharge_amount = 0;
+	  tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleExtra[0]));
+	  weapon_rate  = special_rate;
+	  weapon_drain = special_drain; 
+	}
+      else    
+	special_low = true; 
+    }
 }
 
 void TauTor::calculate()
 {
-		
-        if (transition_count &gt; 0) {
-                if ((transition_count -= frame_time) &lt;= 0) {
-                        sprite = data-&gt;spriteExtraExplosion;
-                        TauTor_state = true; }
-                residual_drain += switch_drain * frame_time / (double)transition_time; }
-        int a = (int)floor(residual_drain);
-        batt -= a;
-        residual_drain -= a;
-        if (batt &lt; 0) batt = 0;
-
-        if (TauTor_state &amp;&amp; (batt == 0)) {
-                play_sound(data-&gt;sampleExtra[1]);
-                residual_drain = 0.0;
-                recharge_amount = extra_recharge;
-                weapon_rate  = extra_rate;
-                weapon_drain = extra_drain;
-                sprite = data-&gt;spriteShip;
-                TauTor_state = false; }
-        
-        Ship::calculate();
-        if (!fire_special) can_switch = true;
+  STACKTRACE;
+  if (transition_count &gt; 0) 
+    {
+      if ((transition_count -= frame_time) &lt;= 0) 
+	{
+	  sprite = data-&gt;spriteExtraExplosion;
+	  TauTor_state = true; 
+	}
+      residual_drain += switch_drain * frame_time / (double)transition_time; 
+    }
+  int a = (int)floor(residual_drain);
+  batt -= a;
+  residual_drain -= a;
+  if (batt &lt; 0)
+    batt = 0;
+  
+  if (TauTor_state &amp;&amp; (batt == 0)) 
+    {
+      tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleExtra[1]));
+      residual_drain = 0.0;
+      recharge_amount = extra_recharge;
+      weapon_rate  = extra_rate;
+      weapon_drain = extra_drain;
+      sprite = data-&gt;spriteShip;
+      TauTor_state = false; 
+    }
+  
+  Ship::calculate();
+  if (!fire_special) 
+    can_switch = true;
 }
 
 void TauTor::calculate_thrust()
 {
-
-        if (thrust &amp;&amp; (transition_count &lt;=0)) {
-                if (TauTor_state &amp;&amp; (batt &gt; 0)) {
-                        residual_drain += engine_drain * frame_time;
-                        accelerate(this, angle, accel_rate * frame_time * accel_boost, speed_max * speed_boost); }
-                else    accelerate(this, angle, accel_rate * frame_time, speed_max); }
+  STACKTRACE;
+  if (thrust &amp;&amp; (transition_count &lt;=0)) 
+    {
+      if (TauTor_state &amp;&amp; (batt &gt; 0)) 
+	{
+	  residual_drain += engine_drain * frame_time;
+	  accelerate(this, angle, accel_rate * frame_time * accel_boost, speed_max * speed_boost); 
+	}
+      else    
+	accelerate(this, angle, accel_rate * frame_time, speed_max); 
+    }
 }
 
 void TauTor::calculate_hotspots ()
 {
-	if((thrust) &amp;&amp; (hotspot_frame &lt;= 0) &amp;&amp; (transition_count &lt;=0)) {
-                if (TauTor_state &amp;&amp; (batt &gt; 0))
-			add(new Animation(this, 
-					  //normal_x() - (cos(angle * ANGLE_RATIO) * 21),
-					  //normal_y() - (sin(angle * ANGLE_RATIO) * 21),
-					  normal_pos() - 21 * unit_vector(angle),
-					  data-&gt;spriteExtra, 0, 12, time_ratio, LAYER_HOTSPOTS));
-		else	add(new Animation(this, 
-					  //normal_x() - (cos(angle * ANGLE_RATIO) * 21),
-					  //normal_y() - (sin(angle * ANGLE_RATIO) * 21),
-					  normal_pos() - 21 * unit_vector(angle),
-					  meleedata.hotspotSprite, 0, HOTSPOT_FRAMES, time_ratio, LAYER_HOTSPOTS));
-		hotspot_frame += hotspot_rate; }
-	if (hotspot_frame &gt; 0) hotspot_frame -= frame_time;
-	return;
+  if((thrust) &amp;&amp; (hotspot_frame &lt;= 0) &amp;&amp; (transition_count &lt;=0)) 
+    {
+      if (TauTor_state &amp;&amp; (batt &gt; 0))
+	add(new Animation(this, 
+			  normal_pos() - 21 * unit_vector(angle),
+			  data-&gt;spriteExtra, 0, 12, time_ratio, LAYER_HOTSPOTS));
+      else	
+	add(new Animation(this, 
+			  normal_pos() - 21 * unit_vector(angle),
+			  game-&gt;meleedata.hotspotSprite, 0, HOTSPOT_FRAMES, time_ratio, LAYER_HOTSPOTS));
+      hotspot_frame += hotspot_rate; 
+    }
+  if (hotspot_frame &gt; 0) 
+    hotspot_frame -= frame_time;
+  return;
 }
 
 
 TauTorTwister::TauTorTwister(Vector2 opos, double oangle, double ov, int odamage,
-                                 double orange, int oarmour, SpaceLocation *creator, SpaceLocation *lpos,
-                                 SpaceSprite *osprite, int ofcount, int ofsize, double relativity) :
-        AnimatedShot(creator, opos, oangle, ov, odamage, orange, oarmour,
-        lpos, osprite, ofcount, ofsize, relativity)
+			     double orange, int oarmour, SpaceLocation *creator, SpaceLocation *lpos,
+			     SpaceSprite *osprite, int ofcount, int ofsize, double relativity) :
+  AnimatedShot(creator, opos, oangle, ov, odamage, orange, oarmour,
+	       lpos, osprite, ofcount, ofsize, relativity)
 {
-        explosionSprite     = data-&gt;spriteWeaponExplosion;
-        explosionFrameCount = 12;
-        explosionFrameSize  = 50;
-        //sample_midd         = data-&gt;sampleSpecial[0];
+  STACKTRACE;
+  explosionSprite     = data-&gt;spriteWeaponExplosion;
+  explosionFrameCount = 12;
+  explosionFrameSize  = 50;
 }
 
 
 TauTorPlasma::TauTorPlasma(Vector2 opos, double oangle, double ov, int odamage,
-                               double orange, int oarmour, SpaceLocation *creator, SpaceLocation *lpos,
-                               SpaceSprite *osprite, int ofcount, int ofsize, double relativity) :
+			   double orange, int oarmour, SpaceLocation *creator, SpaceLocation *lpos,
+			   SpaceSprite *osprite, int ofcount, int ofsize, double relativity) :
         AnimatedShot(creator, opos, oangle, ov, odamage, orange, oarmour,
-        lpos, osprite, ofcount, ofsize, relativity)
+		     lpos, osprite, ofcount, ofsize, relativity)
 {
-        explosionSprite     = data-&gt;spriteSpecialExplosion;
-        explosionFrameCount = 12;
-        explosionFrameSize  = 50;
-
+  STACKTRACE;
+  explosionSprite     = data-&gt;spriteSpecialExplosion;
+  explosionFrameCount = 12;
+  explosionFrameSize  = 50;
+  
 }
 
-
-
-
-
 REGISTER_SHIP(TauTor)
-
+  
+  

Modified: branches/multiplayer-branch/source/ships/shpwolmi.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpwolmi.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ships/shpwolmi.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -17,7 +17,6 @@
 
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 #include &quot;frame.h&quot;
 
@@ -75,6 +74,7 @@
 :
 Ship(opos,  shipAngle, shipData, code)
 {
+  STACKTRACE;
 	
 	weaponRange    = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
 	weaponVelocity = scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
@@ -88,8 +88,8 @@
 
 
 int Wolly::activate_weapon()
-{	
-	STACKTRACE;
+{
+  STACKTRACE;
 	
 
 	Vector2 rpos;
@@ -106,7 +106,7 @@
 
 int Wolly::activate_special()
 {
-	STACKTRACE;
+  STACKTRACE;
 
 	WollyMine *o;
 	Vector2 rpos;
@@ -130,6 +130,7 @@
 :
 Shot(creator, rpos, oangle, ov, odamage, orange, oarmour, opos, osprite, relativity)
 {
+  STACKTRACE;
 	default_range = orange;
 
 	collide_flag_anyone = ALL_LAYERS;
@@ -141,7 +142,7 @@
 
 int WollyPlasma::handle_damage(SpaceLocation *source, double normal, double direct)
 {
-	STACKTRACE;
+  STACKTRACE;
 
 	armour += normal + direct;
 
@@ -165,7 +166,7 @@
 
 void WollyPlasma::calculate()
 {
-	STACKTRACE;
+  STACKTRACE;
 	
 	Shot::calculate();
 
@@ -192,6 +193,7 @@
 
 int WollyPlasma::canCollide(SpaceLocation *other)
 {
+  STACKTRACE;
 	if (other-&gt;id == ID_WOLLYPLASMA)
 		return FALSE;
 		
@@ -207,6 +209,7 @@
 :
 SpaceObject(creator, opos, oangle, osprite)
 {
+  STACKTRACE;
 	lifetime = olifetime;
 	existtime = 0;
 
@@ -226,6 +229,7 @@
 
 void WollyMine::calculate()
 {
+  STACKTRACE;
 	SpaceObject::calculate();
 
 	existtime += frame_time * 1E-3;
@@ -240,6 +244,7 @@
 
 int WollyMine::handle_damage(SpaceLocation *source, double normal, double direct)
 {
+  STACKTRACE;
 	state = 0;
 	return true;
 }

Modified: branches/multiplayer-branch/source/ships/shpyusra.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpyusra.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ships/shpyusra.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -16,7 +16,6 @@
 */
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 #include &quot;other/objanim.h&quot;
 
 class YushSpear;
@@ -69,6 +68,7 @@
   ShipData *shipData, unsigned int code ):
   Ship( opos, shipAngle, shipData, code )
 {
+  STACKTRACE;
   weaponRange    = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
   weaponVelocity = scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
   weaponDamage   = get_config_int(&quot;Weapon&quot;, &quot;Damage&quot;, 0);
@@ -78,7 +78,7 @@
 }
 
 int YushRanger::activate_weapon(){
-	STACKTRACE
+  STACKTRACE;
   if( weaponObject ) return FALSE;
   game-&gt;add( weaponObject = new YushSpear( this, Vector2(0, 0.5*get_size().y), angle, weaponVelocity,
     weaponDamage, weaponRange, weaponArmour, weaponControl, this, data-&gt;spriteWeapon ));
@@ -86,7 +86,7 @@
 }
 
 int YushRanger::activate_special(){
-	STACKTRACE;
+  STACKTRACE;
 	double alpha = atan3(vel.y, vel.x);
 	alpha = normalize(alpha, PI2);
 	double v = vel.length();		//sqrt( vx*vx + vy*vy );
@@ -107,17 +107,17 @@
 }
 
 void YushRanger::calculate_turn_left(){
-	STACKTRACE;
+  STACKTRACE;
 	if( !fire_weapon ) Ship::calculate_turn_left();
 }
 
 void YushRanger::calculate_turn_right(){
-	STACKTRACE;
+  STACKTRACE;
   if( !fire_weapon ) Ship::calculate_turn_right();
 }
 
 void YushRanger::calculate(){
-	STACKTRACE;
+  STACKTRACE;
   Ship::calculate();
   if( weaponObject ){
     if( !weaponObject-&gt;exists() || weaponObject-&gt;released ){
@@ -137,11 +137,12 @@
 control( ocontrol ), 
 released( false )
 {
+  STACKTRACE;
 }
 
 void YushSpear::calculate()
 {
-	STACKTRACE;
+  STACKTRACE;
 
 	if (latched)
 	{
@@ -191,33 +192,39 @@
 }
 
 void YushSpear::release(){
+  STACKTRACE;
 	released = true;
 }
 
 void YushSpear::inflict_damage( SpaceObject* other )
 {
-	STACKTRACE;
-	if( latched || other-&gt;isShot() ) return;
-	if( !other-&gt;isAsteroid() ) Shot::inflict_damage( other );
-	state = 1;                   // don't want to die on contact
-	attributes &amp;= ~ATTRIB_SHOT;  // not a shot anymore
-	released = true;
-	latched = other;
-	rel_angle = other-&gt;trajectory_angle( this ) - other-&gt;get_angle();
-	old_angle = angle - other-&gt;get_angle();
-	rel_dist = distance( other );
-	change_owner( other );       // are now part of the other ship
-	play_sound2( data-&gt;sampleWeapon[1 + random() % 2] );
+  STACKTRACE;
+  if( latched || other-&gt;isShot() ) return;
+  if( !other-&gt;isAsteroid() ) Shot::inflict_damage( other );
+  state = 1;                   // don't want to die on contact
+  attributes &amp;= ~ATTRIB_SHOT;  // not a shot anymore
+  released = true;
+  latched = other;
+  rel_angle = other-&gt;trajectory_angle( this ) - other-&gt;get_angle();
+  old_angle = angle - other-&gt;get_angle();
+  rel_dist = distance( other );
+  change_owner( other );       // are now part of the other ship
+  std::string smpl = data-&gt;sampleWeapon[1 + random() % 2];
+  tw_sound-&gt;stop_sound(data_full_path(smpl));
+  tw_sound-&gt;play_sound(data_full_path(smpl));
 }
 
-int YushSpear::handle_damage( SpaceLocation* other, double normal, double direct ){
-	STACKTRACE;
-	if( latched ){
-		latched-&gt;handle_damage( other, normal, direct );
-		// commenting out the following two lines makes the spears vulnerable to damage
-		normal = direct = 0;
-	}
-	return Shot::handle_damage( other, normal, direct );
+int YushSpear::handle_damage( SpaceLocation* other, double normal, double direct )
+{
+  STACKTRACE;
+  if( latched )
+    {
+      latched-&gt;handle_damage( other, normal, direct );
+      // commenting out the following two lines makes the spears vulnerable to damage
+      normal = direct = 0;
+    }
+  return Shot::handle_damage( other, normal, direct );
 }
 
 REGISTER_SHIP(YushRanger)
+  

Modified: branches/multiplayer-branch/source/ships/shpzeksh.cpp
===================================================================
--- branches/multiplayer-branch/source/ships/shpzeksh.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/ships/shpzeksh.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -18,7 +18,6 @@
 //ZekfahanShocker lousy code by <A HREF="https://lists.berlios.de/mailman/listinfo/tw-light-svn">Richardyzo at ig.com.br</A>
 
 #include &quot;ship.h&quot;
-REGISTER_FILE
 
 class ZekfahanShocker : public Ship {
   double       weaponRange;
@@ -61,6 +60,7 @@
 	:
   Ship(opos, shipAngle, shipData, code)
 {
+  STACKTRACE;
   weaponRange    = scale_range(get_config_float(&quot;Weapon&quot;, &quot;Range&quot;, 0));
   weaponVelocity = scale_velocity(get_config_float(&quot;Weapon&quot;, &quot;Velocity&quot;, 0));
   weaponDamage   = get_config_int(&quot;Weapon&quot;, &quot;Damage&quot;, 0);
@@ -77,66 +77,59 @@
 
 int ZekfahanShocker::activate_weapon()
 {
-	STACKTRACE
-	play_sound2(data-&gt;sampleWeapon[0]);
+  STACKTRACE;
+  tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleWeapon[0]));
+  tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleWeapon[0]));
+  
   add(new AnimatedShot(this, Vector2(42.0, 15.0), angle , weaponVelocity,
-    weaponDamage, weaponRange, weaponArmour, this, data-&gt;spriteWeapon, 5, 12, 1.0));
+		       weaponDamage, weaponRange, weaponArmour, this, data-&gt;spriteWeapon, 5, 12, 1.0));
   add(new AnimatedShot(this, Vector2(-42.0, 15.0), angle , weaponVelocity,
-    weaponDamage, weaponRange, weaponArmour, this, data-&gt;spriteWeapon, 5, 12, 1.0));
+		       weaponDamage, weaponRange, weaponArmour, this, data-&gt;spriteWeapon, 5, 12, 1.0));
   return(TRUE);
 }
 
-int ZekfahanShocker::activate_special() {
-	STACKTRACE
+int ZekfahanShocker::activate_special() 
+{
+  STACKTRACE;
   if(shockingFrames == 0)
-  {
-	play_sound2(data-&gt;sampleSpecial[0]);
-        shockingFrames = specialFrames;
-	shockVar = 1;
-	recharge_amount = 0;
-  }
+    {
+      tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleSpecial[0]));
+      tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleSpecial[0]));
+      
+      shockingFrames = specialFrames;
+      shockVar = 1;
+      recharge_amount = 0;
+    }
   return(TRUE);
 }
 
 void ZekfahanShocker::calculate()
-{ 
-	STACKTRACE
+{
+  STACKTRACE; 
   if(shockVar == 1)
   {
-   if(shockingFrames &gt; 0) {
-     shockingFrames -= frame_time;
-     }
-   if(shockingFrames % 500 == 0 ) {
-     add( new FixedAnimation(this, this, data-&gt;spriteSpecial, 0, 6, 30, LAYER_EXPLOSIONS));
-     }
-   /*
-   if(shockingFrames == 2000 ) {
-	play_sound2(data-&gt;sampleSpecial[0]);
-     add( new FixedAnimation(this, this, data-&gt;spriteSpecial, 0, 6, 30, LAYER_EXPLOSIONS));
-     }
-   if(shockingFrames == 1500 ) {
-	play_sound2(data-&gt;sampleSpecial[0]);
-     add( new FixedAnimation(this, this, data-&gt;spriteSpecial, 0, 6, 30, LAYER_EXPLOSIONS));
-     }
-   if(shockingFrames == 1000 ) {
-	play_sound2(data-&gt;sampleSpecial[0]);
-     add( new FixedAnimation(this, this, data-&gt;spriteSpecial, 0, 6, 30, LAYER_EXPLOSIONS));
-     }
-   if(shockingFrames == 500 ) {
-	play_sound2(data-&gt;sampleSpecial[0]);
-     add( new FixedAnimation(this, this, data-&gt;spriteSpecial, 0, 6, 30, LAYER_EXPLOSIONS));
-     }
-	 */
-   if(shockVar &amp;&amp; shockingFrames &lt;= 50 )
-   {
-	play_sound2(data-&gt;sampleSpecial[1]);
-     add( new Shockwave(Vector2(0, 70), angle , specialVelocity, specialDamage, specialRange, specialArmour, this, this, data-&gt;spriteSpecial, 2, 50));
-     shockingFrames = 0;
-     shockVar = 0;
-     recharge_amount = 1;
-     }
+    if(shockingFrames &gt; 0) 
+      {
+	shockingFrames -= frame_time;
+      }
+    if(shockingFrames % 500 == 0 ) 
+      {
+	add( new FixedAnimation(this, this, data-&gt;spriteSpecial, 0, 6, 30, LAYER_EXPLOSIONS));
+      }
+    if(shockVar &amp;&amp; shockingFrames &lt;= 50 )
+      {
+	tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleSpecial[1]));
+	tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleSpecial[1]));
+	
+	add( new Shockwave(Vector2(0, 70), angle , specialVelocity, 
+			   specialDamage, specialRange, specialArmour, this, this, 
+			   data-&gt;spriteSpecial, 2, 50));
+	shockingFrames = 0;
+	shockVar = 0;
+	recharge_amount = 1;
+      }
   }
-   Ship::calculate();
+  Ship::calculate();
 }
 
 Shockwave::Shockwave(Vector2 oposvec, double oangle, double ov,
@@ -144,16 +137,20 @@
   SpaceSprite *osprite, int ofcount, int ofsize) :
   AnimatedShot(oship, oposvec, oangle, ov, odamage, orange, oarmour, oship, osprite, ofcount, ofsize)
 {
+  STACKTRACE;
   collide_flag_anyone = (ALL_LAYERS);
 }
 
-void Shockwave::inflict_damage(SpaceObject *other) {
-	STACKTRACE
-	play_sound2(data-&gt;sampleSpecial[2]);
-	damage(other, 0, damage_factor);
-	add( new Animation(this, pos, data-&gt;spriteSpecial, 0, 6, 30, LAYER_EXPLOSIONS));
-	return;
-	}
+void Shockwave::inflict_damage(SpaceObject *other) 
+{
+  STACKTRACE;
+  tw_sound-&gt;stop_sound(data_full_path(data-&gt;sampleSpecial[2]));
+  tw_sound-&gt;play_sound(data_full_path(data-&gt;sampleSpecial[2]));
+ 
+  damage(other, 0, damage_factor);
+  add( new Animation(this, pos, data-&gt;spriteSpecial, 0, 6, 30, LAYER_EXPLOSIONS));
+  return;
+}
 
 
 

Modified: branches/multiplayer-branch/source/twgui/twbutton.cpp
===================================================================
--- branches/multiplayer-branch/source/twgui/twbutton.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/twgui/twbutton.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -23,8 +23,6 @@
 
 #include &quot;melee.h&quot;
 
-REGISTER_FILE
-
 #include &quot;twbutton.h&quot;
 #include &quot;twwindow.h&quot;
 #include &quot;other/twconfig.h&quot;
@@ -33,6 +31,7 @@
 
 EmptyButton::EmptyButton(TWindow *menu, char *identbranch, int asciicode, bool akeepkey)
 {
+  STACKTRACE;
   prev = 0;
   next = 0;
   selected = false;
@@ -80,6 +79,7 @@
 
 bool EmptyButton::hasmouse()
 {
+  STACKTRACE;
   return (mainwindow-&gt;mpos.x &gt;= pos.x &amp;&amp;
 	  mainwindow-&gt;mpos.y &gt;= pos.y &amp;&amp;
 	  mainwindow-&gt;mpos.x &lt; (pos+size).x &amp;&amp;
@@ -90,11 +90,13 @@
 
 bool EmptyButton::haskey()
 {
+  STACKTRACE;
   return flag.haskey;
 }
 
 bool EmptyButton::haskeypress()
 {
+  STACKTRACE;
   return flag.haskeypress;
 }
 
@@ -104,6 +106,7 @@
 // made for the detection flag
 void EmptyButton::check_key()
 {
+  STACKTRACE;
   // this is usually the case.
   flag.haskey = false;
   flag.haskeypress = false;
@@ -159,7 +162,8 @@
 
 
 void EmptyButton::handle_focus()
-{	
+{
+  STACKTRACE;	
   //mainwindow-&gt;setfocus(this);
   
   //focus = 1;
@@ -171,7 +175,8 @@
 
 
 void EmptyButton::handle_defocus()
-{	
+{
+  STACKTRACE;	
   flag.focus = false;
   
   //	if (button_event)
@@ -181,6 +186,7 @@
 
 void EmptyButton::check_focus()
 {
+  STACKTRACE;
   flag.lastfocus = flag.focus;
   
   if (haskey())
@@ -217,6 +223,7 @@
 // calls to calculate aren't made...
 void EmptyButton::handle_menu_focus_loss()
 {
+  STACKTRACE;
   selected = 0;
   //update_key();
   flag.reset();
@@ -224,6 +231,7 @@
 
 void EmptyButton::calculate()
 {
+  STACKTRACE;
   
   // copy information from the TWindow manager
   //	update_mouse();
@@ -299,12 +307,14 @@
 
 void EmptyButton::animate()
 {
+  STACKTRACE;
 }
 	
 
 
 EmptyButton::flag_struct::flag_struct()
 {
+  STACKTRACE;
 	// these flags are updated by the area's calculate function.
 //	focus = 0;
 //	left_mouse_press = left_mouse_release = left_mouse_hold = 0;
@@ -315,6 +325,7 @@
 
 void EmptyButton::flag_struct::reset()
 {
+  STACKTRACE;
   // these flags are updated by the area's calculate function.
   focus = 0;
   left_mouse_press = left_mouse_release = left_mouse_hold = 0;
@@ -325,6 +336,7 @@
 
 bool EmptyButton::isvalid()
 {
+  STACKTRACE;
   return true;
 }
 
@@ -340,11 +352,13 @@
 :
 EmptyButton(menu, identbranch, asciicode, akeepkey)
 {
+  STACKTRACE;
 //	mainwindow-&gt;scalepos(&amp;x, &amp;y);
 }
 
 void GraphicButton::locate(int ax, int ay)
 {
+  STACKTRACE;
   pos.x = ax;
   pos.y = ay;
   mainwindow-&gt;scalepos(&amp;pos);
@@ -357,6 +371,7 @@
 
 void GraphicButton::animate()
 {
+  STACKTRACE;
   // check if button 1 (left) releases -&gt; clicks for this item
   // unconditional drawing:
   if (flag.focus)
@@ -374,14 +389,17 @@
 
 void GraphicButton::draw_default()
 {
+  STACKTRACE;
 }
 
 void GraphicButton::draw_focus()
 {
+  STACKTRACE;
 }
 
 void GraphicButton::draw_selected()
 {
+  STACKTRACE;
 }
 
 
@@ -406,6 +424,7 @@
 // check a square area to see if it has the mouse on it.
 bool GraphicButton::hasmouse(BITMAP *bmpref)
 {
+  STACKTRACE;
   // first, check the square bitmap area
   if (EmptyButton::hasmouse())
     {
@@ -422,6 +441,7 @@
 
 void GraphicButton::draw_rect()
 {
+  STACKTRACE;
   BITMAP *b = mainwindow-&gt;drawarea;
   int x1, y1, x2, y2;
   
@@ -460,6 +480,7 @@
 
 void GraphicButton::draw_rect_fancy()
 {
+  STACKTRACE;
   BITMAP *b = mainwindow-&gt;drawarea;
   int x1, y1, x2, y2;
   
@@ -530,6 +551,7 @@
 
 void GraphicButton::draw_boundaries(BITMAP *bmpref)
 {
+  STACKTRACE;
   BITMAP *b = mainwindow-&gt;drawarea;
   
   int i, j;
@@ -576,6 +598,7 @@
 */
 void GraphicButton::locate_by_backgr(char *strid)
 {
+  STACKTRACE;
   char stron[128];
   strcpy(stron,  ident);
   strcat(stron,  strid);
@@ -631,6 +654,7 @@
 // obtain a bitmap, specific to this &quot;object&quot; :
 BITMAP *GraphicButton::getbmp(char *name)
 {
+  STACKTRACE;
   char streditbox[128];
   strcpy(streditbox,  ident);
   strcat(streditbox,  name);
@@ -643,6 +667,7 @@
 // obtain a bitmap using &quot;absolute&quot; path, so that it can come from anywhere...
 BITMAP *GraphicButton::getbmp_nobutton(char *name)
 {
+  STACKTRACE;
   // a background image is needed of course.
   return mainwindow-&gt;bmp(name);
 }
@@ -652,6 +677,7 @@
 
 void GraphicButton::init_pos_size(BITMAP **bmp_default, char *idstr)
 {
+  STACKTRACE;
   *bmp_default = getbmp(idstr);
   
   if (*bmp_default)
@@ -677,6 +703,7 @@
 
 bool GraphicButton::draw(BITMAP *b)
 {
+  STACKTRACE;
   if (b)
     {
       masked_blit(b, mainwindow-&gt;drawarea, 0, 0, pos.x, pos.y, b-&gt;w, b-&gt;h);

Modified: branches/multiplayer-branch/source/twgui/twbuttontypes.cpp
===================================================================
--- branches/multiplayer-branch/source/twgui/twbuttontypes.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/twgui/twbuttontypes.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -21,7 +21,6 @@
 
 #include &quot;melee.h&quot;
 #include &quot;melee/mview.h&quot;
-REGISTER_FILE
 
 #include &quot;twwindow.h&quot;
 #include &quot;twbuttontypes.h&quot;
@@ -37,6 +36,7 @@
 :
 GraphicButton(menu, identbranch, asciicode, akeepkey)
 {
+  STACKTRACE;
 	init_pos_size(&amp;bmp_default, &quot;default&quot;);
 
 	bmp_focus = getbmp(&quot;focus&quot;);
@@ -55,11 +55,13 @@
 // this is the default drawing (at rest):
 void Button::draw_default()
 {
+  STACKTRACE;
 	draw(bmp_default);
 }
 
 void Button::draw_focus()
 {
+  STACKTRACE;
 	if (!draw(bmp_focus))
 	{
 		draw_default();
@@ -69,6 +71,7 @@
 
 void Button::draw_selected()
 {
+  STACKTRACE;
 	if (!draw(bmp_selected))
 		draw_default();
 }
@@ -76,12 +79,14 @@
 
 bool Button::hasmouse()
 {
+  STACKTRACE;
 	return GraphicButton::hasmouse(bmp_default);
 }
 
 
 bool Button::isvalid()
 {
+  STACKTRACE;
 	return bmp_default != 0;
 };
 
@@ -92,6 +97,7 @@
 :
 GraphicButton(menu, identbranch, asciicode, akeepkey)
 {
+  STACKTRACE;
 	init_pos_size(&amp;backgr, &quot;backgr&quot;);
 
 	markfordeletion = true;
@@ -106,6 +112,7 @@
 
 void Area::changebackgr(char *fname)
 {
+  STACKTRACE;
 	BITMAP *newb;
 	//newb = getbmp(fname);
 	newb = getbmp_nobutton(fname);
@@ -123,6 +130,7 @@
 
 void Area::changebackgr(BITMAP *newb)
 {
+  STACKTRACE;
 	if (newb)
 	{
 		if (markfordeletion)
@@ -135,6 +143,7 @@
 
 void Area::overwritebackgr(BITMAP *newb, double scale, int col)
 {
+  STACKTRACE;
 	if (newb &amp;&amp; backgr)
 	{
 		clear_to_color(backgr, col);
@@ -147,12 +156,14 @@
 
 void Area::animate()
 {
+  STACKTRACE;
 	draw(backgr);
 }
 
 
 bool Area::hasmouse()
 {
+  STACKTRACE;
 	// the first rough check whether it's in the boxed bitmap area
 	return GraphicButton::hasmouse(backgr);
 }
@@ -160,6 +171,7 @@
 
 bool Area::isvalid()
 {
+  STACKTRACE;
 	return backgr != 0;
 };
 
@@ -176,6 +188,7 @@
 :
 Area(menu, identbranch, asciicode, akeepkey)
 {
+  STACKTRACE;
 
 	//init_pos_size(&amp;backgr, &quot;backgr&quot;);
 
@@ -197,6 +210,7 @@
 
 void AreaTablet::animate()
 {
+  STACKTRACE;
 	blit(backgr, drawarea, 0, 0, 0, 0, iround(size.x), iround(size.y));
 
 	subanimate();
@@ -208,6 +222,7 @@
 
 void AreaTablet::subanimate()
 {
+  STACKTRACE;
 	// nothing; you can put extra drawing commands here, stuff that's drawn onto
 	// the background before being blitted onto the reserved area.
 }
@@ -215,6 +230,7 @@
 
 bool AreaTablet::hasmouse()
 {
+  STACKTRACE;
 	// the first rough check whether it's in the boxed bitmap area
 	return GraphicButton::hasmouse(backgr);
 }
@@ -222,6 +238,7 @@
 
 bool AreaTablet::isvalid()
 {
+  STACKTRACE;
 	return backgr != 0;
 };
 
@@ -238,6 +255,7 @@
 :
 GraphicButton(menu, identbranch, asciicode)
 {
+  STACKTRACE;
 	init_pos_size(&amp;bmp_on, &quot;on&quot;);
 	bmp_off = getbmp(&quot;off&quot;);
 
@@ -252,6 +270,7 @@
 
 void SwitchButton::draw_default()
 {
+  STACKTRACE;
 	if (state)
 		draw(bmp_on);
 	else
@@ -260,6 +279,7 @@
 
 void SwitchButton::draw_focus()
 {
+  STACKTRACE;
 	draw_default();
 	draw_rect_fancy();
 }
@@ -267,12 +287,14 @@
 // is the same as focus, cause a switch cannot be selected all the time !!
 void SwitchButton::draw_selected()
 {
+  STACKTRACE;
 	draw_focus();
 }
 
 
 void SwitchButton::calculate()
 {
+  STACKTRACE;
 	GraphicButton::calculate();
 
 	// determine if the state of the button is being changed by (some) interaction:
@@ -283,6 +305,7 @@
 
 bool SwitchButton::hasmouse()
 {
+  STACKTRACE;
 	// the first rough check whether it's in the boxed bitmap area
 	return GraphicButton::hasmouse(bmp_on);
 }
@@ -290,6 +313,7 @@
 
 bool SwitchButton::isvalid()
 {
+  STACKTRACE;
 	return bmp_on != 0;
 };
 
@@ -302,6 +326,7 @@
 :
 EmptyButton(menu)
 {
+  STACKTRACE;
 	passive = true;
 }
 GhostButton::~GhostButton()
@@ -316,6 +341,7 @@
 :
 AreaTablet(menu, identbranch, 255)
 {
+  STACKTRACE;
 	relpos = 0.0;	// between 0 and 1
 
 	button = getbmp(&quot;button&quot;);
@@ -355,6 +381,7 @@
 
 void ScrollBar::handle_lhold()
 {
+  STACKTRACE;
 	if (direction == ver)
 		pbutton = iround(mainwindow-&gt;mpos.y - pos.y);		// mouse pos relative in the little bar area
 	else
@@ -372,6 +399,7 @@
 
 void ScrollBar::subanimate()
 {
+  STACKTRACE;
 	AreaTablet::subanimate();
 
 	if (direction == ver)
@@ -383,6 +411,7 @@
 
 void ScrollBar::setrelpos(double arelpos)
 {
+  STACKTRACE;
 	if (relpos == arelpos)
 		return;
 
@@ -395,6 +424,7 @@
 
 void ScrollBar::calculate()
 {
+  STACKTRACE;
 	AreaTablet::calculate();
 }
 

Modified: branches/multiplayer-branch/source/twgui/twgui.cpp
===================================================================
--- branches/multiplayer-branch/source/twgui/twgui.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/twgui/twgui.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -24,7 +24,6 @@
 
 #include &quot;melee.h&quot;
 #include &quot;melee/mview.h&quot;
-REGISTER_FILE
 
 #include &quot;twgui.h&quot;
 #include &quot;twwindow.h&quot;
@@ -39,18 +38,21 @@
 :
 AreaTablet(menu, identbranch, asciicode, akeepkey)
 {
+  STACKTRACE;
 	scroll.setup(mainwindow, identbranch);//, &amp;scroll);
 }
 
 
 int AreaTabletScrolled::gety()
 {
+  STACKTRACE;
 	return scroll.yselect;
 }
 
 
 void AreaTabletScrolled::calculate()
 {
+  STACKTRACE;
 	AreaTablet::calculate();
 
 	scroll.calculate();
@@ -68,6 +70,7 @@
 :
 AreaTablet(menu, identbranch, 255)
 {
+  STACKTRACE;
 	usefont = afont;
 	text = 0;
 
@@ -82,6 +85,7 @@
 
 void TextButton::set_text(char *newtext, int color)
 {
+  STACKTRACE;
 	if (newtext)
 	{
 		if (text &amp;&amp; strlen(text) &lt; strlen(newtext))
@@ -101,6 +105,7 @@
 
 void TextButton::subanimate()
 {
+  STACKTRACE;
 	int xcentre, ycentre;
 
 	xcentre = iround(size.x / 2);
@@ -126,6 +131,7 @@
 :
 AreaTabletScrolled(menu, identbranch, 255)
 {
+  STACKTRACE;
 	usefont = afont;
 	Htxt = text_height(usefont);
 	text_color = makecol(0,0,0);
@@ -155,6 +161,7 @@
 
 void TextList::calculate()
 {
+  STACKTRACE;
 	AreaTablet::calculate();
 
 	scroll.calculate();
@@ -171,6 +178,7 @@
 
 void TextList::set_selected(int iy)
 {
+  STACKTRACE;
 //	yselected = iy;
 	if ( iy &gt;= 0 &amp;&amp; iy &lt; N )
 		scroll.yselect = iy;
@@ -180,6 +188,7 @@
 
 void TextList::clear_optionlist()
 {
+  STACKTRACE;
 	int i;
 
 	if (optionlist)			// delete an existing set of strings first.
@@ -201,6 +210,7 @@
 
 void TextList::set_optionlist(char **aoptionlist, int color)
 {
+  STACKTRACE;
 	int aN;
 
 	// in this case, where the number of elements in the list isn't explicitly
@@ -217,6 +227,7 @@
 
 void TextList::set_optionlist(char **aoptionlist, int aN, int color)
 {
+  STACKTRACE;
 	int i;
 
 	clear_optionlist();		// note that this resets N .
@@ -250,6 +261,7 @@
 
 void TextList::add_optionlist(char *newstr)
 {
+  STACKTRACE;
 	if (!optionlist)
 	{
 		Nreserved = 128;
@@ -278,6 +290,7 @@
 // if the mouse is clicked within the window:
 void TextList::handle_lpress()
 {
+  STACKTRACE;
 
 	int iy;
 	
@@ -305,12 +318,14 @@
 
 int TextList::getk()
 {
+  STACKTRACE;
 	return scroll.yselect;
 }
 
 // select and center the list on &quot;that&quot; item
 void TextList::handle_rpress()
 {
+  STACKTRACE;
 	
 	int iy;
 	
@@ -330,6 +345,7 @@
 
 void TextList::subanimate()
 {
+  STACKTRACE;
 
 	if (!optionlist || N == 0)
 		return;				// if it's an empty list
@@ -393,6 +409,7 @@
 :
 AreaTabletScrolled(menu, identbranch, 255)
 {
+  STACKTRACE;
 	usefont = afont;
 //	Htxt = text_height(usefont);
 	text_color = makecol(0,0,0);
@@ -426,6 +443,7 @@
 // the following could be used for editing text that's stored elsewhere
 void TextInfoArea::set_textinfo_unbuffered(char *newtext, int Nchars)
 {
+  STACKTRACE;
 	if (textinfo)
 		delete textinfo;
 
@@ -440,6 +458,7 @@
 // other external factors.
 void TextInfoArea::set_textinfo(char *newtext, int Nchars)
 {
+  STACKTRACE;
 
 	if (localcopy)
 		delete localcopy;
@@ -458,6 +477,7 @@
 
 void TextInfoArea::set_textinfo(char *atextinfo)
 {
+  STACKTRACE;
 	set_textinfo(atextinfo, strlen(atextinfo));
 }
 
@@ -465,6 +485,7 @@
 
 void TextInfoArea::subanimate()
 {
+  STACKTRACE;
 
 	text_mode(-1);
 
@@ -529,6 +550,7 @@
 :
 TextInfoArea(menu, identbranch, afont, atext, amaxtext)
 {
+  STACKTRACE;
 	//usefont = afont;
 	text = atext;
 	maxchars = amaxtext;	// a short line?
@@ -575,6 +597,7 @@
 
 void TextEditBox::set_textcolor(int c)
 {
+  STACKTRACE;
 	text_color = c;
 }
 
@@ -584,6 +607,7 @@
 // if the mouse button was pressed .. update text pos to current mouse cursor pos.
 void TextEditBox::handle_lpress()
 {
+  STACKTRACE;
 	// but only if the enter-key wasn't pressed (that can also intiate this?)
 	if (keyhandler.keyhit[KEY_ENTER])
 		return;
@@ -616,6 +640,7 @@
 
 void TextEditBox::text_reset(char *newtext, int N)
 {
+  STACKTRACE;
 	textinfo-&gt;textinfo = newtext;
 	text = newtext;
 	textinfo-&gt;Nchars = N;
@@ -625,6 +650,7 @@
 
 void TextEditBox::text_reset()
 {
+  STACKTRACE;
 
 	textinfo-&gt;reset(&amp;scroll);
 
@@ -644,6 +670,7 @@
 // this is, where text is detected and entered ... I think ....
 void TextEditBox::calculate()
 {
+  STACKTRACE;
 	if (textinfo-&gt;textinfo != text) {tw_error(&quot;text mismatch&quot;);}
 
 	TextInfoArea::calculate();
@@ -814,6 +841,7 @@
 
 void TextEditBox::subanimate()
 {
+  STACKTRACE;
 
 //	TextInfoArea::subanimate();
 
@@ -880,6 +908,7 @@
 
 char *TextEditBox::get_text()
 {
+  STACKTRACE;
 	return text;
 }
 
@@ -907,6 +936,7 @@
 :
 AreaTabletScrolled(menu, identbranch, akey)
 {
+  STACKTRACE;
 
 	scroll.set(0, 0, 1, 1, 1, 1);
 
@@ -946,6 +976,7 @@
 
 void MatrixIcons::set_iconinfo(BITMAP **alistIcon, double ascale)
 {
+  STACKTRACE;
 	listIcon = alistIcon;
 
 	// do nothing, if there are no data (doh)
@@ -991,6 +1022,7 @@
 // this is done just after mouse/key update, but before the handle* routines.
 void MatrixIcons::subcalculate()
 {
+  STACKTRACE;
 
 	// additionally, if there's mouse movement within this region, you should
 	// override settings of the scroll menu, namely, which particular icon is
@@ -1006,6 +1038,7 @@
 
 void MatrixIcons::subanimate()
 {
+  STACKTRACE;
 
 	int i, j;
 	int ix, iy;
@@ -1066,6 +1099,7 @@
 // this action is used to scroll left/right/up/down
 void MatrixIcons::handle_rpress()
 {
+  STACKTRACE;
 	int mx, my;
 	
 	// mouse position relative to the center of the item window:
@@ -1080,12 +1114,14 @@
 // select some icon :
 void MatrixIcons::handle_lpress()
 {
+  STACKTRACE;
 	selected = true;
 }
 
 
 int MatrixIcons::getk()
 {
+  STACKTRACE;
 	int k;
 	k = scroll.xselect + scroll.yselect * Nx;
 

Modified: branches/multiplayer-branch/source/twgui/twhelpers.cpp
===================================================================
--- branches/multiplayer-branch/source/twgui/twhelpers.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/twgui/twhelpers.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -22,9 +22,7 @@
 
 
 #include &quot;melee.h&quot;
-//#include &quot;melee/mview.h&quot;
 
-REGISTER_FILE
 
 #include &quot;twbutton.h&quot;
 #include &quot;twwindow.h&quot;
@@ -34,6 +32,7 @@
 
 ScrollControl::ScrollControl()
 {
+  STACKTRACE;
 	x = 0;
 	y = 0;
 
@@ -49,6 +48,7 @@
 void ScrollControl::set(int xscroll, int yscroll, int Nxscroll, int Nyscroll,
 						int Nx_show, int Ny_show)
 {
+  STACKTRACE;
 	x = xscroll;	// this is top-left corner item of the visible screen
 	y = yscroll;
 
@@ -76,6 +76,7 @@
 
 void ScrollControl::check_pos()
 {
+  STACKTRACE;
 	// check the scroll position
 	if (x &gt; Nx-1)
 		x = Nx-1;
@@ -108,6 +109,7 @@
 
 void ScrollControl::add(int dx, int dy)
 {
+  STACKTRACE;
 	x += dx;
 	y += dy;
 
@@ -118,6 +120,7 @@
 
 void ScrollControl::check_sel()
 {
+  STACKTRACE;
 	if (xselect &lt; x)
 		x = xselect;
 
@@ -135,6 +138,7 @@
 
 void ScrollControl::set_sel(int xsel, int ysel)
 {
+  STACKTRACE;
 	xselect = xsel;
 	yselect = ysel;
 
@@ -147,18 +151,21 @@
 // alpha is a value between 0 and 1
 void ScrollControl::set_percent_pos_x(double alpha)
 {
+  STACKTRACE;
 	x = iround( (Nx-1) * alpha );
 	check_pos();
 }
 
 void ScrollControl::set_percent_pos_y(double alpha)
 {
+  STACKTRACE;
 	y = iround( (Ny-1) * alpha );
 	check_pos();
 }
 
 void ScrollControl::set_pos(int xnew, int ynew)
 {
+  STACKTRACE;
 	if ( xnew &gt;= 0 &amp;&amp; xnew &lt; Nx &amp;&amp; ynew &gt;= 0 &amp;&amp; ynew &lt; Ny )
 	{
 		x = xnew;
@@ -177,6 +184,7 @@
 // vertical, or a default value.
 double ScrollControl::get_relpos()
 {
+  STACKTRACE;
 	if (scrollhor)
 		return scrollhor-&gt;relpos;
 	if (scrollvert)
@@ -188,6 +196,7 @@
 
 void ScrollControl::calculate()
 {
+  STACKTRACE;
 	int xold, yold;
 
 	xold = x;
@@ -249,6 +258,7 @@
 								EmptyButton *aup, EmptyButton *adown,
 								ScrollBar *ascrollhor, ScrollBar *ascrollvert)
 {
+  STACKTRACE;
 	left = aleft;
 	right = aright;
 	up = aup;
@@ -357,6 +367,7 @@
 
 TextInfo::TextInfo(FONT *afont, BITMAP *abmp, char *atextinfo, int aNchars)
 {
+  STACKTRACE;
 	bmp = abmp;
 	usefont = afont;
 	textinfo = atextinfo;
@@ -376,6 +387,7 @@
 
 void TextInfo::reset(ScrollControl *scroll)
 {
+  STACKTRACE;
 
 	// &quot;initialize&quot; the text:
 	int n, len;
@@ -460,6 +472,7 @@
 // go from line-coordinate to bitmap coordinate
 void TextInfo::getxy(int charpos, int *x, int *y)
 {
+  STACKTRACE;
 	int iline;
 
 	iline = 0;
@@ -495,6 +508,7 @@
 // map (x) coordinate to character number
 int TextInfo::getcharpos(char *scantxt, int x, int max)
 {
+  STACKTRACE;
 	int i;
 	i = 0;
 
@@ -525,6 +539,7 @@
 // map (x,y) coordinate to character number
 int TextInfo::getcharpos(int x, int y)
 {
+  STACKTRACE;
 	int iline;
 
 	iline = y / Htxt;
@@ -565,6 +580,7 @@
 
 void TextInfo::changeline(int *charpos, int line1, int line2)
 {
+  STACKTRACE;
 
 	if (line2 &gt; Nlines-1)
 		line2 = Nlines-1;

Modified: branches/multiplayer-branch/source/twgui/twmenuexamples.cpp
===================================================================
--- branches/multiplayer-branch/source/twgui/twmenuexamples.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/twgui/twmenuexamples.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -23,8 +23,6 @@
 
 #include &quot;melee.h&quot;
 
-REGISTER_FILE
-
 #include &quot;twbutton.h&quot;
 #include &quot;twwindow.h&quot;
 
@@ -42,6 +40,7 @@
 :
 PopupT(creator, ident, axshift, ayshift)
 {
+  STACKTRACE;
 	// add a text list box
 	tia = new TextInfoArea(this, id2, afont, atext, aNchar);//, &amp;scroll);
 	//tia-&gt;set_textinfo(atext, aNchar);
@@ -64,6 +63,7 @@
 
 void PopupTextInfo::check_end()
 {
+  STACKTRACE;
 	if (closebutton-&gt;flag.left_mouse_press)
 		close(-1);
 }
@@ -77,12 +77,14 @@
 :
 PopupTextInfo(creator, ident, id2, axshift, ayshift, afont, atext, aNchar)
 {
+  STACKTRACE;
 };
 
 
 
 void PopupTextInfo_toggle::calculate()
 {
+  STACKTRACE;
 	PopupTextInfo::calculate();
 }
 
@@ -106,6 +108,7 @@
 :
 PopupT(ident, axshift, ayshift, outputscreen)
 {
+  STACKTRACE;
 	tbl = new TextList(this, id2, afont);
 	tbl-&gt;set_optionlist(aoptionslist, makecol(0,0,0));
 
@@ -118,6 +121,7 @@
 :
 PopupT(atrigger, ident, axshift, ayshift)
 {
+  STACKTRACE;
 	//optionslist = aoptionslist;
 
 	// add a text list box
@@ -142,6 +146,7 @@
 // this calls close with return value
 void PopupList::check_end()
 {
+  STACKTRACE;
 	PopupT::check_end();		// this is also a way to end (without choosing anything)
 
 	if (tbl-&gt;selected)
@@ -166,6 +171,7 @@
 :
 Popup(ident, axshift, ayshift, outputscreen)
 {
+  STACKTRACE;
 
 	icons = new MatrixIcons(this, &quot;icon_&quot;, KEY_ENTER);
 
@@ -200,6 +206,7 @@
 // (the general close is ok, it closes and hides the menu).
 void PopupFleetSelection::check_end()
 {
+  STACKTRACE;
 	if (icons-&gt;selected)
 		close(icons-&gt;getk());
 }
@@ -208,6 +215,7 @@
 
 void PopupFleetSelection::newscan(BITMAP **alistIcon, double ascale, char *txt)
 {
+  STACKTRACE;
 	Popup::newscan();
 	icons-&gt;set_iconinfo(alistIcon, ascale);
 	info-&gt;set_text(txt, makecol(255,255,0));
@@ -220,6 +228,7 @@
 // let the &quot;main&quot; routine determine whether to stop or not ;)
 void PopupFleetSelection::check_end()
 {
+  STACKTRACE;
 	if (icons-&gt;selected)
 		close(icons-&gt;getk());
 }
@@ -240,6 +249,7 @@
 			xcenter, ycenter,
 			outputscreen)
 {
+  STACKTRACE;
 	yes = new Button(this, &quot;yes_&quot;,KEY_Y);
 
 	no = new Button(this, &quot;no_&quot;, KEY_N);
@@ -253,6 +263,7 @@
 
 void PopupYN::check_end()
 {
+  STACKTRACE;
 	if (yes-&gt;flag.left_mouse_press)
 		close(1);
 	if (no-&gt;flag.left_mouse_press)
@@ -274,6 +285,7 @@
 			xcenter, ycenter,
 			outputscreen)
 {
+  STACKTRACE;
 	ok = new Button(this, &quot;ok_&quot;, KEY_ENTER);
 
 	exclusive = true;
@@ -285,6 +297,7 @@
 
 void PopupOk::check_end()
 {
+  STACKTRACE;
 	if (ok-&gt;flag.left_mouse_press)
 		close(1);
 }
@@ -302,6 +315,7 @@
 :
 PopupList(creator, ident, &quot;list_&quot;, axshift, ayshift, afont, 0)
 {
+  STACKTRACE;
 	strcpy(dir, &quot;.&quot;);	// you can't get below this (which is the game directory)
 	strcpy(fname, &quot;none&quot;);
 
@@ -323,6 +337,7 @@
 
 void FileBrowser::set_dir(char *newdir)
 {
+  STACKTRACE;
 	strcpy(dir, newdir);
 	reset_dirlist();
 }
@@ -331,6 +346,7 @@
 
 void FileBrowser::set_ext(char *ext)
 {
+  STACKTRACE;
 	strcpy(required_ext, &quot;.&quot;);
 	strcat(required_ext, ext);
 }
@@ -338,6 +354,7 @@
 
 void FileBrowser::reset_dirlist()
 {
+  STACKTRACE;
 	int err;
 	al_ffblk info;
 	
@@ -390,6 +407,7 @@
 
 void FileBrowser::calculate()
 {
+  STACKTRACE;
 	PopupList::calculate();
 
 	if (disabled)
@@ -440,6 +458,7 @@
 // this calls close with return value
 void FileBrowser::check_end()
 {
+  STACKTRACE;
 	if (selection)
 	{
 		selection = false;
@@ -467,6 +486,7 @@
 
 void ValueStr::set(valuetypes atype, char *adescr, double amin, double amax)
 {
+  STACKTRACE;
 	type = atype;
 	strncpy(descr, adescr, sizeof(descr)-1);
 	min = amin;
@@ -482,6 +502,7 @@
 
 double ValueStr::getval()
 {
+  STACKTRACE;
 	if (type == vtype_float)
 		return value;
 	else
@@ -495,6 +516,7 @@
 :
 EmptyButton(menu, identbranch)
 {
+  STACKTRACE;
 	Nmax = aNmax;
 	values = new ValueStr* [Nmax];
 
@@ -540,12 +562,14 @@
 
 void ValueEdit::edit_update()
 {
+  STACKTRACE;
 	sprintf(edit-&gt;text, values[isel]-&gt;format, values[isel]-&gt;value);
 }
 
 
 void ValueEdit::calculate()
 {
+  STACKTRACE;
 	EmptyButton::calculate();
 
 	// the scrollbar:

Modified: branches/multiplayer-branch/source/twgui/twpopup.cpp
===================================================================
--- branches/multiplayer-branch/source/twgui/twpopup.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/twgui/twpopup.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -22,11 +22,8 @@
 
 
 #include &quot;melee.h&quot;
-//#include &quot;melee/mview.h&quot;
 
-REGISTER_FILE
 
-
 #include &quot;twbutton.h&quot;
 #include &quot;twpopup.h&quot;
 
@@ -40,6 +37,7 @@
 :
 TWindow(ident, xcenter, ycenter, outputscreen)
 {
+  STACKTRACE;
 	movingthereserve = false;
 
 	center(xcenter, ycenter);		// center around this position, in relative coordinates
@@ -54,6 +52,7 @@
 
 void Popup::doneinit()
 {
+  STACKTRACE;
 	TWindow::doneinit();
 
 	hide();
@@ -64,12 +63,14 @@
 // (the general close is ok, it closes and hides the menu).
 void Popup::check_end()
 {
+  STACKTRACE;
 	// nothing
 }
 
 
 void Popup::calculate()
 {
+  STACKTRACE;
 	// must be called before the &quot;return&quot;, otherwise focus-loss isn't called
 	TWindow::calculate();
 
@@ -122,6 +123,7 @@
 
 void Popup::close(int areturnstatus)
 {
+  STACKTRACE;
 	hide();
 
 	returnstatus = areturnstatus;
@@ -133,6 +135,7 @@
 // resets its &quot;ready&quot; status as well.
 bool Popup::ready()
 {
+  STACKTRACE;
 	if (returnvalueready)
 	{
 		returnvalueready = false;
@@ -144,6 +147,7 @@
 // call this to get a int-value from some selection mechanism (eg a list)
 int Popup::getvalue()
 {
+  STACKTRACE;
 //	if (!returnvalueready)
 //		return -1;				// otherwise it's undefined
 
@@ -155,6 +159,7 @@
 // restore the ability to do calculations and actions
 void Popup::enable()
 {
+  STACKTRACE;
 	TWindow::enable();
 	returnvalueready = false;
 }
@@ -163,6 +168,7 @@
 
 void Popup::newscan()
 {
+  STACKTRACE;
 	show();	// (more general than enable)
 	ready();
 }
@@ -195,6 +201,7 @@
 :
 Popup(identbranch, axshift, ayshift, outputscreen)
 {
+  STACKTRACE;
 	trigger = 0;
 
 	init_components(identbranch);
@@ -209,6 +216,7 @@
 			axshift, ayshift,
 			atrigger-&gt;mainwindow-&gt;screen)
 {
+  STACKTRACE;
 	trigger = atrigger;
 
 	init_components(identbranch);
@@ -221,6 +229,7 @@
 
 void PopupT::init_components(char *id)
 {
+  STACKTRACE;
 	returnvalueready = false;
 
 	// and default option settings:
@@ -257,6 +266,7 @@
 
 void PopupT::calculate()
 {
+  STACKTRACE;
 	// must be called before the &quot;return&quot;, otherwise focus-loss isn't called
 	Popup::calculate();
 
@@ -322,6 +332,7 @@
 
 void PopupT::handle_focus_loss()
 {
+  STACKTRACE;
 	/*
 	if (!close_on_defocus)
 		return;
@@ -338,6 +349,7 @@
 
 void PopupT::close(int areturnstatus)
 {
+  STACKTRACE;
 	if (trigger)
 	{
 		// give back focus/control to the window that called this window.
@@ -356,6 +368,7 @@
 // you can (and should) replace this routine with one suited for your own purposes
 void PopupT::check_end()
 {
+  STACKTRACE;
 //	if (!hidden &amp;&amp; !hasfocus &amp;&amp; close_on_defocus)	// to prevent this from being called twice, due to recursive call to handle_focus() in hide()
 //	{
 		//tw_error(&quot;PopupList : Losing focus !!&quot;);

Modified: branches/multiplayer-branch/source/twgui/twwindow.cpp
===================================================================
--- branches/multiplayer-branch/source/twgui/twwindow.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/twgui/twwindow.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -24,7 +24,6 @@
 //#include &quot;melee/mview.h&quot;
 #include &quot;other/twconfig.h&quot;
 
-REGISTER_FILE
 
 
 #include &quot;twwindow.h&quot;
@@ -48,6 +47,7 @@
 // this is used to scale them to other screen resolutions.
 TWindow::TWindow(char *identbase, int dx, int dy, BITMAP *outputscreen, bool vidwin)
 {
+  STACKTRACE;
 	prev = 0;
 	next = 0;
 
@@ -225,6 +225,7 @@
 
 TWindow *TWindow::tree_root()
 {
+  STACKTRACE;
 	TWindow *current;
 	current = this;
 	while (current-&gt;prev)
@@ -236,6 +237,7 @@
 
 TWindow *TWindow::tree_last()
 {
+  STACKTRACE;
 	TWindow *current;
 	current = this;
 	while (current-&gt;next)
@@ -248,6 +250,7 @@
 
 void TWindow::tree_calculate()
 {
+  STACKTRACE;
 	TWindow *current;
 	current = tree_root();
 
@@ -274,6 +277,7 @@
 
 void TWindow::tree_animate()
 {
+  STACKTRACE;
 	TWindow *current;
 	current = tree_last();
 
@@ -293,6 +297,7 @@
 
 void TWindow::focus()
 {
+  STACKTRACE;
 	// no need if this already is the root ... cause then it already has the focus.
 	if (!prev)
 		return;
@@ -324,6 +329,7 @@
 
 void TWindow::tree_setscreen(BITMAP *scr)
 {
+  STACKTRACE;
 	TWindow *current;
 	current = tree_root();
 
@@ -339,6 +345,7 @@
 // add a window at the end of the window list
 void TWindow::add(TWindow *newwindow)
 {
+  STACKTRACE;
 	TWindow *current;
 	current = this;
 	while (current-&gt;next)
@@ -352,6 +359,7 @@
 // call all the clean up routines for all the menus
 void TWindow::tree_doneinit()
 {
+  STACKTRACE;
 	TWindow *current;
 	current = tree_root();
 
@@ -366,6 +374,7 @@
 
 bool TWindow::hasfocus()
 {
+  STACKTRACE;
 	// only the root has primary focus...
 	return (prev != 0);
 }
@@ -388,6 +397,7 @@
 
 BITMAP* TWindow::bmp(char *bmpname, bool vidmem)
 {
+  STACKTRACE;
 	BITMAP *bmp, *tmpbmp;
 	int bpp;
 
@@ -418,12 +428,14 @@
 
 void TWindow::doneinit()
 {
+  STACKTRACE;
 	del_bitmap(&amp;backgr_forsearch);
 	//if (datafile)			unload_datafile(datafile);
 }
 
 void TWindow::setscreen(BITMAP *scr)
 {
+  STACKTRACE;
 	screen = scr;
 }
 
@@ -431,6 +443,7 @@
 
 void TWindow::center(int xcenter, int ycenter)
 {
+  STACKTRACE;
 	// put back the background
 	//blit(originalscreen, screen, 0, 0, x, y, W, H);
 
@@ -447,6 +460,7 @@
 
 void TWindow::center_abs(int xcenter, int ycenter)
 {
+  STACKTRACE;
 	// put back the background
 	//blit(originalscreen, screen, 0, 0, x, y, W, H);
 
@@ -460,6 +474,7 @@
 
 void TWindow::center()
 {
+  STACKTRACE;
 	ASSERT(screen)
 	center(screen-&gt;w/2, screen-&gt;h/2);
 }
@@ -468,12 +483,14 @@
 // changes the &quot;disabled&quot; flag, and possibly does other stuff as well?
 void TWindow::enable()
 {
+  STACKTRACE;
 	disabled = false;
 //	mouse.reset();		// reset the mouse to the newest values.
 }
 
 void TWindow::disable()
 {
+  STACKTRACE;
 	if (!disabled)				// to prevent possible recursive call (disable can be called within focus loss in some cases...)
 	{
 		disabled = true;
@@ -485,6 +502,7 @@
 
 void TWindow::show()
 {
+  STACKTRACE;
 	hidden = false;	// allow animation
 	enable();		// allow calculation
 	focus();		// bring this window to the front of the list, so that it draws on top of the rest
@@ -492,6 +510,7 @@
 
 void TWindow::hide()
 {
+  STACKTRACE;
 	hidden = true;
 	disable();
 	//blit(originalscreen, screen, 0, 0, 0, 0, W, H);
@@ -501,6 +520,7 @@
 
 void TWindow::add(EmptyButton *newbutton)
 {
+  STACKTRACE;
 	if (!button_first)
 	{
 		button_first = newbutton;
@@ -516,6 +536,7 @@
 
 void TWindow::rem(EmptyButton *newbutton)
 {
+  STACKTRACE;
 	if (! newbutton)
 		return;
 
@@ -543,6 +564,7 @@
 
 bool TWindow::checkmouse()
 {
+  STACKTRACE;
 	if (!(prev &amp;&amp; prev-&gt;grabbedmouse))
 	{
 		// If the mouse hasn't been &quot;grabbed&quot; by a window above this window
@@ -570,6 +592,7 @@
 
 void TWindow::setfocus(EmptyButton *newbutton)
 {
+  STACKTRACE;
 	if (button_focus)
 		button_focus-&gt;handle_defocus();
 
@@ -583,6 +606,7 @@
 
 void TWindow::calculate()
 {
+  STACKTRACE;
 
 	if (disabled)
 	{
@@ -713,6 +737,7 @@
 
 void TWindow::animate()
 {
+  STACKTRACE;
 
 	if (hidden)
 		return;
@@ -762,6 +787,7 @@
 
 void TWindow::handle_focus()
 {
+  STACKTRACE;
 	// bring it first in the list ...
 	focus();
 }
@@ -769,6 +795,7 @@
 
 void TWindow::handle_focus_loss()
 {
+  STACKTRACE;
 	//for (int i = 0; i &lt; Nareas; ++i )
 	//	area[i]-&gt;handle_menu_focus_loss();
 	EmptyButton *button;
@@ -784,12 +811,14 @@
 
 void TWindow::scalepos(int *ax, int *ay)
 {
+  STACKTRACE;
 	(*ax) = iround( (*ax) * scale );
 	(*ay) = iround( (*ay) * scale );
 }
 
 void TWindow::scalepos(Vector2 *apos)
 {
+  STACKTRACE;
 	(apos-&gt;x) = iround( (apos-&gt;x) * scale );
 	(apos-&gt;y) = iround( (apos-&gt;y) * scale );
 }
@@ -839,6 +868,7 @@
 
 bool TWindow::search_bmp_location(BITMAP *bmp_default, Vector2 *apos)
 {
+  STACKTRACE;
 	ASSERT(bmp_default);
 	ASSERT(apos);
 	
@@ -909,6 +939,7 @@
 /*
 void TWindow::focus2other(TWindow *other)
 {
+  STACKTRACE;
 	disable();			// this menu won't generate signals now, but it'll be drawn still
 	other-&gt;show();
 	other-&gt;prev = this;
@@ -916,6 +947,7 @@
 
 void TWindow::back2other()
 {
+  STACKTRACE;
 	prev-&gt;enable();			// switch control back to the meleemenu
 	hide();					// this menu is disabled, and won't be drawn
 	prev = 0;
@@ -925,17 +957,20 @@
 
 void TWindow::update_time()
 {
+  STACKTRACE;
 	menu_time = get_time() - menu_starttime;
 }
 
 /*
 void TWindow::clear_keys()
 {
+  STACKTRACE;
 	keybuff_count = 0;
 }
 
 void TWindow::add_key(int akey)
 {
+  STACKTRACE;
 	if (disabled)
 		return;
 
@@ -949,6 +984,7 @@
 
 void TWindow::add_keys()
 {
+  STACKTRACE;
 	if (keyboard_needs_poll())
 		poll_keyboard();
 

Modified: branches/multiplayer-branch/source/twgui/utils.cpp
===================================================================
--- branches/multiplayer-branch/source/twgui/utils.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/twgui/utils.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -42,138 +42,128 @@
 // note, separated are the &quot;key&quot; and the extra &quot;control&quot; key (ctrl, alt)
 int mapkey(int scancode_key, int scancode_ctrl)
 {
-	int k;
+  int k;
 
-	k = scancode_key;
+  k = scancode_key;
 
-	k |= scancode_ctrl &lt;&lt; 8;
-	
-	// thus we have 2 scan codes, no more needed.
-	return k;
+  k |= scancode_ctrl &lt;&lt; 8;
+  
+  // thus we have 2 scan codes, no more needed.
+  return k;
 }
 
 int unmapkey1(int k)
 {
-	// return the 1st scancode
-	return k &amp; 0x0FF;
+  // return the 1st scancode
+  return k &amp; 0x0FF;
 }
 
 int unmapkey2(int k)
 {
-	// return the 1st scancode
-	return (k &gt;&gt; 8) &amp; 0x0FF;
+  // return the 1st scancode
+  return (k &gt;&gt; 8) &amp; 0x0FF;
 }
 
 
 BITMAP *find_datafile_bmp(DATAFILE *datafile, char *identif)
 {
-	char objname[128];
+  char objname[128];
+  
+  if (strlen(identif) &gt; 120)
+    {
+      tw_error(&quot;string exceeds max length&quot;);
+    }
+  
+  strcpy(objname, identif);
+  strcat(objname, &quot;_BMP&quot;);	// default extension for .bmp files.
 
-	if (strlen(identif) &gt; 120)
-	{
-		tw_error(&quot;string exceeds max length&quot;);
-	}
+  DATAFILE *dat = find_datafile_object(datafile, objname);
 
-	strcpy(objname, identif);
-	strcat(objname, &quot;_BMP&quot;);	// default extension for .bmp files.
-
-	DATAFILE *dat = find_datafile_object(datafile, objname);
-
-	if (!dat)
-	{
-		//char txt[512];
-		//sprintf(txt, &quot;Could not find %s&quot;, objname);
-		//tw_error(txt);
-		return 0;
-	}
-
-	if (dat-&gt;type == DAT_BITMAP)
-		return (BITMAP*) dat-&gt;dat;
-	else
-		return 0;
+  if (!dat)
+    {
+      //char txt[512];
+      //sprintf(txt, &quot;Could not find %s&quot;, objname);
+      //tw_error(txt);
+      return 0;
+    }
+  
+  if (dat-&gt;type == DAT_BITMAP)
+    return (BITMAP*) dat-&gt;dat;
+  else
+    return 0;
 }
 
 
 BITMAP *clone_bitmap(int bpp, BITMAP *src, double scale, bool vidmem)
 {
-	BITMAP *dest, *convert;
+  BITMAP *dest, *convert;
+  
+  if ( !src )
+    return 0;
 
-	if ( !src )
-		return 0;
+  int W, H;
+  
+  W = iround( src-&gt;w * scale );
+  H = iround( src-&gt;h * scale );
+  
+  dest = create_bitmap_ex(bpp, W, H);
+  
+  convert = create_bitmap_ex(bpp, src-&gt;w, src-&gt;h);
+  blit(src, convert, 0, 0, 0, 0, src-&gt;w, src-&gt;h);		// use this to convert color depth
+  
+  if (W != src-&gt;w || H != src-&gt;h )
+    stretch_blit(convert, dest, 0, 0, convert-&gt;w, convert-&gt;h, 0, 0, dest-&gt;w, dest-&gt;h);
+  else
+    blit(convert, dest, 0, 0, 0, 0, W, H);
+  
+  del_bitmap(&amp;convert);
 
-	int W, H;
 
-	W = iround( src-&gt;w * scale );
-	H = iround( src-&gt;h * scale );
-
-	dest = create_bitmap_ex(bpp, W, H);
-
-	convert = create_bitmap_ex(bpp, src-&gt;w, src-&gt;h);
-	blit(src, convert, 0, 0, 0, 0, src-&gt;w, src-&gt;h);		// use this to convert color depth
-
-	if (W != src-&gt;w || H != src-&gt;h )
-		stretch_blit(convert, dest, 0, 0, convert-&gt;w, convert-&gt;h, 0, 0, dest-&gt;w, dest-&gt;h);
-	else
-		blit(convert, dest, 0, 0, 0, 0, W, H);
-
-	del_bitmap(&amp;convert);
-
-
 	
-	// try to store this in memory, if there's enough room for it
-	// cause the menu-bitmaps are pretty large, and take lotsa time to draw ...
-	if (vidmem)
+  // try to store this in memory, if there's enough room for it
+  // cause the menu-bitmaps are pretty large, and take lotsa time to draw ...
+  if (vidmem)
+    {
+      convert = create_video_bitmap(W, H);
+      if (convert)
 	{
-		convert = create_video_bitmap(W, H);
-		if (convert)
-		{
-			blit(dest, convert, 0, 0, 0, 0, W, H);
-			del_bitmap(&amp;dest);
-			dest = convert;
-		}
+	  blit(dest, convert, 0, 0, 0, 0, W, H);
+	  del_bitmap(&amp;dest);
+	  dest = convert;
 	}
+    }
 	
-
-	return dest;
+  
+  return dest;
 }
 
-
-
-
-
-
-
-
-
-
-
 normalmouse::normalmouse()
 {
-	bmp.original_mouse_sprite = mouse_sprite;
-	bmp.newmousebmp = 0;
+  bmp.original_mouse_sprite = mouse_sprite;
+  bmp.newmousebmp = 0;
 
-	reset();
+  reset();
 }
 
 
 void normalmouse::reset()
 {
-	update();		// initialize with current mouse values.
-	pos2 = pos;
-	oldpos = pos;
+  update();		// initialize with current mouse values.
+  pos2 = pos;
+  oldpos = pos;
 }
 
 
 void normalmouse::copyinfo(normalmouse *othermouse)
 {
-	pos    = othermouse-&gt;pos;
-	oldpos = othermouse-&gt;oldpos;
-	pos2 = othermouse-&gt;pos2;
-	left   = othermouse-&gt;left;
-	mid    = othermouse-&gt;mid;
-	right  = othermouse-&gt;right;
-	bmp.newmousebmp = othermouse-&gt;bmp.newmousebmp;
-	bmp.original_mouse_sprite = othermouse-&gt;bmp.original_mouse_sprite;
+  pos    = othermouse-&gt;pos;
+  oldpos = othermouse-&gt;oldpos;
+  pos2 = othermouse-&gt;pos2;
+  left   = othermouse-&gt;left;
+  mid    = othermouse-&gt;mid;
+  right  = othermouse-&gt;right;
+  bmp.newmousebmp = othermouse-&gt;bmp.newmousebmp;
+  bmp.original_mouse_sprite = othermouse-&gt;bmp.original_mouse_sprite;
 }
 
 
@@ -182,134 +172,133 @@
 // (unmoved) position every iteration.
 void normalmouse::move(int dx, int dy)
 {
-	pos.x += dx;
-	pos.y += dy;
-
-	oldpos.x += dx;
-	oldpos.y += dy;
+  pos.x += dx;
+  pos.y += dy;
+	
+  oldpos.x += dx;
+  oldpos.y += dy;
 }
 
 int normalmouse::vx()
 {
-	return pos.x - oldpos.x;
+  return pos.x - oldpos.x;
 }
 
 int normalmouse::vy()
 {
-	return pos.y - oldpos.y;
+  return pos.y - oldpos.y;
 }
 
 
 void normalmouse::update()
 {
-	if (mouse_needs_poll())
-		poll_mouse();
+  if (mouse_needs_poll())
+    poll_mouse();
 	
-	oldpos = pos2;	// this is exactly the &quot;old&quot; position, unmoved
-	pos.set(mouse_x, mouse_y, mouse_z);
-	pos2 = pos;
-
-	int b = mouse_b;
-
-	left.update(bool(b &amp; 1));		// make distinction here; individual buttons shouldn't know of each other
-	mid.update(bool(b &amp; 4));
-	right.update(bool(b &amp; 2));
+  oldpos = pos2;	// this is exactly the &quot;old&quot; position, unmoved
+  pos.set(mouse_x, mouse_y, mouse_z);
+  pos2 = pos;
+  
+  int b = mouse_b;
+  
+  left.update(bool(b &amp; 1));		// make distinction here; individual buttons shouldn't know of each other
+  mid.update(bool(b &amp; 4));
+  right.update(bool(b &amp; 2));
 }
 
 
 void normalmouse::mousebutton::update(bool newstatus)
 {
-	// we are mainly interested in changes in the button status.
-	if (newstatus != button.status)
-	{
-		oldbutton = button;
-	
-		button.status = newstatus;	// on or of ;)
+  // we are mainly interested in changes in the button status.
+  if (newstatus != button.status)
+    {
+      oldbutton = button;
+      
+      button.status = newstatus;	// on or of ;)
 
-		if (button.status != oldbutton.status)
-			button.time = get_time() * 1E-3;				// detect timing of a change in button status
-
-		button.change = true;
-
-	} else
-		button.change = false;
+      if (button.status != oldbutton.status)
+	button.time = get_time() * 1E-3;				// detect timing of a change in button status
+      
+      button.change = true;
+      
+    } else
+      button.change = false;
 }
 
 
 
 bool normalmouse::mousebutton::press()
 {
-	if (!button.change)
-		return false;
-
-	if (button.status &amp;&amp; (!oldbutton.status))
-		return true;
-	else 
-		return false;
-
+  if (!button.change)
+    return false;
+  
+  if (button.status &amp;&amp; (!oldbutton.status))
+    return true;
+  else 
+    return false;
 }
 
 bool normalmouse::mousebutton::release()
 {
-	if (!button.change)
-		return false;
-
-	if ((!button.status) &amp;&amp; oldbutton.status)
-		return true;
-	else 
-		return false;
+  if (!button.change)
+    return false;
+  
+  if ((!button.status) &amp;&amp; oldbutton.status)
+    return true;
+  else 
+    return false;
 }
 
 bool normalmouse::mousebutton::dclick()
 {
-	if (!button.change)		// check if the mouse is clicked
-		return false;
+  if (!button.change)		// check if the mouse is clicked
+    return false;
+  
+  if (!button.status)		// check if the mouse button is pressed
+    return false;
+  
+  if (button.time - oldbutton.time &lt; 0.2)	// check time between release and press
+    return true;
+  
 
-	if (!button.status)		// check if the mouse button is pressed
-		return false;
-
-	if (button.time - oldbutton.time &lt; 0.2)	// check time between release and press
-		return true;
-	
-
-	return false;
+  return false;
 }
 
 bool normalmouse::mousebutton::hold()
 {
-	return button.status;
+  return button.status;
 }
 
 
 void normalmouse::bmpstr::init(BITMAP *newbmp)
 {
-	newmousebmp = newbmp;
+  newmousebmp = newbmp;
 }
 
 void normalmouse::bmpstr::set()
 {
-	if (newmousebmp)
-	{
-		set_mouse_sprite(newmousebmp);
-	}
+  if (newmousebmp)
+    {
+      set_mouse_sprite(newmousebmp);
+    }
 }
 
 void normalmouse::bmpstr::restore()
 {
-	set_mouse_sprite(original_mouse_sprite);
+  set_mouse_sprite(original_mouse_sprite);
 }
 
 void normalmouse::posstr::set(int xnew, int ynew, int znew)
 {
-	x = xnew;
-	y = ynew;
-	wheel = znew;
+  x = xnew;
+  y = ynew;
+  wheel = znew;
 }
 
 void normalmouse::posstr::move(int dx, int dy)
 {
-	x += dx;
-	y += dy;
+  x += dx;
+  y += dy;
 }
 
 
@@ -332,42 +321,42 @@
 // just make a copy of the input.
 static int my_callback(int key)
 {
-	keyhandler.add(key);
-	return key;
+  keyhandler.add(key);
+  return key;
 }
 
 
 
 TKeyHandler::TKeyHandler()
 {
-	keyboard_callback = my_callback;
-
-	clear();
+  keyboard_callback = my_callback;
+  
+  clear();
 }
 
 
 void TKeyHandler::clear()
 {
-	Nbuf = 0;
-	Nbackbuf = 0;
-
-	int i;
-	for ( i = 0; i &lt; KEY_MAX; ++i )
-	{
-		keynew[i] = key[i];
-		keyold[i] = key[i];
-	}
+  Nbuf = 0;
+  Nbackbuf = 0;
+  
+  int i;
+  for ( i = 0; i &lt; KEY_MAX; ++i )
+    {
+      keynew[i] = key[i];
+      keyold[i] = key[i];
+    }
 }
 
 
 void TKeyHandler::add(int key)
 {
-	if (Nbackbuf &gt;= buffmax)
-		return;
-
-	keybackbuf[Nbackbuf] = key;
-
-	++Nbackbuf;
+  if (Nbackbuf &gt;= buffmax)
+    return;
+  
+  keybackbuf[Nbackbuf] = key;
+  
+  ++Nbackbuf;
 }
 
 void TKeyHandler::clearbuf()
@@ -378,64 +367,64 @@
 
 void TKeyHandler::update()
 {
-	if (keyboard_needs_poll())
-		poll_keyboard();
-
-	// detect key changes ...
-	// (note that changes in-between updates are not seen by this so it's not 100% accurate)
-	int i;
-	for ( i = 0; i &lt; KEY_MAX; ++i )
+  if (keyboard_needs_poll())
+    poll_keyboard();
+  
+  // detect key changes ...
+  // (note that changes in-between updates are not seen by this so it's not 100% accurate)
+  int i;
+  for ( i = 0; i &lt; KEY_MAX; ++i )
+    {
+      // keep record of prev and new states
+      keyold[i] = keynew[i];
+      keynew[i] = key[i];
+      
+      // detect changes
+      keyhit[i] = 0;
+      keyreleased[i] = 0;
+      
+      if (keynew[i] != keyold[i])
 	{
-		// keep record of prev and new states
-		keyold[i] = keynew[i];
-		keynew[i] = key[i];
-
-		// detect changes
-		keyhit[i] = 0;
-		keyreleased[i] = 0;
-
-		if (keynew[i] != keyold[i])
-		{
-			if (keynew[i])
-				keyhit[i] = 1;
-			else
-				keyreleased[i] = 1;
-		}
-
+	  if (keynew[i])
+	    keyhit[i] = 1;
+	  else
+	    keyreleased[i] = 1;
 	}
-
-
-	Nbuf = Nbackbuf;
-	for ( i = 0; i &lt; Nbuf; ++i )
-	{
-		keybuf[i] = keybackbuf[i];
-	}
-	// reset the back-buffer for reading new stuf.
-	Nbackbuf = 0;
-
+      
+    }
+  
+  
+  Nbuf = Nbackbuf;
+  for ( i = 0; i &lt; Nbuf; ++i )
+    {
+      keybuf[i] = keybackbuf[i];
+    }
+  // reset the back-buffer for reading new stuf.
+  Nbackbuf = 0;
+  
 }
 
 
 bool TKeyHandler::pressed(char key)
 {
-	// only compare if the key != 0, otherwise you can get matches with
-	// wierd key combos or something. So, key==0 has the meaning of, don't compare me!
-	if (key == 0)
-		return false;
-
-	//char teststring[128];
-	int i;
-	for (i = 0; i &lt; Nbuf; ++i)
-	{
-		//teststring[i] = keybuf[i] &amp; 0x0FF;
-
-		if ( (keybuf[i] &amp; 0x0FF) == key )	// only compare by ascii code...
-			return true;
-	}
-
-	//teststring[i] = 0;
-	//message.out(teststring);
-
-	return false;
+  // only compare if the key != 0, otherwise you can get matches with
+  // wierd key combos or something. So, key==0 has the meaning of, don't compare me!
+  if (key == 0)
+    return false;
+  
+  //char teststring[128];
+  int i;
+  for (i = 0; i &lt; Nbuf; ++i)
+    {
+      //teststring[i] = keybuf[i] &amp; 0x0FF;
+      
+      if ( (keybuf[i] &amp; 0x0FF) == key )	// only compare by ascii code...
+	return true;
+    }
+  
+  //teststring[i] = 0;
+  //message.out(teststring);
+  
+  return false;
 }
 

Modified: branches/multiplayer-branch/source/util/aastr.c
===================================================================
--- branches/multiplayer-branch/source/util/aastr.c	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/util/aastr.c	2004-09-28 19:53:03 UTC (rev 71)
@@ -74,156 +74,167 @@
 	int dw, int dh, 
 	int mode ) 
 {
-	unsigned long addr;
-	int xscale, yscale, xbase, ybase;
-	int y1, y2, x1, x2;
-	int cx, cy, cw, ch;
-	int iy, ix;
-	int idx, idy;
-	int mw, mh;
-	ADD_TYPE *add;
-	PUT_TYPE *put;
+  unsigned long addr;
+  int xscale, yscale, xbase, ybase;
+  int y1, y2, x1, x2;
+  int cx, cy, cw, ch;
+  int iy, ix;
+  int idx, idy;
+  int mw, mh;
+  ADD_TYPE *add;
+  PUT_TYPE *put;
 
-	if (((mode&amp;~(AA_MASKED)) == AA_NO_AA) &amp;&amp; 
-		(bitmap_color_depth(src) == bitmap_color_depth(dest))) 
-//	if (0)
-	{
-		if (mode &amp; AA_MASKED) masked_stretch_blit(src, dest, 
-			sx&gt;&gt;aa_BITS, sy&gt;&gt;aa_BITS, sw&gt;&gt;aa_BITS, sh&gt;&gt;aa_BITS, 
-			dx&gt;&gt;aa_BITS, dy&gt;&gt;aa_BITS, dw&gt;&gt;aa_BITS, dh&gt;&gt;aa_BITS);
-		else stretch_blit(src, dest, 
-			sx&gt;&gt;aa_BITS, sy&gt;&gt;aa_BITS, sw&gt;&gt;aa_BITS, sh&gt;&gt;aa_BITS, 
-			dx&gt;&gt;aa_BITS, dy&gt;&gt;aa_BITS, dw&gt;&gt;aa_BITS, dh&gt;&gt;aa_BITS);
-		return;
-	}
-
-	if ((dx + dw &lt; 0) || (dy + dh &lt; 0) || 
-		(dx &gt;= dest-&gt;w &lt;&lt; aa_BITS) || (dy &gt;= dest-&gt;h &lt;&lt; aa_BITS)) return;
-
-	if (!(mode &amp; AA_NO_ALIGN)) {
-		sx &amp;= (sx + bit(aa_BITS-1)) &amp;~bitn(aa_BITS);
-		sy &amp;= (sy + bit(aa_BITS-1)) &amp;~bitn(aa_BITS);
-		sw &amp;= (sw + bit(aa_BITS-1)) &amp;~bitn(aa_BITS);
-		sh &amp;= (sh + bit(aa_BITS-1)) &amp;~bitn(aa_BITS);
-		dx &amp;= (dx + bit(aa_BITS-1)) &amp;~bitn(aa_BITS);
-		dy &amp;= (dy + bit(aa_BITS-1)) &amp;~bitn(aa_BITS);
-		dw &amp;= (dw + bit(aa_BITS-1)) &amp;~bitn(aa_BITS);
-		dh &amp;= (dh + bit(aa_BITS-1)) &amp;~bitn(aa_BITS);
-	}
-
-	if ((sw &lt; (1 &lt;&lt; (aa_BITS/2))) || (sh &lt; (1 &lt;&lt; (aa_BITS/2)))) 
-		return;
-	if ((dw &lt; (1 &lt;&lt; (aa_BITS/2))) || (dh &lt; (1 &lt;&lt; (aa_BITS/2)))) 
-		return;
-
-	yscale = ((sh) &lt;&lt; aa_BITS) / dh;
-	ybase = (((dy&amp;bitn(aa_BITS)) * yscale) &gt;&gt; aa_BITS) - sy;
-	xscale = ((sw) &lt;&lt; aa_BITS) / dw;
-	xbase = (((dx&amp;bitn(aa_BITS)) * xscale) &gt;&gt; aa_BITS) - sx;
-
- 	add = get_aa_add_function(src, mode);
-	put = get_aa_put_function(dest, mode);
-	if (!add || !put) return;
-
+  if (((mode&amp;~(AA_MASKED)) == AA_NO_AA) &amp;&amp; 
+      (bitmap_color_depth(src) == bitmap_color_depth(dest))) 
+    //	if (0)
+    {
+      if (mode &amp; AA_MASKED) 
+	masked_stretch_blit(src, dest, 
+			    sx&gt;&gt;aa_BITS, sy&gt;&gt;aa_BITS, sw&gt;&gt;aa_BITS, 
+			    sh&gt;&gt;aa_BITS, 
+			    dx&gt;&gt;aa_BITS, dy&gt;&gt;aa_BITS, dw&gt;&gt;aa_BITS, 
+			    dh&gt;&gt;aa_BITS);
+      else 
+	stretch_blit(src, dest, 
+		     sx&gt;&gt;aa_BITS, sy&gt;&gt;aa_BITS, sw&gt;&gt;aa_BITS, sh&gt;&gt;aa_BITS, 
+		     dx&gt;&gt;aa_BITS, dy&gt;&gt;aa_BITS, dw&gt;&gt;aa_BITS, dh&gt;&gt;aa_BITS);
+      return;
+    }
+    
+    if ((dx + dw &lt; 0) || (dy + dh &lt; 0) || 
+	(dx &gt;= dest-&gt;w &lt;&lt; aa_BITS) || (dy &gt;= dest-&gt;h &lt;&lt; aa_BITS)) 
+      return;
+    
+    if (!(mode &amp; AA_NO_ALIGN)) 
+      {
+	sx &amp;= (sx + bit(aa_BITS-1)) &amp;~bitn(aa_BITS);
+	sy &amp;= (sy + bit(aa_BITS-1)) &amp;~bitn(aa_BITS);
+	sw &amp;= (sw + bit(aa_BITS-1)) &amp;~bitn(aa_BITS);
+	sh &amp;= (sh + bit(aa_BITS-1)) &amp;~bitn(aa_BITS);
+	dx &amp;= (dx + bit(aa_BITS-1)) &amp;~bitn(aa_BITS);
+	dy &amp;= (dy + bit(aa_BITS-1)) &amp;~bitn(aa_BITS);
+	dw &amp;= (dw + bit(aa_BITS-1)) &amp;~bitn(aa_BITS);
+	dh &amp;= (dh + bit(aa_BITS-1)) &amp;~bitn(aa_BITS);
+      }
+    
+    if ((sw &lt; (1 &lt;&lt; (aa_BITS/2))) || (sh &lt; (1 &lt;&lt; (aa_BITS/2)))) 
+      return;
+    if ((dw &lt; (1 &lt;&lt; (aa_BITS/2))) || (dh &lt; (1 &lt;&lt; (aa_BITS/2)))) 
+      return;
+    
+    yscale = ((sh) &lt;&lt; aa_BITS) / dh;
+    ybase = (((dy&amp;bitn(aa_BITS)) * yscale) &gt;&gt; aa_BITS) - sy;
+    xscale = ((sw) &lt;&lt; aa_BITS) / dw;
+    xbase = (((dx&amp;bitn(aa_BITS)) * xscale) &gt;&gt; aa_BITS) - sx;
+    
+    add = get_aa_add_function(src, mode);
+    put = get_aa_put_function(dest, mode);
+    if (!add || !put) return;
+    
 #if AASTR2_HW_SUPPORT_LEVEL &gt;= 1
-	bmp_select(dest);
+    bmp_select(dest);
 #endif
-
-	y1 = (dy        &gt;&gt; aa_BITS);
-	y2 = ((dy+dh-1) &gt;&gt; aa_BITS);
-	x1 = (dx        &gt;&gt; aa_BITS);
-	x2 = ((dx+dw-1) &gt;&gt; aa_BITS);
-	cw = xscale;
-	ch = yscale;
-	idy = dy &gt;&gt; aa_BITS;
-	idx = dx &gt;&gt; aa_BITS;
-	mw = sx+sw;
-	mh = sy+sh;
-	if ((unsigned int)cw &lt; aa_SIZE) cw = aa_SIZE;
-	if ((unsigned int)ch &lt; aa_SIZE) ch = aa_SIZE;
-	_aa.total = cw * ch;
-	if (!(mode &amp; (AA_NO_ALIGN | AA_NO_FILTER))) {
-		if (_aa.total &gt; aa_MAX_NUM) {
-			if ((unsigned int)cw &gt; aa_MAX_SIZE) {
-//				xbase -= (cw - aa_MAX_SIZE) &gt;&gt; 1;
-//				xbase = 0;
-				cw = aa_MAX_SIZE;
-			}
-			if ((unsigned int)ch &gt; aa_MAX_SIZE) {
-//				ybase -= (ch - aa_MAX_SIZE) &gt;&gt; 1;
-//				ybase = 0;
-				ch = aa_MAX_SIZE;
-			}
-			_aa.total = cw * ch;
-		}
+    
+    y1 = (dy        &gt;&gt; aa_BITS);
+    y2 = ((dy+dh-1) &gt;&gt; aa_BITS);
+    x1 = (dx        &gt;&gt; aa_BITS);
+    x2 = ((dx+dw-1) &gt;&gt; aa_BITS);
+    cw = xscale;
+    ch = yscale;
+    idy = dy &gt;&gt; aa_BITS;
+    idx = dx &gt;&gt; aa_BITS;
+    mw = sx+sw;
+    mh = sy+sh;
+    if ((unsigned int)cw &lt; aa_SIZE) cw = aa_SIZE;
+    if ((unsigned int)ch &lt; aa_SIZE) ch = aa_SIZE;
+    _aa.total = cw * ch;
+    if (!(mode &amp; (AA_NO_ALIGN | AA_NO_FILTER))) {
+      if (_aa.total &gt; aa_MAX_NUM) {
+	if ((unsigned int)cw &gt; aa_MAX_SIZE) {
+	  //				xbase -= (cw - aa_MAX_SIZE) &gt;&gt; 1;
+	  //				xbase = 0;
+	  cw = aa_MAX_SIZE;
 	}
-	if (_aa_mode &amp; AA_VFLIP) {
-		ybase -= yscale * (y2-idy);
-		yscale *= -1;
+	if ((unsigned int)ch &gt; aa_MAX_SIZE) {
+	  //				ybase -= (ch - aa_MAX_SIZE) &gt;&gt; 1;
+	  //				ybase = 0;
+	  ch = aa_MAX_SIZE;
 	}
-	if (_aa_mode &amp; AA_HFLIP) {
-		xbase -= xscale * (x2-idx);
-		xscale *= -1;
-	}
-	if (dest-&gt;clip) {
-		if (y1 &lt; dest-&gt;ct) y1 = dest-&gt;ct;
-		if (y2 &gt;= dest-&gt;cb) y2 = dest-&gt;cb - 1;
-		if (x1 &lt; dest-&gt;cl) x1 = dest-&gt;cl;
-		if (x2 &gt;= dest-&gt;cr) x2 = dest-&gt;cr - 1;
-	}
-	if (_aa_trans) {
-		if (_aa_trans2 &gt;= 256) return;
-		_aa.total += (_aa.total * (Uint64)_aa_trans) &gt;&gt; 8;
-	}
-	_aa.inverse = 1 + (0xffffffffUL /  _aa.total );
-	for (iy = y1; iy &lt;= y2; iy += 1) {
-		int th;
-		cy = (iy-idy) * yscale - ybase;
+	_aa.total = cw * ch;
+      }
+    }
+    if (_aa_mode &amp; AA_VFLIP) {
+      ybase -= yscale * (y2-idy);
+      yscale *= -1;
+    }
+    if (_aa_mode &amp; AA_HFLIP) {
+      xbase -= xscale * (x2-idx);
+      xscale *= -1;
+    }
+    if (dest-&gt;clip) {
+      if (y1 &lt; dest-&gt;ct) y1 = dest-&gt;ct;
+      if (y2 &gt;= dest-&gt;cb) y2 = dest-&gt;cb - 1;
+      if (x1 &lt; dest-&gt;cl) x1 = dest-&gt;cl;
+      if (x2 &gt;= dest-&gt;cr) x2 = dest-&gt;cr - 1;
+    }
+    if (_aa_trans) {
+      if (_aa_trans2 &gt;= 256) return;
+      _aa.total += (_aa.total * (Uint64)_aa_trans) &gt;&gt; 8;
+    }
+
+    if(_aa.total)
+      _aa.inverse = 1 + (0xffffffffUL /  _aa.total );
+    else
+      _aa.inverse = 1;
+    
+    for (iy = y1; iy &lt;= y2; iy += 1) {
+      int th;
+      cy = (iy-idy) * yscale - ybase;
 #if AASTR2_HW_SUPPORT_LEVEL &gt;= 2
-		addr = bmp_write_line(dest, iy); //this helps if dest is a video bitmap
+      addr = bmp_write_line(dest, iy); //this helps if dest is a video bitmap
 #else
-		addr = (int)dest-&gt;line[iy];
+      addr = (int)dest-&gt;line[iy];
 #endif
-		_aa.y = iy;
+      _aa.y = iy;
 		th = ch;
 		if (cy &lt; 0) { //top edge of image
-			th += cy;
-			cy = 0;
+		  th += cy;
+		  cy = 0;
 		}
 		if (cy + th &gt; mh) { //bottom edge of image
-			th = mh - cy;
+		  th = mh - cy;
 		}
 		if ((unsigned int)th &lt; aa_SIZE) { //either edge
-			cy -= (aa_SIZE - th) / 2;
-			th = aa_SIZE;
-			if (cy &lt; 0) cy = 0;
-			if (cy &gt; (int)(mh - aa_SIZE)) cy = mh - aa_SIZE;
+		  cy -= (aa_SIZE - th) / 2;
+		  th = aa_SIZE;
+		  if (cy &lt; 0) cy = 0;
+		  if (cy &gt; (int)(mh - aa_SIZE)) cy = mh - aa_SIZE;
 		}
 		for (ix = x1; ix &lt;= x2; ix += 1) {
-			int tw;
-			cx = (ix-idx) * xscale - xbase;
-			tw = cw;
-			if (cx &lt; 0) {//left edge of image
-				tw += cx;
-				cx = 0;
-			}
-			if (cx + tw &gt; mw) {//right edge of image
-				tw = mw - cx;
-			}
-			if ((unsigned int)tw &lt; aa_SIZE) {//either edge of image
-				cx -= (aa_SIZE - tw) / 2;
-				tw = aa_SIZE;
-				if (cx &lt; 0) cx = 0;
-				if (cx &gt; (int)(mw - aa_SIZE)) cx = mw - aa_SIZE;
-			}
+		  int tw;
+		  cx = (ix-idx) * xscale - xbase;
+		  tw = cw;
+		  if (cx &lt; 0) {//left edge of image
+		    tw += cx;
+		    cx = 0;
+		  }
+		  if (cx + tw &gt; mw) {//right edge of image
+		    tw = mw - cx;
+		  }
+		  if ((unsigned int)tw &lt; aa_SIZE) {//either edge of image
+		    cx -= (aa_SIZE - tw) / 2;
+		    tw = aa_SIZE;
+		    if (cx &lt; 0) cx = 0;
+		    if (cx &gt; (int)(mw - aa_SIZE)) cx = mw - aa_SIZE;
+		  }
 			add ((BITMAP *)src, cx, cx + tw, cy, cy + th);
 			AA_PUT_PIXEL (put, addr, ix);
 		}
-	}
+    }
 #if AASTR2_HW_SUPPORT_LEVEL &gt;= 2
-	bmp_unwrite_line(dest); //this helps if dest is a video bitmap
+    bmp_unwrite_line(dest); //this helps if dest is a video bitmap
 #endif
-	return;
+    return;
 }
 
 /*

Modified: branches/multiplayer-branch/source/util/base.cpp
===================================================================
--- branches/multiplayer-branch/source/util/base.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/util/base.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -44,6 +44,7 @@
 ------------------------------*/
 
 void BaseClass::preinit() {
+  STACKTRACE;
 	return;
 }
 BaseClass::~BaseClass() {
@@ -55,12 +56,14 @@
 	return ((void**)this);
 }
 int BaseClass::serialize(void *stream) {
+  STACKTRACE;
 	return 0;
 }
 int BaseClass::_get_size() const {
 	return 0;
 }
 void BaseClass::_event( Event *e) {
+  STACKTRACE;
 	return;
 }
 void BaseClass::issue_event ( std::list&lt;BaseClass*&gt;&amp; recipients, Event *e) {

Modified: branches/multiplayer-branch/source/util/errors.cpp
===================================================================
--- branches/multiplayer-branch/source/util/errors.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/util/errors.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -7,81 +7,88 @@
 #include &lt;stdarg.h&gt;
 
 #include &quot;melee.h&quot;
-REGISTER_FILE
 
 #include &quot;other/dialogs.h&quot;
 
-static DIALOG *tw_alert_dialogs[4] = { 
-	tw_alert_dialog1, 
-	tw_alert_dialog2, 
-	tw_alert_dialog3, 
-	tw_alert_dialog4
-};
+static DIALOG *tw_alert_dialogs[5] = 
+  { 
+    tw_alert_dialog1, 
+    tw_alert_dialog2, 
+    tw_alert_dialog3, 
+    tw_alert_dialog4,
+    tw_alert_dialog5
+  };
 
-char find_shortcut_key(const char *s) {
-	while (true) {
-		s = strchr(s, '&amp;');
-		if (s &amp;&amp; (s[1] != '&amp;')) {
-			s++;
-			break;
-		}
-		if (!s) return 0;
+char find_shortcut_key(const char *s) 
+{
+  while (true) 
+    {
+      s = strchr(s, '&amp;');
+      if (s &amp;&amp; (s[1] != '&amp;')) 
+	{
+	  s++;
+	  break;
 	}
-	return *s;
+      if (!s) 
+	return 0;
+    }
+  return *s;
 }
 
 int _tw_alert ( 
-	bool popup, 
-	char *message, 
-	const char *b1, 
-	const char *b2 = NULL, 
-	const char *b3 = NULL, 
-	const char *b4 = NULL
-) 
+	       bool popup, 
+	       char *message, 
+	       const char *b1, 
+	       const char *b2 = NULL, 
+	       const char *b3 = NULL, 
+	       const char *b4 = NULL,
+	       const char *b5 = NULL
+	       ) 
 {
-	char *s1 = message;
-	char *s2 = NULL, *s3 = NULL;
-
-	s2 = strchr(s1, '\n');
-	if (s2) {
-		s2[0] = 0;
-		s2 += 1;
-		s3 = strchr(s2, '\n');
-		if (s3) {
-			s3[0]= 0;
-			s3 += 1;
-		}
-	}
-
-	int l = 1;
-	if (b2) l = 2;
-	if (b3) l = 3;
-	if (b4) l = 4;
-	DIALOG *dialog = tw_alert_dialogs[l-1];
-	dialog[1].dp = (void*)message;
-	if (b1) {
-		dialog[2].dp = (void*)b1;
-		dialog[2].key = find_shortcut_key(b1);
-	}
-	if (b2) {
-		dialog[3].dp = (void*)b2;
-		dialog[3].key = find_shortcut_key(b2);
-	}
-	if (b3) {
-		dialog[4].dp = (void*)b3;
-		dialog[4].key = find_shortcut_key(b3);
-	}
-	if (b4) {
-		dialog[5].dp = (void*)b4;
-		dialog[5].key = find_shortcut_key(b4);
-	}
-
-	int i;
-
-	if (popup) i = tw_popup_dialog(&amp;videosystem.window, dialog, 2) - 2;
-	else       i = tw_do_dialog   (&amp;videosystem.window, dialog, 2) - 2;
-	return i + 1;
-	//return alert3(s1, s2, s3, b1, b2, b3, 0, 0, 0);
+  int l = 1;
+  if (b2) 
+    l = 2;
+  if (b3) 
+    l = 3;
+  if (b4) 
+    l = 4;
+  if (b5)
+    l = 5;
+  DIALOG *dialog = tw_alert_dialogs[l-1];
+  dialog[1].dp = (void*)message;
+  if (b1) 
+    {
+      dialog[2].dp = (void*)b1;
+      dialog[2].key = find_shortcut_key(b1);
+    }
+  if (b2) 
+    {
+      dialog[3].dp = (void*)b2;
+      dialog[3].key = find_shortcut_key(b2);
+    }
+  if (b3) 
+    {
+      dialog[4].dp = (void*)b3;
+      dialog[4].key = find_shortcut_key(b3);
+    }
+  if (b4) 
+    {
+      dialog[5].dp = (void*)b4;
+      dialog[5].key = find_shortcut_key(b4);
+    }
+  if (b5) 
+    {
+      dialog[6].dp = (void*)b5;
+      dialog[6].key = find_shortcut_key(b5);
+    }
+  
+  int i;
+  
+  if (popup) 
+    i = tw_popup_dialog(&amp;videosystem-&gt;window, dialog, 2) - 2;
+  else
+    i = tw_do_dialog   (&amp;videosystem-&gt;window, dialog, 2) - 2;
+  return i + 1;
 }
 
 
@@ -100,92 +107,102 @@
 	const char *message
 ) 
 {
-	char error_string[4096];
-	int i;
+  char error_string[32000];
+  int i;
 
-	if (__error_flag &amp; 2) return;
+  if (__error_flag &amp; 2) return;
+  
+  char *cp = &amp;error_string[0];
+  if (file) 
+    {
+      char *_file = strstr(file, &quot;source&quot;);
+      if (_file) file = _file;
+    }
 
-	char *cp = &amp;error_string[0];
-	if (file) {
-		char *_file = strstr(file, &quot;source&quot;);
-		if (_file) file = _file;
-	}
+  log_debug(&quot;tw_error_handler invoked: &quot;);
+  int len = strlen(message);
+  memcpy(error_string, message, len);
+  cp += len;
+  if (line &gt;= 0) 
+    {
+      log_debug(        &quot;(from %s, Line %d)\n&quot;, file, line);
+      cp += sprintf(cp, &quot;\n(from %s, line %d)\n&quot;, file, line);
+    }
+  else 
+    {
+      log_debug(&quot;(from unspecified file &amp; linenumber)\n&quot;);
+      cp += sprintf(cp, &quot;\n&quot;);
+    }
+  cp += sprintf(cp, &quot;\nStack Trace:\n&quot;);
+  cp += sprintf(cp, &quot;%s&quot;, UserStackTraceHelper::get_stack_trace_string().c_str());
 
-	log_debug(&quot;tw_error_handler invoked: &quot;);
-	int len = strlen(message);
-	memcpy(error_string, message, len);
-	cp += len;
-	if (line &gt;= 0) {//display line # and file name
-		log_debug(        &quot;(from %s, Line %d)\n&quot;, file, line);
-		cp += sprintf(cp, &quot;\n(from %s, line %d)\n&quot;, file, line);
-	}
-	else {
-		log_debug(&quot;(from unspecified file &amp; linenumber)\n&quot;);
-		cp += sprintf(cp, &quot;\n&quot;);
-	}
-	log_debug(&quot;begin error message:\n%s\nend error message\n&quot;, message);
-
-
-
-	if (videosystem.width &lt;= 0) {
-		allegro_message(&quot;Critical Error$: %s\n&quot;, error_string);
-		log_debug(&quot;\nUnable to display messge, shutting down\n&quot;);
-		throw -1;
-	}
-
-	log_debug(&quot;Pressenting graphical error prompt\n&quot;);
-
-	const char *es[] = {&quot;&amp;Abort&quot;, &quot;&amp;Retry&quot;, &quot;&amp;Debug&quot;, &quot;&amp;Ignore&quot;};
-	enum {
-		ES_ABORT = 0,
-		ES_RETRY,
-		ES_DEBUG,
-		ES_IGNORE
-	};
-	int selection = -1;
-
-	if ( in_catch_statement ) {
-		int les[] = { ES_ABORT, ES_DEBUG };
-		i = _tw_alert( false, error_string, es[les[0]], es[les[1]] );
-		if (i &gt; 0) selection = les[i - 1];
-	}
-	else {
-		int les[] = { ES_ABORT, ES_RETRY, ES_DEBUG, ES_IGNORE };
-		i = _tw_alert( false, error_string, es[les[0]], es[les[1]], es[les[2]], es[les[3]] );
-		if (i &gt; 0) selection = les[i - 1];
-	}
-	if (selection &lt; 0) selection = ES_ABORT;
-	log_debug(&quot;Option \&quot;%s\&quot; selected\n&quot;, es[selection]);
-
-	videosystem.screen_corrupted = true;
-
-	if (selection == ES_DEBUG) {//&quot;Debug&quot;
-		__error_flag |= 1;
-		if (in_catch_statement) {
-			return;
-		}
+  log_debug(&quot;begin error message:\n%s\nend error message\n&quot;, message);
+  log_debug(UserStackTraceHelper::get_stack_trace_string().c_str());
+  
+  
+  if (videosystem-&gt;width &lt;= 0) {
+    allegro_message(&quot;Critical Error$: %s\n&quot;, error_string);
+    log_debug(&quot;\nUnable to display messge, shutting down\n&quot;);
+    throw -1;
+  }
+  
+  log_debug(&quot;Pressenting graphical error prompt\n&quot;);
+  
+  const char *es[] = {&quot;&amp;Abort&quot;, &quot;&amp;Retry&quot;, &quot;&amp;Debug&quot;, &quot;&amp;Ignore&quot;, &quot;&amp;Stack Trace&quot;};
+  enum {
+    ES_ABORT = 0,
+    ES_RETRY,
+    ES_DEBUG,
+    ES_IGNORE,
+    ES_STACKTRACE
+  };
+  int selection = -1;
+  
+  i = _tw_alert( false, error_string, es[ES_ABORT], es[ES_RETRY], 
+		 es[ES_DEBUG], es[ES_IGNORE], es[ES_STACKTRACE] );
+  if (i &gt; 0) 
+    selection = i - 1;
+  
+  if (selection &lt; 0) 
+    selection = ES_ABORT;
+  log_debug(&quot;Option \&quot;%s\&quot; selected\n&quot;, es[selection]);
+  
+  videosystem-&gt;screen_corrupted = true;
+  
+  if (selection == ES_DEBUG) {//&quot;Debug&quot;
+    __error_flag |= 1;
+    if (in_catch_statement) {
+      return;
+    }
 #		if defined ALLEGRO_MSVC
-			__asm int 3;
+    __asm int 3;
 #		elif defined __GNUC__ &amp;&amp; defined __i386__
-			asm(&quot;int $0x03&quot;);
+    asm(&quot;int $0x03&quot;);
 #		else
-			if (1) (*((int*)NULL)) = 0;
+    if (1) (*((int*)NULL)) = 0;
 #		endif
-		return;
-	}
-
-	if (selection == ES_IGNORE) {//&quot;Ignore&quot;
-		__error_flag |= 2;
-		return;
-	}
-
-	if (selection == ES_RETRY) {//&quot;Retry&quot;
-		return;
-	}
-
-	//&quot;Abort&quot;
-	if (in_catch_statement) return;
-	else throw 0;
+    return;
+  }
+  
+  if (selection == ES_IGNORE) {//&quot;Ignore&quot;
+    __error_flag |= 2;
+    return;
+  }
+  
+  if (selection == ES_RETRY) {//&quot;Retry&quot;
+    return;
+  }
+  
+  if(selection == ES_STACKTRACE)
+    {
+      show_text(UserStackTraceHelper::get_stack_trace_string().c_str());
+      tw_error_handler ( in_catch_statement, file, line, message );
+      return;
+    }
+  //&quot;Abort&quot;
+  if (in_catch_statement) 
+    return;
+  else throw 0;
 }
 static void _register_tw_error_hanlde() {_error_handler = &amp;tw_error_handler;}
 CALL_BEFORE_MAIN(_register_tw_error_hanlde);
@@ -197,7 +214,7 @@
 
 void tw_error_exit(const char* message) {
 	log_debug(&quot;\nCritical Error!: %s\n\n&quot;, message);
-	if ((videosystem.width &gt; 0) &amp;&amp; (strlen(message) &lt; 1000)) {
+	if ((videosystem-&gt;width &gt; 0) &amp;&amp; (strlen(message) &lt; 1000)) {
 		char buf[1024];
 		sprintf(buf, &quot;Critical Error!: %s&quot;, message);
 		tw_alert (buf, &quot;Quit&quot;);
@@ -212,21 +229,66 @@
 //char tw_error_str[tw_error_str_len];
 
 void caught_error(const char *format, ...) {
-	char error_string[4096];
+  	char error_string[4096];
 	if (format) {
 		va_list those_dots;
 		va_start(those_dots, format);
 		vsprintf(error_string, format, those_dots);
 		va_end(those_dots);
 	}
+ 
+  	tw_error_handler( 1, NULL, -1, error_string);
+	// tw_error_handler( 1, NULL, -1, format);
 
-	_error_handler( 1, NULL, -1, error_string);
-
 	return;
 }
 
+std::stack&lt;SOURCE_LINE*&gt; UserStackTraceHelper::call_stack;
+UserStackTraceHelper::UserStackTraceHelper( SOURCE_LINE* srcline)
+{
+  #ifdef DEBUG
+  //  debug_log(GetStackNodeString(srcline).c_str());
+  #endif 
+      call_stack.push(srcline);
+}
 
+UserStackTraceHelper::~UserStackTraceHelper()
+{
+      call_stack.pop();
+}
 
+std::string UserStackTraceHelper::GetStackNodeString(SOURCE_LINE* stNode)
+{
+  std::string strFile;
+  char *_file = strstr(stNode-&gt;file, &quot;source&quot;);
+  if (_file) 
+    strFile = _file;
+  
+  char line[20] = {0};
+  sprintf(line, &quot;%d&quot;, stNode-&gt;line);
+      
+  std::string strName;
+  if(stNode-&gt;name!=NULL)
+    strName = std::string(&quot; &quot;) + stNode-&gt;name;
+  
+  return std::string(&quot;from: &quot;) + strFile + &quot;, line &quot; + line + &quot; funct: &quot; + stNode-&gt;funct + strName + &quot;\n&quot;;
+}
+
+std::string UserStackTraceHelper::get_stack_trace_string()
+{
+  std::string stack_string = &quot;&quot;;
+  
+  std::stack&lt;SOURCE_LINE*&gt; tmp;
+  tmp = call_stack;
+  while(!tmp.empty())
+    {
+      SOURCE_LINE* stNode = tmp.top();
+      stack_string += GetStackNodeString(stNode);
+      tmp.pop();
+    }
+  return stack_string;
+}
+
 void init_error() {
 }
 void deinit_error() {

Modified: branches/multiplayer-branch/source/util/errors.h
===================================================================
--- branches/multiplayer-branch/source/util/errors.h	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/util/errors.h	2004-09-28 19:53:03 UTC (rev 71)
@@ -15,39 +15,49 @@
  */
 
 #ifdef __cplusplus
+#include &lt;stack&gt;
 
 int tw_alert(const char *message, const char *b1 = 0, const char *b2 = 0, const char *b3 = 0, const char *b4 = 0) ;
 
 // for errors caught in &quot;catch&quot; clauses
 void caught_error(const char *format, ...);
 
-//const int tw_error_str_len = 2048;	// should be plenty of room.
-//extern char tw_error_str[tw_error_str_len];
-//bool get_stacklist_info(int N, const char **filename, int **linenum, int **level);
-//bool get_stacktrace_info(int N, const char **filename, int **linenum, int **level);
 
-
-
 //quits TW with an error message
 //used for catastrophic errors
 void tw_error_exit(const char* message) ;
 
-
-//stacktrace and profiling stuff:
-
 #include &quot;get_time.h&quot;
 
-struct SOURCE_LINE {
-	int line;         // __LINE__
-	const char *file; // __FILE__
-	const char *name; // NULL or a descriptor string
+struct SOURCE_LINE 
+{
+  int line;         // __LINE__
+  const char *file; // __FILE__
+  const char *funct; // __FUNCTION__
+  const char *name; // NULL or a descriptor string
 };
 
+/// \brief Call stack tracker
+///
+/// Object of this class is created on stack in STACKTRACE macro, so it's creating/destruction can 
+/// be used to manage  call stack. 
+class UserStackTraceHelper 
+{
+  static std::stack&lt;SOURCE_LINE*&gt; call_stack;
+  static std::string GetStackNodeString(SOURCE_LINE* stNode);
+ public:
+  UserStackTraceHelper( SOURCE_LINE* srcline);
+  ~UserStackTraceHelper();
+  
+  /// \brief get stack trace string 
+  static std::string get_stack_trace_string();
+};
 
-#	define STACKTRACE
-#	define _STACKTRACE(A)
 
+#define STACKTRACE static SOURCE_LINE _srcline = { __LINE__, __FILE__, __FUNCTION__, 0 }; UserStackTraceHelper _stacktrace_ ( &amp;_srcline );
+#define _STACKTRACE(A) static SOURCE_LINE _srcline = { __LINE__, __FILE__, __FUNCTION__, A }; UserStackTraceHelper _stacktrace_ ( &amp;_srcline );
 
+
 extern &quot;C&quot; {
 #endif
 
@@ -84,41 +94,29 @@
  */
 
 #	define tw_error _prep_error_func(__FILE__, __LINE__)
-//#	define tw_error _prep_error(__FILE__, __LINE__); _error
-	void error_handler ( const char *message);
-	extern void (*_error_handler) ( 
-		int in_catch_statement, //&quot;retry&quot; is invalid inside a catch statement
-		const char *src_file, 
-		int line, 
-		const char *message 
-	);
 
-	typedef void (*ERROR_FUNC_TYPE)(const char *fmt, ...);
+  void error_handler ( const char *message);
+  extern void (*_error_handler) ( 
+				 int in_catch_statement, //&quot;retry&quot; is invalid inside a catch statement
+				 const char *src_file, 
+				 int line, 
+				 const char *message 
+				 );
 
-	ERROR_FUNC_TYPE _prep_error_func ( const char *file, int line );
-	void _prep_error(const char *file, int line);
-	void _error(const char *format, ...);
+  typedef void (*ERROR_FUNC_TYPE)(const char *fmt, ...);
+  
+  ERROR_FUNC_TYPE _prep_error_func ( const char *file, int line );
+  void _prep_error(const char *file, int line);
+  void _error(const char *format, ...);
+  
 
 /*
- * void error(const char *format, ...)
- *
- * This function is more or less the same as tw_error(const char *format, ...)
- *
- * The primary difference is, this function will not display extra debugging 
- * information.  Specifically, it won't attempt to display the call stack.  
- * 
- */
-
-	void error(const char *format, ...);
-
-
-/*
  * void log_debug(const char *format, ...)
  *
  * Records a log of certain information to disk.
  * Typical log message: &quot;Sound Initialized (10 voices sfx, 22 for music)&quot;
  */
-	void log_debug(const char *format, ...);
+  void log_debug(const char *format, ...);
 
 /*
  * void tw_error_exit(char* message)

Modified: branches/multiplayer-branch/source/util/history.cpp
===================================================================
--- branches/multiplayer-branch/source/util/history.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/util/history.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -2,8 +2,8 @@
 #include &lt;math.h&gt;
 #include &quot;base.h&quot;
 #include &quot;history.h&quot;
+#include &quot;errors.h&quot;
 
-
 ////////////////////////////////////////////////////////////////////////
 //				Histograph stuff
 ////////////////////////////////////////////////////////////////////////
@@ -30,6 +30,7 @@
 */
 
 Histograph::Histograph(Uint16 max) {
+  STACKTRACE;
 	num = 0;
 	base = 0;
 	this-&gt;max = max;
@@ -42,9 +43,11 @@
 	delete[] element;
 }
 void Histograph::add_element(double v) {
+  STACKTRACE;
 	_add(v);
 }
 void Histograph::_add(double v) {
+  STACKTRACE;
 	int i;
 	if (num == max) {
 		num -= next_ratio;

Modified: branches/multiplayer-branch/source/util/random.cpp
===================================================================
--- branches/multiplayer-branch/source/util/random.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/util/random.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -41,9 +41,11 @@
 	ADDITIVE   = 123456789
 };
 Uint32 RNG_lcg64a::randi(Uint32 max) {
+  STACKTRACE;
 	return _rng_dist_32_flat(max, raw32());
 }
 Uint32 RNG_lcg64a::raw32() {
+  STACKTRACE;
 #	if defined(_MSC_VER) &amp;&amp; defined(__i386__) &amp;&amp; !defined(NO_ASM)
 		split_int_64 i64 = s64;
 		_asm { mov eax, [i64.s.high] } 
@@ -73,6 +75,7 @@
 	return s64.s.high;
 }
 Uint64 RNG_lcg64a::raw64() {
+  STACKTRACE;
 	Uint64 bob = raw32();
 	bob = (bob &lt;&lt; 32) | raw32();
 	return bob;
@@ -95,11 +98,13 @@
 }
 
 void RNG_lcg64a::seed( int s ) {
+  STACKTRACE;
 	s64.s.low = s;
 	s64.s.high = 0;
 	return;
 }
 void RNG_lcg64a::seed_more( int s ) {
+  STACKTRACE;
 	if (s64.s.high &amp; 0x80000000) raw32();
 	raw32();
 	s64.s.low += ((s64.s.high &gt;&gt; 27) | (s64.s.high &lt;&lt; 5)) ^ s;

Modified: branches/multiplayer-branch/source/util/sound.cpp
===================================================================
--- branches/multiplayer-branch/source/util/sound.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/util/sound.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -24,11 +24,13 @@
 
 #include &lt;allegro.h&gt;
 #include &quot;other/twconfig.h&quot;
+#include &quot;errors.h&quot;
 
+SoundSystem* tw_sound = NULL;
 
-SoundSystem2 tw_sound;
-SoundSystem2::SoundSystem2(bool sound_on)
+SoundSystem::SoundSystem(bool sound_on)
 {
+  STACKTRACE;
   mix_ok = false;
   current_music = &quot;&quot;;
   
@@ -48,20 +50,27 @@
   const size_t buf_size = 1024;
 #endif
   
-  const int res = Mix_OpenAudio(MIX_DEFAULT_FREQUENCY,MIX_DEFAULT_FORMAT,2,buf_size);
+  int res = Mix_OpenAudio(MIX_DEFAULT_FREQUENCY,MIX_DEFAULT_FORMAT,2,buf_size);
   if(res &gt;= 0) 
     {
       mix_ok = true;
-      Mix_AllocateChannels(16);
+      Mix_AllocateChannels(32);
     } 
   else 
     {
       mix_ok = false;
       std::cerr &lt;&lt; &quot;Could not initialize audio: &quot; &lt;&lt; SDL_GetError() &lt;&lt; &quot;\n&quot;;
     }
+
+  res = Mix_QuerySpec(&amp;frequency, &amp;format, &amp;channels);
+  if(!res)
+    {
+      mix_ok = false;
+      std::cerr &lt;&lt; &quot;Could not initialize audio: &quot; &lt;&lt; SDL_GetError() &lt;&lt; &quot;\n&quot;;
+    }
 };
 
-SoundSystem2::~SoundSystem2()
+SoundSystem::~SoundSystem()
 {
   std::cerr &lt;&lt; &quot;closing audio...\n&quot;;
   if(!mix_ok)
@@ -87,8 +96,9 @@
   std::cerr &lt;&lt; &quot;done closing audio...\n&quot;;
 }
   
-void SoundSystem2::play_music(const std::string&amp; file, int loops)
+void SoundSystem::play_music(const std::string file, int loops)
 {
+  STACKTRACE;
   if(!mix_ok || current_music == file)
     return;
   
@@ -120,10 +130,10 @@
   
   if(Mix_PlayingMusic()) 
     {
-      Mix_FadeOutMusic(500);
+      Mix_FadeOutMusic(0);
     }
   
-  const int res = Mix_FadeInMusic(itor-&gt;second,loops,500);
+  const int res = Mix_FadeInMusic(itor-&gt;second,loops,0);
   if(res &lt; 0) 
     {
       std::cerr &lt;&lt; &quot;Could not play music: &quot; &lt;&lt; SDL_GetError() &lt;&lt; &quot;\n&quot;;
@@ -132,8 +142,9 @@
   current_music = file;
 }
 
-void SoundSystem2::play_sound(const std::string&amp; file)
+void SoundSystem::play_sound(const std::string file, double vol)
 {
+  STACKTRACE;
   if(!mix_ok || sound_off)
     return;
   
@@ -164,10 +175,38 @@
     {
       std::cerr &lt;&lt; &quot;error playing sound effect: &quot; &lt;&lt; SDL_GetError() &lt;&lt; &quot;\n&quot;;
     }
+  if(vol!=-1)
+    {
+      
+      Mix_VolumeChunk(itor-&gt;second, int(vol*double(MIX_MAX_VOLUME)));
+    }
 }
 
-void SoundSystem2::set_music_volume(double vol)
+void SoundSystem::stop_sound(const std::string file)
 {
+  STACKTRACE;
+  if(!mix_ok || sound_off)
+    return;
+  
+  std::map&lt;std::string,Mix_Chunk*&gt;::const_iterator itor = sound_cache.find(file);
+  if(itor == sound_cache.end()) 
+    {
+      return;
+    }
+  
+  for (int i=0; i&lt;32; i++)
+    {
+      Mix_Chunk * chunk = Mix_GetChunk(i);
+      if(chunk == itor-&gt;second)
+	{
+	  Mix_HaltChannel(i);
+	}
+    }
+}
+
+void SoundSystem::set_music_volume(double vol)
+{
+  STACKTRACE;
   if(!mix_ok)
     return;
   
@@ -195,8 +234,9 @@
   set_config_float(&quot;Sound&quot;, &quot;MusicVolume&quot;, vol);
 }
 
-void SoundSystem2::set_sound_volume(double vol)
+void SoundSystem::set_sound_volume(double vol)
 {
+  STACKTRACE;
   if(!mix_ok)
     return;
   
@@ -214,14 +254,22 @@
   set_config_float(&quot;Sound&quot;, &quot;SoundVolume&quot;, vol);
 }
 
-double SoundSystem2::load_music_volume()
+double SoundSystem::load_music_volume()
 {
+  STACKTRACE;
   tw_set_config_file(&quot;client.ini&quot;);
   return get_config_float(&quot;Sound&quot;, &quot;MusicVolume&quot;, 0.5);
 }
 
-double SoundSystem2::load_sound_volume()
+double SoundSystem::load_sound_volume()
 {
+  STACKTRACE;
   tw_set_config_file(&quot;client.ini&quot;);
   return get_config_float(&quot;Sound&quot;, &quot;SoundVolume&quot;, 0.5);
 }
+
+bool SoundSystem::playing_music()
+{
+  STACKTRACE;
+  return Mix_PlayingMusic();
+}

Modified: branches/multiplayer-branch/source/util/sound.h
===================================================================
--- branches/multiplayer-branch/source/util/sound.h	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/util/sound.h	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,16 +1,19 @@
-/* modified by Yurand for TW-Light */
-/* $Id: sound.hpp,v 1.11 2004/08/30 01:23:16 Sirp Exp $ */
 /*
-   Copyright (C) 2003 by David White &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/tw-light-svn">davidnwhite at optusnet.com.au</A>&gt;
-   Part of the Battle for Wesnoth Project <A HREF="http://wesnoth.whitevine.net">http://wesnoth.whitevine.net</A>
+This file is part of &quot;TW-Light&quot; 
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
+Copyright (C) 2001-2004  TimeWarp development team
 
-   This program is free software; you can redistribute it and/or modify
-   it under the terms of the GNU General Public License.
-   This program is distributed in the hope that it will be useful,
-   but WITHOUT ANY WARRANTY.
+This program is free software; you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation; either version 2 of the License, or
+(at your option) any later version.
 
-   See the COPYING file for more details.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
 */
+
 #ifndef TW_SOUND_H_INCLUDED
 #define TW_SOUND_H_INCLUDED
 
@@ -20,7 +23,7 @@
 #include &quot;SDL_mixer.h&quot;
 
 /// \brief All work with sound must be implemented using this class
-class SoundSystem2
+class SoundSystem
 {  
   bool mix_ok;
   std::map&lt;std::string,Mix_Chunk*&gt; sound_cache;
@@ -30,26 +33,40 @@
   
   bool music_off;
   bool sound_off;
+  
+  int frequency;
+  Uint16 format;
+  int channels;
 
  public:
-  SoundSystem2(bool sound_on = true);
-  ~SoundSystem2();
+  SoundSystem(bool sound_on = true);
+  ~SoundSystem();
 
   /// \brief play music file
-  void play_music(const std::string&amp; file, int loops = -1);
+  /// \param file - path to music file
+  /// \param loops - -1 play instantly
+  void play_music(const std::string file, int loops = -1);
   /// \brief play sound effect from file
-  void play_sound(const std::string&amp; file);
-  
+  /// \param file - path to sound file
+  /// \param vol - sound volume 1 - max, 0 min
+  void play_sound(const std::string file, double vol = -1);
+  /// \brief stop playing current sound
+  void stop_sound(const std::string file);
+
   /// \brief set music volume
   void set_music_volume(double vol);
   /// \brief set sound effect volume
   void set_sound_volume(double vol);
 
   // this functions will die after config would be implemented
-  
+  /// \brief get music volume from .ini 
   double load_music_volume();
+  /// \brief get sound volume from .ini
   double load_sound_volume();
+
+  /// \brief return true if music playing
+  bool playing_music();
 };
-extern SoundSystem2 tw_sound;
+extern SoundSystem* tw_sound;
 
 #endif

Deleted: branches/multiplayer-branch/source/util/sounds.cpp
===================================================================
--- branches/multiplayer-branch/source/util/sounds.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/util/sounds.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,62 +0,0 @@
-
-//#define NO_JGMOD
-
-#include &lt;allegro.h&gt;
-#ifdef WIN32
-#include &lt;winalleg.h&gt;
-#endif
-
-#include &quot;base.h&quot;
-#include &quot;sounds.h&quot;
-#include &quot;errors.h&quot; //only used for log_debug() function
-
-
-
-/* static int is_jgmod_compiled() {return 0;} */
-
-
-SoundSystem tw_soundsystem;
-SoundSystem::SoundSystem() {
-	return;
-}
-int SoundSystem::is_music_supported() const {
-  return 0;
-}
-int SoundSystem::is_music_playing() const {
-  return 0;
-}
-void SoundSystem::disable() {
-	return;
-}
-void SoundSystem::load() {
-	return;
-}
-void SoundSystem::save() {
-	return;
-}
-void SoundSystem::init() {
-	return;
-}
-int SoundSystem::play (SAMPLE *spl, int vol, int pan, int freq, bool loop) {
-  return -1;
-}
-void SoundSystem::stop (SAMPLE *spl) {
-}
-void SoundSystem::stop (int voice_id) {
-}
-void SoundSystem::play_music (Music *music, int loop) {
-}
-void SoundSystem::stop_music () {
-}
-void SoundSystem::set_volumes(int sound_volume, int music_volume, int sound_on, int music_on) {
-}
-
-Music *SoundSystem::load_music(const char *fname) 
-{
-  return NULL;
-}
-
-
-void SoundSystem::unload_music(Music *mus) 
-{
-}

Deleted: branches/multiplayer-branch/source/util/sounds.h
===================================================================
--- branches/multiplayer-branch/source/util/sounds.h	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/util/sounds.h	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,68 +0,0 @@
-#ifndef __SOUNDS_H__
-#define __SOUNDS_H__
-
-#define PLATFORM_IS_ALLEGRO
-
-#ifdef PLATFORM_IS_ALLEGRO
-	struct SAMPLE;
-	struct JGMOD;
-	typedef SAMPLE  Sound;
-	typedef JGMOD   Music;
-#else
-	#error unknown platform (allegro?)
-#endif
-
-#include &quot;base.h&quot;
-
-class SoundSystem : public BaseClass {
-	public:
-	enum {
-		ENABLED = 1,
-		DISABLED = 2,
-		MOD_ENABLED = 4,
-		MOD_DISABLED = 8, 
-		SOUND_ON = 16,
-		MUSIC_ON = 32,
-		OGG_ENABLED = 64,
-		OGG_DISABLED = 128
-		};
-	Music *looping_music;
-	char fake_mod_playing;
-	char sound_on, music_on;
-	char sound_channels, music_channels;
-	int sound_volume, music_volume;
-	unsigned int state;
-
-	SoundSystem() ;
-	void disable() ;
-
-	void load() ;
-	void save() ;
-	void init() ;
-
-	int play (Sound *spl, int vol = 256, int pan = 128, int freq = 1000, bool loop = false) ;
-	void stop (Sound *spl);
-	void stop (int voice_id);
-	
-	void pause_music(SAMPLE * sample);
-	void resume_music(SAMPLE * sample);
-
-	void play_music (Music *mus, int loop = false);
-	void stop_music ();
-	int is_music_playing() const;
-	int is_music_supported() const;
-
-	void set_volumes(int sound_volume, int music_volume, int sound_on, int music_on) ;
-
-	Music *load_music(const char *fname);
-	void unload_music(Music *music);
-	
-}
-extern tw_soundsystem;
-#define sound tw_soundsystem
-
-/*------------------------------
-		Sound (and MODs)
-------------------------------*/
-
-#endif // __SOUNDS_H__

Modified: branches/multiplayer-branch/source/util/vector2.cpp
===================================================================
--- branches/multiplayer-branch/source/util/vector2.cpp	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/source/util/vector2.cpp	2004-09-28 19:53:03 UTC (rev 71)
@@ -4,15 +4,21 @@
 #include &quot;vector2.h&quot;
 #include &quot;random.h&quot;
 #include &quot;round.h&quot;
+#include &quot;errors.h&quot;
 //#include &quot;../melee.h&quot;
 
-Vector2::Vector2(Vector2i v2i) : x(v2i.x), y(v2i.y) {}
+Vector2::Vector2(Vector2i v2i) : x(v2i.x), y(v2i.y) 
+{
+  STACKTRACE;
+}
 Vector2i Vector2::round()
 {
+  STACKTRACE;
 	return Vector2i(iround(x), iround(y));
 }
 Vector2i Vector2::truncate()
 {
+  STACKTRACE;
 	return Vector2i(int(x), int(y));
 }
 
@@ -71,6 +77,7 @@
 
 Vector3D::Vector3D(double ax, double ay, double az)
 {
+  STACKTRACE;
 	x = ax;
 	y = ay;
 	z = az;
@@ -78,16 +85,19 @@
 
 double Vector3D::dot(Vector3D v)
 {
+  STACKTRACE;
 	return x*v.x + y*v.y + z*v.z;
 }
 
 Vector3D Vector3D::cross(Vector3D b)
 {
+  STACKTRACE;
 	return Vector3D(y*b.z - z*b.y, -x*b.z + z*b.x, x*b.y - y*b.x);
 }
 
 void Vector3D::normalize()
 {
+  STACKTRACE;
 	double r;
 	r = sqrt(x*x + y*y + z*z);
 	x /= r;

Modified: branches/multiplayer-branch/sources.lst
===================================================================
--- branches/multiplayer-branch/sources.lst	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/sources.lst	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,162 +1,191 @@
+source/ais/c_wussie.cpp
+source/ais/c_other.cpp
 source/ais/c_input.cpp
-source/ais/c_other.cpp
-source/ais/c_wussie.cpp
-source/doxygen.cpp
 source/frame.cpp
+source/util/random.cpp
+source/util/vector2.cpp
+source/util/round.c
+source/util/history.cpp
+source/util/types.cpp
+source/util/aautil.c
+source/util/sound.cpp
+source/util/get_time.c
+source/util/aarot.c
+source/util/aastr.c
+source/util/errors.cpp
+source/util/errors_c.c
+source/util/endian.cpp
+source/util/pmask.c
+source/util/base.cpp
+source/games/ggob.cpp
 source/games/gflmelee.cpp
-source/games/MultiplayerGame.cpp
-source/gui.cpp
-source/input.cpp
-source/libraries/agup/aalg.c
-source/libraries/agup/aase.c
-source/libraries/agup/abeos.c
-source/libraries/agup/abitmap.c
-source/libraries/agup/agtk.c
-source/libraries/agup/agup.c
-source/libraries/agup/ans.c
-source/libraries/agup/aphoton.c
-source/libraries/agup/awin95.c
-source/libraries/jpgalleg/decode.c
-source/libraries/jpgalleg/encode.c
-source/libraries/jpgalleg/io.c
-source/libraries/jpgalleg/jpgalleg.c
-source/libraries/raknet/AES128.cpp
-source/libraries/raknet/AsynchronousFileIO.cpp
-source/libraries/raknet/BitStream.cpp
-source/libraries/raknet/CheckSum.cpp
-source/libraries/raknet/DataBlockEncryptor.cpp
-source/libraries/raknet/DistributedNetworkObject.cpp
-source/libraries/raknet/DistributedNetworkObjectManager.cpp
-source/libraries/raknet/DistributedNetworkObjectStub.cpp
-source/libraries/raknet/EncodeClassName.cpp
-source/libraries/raknet/Euclid.cpp
-source/libraries/raknet/ExtendedOverlappedPool.cpp
-source/libraries/raknet/GetTime.cpp
-source/libraries/raknet/HuffmanEncodingTree.cpp
-source/libraries/raknet/HuffmanEncodingTreeFactory.cpp
-source/libraries/raknet/InternalPacketPool.cpp
-source/libraries/raknet/MPUInt.cpp
-source/libraries/raknet/NetworkObject.cpp
-source/libraries/raknet/NetworkTypes.cpp
-source/libraries/raknet/PacketPool.cpp
-source/libraries/raknet/RakClient.cpp
-source/libraries/raknet/RakNetworkFactory.cpp
-source/libraries/raknet/RakPeer.cpp
-source/libraries/raknet/RakServer.cpp
-source/libraries/raknet/rand.cpp
-source/libraries/raknet/ReliabilityLayer.cpp
-source/libraries/raknet/RPCNode.cpp
-source/libraries/raknet/RSA.cpp
-source/libraries/raknet/SHA1.cpp
-source/libraries/raknet/SimpleMutex.cpp
-source/libraries/raknet/SocketLayer.cpp
-source/libraries/raknet/StringCompressor.cpp
-source/melee/manim.cpp
-source/melee/mcbodies.cpp
-source/melee/mcontrol.cpp
-source/melee/mfleet.cpp
-source/melee/mframe.cpp
-source/melee/mgame.cpp
-source/melee/mhelpers.cpp
+source/games/gdefender.cpp
+source/melee/mlog.cpp
 source/melee/mitems.cpp
-source/melee/mlog.cpp
-source/melee/mmain.cpp
-source/melee/mmath.cpp
 source/melee/mnet1.cpp
 source/melee/moptions.cpp
+source/melee/mgame.cpp
+source/melee/mhelpers.cpp
+source/melee/mfleet.cpp
+source/melee/mview.cpp
 source/melee/mship.cpp
+source/melee/mcontrol.cpp
+source/melee/manim.cpp
+source/melee/mframe.cpp
 source/melee/mshot.cpp
 source/melee/mshpdata.cpp
 source/melee/mshppan.cpp
 source/melee/msprite.cpp
+source/melee/mcbodies.cpp
+source/melee/mmain.cpp
 source/melee/mtarget.cpp
-source/melee/mview.cpp
+source/melee/mmath.cpp
+source/other/orbit.cpp
 source/other/configrw.cpp
-source/other/dialogs.cpp
+source/other/shippart.cpp
 source/other/fontmorph.cpp
+source/other/vtarget.cpp
+source/other/twconfig.cpp
+source/other/vbodies.cpp
+source/other/gup.cpp
+source/other/objanim.cpp
 source/other/nullphas.cpp
-source/other/objanim.cpp
-source/other/orbit.cpp
 source/other/planet3d.cpp
 source/other/radar.cpp
-source/other/shippart.cpp
-source/other/twconfig.cpp
-source/other/vbodies.cpp
-source/other/vtarget.cpp
-source/sc1ships/shpandgu.cpp
-source/sc1ships/shparisk.cpp
-source/sc1ships/shpchebr.cpp
-source/sc1ships/shpearcr.cpp
-source/sc1ships/shpilwav.cpp
-source/sc1ships/shpkzedr.cpp
-source/sc1ships/shpmmrxf.cpp
-source/sc1ships/shpmycpo.cpp
-source/sc1ships/shpshosc.cpp
-source/sc1ships/shpspael.cpp
-source/sc1ships/shpsyrpe.cpp
-source/sc1ships/shpumgdr.cpp
-source/sc1ships/shpvuxin.cpp
-source/sc1ships/shpyehte.cpp
-source/sc2ships/shpchmav.cpp
-source/sc2ships/shpdruma.cpp
-source/sc2ships/shpkohma.cpp
-source/sc2ships/shpmeltr.cpp
-source/sc2ships/shporzne.cpp
-source/sc2ships/shppkufu.cpp
-source/sc2ships/shpslypr.cpp
-source/sc2ships/shpsupbl.cpp
-source/sc2ships/shpthrto.cpp
-source/sc2ships/shputwju.cpp
-source/sc2ships/shpzfpst.cpp
-source/scp.cpp
+source/other/dialogs.cpp
+source/ships/shptauar.cpp
+source/ships/shpbogce.cpp
 source/ships/shpaktgu.cpp
+source/ships/shptauda.cpp
+source/ships/shpforsh.cpp
+source/ships/shptaume.cpp
+source/ships/shpdragr.cpp
+source/ships/shptausl.cpp
+source/ships/shptaust.cpp
+source/ships/shptauto.cpp
+source/ships/shpgarty.cpp
+source/ships/shprogsq.cpp
+source/ships/shpzeksh.cpp
+source/ships/shpconca.cpp
+source/ships/shpchoex.cpp
+source/ships/shpconho.cpp
+source/ships/shpilwsp.cpp
 source/ships/shpalabc.cpp
+source/ships/shpyusra.cpp
 source/ships/shpbahbu.cpp
 source/ships/shpbipka.cpp
-source/ships/shpbogce.cpp
-source/ships/shpchoex.cpp
-source/ships/shpconca.cpp
-source/ships/shpconho.cpp
-source/ships/shpdragr.cpp
+source/ships/shpwolmi.cpp
 source/ships/shpearc3.cpp
-source/ships/shpforsh.cpp
-source/ships/shpgarty.cpp
-source/ships/shpilwsp.cpp
 source/ships/shpkahbo.cpp
-source/ships/shprogsq.cpp
 source/ships/shpstaba.cpp
-source/ships/shptauar.cpp
-source/ships/shptauda.cpp
-source/ships/shptaume.cpp
-source/ships/shptausl.cpp
-source/ships/shptaust.cpp
-source/ships/shptauto.cpp
-source/ships/shpwolmi.cpp
-source/ships/shpyusra.cpp
-source/ships/shpzeksh.cpp
+source/tests/testmain.cpp
 source/tests/testdatapath.cpp
-source/tests/testmain.cpp
-source/twgui/twbutton.cpp
-source/twgui/twbuttontypes.cpp
 source/twgui/twgui.cpp
 source/twgui/twhelpers.cpp
+source/twgui/twbuttontypes.cpp
+source/twgui/twbutton.cpp
 source/twgui/twmenuexamples.cpp
 source/twgui/twpopup.cpp
 source/twgui/twwindow.cpp
 source/twgui/utils.cpp
-source/util/aarot.c
-source/util/aastr.c
-source/util/aautil.c
-source/util/base.cpp
-source/util/endian.cpp
-source/util/errors.cpp
-source/util/errors_c.c
-source/util/get_time.c
-source/util/history.cpp
-source/util/pmask.c
-source/util/random.cpp
-source/util/round.c
-source/util/sound.cpp
-source/util/sounds.cpp
-source/util/types.cpp
-source/util/vector2.cpp
+source/libraries/lua/lib/ldblib.c
+source/libraries/lua/lib/lauxlib.c
+source/libraries/lua/lib/lbaselib.c
+source/libraries/lua/lib/loadlib.c
+source/libraries/lua/lib/ltablib.c
+source/libraries/lua/lib/lmathlib.c
+source/libraries/lua/lib/lstrlib.c
+source/libraries/lua/lib/liolib.c
+source/libraries/lua/lundump.c
+source/libraries/lua/ldebug.c
+source/libraries/lua/ldo.c
+source/libraries/lua/lgc.c
+source/libraries/lua/ltm.c
+source/libraries/lua/lvm.c
+source/libraries/lua/lcode.c
+source/libraries/lua/ldump.c
+source/libraries/lua/lfunc.c
+source/libraries/lua/lparser.c
+source/libraries/lua/ltable.c
+source/libraries/lua/ltests.c
+source/libraries/lua/lstate.c
+source/libraries/lua/lapi.c
+source/libraries/lua/llex.c
+source/libraries/lua/lmem.c
+source/libraries/lua/lzio.c
+source/libraries/lua/lopcodes.c
+source/libraries/lua/lobject.c
+source/libraries/lua/lstring.c
+source/libraries/agup/aphoton.c
+source/libraries/agup/ans.c
+source/libraries/agup/awin95.c
+source/libraries/agup/aalg.c
+source/libraries/agup/aase.c
+source/libraries/agup/agtk.c
+source/libraries/agup/agup.c
+source/libraries/agup/abeos.c
+source/libraries/agup/abitmap.c
+source/libraries/raknet/AES128.cpp
+source/libraries/raknet/PacketPool.cpp
+source/libraries/raknet/ExtendedOverlappedPool.cpp
+source/libraries/raknet/RakServer.cpp
+source/libraries/raknet/RPCNode.cpp
+source/libraries/raknet/RSA.cpp
+source/libraries/raknet/RakClient.cpp
+source/libraries/raknet/HuffmanEncodingTreeFactory.cpp
+source/libraries/raknet/RakPeer.cpp
+source/libraries/raknet/SocketLayer.cpp
+source/libraries/raknet/StringCompressor.cpp
+source/libraries/raknet/DataBlockEncryptor.cpp
+source/libraries/raknet/InternalPacketPool.cpp
+source/libraries/raknet/SHA1.cpp
+source/libraries/raknet/rand.cpp
+source/libraries/raknet/GetTime.cpp
+source/libraries/raknet/EncodeClassName.cpp
+source/libraries/raknet/NetworkObject.cpp
+source/libraries/raknet/SimpleMutex.cpp
+source/libraries/raknet/Euclid.cpp
+source/libraries/raknet/DistributedNetworkObjectStub.cpp
+source/libraries/raknet/ReliabilityLayer.cpp
+source/libraries/raknet/AsynchronousFileIO.cpp
+source/libraries/raknet/HuffmanEncodingTree.cpp
+source/libraries/raknet/BitStream.cpp
+source/libraries/raknet/RakNetworkFactory.cpp
+source/libraries/raknet/DistributedNetworkObject.cpp
+source/libraries/raknet/MPUInt.cpp
+source/libraries/raknet/CheckSum.cpp
+source/libraries/raknet/DistributedNetworkObjectManager.cpp
+source/libraries/raknet/NetworkTypes.cpp
+source/libraries/jpgalleg/io.c
+source/libraries/jpgalleg/encode.c
+source/libraries/jpgalleg/decode.c
+source/libraries/jpgalleg/jpgalleg.c
+source/scp.cpp
+source/doxygen.cpp
+source/input.cpp
+source/sc1ships/shpearcr.cpp
+source/sc1ships/shpchebr.cpp
+source/sc1ships/shpandgu.cpp
+source/sc1ships/shpilwav.cpp
+source/sc1ships/shpkzedr.cpp
+source/sc1ships/shpyehte.cpp
+source/sc1ships/shpsyrpe.cpp
+source/sc1ships/shpspael.cpp
+source/sc1ships/shpvuxin.cpp
+source/sc1ships/shpumgdr.cpp
+source/sc1ships/shparisk.cpp
+source/sc1ships/shpmycpo.cpp
+source/sc1ships/shpmmrxf.cpp
+source/sc1ships/shpshosc.cpp
+source/sc2ships/shpthrto.cpp
+source/sc2ships/shporzne.cpp
+source/sc2ships/shpdruma.cpp
+source/sc2ships/shpmeltr.cpp
+source/sc2ships/shpchmav.cpp
+source/sc2ships/shpkohma.cpp
+source/sc2ships/shputwju.cpp
+source/sc2ships/shpsupbl.cpp
+source/sc2ships/shppkufu.cpp
+source/sc2ships/shpslypr.cpp
+source/sc2ships/shpzfpst.cpp
+source/gui.cpp

Copied: branches/multiplayer-branch/web/3dlogo.jpg (from rev 69, trunk/web/3dlogo.jpg)


Property changes on: branches/multiplayer-branch/web/3dlogo.jpg
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Copied: branches/multiplayer-branch/web/background.jpg (from rev 69, trunk/web/background.jpg)


Property changes on: branches/multiplayer-branch/web/background.jpg
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Copied: branches/multiplayer-branch/web/dialog-editor-win32-62.zip (from rev 69, trunk/web/dialog-editor-win32-62.zip)


Property changes on: branches/multiplayer-branch/web/dialog-editor-win32-62.zip
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Copied: branches/multiplayer-branch/web/downloads.html (from rev 69, trunk/web/downloads.html)

Modified: branches/multiplayer-branch/web/index.html
===================================================================
--- branches/multiplayer-branch/web/index.html	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/web/index.html	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,117 +1,78 @@
 &lt;html&gt;
 
 &lt;head&gt;
-	&lt;link href=&quot;style.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; title=&quot;default&quot;/&gt;
+&lt;link href=&quot;style.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; title=&quot;default&quot;/&gt;
 &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=windows-1251&quot;&gt;
 &lt;meta name=&quot;description&quot; content=&quot;Homepage of TW-Light.&quot;&gt;
-&lt;meta name=&quot;keywords&quot; content=&quot;TW-Light timewarp SC sc1 sc2 star control uqm the ur-quan masters ur-quan 
-orz spathi adventure opensource game zip yurand fork TW&quot;&gt;
+&lt;meta name=&quot;keywords&quot; content=&quot;TW-Light timewarp SC sc1 sc2 star control uqm the ur-quan masters ur-quan orz spathi adventure opensource game zip yurand fork TW&quot;&gt;
 &lt;title&gt;TW-Light&lt;/title&gt;
 &lt;/head&gt;
 
 &lt;body&gt;
 
-&lt;!--
-&lt;div align=&quot;center&quot;&gt;&lt;center&gt;
-&lt;table border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot;&gt;
-	&lt;tr&gt;&lt;td align=&quot;center&quot;&gt;&lt;img border=&quot;0&quot; src=&quot;logo.png&quot; alt=&quot;TW-Light&quot; width=&quot;390&quot; height=&quot;150&quot;&gt;&lt;/td&gt;&lt;/tr&gt;
-&lt;/table&gt;
-&lt;/center&gt;
+&lt;div class=&quot;navbar&quot;&gt;
+  &lt;table class=&quot;navlinks&quot; summary=&quot;navigation bar&quot;&gt;
+    &lt;tr&gt;
+      &lt;td&gt;
+        &lt;img src=&quot;./3dlogo.jpg&quot; alt=&quot;&quot; width=&quot;200&quot; height=&quot;120&quot; /&gt; 
+      &lt;/td&gt;
+      &lt;td&gt;
+      &lt;a id=&quot;curpagelink&quot; href=&quot;./index.html&quot;&gt;News&lt;/a&gt; | &lt;a href=&quot;./info.html&quot;&gt;Info&lt;/a&gt; | &lt;a href=&quot;./team.html&quot;&gt;Team&lt;/a&gt; | &lt;a  href=&quot;./downloads.html&quot;&gt;Downloads&lt;/a&gt; | &lt;a href=&quot;<A HREF="http://openfacts.berlios.de/index-en.phtml?title=TW-Light">http://openfacts.berlios.de/index-en.phtml?title=TW-Light</A>&quot;&gt;Wiki&lt;/a&gt; | &lt;a href=&quot;<A HREF="http://bugs.cs.iupui.edu/cgi-bin/bugzilla/">http://bugs.cs.iupui.edu/cgi-bin/bugzilla/</A>&quot;&gt;Bug Database&lt;/a&gt; | &lt;a href=&quot;<A HREF="http://timewarp.sourceforge.net/forum/index.php">http://timewarp.sourceforge.net/forum/index.php</A>&quot;&gt;Forum&lt;/a&gt; | &lt;a href=&quot;./links.html&quot;&gt;Links&lt;/a&gt;
+      &lt;/td&gt;
+    &lt;/tr&gt;
+  &lt;/table&gt;
 &lt;/div&gt;
---&gt;
 
-&lt;p&gt;&lt;div class=&quot;title&quot;&gt;&lt;center&gt;about&lt;/center&gt;&lt;/div&gt;
-&lt;p&gt;&lt;/p&gt;
-&lt;table border=&quot;0&quot; width=&quot;100%&quot;&gt;
-&lt;td&gt;
-	&lt;a href=&quot;snapshot.png&quot;&gt;&lt;img src=&quot;snapshot.png&quot; alt=&quot;snapshot&quot; width=&quot;240&quot; height=&quot;180&quot; border=&quot;1&quot;&gt;&lt;/a&gt;
-&lt;/td&gt;
-&lt;td&gt;
-	&lt;p align=&quot;left&quot;&gt;&lt;font size=&quot;3&quot;&gt;TW-Light is an open source clone/sequel to the epic cross-genre 
-		game Star Control II. Currently it includes only a combat portion, although there 
-		are some plans to expand it to include an epic adventure. TW-Light is derivative work
-		from &lt;a href=&quot;<A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>&quot;&gt;Star Control: Timewarp&lt;/a&gt;
-		&lt;/font&gt;
-	&lt;/p&gt;
+&lt;div class=&quot;main&quot;&gt;
+  &lt;h3 class=&quot;important&quot;&gt;TW-Light&lt;/h3&gt;
+  &lt;p class=&quot;indented&quot;&gt;
+  TW-Light is an open source clone/sequel to the epic cross-genre game
+ Star Control II. Currently it includes only a combat portion, although
+ epic adventure part that is called TW:Legacies is actively developed
+ now. TW-Light is derivative work from Star Control: Timewarp
+  
+&lt;a href=&quot;<A HREF="http://timewarp.sourceforge.net/">http://timewarp.sourceforge.net/</A>&quot;&gt;Star Control: Timewarp&lt;/a&gt;
+&lt;/p&gt;
 
-
-	&lt;p align=&quot;left&quot;&gt;&lt;font size=&quot;3&quot;&gt;
-		TW-Light is written in portable C++ 							
-		and is known to compile and run on &lt;b&gt;Linux&lt;/b&gt;  and &lt;b&gt;Windows&lt;/b&gt; 
-		(with the exception that it is still not 64-bit clean 
-		as nobody of us has access to such hardware)&lt;/font&gt;
-	&lt;/p&gt;
-&lt;/td&gt;
-	&lt;/table&gt;
-	
-&lt;p align=&quot;left&quot;&gt;&lt;font size=&quot;3&quot;&gt;More detailed information about the game: 
-&lt;a href=&quot;<A HREF="http://openfacts.berlios.de/index-en.phtml?title=TW-Light">http://openfacts.berlios.de/index-en.phtml?title=TW-Light</A>&quot;&gt;Wiki&lt;/a&gt;, 
-&lt;!--
-&lt;br&gt;
-&lt;br&gt;
-Subscribe to our &lt;a href=&quot;<A HREF="http://sourceforge.net/mail/?group_id=13354">http://sourceforge.net/mail/?group_id=13354</A>&quot;&gt;mailing lists&lt;/a&gt; if you want to always know the latest news about TimeWarp.
---&gt;&lt;/font&gt;
+&lt;p class=&quot;indented&quot;&gt;
+TW-Light is written in portable C++ and is known to compile and run on &lt;b&gt;Linux&lt;/b&gt;  
+and &lt;b&gt;Windows&lt;/b&gt; (with the exception that it is still not 64-bit clean as nobody of 
+us has access to such hardware)
 &lt;/p&gt;
 
-&lt;div class=&quot;title&quot;&gt;&lt;center&gt;downloads&lt;/center&gt;&lt;/div&gt;
-&lt;p&gt;&lt;div class=&quot;indented&quot;&gt;
-	The latest version is &lt;b&gt;0.2r16&lt;/b&gt;.
-	You can download it &lt;a href=&quot;<A HREF="http://developer.berlios.de/project/showfiles.php?group_id=2082&amp;release_id=3153">http://developer.berlios.de/project/showfiles.php?group_id=2082&amp;release_id=3153</A>&quot;&gt;here.&lt;/a&gt;&lt;br&gt;
+&lt;br /&gt;
 
-	To successfully compile the sources and play the game on Linux/Unix you first need 
-	&lt;a href=&quot;<A HREF="http://www.allegro.cc/files/index.html">http://www.allegro.cc/files/index.html</A>&quot;&gt;Allegro&lt;/a&gt;
-	&lt;!--	
-	 and &lt;a href=&quot;<A HREF="http://www.lua.org">http://www.lua.org</A>&quot;&gt;Lua&lt;/a&gt;
-	View &lt;a href=&quot;&quot;&gt;ChangeLog&lt;/a&gt; to see the list of the latest changes.&lt;br&gt;
-	--&gt;
-&lt;/div&gt;	
-&lt;/div&gt;&lt;/p&gt;
+&lt;h2&gt;News&lt;/h2&gt;
 
-&lt;!-- &lt;div class=&quot;title&quot;&gt;&lt;center&gt;news&lt;/center&gt;&lt;/div&gt; --&gt;
+&lt;!--
+&lt;h3&gt;Announcing the Ultronomicon&lt;span class=&quot;date&quot;&gt;(Friday, September 3 2004)&lt;/span&gt;&lt;/h3&gt;
+&lt;p class=&quot;indented&quot;&gt;
+    The &lt;a href=&quot;<A HREF="http://uqm.stack.nl/wiki/">http://uqm.stack.nl/wiki/</A>&quot;&gt;Ultronomicon&lt;/a&gt;, our new wiki
+    database, is now officially open.
+    We've chosen the &lt;a href=&quot;<A HREF="http://creativecommons.org/licenses/by/2.0/">http://creativecommons.org/licenses/by/2.0/</A>&quot;&gt;
+    Creative Commons Attribution 2.0&lt;/a&gt; license for all its text.
+&lt;/p&gt;
 
+&lt;p class=&quot;indented&quot;&gt;
+    The goal is to make it a complete reference work for everything relating
+    to The Ur-Quan Masters, including the Star Control universe, gameplay,
+    technical tips, and developer info.
+&lt;/p&gt;
 
-&lt;div class=&quot;title&quot;&gt;&lt;center&gt;development&lt;/center&gt;&lt;/div&gt;
-&lt;p&gt;
-TW-Light is developed by a group of Star Control fans. Though the game is quite playable 
-now, it is far from being complete. The development of this game is still going 
-on. Please note, that this is a &lt;b&gt;real project&lt;/b&gt;, not just a collection of 
-plans, ideas and dreams like in some other places in the net.
-
-Things may seem to change slow, but there is real progress and every new version 
-is (we hope ;-) better than previous one. Anyway it is better to have a working 
-game than lots of ideas, but no code at all. All the work is done in our spare 
-time, so don't expect that your nice suggestion will be implemented in a short 
-time. If you are badly missing some feature and think that you can make it 
-youself, your patch will be welcome (if it does not break all the rest ;-)
+&lt;p class=&quot;indented&quot;&gt;
+    I encourage everyone to write a bit about their favourite Ur-Quan Masters
+    subject, so that we will have something to show soon.
+&lt;/p&gt;
+--&gt;
+  
+&lt;/div&gt;
+	
+&lt;!--
 &lt;br&gt;
 &lt;br&gt;
-You can support the project by participating discussion in 
-&lt;a href=&quot;<A HREF="http://timewarp.sourceforge.net/forum/index.php">http://timewarp.sourceforge.net/forum/index.php</A>&quot;&gt;TimeWarp forum&lt;/a&gt;, 
-where you can post suggestions for future development or just any questions about TW-Light.&lt;br&gt;
-&lt;br&gt;
-You can support the project by posting bugreports and patches in 
-&lt;a href=&quot;<A HREF="http://bugs.cs.iupui.edu/cgi-bin/bugzilla/">http://bugs.cs.iupui.edu/cgi-bin/bugzilla/</A>&quot;&gt;TimeWarp Bugzilla&lt;/a&gt;
-&lt;br&gt;&lt;br&gt;
-&lt;br&gt;
-&lt;a href=&quot;<A HREF="http://svn.berlios.de/viewcvs/tw-light/">http://svn.berlios.de/viewcvs/tw-light/</A>&quot;&gt;TW-Light SVN repository&lt;/a&gt; 
+Subscribe to our &lt;a href=&quot;<A HREF="http://sourceforge.net/mail/?group_id=13354">http://sourceforge.net/mail/?group_id=13354</A>&quot;&gt;mailing lists&lt;/a&gt; if you want to always know the latest news about TimeWarp.
+--&gt;
 
-&lt;/p&gt;
-
-&lt;p align=&quot;left&quot;&gt;&lt;font size=&quot;3&quot;&gt;&lt;strong&gt;TW-Light resources&lt;/strong&gt;&lt;/font&gt;&lt;/p&gt;
-
-&lt;ul&gt;
-    &lt;li&gt;&lt;a href=&quot;<A HREF="http://developer.berlios.de/projects/tw-light/">http://developer.berlios.de/projects/tw-light/</A>&quot;&gt;BerliOS: TW-Light Project Info&lt;/a&gt;&lt;/li&gt;
-    &lt;li&gt;&lt;a href=&quot;<A HREF="http://bugs.cs.iupui.edu/cgi-bin/bugzilla/">http://bugs.cs.iupui.edu/cgi-bin/bugzilla/</A>&quot;&gt;TW-Light Bugzilla&lt;/a&gt; &lt;/li&gt;
-    &lt;li&gt;&lt;a href=&quot;<A HREF="http://timewarp.sourceforge.net/forum/index.php">http://timewarp.sourceforge.net/forum/index.php</A>&quot;&gt;TimeWarp Forum (official)&lt;/a&gt; &lt;/li&gt;
-&lt;/ul&gt;
-
-&lt;p align=&quot;left&quot;&gt;&lt;font size=&quot;3&quot;&gt;&lt;strong&gt;other Star Control inspired game projects in development&lt;/strong&gt;&lt;/font&gt;&lt;/p&gt;
-&lt;ul&gt;
-    &lt;li&gt;&lt;a href=&quot;<A HREF="http://timewarp.sourceforge.net">http://timewarp.sourceforge.net</A>&quot;&gt;TimeWarp&lt;/a&gt; &lt;/li&gt;
-    &lt;li&gt;&lt;a href=&quot;<A HREF="http://sc2.sourceforge.net">http://sc2.sourceforge.net</A>&quot;&gt;The Ur-quan Masters&lt;/a&gt; &lt;/li&gt;
-    &lt;li&gt;&lt;a href=&quot;<A HREF="http://twx.sourceforge.net">http://twx.sourceforge.net</A>&quot;&gt;TWX&lt;/a&gt; &lt;/li&gt;
-&lt;/ul&gt;
-
 &lt;p align=&quot;left&quot;&gt;&lt;font size=&quot;3&quot;&gt;&lt;strong&gt;this page is hosted by&lt;/strong&gt;&lt;/font&gt;&lt;/p&gt;
 &lt;table border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;100%&quot;&gt;
 &lt;tr&gt;&lt;td align=&quot;left&quot;&gt;&lt;a href=&quot;<A HREF="http://developer.berlios.de">http://developer.berlios.de</A>&quot; title=&quot;BerliOS Developer&quot;&gt; &lt;img src=&quot;<A HREF="http://developer.berlios.de/bslogo.php?group_id=2082">http://developer.berlios.de/bslogo.php?group_id=2082</A>&quot; width=&quot;124px&quot; height=&quot;32px&quot; border=&quot;0&quot; alt=&quot;BerliOS Developer Logo&quot;&gt;&lt;/a&gt;

Copied: branches/multiplayer-branch/web/info.html (from rev 69, trunk/web/info.html)

Copied: branches/multiplayer-branch/web/links.html (from rev 69, trunk/web/links.html)

Deleted: branches/multiplayer-branch/web/logo.png
===================================================================
(Binary files differ)

Modified: branches/multiplayer-branch/web/style.css
===================================================================
--- branches/multiplayer-branch/web/style.css	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/web/style.css	2004-09-28 19:53:03 UTC (rev 71)
@@ -31,6 +31,7 @@
   padding: 0px 0px 0px 2px;
 }
 
+
 p {
   padding: 0px 0px 0px 2px;
 }
@@ -63,9 +64,10 @@
 }
 
 /* top navigation bar */
-.topbar {
+.navbar {
   color: #ffffff;
   background-color: #001133;
+  background-image: url(background.jpg);
   margin-left: 1em;
   margin-right: 1em;
   margin-top: 1em;
@@ -77,19 +79,19 @@
   font-weight: bold;
 }
 
-/* topbar links */
-.toplinks {
+/* navbar links */
+.navlinks {
   font-size: 110%;
   text-align: center;
 }
 
-/* topbar links table settings */
-table.toplinks td {
+/* navbar links table settings */
+table.navlinks td {
   padding: 0px 10px 0px 0px;
   margin-left: 1em;
 }
 
-/* current page in topbar links */
+/* current page in navbar links */
 #curpagelink {
   color: white;
   background-color: transparent;
@@ -104,6 +106,7 @@
 .main {
   color: #ffffff;
   background-color: #001133;
+/*  background-image: url(./bluepurplenebula2.jpg);*/
   margin-left: 1em;
   margin-right: 1em;
   margin-top: 1em;
@@ -163,6 +166,7 @@
   width: 100%;
 }
 
+
 /* important (red) &lt;h3&gt; */
 h3.important {
   color: white;
@@ -172,14 +176,4 @@
   border-right: 2px solid #bb0000;
   border-bottom: 2px solid #bb0000;
   padding: 0px 0px 0px 2px;
-}
-
-.title {
-  color: white;
-  background-color: #661166;
-  border-top: 2px solid #994499;
-  border-left: 2px solid #994499;
-  border-right: 2px solid #994499;
-  border-bottom: 2px solid #994499;    
-  padding: 0px 0px 0px 2px;
-}
+}
\ No newline at end of file

Copied: branches/multiplayer-branch/web/team.html (from rev 69, trunk/web/team.html)

Modified: branches/multiplayer-branch/web/update.sh
===================================================================
--- branches/multiplayer-branch/web/update.sh	2004-09-28 19:44:24 UTC (rev 70)
+++ branches/multiplayer-branch/web/update.sh	2004-09-28 19:53:03 UTC (rev 71)
@@ -1,2 +1,2 @@
 #!/bin/bash
-pscp index.html <A HREF="https://lists.berlios.de/mailman/listinfo/tw-light-svn">yurand at shell.berlios.de</A>:/home/groups/tw-light/htdocs
\ No newline at end of file
+pscp 3dlogo.jpg background.jpg downloads.html index.html info.html links.html team.html style.css <A HREF="https://lists.berlios.de/mailman/listinfo/tw-light-svn">yurand at shell.berlios.de</A>:/home/groups/tw-light/htdocs
\ No newline at end of file


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000018.html">[Tw-light-svn] r70 - trunk/Util
</A></li>
	<LI>Next message: <A HREF="000020.html">[Tw-light-svn] r72 - in trunk: source source/libraries/raknet web
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19">[ date ]</a>
              <a href="thread.html#19">[ thread ]</a>
              <a href="subject.html#19">[ subject ]</a>
              <a href="author.html#19">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/tw-light-svn">More information about the Tw-light-svn
mailing list</a><br>
</body></html>
