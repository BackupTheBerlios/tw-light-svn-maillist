<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Tw-light-svn] r175 - in trunk: . Util/deditor gamedata/default_ini gamedata/games/test_game/dialogs gamedata/games/test_game/scripts gamedata/games/test_game/scripts/systems gamedata/python source/games source/melee source/other source/tml
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/tw-light-svn/2005-August/index.html" >
   <LINK REL="made" HREF="mailto:tw-light-svn%40lists.berlios.de?Subject=Re%3A%20%5BTw-light-svn%5D%20r175%20-%20in%20trunk%3A%20.%20Util/deditor%20gamedata/default_ini%20gamedata/games/test_game/dialogs%20gamedata/games/test_game/scripts%20gamedata/games/test_game/scripts/systems%20gamedata/python%20source/games%20source/melee%20source/other%20source/tml&In-Reply-To=%3C200508061809.j76I9s5v005274%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000120.html">
   <LINK REL="Next"  HREF="000122.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Tw-light-svn] r175 - in trunk: . Util/deditor gamedata/default_ini gamedata/games/test_game/dialogs gamedata/games/test_game/scripts gamedata/games/test_game/scripts/systems gamedata/python source/games source/melee source/other source/tml</H1>
    <B>Yura Semashko at BerliOS</B> 
    <A HREF="mailto:tw-light-svn%40lists.berlios.de?Subject=Re%3A%20%5BTw-light-svn%5D%20r175%20-%20in%20trunk%3A%20.%20Util/deditor%20gamedata/default_ini%20gamedata/games/test_game/dialogs%20gamedata/games/test_game/scripts%20gamedata/games/test_game/scripts/systems%20gamedata/python%20source/games%20source/melee%20source/other%20source/tml&In-Reply-To=%3C200508061809.j76I9s5v005274%40sheep.berlios.de%3E"
       TITLE="[Tw-light-svn] r175 - in trunk: . Util/deditor gamedata/default_ini gamedata/games/test_game/dialogs gamedata/games/test_game/scripts gamedata/games/test_game/scripts/systems gamedata/python source/games source/melee source/other source/tml">yurand at berlios.de
       </A><BR>
    <I>Sat Aug  6 20:09:54 CEST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="000120.html">[Tw-light-svn] r174 - in trunk: . gamedata/default_ini/ships gamedata/images/ships/shpearc3 gamedata/images/ships/shprogsq gamedata/images/ships/shpstaba
</A></li>
        <LI>Next message: <A HREF="000122.html">[Tw-light-svn] r176 - in trunk: gamedata/default_ini source/generated source/melee
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#121">[ date ]</a>
              <a href="thread.html#121">[ thread ]</a>
              <a href="subject.html#121">[ subject ]</a>
              <a href="author.html#121">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: yurand
Date: 2005-08-06 20:09:53 +0200 (Sat, 06 Aug 2005)
New Revision: 175

Added:
   trunk/Util/deditor/SConstruct
   trunk/gamedata/games/test_game/dialogs/chorali_commander.xml
   trunk/gamedata/games/test_game/scripts/flags.py
   trunk/gamedata/python/flags.py
   trunk/gamedata/python/quests.py
   trunk/source/other/gobwarpouttrail.cpp
   trunk/source/other/gobwarpouttrail.h
Removed:
   trunk/Util/deditor/gui.bat
   trunk/Util/deditor/lua/
   trunk/source/melee/GobWarpOutTrail.cpp
   trunk/source/melee/GobWarpOutTrail.h
Modified:
   trunk/SConstruct
   trunk/Util/deditor/application.cpp
   trunk/Util/deditor/dialog.xml
   trunk/Util/deditor/helpers.cpp
   trunk/Util/deditor/maindialog.h
   trunk/Util/deditor/maindialog.ui
   trunk/Util/deditor/mainwidget.cpp
   trunk/Util/deditor/xmlparser.cpp
   trunk/Util/deditor/xmlparser.h
   trunk/gamedata/default_ini/client.ini
   trunk/gamedata/games/test_game/dialogs/druuge.xml
   trunk/gamedata/games/test_game/dialogs/ixis_mining_station_commander.xml
   trunk/gamedata/games/test_game/dialogs/precursor_wrack_first_inspection.xml
   trunk/gamedata/games/test_game/dialogs/shpalabc.xml
   trunk/gamedata/games/test_game/dialogs/shpandgu.xml
   trunk/gamedata/games/test_game/dialogs/shparisk.xml
   trunk/gamedata/games/test_game/dialogs/shpbahbu.xml
   trunk/gamedata/games/test_game/dialogs/shpbipka.xml
   trunk/gamedata/games/test_game/dialogs/shpchmav.xml
   trunk/gamedata/games/test_game/dialogs/test_dialog.xml
   trunk/gamedata/games/test_game/dialogs/transport_please_help.xml
   trunk/gamedata/games/test_game/dialogs/transport_thanks.xml
   trunk/gamedata/games/test_game/dialogs/welcomecommander.xml
   trunk/gamedata/games/test_game/scripts/quests.py
   trunk/gamedata/games/test_game/scripts/start.py
   trunk/gamedata/games/test_game/scripts/systems/gamaonyx.py
   trunk/gamedata/games/test_game/scripts/systems/ixis.py
   trunk/gamedata/games/test_game/scripts/systems/narike.py
   trunk/gamedata/python/dialog.py
   trunk/gamedata/python/tml.py
   trunk/source/games/ggob.cpp
   trunk/source/games/ggob.h
   trunk/source/melee/mship.cpp
   trunk/source/tml/eventmanager.cpp
   trunk/source/tml/eventmanager.h
   trunk/source/tml/gameaction.cpp
   trunk/source/tml/gameaction.h
   trunk/source/tml/gameevent.cpp
   trunk/source/tml/gameevent.h
   trunk/sources.lst
Log:
Dialog editor updated to use QT 3
You can call python code in alien/player answers using {}
fixed issue #0000048  Pressing 'J' in Adventure mode without a system selected causes crash


Modified: trunk/SConstruct
===================================================================
--- trunk/SConstruct	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/SConstruct	2005-08-06 18:09:53 UTC (rev 175)
@@ -56,6 +56,7 @@
   source/other/configrw.cpp
   source/other/dialogs.cpp
   source/other/fontmorph.cpp
+  source/other/gobwarpouttrail.cpp 
   source/other/gup.cpp
   source/other/nullphas.cpp
   source/other/objanim.cpp

Added: trunk/Util/deditor/SConstruct
===================================================================
--- trunk/Util/deditor/SConstruct	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/Util/deditor/SConstruct	2005-08-06 18:09:53 UTC (rev 175)
@@ -0,0 +1,18 @@
+import os
+env = Environment(tools=['default','qt','mingw'])
+if str(Platform()) == &quot;win32&quot;:
+    env.Append(CPPDEFINES=['WIN32'])
+    if env[&quot;CC&quot;] == &quot;cl&quot;:
+        env.AppendENVPath('PATH', os.environ['PATH'])
+        env.Append(LIBPATH=[&quot;#lua&quot;])
+
+#env.Append(LIBS= ['lua','lualib'])
+env.Program('dedit', ['maindialog.ui',
+                      'application.cpp', 
+                      'helpers.cpp',
+                      'main.cpp',
+                      'mainwidget.cpp',
+                      'node.cpp',
+                      'xmlparser.cpp']
+              )
+

Modified: trunk/Util/deditor/application.cpp
===================================================================
--- trunk/Util/deditor/application.cpp	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/Util/deditor/application.cpp	2005-08-06 18:09:53 UTC (rev 175)
@@ -309,7 +309,7 @@
     evalanswerIcon = QPixmap( evalanswer_xpm );
 
 	QPopupMenu * test = new QPopupMenu( this );
-    menuBar()-&gt;insertItem( &quot;&amp;Test&quot;, test );
+    menuBar()-&gt;insertItem( &quot;Test&quot;, test );
 
     id = test-&gt;insertItem( evalanswerIcon, &quot;Evaluate answer&quot;,
 			   this, SLOT(evaluateAnswerSlot()), CTRL+Key_R );

Modified: trunk/Util/deditor/dialog.xml
===================================================================
--- trunk/Util/deditor/dialog.xml	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/Util/deditor/dialog.xml	2005-08-06 18:09:53 UTC (rev 175)
@@ -1,2 +1,3 @@
-&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;Start&quot; music=&quot;&quot; background=&quot;a.png&quot; alien_text=&quot;TW-Light Dialog Editor. 
-   &lt;br&gt; Test dialog&quot; font=&quot;&quot; text_location=&quot;&quot;&gt;&lt;PLAYER_ANSWER text=&quot;We come in peace&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(&quot;2&quot;)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Die supid alien!&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(&quot;1&quot;)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;1&quot; name=&quot;Batte&quot; music=&quot;&quot; background=&quot;&quot; alien_text=&quot;You have bad manners, die&quot; font=&quot;&quot; text_location=&quot;&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Ok!!&quot; appear_condition=&quot;1&quot;&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;2&quot; name=&quot;Bye&quot; music=&quot;&quot; background=&quot;a.png&quot; alien_text=&quot;Have to go, sorry&quot; font=&quot;&quot; text_location=&quot;&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Bye&quot; appear_condition=&quot;1&quot;&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;
\ No newline at end of file
+&lt;DIALOG&gt;&lt;START_DIALOG&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;def abc():
+  print &quot;abc&quot;&quot;&gt;&lt;/ACTION&gt;&lt;/START_DIALOG&gt;&lt;END_DIALOG&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;&quot;&gt;&lt;/ACTION&gt;&lt;/END_DIALOG&gt;&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;Start&quot; music=&quot;&quot; background=&quot;a.png&quot; alien_text=&quot;TW-Light Dialog Editor. 
+   &lt;br&gt; Test dialog&quot; font=&quot;&quot; text_location=&quot;&quot;&gt;&lt;PLAYER_ANSWER text=&quot;We come in peace&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(&quot;2&quot;)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Die supid alien!&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(&quot;1&quot;)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;1&quot; name=&quot;Batte&quot; music=&quot;&quot; background=&quot;&quot; alien_text=&quot;You have bad manners, die&quot; font=&quot;&quot; text_location=&quot;&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Ok!!&quot; appear_condition=&quot;1&quot;&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;2&quot; name=&quot;Bye&quot; music=&quot;&quot; background=&quot;a.png&quot; alien_text=&quot;Have to go, sorry&quot; font=&quot;&quot; text_location=&quot;&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Bye&quot; appear_condition=&quot;1&quot;&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;&lt;/DIALOG&gt;
\ No newline at end of file

Deleted: trunk/Util/deditor/gui.bat
===================================================================
--- trunk/Util/deditor/gui.bat	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/Util/deditor/gui.bat	2005-08-06 18:09:53 UTC (rev 175)
@@ -1,5 +0,0 @@
-uic -o maindialog.h MainDialog.ui
-uic -i maindialog.h -o maindialog.cpp MainDialog.ui
-moc -o moc_maindialog.cpp maindialog.h
-moc -o moc_application.cpp application.h
-moc -o moc_node.cpp node.h

Modified: trunk/Util/deditor/helpers.cpp
===================================================================
--- trunk/Util/deditor/helpers.cpp	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/Util/deditor/helpers.cpp	2005-08-06 18:09:53 UTC (rev 175)
@@ -28,6 +28,6 @@
 	str.replace(QRegExp(&quot;&gt;&quot;),&quot;&gt;&quot;);
 	str.replace(QRegExp(&quot;&lt;&quot;),&quot;&lt;&quot;);
 	str.replace(QRegExp(&quot;\&quot;&quot;),&quot;&quot;&quot;);
-
+	str.replace(QRegExp(&quot;\n&quot;),&quot;&#10;&quot;);
 	return str;
 }

Modified: trunk/Util/deditor/maindialog.h
===================================================================
--- trunk/Util/deditor/maindialog.h	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/Util/deditor/maindialog.h	2005-08-06 18:09:53 UTC (rev 175)
@@ -1,8 +1,8 @@
 /****************************************************************************
 ** Form interface generated from reading ui file 'maindialog.ui'
 **
-** Created: Sat May 14 10:31:25 2005
-**      by: The User Interface Compiler ($Id: qt/main.cpp   3.3.3   edited Nov 24 2003 $)
+** Created: &#1057;&#1073; 6. &#1072;&#1074;&#1075; 20:29:10 2005
+**      by: The User Interface Compiler ()
 **
 ** WARNING! All changes made in this file will be lost!
 ****************************************************************************/
@@ -21,11 +21,10 @@
 class QTextBrowser;
 class QLabel;
 class QMultiLineEdit;
-class QCheckBox;
 class QTabWidget;
 class QLineEdit;
 class QGroupBox;
-class QTable;
+class QTextEdit;
 class QListView;
 class QListViewItem;
 
@@ -37,13 +36,12 @@
     DialogEditorGenerated( QWidget* parent = 0, const char* name = 0, WFlags fl = 0 );
     ~DialogEditorGenerated();
 
-    QSplitter* splitter3;
-    QSplitter* splitter2;
-    QSplitter* splitter1;
+    QSplitter* splitter7;
+    QSplitter* splitter6;
     QTextBrowser* alienTextBrowser;
     QLabel* TextLabel4;
     QMultiLineEdit* commonMultiLineEdit;
-    QCheckBox* TestModeCheckBox;
+    QSplitter* splitter5;
     QTabWidget* TabWidget2;
     QWidget* tab;
     QLineEdit* textLocationLineEdit;
@@ -82,25 +80,26 @@
     QLineEdit* condition5LineEdit;
     QLabel* TextLabel11;
     QLineEdit* action5LineEdit;
-    QLabel* TextLabel3;
-    QLabel* TextLabel12;
-    QLabel* TextLabel13;
-    QTable* triggerTable;
+    QWidget* TabPage;
+    QSplitter* splitter14;
+    QLabel* textLabel1;
+    QTextEdit* startDialogCode_textEdit;
+    QLabel* textLabel1_2;
+    QTextEdit* endDialogCode_textEdit;
     QListView* nodeListView;
     QListView* answersListView;
 
 public slots:
-    virtual void answerChangedSlot(QListViewItem*);
-    virtual void answerPositionChanged(int);
-    virtual void nodeChangedSlot(QListViewItem* );
-    virtual void processAnswerSlot(QListViewItem*);
+    virtual void answerChangedSlot( QListViewItem * );
+    virtual void answerPositionChanged( int );
+    virtual void nodeChangedSlot( QListViewItem * );
+    virtual void processAnswerSlot( QListViewItem * );
     virtual void saveAnswer();
     virtual void saveNodeInfo();
 
 protected:
     QGridLayout* DialogEditorGeneratedLayout;
-    QVBoxLayout* Layout20;
-    QVBoxLayout* Layout14;
+    QVBoxLayout* layout14;
     QGridLayout* tabLayout;
     QGridLayout* Layout15;
     QSpacerItem* Spacer1;
@@ -114,8 +113,9 @@
     QHBoxLayout* Layout7;
     QHBoxLayout* Layout8;
     QHBoxLayout* Layout9;
-    QVBoxLayout* Layout19;
-    QHBoxLayout* Layout18;
+    QGridLayout* TabPageLayout;
+    QVBoxLayout* layout36;
+    QVBoxLayout* layout35;
 
 protected slots:
     virtual void languageChange();

Modified: trunk/Util/deditor/maindialog.ui
===================================================================
--- trunk/Util/deditor/maindialog.ui	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/Util/deditor/maindialog.ui	2005-08-06 18:09:53 UTC (rev 175)
@@ -27,790 +27,778 @@
         &lt;/property&gt;
         &lt;widget class=&quot;QSplitter&quot; row=&quot;0&quot; column=&quot;0&quot;&gt;
             &lt;property name=&quot;name&quot;&gt;
-                &lt;cstring&gt;splitter3&lt;/cstring&gt;
+                &lt;cstring&gt;splitter7&lt;/cstring&gt;
             &lt;/property&gt;
+            &lt;property name=&quot;maximumSize&quot;&gt;
+                &lt;size&gt;
+                    &lt;width&gt;32767&lt;/width&gt;
+                    &lt;height&gt;32767&lt;/height&gt;
+                &lt;/size&gt;
+            &lt;/property&gt;
             &lt;property name=&quot;orientation&quot;&gt;
                 &lt;enum&gt;Vertical&lt;/enum&gt;
             &lt;/property&gt;
+            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                &lt;string&gt;First column - trigger name, second - value&lt;/string&gt;
+            &lt;/property&gt;
             &lt;widget class=&quot;QSplitter&quot;&gt;
                 &lt;property name=&quot;name&quot;&gt;
-                    &lt;cstring&gt;splitter2&lt;/cstring&gt;
+                    &lt;cstring&gt;splitter6&lt;/cstring&gt;
                 &lt;/property&gt;
                 &lt;property name=&quot;orientation&quot;&gt;
                     &lt;enum&gt;Horizontal&lt;/enum&gt;
                 &lt;/property&gt;
-                &lt;widget class=&quot;QSplitter&quot;&gt;
+                &lt;widget class=&quot;QTextBrowser&quot;&gt;
                     &lt;property name=&quot;name&quot;&gt;
-                        &lt;cstring&gt;splitter1&lt;/cstring&gt;
+                        &lt;cstring&gt;alienTextBrowser&lt;/cstring&gt;
                     &lt;/property&gt;
-                    &lt;property name=&quot;orientation&quot;&gt;
-                        &lt;enum&gt;Horizontal&lt;/enum&gt;
+                    &lt;property name=&quot;sizePolicy&quot;&gt;
+                        &lt;sizepolicy&gt;
+                            &lt;hsizetype&gt;7&lt;/hsizetype&gt;
+                            &lt;vsizetype&gt;7&lt;/vsizetype&gt;
+                            &lt;horstretch&gt;0&lt;/horstretch&gt;
+                            &lt;verstretch&gt;0&lt;/verstretch&gt;
+                        &lt;/sizepolicy&gt;
                     &lt;/property&gt;
-                    &lt;widget class=&quot;QLayoutWidget&quot;&gt;
+                    &lt;property name=&quot;minimumSize&quot;&gt;
+                        &lt;size&gt;
+                            &lt;width&gt;200&lt;/width&gt;
+                            &lt;height&gt;150&lt;/height&gt;
+                        &lt;/size&gt;
+                    &lt;/property&gt;
+                    &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                        &lt;string&gt;Alian picture, and text here&lt;/string&gt;
+                    &lt;/property&gt;
+                &lt;/widget&gt;
+                &lt;widget class=&quot;QLayoutWidget&quot;&gt;
+                    &lt;property name=&quot;name&quot;&gt;
+                        &lt;cstring&gt;layout14&lt;/cstring&gt;
+                    &lt;/property&gt;
+                    &lt;vbox&gt;
                         &lt;property name=&quot;name&quot;&gt;
-                            &lt;cstring&gt;Layout20&lt;/cstring&gt;
+                            &lt;cstring&gt;unnamed&lt;/cstring&gt;
                         &lt;/property&gt;
-                        &lt;vbox&gt;
+                        &lt;widget class=&quot;QLabel&quot;&gt;
                             &lt;property name=&quot;name&quot;&gt;
+                                &lt;cstring&gt;TextLabel4&lt;/cstring&gt;
+                            &lt;/property&gt;
+                            &lt;property name=&quot;text&quot;&gt;
+                                &lt;string&gt;Place text here:&lt;/string&gt;
+                            &lt;/property&gt;
+                        &lt;/widget&gt;
+                        &lt;widget class=&quot;QMultiLineEdit&quot;&gt;
+                            &lt;property name=&quot;name&quot;&gt;
+                                &lt;cstring&gt;commonMultiLineEdit&lt;/cstring&gt;
+                            &lt;/property&gt;
+                            &lt;property name=&quot;minimumSize&quot;&gt;
+                                &lt;size&gt;
+                                    &lt;width&gt;0&lt;/width&gt;
+                                    &lt;height&gt;90&lt;/height&gt;
+                                &lt;/size&gt;
+                            &lt;/property&gt;
+                            &lt;property name=&quot;textFormat&quot;&gt;
+                                &lt;enum&gt;AutoText&lt;/enum&gt;
+                            &lt;/property&gt;
+                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                &lt;string&gt;Text in this edit can be set aso player or alian answer.&lt;/string&gt;
+                            &lt;/property&gt;
+                        &lt;/widget&gt;
+                    &lt;/vbox&gt;
+                &lt;/widget&gt;
+            &lt;/widget&gt;
+            &lt;widget class=&quot;QSplitter&quot;&gt;
+                &lt;property name=&quot;name&quot;&gt;
+                    &lt;cstring&gt;splitter5&lt;/cstring&gt;
+                &lt;/property&gt;
+                &lt;property name=&quot;orientation&quot;&gt;
+                    &lt;enum&gt;Horizontal&lt;/enum&gt;
+                &lt;/property&gt;
+                &lt;widget class=&quot;QTabWidget&quot;&gt;
+                    &lt;property name=&quot;name&quot;&gt;
+                        &lt;cstring&gt;TabWidget2&lt;/cstring&gt;
+                    &lt;/property&gt;
+                    &lt;property name=&quot;sizePolicy&quot;&gt;
+                        &lt;sizepolicy&gt;
+                            &lt;hsizetype&gt;4&lt;/hsizetype&gt;
+                            &lt;vsizetype&gt;4&lt;/vsizetype&gt;
+                            &lt;horstretch&gt;0&lt;/horstretch&gt;
+                            &lt;verstretch&gt;0&lt;/verstretch&gt;
+                        &lt;/sizepolicy&gt;
+                    &lt;/property&gt;
+                    &lt;property name=&quot;minimumSize&quot;&gt;
+                        &lt;size&gt;
+                            &lt;width&gt;200&lt;/width&gt;
+                            &lt;height&gt;250&lt;/height&gt;
+                        &lt;/size&gt;
+                    &lt;/property&gt;
+                    &lt;property name=&quot;margin&quot;&gt;
+                        &lt;number&gt;0&lt;/number&gt;
+                    &lt;/property&gt;
+                    &lt;widget class=&quot;QWidget&quot;&gt;
+                        &lt;property name=&quot;name&quot;&gt;
+                            &lt;cstring&gt;tab&lt;/cstring&gt;
+                        &lt;/property&gt;
+                        &lt;attribute name=&quot;title&quot;&gt;
+                            &lt;string&gt;Node&lt;/string&gt;
+                        &lt;/attribute&gt;
+                        &lt;grid&gt;
+                            &lt;property name=&quot;name&quot;&gt;
                                 &lt;cstring&gt;unnamed&lt;/cstring&gt;
                             &lt;/property&gt;
                             &lt;property name=&quot;margin&quot;&gt;
-                                &lt;number&gt;0&lt;/number&gt;
+                                &lt;number&gt;11&lt;/number&gt;
                             &lt;/property&gt;
                             &lt;property name=&quot;spacing&quot;&gt;
                                 &lt;number&gt;6&lt;/number&gt;
                             &lt;/property&gt;
-                            &lt;widget class=&quot;QTextBrowser&quot;&gt;
+                            &lt;widget class=&quot;QLayoutWidget&quot; row=&quot;0&quot; column=&quot;0&quot;&gt;
                                 &lt;property name=&quot;name&quot;&gt;
-                                    &lt;cstring&gt;alienTextBrowser&lt;/cstring&gt;
+                                    &lt;cstring&gt;Layout15&lt;/cstring&gt;
                                 &lt;/property&gt;
-                                &lt;property name=&quot;sizePolicy&quot;&gt;
-                                    &lt;sizepolicy&gt;
-                                        &lt;hsizetype&gt;7&lt;/hsizetype&gt;
-                                        &lt;vsizetype&gt;7&lt;/vsizetype&gt;
-                                        &lt;horstretch&gt;0&lt;/horstretch&gt;
-                                        &lt;verstretch&gt;0&lt;/verstretch&gt;
-                                    &lt;/sizepolicy&gt;
-                                &lt;/property&gt;
-                                &lt;property name=&quot;minimumSize&quot;&gt;
-                                    &lt;size&gt;
-                                        &lt;width&gt;200&lt;/width&gt;
-                                        &lt;height&gt;200&lt;/height&gt;
-                                    &lt;/size&gt;
-                                &lt;/property&gt;
-                                &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
-                                    &lt;string&gt;Alian picture, and text here&lt;/string&gt;
-                                &lt;/property&gt;
+                                &lt;grid&gt;
+                                    &lt;property name=&quot;name&quot;&gt;
+                                        &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                                    &lt;/property&gt;
+                                    &lt;property name=&quot;margin&quot;&gt;
+                                        &lt;number&gt;0&lt;/number&gt;
+                                    &lt;/property&gt;
+                                    &lt;property name=&quot;spacing&quot;&gt;
+                                        &lt;number&gt;6&lt;/number&gt;
+                                    &lt;/property&gt;
+                                    &lt;widget class=&quot;QLineEdit&quot; row=&quot;5&quot; column=&quot;1&quot; rowspan=&quot;1&quot; colspan=&quot;2&quot;&gt;
+                                        &lt;property name=&quot;name&quot;&gt;
+                                            &lt;cstring&gt;textLocationLineEdit&lt;/cstring&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;alignment&quot;&gt;
+                                            &lt;set&gt;AlignLeft&lt;/set&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;hAlign&quot; stdset=&quot;0&quot;&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                            &lt;string&gt;Alien text location&lt;/string&gt;
+                                        &lt;/property&gt;
+                                    &lt;/widget&gt;
+                                    &lt;widget class=&quot;QLineEdit&quot; row=&quot;1&quot; column=&quot;1&quot; rowspan=&quot;1&quot; colspan=&quot;2&quot;&gt;
+                                        &lt;property name=&quot;name&quot;&gt;
+                                            &lt;cstring&gt;NodeNameLineEdit&lt;/cstring&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;alignment&quot;&gt;
+                                            &lt;set&gt;AlignLeft&lt;/set&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;hAlign&quot; stdset=&quot;0&quot;&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                            &lt;string&gt;Name is not used&lt;/string&gt;
+                                        &lt;/property&gt;
+                                    &lt;/widget&gt;
+                                    &lt;widget class=&quot;QLabel&quot; row=&quot;4&quot; column=&quot;0&quot;&gt;
+                                        &lt;property name=&quot;name&quot;&gt;
+                                            &lt;cstring&gt;TextLabel1_3&lt;/cstring&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;text&quot;&gt;
+                                            &lt;string&gt;Font:&lt;/string&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                            &lt;string&gt;Alien text font&lt;/string&gt;
+                                        &lt;/property&gt;
+                                    &lt;/widget&gt;
+                                    &lt;widget class=&quot;QLineEdit&quot; row=&quot;4&quot; column=&quot;1&quot; rowspan=&quot;1&quot; colspan=&quot;2&quot;&gt;
+                                        &lt;property name=&quot;name&quot;&gt;
+                                            &lt;cstring&gt;fontLineEdit&lt;/cstring&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;alignment&quot;&gt;
+                                            &lt;set&gt;AlignLeft&lt;/set&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;hAlign&quot; stdset=&quot;0&quot;&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                            &lt;string&gt;Alien text font&lt;/string&gt;
+                                        &lt;/property&gt;
+                                    &lt;/widget&gt;
+                                    &lt;widget class=&quot;QLabel&quot; row=&quot;2&quot; column=&quot;0&quot;&gt;
+                                        &lt;property name=&quot;name&quot;&gt;
+                                            &lt;cstring&gt;TextLabel3_2&lt;/cstring&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;text&quot;&gt;
+                                            &lt;string&gt;Music&lt;/string&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                            &lt;string&gt;Path to music file&lt;/string&gt;
+                                        &lt;/property&gt;
+                                    &lt;/widget&gt;
+                                    &lt;widget class=&quot;QLabel&quot; row=&quot;0&quot; column=&quot;0&quot;&gt;
+                                        &lt;property name=&quot;name&quot;&gt;
+                                            &lt;cstring&gt;TextLabel1&lt;/cstring&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;text&quot;&gt;
+                                            &lt;string&gt;Node ID&lt;/string&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                            &lt;string&gt;unique identifier for node&lt;/string&gt;
+                                        &lt;/property&gt;
+                                    &lt;/widget&gt;
+                                    &lt;widget class=&quot;QLabel&quot; row=&quot;5&quot; column=&quot;0&quot;&gt;
+                                        &lt;property name=&quot;name&quot;&gt;
+                                            &lt;cstring&gt;TextLabel2_3&lt;/cstring&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;text&quot;&gt;
+                                            &lt;string&gt;Text location:&lt;/string&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                            &lt;string&gt;Alien text location&lt;/string&gt;
+                                        &lt;/property&gt;
+                                    &lt;/widget&gt;
+                                    &lt;widget class=&quot;QLabel&quot; row=&quot;3&quot; column=&quot;0&quot;&gt;
+                                        &lt;property name=&quot;name&quot;&gt;
+                                            &lt;cstring&gt;TextLabel4_2&lt;/cstring&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;text&quot;&gt;
+                                            &lt;string&gt;Background&lt;/string&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                            &lt;string&gt;Path to background picture&lt;/string&gt;
+                                        &lt;/property&gt;
+                                    &lt;/widget&gt;
+                                    &lt;spacer row=&quot;0&quot; column=&quot;1&quot;&gt;
+                                        &lt;property name=&quot;name&quot;&gt;
+                                            &lt;cstring&gt;Spacer1&lt;/cstring&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;orientation&quot;&gt;
+                                            &lt;enum&gt;Horizontal&lt;/enum&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;sizeType&quot;&gt;
+                                            &lt;enum&gt;Expanding&lt;/enum&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;sizeHint&quot;&gt;
+                                            &lt;size&gt;
+                                                &lt;width&gt;20&lt;/width&gt;
+                                                &lt;height&gt;20&lt;/height&gt;
+                                            &lt;/size&gt;
+                                        &lt;/property&gt;
+                                    &lt;/spacer&gt;
+                                    &lt;widget class=&quot;QLineEdit&quot; row=&quot;2&quot; column=&quot;1&quot; rowspan=&quot;1&quot; colspan=&quot;2&quot;&gt;
+                                        &lt;property name=&quot;name&quot;&gt;
+                                            &lt;cstring&gt;MusicEdit&lt;/cstring&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;alignment&quot;&gt;
+                                            &lt;set&gt;AlignLeft&lt;/set&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;hAlign&quot; stdset=&quot;0&quot;&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                            &lt;string&gt;Path to music file&lt;/string&gt;
+                                        &lt;/property&gt;
+                                    &lt;/widget&gt;
+                                    &lt;widget class=&quot;QLineEdit&quot; row=&quot;3&quot; column=&quot;1&quot; rowspan=&quot;1&quot; colspan=&quot;2&quot;&gt;
+                                        &lt;property name=&quot;name&quot;&gt;
+                                            &lt;cstring&gt;BackgroundLineEdit&lt;/cstring&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;alignment&quot;&gt;
+                                            &lt;set&gt;AlignLeft&lt;/set&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;hAlign&quot; stdset=&quot;0&quot;&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                            &lt;string&gt;Path to background picture&lt;/string&gt;
+                                        &lt;/property&gt;
+                                    &lt;/widget&gt;
+                                    &lt;widget class=&quot;QLabel&quot; row=&quot;1&quot; column=&quot;0&quot;&gt;
+                                        &lt;property name=&quot;name&quot;&gt;
+                                            &lt;cstring&gt;TextLabel2&lt;/cstring&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;text&quot;&gt;
+                                            &lt;string&gt;Node Name&lt;/string&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                            &lt;string&gt;Name is not used&lt;/string&gt;
+                                        &lt;/property&gt;
+                                    &lt;/widget&gt;
+                                    &lt;widget class=&quot;QLineEdit&quot; row=&quot;0&quot; column=&quot;2&quot;&gt;
+                                        &lt;property name=&quot;name&quot;&gt;
+                                            &lt;cstring&gt;nodeIdLineEdit&lt;/cstring&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;alignment&quot;&gt;
+                                            &lt;set&gt;AlignRight&lt;/set&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;hAlign&quot; stdset=&quot;0&quot;&gt;
+                                        &lt;/property&gt;
+                                        &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                            &lt;string&gt;unique identifier for node&lt;/string&gt;
+                                        &lt;/property&gt;
+                                    &lt;/widget&gt;
+                                &lt;/grid&gt;
                             &lt;/widget&gt;
-                            &lt;widget class=&quot;QLabel&quot;&gt;
-                                &lt;property name=&quot;name&quot;&gt;
-                                    &lt;cstring&gt;TextLabel4&lt;/cstring&gt;
-                                &lt;/property&gt;
-                                &lt;property name=&quot;text&quot;&gt;
-                                    &lt;string&gt;Place text here:&lt;/string&gt;
-                                &lt;/property&gt;
-                            &lt;/widget&gt;
-                            &lt;widget class=&quot;QMultiLineEdit&quot;&gt;
-                                &lt;property name=&quot;name&quot;&gt;
-                                    &lt;cstring&gt;commonMultiLineEdit&lt;/cstring&gt;
-                                &lt;/property&gt;
-                                &lt;property name=&quot;minimumSize&quot;&gt;
-                                    &lt;size&gt;
-                                        &lt;width&gt;0&lt;/width&gt;
-                                        &lt;height&gt;90&lt;/height&gt;
-                                    &lt;/size&gt;
-                                &lt;/property&gt;
-                                &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
-                                    &lt;string&gt;Text in this edit can be set aso player or alian answer.&lt;/string&gt;
-                                &lt;/property&gt;
-                            &lt;/widget&gt;
-                        &lt;/vbox&gt;
+                        &lt;/grid&gt;
                     &lt;/widget&gt;
-                    &lt;widget class=&quot;QLayoutWidget&quot;&gt;
+                    &lt;widget class=&quot;QWidget&quot;&gt;
                         &lt;property name=&quot;name&quot;&gt;
-                            &lt;cstring&gt;Layout14&lt;/cstring&gt;
+                            &lt;cstring&gt;tab&lt;/cstring&gt;
                         &lt;/property&gt;
+                        &lt;attribute name=&quot;title&quot;&gt;
+                            &lt;string&gt;Answer&lt;/string&gt;
+                        &lt;/attribute&gt;
                         &lt;vbox&gt;
                             &lt;property name=&quot;name&quot;&gt;
                                 &lt;cstring&gt;unnamed&lt;/cstring&gt;
                             &lt;/property&gt;
                             &lt;property name=&quot;margin&quot;&gt;
-                                &lt;number&gt;0&lt;/number&gt;
+                                &lt;number&gt;11&lt;/number&gt;
                             &lt;/property&gt;
                             &lt;property name=&quot;spacing&quot;&gt;
                                 &lt;number&gt;6&lt;/number&gt;
                             &lt;/property&gt;
-                            &lt;widget class=&quot;QCheckBox&quot;&gt;
+                            &lt;widget class=&quot;QLayoutWidget&quot;&gt;
                                 &lt;property name=&quot;name&quot;&gt;
-                                    &lt;cstring&gt;TestModeCheckBox&lt;/cstring&gt;
+                                    &lt;cstring&gt;Layout12&lt;/cstring&gt;
                                 &lt;/property&gt;
-                                &lt;property name=&quot;text&quot;&gt;
-                                    &lt;string&gt;Test Mode (Hide not allowed answers)&lt;/string&gt;
-                                &lt;/property&gt;
-                            &lt;/widget&gt;
-                            &lt;widget class=&quot;QTabWidget&quot;&gt;
-                                &lt;property name=&quot;name&quot;&gt;
-                                    &lt;cstring&gt;TabWidget2&lt;/cstring&gt;
-                                &lt;/property&gt;
-                                &lt;property name=&quot;sizePolicy&quot;&gt;
-                                    &lt;sizepolicy&gt;
-                                        &lt;hsizetype&gt;4&lt;/hsizetype&gt;
-                                        &lt;vsizetype&gt;4&lt;/vsizetype&gt;
-                                        &lt;horstretch&gt;0&lt;/horstretch&gt;
-                                        &lt;verstretch&gt;0&lt;/verstretch&gt;
-                                    &lt;/sizepolicy&gt;
-                                &lt;/property&gt;
-                                &lt;property name=&quot;minimumSize&quot;&gt;
-                                    &lt;size&gt;
-                                        &lt;width&gt;200&lt;/width&gt;
-                                        &lt;height&gt;250&lt;/height&gt;
-                                    &lt;/size&gt;
-                                &lt;/property&gt;
-                                &lt;property name=&quot;margin&quot;&gt;
-                                    &lt;number&gt;0&lt;/number&gt;
-                                &lt;/property&gt;
-                                &lt;widget class=&quot;QWidget&quot;&gt;
+                                &lt;vbox&gt;
                                     &lt;property name=&quot;name&quot;&gt;
-                                        &lt;cstring&gt;tab&lt;/cstring&gt;
+                                        &lt;cstring&gt;unnamed&lt;/cstring&gt;
                                     &lt;/property&gt;
-                                    &lt;attribute name=&quot;title&quot;&gt;
-                                        &lt;string&gt;Node&lt;/string&gt;
-                                    &lt;/attribute&gt;
-                                    &lt;grid&gt;
+                                    &lt;property name=&quot;margin&quot;&gt;
+                                        &lt;number&gt;0&lt;/number&gt;
+                                    &lt;/property&gt;
+                                    &lt;property name=&quot;spacing&quot;&gt;
+                                        &lt;number&gt;6&lt;/number&gt;
+                                    &lt;/property&gt;
+                                    &lt;widget class=&quot;QLayoutWidget&quot;&gt;
                                         &lt;property name=&quot;name&quot;&gt;
-                                            &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                                            &lt;cstring&gt;Layout11&lt;/cstring&gt;
                                         &lt;/property&gt;
-                                        &lt;property name=&quot;margin&quot;&gt;
-                                            &lt;number&gt;11&lt;/number&gt;
-                                        &lt;/property&gt;
-                                        &lt;property name=&quot;spacing&quot;&gt;
-                                            &lt;number&gt;6&lt;/number&gt;
-                                        &lt;/property&gt;
-                                        &lt;widget class=&quot;QLayoutWidget&quot; row=&quot;0&quot; column=&quot;0&quot;&gt;
+                                        &lt;hbox&gt;
                                             &lt;property name=&quot;name&quot;&gt;
-                                                &lt;cstring&gt;Layout15&lt;/cstring&gt;
+                                                &lt;cstring&gt;unnamed&lt;/cstring&gt;
                                             &lt;/property&gt;
-                                            &lt;grid&gt;
+                                            &lt;property name=&quot;margin&quot;&gt;
+                                                &lt;number&gt;0&lt;/number&gt;
+                                            &lt;/property&gt;
+                                            &lt;property name=&quot;spacing&quot;&gt;
+                                                &lt;number&gt;6&lt;/number&gt;
+                                            &lt;/property&gt;
+                                            &lt;widget class=&quot;QLabel&quot;&gt;
                                                 &lt;property name=&quot;name&quot;&gt;
-                                                    &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                                                    &lt;cstring&gt;TextLabel1_2&lt;/cstring&gt;
                                                 &lt;/property&gt;
-                                                &lt;property name=&quot;margin&quot;&gt;
-                                                    &lt;number&gt;0&lt;/number&gt;
+                                                &lt;property name=&quot;text&quot;&gt;
+                                                    &lt;string&gt;Appear condition:&lt;/string&gt;
                                                 &lt;/property&gt;
-                                                &lt;property name=&quot;spacing&quot;&gt;
-                                                    &lt;number&gt;6&lt;/number&gt;
+                                            &lt;/widget&gt;
+                                            &lt;widget class=&quot;QLineEdit&quot;&gt;
+                                                &lt;property name=&quot;name&quot;&gt;
+                                                    &lt;cstring&gt;appearConditionLineEdit&lt;/cstring&gt;
                                                 &lt;/property&gt;
-                                                &lt;widget class=&quot;QLineEdit&quot; row=&quot;5&quot; column=&quot;1&quot; rowspan=&quot;1&quot; colspan=&quot;2&quot;&gt;
-                                                    &lt;property name=&quot;name&quot;&gt;
-                                                        &lt;cstring&gt;textLocationLineEdit&lt;/cstring&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;alignment&quot;&gt;
-                                                        &lt;set&gt;AlignLeft&lt;/set&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;hAlign&quot; stdset=&quot;0&quot;&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
-                                                        &lt;string&gt;Alien text location&lt;/string&gt;
-                                                    &lt;/property&gt;
-                                                &lt;/widget&gt;
-                                                &lt;widget class=&quot;QLineEdit&quot; row=&quot;1&quot; column=&quot;1&quot; rowspan=&quot;1&quot; colspan=&quot;2&quot;&gt;
-                                                    &lt;property name=&quot;name&quot;&gt;
-                                                        &lt;cstring&gt;NodeNameLineEdit&lt;/cstring&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;alignment&quot;&gt;
-                                                        &lt;set&gt;AlignLeft&lt;/set&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;hAlign&quot; stdset=&quot;0&quot;&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
-                                                        &lt;string&gt;Name is not used&lt;/string&gt;
-                                                    &lt;/property&gt;
-                                                &lt;/widget&gt;
-                                                &lt;widget class=&quot;QLabel&quot; row=&quot;4&quot; column=&quot;0&quot;&gt;
-                                                    &lt;property name=&quot;name&quot;&gt;
-                                                        &lt;cstring&gt;TextLabel1_3&lt;/cstring&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;text&quot;&gt;
-                                                        &lt;string&gt;Font:&lt;/string&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
-                                                        &lt;string&gt;Alien text font&lt;/string&gt;
-                                                    &lt;/property&gt;
-                                                &lt;/widget&gt;
-                                                &lt;widget class=&quot;QLineEdit&quot; row=&quot;4&quot; column=&quot;1&quot; rowspan=&quot;1&quot; colspan=&quot;2&quot;&gt;
-                                                    &lt;property name=&quot;name&quot;&gt;
-                                                        &lt;cstring&gt;fontLineEdit&lt;/cstring&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;alignment&quot;&gt;
-                                                        &lt;set&gt;AlignLeft&lt;/set&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;hAlign&quot; stdset=&quot;0&quot;&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
-                                                        &lt;string&gt;Alien text font&lt;/string&gt;
-                                                    &lt;/property&gt;
-                                                &lt;/widget&gt;
-                                                &lt;widget class=&quot;QLabel&quot; row=&quot;2&quot; column=&quot;0&quot;&gt;
-                                                    &lt;property name=&quot;name&quot;&gt;
-                                                        &lt;cstring&gt;TextLabel3_2&lt;/cstring&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;text&quot;&gt;
-                                                        &lt;string&gt;Music&lt;/string&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
-                                                        &lt;string&gt;Path to music file&lt;/string&gt;
-                                                    &lt;/property&gt;
-                                                &lt;/widget&gt;
-                                                &lt;widget class=&quot;QLabel&quot; row=&quot;0&quot; column=&quot;0&quot;&gt;
-                                                    &lt;property name=&quot;name&quot;&gt;
-                                                        &lt;cstring&gt;TextLabel1&lt;/cstring&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;text&quot;&gt;
-                                                        &lt;string&gt;Node ID&lt;/string&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
-                                                        &lt;string&gt;unique identifier for node&lt;/string&gt;
-                                                    &lt;/property&gt;
-                                                &lt;/widget&gt;
-                                                &lt;widget class=&quot;QLabel&quot; row=&quot;5&quot; column=&quot;0&quot;&gt;
-                                                    &lt;property name=&quot;name&quot;&gt;
-                                                        &lt;cstring&gt;TextLabel2_3&lt;/cstring&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;text&quot;&gt;
-                                                        &lt;string&gt;Text location:&lt;/string&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
-                                                        &lt;string&gt;Alien text location&lt;/string&gt;
-                                                    &lt;/property&gt;
-                                                &lt;/widget&gt;
-                                                &lt;widget class=&quot;QLabel&quot; row=&quot;3&quot; column=&quot;0&quot;&gt;
-                                                    &lt;property name=&quot;name&quot;&gt;
-                                                        &lt;cstring&gt;TextLabel4_2&lt;/cstring&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;text&quot;&gt;
-                                                        &lt;string&gt;Background&lt;/string&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
-                                                        &lt;string&gt;Path to background picture&lt;/string&gt;
-                                                    &lt;/property&gt;
-                                                &lt;/widget&gt;
-                                                &lt;spacer row=&quot;0&quot; column=&quot;1&quot;&gt;
-                                                    &lt;property name=&quot;name&quot;&gt;
-                                                        &lt;cstring&gt;Spacer1&lt;/cstring&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;orientation&quot;&gt;
-                                                        &lt;enum&gt;Horizontal&lt;/enum&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;sizeType&quot;&gt;
-                                                        &lt;enum&gt;Expanding&lt;/enum&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;sizeHint&quot;&gt;
-                                                        &lt;size&gt;
-                                                            &lt;width&gt;20&lt;/width&gt;
-                                                            &lt;height&gt;20&lt;/height&gt;
-                                                        &lt;/size&gt;
-                                                    &lt;/property&gt;
-                                                &lt;/spacer&gt;
-                                                &lt;widget class=&quot;QLineEdit&quot; row=&quot;2&quot; column=&quot;1&quot; rowspan=&quot;1&quot; colspan=&quot;2&quot;&gt;
-                                                    &lt;property name=&quot;name&quot;&gt;
-                                                        &lt;cstring&gt;MusicEdit&lt;/cstring&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;alignment&quot;&gt;
-                                                        &lt;set&gt;AlignLeft&lt;/set&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;hAlign&quot; stdset=&quot;0&quot;&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
-                                                        &lt;string&gt;Path to music file&lt;/string&gt;
-                                                    &lt;/property&gt;
-                                                &lt;/widget&gt;
-                                                &lt;widget class=&quot;QLineEdit&quot; row=&quot;3&quot; column=&quot;1&quot; rowspan=&quot;1&quot; colspan=&quot;2&quot;&gt;
-                                                    &lt;property name=&quot;name&quot;&gt;
-                                                        &lt;cstring&gt;BackgroundLineEdit&lt;/cstring&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;alignment&quot;&gt;
-                                                        &lt;set&gt;AlignLeft&lt;/set&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;hAlign&quot; stdset=&quot;0&quot;&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
-                                                        &lt;string&gt;Path to background picture&lt;/string&gt;
-                                                    &lt;/property&gt;
-                                                &lt;/widget&gt;
-                                                &lt;widget class=&quot;QLabel&quot; row=&quot;1&quot; column=&quot;0&quot;&gt;
-                                                    &lt;property name=&quot;name&quot;&gt;
-                                                        &lt;cstring&gt;TextLabel2&lt;/cstring&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;text&quot;&gt;
-                                                        &lt;string&gt;Node Name&lt;/string&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
-                                                        &lt;string&gt;Name is not used&lt;/string&gt;
-                                                    &lt;/property&gt;
-                                                &lt;/widget&gt;
-                                                &lt;widget class=&quot;QLineEdit&quot; row=&quot;0&quot; column=&quot;2&quot;&gt;
-                                                    &lt;property name=&quot;name&quot;&gt;
-                                                        &lt;cstring&gt;nodeIdLineEdit&lt;/cstring&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;alignment&quot;&gt;
-                                                        &lt;set&gt;AlignRight&lt;/set&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;hAlign&quot; stdset=&quot;0&quot;&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
-                                                        &lt;string&gt;unique identifier for node&lt;/string&gt;
-                                                    &lt;/property&gt;
-                                                &lt;/widget&gt;
-                                            &lt;/grid&gt;
-                                        &lt;/widget&gt;
-                                    &lt;/grid&gt;
-                                &lt;/widget&gt;
-                                &lt;widget class=&quot;QWidget&quot;&gt;
-                                    &lt;property name=&quot;name&quot;&gt;
-                                        &lt;cstring&gt;tab&lt;/cstring&gt;
-                                    &lt;/property&gt;
-                                    &lt;attribute name=&quot;title&quot;&gt;
-                                        &lt;string&gt;Answer&lt;/string&gt;
-                                    &lt;/attribute&gt;
-                                    &lt;vbox&gt;
+                                                &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                    &lt;string&gt;Answer will not show, if doesn.t match&lt;/string&gt;
+                                                &lt;/property&gt;
+                                            &lt;/widget&gt;
+                                        &lt;/hbox&gt;
+                                    &lt;/widget&gt;
+                                    &lt;widget class=&quot;QGroupBox&quot;&gt;
                                         &lt;property name=&quot;name&quot;&gt;
-                                            &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                                            &lt;cstring&gt;GroupBox1&lt;/cstring&gt;
                                         &lt;/property&gt;
-                                        &lt;property name=&quot;margin&quot;&gt;
-                                            &lt;number&gt;11&lt;/number&gt;
+                                        &lt;property name=&quot;title&quot;&gt;
+                                            &lt;string&gt;Actions&lt;/string&gt;
                                         &lt;/property&gt;
-                                        &lt;property name=&quot;spacing&quot;&gt;
-                                            &lt;number&gt;6&lt;/number&gt;
-                                        &lt;/property&gt;
-                                        &lt;widget class=&quot;QLayoutWidget&quot;&gt;
+                                        &lt;hbox&gt;
                                             &lt;property name=&quot;name&quot;&gt;
-                                                &lt;cstring&gt;Layout12&lt;/cstring&gt;
+                                                &lt;cstring&gt;unnamed&lt;/cstring&gt;
                                             &lt;/property&gt;
-                                            &lt;vbox&gt;
+                                            &lt;property name=&quot;margin&quot;&gt;
+                                                &lt;number&gt;11&lt;/number&gt;
+                                            &lt;/property&gt;
+                                            &lt;property name=&quot;spacing&quot;&gt;
+                                                &lt;number&gt;6&lt;/number&gt;
+                                            &lt;/property&gt;
+                                            &lt;widget class=&quot;QLayoutWidget&quot;&gt;
                                                 &lt;property name=&quot;name&quot;&gt;
-                                                    &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                                                    &lt;cstring&gt;Layout10&lt;/cstring&gt;
                                                 &lt;/property&gt;
-                                                &lt;property name=&quot;margin&quot;&gt;
-                                                    &lt;number&gt;0&lt;/number&gt;
-                                                &lt;/property&gt;
-                                                &lt;property name=&quot;spacing&quot;&gt;
-                                                    &lt;number&gt;6&lt;/number&gt;
-                                                &lt;/property&gt;
-                                                &lt;widget class=&quot;QLayoutWidget&quot;&gt;
+                                                &lt;vbox&gt;
                                                     &lt;property name=&quot;name&quot;&gt;
-                                                        &lt;cstring&gt;Layout11&lt;/cstring&gt;
+                                                        &lt;cstring&gt;unnamed&lt;/cstring&gt;
                                                     &lt;/property&gt;
-                                                    &lt;hbox&gt;
+                                                    &lt;property name=&quot;margin&quot;&gt;
+                                                        &lt;number&gt;0&lt;/number&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;property name=&quot;spacing&quot;&gt;
+                                                        &lt;number&gt;6&lt;/number&gt;
+                                                    &lt;/property&gt;
+                                                    &lt;widget class=&quot;QLayoutWidget&quot;&gt;
                                                         &lt;property name=&quot;name&quot;&gt;
-                                                            &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                                                            &lt;cstring&gt;Layout5&lt;/cstring&gt;
                                                         &lt;/property&gt;
-                                                        &lt;property name=&quot;margin&quot;&gt;
-                                                            &lt;number&gt;0&lt;/number&gt;
+                                                        &lt;hbox&gt;
+                                                            &lt;property name=&quot;name&quot;&gt;
+                                                                &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                                                            &lt;/property&gt;
+                                                            &lt;property name=&quot;margin&quot;&gt;
+                                                                &lt;number&gt;0&lt;/number&gt;
+                                                            &lt;/property&gt;
+                                                            &lt;property name=&quot;spacing&quot;&gt;
+                                                                &lt;number&gt;6&lt;/number&gt;
+                                                            &lt;/property&gt;
+                                                            &lt;widget class=&quot;QLabel&quot;&gt;
+                                                                &lt;property name=&quot;name&quot;&gt;
+                                                                    &lt;cstring&gt;TextLabel2_2&lt;/cstring&gt;
+                                                                &lt;/property&gt;
+                                                                &lt;property name=&quot;text&quot;&gt;
+                                                                    &lt;string&gt;condition&lt;/string&gt;
+                                                                &lt;/property&gt;
+                                                            &lt;/widget&gt;
+                                                            &lt;widget class=&quot;QLineEdit&quot;&gt;
+                                                                &lt;property name=&quot;name&quot;&gt;
+                                                                    &lt;cstring&gt;condition1LineEdit&lt;/cstring&gt;
+                                                                &lt;/property&gt;
+                                                                &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                                    &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
+                                                                &lt;/property&gt;
+                                                            &lt;/widget&gt;
+                                                            &lt;widget class=&quot;QLabel&quot;&gt;
+                                                                &lt;property name=&quot;name&quot;&gt;
+                                                                    &lt;cstring&gt;TextLabel7&lt;/cstring&gt;
+                                                                &lt;/property&gt;
+                                                                &lt;property name=&quot;text&quot;&gt;
+                                                                    &lt;string&gt;do&lt;/string&gt;
+                                                                &lt;/property&gt;
+                                                            &lt;/widget&gt;
+                                                            &lt;widget class=&quot;QLineEdit&quot;&gt;
+                                                                &lt;property name=&quot;name&quot;&gt;
+                                                                    &lt;cstring&gt;action1LineEdit&lt;/cstring&gt;
+                                                                &lt;/property&gt;
+                                                                &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                                    &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
+                                                                &lt;/property&gt;
+                                                            &lt;/widget&gt;
+                                                        &lt;/hbox&gt;
+                                                    &lt;/widget&gt;
+                                                    &lt;widget class=&quot;QLayoutWidget&quot;&gt;
+                                                        &lt;property name=&quot;name&quot;&gt;
+                                                            &lt;cstring&gt;Layout6&lt;/cstring&gt;
                                                         &lt;/property&gt;
-                                                        &lt;property name=&quot;spacing&quot;&gt;
-                                                            &lt;number&gt;6&lt;/number&gt;
+                                                        &lt;hbox&gt;
+                                                            &lt;property name=&quot;name&quot;&gt;
+                                                                &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                                                            &lt;/property&gt;
+                                                            &lt;property name=&quot;margin&quot;&gt;
+                                                                &lt;number&gt;0&lt;/number&gt;
+                                                            &lt;/property&gt;
+                                                            &lt;property name=&quot;spacing&quot;&gt;
+                                                                &lt;number&gt;6&lt;/number&gt;
+                                                            &lt;/property&gt;
+                                                            &lt;widget class=&quot;QLabel&quot;&gt;
+                                                                &lt;property name=&quot;name&quot;&gt;
+                                                                    &lt;cstring&gt;TextLabel3_3&lt;/cstring&gt;
+                                                                &lt;/property&gt;
+                                                                &lt;property name=&quot;text&quot;&gt;
+                                                                    &lt;string&gt;condition&lt;/string&gt;
+                                                                &lt;/property&gt;
+                                                            &lt;/widget&gt;
+                                                            &lt;widget class=&quot;QLineEdit&quot;&gt;
+                                                                &lt;property name=&quot;name&quot;&gt;
+                                                                    &lt;cstring&gt;condition2LineEdit&lt;/cstring&gt;
+                                                                &lt;/property&gt;
+                                                                &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                                    &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
+                                                                &lt;/property&gt;
+                                                            &lt;/widget&gt;
+                                                            &lt;widget class=&quot;QLabel&quot;&gt;
+                                                                &lt;property name=&quot;name&quot;&gt;
+                                                                    &lt;cstring&gt;TextLabel8&lt;/cstring&gt;
+                                                                &lt;/property&gt;
+                                                                &lt;property name=&quot;text&quot;&gt;
+                                                                    &lt;string&gt;do&lt;/string&gt;
+                                                                &lt;/property&gt;
+                                                            &lt;/widget&gt;
+                                                            &lt;widget class=&quot;QLineEdit&quot;&gt;
+                                                                &lt;property name=&quot;name&quot;&gt;
+                                                                    &lt;cstring&gt;action2LineEdit&lt;/cstring&gt;
+                                                                &lt;/property&gt;
+                                                                &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                                    &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
+                                                                &lt;/property&gt;
+                                                            &lt;/widget&gt;
+                                                        &lt;/hbox&gt;
+                                                    &lt;/widget&gt;
+                                                    &lt;widget class=&quot;QLayoutWidget&quot;&gt;
+                                                        &lt;property name=&quot;name&quot;&gt;
+                                                            &lt;cstring&gt;Layout7&lt;/cstring&gt;
                                                         &lt;/property&gt;
-                                                        &lt;widget class=&quot;QLabel&quot;&gt;
+                                                        &lt;hbox&gt;
                                                             &lt;property name=&quot;name&quot;&gt;
-                                                                &lt;cstring&gt;TextLabel1_2&lt;/cstring&gt;
+                                                                &lt;cstring&gt;unnamed&lt;/cstring&gt;
                                                             &lt;/property&gt;
-                                                            &lt;property name=&quot;text&quot;&gt;
-                                                                &lt;string&gt;Appear condition:&lt;/string&gt;
+                                                            &lt;property name=&quot;margin&quot;&gt;
+                                                                &lt;number&gt;0&lt;/number&gt;
                                                             &lt;/property&gt;
-                                                        &lt;/widget&gt;
-                                                        &lt;widget class=&quot;QLineEdit&quot;&gt;
+                                                            &lt;property name=&quot;spacing&quot;&gt;
+                                                                &lt;number&gt;6&lt;/number&gt;
+                                                            &lt;/property&gt;
+                                                            &lt;widget class=&quot;QLabel&quot;&gt;
+                                                                &lt;property name=&quot;name&quot;&gt;
+                                                                    &lt;cstring&gt;TextLabel4_3&lt;/cstring&gt;
+                                                                &lt;/property&gt;
+                                                                &lt;property name=&quot;text&quot;&gt;
+                                                                    &lt;string&gt;condition&lt;/string&gt;
+                                                                &lt;/property&gt;
+                                                            &lt;/widget&gt;
+                                                            &lt;widget class=&quot;QLineEdit&quot;&gt;
+                                                                &lt;property name=&quot;name&quot;&gt;
+                                                                    &lt;cstring&gt;condition3LineEdit&lt;/cstring&gt;
+                                                                &lt;/property&gt;
+                                                                &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                                    &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
+                                                                &lt;/property&gt;
+                                                            &lt;/widget&gt;
+                                                            &lt;widget class=&quot;QLabel&quot;&gt;
+                                                                &lt;property name=&quot;name&quot;&gt;
+                                                                    &lt;cstring&gt;TextLabel9&lt;/cstring&gt;
+                                                                &lt;/property&gt;
+                                                                &lt;property name=&quot;text&quot;&gt;
+                                                                    &lt;string&gt;do&lt;/string&gt;
+                                                                &lt;/property&gt;
+                                                            &lt;/widget&gt;
+                                                            &lt;widget class=&quot;QLineEdit&quot;&gt;
+                                                                &lt;property name=&quot;name&quot;&gt;
+                                                                    &lt;cstring&gt;action3LineEdit&lt;/cstring&gt;
+                                                                &lt;/property&gt;
+                                                                &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                                    &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
+                                                                &lt;/property&gt;
+                                                            &lt;/widget&gt;
+                                                        &lt;/hbox&gt;
+                                                    &lt;/widget&gt;
+                                                    &lt;widget class=&quot;QLayoutWidget&quot;&gt;
+                                                        &lt;property name=&quot;name&quot;&gt;
+                                                            &lt;cstring&gt;Layout8&lt;/cstring&gt;
+                                                        &lt;/property&gt;
+                                                        &lt;hbox&gt;
                                                             &lt;property name=&quot;name&quot;&gt;
-                                                                &lt;cstring&gt;appearConditionLineEdit&lt;/cstring&gt;
+                                                                &lt;cstring&gt;unnamed&lt;/cstring&gt;
                                                             &lt;/property&gt;
-                                                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
-                                                                &lt;string&gt;Answer will not show, if doesn.t match&lt;/string&gt;
+                                                            &lt;property name=&quot;margin&quot;&gt;
+                                                                &lt;number&gt;0&lt;/number&gt;
                                                             &lt;/property&gt;
-                                                        &lt;/widget&gt;
-                                                    &lt;/hbox&gt;
-                                                &lt;/widget&gt;
-                                                &lt;widget class=&quot;QGroupBox&quot;&gt;
-                                                    &lt;property name=&quot;name&quot;&gt;
-                                                        &lt;cstring&gt;GroupBox1&lt;/cstring&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;property name=&quot;title&quot;&gt;
-                                                        &lt;string&gt;Actions&lt;/string&gt;
-                                                    &lt;/property&gt;
-                                                    &lt;hbox&gt;
+                                                            &lt;property name=&quot;spacing&quot;&gt;
+                                                                &lt;number&gt;6&lt;/number&gt;
+                                                            &lt;/property&gt;
+                                                            &lt;widget class=&quot;QLabel&quot;&gt;
+                                                                &lt;property name=&quot;name&quot;&gt;
+                                                                    &lt;cstring&gt;TextLabel5&lt;/cstring&gt;
+                                                                &lt;/property&gt;
+                                                                &lt;property name=&quot;text&quot;&gt;
+                                                                    &lt;string&gt;condition&lt;/string&gt;
+                                                                &lt;/property&gt;
+                                                            &lt;/widget&gt;
+                                                            &lt;widget class=&quot;QLineEdit&quot;&gt;
+                                                                &lt;property name=&quot;name&quot;&gt;
+                                                                    &lt;cstring&gt;condition4LineEdit&lt;/cstring&gt;
+                                                                &lt;/property&gt;
+                                                                &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                                    &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
+                                                                &lt;/property&gt;
+                                                            &lt;/widget&gt;
+                                                            &lt;widget class=&quot;QLabel&quot;&gt;
+                                                                &lt;property name=&quot;name&quot;&gt;
+                                                                    &lt;cstring&gt;TextLabel10&lt;/cstring&gt;
+                                                                &lt;/property&gt;
+                                                                &lt;property name=&quot;text&quot;&gt;
+                                                                    &lt;string&gt;do&lt;/string&gt;
+                                                                &lt;/property&gt;
+                                                            &lt;/widget&gt;
+                                                            &lt;widget class=&quot;QLineEdit&quot;&gt;
+                                                                &lt;property name=&quot;name&quot;&gt;
+                                                                    &lt;cstring&gt;action4LineEdit&lt;/cstring&gt;
+                                                                &lt;/property&gt;
+                                                                &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                                    &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
+                                                                &lt;/property&gt;
+                                                            &lt;/widget&gt;
+                                                        &lt;/hbox&gt;
+                                                    &lt;/widget&gt;
+                                                    &lt;widget class=&quot;QLayoutWidget&quot;&gt;
                                                         &lt;property name=&quot;name&quot;&gt;
-                                                            &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                                                            &lt;cstring&gt;Layout9&lt;/cstring&gt;
                                                         &lt;/property&gt;
-                                                        &lt;property name=&quot;margin&quot;&gt;
-                                                            &lt;number&gt;11&lt;/number&gt;
-                                                        &lt;/property&gt;
-                                                        &lt;property name=&quot;spacing&quot;&gt;
-                                                            &lt;number&gt;6&lt;/number&gt;
-                                                        &lt;/property&gt;
-                                                        &lt;widget class=&quot;QLayoutWidget&quot;&gt;
+                                                        &lt;hbox&gt;
                                                             &lt;property name=&quot;name&quot;&gt;
-                                                                &lt;cstring&gt;Layout10&lt;/cstring&gt;
+                                                                &lt;cstring&gt;unnamed&lt;/cstring&gt;
                                                             &lt;/property&gt;
-                                                            &lt;vbox&gt;
+                                                            &lt;property name=&quot;margin&quot;&gt;
+                                                                &lt;number&gt;0&lt;/number&gt;
+                                                            &lt;/property&gt;
+                                                            &lt;property name=&quot;spacing&quot;&gt;
+                                                                &lt;number&gt;6&lt;/number&gt;
+                                                            &lt;/property&gt;
+                                                            &lt;widget class=&quot;QLabel&quot;&gt;
                                                                 &lt;property name=&quot;name&quot;&gt;
-                                                                    &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                                                                    &lt;cstring&gt;TextLabel6&lt;/cstring&gt;
                                                                 &lt;/property&gt;
-                                                                &lt;property name=&quot;margin&quot;&gt;
-                                                                    &lt;number&gt;0&lt;/number&gt;
+                                                                &lt;property name=&quot;text&quot;&gt;
+                                                                    &lt;string&gt;condition&lt;/string&gt;
                                                                 &lt;/property&gt;
-                                                                &lt;property name=&quot;spacing&quot;&gt;
-                                                                    &lt;number&gt;6&lt;/number&gt;
+                                                            &lt;/widget&gt;
+                                                            &lt;widget class=&quot;QLineEdit&quot;&gt;
+                                                                &lt;property name=&quot;name&quot;&gt;
+                                                                    &lt;cstring&gt;condition5LineEdit&lt;/cstring&gt;
                                                                 &lt;/property&gt;
-                                                                &lt;widget class=&quot;QLayoutWidget&quot;&gt;
-                                                                    &lt;property name=&quot;name&quot;&gt;
-                                                                        &lt;cstring&gt;Layout5&lt;/cstring&gt;
-                                                                    &lt;/property&gt;
-                                                                    &lt;hbox&gt;
-                                                                        &lt;property name=&quot;name&quot;&gt;
-                                                                            &lt;cstring&gt;unnamed&lt;/cstring&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property name=&quot;margin&quot;&gt;
-                                                                            &lt;number&gt;0&lt;/number&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property name=&quot;spacing&quot;&gt;
-                                                                            &lt;number&gt;6&lt;/number&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;widget class=&quot;QLabel&quot;&gt;
-                                                                            &lt;property name=&quot;name&quot;&gt;
-                                                                                &lt;cstring&gt;TextLabel2_2&lt;/cstring&gt;
-                                                                            &lt;/property&gt;
-                                                                            &lt;property name=&quot;text&quot;&gt;
-                                                                                &lt;string&gt;condition&lt;/string&gt;
-                                                                            &lt;/property&gt;
-                                                                        &lt;/widget&gt;
-                                                                        &lt;widget class=&quot;QLineEdit&quot;&gt;
-                                                                            &lt;property name=&quot;name&quot;&gt;
-                                                                                &lt;cstring&gt;condition1LineEdit&lt;/cstring&gt;
-                                                                            &lt;/property&gt;
-                                                                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
-                                                                                &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
-                                                                            &lt;/property&gt;
-                                                                        &lt;/widget&gt;
-                                                                        &lt;widget class=&quot;QLabel&quot;&gt;
-                                                                            &lt;property name=&quot;name&quot;&gt;
-                                                                                &lt;cstring&gt;TextLabel7&lt;/cstring&gt;
-                                                                            &lt;/property&gt;
-                                                                            &lt;property name=&quot;text&quot;&gt;
-                                                                                &lt;string&gt;do&lt;/string&gt;
-                                                                            &lt;/property&gt;
-                                                                        &lt;/widget&gt;
-                                                                        &lt;widget class=&quot;QLineEdit&quot;&gt;
-                                                                            &lt;property name=&quot;name&quot;&gt;
-                                                                                &lt;cstring&gt;action1LineEdit&lt;/cstring&gt;
-                                                                            &lt;/property&gt;
-                                                                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
-                                                                                &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
-                                                                            &lt;/property&gt;
-                                                                        &lt;/widget&gt;
-                                                                    &lt;/hbox&gt;
-                                                                &lt;/widget&gt;
-                                                                &lt;widget class=&quot;QLayoutWidget&quot;&gt;
-                                                                    &lt;property name=&quot;name&quot;&gt;
-                                                                        &lt;cstring&gt;Layout6&lt;/cstring&gt;
-                                                                    &lt;/property&gt;
-                                                                    &lt;hbox&gt;
-                                                                        &lt;property name=&quot;name&quot;&gt;
-                                                                            &lt;cstring&gt;unnamed&lt;/cstring&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property name=&quot;margin&quot;&gt;
-                                                                            &lt;number&gt;0&lt;/number&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property name=&quot;spacing&quot;&gt;
-                                                                            &lt;number&gt;6&lt;/number&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;widget class=&quot;QLabel&quot;&gt;
-                                                                            &lt;property name=&quot;name&quot;&gt;
-                                                                                &lt;cstring&gt;TextLabel3_3&lt;/cstring&gt;
-                                                                            &lt;/property&gt;
-                                                                            &lt;property name=&quot;text&quot;&gt;
-                                                                                &lt;string&gt;condition&lt;/string&gt;
-                                                                            &lt;/property&gt;
-                                                                        &lt;/widget&gt;
-                                                                        &lt;widget class=&quot;QLineEdit&quot;&gt;
-                                                                            &lt;property name=&quot;name&quot;&gt;
-                                                                                &lt;cstring&gt;condition2LineEdit&lt;/cstring&gt;
-                                                                            &lt;/property&gt;
-                                                                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
-                                                                                &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
-                                                                            &lt;/property&gt;
-                                                                        &lt;/widget&gt;
-                                                                        &lt;widget class=&quot;QLabel&quot;&gt;
-                                                                            &lt;property name=&quot;name&quot;&gt;
-                                                                                &lt;cstring&gt;TextLabel8&lt;/cstring&gt;
-                                                                            &lt;/property&gt;
-                                                                            &lt;property name=&quot;text&quot;&gt;
-                                                                                &lt;string&gt;do&lt;/string&gt;
-                                                                            &lt;/property&gt;
-                                                                        &lt;/widget&gt;
-                                                                        &lt;widget class=&quot;QLineEdit&quot;&gt;
-                                                                            &lt;property name=&quot;name&quot;&gt;
-                                                                                &lt;cstring&gt;action2LineEdit&lt;/cstring&gt;
-                                                                            &lt;/property&gt;
-                                                                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
-                                                                                &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
-                                                                            &lt;/property&gt;
-                                                                        &lt;/widget&gt;
-                                                                    &lt;/hbox&gt;
-                                                                &lt;/widget&gt;
-                                                                &lt;widget class=&quot;QLayoutWidget&quot;&gt;
-                                                                    &lt;property name=&quot;name&quot;&gt;
-                                                                        &lt;cstring&gt;Layout7&lt;/cstring&gt;
-                                                                    &lt;/property&gt;
-                                                                    &lt;hbox&gt;
-                                                                        &lt;property name=&quot;name&quot;&gt;
-                                                                            &lt;cstring&gt;unnamed&lt;/cstring&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property name=&quot;margin&quot;&gt;
-                                                                            &lt;number&gt;0&lt;/number&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property name=&quot;spacing&quot;&gt;
-                                                                            &lt;number&gt;6&lt;/number&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;widget class=&quot;QLabel&quot;&gt;
-                                                                            &lt;property name=&quot;name&quot;&gt;
-                                                                                &lt;cstring&gt;TextLabel4_3&lt;/cstring&gt;
-                                                                            &lt;/property&gt;
-                                                                            &lt;property name=&quot;text&quot;&gt;
-                                                                                &lt;string&gt;condition&lt;/string&gt;
-                                                                            &lt;/property&gt;
-                                                                        &lt;/widget&gt;
-                                                                        &lt;widget class=&quot;QLineEdit&quot;&gt;
-                                                                            &lt;property name=&quot;name&quot;&gt;
-                                                                                &lt;cstring&gt;condition3LineEdit&lt;/cstring&gt;
-                                                                            &lt;/property&gt;
-                                                                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
-                                                                                &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
-                                                                            &lt;/property&gt;
-                                                                        &lt;/widget&gt;
-                                                                        &lt;widget class=&quot;QLabel&quot;&gt;
-                                                                            &lt;property name=&quot;name&quot;&gt;
-                                                                                &lt;cstring&gt;TextLabel9&lt;/cstring&gt;
-                                                                            &lt;/property&gt;
-                                                                            &lt;property name=&quot;text&quot;&gt;
-                                                                                &lt;string&gt;do&lt;/string&gt;
-                                                                            &lt;/property&gt;
-                                                                        &lt;/widget&gt;
-                                                                        &lt;widget class=&quot;QLineEdit&quot;&gt;
-                                                                            &lt;property name=&quot;name&quot;&gt;
-                                                                                &lt;cstring&gt;action3LineEdit&lt;/cstring&gt;
-                                                                            &lt;/property&gt;
-                                                                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
-                                                                                &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
-                                                                            &lt;/property&gt;
-                                                                        &lt;/widget&gt;
-                                                                    &lt;/hbox&gt;
-                                                                &lt;/widget&gt;
-                                                                &lt;widget class=&quot;QLayoutWidget&quot;&gt;
-                                                                    &lt;property name=&quot;name&quot;&gt;
-                                                                        &lt;cstring&gt;Layout8&lt;/cstring&gt;
-                                                                    &lt;/property&gt;
-                                                                    &lt;hbox&gt;
-                                                                        &lt;property name=&quot;name&quot;&gt;
-                                                                            &lt;cstring&gt;unnamed&lt;/cstring&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property name=&quot;margin&quot;&gt;
-                                                                            &lt;number&gt;0&lt;/number&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property name=&quot;spacing&quot;&gt;
-                                                                            &lt;number&gt;6&lt;/number&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;widget class=&quot;QLabel&quot;&gt;
-                                                                            &lt;property name=&quot;name&quot;&gt;
-                                                                                &lt;cstring&gt;TextLabel5&lt;/cstring&gt;
-                                                                            &lt;/property&gt;
-                                                                            &lt;property name=&quot;text&quot;&gt;
-                                                                                &lt;string&gt;condition&lt;/string&gt;
-                                                                            &lt;/property&gt;
-                                                                        &lt;/widget&gt;
-                                                                        &lt;widget class=&quot;QLineEdit&quot;&gt;
-                                                                            &lt;property name=&quot;name&quot;&gt;
-                                                                                &lt;cstring&gt;condition4LineEdit&lt;/cstring&gt;
-                                                                            &lt;/property&gt;
-                                                                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
-                                                                                &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
-                                                                            &lt;/property&gt;
-                                                                        &lt;/widget&gt;
-                                                                        &lt;widget class=&quot;QLabel&quot;&gt;
-                                                                            &lt;property name=&quot;name&quot;&gt;
-                                                                                &lt;cstring&gt;TextLabel10&lt;/cstring&gt;
-                                                                            &lt;/property&gt;
-                                                                            &lt;property name=&quot;text&quot;&gt;
-                                                                                &lt;string&gt;do&lt;/string&gt;
-                                                                            &lt;/property&gt;
-                                                                        &lt;/widget&gt;
-                                                                        &lt;widget class=&quot;QLineEdit&quot;&gt;
-                                                                            &lt;property name=&quot;name&quot;&gt;
-                                                                                &lt;cstring&gt;action4LineEdit&lt;/cstring&gt;
-                                                                            &lt;/property&gt;
-                                                                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
-                                                                                &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
-                                                                            &lt;/property&gt;
-                                                                        &lt;/widget&gt;
-                                                                    &lt;/hbox&gt;
-                                                                &lt;/widget&gt;
-                                                                &lt;widget class=&quot;QLayoutWidget&quot;&gt;
-                                                                    &lt;property name=&quot;name&quot;&gt;
-                                                                        &lt;cstring&gt;Layout9&lt;/cstring&gt;
-                                                                    &lt;/property&gt;
-                                                                    &lt;hbox&gt;
-                                                                        &lt;property name=&quot;name&quot;&gt;
-                                                                            &lt;cstring&gt;unnamed&lt;/cstring&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property name=&quot;margin&quot;&gt;
-                                                                            &lt;number&gt;0&lt;/number&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;property name=&quot;spacing&quot;&gt;
-                                                                            &lt;number&gt;6&lt;/number&gt;
-                                                                        &lt;/property&gt;
-                                                                        &lt;widget class=&quot;QLabel&quot;&gt;
-                                                                            &lt;property name=&quot;name&quot;&gt;
-                                                                                &lt;cstring&gt;TextLabel6&lt;/cstring&gt;
-                                                                            &lt;/property&gt;
-                                                                            &lt;property name=&quot;text&quot;&gt;
-                                                                                &lt;string&gt;condition&lt;/string&gt;
-                                                                            &lt;/property&gt;
-                                                                        &lt;/widget&gt;
-                                                                        &lt;widget class=&quot;QLineEdit&quot;&gt;
-                                                                            &lt;property name=&quot;name&quot;&gt;
-                                                                                &lt;cstring&gt;condition5LineEdit&lt;/cstring&gt;
-                                                                            &lt;/property&gt;
-                                                                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
-                                                                                &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
-                                                                            &lt;/property&gt;
-                                                                        &lt;/widget&gt;
-                                                                        &lt;widget class=&quot;QLabel&quot;&gt;
-                                                                            &lt;property name=&quot;name&quot;&gt;
-                                                                                &lt;cstring&gt;TextLabel11&lt;/cstring&gt;
-                                                                            &lt;/property&gt;
-                                                                            &lt;property name=&quot;text&quot;&gt;
-                                                                                &lt;string&gt;do&lt;/string&gt;
-                                                                            &lt;/property&gt;
-                                                                        &lt;/widget&gt;
-                                                                        &lt;widget class=&quot;QLineEdit&quot;&gt;
-                                                                            &lt;property name=&quot;name&quot;&gt;
-                                                                                &lt;cstring&gt;action5LineEdit&lt;/cstring&gt;
-                                                                            &lt;/property&gt;
-                                                                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
-                                                                                &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
-                                                                            &lt;/property&gt;
-                                                                        &lt;/widget&gt;
-                                                                    &lt;/hbox&gt;
-                                                                &lt;/widget&gt;
-                                                            &lt;/vbox&gt;
-                                                        &lt;/widget&gt;
-                                                    &lt;/hbox&gt;
-                                                &lt;/widget&gt;
-                                            &lt;/vbox&gt;
-                                        &lt;/widget&gt;
-                                    &lt;/vbox&gt;
-                                &lt;/widget&gt;
+                                                                &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                                    &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
+                                                                &lt;/property&gt;
+                                                            &lt;/widget&gt;
+                                                            &lt;widget class=&quot;QLabel&quot;&gt;
+                                                                &lt;property name=&quot;name&quot;&gt;
+                                                                    &lt;cstring&gt;TextLabel11&lt;/cstring&gt;
+                                                                &lt;/property&gt;
+                                                                &lt;property name=&quot;text&quot;&gt;
+                                                                    &lt;string&gt;do&lt;/string&gt;
+                                                                &lt;/property&gt;
+                                                            &lt;/widget&gt;
+                                                            &lt;widget class=&quot;QLineEdit&quot;&gt;
+                                                                &lt;property name=&quot;name&quot;&gt;
+                                                                    &lt;cstring&gt;action5LineEdit&lt;/cstring&gt;
+                                                                &lt;/property&gt;
+                                                                &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                                    &lt;string&gt;if condition match, coresponding action will be evaluated&lt;/string&gt;
+                                                                &lt;/property&gt;
+                                                            &lt;/widget&gt;
+                                                        &lt;/hbox&gt;
+                                                    &lt;/widget&gt;
+                                                &lt;/vbox&gt;
+                                            &lt;/widget&gt;
+                                        &lt;/hbox&gt;
+                                    &lt;/widget&gt;
+                                &lt;/vbox&gt;
                             &lt;/widget&gt;
                         &lt;/vbox&gt;
                     &lt;/widget&gt;
-                &lt;/widget&gt;
-                &lt;widget class=&quot;QLayoutWidget&quot;&gt;
-                    &lt;property name=&quot;name&quot;&gt;
-                        &lt;cstring&gt;Layout19&lt;/cstring&gt;
-                    &lt;/property&gt;
-                    &lt;vbox&gt;
+                    &lt;widget class=&quot;QWidget&quot;&gt;
                         &lt;property name=&quot;name&quot;&gt;
-                            &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                            &lt;cstring&gt;TabPage&lt;/cstring&gt;
                         &lt;/property&gt;
-                        &lt;property name=&quot;margin&quot;&gt;
-                            &lt;number&gt;0&lt;/number&gt;
-                        &lt;/property&gt;
-                        &lt;property name=&quot;spacing&quot;&gt;
-                            &lt;number&gt;6&lt;/number&gt;
-                        &lt;/property&gt;
-                        &lt;widget class=&quot;QLayoutWidget&quot;&gt;
+                        &lt;attribute name=&quot;title&quot;&gt;
+                            &lt;string&gt;Init/deinit&lt;/string&gt;
+                        &lt;/attribute&gt;
+                        &lt;grid&gt;
                             &lt;property name=&quot;name&quot;&gt;
-                                &lt;cstring&gt;Layout18&lt;/cstring&gt;
+                                &lt;cstring&gt;unnamed&lt;/cstring&gt;
                             &lt;/property&gt;
-                            &lt;hbox&gt;
+                            &lt;widget class=&quot;QSplitter&quot; row=&quot;0&quot; column=&quot;0&quot;&gt;
                                 &lt;property name=&quot;name&quot;&gt;
-                                    &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                                    &lt;cstring&gt;splitter14&lt;/cstring&gt;
                                 &lt;/property&gt;
-                                &lt;property name=&quot;margin&quot;&gt;
-                                    &lt;number&gt;0&lt;/number&gt;
+                                &lt;property name=&quot;orientation&quot;&gt;
+                                    &lt;enum&gt;Horizontal&lt;/enum&gt;
                                 &lt;/property&gt;
-                                &lt;property name=&quot;spacing&quot;&gt;
-                                    &lt;number&gt;6&lt;/number&gt;
-                                &lt;/property&gt;
-                                &lt;widget class=&quot;QLabel&quot;&gt;
+                                &lt;widget class=&quot;QLayoutWidget&quot;&gt;
                                     &lt;property name=&quot;name&quot;&gt;
-                                        &lt;cstring&gt;TextLabel3&lt;/cstring&gt;
+                                        &lt;cstring&gt;layout36&lt;/cstring&gt;
                                     &lt;/property&gt;
-                                    &lt;property name=&quot;text&quot;&gt;
-                                        &lt;string&gt;Triggers:&lt;/string&gt;
-                                    &lt;/property&gt;
+                                    &lt;vbox&gt;
+                                        &lt;property name=&quot;name&quot;&gt;
+                                            &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                                        &lt;/property&gt;
+                                        &lt;widget class=&quot;QLabel&quot;&gt;
+                                            &lt;property name=&quot;name&quot;&gt;
+                                                &lt;cstring&gt;textLabel1&lt;/cstring&gt;
+                                            &lt;/property&gt;
+                                            &lt;property name=&quot;text&quot;&gt;
+                                                &lt;string&gt;Start&lt;/string&gt;
+                                            &lt;/property&gt;
+                                        &lt;/widget&gt;
+                                        &lt;widget class=&quot;QTextEdit&quot;&gt;
+                                            &lt;property name=&quot;name&quot;&gt;
+                                                &lt;cstring&gt;startDialogCode_textEdit&lt;/cstring&gt;
+                                            &lt;/property&gt;
+                                            &lt;property name=&quot;toolTip&quot; stdset=&quot;0&quot;&gt;
+                                                &lt;string&gt;This code will be evaluated before start dialog&lt;/string&gt;
+                                            &lt;/property&gt;
+                                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                &lt;string&gt;This code will be evaluated before start dialog&lt;/string&gt;
+                                            &lt;/property&gt;
+                                        &lt;/widget&gt;
+                                    &lt;/vbox&gt;
                                 &lt;/widget&gt;
-                                &lt;widget class=&quot;QLabel&quot;&gt;
+                                &lt;widget class=&quot;QLayoutWidget&quot;&gt;
                                     &lt;property name=&quot;name&quot;&gt;
-                                        &lt;cstring&gt;TextLabel12&lt;/cstring&gt;
+                                        &lt;cstring&gt;layout35&lt;/cstring&gt;
                                     &lt;/property&gt;
-                                    &lt;property name=&quot;text&quot;&gt;
-                                        &lt;string&gt;Name&lt;/string&gt;
-                                    &lt;/property&gt;
+                                    &lt;vbox&gt;
+                                        &lt;property name=&quot;name&quot;&gt;
+                                            &lt;cstring&gt;unnamed&lt;/cstring&gt;
+                                        &lt;/property&gt;
+                                        &lt;widget class=&quot;QLabel&quot;&gt;
+                                            &lt;property name=&quot;name&quot;&gt;
+                                                &lt;cstring&gt;textLabel1_2&lt;/cstring&gt;
+                                            &lt;/property&gt;
+                                            &lt;property name=&quot;text&quot;&gt;
+                                                &lt;string&gt;End&lt;/string&gt;
+                                            &lt;/property&gt;
+                                        &lt;/widget&gt;
+                                        &lt;widget class=&quot;QTextEdit&quot;&gt;
+                                            &lt;property name=&quot;name&quot;&gt;
+                                                &lt;cstring&gt;endDialogCode_textEdit&lt;/cstring&gt;
+                                            &lt;/property&gt;
+                                            &lt;property name=&quot;toolTip&quot; stdset=&quot;0&quot;&gt;
+                                                &lt;string&gt;This code will be evaluated after finishing dialog&lt;/string&gt;
+                                            &lt;/property&gt;
+                                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                                                &lt;string&gt;This code will be evaluated after finishing dialog&lt;/string&gt;
+                                            &lt;/property&gt;
+                                        &lt;/widget&gt;
+                                    &lt;/vbox&gt;
                                 &lt;/widget&gt;
-                                &lt;widget class=&quot;QLabel&quot;&gt;
-                                    &lt;property name=&quot;name&quot;&gt;
-                                        &lt;cstring&gt;TextLabel13&lt;/cstring&gt;
-                                    &lt;/property&gt;
-                                    &lt;property name=&quot;text&quot;&gt;
-                                        &lt;string&gt;Value&lt;/string&gt;
-                                    &lt;/property&gt;
-                                &lt;/widget&gt;
-                            &lt;/hbox&gt;
-                        &lt;/widget&gt;
-                        &lt;widget class=&quot;QTable&quot;&gt;
-                            &lt;property name=&quot;name&quot;&gt;
-                                &lt;cstring&gt;triggerTable&lt;/cstring&gt;
-                            &lt;/property&gt;
-                            &lt;property name=&quot;maximumSize&quot;&gt;
-                                &lt;size&gt;
-                                    &lt;width&gt;200&lt;/width&gt;
-                                    &lt;height&gt;32767&lt;/height&gt;
-                                &lt;/size&gt;
-                            &lt;/property&gt;
-                            &lt;property name=&quot;numRows&quot;&gt;
-                                &lt;number&gt;6&lt;/number&gt;
-                            &lt;/property&gt;
-                            &lt;property name=&quot;numCols&quot;&gt;
-                                &lt;number&gt;6&lt;/number&gt;
-                            &lt;/property&gt;
-                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
-                                &lt;string&gt;First column - trigger name, second - value&lt;/string&gt;
-                            &lt;/property&gt;
-                        &lt;/widget&gt;
-                        &lt;widget class=&quot;QListView&quot;&gt;
-                            &lt;column&gt;
-                                &lt;property name=&quot;text&quot;&gt;
-                                    &lt;string&gt;ID&lt;/string&gt;
-                                &lt;/property&gt;
-                                &lt;property name=&quot;clickable&quot;&gt;
-                                    &lt;bool&gt;true&lt;/bool&gt;
-                                &lt;/property&gt;
-                                &lt;property name=&quot;resizable&quot;&gt;
-                                    &lt;bool&gt;true&lt;/bool&gt;
-                                &lt;/property&gt;
-                            &lt;/column&gt;
-                            &lt;column&gt;
-                                &lt;property name=&quot;text&quot;&gt;
-                                    &lt;string&gt;Name&lt;/string&gt;
-                                &lt;/property&gt;
-                                &lt;property name=&quot;clickable&quot;&gt;
-                                    &lt;bool&gt;true&lt;/bool&gt;
-                                &lt;/property&gt;
-                                &lt;property name=&quot;resizable&quot;&gt;
-                                    &lt;bool&gt;true&lt;/bool&gt;
-                                &lt;/property&gt;
-                            &lt;/column&gt;
-                            &lt;property name=&quot;name&quot;&gt;
-                                &lt;cstring&gt;nodeListView&lt;/cstring&gt;
-                            &lt;/property&gt;
-                            &lt;property name=&quot;sizePolicy&quot;&gt;
-                                &lt;sizepolicy&gt;
-                                    &lt;hsizetype&gt;7&lt;/hsizetype&gt;
-                                    &lt;vsizetype&gt;5&lt;/vsizetype&gt;
-                                    &lt;horstretch&gt;0&lt;/horstretch&gt;
-                                    &lt;verstretch&gt;0&lt;/verstretch&gt;
-                                &lt;/sizepolicy&gt;
-                            &lt;/property&gt;
-                            &lt;property name=&quot;maximumSize&quot;&gt;
-                                &lt;size&gt;
-                                    &lt;width&gt;200&lt;/width&gt;
-                                    &lt;height&gt;32767&lt;/height&gt;
-                                &lt;/size&gt;
-                            &lt;/property&gt;
-                            &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
-                                &lt;string&gt;Browse nodes from here&lt;/string&gt;
-                            &lt;/property&gt;
-                        &lt;/widget&gt;
-                    &lt;/vbox&gt;
+                            &lt;/widget&gt;
+                        &lt;/grid&gt;
+                    &lt;/widget&gt;
                 &lt;/widget&gt;
+                &lt;widget class=&quot;QListView&quot;&gt;
+                    &lt;column&gt;
+                        &lt;property name=&quot;text&quot;&gt;
+                            &lt;string&gt;ID&lt;/string&gt;
+                        &lt;/property&gt;
+                        &lt;property name=&quot;clickable&quot;&gt;
+                            &lt;bool&gt;true&lt;/bool&gt;
+                        &lt;/property&gt;
+                        &lt;property name=&quot;resizable&quot;&gt;
+                            &lt;bool&gt;true&lt;/bool&gt;
+                        &lt;/property&gt;
+                    &lt;/column&gt;
+                    &lt;column&gt;
+                        &lt;property name=&quot;text&quot;&gt;
+                            &lt;string&gt;Name&lt;/string&gt;
+                        &lt;/property&gt;
+                        &lt;property name=&quot;clickable&quot;&gt;
+                            &lt;bool&gt;true&lt;/bool&gt;
+                        &lt;/property&gt;
+                        &lt;property name=&quot;resizable&quot;&gt;
+                            &lt;bool&gt;true&lt;/bool&gt;
+                        &lt;/property&gt;
+                    &lt;/column&gt;
+                    &lt;property name=&quot;name&quot;&gt;
+                        &lt;cstring&gt;nodeListView&lt;/cstring&gt;
+                    &lt;/property&gt;
+                    &lt;property name=&quot;sizePolicy&quot;&gt;
+                        &lt;sizepolicy&gt;
+                            &lt;hsizetype&gt;7&lt;/hsizetype&gt;
+                            &lt;vsizetype&gt;5&lt;/vsizetype&gt;
+                            &lt;horstretch&gt;0&lt;/horstretch&gt;
+                            &lt;verstretch&gt;0&lt;/verstretch&gt;
+                        &lt;/sizepolicy&gt;
+                    &lt;/property&gt;
+                    &lt;property name=&quot;maximumSize&quot;&gt;
+                        &lt;size&gt;
+                            &lt;width&gt;200&lt;/width&gt;
+                            &lt;height&gt;32767&lt;/height&gt;
+                        &lt;/size&gt;
+                    &lt;/property&gt;
+                    &lt;property name=&quot;resizeMode&quot;&gt;
+                        &lt;enum&gt;LastColumn&lt;/enum&gt;
+                    &lt;/property&gt;
+                    &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
+                        &lt;string&gt;Browse nodes from here&lt;/string&gt;
+                    &lt;/property&gt;
+                &lt;/widget&gt;
             &lt;/widget&gt;
             &lt;widget class=&quot;QListView&quot;&gt;
                 &lt;column&gt;
@@ -827,6 +815,18 @@
                 &lt;property name=&quot;name&quot;&gt;
                     &lt;cstring&gt;answersListView&lt;/cstring&gt;
                 &lt;/property&gt;
+                &lt;property name=&quot;acceptDrops&quot;&gt;
+                    &lt;bool&gt;true&lt;/bool&gt;
+                &lt;/property&gt;
+                &lt;property name=&quot;frameShape&quot;&gt;
+                    &lt;enum&gt;TabWidgetPanel&lt;/enum&gt;
+                &lt;/property&gt;
+                &lt;property name=&quot;resizeMode&quot;&gt;
+                    &lt;enum&gt;LastColumn&lt;/enum&gt;
+                &lt;/property&gt;
+                &lt;property name=&quot;defaultRenameAction&quot;&gt;
+                    &lt;enum&gt;Accept&lt;/enum&gt;
+                &lt;/property&gt;
                 &lt;property name=&quot;whatsThis&quot; stdset=&quot;0&quot;&gt;
                     &lt;string&gt;Player Answers&lt;/string&gt;
                 &lt;/property&gt;
@@ -867,7 +867,6 @@
     &lt;tabstop&gt;BackgroundLineEdit&lt;/tabstop&gt;
     &lt;tabstop&gt;commonMultiLineEdit&lt;/tabstop&gt;
     &lt;tabstop&gt;nodeListView&lt;/tabstop&gt;
-    &lt;tabstop&gt;triggerTable&lt;/tabstop&gt;
     &lt;tabstop&gt;alienTextBrowser&lt;/tabstop&gt;
     &lt;tabstop&gt;TabWidget2&lt;/tabstop&gt;
     &lt;tabstop&gt;appearConditionLineEdit&lt;/tabstop&gt;
@@ -882,11 +881,14 @@
     &lt;tabstop&gt;condition5LineEdit&lt;/tabstop&gt;
     &lt;tabstop&gt;action5LineEdit&lt;/tabstop&gt;
 &lt;/tabstops&gt;
+&lt;includes&gt;
+    &lt;include location=&quot;local&quot; impldecl=&quot;in implementation&quot;&gt;maindialog.ui.h&lt;/include&gt;
+&lt;/includes&gt;
 &lt;slots&gt;
-    &lt;slot&gt;answerChangedSlot(QListViewItem*)&lt;/slot&gt;
-    &lt;slot&gt;answerPositionChanged(int)&lt;/slot&gt;
-    &lt;slot&gt;nodeChangedSlot(QListViewItem* )&lt;/slot&gt;
-    &lt;slot&gt;processAnswerSlot(QListViewItem*)&lt;/slot&gt;
+    &lt;slot&gt;answerChangedSlot( QListViewItem * )&lt;/slot&gt;
+    &lt;slot&gt;answerPositionChanged( int )&lt;/slot&gt;
+    &lt;slot&gt;nodeChangedSlot( QListViewItem * )&lt;/slot&gt;
+    &lt;slot&gt;processAnswerSlot( QListViewItem * )&lt;/slot&gt;
     &lt;slot&gt;saveAnswer()&lt;/slot&gt;
     &lt;slot&gt;saveNodeInfo()&lt;/slot&gt;
 &lt;/slots&gt;

Modified: trunk/Util/deditor/mainwidget.cpp
===================================================================
--- trunk/Util/deditor/mainwidget.cpp	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/Util/deditor/mainwidget.cpp	2005-08-06 18:09:53 UTC (rev 175)
@@ -24,340 +24,364 @@
 #include &lt;unistd.h&gt;
 #endif
 
-extern &quot;C&quot; {
-#	include &quot;lua.h&quot;
-#	include &quot;lualib.h&quot;
-#	include &quot;lauxlib.h&quot;
+/*extern &quot;C&quot; {
+#   include &quot;lua.h&quot;
+#   include &quot;lualib.h&quot;
+#   include &quot;lauxlib.h&quot;
 }
+  */
 
 DialogEditor::DialogEditor( QWidget* parent, const char* name, WFlags fl ): DialogEditorGenerated(parent, name, fl)
 {
-	WriteLog(&quot;DialogEditor::DialogEditor\n&quot;);
-	alienTextBrowser-&gt;setFrameStyle( QFrame::Panel | QFrame::Sunken );
-	alienTextBrowser-&gt;setText(&quot;&lt;HTML&gt;&lt;BODY&gt;&lt;center&gt;&lt;img width=\&quot;100\&quot; height=\&quot;100\&quot; src=\&quot;./tw-logo.png\&quot;&gt;&lt;br&gt;Alien text and picture will be here&lt;/center&gt;&lt;/BODY&gt;&lt;/HTML&gt;&quot;);
-	alienTextBrowser-&gt;mimeSourceFactory()-&gt;setExtensionType(&quot;qml&quot;, &quot;text/utf8&quot;);
+    WriteLog(&quot;DialogEditor::DialogEditor\n&quot;);
+    alienTextBrowser-&gt;setFrameStyle( QFrame::Panel | QFrame::Sunken );
+    alienTextBrowser-&gt;setText(&quot;&lt;HTML&gt;&lt;BODY&gt;&lt;center&gt;&lt;img width=\&quot;100\&quot; height=\&quot;100\&quot; src=\&quot;./tw-logo.png\&quot;&gt;&lt;br&gt;Alien text and picture will be here&lt;/center&gt;&lt;/BODY&gt;&lt;/HTML&gt;&quot;);
+    alienTextBrowser-&gt;mimeSourceFactory()-&gt;setExtensionType(&quot;qml&quot;, &quot;text/utf8&quot;);
 
-	CreateNewNode();
-	answersListView-&gt;setSorting(-1);
+    CreateNewNode();
+    answersListView-&gt;setSorting(-1);
 }
 
 DialogEditor::~DialogEditor()
 {
-	WriteLog(&quot;DialogEditor::~DialogEditor\n&quot;);
+    WriteLog(&quot;DialogEditor::~DialogEditor\n&quot;);
 }
 
 
 PlayerAnswer* DialogEditor::getPlayerAnswer(const QString&amp; text)
 {
-	NodeItem * node = (NodeItem*)nodeListView-&gt;currentItem();
-	PlayerAnswer * a;
-	for(a = node-&gt;m_answers.first();
-			a; a = node-&gt;m_answers.next())
-		if(a-&gt;m_strText == text)
-			break;
-	assert(a&amp;&amp;&quot;Answer was not found in node!!!&quot;);
-	return a;
+    NodeItem * node = (NodeItem*)nodeListView-&gt;currentItem();
+    PlayerAnswer * a;
+    for(a = node-&gt;m_answers.first();
+            a; a = node-&gt;m_answers.next())
+        if(a-&gt;m_strText == text)
+            break;
+    assert(a&amp;&amp;&quot;Answer was not found in node!!!&quot;);
+    return a;
 }
 
 int DialogEditor::getPlayerAnswerPos(const QString&amp; text)
 {
-	NodeItem * node = (NodeItem*)nodeListView-&gt;currentItem();
-	PlayerAnswer * a;
-	int pos = 0;
-	for(a = node-&gt;m_answers.first();
-			a; a = node-&gt;m_answers.next())
-			{
-				if(a-&gt;m_strText == text)
-					break;
-				pos++;
-			}
-	assert(a&amp;&amp;&quot;Answer was not found in node!!!&quot;);
-	return pos;
+    NodeItem * node = (NodeItem*)nodeListView-&gt;currentItem();
+    PlayerAnswer * a;
+    int pos = 0;
+    for(a = node-&gt;m_answers.first();
+            a; a = node-&gt;m_answers.next())
+            {
+                if(a-&gt;m_strText == text)
+                    break;
+                pos++;
+            }
+    assert(a&amp;&amp;&quot;Answer was not found in node!!!&quot;);
+    return pos;
 }
 
 void DialogEditor::removeAnswer()
-{		
-	WriteLog(&quot;DialogEditor::removeAnswer()\n&quot;);
-	QListViewItem * curAnsw = answersListView-&gt;currentItem();
-	if (!curAnsw)
-			return;
-	NodeItem * node = (NodeItem*)nodeListView-&gt;currentItem();
-	node-&gt;m_answers.remove(getPlayerAnswer(curAnsw-&gt;text(0)));
+{       
+    WriteLog(&quot;DialogEditor::removeAnswer()\n&quot;);
+    QListViewItem * curAnsw = answersListView-&gt;currentItem();
+    if (!curAnsw)
+            return;
+    NodeItem * node = (NodeItem*)nodeListView-&gt;currentItem();
+    node-&gt;m_answers.remove(getPlayerAnswer(curAnsw-&gt;text(0)));
 
-	delete curAnsw;
+    delete curAnsw;
 }
 
 void DialogEditor::removeNode()
 {
-	WriteLog(&quot;DialogEditor::removeNode()\n&quot;);
-	if(nodeListView-&gt;childCount()==1)
-		return;
-	
-	QListViewItem* item= nodeListView-&gt;currentItem();
-	QListViewItemIterator it( item );
-	it++;
-	if(it.current())
-	{
-		nodeListView-&gt;setCurrentItem(it.current());
-	}
-	else
-	{
-		QListViewItemIterator i( item );
-		i--;
-		nodeListView-&gt;setCurrentItem(i.current());
-	}
-	delete item;
+    WriteLog(&quot;DialogEditor::removeNode()\n&quot;);
+    if(nodeListView-&gt;childCount()==1)
+        return;
+    
+    QListViewItem* item= nodeListView-&gt;currentItem();
+    QListViewItemIterator it( item );
+    it++;
+    if(it.current())
+    {
+        nodeListView-&gt;setCurrentItem(it.current());
+    }
+    else
+    {
+        QListViewItemIterator i( item );
+        i--;
+        nodeListView-&gt;setCurrentItem(i.current());
+    }
+    delete item;
 }
 
 void DialogEditor::CreateNewNode()
 {
-	WriteLog(&quot;DialogEditor::CreateNewNode()\n&quot;);
-	int nodeCount = nodeListView-&gt;childCount();
-	
-	QString strId;
-	if (nodeCount)
-	{
-		int id = 0;
-		QListViewItem* item = nodeListView-&gt;firstChild ();
-		QListViewItemIterator it( item );
-		for(;it.current();it++)
-		{
-			if(it.current()-&gt;text(0).toInt()&gt;id)
-				id = it.current()-&gt;text(0).toInt();
-		}
-		strId.sprintf(&quot;%d&quot;,id+1);
-	}
-	else
-	{
-		strId = &quot;0&quot;;
-	}
-	NodeItem* critem = new NodeItem ( nodeListView ) ;
+    WriteLog(&quot;DialogEditor::CreateNewNode()\n&quot;);
+    int nodeCount = nodeListView-&gt;childCount();
+    
+    QString strId;
+    if (nodeCount)
+    {
+        int id = 0;
+        QListViewItem* item = nodeListView-&gt;firstChild ();
+        QListViewItemIterator it( item );
+        for(;it.current();it++)
+        {
+            if(it.current()-&gt;text(0).toInt()&gt;id)
+                id = it.current()-&gt;text(0).toInt();
+        }
+        strId.sprintf(&quot;%d&quot;,id+1);
+    }
+    else
+    {
+        strId = &quot;0&quot;;
+    }
+    NodeItem* critem = new NodeItem ( nodeListView ) ;
 
-	NodeItem * node = (NodeItem*)nodeListView-&gt;currentItem();
-	if(node)
-	{
-		critem-&gt;setFont(node-&gt;m_strFont);
-		critem-&gt;setPicture(node-&gt;m_strPicture);
-		critem-&gt;setTextLocation(node-&gt;m_strTextLocation);
-		critem-&gt;setMusic(node-&gt;m_strMusic);
-	}
-	critem-&gt;setName(&quot;New node name&quot;);
-	critem-&gt;setID( strId );
-	nodeListView-&gt;setCurrentItem(critem);
+    NodeItem * node = (NodeItem*)nodeListView-&gt;currentItem();
+    if(node)
+    {
+        critem-&gt;setFont(node-&gt;m_strFont);
+        critem-&gt;setPicture(node-&gt;m_strPicture);
+        critem-&gt;setTextLocation(node-&gt;m_strTextLocation);
+        critem-&gt;setMusic(node-&gt;m_strMusic);
+    }
+    critem-&gt;setName(&quot;New node name&quot;);
+    critem-&gt;setID( strId );
+    nodeListView-&gt;setCurrentItem(critem);
 }
 
 void DialogEditor::nodeChangedSlot(QListViewItem* i)
 {
-	WriteLog(&quot;DialogEditor::nodeChangedSlot\n&quot;);
-	NodeItem * node = (NodeItem*)i;
-	if (!i)
-		return;
+    WriteLog(&quot;DialogEditor::nodeChangedSlot\n&quot;);
+    NodeItem * node = (NodeItem*)i;
+    if (!i)
+        return;
 
-	// disconnect edits from previous
-	disconnect( nodeIdLineEdit,     0, 0, 0 );
-	disconnect( NodeNameLineEdit,   0, 0, 0 );
-	disconnect( MusicEdit,          0, 0, 0 );
-	disconnect( BackgroundLineEdit, 0, 0, 0 );
-	disconnect( textLocationLineEdit, 0, 0, 0 );
-	disconnect( fontLineEdit, 0, 0, 0 );
+    // disconnect edits from previous
+    disconnect( nodeIdLineEdit,     0, 0, 0 );
+    disconnect( NodeNameLineEdit,   0, 0, 0 );
+    disconnect( MusicEdit,          0, 0, 0 );
+    disconnect( BackgroundLineEdit, 0, 0, 0 );
+    disconnect( textLocationLineEdit, 0, 0, 0 );
+    disconnect( fontLineEdit, 0, 0, 0 );
 
-	connect( nodeIdLineEdit, SIGNAL( textChanged ( const QString&amp;)), 
-		node, SLOT(setID(const QString&amp;)));
-	connect( NodeNameLineEdit, SIGNAL( textChanged ( const QString&amp;)), 
-		node, SLOT(setName(const QString&amp;)));
-	connect( MusicEdit, SIGNAL( textChanged ( const QString&amp;)), 
-		node, SLOT(setMusic(const QString&amp;)));
-	connect( BackgroundLineEdit, SIGNAL( textChanged ( const QString&amp;)), 
-		node, SLOT(setPicture(const QString&amp;)));
-	connect( textLocationLineEdit, SIGNAL( textChanged ( const QString&amp;)), 
-		node, SLOT(setTextLocation(const QString&amp;)));
-	connect( fontLineEdit, SIGNAL( textChanged ( const QString&amp;)), 
-		node, SLOT(setFont(const QString&amp;)));
+    connect( nodeIdLineEdit, SIGNAL( textChanged ( const QString&amp;)), 
+        node, SLOT(setID(const QString&amp;)));
+    connect( NodeNameLineEdit, SIGNAL( textChanged ( const QString&amp;)), 
+        node, SLOT(setName(const QString&amp;)));
+    connect( MusicEdit, SIGNAL( textChanged ( const QString&amp;)), 
+        node, SLOT(setMusic(const QString&amp;)));
+    connect( BackgroundLineEdit, SIGNAL( textChanged ( const QString&amp;)), 
+        node, SLOT(setPicture(const QString&amp;)));
+    connect( textLocationLineEdit, SIGNAL( textChanged ( const QString&amp;)), 
+        node, SLOT(setTextLocation(const QString&amp;)));
+    connect( fontLineEdit, SIGNAL( textChanged ( const QString&amp;)), 
+        node, SLOT(setFont(const QString&amp;)));
 
-	nodeIdLineEdit      -&gt;setText(node-&gt;text(0));
-	NodeNameLineEdit    -&gt;setText(node-&gt;text(1));
-	MusicEdit           -&gt;setText(node-&gt;m_strMusic);
-	BackgroundLineEdit  -&gt;setText(node-&gt;m_strPicture);
-	textLocationLineEdit-&gt;setText(node-&gt;m_strTextLocation);
-	fontLineEdit        -&gt;setText(node-&gt;m_strFont);
+    nodeIdLineEdit      -&gt;setText(node-&gt;text(0));
+    NodeNameLineEdit    -&gt;setText(node-&gt;text(1));
+    MusicEdit           -&gt;setText(node-&gt;m_strMusic);
+    BackgroundLineEdit  -&gt;setText(node-&gt;m_strPicture);
+    textLocationLineEdit-&gt;setText(node-&gt;m_strTextLocation);
+    fontLineEdit        -&gt;setText(node-&gt;m_strFont);
 
-	// Set Browser
-	QString browserText;
-	browserText += &quot;&lt;HTML&gt;&lt;BODY&gt;&lt;CENTER&gt;&quot;;
-	if(node-&gt;m_strPicture!= &quot;&quot;)
-	{
-		browserText += QString(&quot;&quot;).sprintf(&quot;&lt;img width=\&quot;100\&quot; height=\&quot;100\&quot;&quot;
-			&quot;src=\&quot;alien\&quot; alt=\&quot;Home\&quot; border=\&quot;0\&quot;&gt;&lt;br&gt;&quot;);
-	}
+    // Set Browser
+    QString browserText;
+    browserText += &quot;&lt;HTML&gt;&lt;BODY&gt;&lt;CENTER&gt;&quot;;
+    if(node-&gt;m_strPicture!= &quot;&quot;)
+    {
+        browserText += QString(&quot;&quot;).sprintf(&quot;&lt;img width=\&quot;100\&quot; height=\&quot;100\&quot;&quot;
+            &quot;src=\&quot;alien\&quot; alt=\&quot;Home\&quot; border=\&quot;0\&quot;&gt;&lt;br&gt;&quot;);
+    }
 
-	browserText += node-&gt;m_strAlienText;
-	browserText += &quot;&lt;/CENTER&gt;&lt;/BODY&gt;&lt;/HTML&gt;&quot;;
+    browserText += node-&gt;m_strAlienText;
+    browserText += &quot;&lt;/CENTER&gt;&lt;/BODY&gt;&lt;/HTML&gt;&quot;;
 
-	alienTextBrowser-&gt;mimeSourceFactory()-&gt;setFilePath( QDir::currentDirPath() );
-	alienTextBrowser-&gt;mimeSourceFactory()-&gt;setImage(&quot;alien&quot;,QImage(BackgroundLineEdit-&gt;text()));
-	alienTextBrowser-&gt;setText(browserText);
+    alienTextBrowser-&gt;mimeSourceFactory()-&gt;setFilePath( QDir::currentDirPath() );
+    alienTextBrowser-&gt;mimeSourceFactory()-&gt;setImage(&quot;alien&quot;,QImage(BackgroundLineEdit-&gt;text()));
+    alienTextBrowser-&gt;setText(browserText);
 
-	// Set Answers
-	disconnectAnswer();
-	answersListView-&gt;clear();
-	for(PlayerAnswer * a = node-&gt;m_answers. last();
-		a; a = node-&gt;m_answers.prev())
-	{
-		if (script_check_condition(a-&gt;m_strAppearCondition) || !TestModeCheckBox-&gt;isChecked ())
-			QListViewItem * item = new QListViewItem(answersListView,a-&gt;m_strText);
-	//	answersListView     -&gt;setCurrentItem(item);
-	}
+    // Set Answers
+    disconnectAnswer();
+    answersListView-&gt;clear();
+    for(PlayerAnswer * a = node-&gt;m_answers. last();
+        a; a = node-&gt;m_answers.prev())
+    {
+      if (script_check_condition(a-&gt;m_strAppearCondition) || 1/*!TestModeCheckBox-&gt;isChecked ()*/)
+            QListViewItem * item = new QListViewItem(answersListView,a-&gt;m_strText);
+    //  answersListView     -&gt;setCurrentItem(item);
+    }
 }
 
 
 void DialogEditor::disconnectAnswer()
 {
-	WriteLog(&quot;DialogEditor::disconnectAnswer()\n&quot;);
-	disconnect(condition1LineEdit, 0, 0, 0);
-	condition1LineEdit-&gt;setText(&quot;&quot;);
-	condition1LineEdit-&gt;setEnabled(FALSE);
-	disconnect(condition2LineEdit, 0, 0, 0);
-	condition2LineEdit-&gt;setText(&quot;&quot;);
-	condition2LineEdit-&gt;setEnabled(FALSE);
-	disconnect(condition3LineEdit, 0, 0, 0);
-	condition3LineEdit-&gt;setText(&quot;&quot;);
-	condition3LineEdit-&gt;setEnabled(FALSE);
-	disconnect(condition4LineEdit, 0, 0, 0);
-	condition4LineEdit-&gt;setText(&quot;&quot;);
-	condition4LineEdit-&gt;setEnabled(FALSE);
-	disconnect(condition5LineEdit, 0, 0, 0);
-	condition5LineEdit-&gt;setText(&quot;&quot;);
-	condition5LineEdit-&gt;setEnabled(FALSE);
+    WriteLog(&quot;DialogEditor::disconnectAnswer()\n&quot;);
+    disconnect(condition1LineEdit, 0, 0, 0);
+    condition1LineEdit-&gt;setText(&quot;&quot;);
+    condition1LineEdit-&gt;setEnabled(FALSE);
+    disconnect(condition2LineEdit, 0, 0, 0);
+    condition2LineEdit-&gt;setText(&quot;&quot;);
+    condition2LineEdit-&gt;setEnabled(FALSE);
+    disconnect(condition3LineEdit, 0, 0, 0);
+    condition3LineEdit-&gt;setText(&quot;&quot;);
+    condition3LineEdit-&gt;setEnabled(FALSE);
+    disconnect(condition4LineEdit, 0, 0, 0);
+    condition4LineEdit-&gt;setText(&quot;&quot;);
+    condition4LineEdit-&gt;setEnabled(FALSE);
+    disconnect(condition5LineEdit, 0, 0, 0);
+    condition5LineEdit-&gt;setText(&quot;&quot;);
+    condition5LineEdit-&gt;setEnabled(FALSE);
 
-	disconnect(action1LineEdit, 0, 0, 0);
-	action1LineEdit-&gt;setText(&quot;&quot;);
-	action1LineEdit-&gt;setEnabled(FALSE);
-	disconnect(action2LineEdit, 0, 0, 0);
-	action2LineEdit-&gt;setText(&quot;&quot;);
-	action2LineEdit-&gt;setEnabled(FALSE);
-	disconnect(action3LineEdit, 0, 0, 0);
-	action3LineEdit-&gt;setText(&quot;&quot;);
-	action3LineEdit-&gt;setEnabled(FALSE);
-	disconnect(action4LineEdit, 0, 0, 0);
-	action4LineEdit-&gt;setText(&quot;&quot;);
-	action4LineEdit-&gt;setEnabled(FALSE);
-	disconnect(action5LineEdit, 0, 0, 0);
-	action5LineEdit-&gt;setText(&quot;&quot;);
-	action5LineEdit-&gt;setEnabled(FALSE);
+    disconnect(action1LineEdit, 0, 0, 0);
+    action1LineEdit-&gt;setText(&quot;&quot;);
+    action1LineEdit-&gt;setEnabled(FALSE);
+    disconnect(action2LineEdit, 0, 0, 0);
+    action2LineEdit-&gt;setText(&quot;&quot;);
+    action2LineEdit-&gt;setEnabled(FALSE);
+    disconnect(action3LineEdit, 0, 0, 0);
+    action3LineEdit-&gt;setText(&quot;&quot;);
+    action3LineEdit-&gt;setEnabled(FALSE);
+    disconnect(action4LineEdit, 0, 0, 0);
+    action4LineEdit-&gt;setText(&quot;&quot;);
+    action4LineEdit-&gt;setEnabled(FALSE);
+    disconnect(action5LineEdit, 0, 0, 0);
+    action5LineEdit-&gt;setText(&quot;&quot;);
+    action5LineEdit-&gt;setEnabled(FALSE);
 
-	disconnect(appearConditionLineEdit, 0, 0, 0);
-	appearConditionLineEdit-&gt;setText(&quot;&quot;);
-	appearConditionLineEdit-&gt;setEnabled(FALSE);
+    disconnect(appearConditionLineEdit, 0, 0, 0);
+    appearConditionLineEdit-&gt;setText(&quot;&quot;);
+    appearConditionLineEdit-&gt;setEnabled(FALSE);
 }
 
 
 void DialogEditor::answerChangedSlot(QListViewItem* item)
 {
-	WriteLog(&quot;DialogEditor::answerChangedSlot(QListViewItem* item)\n&quot;);
-	disconnectAnswer();
-	if(!item)
-	{
-		condition1LineEdit-&gt;setEnabled ( FALSE ) ;
-		return;
-	}
-	
+    WriteLog(&quot;DialogEditor::answerChangedSlot(QListViewItem* item)\n&quot;);
+    disconnectAnswer();
+    if(!item)
+    {
+        condition1LineEdit-&gt;setEnabled ( FALSE ) ;
+        return;
+    }
+    
 
-	PlayerAnswer * pa = getPlayerAnswer(item-&gt;text(0));
+    PlayerAnswer * pa = getPlayerAnswer(item-&gt;text(0));
 
-	connect( condition1LineEdit, SIGNAL( textChanged ( const QString&amp;)), 
-		pa, SLOT(setCondition1Line(const QString&amp;)));
-	condition1LineEdit-&gt;setEnabled(TRUE);
-	connect( condition2LineEdit, SIGNAL( textChanged ( const QString&amp;)), 
-		pa, SLOT(setCondition2Line(const QString&amp;)));
-	condition2LineEdit-&gt;setEnabled(TRUE);
-	connect( condition3LineEdit, SIGNAL( textChanged ( const QString&amp;)), 
-		pa, SLOT(setCondition3Line(const QString&amp;)));
-	condition3LineEdit-&gt;setEnabled(TRUE);
-	connect( condition4LineEdit, SIGNAL( textChanged ( const QString&amp;)), 
-		pa, SLOT(setCondition4Line(const QString&amp;)));
-	condition4LineEdit-&gt;setEnabled(TRUE);
-	connect( condition5LineEdit, SIGNAL( textChanged ( const QString&amp;)), 
-		pa, SLOT(setCondition5Line(const QString&amp;)));
-	condition5LineEdit-&gt;setEnabled(TRUE);
+    connect( condition1LineEdit, SIGNAL( textChanged ( const QString&amp;)), 
+        pa, SLOT(setCondition1Line(const QString&amp;)));
+    condition1LineEdit-&gt;setEnabled(TRUE);
+    connect( condition2LineEdit, SIGNAL( textChanged ( const QString&amp;)), 
+        pa, SLOT(setCondition2Line(const QString&amp;)));
+    condition2LineEdit-&gt;setEnabled(TRUE);
+    connect( condition3LineEdit, SIGNAL( textChanged ( const QString&amp;)), 
+        pa, SLOT(setCondition3Line(const QString&amp;)));
+    condition3LineEdit-&gt;setEnabled(TRUE);
+    connect( condition4LineEdit, SIGNAL( textChanged ( const QString&amp;)), 
+        pa, SLOT(setCondition4Line(const QString&amp;)));
+    condition4LineEdit-&gt;setEnabled(TRUE);
+    connect( condition5LineEdit, SIGNAL( textChanged ( const QString&amp;)), 
+        pa, SLOT(setCondition5Line(const QString&amp;)));
+    condition5LineEdit-&gt;setEnabled(TRUE);
 
-	connect( action1LineEdit, SIGNAL( textChanged ( const QString&amp;)), 
-		pa, SLOT(setAction1Line(const QString&amp;)));
-	action1LineEdit-&gt;setEnabled(TRUE);
-	connect( action2LineEdit, SIGNAL( textChanged ( const QString&amp;)), 
-		pa, SLOT(setAction2Line(const QString&amp;)));
-	action2LineEdit-&gt;setEnabled(TRUE);
-	connect( action3LineEdit, SIGNAL( textChanged ( const QString&amp;)), 
-		pa, SLOT(setAction3Line(const QString&amp;)));
-	action3LineEdit-&gt;setEnabled(TRUE);
-	connect( action4LineEdit, SIGNAL( textChanged ( const QString&amp;)), 
-		pa, SLOT(setAction4Line(const QString&amp;)));
-	action4LineEdit-&gt;setEnabled(TRUE);
-	connect( action5LineEdit, SIGNAL( textChanged ( const QString&amp;)), 
-		pa, SLOT(setAction5Line(const QString&amp;)));
-	action5LineEdit-&gt;setEnabled(TRUE);
+    connect( action1LineEdit, SIGNAL( textChanged ( const QString&amp;)), 
+        pa, SLOT(setAction1Line(const QString&amp;)));
+    action1LineEdit-&gt;setEnabled(TRUE);
+    connect( action2LineEdit, SIGNAL( textChanged ( const QString&amp;)), 
+        pa, SLOT(setAction2Line(const QString&amp;)));
+    action2LineEdit-&gt;setEnabled(TRUE);
+    connect( action3LineEdit, SIGNAL( textChanged ( const QString&amp;)), 
+        pa, SLOT(setAction3Line(const QString&amp;)));
+    action3LineEdit-&gt;setEnabled(TRUE);
+    connect( action4LineEdit, SIGNAL( textChanged ( const QString&amp;)), 
+        pa, SLOT(setAction4Line(const QString&amp;)));
+    action4LineEdit-&gt;setEnabled(TRUE);
+    connect( action5LineEdit, SIGNAL( textChanged ( const QString&amp;)), 
+        pa, SLOT(setAction5Line(const QString&amp;)));
+    action5LineEdit-&gt;setEnabled(TRUE);
 
-	connect( appearConditionLineEdit, SIGNAL( textChanged ( const QString&amp;)), 
-		pa, SLOT(setAppearCondition(const QString&amp;)));
-	appearConditionLineEdit-&gt;setEnabled(TRUE);
+    connect( appearConditionLineEdit, SIGNAL( textChanged ( const QString&amp;)), 
+        pa, SLOT(setAppearCondition(const QString&amp;)));
+    appearConditionLineEdit-&gt;setEnabled(TRUE);
 
-	condition1LineEdit-&gt;setText(pa-&gt;m_strCond[0]);
-	condition2LineEdit-&gt;setText(pa-&gt;m_strCond[1]);
-	condition3LineEdit-&gt;setText(pa-&gt;m_strCond[2]);
-	condition4LineEdit-&gt;setText(pa-&gt;m_strCond[3]);
-	condition5LineEdit-&gt;setText(pa-&gt;m_strCond[4]);
+    condition1LineEdit-&gt;setText(pa-&gt;m_strCond[0]);
+    condition2LineEdit-&gt;setText(pa-&gt;m_strCond[1]);
+    condition3LineEdit-&gt;setText(pa-&gt;m_strCond[2]);
+    condition4LineEdit-&gt;setText(pa-&gt;m_strCond[3]);
+    condition5LineEdit-&gt;setText(pa-&gt;m_strCond[4]);
 
-	action1LineEdit-&gt;setText(pa-&gt;m_strAct[0]);
-	action2LineEdit-&gt;setText(pa-&gt;m_strAct[1]);
-	action3LineEdit-&gt;setText(pa-&gt;m_strAct[2]);
-	action4LineEdit-&gt;setText(pa-&gt;m_strAct[3]);
-	action5LineEdit-&gt;setText(pa-&gt;m_strAct[4]);
+    action1LineEdit-&gt;setText(pa-&gt;m_strAct[0]);
+    action2LineEdit-&gt;setText(pa-&gt;m_strAct[1]);
+    action3LineEdit-&gt;setText(pa-&gt;m_strAct[2]);
+    action4LineEdit-&gt;setText(pa-&gt;m_strAct[3]);
+    action5LineEdit-&gt;setText(pa-&gt;m_strAct[4]);
 
-	appearConditionLineEdit-&gt;setText(pa-&gt;m_strAppearCondition);
+    appearConditionLineEdit-&gt;setText(pa-&gt;m_strAppearCondition);
 
-	commonMultiLineEdit-&gt;setText(item-&gt;text(0));
+    commonMultiLineEdit-&gt;setText(item-&gt;text(0));
 }
 
 QString DialogEditor::GetXML()
 {
-	WriteLog(&quot;DialogEditor::edited()\n&quot;);
-	QString strRes;
-	strRes += &quot;&lt;NODES&gt;&quot;;
-	QListViewItem* item = nodeListView-&gt;firstChild ();
-	QListViewItemIterator it( item );
-	for(;it.current();it++)
-	{
-		NodeItem *item = (NodeItem*)it.current();
-		strRes += &quot;&lt;NODE id=\&quot;&quot;   + TWEscapeXML(item-&gt;text(0)) + &quot;\&quot;&quot;;
-		strRes += &quot; name=\&quot;&quot;      + TWEscapeXML(item-&gt;text(1)) + &quot;\&quot;&quot;;
-		strRes += &quot; music=\&quot;&quot;     + TWEscapeXML(item-&gt;m_strMusic) + &quot;\&quot;&quot;;
-		strRes += &quot; background=\&quot;&quot;+ TWEscapeXML(item-&gt;m_strPicture) + &quot;\&quot;&quot;;
-		strRes += &quot; alien_text=\&quot;&quot;+ TWEscapeXML(item-&gt;m_strAlienText) + &quot;\&quot;&quot;;
-		strRes += &quot; font=\&quot;&quot;+ TWEscapeXML(item-&gt;m_strFont) + &quot;\&quot;&quot;;
-		strRes += &quot; text_location=\&quot;&quot;+ TWEscapeXML(item-&gt;m_strTextLocation) + &quot;\&quot;&quot;;
-		strRes += &quot;&gt;&quot;;
+    WriteLog(&quot;DialogEditor::edited()\n&quot;);
+    QString strRes;
+    strRes += &quot;&lt;DIALOG&gt;&quot;;
 
+    strRes += &quot;&lt;START_DIALOG&gt;&quot;;
+    if(!startDialogCode_textEdit-&gt;text().isEmpty())
+      {
+        strRes += &quot;&lt;ACTION &quot;;
+        strRes += &quot;condition=\&quot;&quot; + TWEscapeXML(&quot;1&quot;) + &quot;\&quot; &quot;;
+        strRes += &quot;action=\&quot;&quot; + TWEscapeXML(startDialogCode_textEdit-&gt;text()) + &quot;\&quot;&gt;&quot;;
+        strRes += &quot;&lt;/ACTION&gt;&quot;;
+      }
+    strRes += &quot;&lt;/START_DIALOG&gt;&quot;;
 
-		for(PlayerAnswer * a = item-&gt;m_answers.first();
-			a; a = item-&gt;m_answers.next())
-		{	
-			strRes +=&quot;&lt;PLAYER_ANSWER &quot;;
-			strRes +=&quot;text=\&quot;&quot; + TWEscapeXML(a-&gt;m_strText) + &quot;\&quot; &quot;;
-			strRes +=&quot;appear_condition=\&quot;&quot; + TWEscapeXML(a-&gt;m_strAppearCondition) + &quot;\&quot;&gt;&quot;;
-			
-			for(int j=0;j&lt;5;j++)
-				if( !(a-&gt;m_strCond[j].isEmpty()) &amp;&amp; !(a-&gt;m_strAct[j].isEmpty()))
-				{
-					strRes += &quot;&lt;ACTION &quot;;
-					strRes += &quot;condition=\&quot;&quot; + TWEscapeXML(a-&gt;m_strCond[j]) + &quot;\&quot; &quot;;
-					strRes += &quot;action=\&quot;&quot; + TWEscapeXML(a-&gt;m_strAct[j]) + &quot;\&quot;&gt;&quot;;
-					strRes += &quot;&lt;/ACTION&gt;&quot;;
-				}
-			strRes +=&quot;&lt;/PLAYER_ANSWER&gt;&quot;;
-		}
-		strRes += &quot;&lt;/NODE&gt;&quot;;
-	}
-	strRes += &quot;&lt;/NODES&gt;&quot;;
-	return strRes;
+    strRes += &quot;&lt;END_DIALOG&gt;&quot;;
+    if(!startDialogCode_textEdit-&gt;text().isEmpty())
+      {
+        strRes += &quot;&lt;ACTION &quot;;
+        strRes += &quot;condition=\&quot;&quot; + TWEscapeXML(&quot;1&quot;) + &quot;\&quot; &quot;;
+        strRes += &quot;action=\&quot;&quot; + TWEscapeXML(endDialogCode_textEdit-&gt;text()) + &quot;\&quot;&gt;&quot;;
+        strRes += &quot;&lt;/ACTION&gt;&quot;;
+      }
+    strRes += &quot;&lt;/END_DIALOG&gt;&quot;;
+
+    strRes += &quot;&lt;NODES&gt;&quot;;
+    QListViewItem* item = nodeListView-&gt;firstChild ();
+    QListViewItemIterator it( item );
+    for(;it.current();it++)
+    {
+        NodeItem *item = (NodeItem*)it.current();
+        strRes += &quot;&lt;NODE id=\&quot;&quot;   + TWEscapeXML(item-&gt;text(0)) + &quot;\&quot;&quot;;
+        strRes += &quot; name=\&quot;&quot;      + TWEscapeXML(item-&gt;text(1)) + &quot;\&quot;&quot;;
+        strRes += &quot; music=\&quot;&quot;     + TWEscapeXML(item-&gt;m_strMusic) + &quot;\&quot;&quot;;
+        strRes += &quot; background=\&quot;&quot;+ TWEscapeXML(item-&gt;m_strPicture) + &quot;\&quot;&quot;;
+        strRes += &quot; alien_text=\&quot;&quot;+ TWEscapeXML(item-&gt;m_strAlienText) + &quot;\&quot;&quot;;
+        strRes += &quot; font=\&quot;&quot;+ TWEscapeXML(item-&gt;m_strFont) + &quot;\&quot;&quot;;
+        strRes += &quot; text_location=\&quot;&quot;+ TWEscapeXML(item-&gt;m_strTextLocation) + &quot;\&quot;&quot;;
+        strRes += &quot;&gt;&quot;;
+
+
+        for(PlayerAnswer * a = item-&gt;m_answers.first();
+            a; a = item-&gt;m_answers.next())
+        {   
+            strRes +=&quot;&lt;PLAYER_ANSWER &quot;;
+            strRes +=&quot;text=\&quot;&quot; + TWEscapeXML(a-&gt;m_strText) + &quot;\&quot; &quot;;
+            strRes +=&quot;appear_condition=\&quot;&quot; + TWEscapeXML(a-&gt;m_strAppearCondition) + &quot;\&quot;&gt;&quot;;
+            
+            for(int j=0;j&lt;5;j++)
+                if( !(a-&gt;m_strCond[j].isEmpty()) &amp;&amp; !(a-&gt;m_strAct[j].isEmpty()))
+                {
+                    strRes += &quot;&lt;ACTION &quot;;
+                    strRes += &quot;condition=\&quot;&quot; + TWEscapeXML(a-&gt;m_strCond[j]) + &quot;\&quot; &quot;;
+                    strRes += &quot;action=\&quot;&quot; + TWEscapeXML(a-&gt;m_strAct[j]) + &quot;\&quot;&gt;&quot;;
+                    strRes += &quot;&lt;/ACTION&gt;&quot;;
+                }
+            strRes +=&quot;&lt;/PLAYER_ANSWER&gt;&quot;;
+        }
+        strRes += &quot;&lt;/NODE&gt;&quot;;
+    }
+    strRes += &quot;&lt;/NODES&gt;&quot;;
+    strRes += &quot;&lt;/DIALOG&gt;&quot;;
+    return strRes;
 }
 
 void DialogEditor::loadDoc(QString fileName)
@@ -366,11 +390,11 @@
 
   if(fileName.find(&quot;.xml&quot;, 0, FALSE)==-1)
   {
-	  QString mes;
-	  mes.sprintf(&quot;file:\n%s\nDoes not have xml extension&quot;, (const char*)fileName);
+      QString mes;
+      mes.sprintf(&quot;file:\n%s\nDoes not have xml extension&quot;, (const char*)fileName);
 
-	  QMessageBox::warning (this, &quot;TW-Light editor&quot;,
-			mes);
+      QMessageBox::warning (this, &quot;TW-Light editor&quot;,
+            mes);
   }
 
   QFile f(fileName);
@@ -381,141 +405,143 @@
   reader.setContentHandler( &amp;handler );
   reader.parse( source );
   if(nodeListView-&gt; childCount ())
-	nodeListView-&gt;setCurrentItem( nodeListView-&gt;firstChild ());
+    nodeListView-&gt;setCurrentItem( nodeListView-&gt;firstChild ());
 }
 
 void DialogEditor::setAlienText()
 {
-	WriteLog(&quot;DialogEditor::setAlienText()\n&quot;);
-	NodeItem * node = (NodeItem*)nodeListView-&gt;currentItem();
-	node-&gt;m_strAlienText = commonMultiLineEdit-&gt;text();
-	nodeChangedSlot(node);
+    WriteLog(&quot;DialogEditor::setAlienText()\n&quot;);
+    NodeItem * node = (NodeItem*)nodeListView-&gt;currentItem();
+    node-&gt;m_strAlienText = commonMultiLineEdit-&gt;text();
+    nodeChangedSlot(node);
 }
 
 void DialogEditor::setPlayerAnswerText()
 {
-	WriteLog(&quot;DialogEditor::setPlayerAnswerText()\n&quot;);
-	QListViewItem * curAnsw = answersListView-&gt;currentItem();
-	if(!curAnsw)
-		return;
-	PlayerAnswer * pa = getPlayerAnswer(curAnsw-&gt;text(0));
-	pa-&gt;m_strText = commonMultiLineEdit-&gt;text();
-	curAnsw-&gt;setText(0, commonMultiLineEdit-&gt;text());
+    WriteLog(&quot;DialogEditor::setPlayerAnswerText()\n&quot;);
+    QListViewItem * curAnsw = answersListView-&gt;currentItem();
+    if(!curAnsw)
+        return;
+    PlayerAnswer * pa = getPlayerAnswer(curAnsw-&gt;text(0));
+    pa-&gt;m_strText = commonMultiLineEdit-&gt;text();
+    curAnsw-&gt;setText(0, commonMultiLineEdit-&gt;text());
 }
 
 void DialogEditor::AddPlayerAnswer()
 {
-	WriteLog(&quot;DialogEditor::AddPlayerAnswer()\n&quot;);
-	NodeItem * node = (NodeItem*)nodeListView-&gt;currentItem();
-	PlayerAnswer * item = new PlayerAnswer;
-	item-&gt;m_strText = commonMultiLineEdit-&gt;text();
-	item-&gt;m_strAppearCondition = &quot;1&quot;;
+    WriteLog(&quot;DialogEditor::AddPlayerAnswer()\n&quot;);
+    NodeItem * node = (NodeItem*)nodeListView-&gt;currentItem();
+    PlayerAnswer * item = new PlayerAnswer;
+    item-&gt;m_strText = commonMultiLineEdit-&gt;text();
+    item-&gt;m_strAppearCondition = &quot;1&quot;;
 
-	node-&gt;m_answers.append(item);
-	nodeChangedSlot(node);
+    node-&gt;m_answers.append(item);
+    nodeChangedSlot(node);
 }
 
 // To be implemented
 bool DialogEditor::script_check_condition(const QString &amp; condition)
 {
-	WriteLog(&quot;DialogEditor::script_check_condition(QString &amp; condition)\n&quot;);
-	return true;
+    WriteLog(&quot;DialogEditor::script_check_condition(QString &amp; condition)\n&quot;);
+    return true;
 }
 
 NodeItem * DialogEditor::getNodeItem(const QString&amp; id)
 {
-	WriteLog(&quot;DialogEditor::getNodeItem(QString&amp; id)\n&quot;);
-	QListViewItem* item = nodeListView-&gt;firstChild ();
-	QListViewItemIterator it( item );
-	for(;it.current();it++)
-	{
-		if(it.current()-&gt;text(0) == id)
-			return (NodeItem *)it.current();
-	}
-	return NULL;
+    WriteLog(&quot;DialogEditor::getNodeItem(QString&amp; id)\n&quot;);
+    QListViewItem* item = nodeListView-&gt;firstChild ();
+    QListViewItemIterator it( item );
+    for(;it.current();it++)
+    {
+        if(it.current()-&gt;text(0) == id)
+            return (NodeItem *)it.current();
+    }
+    return NULL;
 }
 
 
 void DialogEditor::processAnswerSlot(QListViewItem* item)
 {
-	WriteLog(&quot;DialogEditor::processAnswerSlot(QListViewItem* item)\n&quot;);
-	PlayerAnswer* answer = getPlayerAnswer(item-&gt;text(0));
-	for(int i=0;i&lt;5;i++)
-	{
-			lua_State * L = lua_open();
-			lua_baselibopen(L);
-			lua_iolibopen(L);
-			lua_strlibopen(L);
-			lua_mathlibopen(L);
-			bool eva = lua_dostring(L, &quot;function goto(id) gotoid = id; end&quot;);
-			eva = lua_dostring(L, answer-&gt;m_strAct[i]);
-			lua_getglobal(L, &quot;gotoid&quot;);
-			if (lua_isstring(L, -1)) 
-			{
-				const char * id = lua_tostring(L, -1);
-				NodeItem * node = getNodeItem(QString(id));
-				if(node)
-					nodeListView-&gt;setCurrentItem(node);
-			}
-			lua_close(L);
-	}
+    WriteLog(&quot;DialogEditor::processAnswerSlot(QListViewItem* item)\n&quot;);
+    PlayerAnswer* answer = getPlayerAnswer(item-&gt;text(0));
+    for(int i=0;i&lt;5;i++)
+    {
+    /*
+            lua_State * L = lua_open();
+            lua_baselibopen(L);
+            lua_iolibopen(L);
+            lua_strlibopen(L);
+            lua_mathlibopen(L);
+            bool eva = lua_dostring(L, &quot;function goto(id) gotoid = id; end&quot;);
+            eva = lua_dostring(L, answer-&gt;m_strAct[i]);
+            lua_getglobal(L, &quot;gotoid&quot;);
+            if (lua_isstring(L, -1)) 
+            {
+                const char * id = lua_tostring(L, -1);
+                NodeItem * node = getNodeItem(QString(id));
+                if(node)
+                    nodeListView-&gt;setCurrentItem(node);
+            }
+            lua_close(L);
+     */
+    }
 }
 
 void DialogEditor::answerUp()
 {
-	NodeItem * node = (NodeItem*)nodeListView-&gt;currentItem();
-	QListViewItem * item = answersListView-&gt;currentItem();
+    NodeItem * node = (NodeItem*)nodeListView-&gt;currentItem();
+    QListViewItem * item = answersListView-&gt;currentItem();
 
-	if(!node || !item)
-		return;
-	
-	int pos = getPlayerAnswerPos(item-&gt;text(0));
-	if(pos==0)
-		return;
-	
-	QString strText = item-&gt;text(0);
-	PlayerAnswer* answer = node-&gt;m_answers.take(pos);
-	node-&gt;m_answers.insert(pos-1, answer);
+    if(!node || !item)
+        return;
+    
+    int pos = getPlayerAnswerPos(item-&gt;text(0));
+    if(pos==0)
+        return;
+    
+    QString strText = item-&gt;text(0);
+    PlayerAnswer* answer = node-&gt;m_answers.take(pos);
+    node-&gt;m_answers.insert(pos-1, answer);
 
-	nodeChangedSlot(node);	
+    nodeChangedSlot(node);  
 
-	QListViewItemIterator it( answersListView-&gt;firstChild () );
-	for(;it.current();it++)
-	{
-		if(it.current()-&gt;text(0)==strText)
-		{
-			answersListView-&gt;setCurrentItem(it.current());
-			break;
-		}
-	}
+    QListViewItemIterator it( answersListView-&gt;firstChild () );
+    for(;it.current();it++)
+    {
+        if(it.current()-&gt;text(0)==strText)
+        {
+            answersListView-&gt;setCurrentItem(it.current());
+            break;
+        }
+    }
 }
 
 void DialogEditor::answerDown()
 {
-	NodeItem * node = (NodeItem*)nodeListView-&gt;currentItem();
-	QListViewItem * item = answersListView-&gt;currentItem();
-	
-	if(!node || !item)
-		return;
+    NodeItem * node = (NodeItem*)nodeListView-&gt;currentItem();
+    QListViewItem * item = answersListView-&gt;currentItem();
+    
+    if(!node || !item)
+        return;
 
-	int pos = getPlayerAnswerPos(item-&gt;text(0));
-	if(pos==node-&gt;m_answers.count()-1 )
-		return;
-	
-	QString strText = item-&gt;text(0);
+    int pos = getPlayerAnswerPos(item-&gt;text(0));
+    if(pos==node-&gt;m_answers.count()-1 )
+        return;
+    
+    QString strText = item-&gt;text(0);
 
-	PlayerAnswer* answer = node-&gt;m_answers.take(pos);
-	node-&gt;m_answers.insert(pos+1, answer);
+    PlayerAnswer* answer = node-&gt;m_answers.take(pos);
+    node-&gt;m_answers.insert(pos+1, answer);
 
-	nodeChangedSlot(node);	
-	QListViewItemIterator it( answersListView-&gt;firstChild () );
-	for(;it.current();it++)
-	{
-		if(it.current()-&gt;text(0)==strText)
-		{
-			answersListView-&gt;setCurrentItem(it.current());
-			break;
-		}
-	}
+    nodeChangedSlot(node);  
+    QListViewItemIterator it( answersListView-&gt;firstChild () );
+    for(;it.current();it++)
+    {
+        if(it.current()-&gt;text(0)==strText)
+        {
+            answersListView-&gt;setCurrentItem(it.current());
+            break;
+        }
+    }
 }
 

Modified: trunk/Util/deditor/xmlparser.cpp
===================================================================
--- trunk/Util/deditor/xmlparser.cpp	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/Util/deditor/xmlparser.cpp	2005-08-06 18:09:53 UTC (rev 175)
@@ -1,6 +1,7 @@
 #include &quot;xmlparser.h&quot;
-#include &lt;iostream.h&gt;
+#include &lt;iostream&gt;
 #include &lt;qstring.h&gt;
+#include &lt;qtextedit.h&gt;
 #include &lt;qlineedit.h&gt;
 #include &lt;qmessagebox.h&gt; 
 #include &lt;assert.h&gt;
@@ -29,7 +30,16 @@
                                     const QXmlAttributes&amp; attr)
 {
 	WriteLog(&quot;XMLParser::startElement\n&quot;);
-	if (qName==&quot;NODES&quot;)
+	if(qName==&quot;DIALOG&quot;)
+	  {
+	  }
+	else if(qName==&quot;START_DIALOG&quot;)
+	  {
+	  }
+	else if (qName==&quot;END_DIALOG&quot;)
+	  {
+	  }
+	else if (qName==&quot;NODES&quot;)
 	{
 	}
 	else if (qName==&quot;NODE&quot;)
@@ -119,12 +129,6 @@
 	}
 	else if(qName==&quot;ACTION&quot;)
 	{
-		assert(curAnswer);
-		int j;
-		for(j=0; j&lt;5;j++)
-			if(curAnswer-&gt;m_strAct[j].isEmpty()&amp;&amp;
-			   curAnswer-&gt;m_strCond[j].isEmpty())
-			    break;
 		QString strCondition = &quot;&quot;;
 		QString strAction    = &quot;&quot;;
 		for(int i=0; i&lt; attr.length();i++)
@@ -144,24 +148,44 @@
 				QString(&quot;Unknown attribute: &quot;) + attr.localName(i));
 			}
 		}
-		curAnswer-&gt;m_strAct[j] = strAction;
-		curAnswer-&gt;m_strCond[j] = strCondition;
+		if(prev_node == &quot;START_DIALOG&quot;)
+		  {
+		    m_dialogEditor-&gt;startDialogCode_textEdit-&gt;setText(strAction);
+		  }
+		else if(prev_node == &quot;END_DIALOG&quot;)
+		  {
+		    m_dialogEditor-&gt;endDialogCode_textEdit-&gt;setText(strAction);
+		  }
+		else
+		  {	  
+		    assert(curAnswer);
+		    for(int j=0; j&lt;5;j++)
+		      {
+			if(curAnswer-&gt;m_strAct[j].isEmpty()&amp;&amp;
+			   curAnswer-&gt;m_strCond[j].isEmpty())
+			  {
+			    curAnswer-&gt;m_strAct[j] = strAction;
+			    curAnswer-&gt;m_strCond[j] = strCondition;
+			    break;
+			  }
+		      }
+		  }
 	}
 	else
 	{
 		QMessageBox::warning (m_dialogEditor, &quot;TW-Light editor&quot;,
 			QString(&quot;Unknown Node: &quot;) + qName);
 	}
-
-    return TRUE;
+	prev_node = qName;
+	return TRUE;
 }
 
 bool XMLParser::endElement( const QString &amp; namespaceURI, const QString &amp; localName, const QString &amp; qName ) 
 {
 	WriteLog(&quot;XMLParser::endElement\n&quot;);
 	if(qName==&quot;NODES&quot;)
-	{
-	}
+	  {
+	  }
 	else if (qName==&quot;NODE&quot;)
 	{
 		m_dialogEditor-&gt;nodeListView-&gt;setCurrentItem(curNode);
@@ -175,6 +199,15 @@
 	else if(qName==&quot;ACTION&quot;)
 	{
 	}
+	else if (qName==&quot;START_DIALOG&quot;)
+	  {
+	  }
+	else if(qName==&quot;END_DIALOG&quot;)
+	  {
+	  }
+	else if(qName==&quot;DIALOG&quot;)
+	  {
+	  }
 	else
 	{
 		QMessageBox::warning (m_dialogEditor, &quot;TW-Light editor&quot;,

Modified: trunk/Util/deditor/xmlparser.h
===================================================================
--- trunk/Util/deditor/xmlparser.h	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/Util/deditor/xmlparser.h	2005-08-06 18:09:53 UTC (rev 175)
@@ -15,6 +15,7 @@
 
 	NodeItem * curNode;
 	PlayerAnswer * curAnswer;
+	QString prev_node;
 public:
 	XMLParser(DialogEditor* editor);
     bool startDocument();

Modified: trunk/gamedata/default_ini/client.ini
===================================================================
--- trunk/gamedata/default_ini/client.ini	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/gamedata/default_ini/client.ini	2005-08-06 18:09:53 UTC (rev 175)
@@ -1,68 +1,68 @@
-[System]
-AutoUnload = 0
-
-[Video]
-ScreenWidth = 800
-ScreenHeight = 600
-
-BitsPerPixel = 32
-;valid = values are 8 (ugly), 15, 16, 24 (slow), and 32
-
-FullScreen = 1
-; = 0 = windowed, 1 = fullscreen
-
-;This will select the theme by its string name. The names for the non-bitmap
-;themes are: &quot;GTK&quot;, &quot;Win95&quot;, &quot;Photon&quot;, &quot;BeOS&quot;, &quot;NeXTStep&quot;, &quot;ASE&quot;, &quot;Allegro&quot;.
-GuiTheme = Photon
-
-Gamma = 45
-;gamma = gamma correction, should be between 0 and 255
-
-
-
-[Sound]
-SoundVolume = 0.5
-MusicVolume = 0.5
-SoundBuffer = 1024
-
-
-[Planet]
-PlanetDimension = 3
-PlanetUsespec = 1
-
-[View]
-View = Enemy
-;determines = where the camera goes
-InterpolateFrames = 1
-;0 = low quality, 1 = high quality
-Mip_min = 0
-;from = 0 to 3?  0 = normal, 1 = low quality, 2 = very low quality, ...
-Mip_max = 10
-;from = 0 to 3?  0 = high quality, 99 = normal
-Mip_bias = 0
-;from = -3? to 3?  0 = normal, -1 = high quality, 1 = low quality, 2 = very low quality
-;(Hero, = Enemy, Enemy_Discrete, Split, Everything)
-MinimumFrameRate = 15.0
-; = determines the worst-case frameskipping (between 5 and 15 recommended)
-FPS_Time = 250
-; = milliseconds per time the FPS is updated.
-
-Key_zoomin = EQUALS
-Key_zoomout = MINUS
-Key_alter1 = 0
-Key_alter2 = 9
-
-
-[Rendering]
-AA_Mode = 35
-
-
-[Stars]
-quality = 5
-;recomended = quality settings are 1, 2, and 5
-
-
-[Menu]
-SelectGame = 0
-
-
+[System]
+AutoUnload = 0
+
+[Video]
+ScreenWidth = 800
+ScreenHeight = 600
+
+BitsPerPixel = 32
+;valid = values are 8 (ugly), 15, 16, 24 (slow), and 32
+
+FullScreen = 1
+; = 0 = windowed, 1 = fullscreen
+
+;This = will select the theme by its string name. The names for the non-bitmap
+;themes = are: &quot;GTK&quot;, &quot;Win95&quot;, &quot;Photon&quot;, &quot;BeOS&quot;, &quot;NeXTStep&quot;, &quot;ASE&quot;, &quot;Allegro&quot;.
+GuiTheme = Photon
+
+Gamma = 45
+;gamma = gamma correction, should be between 0 and 255
+
+
+
+[Sound]
+SoundVolume = 0.500000
+MusicVolume = 0.500000
+SoundBuffer = 1024
+
+
+[Planet]
+PlanetDimension = 3
+PlanetUsespec = 1
+
+[View]
+View = Enemy
+;determines = where the camera goes
+InterpolateFrames = 1
+;0 = low quality, 1 = high quality
+Mip_min = 0
+;from = 0 to 3?  0 = normal, 1 = low quality, 2 = very low quality, ...
+Mip_max = 10
+;from = 0 to 3?  0 = high quality, 99 = normal
+Mip_bias = 0
+;from = -3? to 3?  0 = normal, -1 = high quality, 1 = low quality, 2 = very low quality
+;(Hero, = Enemy, Enemy_Discrete, Split, Everything)
+MinimumFrameRate = 15.0
+; = determines the worst-case frameskipping (between 5 and 15 recommended)
+FPS_Time = 250
+; = milliseconds per time the FPS is updated.
+
+Key_zoomin = EQUALS
+Key_zoomout = MINUS
+Key_alter1 = 0
+Key_alter2 = 9
+
+
+[Rendering]
+AA_Mode = 35
+
+
+[Stars]
+quality = 5
+;recomended = quality settings are 1, 2, and 5
+
+
+[Menu]
+SelectGame = 0
+
+

Added: trunk/gamedata/games/test_game/dialogs/chorali_commander.xml
===================================================================
--- trunk/gamedata/games/test_game/dialogs/chorali_commander.xml	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/gamedata/games/test_game/dialogs/chorali_commander.xml	2005-08-06 18:09:53 UTC (rev 175)
@@ -0,0 +1 @@
+&lt;DIALOG&gt;&lt;START_DIALOG&gt;&lt;/START_DIALOG&gt;&lt;END_DIALOG&gt;&lt;/END_DIALOG&gt;&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;First welcome&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/estion.jpg&quot; alien_text=&quot;We are Chorali. What do you want?&quot; font=&quot;Estion&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Submit or die foolish creature&quot; appear_condition=&quot;gflag.m2_status == MISSION_IN_PROGRESS&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;gflag.m2_status = MISSION_COMPLETED&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Err... nothing, bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;1&quot; name=&quot;Ok&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/estion.jpg&quot; alien_text=&quot;Oh, ok... we're quite familiar with that arrangement.&quot; font=&quot;Estion&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Tell me your secrets!&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(2)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;2&quot; !
 name=&quot;Secrets&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/estion.jpg&quot; alien_text=&quot;Go to coordinates 1500,5000, you will find precursor wreck. &quot; font=&quot;Estion&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;That is help. You will live a bit longer&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(3)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;3&quot; name=&quot;Bye&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/estion.jpg&quot; alien_text=&quot;I hope you will die soon|Bye&quot; font=&quot;Estion&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;&lt;/DIALOG&gt;
\ No newline at end of file

Modified: trunk/gamedata/games/test_game/dialogs/druuge.xml
===================================================================
--- trunk/gamedata/games/test_game/dialogs/druuge.xml	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/gamedata/games/test_game/dialogs/druuge.xml	2005-08-06 18:09:53 UTC (rev 175)
@@ -1,4 +1,4 @@
-&lt;DIALOG&gt;&lt;START_NODES&gt;&lt;/START_NODES&gt;&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;Meet Druuge&quot; music=&quot;music/races/druuge.mod&quot; background=&quot;images/alien/druuge.jpg&quot; alien_text=&quot;We are the Druuge of the Crimson Corporation. We have rightfully taken possesion of this area, and must ask you to cease tresspassing immediately.&quot; font=&quot;&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;These are Precursor artifacts. They aren't rightfully owned by anyone!&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Stand aside, Druuge. I have come to claim the bounty of this region.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(7)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Oh, me? I was just passing through.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(10)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;1&quot; name=&quot;We lay claim&quot; music=&quot;music/races/druuge.mod&quot; background=&quot;images/alien/druuge.jpg&quot; alien_text=&quot;Ha ha ha! We lay claim to these grou!
 nds under secion 577(d) of the Druuge Civil Code.&quot; font=&quot;&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;That's impossible! What is this code?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(2)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;In that case, I lay claim to your lives under section 2(c) of the code of [Player_name]!&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(6)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;2&quot; name=&quot;text of the law&quot; music=&quot;music/races/druuge.mod&quot; background=&quot;images/alien/druuge.jpg&quot; alien_text=&quot;I quote section 577(d), Article IX:
+&lt;DIALOG&gt;&lt;START_DIALOG&gt;&lt;/START_DIALOG&gt;&lt;END_DIALOG&gt;&lt;/END_DIALOG&gt;&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;Meet Druuge&quot; music=&quot;music/races/druuge.mod&quot; background=&quot;images/alien/druuge.jpg&quot; alien_text=&quot;We are the Druuge of the Crimson Corporation. We have rightfully taken possesion of this area, and must ask you to cease tresspassing immediately.&quot; font=&quot;&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;These are Precursor artifacts. They aren't rightfully owned by anyone!&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Stand aside, Druuge. I have come to claim the bounty of this region.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(7)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Oh, me? I was just passing through.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(10)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;1&quot; name=&quot;We lay claim&quot; music=&quot;music/races/druuge.mod&quot; background=&quot;images/alien/druuge.jpg&quot; alien_text=&quot;Ha ha ha!!
  We lay claim to these grounds under secion 577(d) of the Druuge Civil Code.&quot; font=&quot;&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;That's impossible! What is this code?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(2)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;In that case, I lay claim to your lives under section 2(c) of the code of [Player_name]!&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(6)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;10&quot; name=&quot;another route&quot; music=&quot;music/races/druuge.mod&quot; background=&quot;images/alien/druuge.jpg&quot; alien_text=&quot;Very well. We ask that you find another route immedately, or we will be obligated to remove you from the premises ourselves.&quot; font=&quot;&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;I've thought of a new route already- my main cannons straight through your hull!&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(8)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Do not harm us, Druuge. We will find a way aroun!
 d.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(9)!
 &quot;&gt;&lt;/ACTI
ON&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;11&quot; name=&quot;(F) defend property&quot; music=&quot;music/races/druuge.mod&quot; background=&quot;images/alien/druuge.jpg&quot; alien_text=&quot;We are obligated to defend the property of the Crimson Corporation. You must die now. [Fight]&quot; font=&quot;&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;(end dialogue)&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;2&quot; name=&quot;text of the law&quot; music=&quot;music/races/druuge.mod&quot; background=&quot;images/alien/druuge.jpg&quot; alien_text=&quot;I quote section 577(d), Article IX:
 Finders keepers, losers weepers.&quot; font=&quot;&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;But I found it first! I've been to this wreck before!&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(3)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Laws are made to be broken.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(11)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;3&quot; name=&quot;prove it&quot; music=&quot;music/races/druuge.mod&quot; background=&quot;images/alien/druuge.jpg&quot; alien_text=&quot;Oh, did you? Well then, I suppose we'd better stand down, as long as you submitted a proper request for posession and scavenging to the Crimson Corporation Headquarters. &quot; font=&quot;&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Why, of course. You may go now.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(5)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Er... no, I didn't.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(4)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;4&quot; name=&quot;(F) forced to!
  eradicate&quot; music=&quot;music/races/druuge.mod&quot; background=&quot;images/alien/druuge.jpg&quot; alien_text=&quot;Ahhh... that is a pity. As a dutiful employee of the Crimson 
 Corporation, I am forced to eradicate you and your crew for attempting 
-deliberate subterfuge under section 8808(b) of the Druuge Penal Code. [Fight]&quot; font=&quot;&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;(end dialogue)&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;5&quot; name=&quot;check records&quot; music=&quot;music/races/druuge.mod&quot; background=&quot;images/alien/druuge.jpg&quot; alien_text=&quot;At once. But first, let me double-check our records.&quot; font=&quot;&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;No- wait! I didn't submit a request!&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(4)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Go ahead. I'm sure you will find things in order.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(4)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;6&quot; name=&quot;(F) prepare to die&quot; music=&quot;music/races/druuge.mod&quot; background=&quot;images/alien/druuge.jpg&quot; alien_text=&quot;We are not aware of this code, but we are obligated to defend the property of the Crimson Corporation at all costs. P!
 repare to die. [Fight]&quot; font=&quot;&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;(end dialogue)&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;7&quot; name=&quot;refuse&quot; music=&quot;music/races/druuge.mod&quot; background=&quot;images/alien/druuge.jpg&quot; alien_text=&quot;I refuse. This salvage is property of the Crimson Corporation. You have one more chance to remove yourself from the premises before I am forced to do so myself.&quot; font=&quot;&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Eat plasma, you gremlin-faced spawn of hell!&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(8)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Fine, I give up. The wreckage is yours.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(9)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;8&quot; name=&quot;(F) add your wreckage&quot; music=&quot;music/races/druuge.mod&quot; background=&quot;images/alien/druuge.jpg&quot; alien_text=&quot;We will add your name to our Ledger of Hatred once your own demolished!
  hull floats besides the wreckage you seek! [Fight]&quot; font=&quot;&quot; t!
 ext_loca
tion=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;(end dialogue)&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;9&quot; name=&quot;(E) leave&quot; music=&quot;music/races/druuge.mod&quot; background=&quot;images/alien/druuge.jpg&quot; alien_text=&quot;As it should be. Leave this place now, human, and do not return.&quot; font=&quot;&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Goodbye, Druuge.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;10&quot; name=&quot;another route&quot; music=&quot;music/races/druuge.mod&quot; background=&quot;images/alien/druuge.jpg&quot; alien_text=&quot;Very well. We ask that you find another route immedately, or we will be obligated to remove you from the premises ourselves.&quot; font=&quot;&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;I've thought of a new route already- my main cannons straight through your hull!&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(8)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Do not harm us, !
 Druuge. We will find a way around.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(9)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;11&quot; name=&quot;(F) defend property&quot; music=&quot;music/races/druuge.mod&quot; background=&quot;images/alien/druuge.jpg&quot; alien_text=&quot;We are obligated to defend the property of the Crimson Corporation. You must die now. [Fight]&quot; font=&quot;&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;(end dialogue)&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;&lt;/DIALOG&gt;
\ No newline at end of file
+deliberate subterfuge under section 8808(b) of the Druuge Penal Code. [Fight]&quot; font=&quot;&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;(end dialogue)&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;5&quot; name=&quot;check records&quot; music=&quot;music/races/druuge.mod&quot; background=&quot;images/alien/druuge.jpg&quot; alien_text=&quot;At once. But first, let me double-check our records.&quot; font=&quot;&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;No- wait! I didn't submit a request!&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(4)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Go ahead. I'm sure you will find things in order.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(4)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;6&quot; name=&quot;(F) prepare to die&quot; music=&quot;music/races/druuge.mod&quot; background=&quot;images/alien/druuge.jpg&quot; alien_text=&quot;We are not aware of this code, but we are obligated to defend the property of the Crimson Corporation at all costs. P!
 repare to die. [Fight]&quot; font=&quot;&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;(end dialogue)&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;7&quot; name=&quot;refuse&quot; music=&quot;music/races/druuge.mod&quot; background=&quot;images/alien/druuge.jpg&quot; alien_text=&quot;I refuse. This salvage is property of the Crimson Corporation. You have one more chance to remove yourself from the premises before I am forced to do so myself.&quot; font=&quot;&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Eat plasma, you gremlin-faced spawn of hell!&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(8)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Fine, I give up. The wreckage is yours.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(9)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;8&quot; name=&quot;(F) add your wreckage&quot; music=&quot;music/races/druuge.mod&quot; background=&quot;images/alien/druuge.jpg&quot; alien_text=&quot;We will add your name to our Ledger of Hatred once your own demolished!
  hull floats besides the wreckage you seek! [Fight]&quot; font=&quot;&quot; t!
 ext_loca
tion=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;(end dialogue)&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;9&quot; name=&quot;(E) leave&quot; music=&quot;music/races/druuge.mod&quot; background=&quot;images/alien/druuge.jpg&quot; alien_text=&quot;As it should be. Leave this place now, human, and do not return.&quot; font=&quot;&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Goodbye, Druuge.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;&lt;/DIALOG&gt;
\ No newline at end of file

Modified: trunk/gamedata/games/test_game/dialogs/ixis_mining_station_commander.xml
===================================================================
--- trunk/gamedata/games/test_game/dialogs/ixis_mining_station_commander.xml	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/gamedata/games/test_game/dialogs/ixis_mining_station_commander.xml	2005-08-06 18:09:53 UTC (rev 175)
@@ -1 +1 @@
-&lt;DIALOG&gt;&lt;START_NODES&gt;&lt;/START_NODES&gt;&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;Welcome to ixis mining station station&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;Welcome to the Ixis mining station. How can I help you?&quot; font=&quot;Earth&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;I have some questions for you.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Never mind, I'll just be on my way.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;1&quot; name=&quot;QuestionNexus&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;Sure, I'm happy to share my knowledge with you.&quot; font=&quot;Earth&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;What can you tell me about the Chorali?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(2)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;What are some points of interest in this system?&quot; appear_!
 condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(3)&quot;&gt;&lt;/ACTION&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;quests.add_druuge_guardians()&quot;&gt;&lt;/ACTION&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;tml.GameAction.save_flag('have_drax_open_device',1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;2&quot; name=&quot;Chorali?&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;Hmm... mysterious creatures, they are. I ran into one in a bar planetside- it was made of pure energy. I found it a little wierd at first, but he turned out to be a friendly critter. Even bought me a drink.&quot; font=&quot;Earth&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Umm, thanks. Gotta go.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Interesting. I have some more questions.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;3&quot; name=&quot;Wreck?&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_t!
 ext=&quot;Hmm... A few months ago, a routine scouting mission disco!
 vered a 
Precursor wreck not far from here, at coordinates 1500,5000. Every vessel is completely sealed off, except for one. Unfortunately, it seems to be stripped of all its useful parts, as far as I can tell.&quot; font=&quot;Earth&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;A Precursor wreck! Excuse me, I must travel there at once!&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Fascinating. I have another question.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;&lt;/DIALOG&gt;
\ No newline at end of file
+&lt;DIALOG&gt;&lt;START_DIALOG&gt;&lt;/START_DIALOG&gt;&lt;END_DIALOG&gt;&lt;/END_DIALOG&gt;&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;Welcome to ixis mining station station&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;Welcome to the Ixis mining station. How can I help you?&quot; font=&quot;Earth&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;I have some questions for you.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Never mind, I'll just be on my way.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;1&quot; name=&quot;QuestionNexus&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;Sure, I'm happy to share my knowledge with you.&quot; font=&quot;Earth&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;What can you tell me about the Chorali?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(2)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;What are some points of intere!
 st in this system?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(3)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;2&quot; name=&quot;Chorali?&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;Hmm... mysterious creatures, they are. I ran into one in a bar planetside- it was made of pure energy. I found it a little wierd at first, but he turned out to be a friendly critter. Even bought me a drink.&quot; font=&quot;Earth&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Umm, thanks. Gotta go.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Interesting. I have some more questions.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;3&quot; name=&quot;Wreck?&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;Hmm... A few months ago, a routine scouting mission discovered a Precursor wreck not far from here, at coordinates 1500,5000. Ever!
 y vessel is completely sealed off, except for one. Unfortunate!
 ly, it s
eems to be stripped of all its useful parts, as far as I can tell.&quot; font=&quot;Earth&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;A Precursor wreck! Excuse me, I must travel there at once!&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Fascinating. I have another question.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;&lt;/DIALOG&gt;
\ No newline at end of file

Modified: trunk/gamedata/games/test_game/dialogs/precursor_wrack_first_inspection.xml
===================================================================
--- trunk/gamedata/games/test_game/dialogs/precursor_wrack_first_inspection.xml	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/gamedata/games/test_game/dialogs/precursor_wrack_first_inspection.xml	2005-08-06 18:09:53 UTC (rev 175)
@@ -1 +1 @@
-&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;We have discovered precursor battleship&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;We have discovered precursor vessel. Unfortunately we can't get inside.&quot; font=&quot;Earth&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Ok&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;
\ No newline at end of file
+&lt;DIALOG&gt;&lt;START_DIALOG&gt;&lt;/START_DIALOG&gt;&lt;END_DIALOG&gt;&lt;/END_DIALOG&gt;&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;We have discovered precursor battleship&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;We have discovered precursor vessel. Unfortunately we can't get inside.&quot; font=&quot;Earth&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Ok&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;&lt;/DIALOG&gt;
\ No newline at end of file

Modified: trunk/gamedata/games/test_game/dialogs/shpalabc.xml
===================================================================
--- trunk/gamedata/games/test_game/dialogs/shpalabc.xml	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/gamedata/games/test_game/dialogs/shpalabc.xml	2005-08-06 18:09:53 UTC (rev 175)
@@ -1 +1 @@
-&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;Begin&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;I am Black Spathi!&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Can we chat a little?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;1&quot; name=&quot;bye&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;No, we can't&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;
\ No newline at end of file
+&lt;DIALOG&gt;&lt;START_DIALOG&gt;&lt;/START_DIALOG&gt;&lt;END_DIALOG&gt;&lt;/END_DIALOG&gt;&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;Begin&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;I am Black Spathi!&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Can we chat a little?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;1&quot; name=&quot;bye&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;No, we can't&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;&lt;/DIALOG&gt;
\ No newline at end of file

Modified: trunk/gamedata/games/test_game/dialogs/shpandgu.xml
===================================================================
--- trunk/gamedata/games/test_game/dialogs/shpandgu.xml	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/gamedata/games/test_game/dialogs/shpandgu.xml	2005-08-06 18:09:53 UTC (rev 175)
@@ -1 +1 @@
-&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;Begin&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;I am Black Spathi!&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Can we chat a little?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;1&quot; name=&quot;bye&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;No, we can't&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;
\ No newline at end of file
+&lt;DIALOG&gt;&lt;START_DIALOG&gt;&lt;/START_DIALOG&gt;&lt;END_DIALOG&gt;&lt;/END_DIALOG&gt;&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;Begin&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;I am Black Spathi!&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Can we chat a little?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;1&quot; name=&quot;bye&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;No, we can't&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;&lt;/DIALOG&gt;
\ No newline at end of file

Modified: trunk/gamedata/games/test_game/dialogs/shparisk.xml
===================================================================
--- trunk/gamedata/games/test_game/dialogs/shparisk.xml	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/gamedata/games/test_game/dialogs/shparisk.xml	2005-08-06 18:09:53 UTC (rev 175)
@@ -1 +1 @@
-&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;Begin&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;I am Black Spathi!&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Can we chat a little?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;1&quot; name=&quot;bye&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;No, we can't&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;
\ No newline at end of file
+&lt;DIALOG&gt;&lt;START_DIALOG&gt;&lt;/START_DIALOG&gt;&lt;END_DIALOG&gt;&lt;/END_DIALOG&gt;&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;Begin&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;I am Black Spathi!&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Can we chat a little?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;1&quot; name=&quot;bye&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;No, we can't&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;&lt;/DIALOG&gt;
\ No newline at end of file

Modified: trunk/gamedata/games/test_game/dialogs/shpbahbu.xml
===================================================================
--- trunk/gamedata/games/test_game/dialogs/shpbahbu.xml	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/gamedata/games/test_game/dialogs/shpbahbu.xml	2005-08-06 18:09:53 UTC (rev 175)
@@ -1 +1 @@
-&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;Begin&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;I am Black Spathi!&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Can we chat a little?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;1&quot; name=&quot;bye&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;No, we can't&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;
\ No newline at end of file
+&lt;DIALOG&gt;&lt;START_DIALOG&gt;&lt;/START_DIALOG&gt;&lt;END_DIALOG&gt;&lt;/END_DIALOG&gt;&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;Begin&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;I am Black Spathi!&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Can we chat a little?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;1&quot; name=&quot;bye&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;No, we can't&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;&lt;/DIALOG&gt;
\ No newline at end of file

Modified: trunk/gamedata/games/test_game/dialogs/shpbipka.xml
===================================================================
--- trunk/gamedata/games/test_game/dialogs/shpbipka.xml	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/gamedata/games/test_game/dialogs/shpbipka.xml	2005-08-06 18:09:53 UTC (rev 175)
@@ -1 +1 @@
-&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;Begin&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;I am Black Spathi!&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Can we chat a little?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;1&quot; name=&quot;bye&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;No, we can't&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;
\ No newline at end of file
+&lt;DIALOG&gt;&lt;START_DIALOG&gt;&lt;/START_DIALOG&gt;&lt;END_DIALOG&gt;&lt;/END_DIALOG&gt;&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;Begin&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;I am Black Spathi!&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Can we chat a little?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;1&quot; name=&quot;bye&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;No, we can't&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;&lt;/DIALOG&gt;
\ No newline at end of file

Modified: trunk/gamedata/games/test_game/dialogs/shpchmav.xml
===================================================================
--- trunk/gamedata/games/test_game/dialogs/shpchmav.xml	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/gamedata/games/test_game/dialogs/shpchmav.xml	2005-08-06 18:09:53 UTC (rev 175)
@@ -1 +1 @@
-&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;Begin&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;I am Black Spathi!&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Can we chat a little?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;1&quot; name=&quot;bye&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;No, we can't&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;
\ No newline at end of file
+&lt;DIALOG&gt;&lt;START_DIALOG&gt;&lt;/START_DIALOG&gt;&lt;END_DIALOG&gt;&lt;/END_DIALOG&gt;&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;Begin&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;I am Black Spathi!&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Can we chat a little?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;1&quot; name=&quot;bye&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;No, we can't&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;&lt;/DIALOG&gt;
\ No newline at end of file

Modified: trunk/gamedata/games/test_game/dialogs/test_dialog.xml
===================================================================
--- trunk/gamedata/games/test_game/dialogs/test_dialog.xml	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/gamedata/games/test_game/dialogs/test_dialog.xml	2005-08-06 18:09:53 UTC (rev 175)
@@ -1 +1 @@
-&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;Begin&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;I am Black Spathi!&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Can we chat a little?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;1&quot; name=&quot;bye&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;No, we can't&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;
\ No newline at end of file
+&lt;DIALOG&gt;&lt;START_DIALOG&gt;&lt;/START_DIALOG&gt;&lt;END_DIALOG&gt;&lt;/END_DIALOG&gt;&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;Begin&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;I am Black Spathi!&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Can we chat a little?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;1&quot; name=&quot;bye&quot; music=&quot;music/races/spathi.mod&quot; background=&quot;images/alien/SpathiMain.jpg&quot; alien_text=&quot;No, we can't&quot; font=&quot;Times&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;&lt;/DIALOG&gt;
\ No newline at end of file

Modified: trunk/gamedata/games/test_game/dialogs/transport_please_help.xml
===================================================================
--- trunk/gamedata/games/test_game/dialogs/transport_please_help.xml	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/gamedata/games/test_game/dialogs/transport_please_help.xml	2005-08-06 18:09:53 UTC (rev 175)
@@ -1 +1 @@
-&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;Help request&quot; music=&quot;music/races/korah.mod&quot; background=&quot;images/alien/estion.jpg&quot; alien_text=&quot;SOS, Help, we have kohr-ah battle versel after us. Please do something about it or we are going to die&quot; font=&quot;Estion&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;This is earth cruiser Tamerlan, I will help you.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;
\ No newline at end of file
+&lt;DIALOG&gt;&lt;START_DIALOG&gt;&lt;/START_DIALOG&gt;&lt;END_DIALOG&gt;&lt;/END_DIALOG&gt;&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;Help request&quot; music=&quot;music/races/korah.mod&quot; background=&quot;images/alien/estion.jpg&quot; alien_text=&quot;SOS, Help, we have kohr-ah battle versel after us. Please do something about it or we are going to die&quot; font=&quot;Estion&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;This is earth cruiser Tamerlan, I will help you.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;&lt;/DIALOG&gt;
\ No newline at end of file

Modified: trunk/gamedata/games/test_game/dialogs/transport_thanks.xml
===================================================================
--- trunk/gamedata/games/test_game/dialogs/transport_thanks.xml	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/gamedata/games/test_game/dialogs/transport_thanks.xml	2005-08-06 18:09:53 UTC (rev 175)
@@ -1 +1 @@
-&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;thanks for saving my sorry ass&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/estion.jpg&quot; alien_text=&quot;Thanks for saving my sorry ass.&quot; font=&quot;Estion&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;It was my duty&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;
\ No newline at end of file
+&lt;DIALOG&gt;&lt;START_DIALOG&gt;&lt;/START_DIALOG&gt;&lt;END_DIALOG&gt;&lt;/END_DIALOG&gt;&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;thanks for saving my sorry ass&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/estion.jpg&quot; alien_text=&quot;Thanks for saving my sorry ass.&quot; font=&quot;Estion&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;It was my duty&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;&lt;/DIALOG&gt;
\ No newline at end of file

Modified: trunk/gamedata/games/test_game/dialogs/welcomecommander.xml
===================================================================
--- trunk/gamedata/games/test_game/dialogs/welcomecommander.xml	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/gamedata/games/test_game/dialogs/welcomecommander.xml	2005-08-06 18:09:53 UTC (rev 175)
@@ -1 +1 @@
-&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;Welcome&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;Welcome to the Charlys Sector, Captain.  I am Commander Jacques Haven, of Silcuu Station. Your ship will be a great addition to fleet here. Would you like some background information before you proceed with your first assignment? &quot; font=&quot;Earthling&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Yes, Commander. Information is always valuable.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;No, Commander. I'd like to get straight to my duties.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(5)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;1&quot; name=&quot;Info&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;As you might have seen on your hyperspace map, there are three systems in the Charlys Sector; Narike, Ixis, and Gamma Onyx. It's mostly peaceful in Charlys, except for a few Ko!
 hr-Ah raiders and Ulzrak. We are having negotiatons to have a native, energy-based race known as the Chorali join the Alliance, and we are hoping to initiate them soon with the avian Drax race. &quot; font=&quot;Earthling&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;I'd like to learn more about the Ulzrak.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(2)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;I'd like to learn more about the Chorali.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(3)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;I'd like to learn more about the Drax.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(4)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;That's enough information for now. What are my orders?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(5)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;2&quot; name=&quot;Ulzrak&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;The Ulzrak are a completely hostil!
 e race, that do not seem to have any purpose to their destruct!
 ion, as 
far as we can tell. They do not initiate contact before attacking. The only reason we know their name is froma salvaged computer database. &quot; font=&quot;Earthling&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;I'd like some more general info, Commander.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;That's enough information for now. What are my orders?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(5)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;3&quot; name=&quot;Chorali&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;The Chorali are energy-based creatures that mostly made of photons, liquid, and a thin normal matter shell, through which they interact with a normal environment. As a species, they're rather secretive about any technology or information they find, though it's said they are quite social amog themselves. They are also, as a species rather friendly, however. We're currently negoti!
 ating them joining the New Alliance. &quot; font=&quot;Earthling&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;I'd like some more general info, Commander.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;That's enough information for now. What are my orders?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(5)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;4&quot; name=&quot;Drax&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;We haven't had much contact with the Drax so far, but from what we've heard they've had over a hundred million internal conflicts, and that's only during their spacefaring age. The only governments that succeed are very loosely tied ones, with very little law. It will likely be difficult getting even a preliminary treaty, with the number of factions working for different goals.  &quot; font=&quot;Earthling&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;I'd like some more general info, Comman!
 der.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(!
 1)&quot;&gt;&lt;/AC
TION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;That's enough information for now. What are my orders?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(5)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;5&quot; name=&quot;Orders/Assignments&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;You actually have a choice of assignments, Captain. You can choose to take a transport escort assignment to a mining operation in Ixis, where they need medical supplies. Or, you can negotiate with the Chorali, here in Narike.  &quot; font=&quot;Earthling&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;I'll escort the transport to Ixis. &quot; appear_condition=&quot;not tml.GameAction.get_double_flag('escort_transport_accept')&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(6)&quot;&gt;&lt;/ACTION&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;quests.escort_transport_to_ixis_func()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;I'll negotiate with the Chorali.&quot; appear_condition=&quot;not tml.GameAction.get_double_flag('negotiate_with_choral!
 i_accept')&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(6)&quot;&gt;&lt;/ACTION&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;CHORALI_SELECTED=True&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;6&quot; name=&quot;Good Luck!&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;Good luck, Captain. Be careful, I wouldn't want to lose the newest addition to my fleet. &quot; font=&quot;Earthling&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Thank you, Commander.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;I'll execute my mission well, Commander, be sure of that. &quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog() &quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;
\ No newline at end of file
+&lt;DIALOG&gt;&lt;START_DIALOG&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;m12_compl = gflag.m1_status == MISSION_COMPLETED or gflag.m2_status == MISSION_COMPLETED&#10;&#10;# Tell player to complete mission&#10;if gflag.m1_status == MISSION_IN_PROGRESS or gflag.m2_status == MISSION_IN_PROGRESS or gflag.m3_status == MISSION_IN_PROGRESS :&#10;  goto(7)&#10;&#10;if m12_compl:&#10;  goto(9)&#10;&#10;if m3_status == MISSION_COMPLETED:&#10;  goto(11)&#10;&#10;&quot;&gt;&lt;/ACTION&gt;&lt;/START_DIALOG&gt;&lt;END_DIALOG&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;&quot;&gt;&lt;/ACTION&gt;&lt;/END_DIALOG&gt;&lt;NODES&gt;&lt;NODE id=&quot;0&quot; name=&quot;Welcome&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;Welcome to the Charlys Sector, Captain.  I am Commander Jacques Haven, of Silcuu Station. Your ship will be a great addition to fleet here. Would you like some background information before you proceed with your first assignment? &quot; font=&quot;Earthling&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Yes, Commander. Information is always valuable.&quot; appea!
 r_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;No, Commander. I'd like to get straight to my duties.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(5)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;1&quot; name=&quot;Info&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;As you might have seen on your hyperspace map, there are three systems in the Charlys Sector; Narike, Ixis, and Gamma Onyx. It's mostly peaceful in Charlys, except for a few Kohr-Ah raiders and Ulzrak. We are having negotiatons to have a native, energy-based race known as the Chorali join the Alliance, and we are hoping to initiate them soon with the avian Drax race. &quot; font=&quot;Earthling&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;I'd like to learn more about the Ulzrak.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(2)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;I'd like to learn more about the Chorali.&quot; appear_condi!
 tion=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(3)&quot;&gt;&lt;/ACTION&gt;&lt;/PLA!
 YER_ANSW
ER&gt;&lt;PLAYER_ANSWER text=&quot;I'd like to learn more about the Drax.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(4)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;That's enough information for now. What are my orders?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(5)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;10&quot; name=&quot;Investigate wreck&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;You should investigate precursor wreck&quot; font=&quot;Earthling&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;I will fly imideatly&quot; appear_condition=&quot;gflag.m3_status != MISSION_COMPLETED&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(6)&quot;&gt;&lt;/ACTION&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;check_precursor_wreck_func()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;I have already checked them.&quot; appear_condition=&quot;gflag.m3_status == MISSION_COMPLETED&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(11)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;11&quot; name=&quot;Zoq-Fot-Pik ambasador&quot; music=&quot;music/races/!
 human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;You must escort Zoq-Fot-Pik ambassador to Gamma Onyx .&quot; font=&quot;Earthling&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;I will fly imideatly&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(6)&quot;&gt;&lt;/ACTION&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;quests.zoq_fot_pik_ambassador_func()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;2&quot; name=&quot;Ulzrak&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;The Ulzrak are a completely hostile race, that do not seem to have any purpose to their destruction, as far as we can tell. They do not initiate contact before attacking. The only reason we know their name is froma salvaged computer database. &quot; font=&quot;Earthling&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;I'd like some more general info, Commander.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;That's enough information for now. What are my orders?&quot; a!
 ppear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(5)&quot;&gt;&lt;/A!
 CTION&gt;&lt;/
PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;3&quot; name=&quot;Chorali&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;The Chorali are energy-based creatures that mostly made of photons, liquid, and a thin normal matter shell, through which they interact with a normal environment. As a species, they're rather secretive about any technology or information they find, though it's said they are quite social amog themselves. They are also, as a species rather friendly, however. We're currently negotiating them joining the New Alliance. &quot; font=&quot;Earthling&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;I'd like some more general info, Commander.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;That's enough information for now. What are my orders?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(5)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;4&quot; name=&quot;Drax&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/h!
 uman.jpg&quot; alien_text=&quot;We haven't had much contact with the Drax so far, but from what we've heard they've had over a hundred million internal conflicts, and that's only during their spacefaring age. The only governments that succeed are very loosely tied ones, with very little law. It will likely be difficult getting even a preliminary treaty, with the number of factions working for different goals.  &quot; font=&quot;Earthling&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;I'd like some more general info, Commander.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(1)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;That's enough information for now. What are my orders?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(5)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;5&quot; name=&quot;Orders/Assignments&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;You actually have a choice of assignments, Captain. You can choose to take a transport escort assignment!
  to a mining operation in Ixis, where they need medical suppli!
 es. Or, 
you can negotiate with the Chorali, here in Narike.  &quot; font=&quot;Earthling&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;I'll escort the transport to Ixis. &quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(6)&quot;&gt;&lt;/ACTION&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;quests.escort_transport_to_ixis_func()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;I'll negotiate with the Chorali.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(6)&quot;&gt;&lt;/ACTION&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;quests.negotiate_with_chorali_func()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;6&quot; name=&quot;Good Luck!&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;Good luck, Captain. Be careful, I wouldn't want to lose the newest addition to my fleet. &quot; font=&quot;Earthling&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Thank you, Commander.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog()&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;I'll execute my mission well, Commander, be sure of !
 that. &quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;endDialog() &quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;7&quot; name=&quot;Why are you here?&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;I have assigned you on important mission. Why are you here?&quot; font=&quot;Earthling&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;What was it again?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(8)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;PLAYER_ANSWER text=&quot;Bye&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(6)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;8&quot; name=&quot;Are you dumb or something?&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/alien/human.jpg&quot; alien_text=&quot;Are you dumb or something? {gflag.current_mission}&quot; font=&quot;Earthling&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;Oh, bye.&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;goto(6)&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;NODE id=&quot;9&quot; name=&quot;Good work&quot; music=&quot;music/races/human.mod&quot; background=&quot;images/a!
 lien/human.jpg&quot; alien_text=&quot;Good work. About your next mission!
 ...&quot; fon
t=&quot;Earthling&quot; text_location=&quot;(50,10)&quot;&gt;&lt;PLAYER_ANSWER text=&quot;What is it?&quot; appear_condition=&quot;1&quot;&gt;&lt;ACTION condition=&quot;1&quot; action=&quot;10&quot;&gt;&lt;/ACTION&gt;&lt;/PLAYER_ANSWER&gt;&lt;/NODE&gt;&lt;/NODES&gt;&lt;/DIALOG&gt;
\ No newline at end of file

Added: trunk/gamedata/games/test_game/scripts/flags.py
===================================================================
--- trunk/gamedata/games/test_game/scripts/flags.py	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/gamedata/games/test_game/scripts/flags.py	2005-08-06 18:09:53 UTC (rev 175)
@@ -0,0 +1,39 @@
+#
+# This file should contain all global flags the game is going to use
+# don't place anything else here
+#
+
+# some constants
+MISSION_CLEAN       = 0
+MISSION_IN_PROGRESS = 1
+MISSION_COMPLETED   = 2
+MISSION_FAILED      = 3
+
+class Flags:
+    # Mission 1 Escort transport
+    m1_status     = 0
+    m1_transport = -1 # Transport ship ID
+    m1_enemy     = -1 # attacker's ship
+    
+    # Mission 2 Negotiate with Chorali
+    m2_status     = 0
+    
+    # Mission 3 Investigate wreck
+    m3_status    = 0
+    
+    # Mission 4 Zoq-Fot-Pik ambassador
+    m4_status     = 0
+    
+    # Locations
+    ixis_mining_station = -1
+    ixis_chorali_station = -1
+    precursor_wreck_id   = -1
+    
+    # Know How
+    use_tin_device = 0
+    current_mission = &quot;&quot;
+    
+    # Items
+    tin_device     = 0
+    
+gflag = Flags()

Modified: trunk/gamedata/games/test_game/scripts/quests.py
===================================================================
--- trunk/gamedata/games/test_game/scripts/quests.py	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/gamedata/games/test_game/scripts/quests.py	2005-08-06 18:09:53 UTC (rev 175)
@@ -1,90 +1,118 @@
 import tml,dialog,misc
+from flags import *
 
+# Mission1 Escort transport to Ixis star system
 
-# player choose to escort transport to Ixis star system
-
 def escort_transport_to_ixis_func():
-    tml.GameAction.save_flag('escort_transport_accept',1)
-    tml.GameAction.save_flag('escort_transport_to_ixis_mission_completeP', 0)
-    transport = tml.GameAction.add_ship('Ixis',
-                                        &quot;choex&quot;, 1000, 1000, tml.GameAction.get_player_team())
-    tml.GameAction.save_flag('escort_transport_to_ixis_transport_id',transport )
-    tml.GameAction.go_to_location(transport, tml.GameAction.get_double_flag('ixis_mining_station base'), 50)
-    tml.EventManager.distanceLessThen(transport,
-                                      tml.GameAction.get_double_flag('ixis_mining_station base'),
-                                      100,  'escort_transport_to_ixis_mission_complete')
-    tml.EventManager.distanceLessThen(transport,
-                                      tml.GameAction.get_player_ship_id(),
+    if gflag.m1_status:
+        return
+    gflag.current_mission = &quot;&quot;&quot; You must escort our transport to Ixis minning station.&quot;&quot;&quot;
+    gflag.m1_status = MISSION_IN_PROGRESS
+    
+    gflag.m1_transport = tml.GameAction.add_ship('Ixis',&quot;choex&quot;, 3000, 3500, tml.GameAction.get_player_team())
+    
+    tml.GameAction.go_to_location(gflag.m1_transport, gflag.ixis_mining_station, 50)
+    tml.EventManager.distanceLessThen(gflag.m1_transport, gflag.ixis_mining_station, 100,
+                                      'escort_transport_to_ixis_mission_complete')
+    tml.EventManager.distanceLessThen(gflag.m1_transport, tml.GameAction.get_player_ship_id(),
                                       5000,  'escort_transport_to_ixis_ask_help_against_kohr_ah')
-    enemy = tml.GameAction.add_ship('Ixis',
-                                    &quot;kzedr&quot;, 2000, 2000, tml.GameAction.get_enemy_team())
-    tml.GameAction.set_crew(enemy, 10)
+    tml.EventManager.shipDeathById(gflag.m1_transport,'escort_transport_death')
+    gflag.m1_enemy = tml.GameAction.add_ship('Ixis', &quot;kzedr&quot;, 4000, 4000, tml.GameAction.get_enemy_team())
+    tml.GameAction.set_crew(gflag.m1_enemy, 10)
+    tml.GameAction.set_target(gflag.m1_enemy, gflag.m1_transport)
+    tml.EventManager.shipDeathById(gflag.m1_enemy,'escort_transport_enemy_death')
     tml.GameAction.print_message(&quot;HINT: use 'M' key to access star map&quot;, 15)
 
+def escort_transport_death():
+    if gflag.m1_status != MISSION_COMPLETED:
+        gflag.m1_status = MISSION_FAILED
+        print &quot;Mission 1 failed&quot;
+
+def escort_transport_enemy_death():
+    tml.GameAction.set_camera_mode('Hero')
+    
 def escort_transport_to_ixis_ask_help_against_kohr_ah():
     dialog.runDialogFile(tml.GameConfig.GetAbsolutePath(&quot;dialogs/transport_please_help.xml&quot;))
-
+    tml.GameAction.set_target(tml.GameAction.get_player_ship_id(), gflag.m1_enemy)
+    tml.GameAction.set_camera_mode('Enemy')
+    
 def escort_transport_to_ixis_mission_complete():
-    tml.GameAction.save_flag('escort_transport_to_ixis_mission_completeP', 1)
-    tml.GameAction.remove_location(tml.GameAction.get_double_flag('escort_transport_to_ixis_transport_id'))
+    gflag.m1_status = MISSION_COMPLETED
+    tml.GameAction.remove_location(gflag.m1_transport)
     dialog.runDialogFile(tml.GameConfig.GetAbsolutePath(&quot;dialogs/transport_thanks.xml&quot;))
+    print &quot;Mission 1 completed&quot;
+    
+############################################################################################################
+# Mission 2
+def negotiate_with_chorali_func():
+    gflag.m2_status = MISSION_IN_PROGRESS
+############################################################################################################
+# Mission 3
+def check_precursor_wreck_func():
+    if gflag.m1_status:
+        return
+    gflag.m3_status = MISSION_IN_PROGRESS
+    gflag.current_mission = &quot;&quot;&quot; You must investigate precursor wrack in Ixis star system.&quot;&quot;&quot;
+def check_precursor_wreck_completed_func():
+    dialog.runDialogFile(tml.GameConfig.GetAbsolutePath(&quot;dialogs/precursor_wrack_first_inspection.xml&quot;))
+    gflag.m3_status = MISSION_COMPLETED
 
 ############################################################################################################
 # Precursor wrack
 
-def start_precursor_wrack_mission():
-    tml.GameAction.save_flag('have_drax_open_device', 0)
-    tml.EventManager.distanceLessThen(tml.GameAction.get_double_flag('precursor_wrack_id'),
-                                      tml.GameAction.get_player_ship_id(),
-                                      200,  'precursor_wrack_first_inspection')
-    id = tml.EventManager.distanceLessThen(tml.GameAction.get_double_flag('precursor_wrack_id'),
-                                           tml.GameAction.get_player_ship_id(),
-                                           200,  'win_game_func')
-    tml.EventManager.AddEventCondition(id, 'check_has_drax_open_device')
+# def start_precursor_wrack_mission():
+#     tml.GameAction.save_flag('have_drax_open_device', 0)
+#     tml.EventManager.distanceLessThen(tml.GameAction.get_double_flag('precursor_wrack_id'),
+#                                       tml.GameAction.get_player_ship_id(),
+#                                       200,  'precursor_wrack_first_inspection')
+#     id = tml.EventManager.distanceLessThen(tml.GameAction.get_double_flag('precursor_wrack_id'),
+#                                            tml.GameAction.get_player_ship_id(),
+#                                            200,  'win_game_func')
+#     tml.EventManager.AddEventCondition(id, 'check_has_drax_open_device')
 
-def check_has_drax_open_device():
-    print &quot;Check drax open device&quot;
-    if tml.GameAction.get_double_flag('have_drax_open_device')&gt;0:
-        return True
-    return False
+# def check_has_drax_open_device():
+#     print &quot;Check drax open device&quot;
+#     if tml.GameAction.get_double_flag('have_drax_open_device')&gt;0:
+#         return True
+#     return False
 
-def precursor_wrack_first_inspection():
-    if not check_has_drax_open_device():
-        dialog.runDialogFile(tml.GameConfig.GetAbsolutePath(&quot;dialogs/precursor_wrack_first_inspection.xml&quot;))
+# def precursor_wrack_first_inspection():
+#     if not check_has_drax_open_device():
+#         dialog.runDialogFile(tml.GameConfig.GetAbsolutePath(&quot;dialogs/precursor_wrack_first_inspection.xml&quot;))
 
 
-def add_druuge_guardians():
-    id = tml.EventManager.distanceLessThen(tml.GameAction.get_double_flag('precursor_wrack_id'),
-                                           tml.GameAction.get_player_ship_id(),
-                                           2500,  'druuge_this_is_crimson_corporation_property_now')
-    for i in xrange(1):
-        enemy = tml.GameAction.add_ship('Ixis',
-                                    &quot;druma&quot;, 1500, 5000, tml.GameAction.get_enemy_team())
-        tml.GameAction.guard_location(enemy, tml.GameAction.get_double_flag('precursor_wrack_id'), 1500)
+# def add_druuge_guardians():
+#     id = tml.EventManager.distanceLessThen(tml.GameAction.get_double_flag('precursor_wrack_id'),
+#                                            tml.GameAction.get_player_ship_id(),
+#                                            2500,  'druuge_this_is_crimson_corporation_property_now')
+#     for i in xrange(1):
+#         enemy = tml.GameAction.add_ship('Ixis',
+#                                     &quot;druma&quot;, 1500, 5000, tml.GameAction.get_enemy_team())
+#         tml.GameAction.guard_location(enemy, tml.GameAction.get_double_flag('precursor_wrack_id'), 1500)
 
     
         
-def druuge_this_is_crimson_corporation_property_now():
-    dialog.runDialogFile(tml.GameConfig.GetAbsolutePath(&quot;dialogs/druuge.xml&quot;))
+# def druuge_this_is_crimson_corporation_property_now():
+#     dialog.runDialogFile(tml.GameConfig.GetAbsolutePath(&quot;dialogs/druuge.xml&quot;))
 
 
-def win_game_func():
-    tml.GameAction.end_game()
-    congrat = []
-    congrat.append(&quot;&quot;&quot;You win this little demo game&quot;&quot;&quot;)
-    congrat.append(&quot;&quot;)
-    congrat.append(&quot;Programming:&quot;)
-    congrat.append(&quot;  Yura Semashko (Yurand)&quot;)
-    congrat.append(&quot;&quot;)
-    congrat.append(&quot;Dialogs:&quot;)
-    congrat.append(&quot;  FrungySnack&quot;)
-    congrat.append(&quot;  Halleck&quot;)
-    congrat.append(&quot;  Yura Semashko (Yurand)&quot;)
-    congrat.append(&quot;&quot;)
-    congrat.append(&quot;Please, consider help us with TW-Light: Legacies&quot;)
-    congrat.append(&quot;For detail check our site <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>&quot;)
-    tml.GameAction.scroll_text(misc.PyListStringToVector(congrat),&quot;images/background.jpg&quot;)
-    pass
+# def win_game_func():
+#     tml.GameAction.end_game()
+#     congrat = []
+#     congrat.append(&quot;&quot;&quot;You win this little demo game&quot;&quot;&quot;)
+#     congrat.append(&quot;&quot;)
+#     congrat.append(&quot;Programming:&quot;)
+#     congrat.append(&quot;  Yura Semashko (Yurand)&quot;)
+#     congrat.append(&quot;&quot;)
+#     congrat.append(&quot;Dialogs:&quot;)
+#     congrat.append(&quot;  FrungySnack&quot;)
+#     congrat.append(&quot;  Halleck&quot;)
+#     congrat.append(&quot;  Yura Semashko (Yurand)&quot;)
+#     congrat.append(&quot;&quot;)
+#     congrat.append(&quot;Please, consider help us with TW-Light: Legacies&quot;)
+#     congrat.append(&quot;For detail check our site <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>&quot;)
+#     tml.GameAction.scroll_text(misc.PyListStringToVector(congrat),&quot;images/background.jpg&quot;)
+#     pass
 
 ############################################################################################################
 

Modified: trunk/gamedata/games/test_game/scripts/start.py
===================================================================
--- trunk/gamedata/games/test_game/scripts/start.py	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/gamedata/games/test_game/scripts/start.py	2005-08-06 18:09:53 UTC (rev 175)
@@ -4,30 +4,31 @@
 
 import tml, random
 from quests import *
+from flags import *
 
 # Add player to the game
-tml.GameAction.add_player('Narike', &quot;earcr&quot;, 400, 400)
+tml.GameAction.add_player('Narike', &quot;earcr&quot;, 500, 500)
 
 
 # Add new random enemy as time flow
 
 tml.EventManager.setRepeatableTimeEvent(30, &quot;add_random_enemy_func&quot;)
-
 def add_random_enemy_func():
     if random.random()&lt;0.1:
         tml.GameAction.add_ship(tml.GameAction.get_player_star_system(), &quot;kohma&quot;, -1, -1, tml.GameAction.get_enemy_team())
     if random.random()&lt;0.25:
         tml.GameAction.add_ship(tml.GameAction.get_player_star_system(), &quot;ilwsp&quot;, -1, -1, tml.GameAction.get_enemy_team())
         
-
-#init values for quests
-tml.GameAction.save_flag('escort_transport_accept',0)
-tml.GameAction.save_flag('negotiate_with_chorali_accept',0)
-
+##########################################################################################################################
+        
 # Start quests
-start_precursor_wrack_mission()
+tml.EventManager.distanceLessThen(gflag.precursor_wreck_id,
+                                  tml.GameAction.get_player_ship_id(),
+                                  200,  'check_precursor_wreck_completed_func')
+#start_precursor_wrack_mission()
+#escort_transport_to_ixis_func()
 
-tml.EventManager.shipDeathByType('earcr', 'loose_game')
-def loose_game():
-    tml.GameAction.end_game()
+# tml.EventManager.shipDeathByType('earcr', 'loose_game')
+# def loose_game():
+#     tml.GameAction.end_game()
 

Modified: trunk/gamedata/games/test_game/scripts/systems/gamaonyx.py
===================================================================
--- trunk/gamedata/games/test_game/scripts/systems/gamaonyx.py	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/gamedata/games/test_game/scripts/systems/gamaonyx.py	2005-08-06 18:09:53 UTC (rev 175)
@@ -1,4 +1,6 @@
 import tml
+from flags import *
+
 print &quot;Init Gama Onyx star system&quot;
 
 tml.GameAction.add_system('Gama Onyx',200, 200)

Modified: trunk/gamedata/games/test_game/scripts/systems/ixis.py
===================================================================
--- trunk/gamedata/games/test_game/scripts/systems/ixis.py	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/gamedata/games/test_game/scripts/systems/ixis.py	2005-08-06 18:09:53 UTC (rev 175)
@@ -1,21 +1,29 @@
 import tml
 import random
 import math
+from flags import *
 print &quot;Init Ixis star system&quot;
 
 tml.GameAction.add_system('Ixis',50, 50)
 
 tml.GameAction.add_planet('Ixis','I', 1500, 1800)
+tml.GameAction.add_planet('Ixis','2', 5000, 5000)
 
-tml.GameAction.save_flag( 'ixis_mining_station base',
-                          tml.GameAction.add_orbiter_station('Ixis',
+gflag.ixis_mining_station = tml.GameAction.add_orbiter_station('Ixis',
                                                              'I',
                                                              'gob.dat',
                                                              'station0sprite',
                                                              'gob.dat#station0picture.bmp',
                                                              'earcr',
-                                                             'dialogs/ixis_mining_station_commander.xml'))
+                                                             'dialogs/ixis_mining_station_commander.xml')
 
+gflag.ixis_chorali_station = tml.GameAction.add_orbiter_station('Ixis',
+                                                             '2',
+                                                             'gob.dat',
+                                                             'station0sprite',
+                                                             'gob.dat#station0picture.bmp',
+                                                             'choex',
+                                                             'dialogs/chorali_commander.xml')
 for i in xrange(20):
     tml.GameAction.add_asteroid('Ixis')
 
@@ -26,7 +34,6 @@
 
 # Add Precursor ship wreck
 
-tml.GameAction.save_flag('precursor_wrack_id',
-                         tml.GameAction.add_ship('Ixis', &quot;samat&quot;, 1500, 5000, tml.GameAction.get_enemy_team()))
-tml.GameAction.disable_weapon(tml.GameAction.get_double_flag('precursor_wrack_id'))
+gflag.precursor_wreck_id = tml.GameAction.add_ship('Ixis', &quot;samat&quot;, 1500, 5000, tml.GameAction.get_enemy_team())
+tml.GameAction.disable_weapon(gflag.precursor_wreck_id)
 

Modified: trunk/gamedata/games/test_game/scripts/systems/narike.py
===================================================================
--- trunk/gamedata/games/test_game/scripts/systems/narike.py	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/gamedata/games/test_game/scripts/systems/narike.py	2005-08-06 18:09:53 UTC (rev 175)
@@ -1,18 +1,16 @@
 import tml
+from flags import *
+
 print &quot;Init Narike star system&quot;
 
 tml.GameAction.add_system('Narike',220, 168)
-
 tml.GameAction.add_planet('Narike','Silcuu', 0, 0)
-
-tml.GameAction.save_flag( 'Narike Silcuu Base',
-                          tml.GameAction.add_orbiter_station('Narike',
+gflag.ixis_mining_station = tml.GameAction.add_orbiter_station('Narike',
                                                              'Silcuu',
                                                              'gob.dat',
                                                              'station0sprite',
                                                              'gob.dat#station0picture.bmp',
                                                              'earcr',
-                                                             'dialogs/welcomecommander.xml'))
-
+                                                             'dialogs/welcomecommander.xml')
 for i in xrange(20):
     tml.GameAction.add_asteroid('Narike')

Modified: trunk/gamedata/python/dialog.py
===================================================================
--- trunk/gamedata/python/dialog.py	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/gamedata/python/dialog.py	2005-08-06 18:09:53 UTC (rev 175)
@@ -16,7 +16,7 @@
 #  * runDialogString(str_xml) 
 #  * runDialogFile(file_path)
 
-import unittest, os
+import unittest, os, random, re
 import xml.parsers.expat
 
 &quot;&quot;&quot; For testing purpose we import fake TML implementation that provide the same API as
@@ -31,7 +31,9 @@
     import misc
 
 import quests
+from flags import *
 
+random.seed()
 g_cur_dialog = &quot;&quot;
 
 def runDialogString(str_xml):
@@ -49,7 +51,18 @@
 def endDialog():
     g_cur_dialog.endDialog()    
 #########################################################
+# Helpers functions
 
+def get_text(text):
+    tup = text.split('|')
+    return re.sub(&quot;{(.*?)}&quot;, lambda m: eval(m.group(1)), random.choice(tup))
+
+#########################################################
+class Local:
+    def __init__(self):
+        pass
+local = Local()
+
 class Action:
     def __init__(self,cond,eval):
         self.cond = cond     # should be true for evaluating action
@@ -64,7 +77,7 @@
     
 class PlayerAnswer(Action):
     def __init__(self,text,appear_condition,actions):
-        self.text         = text             # player answer text
+        self.text         = text              # player answer text
         self.cond         = appear_condition  # if true variant visible
         self.actions      = actions           # actions tuple that should run on evaluate
         
@@ -85,18 +98,26 @@
         self.player_answers = player_answers         # player Answers tuple
     def evaluate(self):
         tml.DialogApi.showAlienPicture(self.background)
-        tml.DialogApi.showText(self.alien_text, 0, self.text_location[0], self.text_location[1])
+        tml.DialogApi.showText(get_text(self.alien_text), 0, self.text_location[0], self.text_location[1])
         tml.GetSoundSystem().play_music(self.music)
         answers = filter(lambda x: x.checkCond(), self.player_answers)
         answ_texts = []
         for answer in answers:
-            answ_texts.append(answer.text)
+            answ_texts.append(get_text(answer.text))
         answers[tml.DialogApi.askPlayer(misc.PyListStringToVector(answ_texts))].evaluate()
         
 class Dialog:
-    def __init__(self, nodeset):
+    def __init__(self, startcond = (), endcond = (), nodeset = None):
         self.nodeset  = nodeset     # tuple with all dialog data, terminated by None object
         self.cur_node = nodeset[0]  # currently selectet node
+        global g_cur_dialog
+        g_cur_dialog = self
+        global local
+        local = Local()
+        self.start_cond = startcond
+        self.end_cond   = endcond
+        for act in self.start_cond:
+            act.evaluate()
     def doDialog(self): # run dialog untill selected node != None
         global g_cur_dialog
         g_cur_dialog = self
@@ -107,8 +128,10 @@
     def goto(self,id): # switch current node
         self.cur_node = filter(lambda x: x.id == id, self.nodeset)[0]
     def endDialog(self):
+        for act in self.end_cond:
+            act.evaluate()
         self.cur_node = None
-
+        
 class DialogLoader:
     &quot;&quot;&quot; This class can be used to transform dialog editor's XML files to Dialog objects
 
@@ -120,7 +143,6 @@
         self.p = xml.parsers.expat.ParserCreate()
         self.p.StartElementHandler    = self.start_element
         self.p.EndElementHandler      = self.end_element
-        self.p.CharacterDataHandler   = self.char_data
         self.python_code = &quot;&quot;
     def loadDialogString(self, dlg):
         self.python_code = &quot;&quot;
@@ -139,8 +161,6 @@
     def end_element(self, name):
         endMethod = getattr(self, 'end' + name)
         self.python_code += endMethod( name )
-    def char_data(self, data):
-        print 'Character data:', repr(data)
     ######################################################################
     def startACTION(self, name, attrs):
         return 'Action(&quot;&quot;&quot;' + attrs['condition'] + '&quot;&quot;&quot;,&quot;&quot;&quot;'  + attrs['action'] + '&quot;&quot;&quot;),'
@@ -155,9 +175,13 @@
                attrs['font'] + '&quot;&quot;&quot;,' + \
                attrs['text_location'] + ',('
     def startNODES(self, name, attrs):
-        return 'Dialog(('
+        return 'nodeset = ('
     def startDIALOG(self, name, attrs):
-        return &quot;&quot;
+        return &quot;Dialog( &quot;
+    def startSTART_DIALOG(self, name, attrs):
+        return &quot; startcond = (&quot;
+    def startEND_DIALOG(self, name, attrs):
+        return &quot; endcond = (&quot;
     def startSTART_NODES(self, name, attrs):
         return &quot;&quot;
     def startSTART_NODE(self, name, attrs):
@@ -172,6 +196,10 @@
         return &quot;&quot;
     def endDIALOG(self, name):
         return &quot;&quot;
+    def endSTART_DIALOG(self, name):
+        return &quot;), &quot;
+    def endEND_DIALOG(self, name):
+        return &quot;), &quot;
     def endSTART_NODES(self, name):
         return &quot;&quot;
     def endSTART_NODE(self, name):
@@ -219,18 +247,24 @@
         self.assertEqual(15, test_global_value)
 
 class TestDialogFunctions(unittest.TestCase):
+    start_cond = ()
+    end_cond   = ()
+    nodeset = (
+        Node(0, 'Node1','','','AlienText','',(50,10),
+             (PlayerAnswer('Answer1', '1', (Action('1', 'goto(1)'), )),
+              PlayerAnswer('Answer2', '1', (Action('1', 'endDialog()'),)
+                           )))
+        ,
+        Node(1, 'Node1','','','AlienText','',(50,10),
+             (PlayerAnswer('Answer3', '1', (Action('1', 'endDialog()'),)
+                           ),)),
+        ) 
+    def make_dialog(self, start_cond, end_cond, nodeset):
+        return Dialog(start_cond, end_cond, nodeset)
+    
     def setUp(self):
         tml.DialogApi.clearJornal()
-        self.dialog = Dialog( (
-            Node(0, 'Node1','','','AlienText','',(50,10),
-                 (PlayerAnswer('Answer1', '1', (Action('1', 'goto(1)'), )),
-                  PlayerAnswer('Answer2', '1', (Action('1', 'endDialog()'),)
-                               )))
-            ,
-            Node(1, 'Node1','','','AlienText','',(50,10),
-                 (PlayerAnswer('Answer3', '1', (Action('1', 'endDialog()'),)
-                               ),)),
-            )                         )
+        self.dialog = self.make_dialog( self.start_cond, self.end_cond, self.nodeset)
     def testGoto(self):
         self.dialog.goto(1)
         self.assertEqual(self.dialog.cur_node.id,1)
@@ -240,7 +274,16 @@
     def testDoDialog(self):
         self.dialog.doDialog()
         self.assertEqual(tml.DialogApi.getJornal(),&quot;startDialog showAlienPicture showText play_music askPlayer showAlienPicture showText play_music askPlayer endDialog &quot;)
-
+    def testStartCondition(self):
+        self.dialog = self.make_dialog( (Action('1', 'goto(1)'),), self.end_cond, self.nodeset)
+        self.dialog.doDialog()
+        self.assertEqual(tml.DialogApi.getJornal(),&quot;startDialog showAlienPicture showText play_music askPlayer endDialog &quot;)
+        pass
+    def testUsingLocalVar(self):
+        self.dialog = self.make_dialog( (Action('1', 'goto(1);local.abc=1'),), self.end_cond, self.nodeset)
+        self.assertEqual(1, local.abc)
+        pass
+    
 class TestDialogLoaderFunctions(unittest.TestCase):
     def setUp(self):
         tml.DialogApi.clearJornal()
@@ -276,7 +319,7 @@
     def testNodes(self):
         dlg_ldr = DialogLoader()
         dlg_ldr.start_element('NODES', {})
-        self.assertEqual('Dialog((',dlg_ldr.python_code)
+        self.assertEqual('nodeset = (',dlg_ldr.python_code)
     def testComplexTest(self):
         jornalString = &quot;startDialog showAlienPicture showText play_music askPlayer showAlienPicture showText play_music askPlayer endDialog &quot;
         f = open('test_dialog.xml','r')
@@ -287,7 +330,33 @@
         tml.DialogApi.clearJornal()
         DialogLoader().loadDialogFile('test_dialog.xml').doDialog()
         self.assertEqual(tml.DialogApi.getJornal(),jornalString)
-    
+    def testStartCondition(self):
+        dlg = DialogLoader().loadDialogFile('test_dialog.xml')
+        self.assertEqual(len(dlg.start_cond),2)
+        pass
+    def testStartCondition(self):
+        dlg = DialogLoader().loadDialogFile('test_dialog.xml')
+        self.assertEqual(len(dlg.end_cond),1)
+        pass
+
+class TestGetAlienTextFunction(unittest.TestCase):
+    def testSimpleRandom(self):
+        text = &quot;Hi|Hello&quot;
+        res = get_text(text)
+        self.assert_(res == &quot;Hi&quot; or res == &quot;Hello&quot;)
+    def testSimpleRandomEmpty(self):
+        self.assertEqual(get_text(&quot;&quot;),&quot;&quot;)
+    def testTextWithCalledCode(self):
+        global test_player_name
+        test_player_name = &quot;Yura&quot;
+        text = &quot;hi, {test_player_name}!&quot;
+        self.assertEqual(get_text(text),&quot;hi, Yura!&quot;)
+    def testTextWith2CalledCode(self):
+        global test_player_name
+        test_player_name = &quot;Yura&quot;
+        text = &quot;hi, {test_player_name} {test_player_name}!&quot;
+        self.assertEqual(get_text(text),&quot;hi, Yura Yura!&quot;)
+
 if __name__ == '__main__':
     unittest.main()
 

Added: trunk/gamedata/python/flags.py
===================================================================

Added: trunk/gamedata/python/quests.py
===================================================================
--- trunk/gamedata/python/quests.py	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/gamedata/python/quests.py	2005-08-06 18:09:53 UTC (rev 175)
@@ -0,0 +1 @@
+# just to allow run unit tests from dialogs

Modified: trunk/gamedata/python/tml.py
===================================================================
--- trunk/gamedata/python/tml.py	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/gamedata/python/tml.py	2005-08-06 18:09:53 UTC (rev 175)
@@ -93,6 +93,8 @@
     if _newclass:scroll_text = staticmethod(_tml.GameAction_scroll_text)
     __swig_getmethods__[&quot;print_message&quot;] = lambda x: _tml.GameAction_print_message
     if _newclass:print_message = staticmethod(_tml.GameAction_print_message)
+    __swig_getmethods__[&quot;set_camera_mode&quot;] = lambda x: _tml.GameAction_set_camera_mode
+    if _newclass:set_camera_mode = staticmethod(_tml.GameAction_set_camera_mode)
     def __init__(self, *args):
         _swig_setattr(self, GameAction, 'this', _tml.new_GameAction(*args))
         _swig_setattr(self, GameAction, 'thisown', 1)
@@ -162,6 +164,8 @@
 
 GameAction_print_message = _tml.GameAction_print_message
 
+GameAction_set_camera_mode = _tml.GameAction_set_camera_mode
+
 class DialogApi(_object):
     __swig_setmethods__ = {}
     __setattr__ = lambda self, name, value: _swig_setattr(self, DialogApi, name, value)
@@ -253,8 +257,8 @@
     if _newclass:setRepeatableTimeEvent = staticmethod(_tml.EventManager_setRepeatableTimeEvent)
     __swig_getmethods__[&quot;disableEvent&quot;] = lambda x: _tml.EventManager_disableEvent
     if _newclass:disableEvent = staticmethod(_tml.EventManager_disableEvent)
-    __swig_getmethods__[&quot;shipDeathByName&quot;] = lambda x: _tml.EventManager_shipDeathByName
-    if _newclass:shipDeathByName = staticmethod(_tml.EventManager_shipDeathByName)
+    __swig_getmethods__[&quot;shipDeathById&quot;] = lambda x: _tml.EventManager_shipDeathById
+    if _newclass:shipDeathById = staticmethod(_tml.EventManager_shipDeathById)
     __swig_getmethods__[&quot;shipDeathByType&quot;] = lambda x: _tml.EventManager_shipDeathByType
     if _newclass:shipDeathByType = staticmethod(_tml.EventManager_shipDeathByType)
     __swig_getmethods__[&quot;distanceMoreThen&quot;] = lambda x: _tml.EventManager_distanceMoreThen
@@ -290,7 +294,7 @@
 
 EventManager_disableEvent = _tml.EventManager_disableEvent
 
-EventManager_shipDeathByName = _tml.EventManager_shipDeathByName
+EventManager_shipDeathById = _tml.EventManager_shipDeathById
 
 EventManager_shipDeathByType = _tml.EventManager_shipDeathByType
 

Modified: trunk/source/games/ggob.cpp
===================================================================
--- trunk/source/games/ggob.cpp	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/source/games/ggob.cpp	2005-08-06 18:09:53 UTC (rev 175)
@@ -52,7 +52,7 @@
 #include &quot;tml/eventmanager.h&quot;
 #include &quot;tml/gameaction.h&quot;
 
-#include &quot;melee/GobWarpOutTrail.h&quot;
+#include &quot;other/gobwarpouttrail.h&quot;
 //#include &quot;melee/WarpOutTrail.h&quot;
 
 #define gobgame ((GobGame*)game)
@@ -94,7 +94,7 @@
 }
 
 ////////////////////////////////////////////////////////////////////////
-//				Gob stuff
+//              Gob stuff
 ////////////////////////////////////////////////////////////////////////
 
 GobAsteroid::GobAsteroid( Vector2 opos, double oangle, int ospeed)
@@ -135,7 +135,7 @@
     {
       GobPlayer *p = gobgame-&gt;get_player(source);
       if (p) 
-	p-&gt;buckazoids += 1;
+    p-&gt;buckazoids += 1;
     }
   return i;
 }
@@ -144,7 +144,7 @@
 {
   STACKTRACE;
   Animation *a = new Animation(this, pos,
-			       explosion, 0, explosion-&gt;frames(), time_ratio, get_depth());
+                   explosion, 0, explosion-&gt;frames(), time_ratio, get_depth());
   a-&gt;match_velocity(this);
   game-&gt;add(a);
 
@@ -202,16 +202,16 @@
   item.remove(gobplayer.ship);
   
   std::list&lt;StarSystem*&gt;::iterator sNew = std::find_if(_galaxy._stars.begin(), 
-						 _galaxy._stars.end(), 
-						 std::bind2nd(findStar(), name));
+                         _galaxy._stars.end(), 
+                         std::bind2nd(findStar(), name));
   if(sNew==_galaxy._stars.end())
     {
       tw_error(&quot;Star not found&quot;);
     }
 
   std::list&lt;StarSystem*&gt;::iterator sOld = std::find_if(_galaxy._stars.begin(), 
-						 _galaxy._stars.end(), 
-						 std::bind2nd(findStar(), _name));
+                         _galaxy._stars.end(), 
+                         std::bind2nd(findStar(), _name));
   if(sOld==_galaxy._stars.end())
     {
       tw_error(&quot;Star not found&quot;);
@@ -228,7 +228,7 @@
       remove(item.back());
       if(item.size()==psize)
       {
-	tw_error(&quot;!!!!@@!!@$##$%#$^%#$@#&quot;);
+    tw_error(&quot;!!!!@@!!@$##$%#$^%#$@#&quot;);
       }
       psize = item.size();
     }
@@ -268,11 +268,11 @@
   _player_panel-&gt;window-&gt;init(window);
   
   _player_panel-&gt;window-&gt;locate(
-			0,0.9,
-			0,0,
-			0,0.1,
-			0,0.25
-			);
+            0,0.9,
+            0,0,
+            0,0.1,
+            0,0.25
+            );
   _player_panel-&gt;set_depth(10);
   add(_player_panel);
 }
@@ -300,13 +300,13 @@
 {
   return;
   /*
-	double v;
-	Vector2 d = source-&gt;normal_pos() - space_center;
-	d = normalize(d + size/2, size) - size/2;
-	v = 1000;
-	if (space_zoom &gt; 0.01) v = 500 + space_view_size.x / space_zoom / 4;
-	v = 1 + magnitude_sqr(d) / (v*v);
-	Game::play_sound(sample, source, iround(vol/v), freq);
+    double v;
+    Vector2 d = source-&gt;normal_pos() - space_center;
+    d = normalize(d + size/2, size) - size/2;
+    v = 1000;
+    if (space_zoom &gt; 0.01) v = 500 + space_view_size.x / space_zoom / 4;
+    v = 1 + magnitude_sqr(d) / (v*v);
+    Game::play_sound(sample, source, iround(vol/v), freq);
   */
 }
 
@@ -348,7 +348,7 @@
 
   player_team = new_team();
   enemy_team  = new_team();
-	       
+           
 
   int server_players;
   tw_set_config_file(&quot;client.ini&quot;);
@@ -365,8 +365,8 @@
 
 
   for_each_file( (GameConfig::GetGameDirectory() + &quot;scripts/systems/*.py&quot;).c_str(), 
-		 FA_ARCH|FA_RDONLY, 
-		 _exec_py_script, 0);
+         FA_ARCH|FA_RDONLY, 
+         _exec_py_script, 0);
   _galaxy._stars.remove(s);
   delete s;
   _exec_py_script(GameConfig::GetAbsolutePath(&quot;scripts/start.py&quot;).c_str(), 0, 0);
@@ -378,11 +378,11 @@
 
   this-&gt;change_view(&quot;Hero&quot;);
   view-&gt;window-&gt;locate(
-		       0,0,
-		       0,0,
-		       0,0.9,
-		       0,1
-		       );
+               0,0,
+               0,0,
+               0,0.9,
+               0,1
+               );
   return;
 }
 
@@ -426,18 +426,18 @@
   for(std::list&lt;SpaceLocation*&gt;::iterator i= item.begin(); i!= item.end();i++)
     {
       if(*i &amp;&amp; (*i)-&gt;isPlanet() &amp;&amp; (*i)-&gt;exists() &amp;&amp; ((Planet*)(*i))-&gt;get_name() == name)
-	return (Planet*)(*i);
+    return (Planet*)(*i);
     }
   return NULL;
 }
 
 int GobGame::add_orbiter_station(const std::string&amp; system, 
-			     const std::string&amp; planet, 
-			     const std::string&amp; gatafile,
-			     const std::string&amp; station_sprite,
-			     const std::string&amp; background_picture,
-			     const std::string&amp; buildtype,
-			     const std::string&amp; commander_dialog)
+                 const std::string&amp; planet, 
+                 const std::string&amp; gatafile,
+                 const std::string&amp; station_sprite,
+                 const std::string&amp; background_picture,
+                 const std::string&amp; buildtype,
+                 const std::string&amp; commander_dialog)
 {
   STACKTRACE;
   Planet* p = get_planet(planet);
@@ -470,8 +470,8 @@
   if (gobplayer.ship) 
     {
       message.print((int)msecs_per_fps, 15-i, &quot;coordinates: %d x %d&quot;, 
-		    iround(gobplayer.ship-&gt;normal_pos().x), 
-		    iround(gobplayer.ship-&gt;normal_pos().y));
+            iround(gobplayer.ship-&gt;normal_pos().x), 
+            iround(gobplayer.ship-&gt;normal_pos().y));
     }
   message.print((int)msecs_per_fps, 15-i, &quot;starbucks: %d&quot;, gobplayer.starbucks);
   message.print((int)msecs_per_fps, 15-i, &quot;buckazoids: %d&quot;,gobplayer.buckazoids);
@@ -493,17 +493,17 @@
       e -= random() % (1 + game_time / (250 * 1000));
       if (0) ;
       else if (e &gt;=12) 
-	next_add_new_enemy_time += 15000;
+    next_add_new_enemy_time += 15000;
       else if (e &gt;= 7) 
-	next_add_new_enemy_time += 7000;
+    next_add_new_enemy_time += 7000;
       else if (e &gt;= 4) 
-	next_add_new_enemy_time += 5000;
+    next_add_new_enemy_time += 5000;
       else if (e &gt;= 2) 
-	next_add_new_enemy_time += 3000;
+    next_add_new_enemy_time += 3000;
       else if (e &gt;= 1) 
-	next_add_new_enemy_time += 2000;
+    next_add_new_enemy_time += 2000;
       else 
-	next_add_new_enemy_time += 1000;
+    next_add_new_enemy_time += 1000;
     }
   Game::calculate();
   EventManager::calculate();
@@ -560,34 +560,18 @@
   STACKTRACE;
   switch (k &gt;&gt; 8) 
     {
-    case KEY_J: 
-      {
-	if(_name==&quot;Arix&quot;)
-	  {
-	    add(GobWarpOutTrail::getGobWarpOutTrail(gobplayer.ship, &quot;Beta&quot;, this));
-	    //switch_system(&quot;Beta&quot;);
-	  }
-	else
-	  {
-	    add(GobWarpOutTrail::getGobWarpOutTrail(gobplayer.ship, &quot;Arix&quot;, this));
-	    //switch_system(&quot;Arix&quot;);
-	  }
-	
-	return true;
-      }
-      break;
     case KEY_M:
       {
-	add( GobWarpOutTrail::getGobWarpOutTrail(gobplayer.ship, _galaxy.select(), this));
-	//game-&gt;add( WarpOutTrail::getWarpOutTrail(gobplayer.ship) );
-	//switch_system(_galaxy.select());
-	videosystem-&gt;window.redraw();
-	return true;
+    add( GobWarpOutTrail::getGobWarpOutTrail(gobplayer.ship, _galaxy.select(), this));
+    //game-&gt;add( WarpOutTrail::getWarpOutTrail(gobplayer.ship) );
+    //switch_system(_galaxy.select());
+    videosystem-&gt;window.redraw();
+    return true;
       }
       break;
     default: 
       {
-	return GobGameBase::handle_key(k);
+    return GobGameBase::handle_key(k);
       }
       break;
     }
@@ -623,13 +607,13 @@
   int e = 99999;
   while (e &gt;= num_enemy_types) {
 /*
-base	time	low		high
+base    time    low     high
 
-  1		.5		-0.1	3.7
-  10	5		2.62	7.47
-  50	25		5.89	14.24
- 100	50		8.1		17.3
- 200	100		11.01	26.49
+  1     .5      -0.1    3.7
+  10    5       2.62    7.47
+  50    25      5.89    14.24
+ 100    50      8.1     17.3
+ 200    100     11.01   26.49
 
 
 
@@ -645,7 +629,7 @@
     e = e;
   }
   Ship *ship = create_ship(channel_server, enemy_types[e], &quot;WussieBot&quot;, 
-			   random(size), random(PI2), enemy_team);
+               random(size), random(PI2), enemy_team);
 
   int sb, bz;
   sb = 1 + e / 4;
@@ -678,7 +662,7 @@
   std::string cur_sys = _name;
   switch_system(system);
   Ship *ship = create_ship(channel_server, shptype.c_str(), &quot;WussieBot&quot;, 
-			   pos, random(PI2), team);
+               pos, random(PI2), team);
   add(ship-&gt;get_ship_phaser());
   
   switch_system(cur_sys);
@@ -780,7 +764,7 @@
   for (i = 0; i &lt; num_pairs; i += 1) 
     {
       if (!strcmp(pair_list[i].id, id)) 
-	return &amp;pair_list[i];
+    return &amp;pair_list[i];
     }
   return NULL;
 }
@@ -827,7 +811,7 @@
   if ((starbucks &lt; price_starbucks) || (buckazoids &lt; price_buckazoids)) 
     {
       if (game-&gt;is_local(gobgame-&gt;_player_control-&gt;channel)) 
-	alert(&quot;You don't have enough.&quot;, name, buffy1, &quot;Cancel&quot;, NULL, 0, 0);
+    alert(&quot;You don't have enough.&quot;, name, buffy1, &quot;Cancel&quot;, NULL, 0, 0);
       return 0;
     }
   int r = 0;
@@ -884,7 +868,7 @@
     {
       sprintf (buffy1, &quot;You already have a %s&quot;, ntype-&gt;name);
       if (game-&gt;is_local(gobgame-&gt;_player_control-&gt;channel)) 
-	alert(buffy1, NULL, NULL, &quot;&amp;Cancel&quot;, NULL, 'c', 0);
+    alert(buffy1, NULL, NULL, &quot;&amp;Cancel&quot;, NULL, 'c', 0);
       return;
     }
   int ossb = (s-&gt;value_starbucks*3) / 4 + (s-&gt;ship-&gt;type-&gt;cost*1)/1;
@@ -897,25 +881,25 @@
     {
       int i = 0;
       if (game-&gt;is_local(gobgame-&gt;_player_control-&gt;channel))
-	i = alert(buffy1, buffy2, &quot;Do you wish to buy it?&quot;, &quot;Yeah!&quot;, &quot;No&quot;, 'y', 'n');
+    i = alert(buffy1, buffy2, &quot;Do you wish to buy it?&quot;, &quot;Yeah!&quot;, &quot;No&quot;, 'y', 'n');
       game-&gt;log_int(gobgame-&gt;_player_control-&gt;channel, i);
       if (i == 1) 
-	{
-	  s-&gt;starbucks -= nssb - ossb;
-	  s-&gt;buckazoids -= nsbz - osbz;
-	  s-&gt;new_ship(ntype);
-	}
+    {
+      s-&gt;starbucks -= nssb - ossb;
+      s-&gt;buckazoids -= nsbz - osbz;
+      s-&gt;new_ship(ntype);
     }
+    }
   else 
     {
       if (game-&gt;is_local(gobgame-&gt;_player_control-&gt;channel)) 
-	alert (buffy1, buffy2, &quot;You don't have enough to buy it&quot;, &quot;Cancel&quot;, NULL, 0, 0);
+    alert (buffy1, buffy2, &quot;You don't have enough to buy it&quot;, &quot;Cancel&quot;, NULL, 0, 0);
     }
   return;
 }
 
 GobStation::GobStation ( SpaceSprite *pic, SpaceLocation *orbit_me, const std::string&amp; ship, 
-			 const std::string&amp; background) : 
+             const std::string&amp; background) : 
   Orbiter(pic, orbit_me, random() % 200 + 500) 
 {
   _build_type = ship;
@@ -956,110 +940,110 @@
     game-&gt;window-&gt;lock();
     aa_set_mode(AA_DITHER);
     aa_stretch_blit(background, game-&gt;window-&gt;surface, 
-		    0,0,background-&gt;w,background-&gt;h, 
-		    game-&gt;window-&gt;x,game-&gt;window-&gt;y,game-&gt;window-&gt;w, game-&gt;window-&gt;h);
+            0,0,background-&gt;w,background-&gt;h, 
+            game-&gt;window-&gt;x,game-&gt;window-&gt;y,game-&gt;window-&gt;w, game-&gt;window-&gt;h);
     game-&gt;window-&gt;unlock();
 
     sprintf(dialog_string[0], &quot;%03d Starbucks  %03d Buckazoids&quot;, s-&gt;starbucks, s-&gt;buckazoids);
     int r = 0;
     if (game-&gt;is_local(gobgame-&gt;_player_control-&gt;channel)) 
       r = tw_do_dialog(game-&gt;window, station_dialog, STATION_DIALOG_DEPART);
-		game-&gt;log_int(gobgame-&gt;_player_control-&gt;channel, r);
-		switch (r) {
-		case STATION_DIALOG_UPGRADE: {
-		  upgrade_menu(this, s);
-				aa_set_mode(AA_DITHER);
-				aa_stretch_blit(background, game-&gt;window-&gt;surface, 
-						0,0,background-&gt;w,background-&gt;h, 
-						game-&gt;window-&gt;x,game-&gt;window-&gt;y,
-						game-&gt;window-&gt;w, game-&gt;window-&gt;h);
-		}
-		  break;
-		case STATION_DIALOG_NEWSHIP: 
-		  {
-		    buy_new_ship_menu(s);
-		  }
-		  break;
-		case STATION_DIALOG_REPAIR: 
-		  {
-		    if (s-&gt;ship-&gt;crew == s-&gt;ship-&gt;crew_max) 
-		      {
-			if (game-&gt;is_local(gobgame-&gt;_player_control-&gt;channel)) 
-			  alert(&quot;You don't need repairs&quot;, &quot;&quot;, &quot;&quot;, &quot;Oh, okay&quot;, &quot;I knew that&quot;, 0, 0);			
-			break;
-		      }
-		    int p = 0;
-		    if (game-&gt;is_local(gobgame-&gt;_player_control-&gt;channel)) 
-		      p = alert3(&quot;Which would you prefer&quot;, &quot;to pay for your repairs&quot;, &quot;&quot;, &quot;1 &amp;Starbuck&quot;, &quot;1 &amp;Buckazoid&quot;, &quot;&amp;Nothing!&quot;, 's', 'b', 'n');
-		    game-&gt;log_int(gobgame-&gt;_player_control-&gt;channel, p);
-		    switch (p) {
-		    case 1: 
-		      {
-			if (s-&gt;starbucks) 
-			  {
-			    s-&gt;starbucks -= 1;
-			    s-&gt;ship-&gt;crew = s-&gt;ship-&gt;crew_max;
-			  }
-			else 
-			  {
-			    if (game-&gt;is_local(gobgame-&gt;_player_control-&gt;channel)) 
-			      alert(&quot;You don't have enough!&quot;, NULL, NULL, &quot;&amp;Shit&quot;, NULL, 's', 0);
-			  }
-		      }
-		      break;
-		    case 2: 
-		      {
-			if (s-&gt;buckazoids) 
-			  {
-			    s-&gt;buckazoids -= 1;
-			    s-&gt;ship-&gt;crew = s-&gt;ship-&gt;crew_max;
-			  }
-			else 
-			  {
-			    if (game-&gt;is_local(gobgame-&gt;_player_control-&gt;channel)) 
-			      alert(&quot;You don't have enough!&quot;, NULL, NULL, &quot;&amp;Shit&quot;, NULL, 's', 0);
-			  }
-		      }
-		      break;
-		    case 3: 
-		      {
-			r = STATION_DIALOG_DEPART;
-		      }
-		      break;
-		    }
-		  }
-		  break;
-		case STATION_DIALOG_COMMANDER:
-		  {
-		    chat_with_player();
-		  }
-		  break;
-		}
-		if (r == STATION_DIALOG_DEPART) 
-		  break;
+        game-&gt;log_int(gobgame-&gt;_player_control-&gt;channel, r);
+        switch (r) {
+        case STATION_DIALOG_UPGRADE: {
+          upgrade_menu(this, s);
+                aa_set_mode(AA_DITHER);
+                aa_stretch_blit(background, game-&gt;window-&gt;surface, 
+                        0,0,background-&gt;w,background-&gt;h, 
+                        game-&gt;window-&gt;x,game-&gt;window-&gt;y,
+                        game-&gt;window-&gt;w, game-&gt;window-&gt;h);
+        }
+          break;
+        case STATION_DIALOG_NEWSHIP: 
+          {
+            buy_new_ship_menu(s);
+          }
+          break;
+        case STATION_DIALOG_REPAIR: 
+          {
+            if (s-&gt;ship-&gt;crew == s-&gt;ship-&gt;crew_max) 
+              {
+            if (game-&gt;is_local(gobgame-&gt;_player_control-&gt;channel)) 
+              alert(&quot;You don't need repairs&quot;, &quot;&quot;, &quot;&quot;, &quot;Oh, okay&quot;, &quot;I knew that&quot;, 0, 0);         
+            break;
+              }
+            int p = 0;
+            if (game-&gt;is_local(gobgame-&gt;_player_control-&gt;channel)) 
+              p = alert3(&quot;Which would you prefer&quot;, &quot;to pay for your repairs&quot;, &quot;&quot;, &quot;1 &amp;Starbuck&quot;, &quot;1 &amp;Buckazoid&quot;, &quot;&amp;Nothing!&quot;, 's', 'b', 'n');
+            game-&gt;log_int(gobgame-&gt;_player_control-&gt;channel, p);
+            switch (p) {
+            case 1: 
+              {
+            if (s-&gt;starbucks) 
+              {
+                s-&gt;starbucks -= 1;
+                s-&gt;ship-&gt;crew = s-&gt;ship-&gt;crew_max;
+              }
+            else 
+              {
+                if (game-&gt;is_local(gobgame-&gt;_player_control-&gt;channel)) 
+                  alert(&quot;You don't have enough!&quot;, NULL, NULL, &quot;&amp;Shit&quot;, NULL, 's', 0);
+              }
+              }
+              break;
+            case 2: 
+              {
+            if (s-&gt;buckazoids) 
+              {
+                s-&gt;buckazoids -= 1;
+                s-&gt;ship-&gt;crew = s-&gt;ship-&gt;crew_max;
+              }
+            else 
+              {
+                if (game-&gt;is_local(gobgame-&gt;_player_control-&gt;channel)) 
+                  alert(&quot;You don't have enough!&quot;, NULL, NULL, &quot;&amp;Shit&quot;, NULL, 's', 0);
+              }
+              }
+              break;
+            case 3: 
+              {
+            r = STATION_DIALOG_DEPART;
+              }
+              break;
+            }
+          }
+          break;
+        case STATION_DIALOG_COMMANDER:
+          {
+            chat_with_player();
+          }
+          break;
+        }
+        if (r == STATION_DIALOG_DEPART) 
+          break;
   }
   return;
 }
 void GobStation::inflict_damage(SpaceObject *other) {
   STACKTRACE;
-	SpaceObject::inflict_damage(other);
-	if (!other-&gt;isShip()) return;
-	GobPlayer *p = gobgame-&gt;get_player(other);
-	if (!p) return;
-	gobgame-&gt;pause();
-	char buffy[256];
-	int a;
-	sprintf(buffy, &quot;First visited station %s at time&quot;, _build_type.c_str());
-	a = p-&gt;read_pair(buffy);
-	if (a == -1) p-&gt;write_pair(buffy, game-&gt;game_time);
-	sprintf(buffy, &quot;Visited station %s N times&quot;, _build_type.c_str());
-	a = p-&gt;read_pair(buffy);
-	if (a == -1) a = 0;
-	p-&gt;write_pair(buffy, a+1);
-	station_screen(p);
-	gobgame-&gt;unpause();
-	return;
-	}
+    SpaceObject::inflict_damage(other);
+    if (!other-&gt;isShip()) return;
+    GobPlayer *p = gobgame-&gt;get_player(other);
+    if (!p) return;
+    gobgame-&gt;pause();
+    char buffy[256];
+    int a;
+    sprintf(buffy, &quot;First visited station %s at time&quot;, _build_type.c_str());
+    a = p-&gt;read_pair(buffy);
+    if (a == -1) p-&gt;write_pair(buffy, game-&gt;game_time);
+    sprintf(buffy, &quot;Visited station %s N times&quot;, _build_type.c_str());
+    a = p-&gt;read_pair(buffy);
+    if (a == -1) a = 0;
+    p-&gt;write_pair(buffy, a+1);
+    station_screen(p);
+    gobgame-&gt;unpause();
+    return;
+    }
 
 
 
@@ -1067,15 +1051,15 @@
 int upgrade_index[999];
 GobPlayer *upgrade_list_for;
 char *upgradeListboxGetter(int index, int *list_size) {
-	static char tmp[150];
-	if(index &lt; 0) {
-		*list_size = num_upgrade_indexes;
-		return NULL;
-		}
-	int i = upgrade_index[index];
-	sprintf(tmp, &quot;%1d %3d s$ / %3d b$  :  %s&quot;, upgrade_list_for-&gt;upgrade_list[i]-&gt;num, upgrade_list_for-&gt;upgrade_list[i]-&gt;starbucks, upgrade_list_for-&gt;upgrade_list[i]-&gt;buckazoids, upgrade_list_for-&gt;upgrade_list[i]-&gt;name);
-	return tmp;
-	}
+    static char tmp[150];
+    if(index &lt; 0) {
+        *list_size = num_upgrade_indexes;
+        return NULL;
+        }
+    int i = upgrade_index[index];
+    sprintf(tmp, &quot;%1d %3d s$ / %3d b$  :  %s&quot;, upgrade_list_for-&gt;upgrade_list[i]-&gt;num, upgrade_list_for-&gt;upgrade_list[i]-&gt;starbucks, upgrade_list_for-&gt;upgrade_list[i]-&gt;buckazoids, upgrade_list_for-&gt;upgrade_list[i]-&gt;name);
+    return tmp;
+    }
 #define UPGRADE_DIALOG_EXIT 0
 #define UPGRADE_DIALOG_LIST 3
 static DIALOG upgrade_dialog[] =
@@ -1099,8 +1083,8 @@
     int j = 0;
     for (i = 0; gs-&gt;upgrade_list[i]; i += 1) {
       if (gs-&gt;upgrade_list[i]-&gt;update(gs-&gt;ship, station, gs)) {
-	upgrade_index[j] = i;
-	j += 1;
+    upgrade_index[j] = i;
+    j += 1;
       }
     }
     num_upgrade_indexes = j;
@@ -1108,162 +1092,163 @@
     if (game-&gt;is_local(gobgame-&gt;_player_control-&gt;channel))
       m = tw_do_dialog(game-&gt;window, upgrade_dialog, UPGRADE_DIALOG_EXIT);
     game-&gt;log_int(gobgame-&gt;_player_control-&gt;channel, m);
-		if (m == UPGRADE_DIALOG_EXIT) return;
-		if (m == UPGRADE_DIALOG_LIST) {
-			int i = 0;
-			if (game-&gt;is_local(gobgame-&gt;_player_control-&gt;channel))
-				i = upgrade_dialog[UPGRADE_DIALOG_LIST].d1;
-			game-&gt;log_int(gobgame-&gt;_player_control-&gt;channel, i);
-			i = upgrade_index[i];
-			Upgrade *u = gs-&gt;upgrade_list[i];
-			if (gs-&gt;charge(u-&gt;name, u-&gt;starbucks, u-&gt;buckazoids)) {
-				u-&gt;execute(gs-&gt;ship, station, gs);
-				u-&gt;charge(gs);
-				}
-			}
-		}
-	return;
-	}
+        if (m == UPGRADE_DIALOG_EXIT) return;
+        if (m == UPGRADE_DIALOG_LIST) {
+            int i = 0;
+            if (game-&gt;is_local(gobgame-&gt;_player_control-&gt;channel))
+                i = upgrade_dialog[UPGRADE_DIALOG_LIST].d1;
+            game-&gt;log_int(gobgame-&gt;_player_control-&gt;channel, i);
+            i = upgrade_index[i];
+            Upgrade *u = gs-&gt;upgrade_list[i];
+            if (gs-&gt;charge(u-&gt;name, u-&gt;starbucks, u-&gt;buckazoids)) {
+                u-&gt;execute(gs-&gt;ship, station, gs);
+                u-&gt;charge(gs);
+                }
+            }
+        }
+    return;
+    }
 
 GobDefender::GobDefender ( Ship *ship) 
 : SpaceObject (ship, ship-&gt;normal_pos(), 0, gobgame-&gt;defenderSprite)
 {
-	base_phase = 0;
-	next_shoot_time = 0;
-	collide_flag_anyone = 0;
+    base_phase = 0;
+    next_shoot_time = 0;
+    collide_flag_anyone = 0;
 }
 void GobDefender::calculate() {
   STACKTRACE;
-	SpaceObject::calculate();
-	if (!ship) {
-		die();
-		return;
-	}
-	if (next_shoot_time &lt; gobgame-&gt;game_time) {
-		SpaceObject *target = NULL;
-		Query q;
-		q.begin(this, OBJECT_LAYERS &amp;~ bit(LAYER_SHIPS), 300);
-		while (q.currento &amp;&amp; !target) {
-			if (!q.currento-&gt;sameTeam(ship)) {
-				SpaceLine *l = new PointLaser ( 
-					this, palette_color[4], 2, 150, 
-					this, q.currento
-					);
-				add(l);
-				if (l-&gt;exists()) target = q.currento;
-			}
-			q.next();
-		}
-		if (target) {
-			next_shoot_time = gobgame-&gt;game_time + 400;
-		}
-	}
-	double a = base_phase + (gobgame-&gt;game_time % 120000) * ( PI2 / 1000.0) / 6;
-	angle = normalize(a,PI2);
-	pos = normalize(ship-&gt;normal_pos() + 270 * unit_vector ( angle ));
-	return;
+    SpaceObject::calculate();
+    if (!ship) {
+        die();
+        return;
+    }
+    if (next_shoot_time &lt; gobgame-&gt;game_time) {
+        SpaceObject *target = NULL;
+        Query q;
+        q.begin(this, OBJECT_LAYERS &amp;~ bit(LAYER_SHIPS), 300);
+        while (q.currento &amp;&amp; !target) {
+            if (!q.currento-&gt;sameTeam(ship)) {
+                SpaceLine *l = new PointLaser ( 
+                    this, palette_color[4], 2, 150, 
+                    this, q.currento
+                    );
+                add(l);
+                if (l-&gt;exists()) target = q.currento;
+            }
+            q.next();
+        }
+        if (target) {
+            next_shoot_time = gobgame-&gt;game_time + 400;
+        }
+    }
+    double a = base_phase + (gobgame-&gt;game_time % 120000) * ( PI2 / 1000.0) / 6;
+    angle = normalize(a,PI2);
+    pos = normalize(ship-&gt;normal_pos() + 270 * unit_vector ( angle ));
+    return;
 }
 
 RainbowRift::RainbowRift () 
 //: SpaceLocation ( NULL, 12800, 12800, 0) 
 : SpaceLocation ( NULL, random(map_size), 0) 
 {
-	int i;
-	collide_flag_sameship = 0;
-	collide_flag_sameteam = 0;
-	collide_flag_anyone = 0;
-	for (i = n*6-6; i &lt; n*6+2; i += 1) {
-		p[i] = 75 + random(150.0);
-	}
-	for (i = 0; i &lt; n; i += 1) {
-		squiggle();
-	}
-	next_time = game-&gt;game_time;
-	next_time2 = game-&gt;game_time;
+    int i;
+    collide_flag_sameship = 0;
+    collide_flag_sameteam = 0;
+    collide_flag_anyone = 0;
+    for (i = n*6-6; i &lt; n*6+2; i += 1) {
+        p[i] = 75 + random(150.0);
+    }
+    for (i = 0; i &lt; n; i += 1) {
+        squiggle();
+    }
+    next_time = game-&gt;game_time;
+    next_time2 = game-&gt;game_time;
 }
 void RainbowRift::animate( Frame *frame ) {
   STACKTRACE;
-	Vector2 s;
-	s = corner(pos, Vector2(300,300));
-	if ((s.x &lt; -500) || (s.x &gt; space_view_size.x + 500) || 
-		(s.y &lt; -500) || (s.y &gt; space_view_size.y + 500))
-		return;
-	int b[n*6+2];
-	int i;
-	for (i = 0; i &lt; n*6+2; i += 2) { 
-		b[i] = iround(s.x + p[i] * space_zoom);
-		b[i+1] = iround(s.y + p[i+1] * space_zoom);
-	}
-	for (i = 0; i &lt; n; i += 1) {
-		RGB tc = c[n-i-1];
-		int a = tw_color(tc.r, tc.g, tc.b);
-		spline ( frame-&gt;surface, &amp;b[i*6], a );
-	}
-	frame-&gt;add_box ( 
-		iround(s.x - 2), iround(s.y -2), 
-		iround(300 * space_zoom+5), iround(300 * space_zoom+5)
-		);
-	return;
+    Vector2 s;
+    s = corner(pos, Vector2(300,300));
+    if ((s.x &lt; -500) || (s.x &gt; space_view_size.x + 500) || 
+        (s.y &lt; -500) || (s.y &gt; space_view_size.y + 500))
+        return;
+    int b[n*6+2];
+    int i;
+    for (i = 0; i &lt; n*6+2; i += 2) { 
+        b[i] = iround(s.x + p[i] * space_zoom);
+        b[i+1] = iround(s.y + p[i+1] * space_zoom);
+    }
+    for (i = 0; i &lt; n; i += 1) {
+        RGB tc = c[n-i-1];
+        int a = tw_color(tc.r, tc.g, tc.b);
+        spline ( frame-&gt;surface, &amp;b[i*6], a );
+    }
+    frame-&gt;add_box ( 
+        iround(s.x - 2), iround(s.y -2), 
+        iround(300 * space_zoom+5), iround(300 * space_zoom+5)
+        );
+    return;
 }
 void RainbowRift::squiggle() {
   STACKTRACE;
-	int i;
-	int m = n*6+2;
-	for (i = 0; i &lt; m - 6; i += 1) {
-		p[i] = p[i+6];
-	}
-	p[m-6] = p[m-8] * 2 - p[m-10];
-	p[m-5] = p[m-7] * 2 - p[m-9];
-	p[m-4] = 75 + random(150.0);
-	p[m-3] = 75 + random(150.0);
-	p[m-2] = 75 + random(150.0);
-	p[m-1] = 75 + random(150.0);
-	for (i = 0; i &lt; n-1; i += 1) {
-		c[i] = c[i+1];
-	}
-	int r, g, b;
-	r = int(game-&gt;game_time * 0.5) % 360;
-	hsv_to_rgb( r, 1.0, 1.0, &amp;r, &amp;g, &amp;b );
-	c[n-1].r = r;
-	c[n-1].g = g;
-	c[n-1].b = b;
-	return;
+    int i;
+    int m = n*6+2;
+    for (i = 0; i &lt; m - 6; i += 1) {
+        p[i] = p[i+6];
+    }
+    p[m-6] = p[m-8] * 2 - p[m-10];
+    p[m-5] = p[m-7] * 2 - p[m-9];
+    p[m-4] = 75 + random(150.0);
+    p[m-3] = 75 + random(150.0);
+    p[m-2] = 75 + random(150.0);
+    p[m-1] = 75 + random(150.0);
+    for (i = 0; i &lt; n-1; i += 1) {
+        c[i] = c[i+1];
+    }
+    int r, g, b;
+    r = int(game-&gt;game_time * 0.5) % 360;
+    hsv_to_rgb( r, 1.0, 1.0, &amp;r, &amp;g, &amp;b );
+    c[n-1].r = r;
+    c[n-1].g = g;
+    c[n-1].b = b;
+    return;
 }
 void RainbowRift::calculate() {
   STACKTRACE;
-	while (game-&gt;game_time &gt; next_time) {
-		next_time += 25;
-		squiggle();
-	}
-	while (game-&gt;game_time &gt; next_time2) {
-		next_time2 += random() % 10000;
-		Query q;
-		for (q.begin(this, bit(LAYER_SHIPS), 40); q.current; q.next()) {
-			GobPlayer *p = gobgame-&gt;get_player(q.currento);
-			if (q.currento == p-&gt;ship) {
-				int i = 0;
-				i = gobgame-&gt;_player_control-&gt;choose_ship(game-&gt;window, &quot;You found the Rainbow Rift!&quot;, reference_fleet);
-				game-&gt;log_int(gobgame-&gt;_player_control-&gt;channel, i);
-				if (i == -1) 
-				  i = random(reference_fleet-&gt;getSize());
-				game-&gt;redraw();
-				if (reference_fleet-&gt;getShipType(i) == p-&gt;ship-&gt;type) {
-					p-&gt;starbucks += random() % 80;
-					p-&gt;buckazoids += random() % 80;
-					game-&gt;add(new RainbowRift());
-				}
-				else {
-					p-&gt;starbucks += random() % (1+p-&gt;value_starbucks);
-					p-&gt;buckazoids += random() % (1+p-&gt;value_buckazoids);
-					p-&gt;new_ship(reference_fleet-&gt;getShipType(i));
-				}
-				die();
-			}
-		}
-	}
-	return;
+    while (game-&gt;game_time &gt; next_time) {
+        next_time += 25;
+        squiggle();
+    }
+    while (game-&gt;game_time &gt; next_time2) {
+        next_time2 += random() % 10000;
+        Query q;
+        for (q.begin(this, bit(LAYER_SHIPS), 40); q.current; q.next()) {
+            GobPlayer *p = gobgame-&gt;get_player(q.currento);
+            if (q.currento == p-&gt;ship) {
+                int i = 0;
+                i = gobgame-&gt;_player_control-&gt;choose_ship(game-&gt;window, &quot;You found the Rainbow Rift!&quot;, reference_fleet);
+                game-&gt;log_int(gobgame-&gt;_player_control-&gt;channel, i);
+                if (i == -1) 
+                  i = random(reference_fleet-&gt;getSize());
+                game-&gt;redraw();
+                if (reference_fleet-&gt;getShipType(i) == p-&gt;ship-&gt;type) {
+                    p-&gt;starbucks += random() % 80;
+                    p-&gt;buckazoids += random() % 80;
+                    game-&gt;add(new RainbowRift());
+                }
+                else {
+                    p-&gt;starbucks += random() % (1+p-&gt;value_starbucks);
+                    p-&gt;buckazoids += random() % (1+p-&gt;value_buckazoids);
+                    p-&gt;new_ship(reference_fleet-&gt;getShipType(i));
+                }
+                die();
+            }
+        }
+    }
+    return;
 }
 
+
 int GobGame::add_gobplayer(const std::string&amp; system, const std::string&amp; shptype, Vector2 pos)
 {
   STACKTRACE;

Modified: trunk/source/games/ggob.h
===================================================================
--- trunk/source/games/ggob.h	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/source/games/ggob.h	2005-08-06 18:09:53 UTC (rev 175)
@@ -26,7 +26,7 @@
 #include &quot;gamehierarchy.h&quot;
 #include &quot;other/starmap.h&quot;
 
-#include &quot;melee/GobWarpOutTrail.h&quot;
+#include &quot;other/gobwarpouttrail.h&quot;
 
 class Upgrade;
 class GobStation;
@@ -174,7 +174,7 @@
   virtual Planet* get_planet(const std::string&amp; name);
 
   virtual void prepare();
-  //	protected:
+  //    protected:
   virtual void fps ();
   
 
@@ -205,12 +205,12 @@
 
  public:
   int add_orbiter_station(const std::string&amp; system, 
-			   const std::string&amp; planet, 
-			   const std::string&amp; gatafile,
-			   const std::string&amp; station_sprite,
-			   const std::string&amp; background_picture,
-			   const std::string&amp; buildtype,
-			   const std::string&amp; commander_dialog);
+               const std::string&amp; planet, 
+               const std::string&amp; gatafile,
+               const std::string&amp; station_sprite,
+               const std::string&amp; background_picture,
+               const std::string&amp; buildtype,
+               const std::string&amp; commander_dialog);
 };
 
 /// Station where player can buy upgrades and repair his ship

Deleted: trunk/source/melee/GobWarpOutTrail.cpp
===================================================================
--- trunk/source/melee/GobWarpOutTrail.cpp	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/source/melee/GobWarpOutTrail.cpp	2005-08-06 18:09:53 UTC (rev 175)
@@ -1,83 +0,0 @@
-/*
-This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
-Copyright (C) 2001-2004  TimeWarp development team
-
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
-
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
-*/
-
-#include &quot;melee/mship.h&quot; // for Ship class
-#include &quot;melee/WarpOutTrail.h&quot;
-#include &quot;melee/GobWarpOutTrail.h&quot;
-#include &quot;games/ggob.h&quot;
-
-#include &lt;string&gt;
-
-GobWarpEffect::GobWarpEffect(const std::string &amp; targetSystem, GobGame * gobGame) :
-  targetSystem(targetSystem),
-  gobGame(gobGame)
-{
-  STACKTRACE;
-}
-
-void GobWarpEffect::startEffect() {
-  STACKTRACE;
-  //yB! should uncomment this when we know there is only one call to this per
-  //instance of GobWarpEffect.  Currently, this keeps getting called
-  //gobGame-&gt;item.remove(gobGame-&gt;gobplayer.ship);
-  printf(&quot;GobWarpEffect::startEffect()\n&quot;);
-}
-  
-void GobWarpEffect::endEffect() {
-  STACKTRACE;
-  gobGame-&gt;switch_system(targetSystem);
-  printf(&quot;GobWarpEffect::endEffect()\n&quot;);
-}
-
-
-GobWarpOutTrail::GobWarpOutTrail(
-		 const std::string &amp; targetSystem,
-		 GobGame * gobGame,
-		 SpaceLocation *creator, Vector2 pos, Vector2 rel_pos, 
-		 Ship *ship, SpaceSprite *sprite, int osprite_index, int *ocolors, 
-		 int onum_colors, int ofsize, int steps, int step_time) :
-	 WarpOutTrail(creator, pos, rel_pos, 
-	 ship, sprite, osprite_index, ocolors, 
-	 onum_colors, ofsize, steps, step_time, new GobWarpEffect(targetSystem, gobGame))
-{
-  STACKTRACE;
-}
-
-GobWarpOutTrail * GobWarpOutTrail::getGobWarpOutTrail(Ship * ship, 
-	const std::string &amp; targetSystem,
-	GobGame * gobGame)
-{
-  STACKTRACE;
-  if (!ship) {
-  	tw_error(&quot;In getGobWarpOutTrail(), parameter ship was null&quot;);
-  	return NULL;
-  }
-  return new GobWarpOutTrail(
-		    targetSystem,
-		    gobGame, 
-		    ship,
-		    ship-&gt;pos + unit_vector(ship-&gt;get_angle()) * 0 * ship-&gt;get_size().x,
-		    unit_vector(ship-&gt;get_angle()) * PHASE_MAX * ship-&gt;get_size().x,
-		    ship, 
-		    ship-&gt;get_sprite(), 
-		    ship-&gt;get_sprite_index(), 
-		    inverse_hot_color, 
-		    INVERSE_HOT_COLORS,
-		    PHASE_DELAY, 
-		    PHASE_MAX, 
-		    PHASE_DELAY
-		    );
-}

Deleted: trunk/source/melee/GobWarpOutTrail.h
===================================================================
--- trunk/source/melee/GobWarpOutTrail.h	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/source/melee/GobWarpOutTrail.h	2005-08-06 18:09:53 UTC (rev 175)
@@ -1,100 +0,0 @@
-/*
-This file is part of &quot;TW-Light&quot; 
-                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
-Copyright (C) 2001-2004  TimeWarp development team
-
-This program is free software; you can redistribute it and/or modify
-it under the terms of the GNU General Public License as published by
-the Free Software Foundation; either version 2 of the License, or
-(at your option) any later version.
-
-This program is distributed in the hope that it will be useful,
-but WITHOUT ANY WARRANTY; without even the implied warranty of
-MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-GNU General Public License for more details.
-*/
-
-#ifndef GobWarpOutTrail_Header
-#define GobWarpOutTrail_Header
-
-#include &quot;melee/mship.h&quot; //for Ship class
-#include &quot;melee/WarpOutTrail.h&quot;
-#include &quot;games/ggob.h&quot;
-
-#include &lt;string&gt;
-
-/**
- * 
- */
-class GobWarpEffect : public WarpEffect {
-protected:
-  std::string targetSystem;
-  GobGame * gobGame;
-  
-public:
-  GobWarpEffect(const std::string &amp; targetSystem, GobGame * gobGame);
-
-  /**
-   * Removes the ship from play.
-   */
-  virtual void startEffect();
-  
-  /**
-   * Moves the ship to the star system specified in the constructor.
-   */ 
-  virtual void endEffect();
-
-};
-
-/**
- * Used when the player warps out of one system and into another.
- */  
-class GobWarpOutTrail : public WarpOutTrail {
-
-protected:
-
-  /**
-   * Creates a warp out trail.  At the begining of this effect, the ship is
-   * removed from its current star system.  At the end of this effect, the ship
-   * is placed in the target star system.
-   * 
-   * @param targetSystem the name of the star system to warp to
-   * @param the instance of GobGame
-   * @param creator
-   * @param pos
-   * @param rel_pos
-   * @param ship
-   * @param sprite
-   * @param osprite_index
-   * @param ocolors
-   * @param onum_colors
-   * @param ofsize
-   * @param steps
-   * @param step_time
-   * 
-   * @see WarpOutTrail::WarpOutTrail()
-   */ 
-  GobWarpOutTrail(const std::string &amp; targetSystem,
-		  GobGame * gobGame,
-		  SpaceLocation *creator, Vector2 pos, Vector2 rel_pos, 
-		  Ship *ship, SpaceSprite *sprite, int osprite_index, int *ocolors, 
-		  int onum_colors, int ofsize, int steps, int step_time);
-
-public:
-
-  /**
-   * Constructs a trail such that the player will end up at the specified 
-   * system at the end of the effect.
-   * 
-   * @param the ship to move to the star system
-   * @param system the name of the star system the player wishes to travel to.
-   * @param the instance of GobGame
-   */ 
-  static GobWarpOutTrail * GobWarpOutTrail::getGobWarpOutTrail(Ship * ship, 
-	const std::string &amp; targetSystem,
-	GobGame * gobGame);
-
-};
-
-
-#endif

Modified: trunk/source/melee/mship.cpp
===================================================================
--- trunk/source/melee/mship.cpp	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/source/melee/mship.cpp	2005-08-06 18:09:53 UTC (rev 175)
@@ -445,7 +445,7 @@
     twl::EventList::iterator i = event.begin();
     while(i!=event.end())
       {
-	i = twl::has_event(i,event.end(),TGameEventType::SHIP_DEATH_BY_NAME );
+	i = twl::has_event(i,event.end(),TGameEventType::SHIP_DEATH_BY_ID );
 	if(i!=event.end())
 	  {
 	    (*i)-&gt;trigger();

Copied: trunk/source/other/gobwarpouttrail.cpp (from rev 174, trunk/source/melee/GobWarpOutTrail.cpp)
===================================================================
--- trunk/source/melee/GobWarpOutTrail.cpp	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/source/other/gobwarpouttrail.cpp	2005-08-06 18:09:53 UTC (rev 175)
@@ -0,0 +1,83 @@
+/*
+This file is part of &quot;TW-Light&quot; 
+                    <A HREF="http://tw-light.berlios.de/">http://tw-light.berlios.de/</A>
+Copyright (C) 2001-2004  TimeWarp development team
+
+This program is free software; you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation; either version 2 of the License, or
+(at your option) any later version.
+
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+*/
+
+#include &quot;melee/mship.h&quot; // for Ship class
+#include &quot;melee/WarpOutTrail.h&quot;
+#include &quot;gobwarpouttrail.h&quot;
+#include &quot;games/ggob.h&quot;
+
+#include &lt;string&gt;
+
+GobWarpEffect::GobWarpEffect(const std::string &amp; targetSystem, GobGame * gobGame) :
+  targetSystem(targetSystem),
+  gobGame(gobGame)
+{
+  STACKTRACE;
+}
+
+void GobWarpEffect::startEffect() {
+  STACKTRACE;
+  //yB! should uncomment this when we know there is only one call to this per
+  //instance of GobWarpEffect.  Currently, this keeps getting called
+  //gobGame-&gt;item.remove(gobGame-&gt;gobplayer.ship);
+  printf(&quot;GobWarpEffect::startEffect()\n&quot;);
+}
+  
+void GobWarpEffect::endEffect() {
+  STACKTRACE;
+  gobGame-&gt;switch_system(targetSystem);
+  printf(&quot;GobWarpEffect::endEffect()\n&quot;);
+}
+
+
+GobWarpOutTrail::GobWarpOutTrail(
+         const std::string &amp; targetSystem,
+         GobGame * gobGame,
+         SpaceLocation *creator, Vector2 pos, Vector2 rel_pos, 
+         Ship *ship, SpaceSprite *sprite, int osprite_index, int *ocolors, 
+         int onum_colors, int ofsize, int steps, int step_time) :
+     WarpOutTrail(creator, pos, rel_pos, 
+     ship, sprite, osprite_index, ocolors, 
+     onum_colors, ofsize, steps, step_time, new GobWarpEffect(targetSystem, gobGame))
+{
+  STACKTRACE;
+}
+
+GobWarpOutTrail * GobWarpOutTrail::getGobWarpOutTrail(Ship * ship, 
+    const std::string &amp; targetSystem,
+    GobGame * gobGame)
+{
+  STACKTRACE;
+  if (!ship) {
+    tw_error(&quot;In getGobWarpOutTrail(), parameter ship was null&quot;);
+    return NULL;
+  }
+  return new GobWarpOutTrail(
+            targetSystem,
+            gobGame, 
+            ship,
+            ship-&gt;pos + unit_vector(ship-&gt;get_angle()) * 0 * ship-&gt;get_size().x,
+            unit_vector(ship-&gt;get_angle()) * PHASE_MAX * ship-&gt;get_size().x,
+            ship, 
+            ship-&gt;get_sprite(), 
+            ship-&gt;get_sprite_index(), 
+            inverse_hot_color, 
+            INVERSE_HOT_COLORS,
+            PHASE_DELAY, 
+            PHASE_MAX, 
+            PHASE_DELAY
+            );
+}

Copied: trunk/source/other/gobwarpouttrail.h (from rev 174, trunk/source/melee/GobWarpOutTrail.h)

Modified: trunk/source/tml/eventmanager.cpp
===================================================================
--- trunk/source/tml/eventmanager.cpp	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/source/tml/eventmanager.cpp	2005-08-06 18:09:53 UTC (rev 175)
@@ -90,19 +90,17 @@
 }
 
 
-int EventManager::shipDeathByName(const std::string&amp; name, const std::string&amp; script )
+int EventManager::shipDeathById(double id, const std::string&amp; script )
 {
   STACKTRACE;
   int ret = -1;
-  for(std::list&lt;SpaceLocation*&gt;::iterator i = gobgame-&gt;item.begin(); i!= gobgame-&gt;item.end();i++)
+  SpaceLocation* l  =  twl::get_location((int)id);
+  if(l)
     {
-      if( (*i)-&gt;exists() &amp;&amp; (*i)-&gt;isShip() &amp;&amp; ((Ship*)(*i))-&gt;get_ship_name()==name)
-	{
-	  TEventShipDeathByName* e = new TEventShipDeathByName();
-	  ret = e-&gt;setUp(script);
-	  boost::shared_ptr&lt;TGameEvent&gt; ev (e);
-	  (*i)-&gt;add_event(ev);
-	}
+      TEventShipDeathById* e = new TEventShipDeathById();
+      ret = e-&gt;setUp(script);
+      boost::shared_ptr&lt;TGameEvent&gt; ev (e);
+      (l)-&gt;add_event(ev);
     }
   return ret;
 }

Modified: trunk/source/tml/eventmanager.h
===================================================================
--- trunk/source/tml/eventmanager.h	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/source/tml/eventmanager.h	2005-08-06 18:09:53 UTC (rev 175)
@@ -54,9 +54,9 @@
 
   /// Call function script when ship named 'name' die
   ///
-  /// @param name   - unique name of the ship
+  /// @param id     - ship ID
   /// @param script - function to call
-  static int shipDeathByName(const std::string&amp; name, const std::string&amp; script );
+  static int shipDeathById(double, const std::string&amp; script );
   
   /// Call function script when ship whose type type die
   ///

Modified: trunk/source/tml/gameaction.cpp
===================================================================
--- trunk/source/tml/gameaction.cpp	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/source/tml/gameaction.cpp	2005-08-06 18:09:53 UTC (rev 175)
@@ -22,6 +22,7 @@
 #include &quot;games/ggob.h&quot;
 #include &quot;melee/mship.h&quot;
 #include &quot;melee/mview.h&quot;
+#include &quot;melee/mcontrol.h&quot;
 
 #include &lt;map&gt;
 #include &lt;iostream&gt;
@@ -144,9 +145,9 @@
   SpaceLocation* l  =  twl::get_location((int)who);
   SpaceLocation* l2  =  twl::get_location((int)to);
   
-  if(l)
+  if(l&amp;&amp;l-&gt;isShip()&amp;&amp;l2)
     {
-      l-&gt;set_target((SpaceObject*)l2);
+      ((Ship*)l)-&gt;control-&gt;target = (SpaceObject*)l2;
     }
 }
 
@@ -281,3 +282,16 @@
 {
   message.print(time*1000, 2, &quot;%s&quot;, text.c_str());
 }
+
+void GameAction::set_camera_mode(const std::string&amp; mode)
+{
+  if(mode == &quot;Hero&quot; ||
+     mode == &quot;Enemy&quot;)
+    {
+      game-&gt;change_view(mode.c_str());
+    }
+  else
+    {
+      tw_error( (std::string(&quot;Requesting unknown camera mode : &quot;) + mode).c_str());
+    }
+}

Modified: trunk/source/tml/gameaction.h
===================================================================
--- trunk/source/tml/gameaction.h	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/source/tml/gameaction.h	2005-08-06 18:09:53 UTC (rev 175)
@@ -197,6 +197,7 @@
   /// @time how long to display
   static void print_message(const std::string&amp; text, int time);
 
+  static void set_camera_mode(const std::string&amp; mode);
 };
 
 

Modified: trunk/source/tml/gameevent.cpp
===================================================================
--- trunk/source/tml/gameevent.cpp	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/source/tml/gameevent.cpp	2005-08-06 18:09:53 UTC (rev 175)
@@ -145,11 +145,11 @@
 }
 
 
-TEventShipDeathByName::~TEventShipDeathByName()
+TEventShipDeathById::~TEventShipDeathById()
 {
 }
 
-int TEventShipDeathByName::setUp(const std::string&amp; script)
+int TEventShipDeathById::setUp(const std::string&amp; script)
 {
   STACKTRACE;
   _script = script;

Modified: trunk/source/tml/gameevent.h
===================================================================
--- trunk/source/tml/gameevent.h	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/source/tml/gameevent.h	2005-08-06 18:09:53 UTC (rev 175)
@@ -32,7 +32,7 @@
       UNKNOWN,
       SINGLE_TIME,
       REPEATABLE_TIME,
-      SHIP_DEATH_BY_NAME,
+      SHIP_DEATH_BY_ID,
       SHIP_DEATH_BY_TYPE,
       DISTANCE,
       MOVE,
@@ -128,16 +128,16 @@
 
 typedef TOneTimeEvent TEventShipDeathByNameBase;
 /// Unsupported event 
-class TEventShipDeathByName : public TEventShipDeathByNameBase
+class TEventShipDeathById : public TEventShipDeathByNameBase
 {
  public:
-  virtual ~TEventShipDeathByName();
+  virtual ~TEventShipDeathById();
   /// setup event 
   ///
   /// @param script function to call
   /// @return event id
   virtual int setUp(const std::string&amp; script);
-  virtual int type(){return TGameEventType::SHIP_DEATH_BY_NAME;}
+  virtual int type(){return TGameEventType::SHIP_DEATH_BY_ID;}
 };
 
 typedef TGameEvent TEventShipDeathByTypeBase;

Modified: trunk/sources.lst
===================================================================
--- trunk/sources.lst	2005-08-02 20:29:47 UTC (rev 174)
+++ trunk/sources.lst	2005-08-06 18:09:53 UTC (rev 175)
@@ -1,140 +0,0 @@
-source/python/python_class.cpp
-source/python/fileops.cpp
-source/python/game.cpp
-source/other/starmap.cpp
-source/other/planet3d.cpp
-source/other/fontmorph.cpp
-source/other/vtarget.cpp
-source/other/configrw.cpp
-source/other/orbit.cpp
-source/other/objanim.cpp
-source/other/twconfig.cpp
-source/other/nullphas.cpp
-source/other/radar.cpp
-source/other/shippart.cpp
-source/other/vbodies.cpp
-source/other/gup.cpp
-source/other/dialogs.cpp
-source/ships/shpconca.cpp
-source/ships/shpkahbo.cpp
-source/ships/shpzeksh.cpp
-source/ships/shpgarty.cpp
-source/ships/shpbipka.cpp
-source/ships/shpwolmi.cpp
-source/ships/shptausl.cpp
-source/ships/shpstaba.cpp
-source/ships/shprogsq.cpp
-source/ships/shptauto.cpp
-source/ships/shpearc3.cpp
-source/ships/shptauda.cpp
-source/ships/shpilwsp.cpp
-source/ships/shpdragr.cpp
-source/ships/shptaust.cpp
-source/ships/shpalabc.cpp
-source/ships/shpyusra.cpp
-source/ships/shpsamat.cpp
-source/ships/shpconho.cpp
-source/ships/shpchoex.cpp
-source/ships/shpaktgu.cpp
-source/ships/shptaume.cpp
-source/ships/shptauar.cpp
-source/ships/shpbogce.cpp
-source/ships/shpbahbu.cpp
-source/ships/shpforsh.cpp
-source/melee/mship.cpp
-source/melee/mitems.cpp
-source/melee/manim.cpp
-source/melee/mmain.cpp
-source/melee/mtarget.cpp
-source/melee/mhelpers.cpp
-source/melee/msprite.cpp
-source/melee/mnet1.cpp
-source/melee/mshot.cpp
-source/melee/mframe.cpp
-source/melee/mgame.cpp
-source/melee/mlog.cpp
-source/melee/mshpdata.cpp
-source/melee/GobWarpOutTrail.cpp
-source/melee/WarpOutTrail.cpp
-source/melee/mshppan.cpp
-source/melee/mmath.cpp
-source/melee/moptions.cpp
-source/melee/mfleet.cpp
-source/melee/mcbodies.cpp
-source/melee/mview.cpp
-source/melee/mcontrol.cpp
-source/tml/gameconfig.cpp
-source/tml/gameaction.cpp
-source/tml/gamedialog.cpp
-source/tml/gameevent.cpp
-source/tml/eventmanager.cpp
-source/games/ggob.cpp
-source/games/gflmelee.cpp
-source/games/gdefender.cpp
-source/games/gamehierarchy.cpp
-source/sc1ships/shpchebr.cpp
-source/sc1ships/shpspael.cpp
-source/sc1ships/shpmycpo.cpp
-source/sc1ships/shparisk.cpp
-source/sc1ships/shpmmrxf.cpp
-source/sc1ships/shpvuxin.cpp
-source/sc1ships/shpearcr.cpp
-source/sc1ships/shpyehte.cpp
-source/sc1ships/shpumgdr.cpp
-source/sc1ships/shpandgu.cpp
-source/sc1ships/shpkzedr.cpp
-source/sc1ships/shpshosc.cpp
-source/sc1ships/shpilwav.cpp
-source/sc1ships/shpsyrpe.cpp
-source/sc2ships/shpmeltr.cpp
-source/sc2ships/shpsupbl.cpp
-source/sc2ships/shpzfpst.cpp
-source/sc2ships/shpdruma.cpp
-source/sc2ships/shpslypr.cpp
-source/sc2ships/shppkufu.cpp
-source/sc2ships/shporzne.cpp
-source/sc2ships/shpchmav.cpp
-source/sc2ships/shputwju.cpp
-source/sc2ships/shpkohma.cpp
-source/sc2ships/shpthrto.cpp
-source/generated/tml_wrap.cpp
-source/tests/gameconfigtest.cpp
-source/tests/testmain.cpp
-source/tests/testdatapath.cpp
-source/libraries/jpgalleg/decode.c
-source/libraries/jpgalleg/jpgalleg.c
-source/libraries/jpgalleg/io.c
-source/libraries/jpgalleg/encode.c
-source/libraries/agup/aalg.c
-source/libraries/agup/aphoton.c
-source/libraries/agup/aase.c
-source/libraries/agup/abitmap.c
-source/libraries/agup/awin95.c
-source/libraries/agup/ans.c
-source/libraries/agup/agtk.c
-source/libraries/agup/abeos.c
-source/libraries/agup/agup.c
-source/ais/c_wussie.cpp
-source/ais/c_other.cpp
-source/ais/c_input.cpp
-source/util/endian.cpp
-source/util/history.cpp
-source/util/types.cpp
-source/util/aarot.c
-source/util/base.cpp
-source/util/aastr.c
-source/util/pmask.c
-source/util/errors.cpp
-source/util/errors_c.c
-source/util/aautil.c
-source/util/random.cpp
-source/util/vector2.cpp
-source/util/round.c
-source/util/sound.cpp
-source/util/net_tcp.cpp
-source/util/get_time.c
-source/input.cpp
-source/doxygen.cpp
-source/gui.cpp
-source/scp.cpp
-source/frame.cpp


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000120.html">[Tw-light-svn] r174 - in trunk: . gamedata/default_ini/ships gamedata/images/ships/shpearc3 gamedata/images/ships/shprogsq gamedata/images/ships/shpstaba
</A></li>
	<LI>Next message: <A HREF="000122.html">[Tw-light-svn] r176 - in trunk: gamedata/default_ini source/generated source/melee
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#121">[ date ]</a>
              <a href="thread.html#121">[ thread ]</a>
              <a href="subject.html#121">[ subject ]</a>
              <a href="author.html#121">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/tw-light-svn">More information about the Tw-light-svn
mailing list</a><br>
</body></html>
